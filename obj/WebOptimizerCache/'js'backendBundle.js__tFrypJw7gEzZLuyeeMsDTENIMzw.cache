{"Headers":{"Last-Modified":"Tue, 21 Aug 2018 08:45:41 GMT","X-Content-Type-Options":"nosniff"},"Body":"LyogaW5wdXQoMTE4MiwxMS0xMik6IHJ1bi10aW1lIGVycm9yIEpTMTAxMDogRXhwZWN0ZWQgaWRlbnRpZmllcjogLg0KaW5wdXQoMTE4MiwxMS0xMik6IHJ1bi10aW1lIGVycm9yIEpTMTE5NTogRXhwZWN0ZWQgZXhwcmVzc2lvbjogLiAqLw0KLyohIGpRdWVyeSB2My4zLjEgfCAoYykgSlMgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzIHwganF1ZXJ5Lm9yZy9saWNlbnNlICovDQohZnVuY3Rpb24oZSx0KXsidXNlIHN0cmljdCI7Im9iamVjdCI9PXR5cGVvZiBtb2R1bGUmJiJvYmplY3QiPT10eXBlb2YgbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9ZS5kb2N1bWVudD90KGUsITApOmZ1bmN0aW9uKGUpe2lmKCFlLmRvY3VtZW50KXRocm93IG5ldyBFcnJvcigialF1ZXJ5IHJlcXVpcmVzIGEgd2luZG93IHdpdGggYSBkb2N1bWVudCIpO3JldHVybiB0KGUpfTp0KGUpfSgidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6dGhpcyxmdW5jdGlvbihlLHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1bXSxyPWUuZG9jdW1lbnQsaT1PYmplY3QuZ2V0UHJvdG90eXBlT2Ysbz1uLnNsaWNlLGE9bi5jb25jYXQscz1uLnB1c2gsdT1uLmluZGV4T2YsbD17fSxjPWwudG9TdHJpbmcsZj1sLmhhc093blByb3BlcnR5LHA9Zi50b1N0cmluZyxkPXAuY2FsbChPYmplY3QpLGg9e30sZz1mdW5jdGlvbiBlKHQpe3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiB0JiYibnVtYmVyIiE9dHlwZW9mIHQubm9kZVR5cGV9LHk9ZnVuY3Rpb24gZSh0KXtyZXR1cm4gbnVsbCE9dCYmdD09PXQud2luZG93fSx2PXt0eXBlOiEwLHNyYzohMCxub01vZHVsZTohMH07ZnVuY3Rpb24gbShlLHQsbil7dmFyIGksbz0odD10fHxyKS5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTtpZihvLnRleHQ9ZSxuKWZvcihpIGluIHYpbltpXSYmKG9baV09bltpXSk7dC5oZWFkLmFwcGVuZENoaWxkKG8pLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobyl9ZnVuY3Rpb24geChlKXtyZXR1cm4gbnVsbD09ZT9lKyIiOiJvYmplY3QiPT10eXBlb2YgZXx8ImZ1bmN0aW9uIj09dHlwZW9mIGU/bFtjLmNhbGwoZSldfHwib2JqZWN0Ijp0eXBlb2YgZX12YXIgYj0iMy4zLjEiLHc9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gbmV3IHcuZm4uaW5pdChlLHQpfSxUPS9eW1xzXHVGRUZGXHhBMF0rfFtcc1x1RkVGRlx4QTBdKyQvZzt3LmZuPXcucHJvdG90eXBlPXtqcXVlcnk6IjMuMy4xIixjb25zdHJ1Y3Rvcjp3LGxlbmd0aDowLHRvQXJyYXk6ZnVuY3Rpb24oKXtyZXR1cm4gby5jYWxsKHRoaXMpfSxnZXQ6ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PWU/by5jYWxsKHRoaXMpOmU8MD90aGlzW2UrdGhpcy5sZW5ndGhdOnRoaXNbZV19LHB1c2hTdGFjazpmdW5jdGlvbihlKXt2YXIgdD13Lm1lcmdlKHRoaXMuY29uc3RydWN0b3IoKSxlKTtyZXR1cm4gdC5wcmV2T2JqZWN0PXRoaXMsdH0sZWFjaDpmdW5jdGlvbihlKXtyZXR1cm4gdy5lYWNoKHRoaXMsZSl9LG1hcDpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2sody5tYXAodGhpcyxmdW5jdGlvbih0LG4pe3JldHVybiBlLmNhbGwodCxuLHQpfSkpfSxzbGljZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnB1c2hTdGFjayhvLmFwcGx5KHRoaXMsYXJndW1lbnRzKSl9LGZpcnN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXEoMCl9LGxhc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lcSgtMSl9LGVxOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMubGVuZ3RoLG49K2UrKGU8MD90OjApO3JldHVybiB0aGlzLnB1c2hTdGFjayhuPj0wJiZuPHQ/W3RoaXNbbl1dOltdKX0sZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJldk9iamVjdHx8dGhpcy5jb25zdHJ1Y3RvcigpfSxwdXNoOnMsc29ydDpuLnNvcnQsc3BsaWNlOm4uc3BsaWNlfSx3LmV4dGVuZD13LmZuLmV4dGVuZD1mdW5jdGlvbigpe3ZhciBlLHQsbixyLGksbyxhPWFyZ3VtZW50c1swXXx8e30scz0xLHU9YXJndW1lbnRzLmxlbmd0aCxsPSExO2ZvcigiYm9vbGVhbiI9PXR5cGVvZiBhJiYobD1hLGE9YXJndW1lbnRzW3NdfHx7fSxzKyspLCJvYmplY3QiPT10eXBlb2YgYXx8ZyhhKXx8KGE9e30pLHM9PT11JiYoYT10aGlzLHMtLSk7czx1O3MrKylpZihudWxsIT0oZT1hcmd1bWVudHNbc10pKWZvcih0IGluIGUpbj1hW3RdLGEhPT0ocj1lW3RdKSYmKGwmJnImJih3LmlzUGxhaW5PYmplY3Qocil8fChpPUFycmF5LmlzQXJyYXkocikpKT8oaT8oaT0hMSxvPW4mJkFycmF5LmlzQXJyYXkobik/bjpbXSk6bz1uJiZ3LmlzUGxhaW5PYmplY3Qobik/bjp7fSxhW3RdPXcuZXh0ZW5kKGwsbyxyKSk6dm9pZCAwIT09ciYmKGFbdF09cikpO3JldHVybiBhfSx3LmV4dGVuZCh7ZXhwYW5kbzoialF1ZXJ5IisoIjMuMy4xIitNYXRoLnJhbmRvbSgpKS5yZXBsYWNlKC9cRC9nLCIiKSxpc1JlYWR5OiEwLGVycm9yOmZ1bmN0aW9uKGUpe3Rocm93IG5ldyBFcnJvcihlKX0sbm9vcDpmdW5jdGlvbigpe30saXNQbGFpbk9iamVjdDpmdW5jdGlvbihlKXt2YXIgdCxuO3JldHVybiEoIWV8fCJbb2JqZWN0IE9iamVjdF0iIT09Yy5jYWxsKGUpKSYmKCEodD1pKGUpKXx8ImZ1bmN0aW9uIj09dHlwZW9mKG49Zi5jYWxsKHQsImNvbnN0cnVjdG9yIikmJnQuY29uc3RydWN0b3IpJiZwLmNhbGwobik9PT1kKX0saXNFbXB0eU9iamVjdDpmdW5jdGlvbihlKXt2YXIgdDtmb3IodCBpbiBlKXJldHVybiExO3JldHVybiEwfSxnbG9iYWxFdmFsOmZ1bmN0aW9uKGUpe20oZSl9LGVhY2g6ZnVuY3Rpb24oZSx0KXt2YXIgbixyPTA7aWYoQyhlKSl7Zm9yKG49ZS5sZW5ndGg7cjxuO3IrKylpZighMT09PXQuY2FsbChlW3JdLHIsZVtyXSkpYnJlYWt9ZWxzZSBmb3IociBpbiBlKWlmKCExPT09dC5jYWxsKGVbcl0scixlW3JdKSlicmVhaztyZXR1cm4gZX0sdHJpbTpmdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09ZT8iIjooZSsiIikucmVwbGFjZShULCIiKX0sbWFrZUFycmF5OmZ1bmN0aW9uKGUsdCl7dmFyIG49dHx8W107cmV0dXJuIG51bGwhPWUmJihDKE9iamVjdChlKSk/dy5tZXJnZShuLCJzdHJpbmciPT10eXBlb2YgZT9bZV06ZSk6cy5jYWxsKG4sZSkpLG59LGluQXJyYXk6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBudWxsPT10Py0xOnUuY2FsbCh0LGUsbil9LG1lcmdlOmZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPSt0Lmxlbmd0aCxyPTAsaT1lLmxlbmd0aDtyPG47cisrKWVbaSsrXT10W3JdO3JldHVybiBlLmxlbmd0aD1pLGV9LGdyZXA6ZnVuY3Rpb24oZSx0LG4pe2Zvcih2YXIgcixpPVtdLG89MCxhPWUubGVuZ3RoLHM9IW47bzxhO28rKykocj0hdChlW29dLG8pKSE9PXMmJmkucHVzaChlW29dKTtyZXR1cm4gaX0sbWFwOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG89MCxzPVtdO2lmKEMoZSkpZm9yKHI9ZS5sZW5ndGg7bzxyO28rKyludWxsIT0oaT10KGVbb10sbyxuKSkmJnMucHVzaChpKTtlbHNlIGZvcihvIGluIGUpbnVsbCE9KGk9dChlW29dLG8sbikpJiZzLnB1c2goaSk7cmV0dXJuIGEuYXBwbHkoW10scyl9LGd1aWQ6MSxzdXBwb3J0Omh9KSwiZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiYody5mbltTeW1ib2wuaXRlcmF0b3JdPW5bU3ltYm9sLml0ZXJhdG9yXSksdy5lYWNoKCJCb29sZWFuIE51bWJlciBTdHJpbmcgRnVuY3Rpb24gQXJyYXkgRGF0ZSBSZWdFeHAgT2JqZWN0IEVycm9yIFN5bWJvbCIuc3BsaXQoIiAiKSxmdW5jdGlvbihlLHQpe2xbIltvYmplY3QgIit0KyJdIl09dC50b0xvd2VyQ2FzZSgpfSk7ZnVuY3Rpb24gQyhlKXt2YXIgdD0hIWUmJiJsZW5ndGgiaW4gZSYmZS5sZW5ndGgsbj14KGUpO3JldHVybiFnKGUpJiYheShlKSYmKCJhcnJheSI9PT1ufHwwPT09dHx8Im51bWJlciI9PXR5cGVvZiB0JiZ0PjAmJnQtMSBpbiBlKX12YXIgRT1mdW5jdGlvbihlKXt2YXIgdCxuLHIsaSxvLGEscyx1LGwsYyxmLHAsZCxoLGcseSx2LG0seCxiPSJzaXp6bGUiKzEqbmV3IERhdGUsdz1lLmRvY3VtZW50LFQ9MCxDPTAsRT1hZSgpLGs9YWUoKSxTPWFlKCksRD1mdW5jdGlvbihlLHQpe3JldHVybiBlPT09dCYmKGY9ITApLDB9LE49e30uaGFzT3duUHJvcGVydHksQT1bXSxqPUEucG9wLHE9QS5wdXNoLEw9QS5wdXNoLEg9QS5zbGljZSxPPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPTAscj1lLmxlbmd0aDtuPHI7bisrKWlmKGVbbl09PT10KXJldHVybiBuO3JldHVybi0xfSxQPSJjaGVja2VkfHNlbGVjdGVkfGFzeW5jfGF1dG9mb2N1c3xhdXRvcGxheXxjb250cm9sc3xkZWZlcnxkaXNhYmxlZHxoaWRkZW58aXNtYXB8bG9vcHxtdWx0aXBsZXxvcGVufHJlYWRvbmx5fHJlcXVpcmVkfHNjb3BlZCIsTT0iW1xceDIwXFx0XFxyXFxuXFxmXSIsUj0iKD86XFxcXC58W1xcdy1dfFteXDAtXFx4YTBdKSsiLEk9IlxcWyIrTSsiKigiK1IrIikoPzoiK00rIiooWypeJHwhfl0/PSkiK00rIiooPzonKCg/OlxcXFwufFteXFxcXCddKSopJ3xcIigoPzpcXFxcLnxbXlxcXFxcIl0pKilcInwoIitSKyIpKXwpIitNKyIqXFxdIixXPSI6KCIrUisiKSg/OlxcKCgoJygoPzpcXFxcLnxbXlxcXFwnXSkqKSd8XCIoKD86XFxcXC58W15cXFxcXCJdKSopXCIpfCgoPzpcXFxcLnxbXlxcXFwoKVtcXF1dfCIrSSsiKSopfC4qKVxcKXwpIiwkPW5ldyBSZWdFeHAoTSsiKyIsImciKSxCPW5ldyBSZWdFeHAoIl4iK00rIit8KCg/Ol58W15cXFxcXSkoPzpcXFxcLikqKSIrTSsiKyQiLCJnIiksRj1uZXcgUmVnRXhwKCJeIitNKyIqLCIrTSsiKiIpLF89bmV3IFJlZ0V4cCgiXiIrTSsiKihbPit+XXwiK00rIikiK00rIioiKSx6PW5ldyBSZWdFeHAoIj0iK00rIiooW15cXF0nXCJdKj8pIitNKyIqXFxdIiwiZyIpLFg9bmV3IFJlZ0V4cChXKSxVPW5ldyBSZWdFeHAoIl4iK1IrIiQiKSxWPXtJRDpuZXcgUmVnRXhwKCJeIygiK1IrIikiKSxDTEFTUzpuZXcgUmVnRXhwKCJeXFwuKCIrUisiKSIpLFRBRzpuZXcgUmVnRXhwKCJeKCIrUisifFsqXSkiKSxBVFRSOm5ldyBSZWdFeHAoIl4iK0kpLFBTRVVETzpuZXcgUmVnRXhwKCJeIitXKSxDSElMRDpuZXcgUmVnRXhwKCJeOihvbmx5fGZpcnN0fGxhc3R8bnRofG50aC1sYXN0KS0oY2hpbGR8b2YtdHlwZSkoPzpcXCgiK00rIiooZXZlbnxvZGR8KChbKy1dfCkoXFxkKilufCkiK00rIiooPzooWystXXwpIitNKyIqKFxcZCspfCkpIitNKyIqXFwpfCkiLCJpIiksYm9vbDpuZXcgUmVnRXhwKCJeKD86IitQKyIpJCIsImkiKSxuZWVkc0NvbnRleHQ6bmV3IFJlZ0V4cCgiXiIrTSsiKls+K35dfDooZXZlbnxvZGR8ZXF8Z3R8bHR8bnRofGZpcnN0fGxhc3QpKD86XFwoIitNKyIqKCg/Oi1cXGQpP1xcZCopIitNKyIqXFwpfCkoPz1bXi1dfCQpIiwiaSIpfSxHPS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2ksWT0vXmhcZCQvaSxRPS9eW157XStce1xzKlxbbmF0aXZlIFx3LyxKPS9eKD86IyhbXHctXSspfChcdyspfFwuKFtcdy1dKykpJC8sSz0vWyt+XS8sWj1uZXcgUmVnRXhwKCJcXFxcKFtcXGRhLWZdezEsNn0iK00rIj98KCIrTSsiKXwuKSIsImlnIiksZWU9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPSIweCIrdC02NTUzNjtyZXR1cm4gciE9PXJ8fG4/dDpyPDA/U3RyaW5nLmZyb21DaGFyQ29kZShyKzY1NTM2KTpTdHJpbmcuZnJvbUNoYXJDb2RlKHI+PjEwfDU1Mjk2LDEwMjMmcnw1NjMyMCl9LHRlPS8oW1wwLVx4MWZceDdmXXxeLT9cZCl8Xi0kfFteXDAtXHgxZlx4N2YtXHVGRkZGXHctXS9nLG5lPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQ/IlwwIj09PWU/Ilx1ZmZmZCI6ZS5zbGljZSgwLC0xKSsiXFwiK2UuY2hhckNvZGVBdChlLmxlbmd0aC0xKS50b1N0cmluZygxNikrIiAiOiJcXCIrZX0scmU9ZnVuY3Rpb24oKXtwKCl9LGllPW1lKGZ1bmN0aW9uKGUpe3JldHVybiEwPT09ZS5kaXNhYmxlZCYmKCJmb3JtImluIGV8fCJsYWJlbCJpbiBlKX0se2RpcjoicGFyZW50Tm9kZSIsbmV4dDoibGVnZW5kIn0pO3RyeXtMLmFwcGx5KEE9SC5jYWxsKHcuY2hpbGROb2Rlcyksdy5jaGlsZE5vZGVzKSxBW3cuY2hpbGROb2Rlcy5sZW5ndGhdLm5vZGVUeXBlfWNhdGNoKGUpe0w9e2FwcGx5OkEubGVuZ3RoP2Z1bmN0aW9uKGUsdCl7cS5hcHBseShlLEguY2FsbCh0KSl9OmZ1bmN0aW9uKGUsdCl7dmFyIG49ZS5sZW5ndGgscj0wO3doaWxlKGVbbisrXT10W3IrK10pO2UubGVuZ3RoPW4tMX19fWZ1bmN0aW9uIG9lKGUsdCxyLGkpe3ZhciBvLHMsbCxjLGYsaCx2LG09dCYmdC5vd25lckRvY3VtZW50LFQ9dD90Lm5vZGVUeXBlOjk7aWYocj1yfHxbXSwic3RyaW5nIiE9dHlwZW9mIGV8fCFlfHwxIT09VCYmOSE9PVQmJjExIT09VClyZXR1cm4gcjtpZighaSYmKCh0P3Qub3duZXJEb2N1bWVudHx8dDp3KSE9PWQmJnAodCksdD10fHxkLGcpKXtpZigxMSE9PVQmJihmPUouZXhlYyhlKSkpaWYobz1mWzFdKXtpZig5PT09VCl7aWYoIShsPXQuZ2V0RWxlbWVudEJ5SWQobykpKXJldHVybiByO2lmKGwuaWQ9PT1vKXJldHVybiByLnB1c2gobCkscn1lbHNlIGlmKG0mJihsPW0uZ2V0RWxlbWVudEJ5SWQobykpJiZ4KHQsbCkmJmwuaWQ9PT1vKXJldHVybiByLnB1c2gobCkscn1lbHNle2lmKGZbMl0pcmV0dXJuIEwuYXBwbHkocix0LmdldEVsZW1lbnRzQnlUYWdOYW1lKGUpKSxyO2lmKChvPWZbM10pJiZuLmdldEVsZW1lbnRzQnlDbGFzc05hbWUmJnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSlyZXR1cm4gTC5hcHBseShyLHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShvKSkscn1pZihuLnFzYSYmIVNbZSsiICJdJiYoIXl8fCF5LnRlc3QoZSkpKXtpZigxIT09VCltPXQsdj1lO2Vsc2UgaWYoIm9iamVjdCIhPT10Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpeyhjPXQuZ2V0QXR0cmlidXRlKCJpZCIpKT9jPWMucmVwbGFjZSh0ZSxuZSk6dC5zZXRBdHRyaWJ1dGUoImlkIixjPWIpLHM9KGg9YShlKSkubGVuZ3RoO3doaWxlKHMtLSloW3NdPSIjIitjKyIgIit2ZShoW3NdKTt2PWguam9pbigiLCIpLG09Sy50ZXN0KGUpJiZnZSh0LnBhcmVudE5vZGUpfHx0fWlmKHYpdHJ5e3JldHVybiBMLmFwcGx5KHIsbS5xdWVyeVNlbGVjdG9yQWxsKHYpKSxyfWNhdGNoKGUpe31maW5hbGx5e2M9PT1iJiZ0LnJlbW92ZUF0dHJpYnV0ZSgiaWQiKX19fXJldHVybiB1KGUucmVwbGFjZShCLCIkMSIpLHQscixpKX1mdW5jdGlvbiBhZSgpe3ZhciBlPVtdO2Z1bmN0aW9uIHQobixpKXtyZXR1cm4gZS5wdXNoKG4rIiAiKT5yLmNhY2hlTGVuZ3RoJiZkZWxldGUgdFtlLnNoaWZ0KCldLHRbbisiICJdPWl9cmV0dXJuIHR9ZnVuY3Rpb24gc2UoZSl7cmV0dXJuIGVbYl09ITAsZX1mdW5jdGlvbiB1ZShlKXt2YXIgdD1kLmNyZWF0ZUVsZW1lbnQoImZpZWxkc2V0Iik7dHJ5e3JldHVybiEhZSh0KX1jYXRjaChlKXtyZXR1cm4hMX1maW5hbGx5e3QucGFyZW50Tm9kZSYmdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHQpLHQ9bnVsbH19ZnVuY3Rpb24gbGUoZSx0KXt2YXIgbj1lLnNwbGl0KCJ8IiksaT1uLmxlbmd0aDt3aGlsZShpLS0pci5hdHRySGFuZGxlW25baV1dPXR9ZnVuY3Rpb24gY2UoZSx0KXt2YXIgbj10JiZlLHI9biYmMT09PWUubm9kZVR5cGUmJjE9PT10Lm5vZGVUeXBlJiZlLnNvdXJjZUluZGV4LXQuc291cmNlSW5kZXg7aWYocilyZXR1cm4gcjtpZihuKXdoaWxlKG49bi5uZXh0U2libGluZylpZihuPT09dClyZXR1cm4tMTtyZXR1cm4gZT8xOi0xfWZ1bmN0aW9uIGZlKGUpe3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4iaW5wdXQiPT09dC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpJiZ0LnR5cGU9PT1lfX1mdW5jdGlvbiBwZShlKXtyZXR1cm4gZnVuY3Rpb24odCl7dmFyIG49dC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO3JldHVybigiaW5wdXQiPT09bnx8ImJ1dHRvbiI9PT1uKSYmdC50eXBlPT09ZX19ZnVuY3Rpb24gZGUoZSl7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybiJmb3JtImluIHQ/dC5wYXJlbnROb2RlJiYhMT09PXQuZGlzYWJsZWQ/ImxhYmVsImluIHQ/ImxhYmVsImluIHQucGFyZW50Tm9kZT90LnBhcmVudE5vZGUuZGlzYWJsZWQ9PT1lOnQuZGlzYWJsZWQ9PT1lOnQuaXNEaXNhYmxlZD09PWV8fHQuaXNEaXNhYmxlZCE9PSFlJiZpZSh0KT09PWU6dC5kaXNhYmxlZD09PWU6ImxhYmVsImluIHQmJnQuZGlzYWJsZWQ9PT1lfX1mdW5jdGlvbiBoZShlKXtyZXR1cm4gc2UoZnVuY3Rpb24odCl7cmV0dXJuIHQ9K3Qsc2UoZnVuY3Rpb24obixyKXt2YXIgaSxvPWUoW10sbi5sZW5ndGgsdCksYT1vLmxlbmd0aDt3aGlsZShhLS0pbltpPW9bYV1dJiYobltpXT0hKHJbaV09bltpXSkpfSl9KX1mdW5jdGlvbiBnZShlKXtyZXR1cm4gZSYmInVuZGVmaW5lZCIhPXR5cGVvZiBlLmdldEVsZW1lbnRzQnlUYWdOYW1lJiZlfW49b2Uuc3VwcG9ydD17fSxvPW9lLmlzWE1MPWZ1bmN0aW9uKGUpe3ZhciB0PWUmJihlLm93bmVyRG9jdW1lbnR8fGUpLmRvY3VtZW50RWxlbWVudDtyZXR1cm4hIXQmJiJIVE1MIiE9PXQubm9kZU5hbWV9LHA9b2Uuc2V0RG9jdW1lbnQ9ZnVuY3Rpb24oZSl7dmFyIHQsaSxhPWU/ZS5vd25lckRvY3VtZW50fHxlOnc7cmV0dXJuIGEhPT1kJiY5PT09YS5ub2RlVHlwZSYmYS5kb2N1bWVudEVsZW1lbnQ/KGQ9YSxoPWQuZG9jdW1lbnRFbGVtZW50LGc9IW8oZCksdyE9PWQmJihpPWQuZGVmYXVsdFZpZXcpJiZpLnRvcCE9PWkmJihpLmFkZEV2ZW50TGlzdGVuZXI/aS5hZGRFdmVudExpc3RlbmVyKCJ1bmxvYWQiLHJlLCExKTppLmF0dGFjaEV2ZW50JiZpLmF0dGFjaEV2ZW50KCJvbnVubG9hZCIscmUpKSxuLmF0dHJpYnV0ZXM9dWUoZnVuY3Rpb24oZSl7cmV0dXJuIGUuY2xhc3NOYW1lPSJpIiwhZS5nZXRBdHRyaWJ1dGUoImNsYXNzTmFtZSIpfSksbi5nZXRFbGVtZW50c0J5VGFnTmFtZT11ZShmdW5jdGlvbihlKXtyZXR1cm4gZS5hcHBlbmRDaGlsZChkLmNyZWF0ZUNvbW1lbnQoIiIpKSwhZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpLmxlbmd0aH0pLG4uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZT1RLnRlc3QoZC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKSxuLmdldEJ5SWQ9dWUoZnVuY3Rpb24oZSl7cmV0dXJuIGguYXBwZW5kQ2hpbGQoZSkuaWQ9YiwhZC5nZXRFbGVtZW50c0J5TmFtZXx8IWQuZ2V0RWxlbWVudHNCeU5hbWUoYikubGVuZ3RofSksbi5nZXRCeUlkPyhyLmZpbHRlci5JRD1mdW5jdGlvbihlKXt2YXIgdD1lLnJlcGxhY2UoWixlZSk7cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiBlLmdldEF0dHJpYnV0ZSgiaWQiKT09PXR9fSxyLmZpbmQuSUQ9ZnVuY3Rpb24oZSx0KXtpZigidW5kZWZpbmVkIiE9dHlwZW9mIHQuZ2V0RWxlbWVudEJ5SWQmJmcpe3ZhciBuPXQuZ2V0RWxlbWVudEJ5SWQoZSk7cmV0dXJuIG4/W25dOltdfX0pOihyLmZpbHRlci5JRD1mdW5jdGlvbihlKXt2YXIgdD1lLnJlcGxhY2UoWixlZSk7cmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciBuPSJ1bmRlZmluZWQiIT10eXBlb2YgZS5nZXRBdHRyaWJ1dGVOb2RlJiZlLmdldEF0dHJpYnV0ZU5vZGUoImlkIik7cmV0dXJuIG4mJm4udmFsdWU9PT10fX0sci5maW5kLklEPWZ1bmN0aW9uKGUsdCl7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiB0LmdldEVsZW1lbnRCeUlkJiZnKXt2YXIgbixyLGksbz10LmdldEVsZW1lbnRCeUlkKGUpO2lmKG8pe2lmKChuPW8uZ2V0QXR0cmlidXRlTm9kZSgiaWQiKSkmJm4udmFsdWU9PT1lKXJldHVybltvXTtpPXQuZ2V0RWxlbWVudHNCeU5hbWUoZSkscj0wO3doaWxlKG89aVtyKytdKWlmKChuPW8uZ2V0QXR0cmlidXRlTm9kZSgiaWQiKSkmJm4udmFsdWU9PT1lKXJldHVybltvXX1yZXR1cm5bXX19KSxyLmZpbmQuVEFHPW4uZ2V0RWxlbWVudHNCeVRhZ05hbWU/ZnVuY3Rpb24oZSx0KXtyZXR1cm4idW5kZWZpbmVkIiE9dHlwZW9mIHQuZ2V0RWxlbWVudHNCeVRhZ05hbWU/dC5nZXRFbGVtZW50c0J5VGFnTmFtZShlKTpuLnFzYT90LnF1ZXJ5U2VsZWN0b3JBbGwoZSk6dm9pZCAwfTpmdW5jdGlvbihlLHQpe3ZhciBuLHI9W10saT0wLG89dC5nZXRFbGVtZW50c0J5VGFnTmFtZShlKTtpZigiKiI9PT1lKXt3aGlsZShuPW9baSsrXSkxPT09bi5ub2RlVHlwZSYmci5wdXNoKG4pO3JldHVybiByfXJldHVybiBvfSxyLmZpbmQuQ0xBU1M9bi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lJiZmdW5jdGlvbihlLHQpe2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgdC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lJiZnKXJldHVybiB0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoZSl9LHY9W10seT1bXSwobi5xc2E9US50ZXN0KGQucXVlcnlTZWxlY3RvckFsbCkpJiYodWUoZnVuY3Rpb24oZSl7aC5hcHBlbmRDaGlsZChlKS5pbm5lckhUTUw9IjxhIGlkPSciK2IrIic+PC9hPjxzZWxlY3QgaWQ9JyIrYisiLVxyXFwnIG1zYWxsb3djYXB0dXJlPScnPjxvcHRpb24gc2VsZWN0ZWQ9Jyc+PC9vcHRpb24+PC9zZWxlY3Q+IixlLnF1ZXJ5U2VsZWN0b3JBbGwoIlttc2FsbG93Y2FwdHVyZV49JyddIikubGVuZ3RoJiZ5LnB1c2goIlsqXiRdPSIrTSsiKig/OicnfFwiXCIpIiksZS5xdWVyeVNlbGVjdG9yQWxsKCJbc2VsZWN0ZWRdIikubGVuZ3RofHx5LnB1c2goIlxcWyIrTSsiKig/OnZhbHVlfCIrUCsiKSIpLGUucXVlcnlTZWxlY3RvckFsbCgiW2lkfj0iK2IrIi1dIikubGVuZ3RofHx5LnB1c2goIn49IiksZS5xdWVyeVNlbGVjdG9yQWxsKCI6Y2hlY2tlZCIpLmxlbmd0aHx8eS5wdXNoKCI6Y2hlY2tlZCIpLGUucXVlcnlTZWxlY3RvckFsbCgiYSMiK2IrIisqIikubGVuZ3RofHx5LnB1c2goIi4jLitbK35dIil9KSx1ZShmdW5jdGlvbihlKXtlLmlubmVySFRNTD0iPGEgaHJlZj0nJyBkaXNhYmxlZD0nZGlzYWJsZWQnPjwvYT48c2VsZWN0IGRpc2FibGVkPSdkaXNhYmxlZCc+PG9wdGlvbi8+PC9zZWxlY3Q+Ijt2YXIgdD1kLmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7dC5zZXRBdHRyaWJ1dGUoInR5cGUiLCJoaWRkZW4iKSxlLmFwcGVuZENoaWxkKHQpLnNldEF0dHJpYnV0ZSgibmFtZSIsIkQiKSxlLnF1ZXJ5U2VsZWN0b3JBbGwoIltuYW1lPWRdIikubGVuZ3RoJiZ5LnB1c2goIm5hbWUiK00rIipbKl4kfCF+XT89IiksMiE9PWUucXVlcnlTZWxlY3RvckFsbCgiOmVuYWJsZWQiKS5sZW5ndGgmJnkucHVzaCgiOmVuYWJsZWQiLCI6ZGlzYWJsZWQiKSxoLmFwcGVuZENoaWxkKGUpLmRpc2FibGVkPSEwLDIhPT1lLnF1ZXJ5U2VsZWN0b3JBbGwoIjpkaXNhYmxlZCIpLmxlbmd0aCYmeS5wdXNoKCI6ZW5hYmxlZCIsIjpkaXNhYmxlZCIpLGUucXVlcnlTZWxlY3RvckFsbCgiKiw6eCIpLHkucHVzaCgiLC4qOiIpfSkpLChuLm1hdGNoZXNTZWxlY3Rvcj1RLnRlc3QobT1oLm1hdGNoZXN8fGgud2Via2l0TWF0Y2hlc1NlbGVjdG9yfHxoLm1vek1hdGNoZXNTZWxlY3Rvcnx8aC5vTWF0Y2hlc1NlbGVjdG9yfHxoLm1zTWF0Y2hlc1NlbGVjdG9yKSkmJnVlKGZ1bmN0aW9uKGUpe24uZGlzY29ubmVjdGVkTWF0Y2g9bS5jYWxsKGUsIioiKSxtLmNhbGwoZSwiW3MhPScnXTp4Iiksdi5wdXNoKCIhPSIsVyl9KSx5PXkubGVuZ3RoJiZuZXcgUmVnRXhwKHkuam9pbigifCIpKSx2PXYubGVuZ3RoJiZuZXcgUmVnRXhwKHYuam9pbigifCIpKSx0PVEudGVzdChoLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKSx4PXR8fFEudGVzdChoLmNvbnRhaW5zKT9mdW5jdGlvbihlLHQpe3ZhciBuPTk9PT1lLm5vZGVUeXBlP2UuZG9jdW1lbnRFbGVtZW50OmUscj10JiZ0LnBhcmVudE5vZGU7cmV0dXJuIGU9PT1yfHwhKCFyfHwxIT09ci5ub2RlVHlwZXx8IShuLmNvbnRhaW5zP24uY29udGFpbnMocik6ZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiYmMTYmZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihyKSkpfTpmdW5jdGlvbihlLHQpe2lmKHQpd2hpbGUodD10LnBhcmVudE5vZGUpaWYodD09PWUpcmV0dXJuITA7cmV0dXJuITF9LEQ9dD9mdW5jdGlvbihlLHQpe2lmKGU9PT10KXJldHVybiBmPSEwLDA7dmFyIHI9IWUuY29tcGFyZURvY3VtZW50UG9zaXRpb24tIXQuY29tcGFyZURvY3VtZW50UG9zaXRpb247cmV0dXJuIHJ8fCgxJihyPShlLm93bmVyRG9jdW1lbnR8fGUpPT09KHQub3duZXJEb2N1bWVudHx8dCk/ZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbih0KToxKXx8IW4uc29ydERldGFjaGVkJiZ0LmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGUpPT09cj9lPT09ZHx8ZS5vd25lckRvY3VtZW50PT09dyYmeCh3LGUpPy0xOnQ9PT1kfHx0Lm93bmVyRG9jdW1lbnQ9PT13JiZ4KHcsdCk/MTpjP08oYyxlKS1PKGMsdCk6MDo0JnI/LTE6MSl9OmZ1bmN0aW9uKGUsdCl7aWYoZT09PXQpcmV0dXJuIGY9ITAsMDt2YXIgbixyPTAsaT1lLnBhcmVudE5vZGUsbz10LnBhcmVudE5vZGUsYT1bZV0scz1bdF07aWYoIWl8fCFvKXJldHVybiBlPT09ZD8tMTp0PT09ZD8xOmk/LTE6bz8xOmM/TyhjLGUpLU8oYyx0KTowO2lmKGk9PT1vKXJldHVybiBjZShlLHQpO249ZTt3aGlsZShuPW4ucGFyZW50Tm9kZSlhLnVuc2hpZnQobik7bj10O3doaWxlKG49bi5wYXJlbnROb2RlKXMudW5zaGlmdChuKTt3aGlsZShhW3JdPT09c1tyXSlyKys7cmV0dXJuIHI/Y2UoYVtyXSxzW3JdKTphW3JdPT09dz8tMTpzW3JdPT09dz8xOjB9LGQpOmR9LG9lLm1hdGNoZXM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gb2UoZSxudWxsLG51bGwsdCl9LG9lLm1hdGNoZXNTZWxlY3Rvcj1mdW5jdGlvbihlLHQpe2lmKChlLm93bmVyRG9jdW1lbnR8fGUpIT09ZCYmcChlKSx0PXQucmVwbGFjZSh6LCI9JyQxJ10iKSxuLm1hdGNoZXNTZWxlY3RvciYmZyYmIVNbdCsiICJdJiYoIXZ8fCF2LnRlc3QodCkpJiYoIXl8fCF5LnRlc3QodCkpKXRyeXt2YXIgcj1tLmNhbGwoZSx0KTtpZihyfHxuLmRpc2Nvbm5lY3RlZE1hdGNofHxlLmRvY3VtZW50JiYxMSE9PWUuZG9jdW1lbnQubm9kZVR5cGUpcmV0dXJuIHJ9Y2F0Y2goZSl7fXJldHVybiBvZSh0LGQsbnVsbCxbZV0pLmxlbmd0aD4wfSxvZS5jb250YWlucz1mdW5jdGlvbihlLHQpe3JldHVybihlLm93bmVyRG9jdW1lbnR8fGUpIT09ZCYmcChlKSx4KGUsdCl9LG9lLmF0dHI9ZnVuY3Rpb24oZSx0KXsoZS5vd25lckRvY3VtZW50fHxlKSE9PWQmJnAoZSk7dmFyIGk9ci5hdHRySGFuZGxlW3QudG9Mb3dlckNhc2UoKV0sbz1pJiZOLmNhbGwoci5hdHRySGFuZGxlLHQudG9Mb3dlckNhc2UoKSk/aShlLHQsIWcpOnZvaWQgMDtyZXR1cm4gdm9pZCAwIT09bz9vOm4uYXR0cmlidXRlc3x8IWc/ZS5nZXRBdHRyaWJ1dGUodCk6KG89ZS5nZXRBdHRyaWJ1dGVOb2RlKHQpKSYmby5zcGVjaWZpZWQ/by52YWx1ZTpudWxsfSxvZS5lc2NhcGU9ZnVuY3Rpb24oZSl7cmV0dXJuKGUrIiIpLnJlcGxhY2UodGUsbmUpfSxvZS5lcnJvcj1mdW5jdGlvbihlKXt0aHJvdyBuZXcgRXJyb3IoIlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246ICIrZSl9LG9lLnVuaXF1ZVNvcnQ9ZnVuY3Rpb24oZSl7dmFyIHQscj1bXSxpPTAsbz0wO2lmKGY9IW4uZGV0ZWN0RHVwbGljYXRlcyxjPSFuLnNvcnRTdGFibGUmJmUuc2xpY2UoMCksZS5zb3J0KEQpLGYpe3doaWxlKHQ9ZVtvKytdKXQ9PT1lW29dJiYoaT1yLnB1c2gobykpO3doaWxlKGktLSllLnNwbGljZShyW2ldLDEpfXJldHVybiBjPW51bGwsZX0saT1vZS5nZXRUZXh0PWZ1bmN0aW9uKGUpe3ZhciB0LG49IiIscj0wLG89ZS5ub2RlVHlwZTtpZihvKXtpZigxPT09b3x8OT09PW98fDExPT09byl7aWYoInN0cmluZyI9PXR5cGVvZiBlLnRleHRDb250ZW50KXJldHVybiBlLnRleHRDb250ZW50O2ZvcihlPWUuZmlyc3RDaGlsZDtlO2U9ZS5uZXh0U2libGluZyluKz1pKGUpfWVsc2UgaWYoMz09PW98fDQ9PT1vKXJldHVybiBlLm5vZGVWYWx1ZX1lbHNlIHdoaWxlKHQ9ZVtyKytdKW4rPWkodCk7cmV0dXJuIG59LChyPW9lLnNlbGVjdG9ycz17Y2FjaGVMZW5ndGg6NTAsY3JlYXRlUHNldWRvOnNlLG1hdGNoOlYsYXR0ckhhbmRsZTp7fSxmaW5kOnt9LHJlbGF0aXZlOnsiPiI6e2RpcjoicGFyZW50Tm9kZSIsZmlyc3Q6ITB9LCIgIjp7ZGlyOiJwYXJlbnROb2RlIn0sIisiOntkaXI6InByZXZpb3VzU2libGluZyIsZmlyc3Q6ITB9LCJ+Ijp7ZGlyOiJwcmV2aW91c1NpYmxpbmcifX0scHJlRmlsdGVyOntBVFRSOmZ1bmN0aW9uKGUpe3JldHVybiBlWzFdPWVbMV0ucmVwbGFjZShaLGVlKSxlWzNdPShlWzNdfHxlWzRdfHxlWzVdfHwiIikucmVwbGFjZShaLGVlKSwifj0iPT09ZVsyXSYmKGVbM109IiAiK2VbM10rIiAiKSxlLnNsaWNlKDAsNCl9LENISUxEOmZ1bmN0aW9uKGUpe3JldHVybiBlWzFdPWVbMV0udG9Mb3dlckNhc2UoKSwibnRoIj09PWVbMV0uc2xpY2UoMCwzKT8oZVszXXx8b2UuZXJyb3IoZVswXSksZVs0XT0rKGVbNF0/ZVs1XSsoZVs2XXx8MSk6MiooImV2ZW4iPT09ZVszXXx8Im9kZCI9PT1lWzNdKSksZVs1XT0rKGVbN10rZVs4XXx8Im9kZCI9PT1lWzNdKSk6ZVszXSYmb2UuZXJyb3IoZVswXSksZX0sUFNFVURPOmZ1bmN0aW9uKGUpe3ZhciB0LG49IWVbNl0mJmVbMl07cmV0dXJuIFYuQ0hJTEQudGVzdChlWzBdKT9udWxsOihlWzNdP2VbMl09ZVs0XXx8ZVs1XXx8IiI6biYmWC50ZXN0KG4pJiYodD1hKG4sITApKSYmKHQ9bi5pbmRleE9mKCIpIixuLmxlbmd0aC10KS1uLmxlbmd0aCkmJihlWzBdPWVbMF0uc2xpY2UoMCx0KSxlWzJdPW4uc2xpY2UoMCx0KSksZS5zbGljZSgwLDMpKX19LGZpbHRlcjp7VEFHOmZ1bmN0aW9uKGUpe3ZhciB0PWUucmVwbGFjZShaLGVlKS50b0xvd2VyQ2FzZSgpO3JldHVybiIqIj09PWU/ZnVuY3Rpb24oKXtyZXR1cm4hMH06ZnVuY3Rpb24oZSl7cmV0dXJuIGUubm9kZU5hbWUmJmUubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PXR9fSxDTEFTUzpmdW5jdGlvbihlKXt2YXIgdD1FW2UrIiAiXTtyZXR1cm4gdHx8KHQ9bmV3IFJlZ0V4cCgiKF58IitNKyIpIitlKyIoIitNKyJ8JCkiKSkmJkUoZSxmdW5jdGlvbihlKXtyZXR1cm4gdC50ZXN0KCJzdHJpbmciPT10eXBlb2YgZS5jbGFzc05hbWUmJmUuY2xhc3NOYW1lfHwidW5kZWZpbmVkIiE9dHlwZW9mIGUuZ2V0QXR0cmlidXRlJiZlLmdldEF0dHJpYnV0ZSgiY2xhc3MiKXx8IiIpfSl9LEFUVFI6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBmdW5jdGlvbihyKXt2YXIgaT1vZS5hdHRyKHIsZSk7cmV0dXJuIG51bGw9PWk/IiE9Ij09PXQ6IXR8fChpKz0iIiwiPSI9PT10P2k9PT1uOiIhPSI9PT10P2khPT1uOiJePSI9PT10P24mJjA9PT1pLmluZGV4T2Yobik6Iio9Ij09PXQ/biYmaS5pbmRleE9mKG4pPi0xOiIkPSI9PT10P24mJmkuc2xpY2UoLW4ubGVuZ3RoKT09PW46In49Ij09PXQ/KCIgIitpLnJlcGxhY2UoJCwiICIpKyIgIikuaW5kZXhPZihuKT4tMToifD0iPT09dCYmKGk9PT1ufHxpLnNsaWNlKDAsbi5sZW5ndGgrMSk9PT1uKyItIikpfX0sQ0hJTEQ6ZnVuY3Rpb24oZSx0LG4scixpKXt2YXIgbz0ibnRoIiE9PWUuc2xpY2UoMCwzKSxhPSJsYXN0IiE9PWUuc2xpY2UoLTQpLHM9Im9mLXR5cGUiPT09dDtyZXR1cm4gMT09PXImJjA9PT1pP2Z1bmN0aW9uKGUpe3JldHVybiEhZS5wYXJlbnROb2RlfTpmdW5jdGlvbih0LG4sdSl7dmFyIGwsYyxmLHAsZCxoLGc9byE9PWE/Im5leHRTaWJsaW5nIjoicHJldmlvdXNTaWJsaW5nIix5PXQucGFyZW50Tm9kZSx2PXMmJnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxtPSF1JiYhcyx4PSExO2lmKHkpe2lmKG8pe3doaWxlKGcpe3A9dDt3aGlsZShwPXBbZ10paWYocz9wLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT12OjE9PT1wLm5vZGVUeXBlKXJldHVybiExO2g9Zz0ib25seSI9PT1lJiYhaCYmIm5leHRTaWJsaW5nIn1yZXR1cm4hMH1pZihoPVthP3kuZmlyc3RDaGlsZDp5Lmxhc3RDaGlsZF0sYSYmbSl7eD0oZD0obD0oYz0oZj0ocD15KVtiXXx8KHBbYl09e30pKVtwLnVuaXF1ZUlEXXx8KGZbcC51bmlxdWVJRF09e30pKVtlXXx8W10pWzBdPT09VCYmbFsxXSkmJmxbMl0scD1kJiZ5LmNoaWxkTm9kZXNbZF07d2hpbGUocD0rK2QmJnAmJnBbZ118fCh4PWQ9MCl8fGgucG9wKCkpaWYoMT09PXAubm9kZVR5cGUmJisreCYmcD09PXQpe2NbZV09W1QsZCx4XTticmVha319ZWxzZSBpZihtJiYoeD1kPShsPShjPShmPShwPXQpW2JdfHwocFtiXT17fSkpW3AudW5pcXVlSURdfHwoZltwLnVuaXF1ZUlEXT17fSkpW2VdfHxbXSlbMF09PT1UJiZsWzFdKSwhMT09PXgpd2hpbGUocD0rK2QmJnAmJnBbZ118fCh4PWQ9MCl8fGgucG9wKCkpaWYoKHM/cC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09djoxPT09cC5ub2RlVHlwZSkmJisreCYmKG0mJigoYz0oZj1wW2JdfHwocFtiXT17fSkpW3AudW5pcXVlSURdfHwoZltwLnVuaXF1ZUlEXT17fSkpW2VdPVtULHhdKSxwPT09dCkpYnJlYWs7cmV0dXJuKHgtPWkpPT09cnx8eCVyPT0wJiZ4L3I+PTB9fX0sUFNFVURPOmZ1bmN0aW9uKGUsdCl7dmFyIG4saT1yLnBzZXVkb3NbZV18fHIuc2V0RmlsdGVyc1tlLnRvTG93ZXJDYXNlKCldfHxvZS5lcnJvcigidW5zdXBwb3J0ZWQgcHNldWRvOiAiK2UpO3JldHVybiBpW2JdP2kodCk6aS5sZW5ndGg+MT8obj1bZSxlLCIiLHRdLHIuc2V0RmlsdGVycy5oYXNPd25Qcm9wZXJ0eShlLnRvTG93ZXJDYXNlKCkpP3NlKGZ1bmN0aW9uKGUsbil7dmFyIHIsbz1pKGUsdCksYT1vLmxlbmd0aDt3aGlsZShhLS0pZVtyPU8oZSxvW2FdKV09IShuW3JdPW9bYV0pfSk6ZnVuY3Rpb24oZSl7cmV0dXJuIGkoZSwwLG4pfSk6aX19LHBzZXVkb3M6e25vdDpzZShmdW5jdGlvbihlKXt2YXIgdD1bXSxuPVtdLHI9cyhlLnJlcGxhY2UoQiwiJDEiKSk7cmV0dXJuIHJbYl0/c2UoZnVuY3Rpb24oZSx0LG4saSl7dmFyIG8sYT1yKGUsbnVsbCxpLFtdKSxzPWUubGVuZ3RoO3doaWxlKHMtLSkobz1hW3NdKSYmKGVbc109ISh0W3NdPW8pKX0pOmZ1bmN0aW9uKGUsaSxvKXtyZXR1cm4gdFswXT1lLHIodCxudWxsLG8sbiksdFswXT1udWxsLCFuLnBvcCgpfX0pLGhhczpzZShmdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24odCl7cmV0dXJuIG9lKGUsdCkubGVuZ3RoPjB9fSksY29udGFpbnM6c2UoZnVuY3Rpb24oZSl7cmV0dXJuIGU9ZS5yZXBsYWNlKFosZWUpLGZ1bmN0aW9uKHQpe3JldHVybih0LnRleHRDb250ZW50fHx0LmlubmVyVGV4dHx8aSh0KSkuaW5kZXhPZihlKT4tMX19KSxsYW5nOnNlKGZ1bmN0aW9uKGUpe3JldHVybiBVLnRlc3QoZXx8IiIpfHxvZS5lcnJvcigidW5zdXBwb3J0ZWQgbGFuZzogIitlKSxlPWUucmVwbGFjZShaLGVlKS50b0xvd2VyQ2FzZSgpLGZ1bmN0aW9uKHQpe3ZhciBuO2Rve2lmKG49Zz90Lmxhbmc6dC5nZXRBdHRyaWJ1dGUoInhtbDpsYW5nIil8fHQuZ2V0QXR0cmlidXRlKCJsYW5nIikpcmV0dXJuKG49bi50b0xvd2VyQ2FzZSgpKT09PWV8fDA9PT1uLmluZGV4T2YoZSsiLSIpfXdoaWxlKCh0PXQucGFyZW50Tm9kZSkmJjE9PT10Lm5vZGVUeXBlKTtyZXR1cm4hMX19KSx0YXJnZXQ6ZnVuY3Rpb24odCl7dmFyIG49ZS5sb2NhdGlvbiYmZS5sb2NhdGlvbi5oYXNoO3JldHVybiBuJiZuLnNsaWNlKDEpPT09dC5pZH0scm9vdDpmdW5jdGlvbihlKXtyZXR1cm4gZT09PWh9LGZvY3VzOmZ1bmN0aW9uKGUpe3JldHVybiBlPT09ZC5hY3RpdmVFbGVtZW50JiYoIWQuaGFzRm9jdXN8fGQuaGFzRm9jdXMoKSkmJiEhKGUudHlwZXx8ZS5ocmVmfHx+ZS50YWJJbmRleCl9LGVuYWJsZWQ6ZGUoITEpLGRpc2FibGVkOmRlKCEwKSxjaGVja2VkOmZ1bmN0aW9uKGUpe3ZhciB0PWUubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4iaW5wdXQiPT09dCYmISFlLmNoZWNrZWR8fCJvcHRpb24iPT09dCYmISFlLnNlbGVjdGVkfSxzZWxlY3RlZDpmdW5jdGlvbihlKXtyZXR1cm4gZS5wYXJlbnROb2RlJiZlLnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCwhMD09PWUuc2VsZWN0ZWR9LGVtcHR5OmZ1bmN0aW9uKGUpe2ZvcihlPWUuZmlyc3RDaGlsZDtlO2U9ZS5uZXh0U2libGluZylpZihlLm5vZGVUeXBlPDYpcmV0dXJuITE7cmV0dXJuITB9LHBhcmVudDpmdW5jdGlvbihlKXtyZXR1cm4hci5wc2V1ZG9zLmVtcHR5KGUpfSxoZWFkZXI6ZnVuY3Rpb24oZSl7cmV0dXJuIFkudGVzdChlLm5vZGVOYW1lKX0saW5wdXQ6ZnVuY3Rpb24oZSl7cmV0dXJuIEcudGVzdChlLm5vZGVOYW1lKX0sYnV0dG9uOmZ1bmN0aW9uKGUpe3ZhciB0PWUubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4iaW5wdXQiPT09dCYmImJ1dHRvbiI9PT1lLnR5cGV8fCJidXR0b24iPT09dH0sdGV4dDpmdW5jdGlvbihlKXt2YXIgdDtyZXR1cm4iaW5wdXQiPT09ZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpJiYidGV4dCI9PT1lLnR5cGUmJihudWxsPT0odD1lLmdldEF0dHJpYnV0ZSgidHlwZSIpKXx8InRleHQiPT09dC50b0xvd2VyQ2FzZSgpKX0sZmlyc3Q6aGUoZnVuY3Rpb24oKXtyZXR1cm5bMF19KSxsYXN0OmhlKGZ1bmN0aW9uKGUsdCl7cmV0dXJuW3QtMV19KSxlcTpoZShmdW5jdGlvbihlLHQsbil7cmV0dXJuW248MD9uK3Q6bl19KSxldmVuOmhlKGZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPTA7bjx0O24rPTIpZS5wdXNoKG4pO3JldHVybiBlfSksb2RkOmhlKGZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPTE7bjx0O24rPTIpZS5wdXNoKG4pO3JldHVybiBlfSksbHQ6aGUoZnVuY3Rpb24oZSx0LG4pe2Zvcih2YXIgcj1uPDA/bit0Om47LS1yPj0wOyllLnB1c2gocik7cmV0dXJuIGV9KSxndDpoZShmdW5jdGlvbihlLHQsbil7Zm9yKHZhciByPW48MD9uK3Q6bjsrK3I8dDspZS5wdXNoKHIpO3JldHVybiBlfSl9fSkucHNldWRvcy5udGg9ci5wc2V1ZG9zLmVxO2Zvcih0IGlue3JhZGlvOiEwLGNoZWNrYm94OiEwLGZpbGU6ITAscGFzc3dvcmQ6ITAsaW1hZ2U6ITB9KXIucHNldWRvc1t0XT1mZSh0KTtmb3IodCBpbntzdWJtaXQ6ITAscmVzZXQ6ITB9KXIucHNldWRvc1t0XT1wZSh0KTtmdW5jdGlvbiB5ZSgpe315ZS5wcm90b3R5cGU9ci5maWx0ZXJzPXIucHNldWRvcyxyLnNldEZpbHRlcnM9bmV3IHllLGE9b2UudG9rZW5pemU9ZnVuY3Rpb24oZSx0KXt2YXIgbixpLG8sYSxzLHUsbCxjPWtbZSsiICJdO2lmKGMpcmV0dXJuIHQ/MDpjLnNsaWNlKDApO3M9ZSx1PVtdLGw9ci5wcmVGaWx0ZXI7d2hpbGUocyl7biYmIShpPUYuZXhlYyhzKSl8fChpJiYocz1zLnNsaWNlKGlbMF0ubGVuZ3RoKXx8cyksdS5wdXNoKG89W10pKSxuPSExLChpPV8uZXhlYyhzKSkmJihuPWkuc2hpZnQoKSxvLnB1c2goe3ZhbHVlOm4sdHlwZTppWzBdLnJlcGxhY2UoQiwiICIpfSkscz1zLnNsaWNlKG4ubGVuZ3RoKSk7Zm9yKGEgaW4gci5maWx0ZXIpIShpPVZbYV0uZXhlYyhzKSl8fGxbYV0mJiEoaT1sW2FdKGkpKXx8KG49aS5zaGlmdCgpLG8ucHVzaCh7dmFsdWU6bix0eXBlOmEsbWF0Y2hlczppfSkscz1zLnNsaWNlKG4ubGVuZ3RoKSk7aWYoIW4pYnJlYWt9cmV0dXJuIHQ/cy5sZW5ndGg6cz9vZS5lcnJvcihlKTprKGUsdSkuc2xpY2UoMCl9O2Z1bmN0aW9uIHZlKGUpe2Zvcih2YXIgdD0wLG49ZS5sZW5ndGgscj0iIjt0PG47dCsrKXIrPWVbdF0udmFsdWU7cmV0dXJuIHJ9ZnVuY3Rpb24gbWUoZSx0LG4pe3ZhciByPXQuZGlyLGk9dC5uZXh0LG89aXx8cixhPW4mJiJwYXJlbnROb2RlIj09PW8scz1DKys7cmV0dXJuIHQuZmlyc3Q/ZnVuY3Rpb24odCxuLGkpe3doaWxlKHQ9dFtyXSlpZigxPT09dC5ub2RlVHlwZXx8YSlyZXR1cm4gZSh0LG4saSk7cmV0dXJuITF9OmZ1bmN0aW9uKHQsbix1KXt2YXIgbCxjLGYscD1bVCxzXTtpZih1KXt3aGlsZSh0PXRbcl0paWYoKDE9PT10Lm5vZGVUeXBlfHxhKSYmZSh0LG4sdSkpcmV0dXJuITB9ZWxzZSB3aGlsZSh0PXRbcl0paWYoMT09PXQubm9kZVR5cGV8fGEpaWYoZj10W2JdfHwodFtiXT17fSksYz1mW3QudW5pcXVlSURdfHwoZlt0LnVuaXF1ZUlEXT17fSksaSYmaT09PXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSl0PXRbcl18fHQ7ZWxzZXtpZigobD1jW29dKSYmbFswXT09PVQmJmxbMV09PT1zKXJldHVybiBwWzJdPWxbMl07aWYoY1tvXT1wLHBbMl09ZSh0LG4sdSkpcmV0dXJuITB9cmV0dXJuITF9fWZ1bmN0aW9uIHhlKGUpe3JldHVybiBlLmxlbmd0aD4xP2Z1bmN0aW9uKHQsbixyKXt2YXIgaT1lLmxlbmd0aDt3aGlsZShpLS0paWYoIWVbaV0odCxuLHIpKXJldHVybiExO3JldHVybiEwfTplWzBdfWZ1bmN0aW9uIGJlKGUsdCxuKXtmb3IodmFyIHI9MCxpPXQubGVuZ3RoO3I8aTtyKyspb2UoZSx0W3JdLG4pO3JldHVybiBufWZ1bmN0aW9uIHdlKGUsdCxuLHIsaSl7Zm9yKHZhciBvLGE9W10scz0wLHU9ZS5sZW5ndGgsbD1udWxsIT10O3M8dTtzKyspKG89ZVtzXSkmJihuJiYhbihvLHIsaSl8fChhLnB1c2gobyksbCYmdC5wdXNoKHMpKSk7cmV0dXJuIGF9ZnVuY3Rpb24gVGUoZSx0LG4scixpLG8pe3JldHVybiByJiYhcltiXSYmKHI9VGUocikpLGkmJiFpW2JdJiYoaT1UZShpLG8pKSxzZShmdW5jdGlvbihvLGEscyx1KXt2YXIgbCxjLGYscD1bXSxkPVtdLGg9YS5sZW5ndGgsZz1vfHxiZSh0fHwiKiIscy5ub2RlVHlwZT9bc106cyxbXSkseT0hZXx8IW8mJnQ/Zzp3ZShnLHAsZSxzLHUpLHY9bj9pfHwobz9lOmh8fHIpP1tdOmE6eTtpZihuJiZuKHksdixzLHUpLHIpe2w9d2UodixkKSxyKGwsW10scyx1KSxjPWwubGVuZ3RoO3doaWxlKGMtLSkoZj1sW2NdKSYmKHZbZFtjXV09ISh5W2RbY11dPWYpKX1pZihvKXtpZihpfHxlKXtpZihpKXtsPVtdLGM9di5sZW5ndGg7d2hpbGUoYy0tKShmPXZbY10pJiZsLnB1c2goeVtjXT1mKTtpKG51bGwsdj1bXSxsLHUpfWM9di5sZW5ndGg7d2hpbGUoYy0tKShmPXZbY10pJiYobD1pP08obyxmKTpwW2NdKT4tMSYmKG9bbF09IShhW2xdPWYpKX19ZWxzZSB2PXdlKHY9PT1hP3Yuc3BsaWNlKGgsdi5sZW5ndGgpOnYpLGk/aShudWxsLGEsdix1KTpMLmFwcGx5KGEsdil9KX1mdW5jdGlvbiBDZShlKXtmb3IodmFyIHQsbixpLG89ZS5sZW5ndGgsYT1yLnJlbGF0aXZlW2VbMF0udHlwZV0scz1hfHxyLnJlbGF0aXZlWyIgIl0sdT1hPzE6MCxjPW1lKGZ1bmN0aW9uKGUpe3JldHVybiBlPT09dH0scywhMCksZj1tZShmdW5jdGlvbihlKXtyZXR1cm4gTyh0LGUpPi0xfSxzLCEwKSxwPVtmdW5jdGlvbihlLG4scil7dmFyIGk9IWEmJihyfHxuIT09bCl8fCgodD1uKS5ub2RlVHlwZT9jKGUsbixyKTpmKGUsbixyKSk7cmV0dXJuIHQ9bnVsbCxpfV07dTxvO3UrKylpZihuPXIucmVsYXRpdmVbZVt1XS50eXBlXSlwPVttZSh4ZShwKSxuKV07ZWxzZXtpZigobj1yLmZpbHRlcltlW3VdLnR5cGVdLmFwcGx5KG51bGwsZVt1XS5tYXRjaGVzKSlbYl0pe2ZvcihpPSsrdTtpPG87aSsrKWlmKHIucmVsYXRpdmVbZVtpXS50eXBlXSlicmVhaztyZXR1cm4gVGUodT4xJiZ4ZShwKSx1PjEmJnZlKGUuc2xpY2UoMCx1LTEpLmNvbmNhdCh7dmFsdWU6IiAiPT09ZVt1LTJdLnR5cGU/IioiOiIifSkpLnJlcGxhY2UoQiwiJDEiKSxuLHU8aSYmQ2UoZS5zbGljZSh1LGkpKSxpPG8mJkNlKGU9ZS5zbGljZShpKSksaTxvJiZ2ZShlKSl9cC5wdXNoKG4pfXJldHVybiB4ZShwKX1mdW5jdGlvbiBFZShlLHQpe3ZhciBuPXQubGVuZ3RoPjAsaT1lLmxlbmd0aD4wLG89ZnVuY3Rpb24obyxhLHMsdSxjKXt2YXIgZixoLHksdj0wLG09IjAiLHg9byYmW10sYj1bXSx3PWwsQz1vfHxpJiZyLmZpbmQuVEFHKCIqIixjKSxFPVQrPW51bGw9PXc/MTpNYXRoLnJhbmRvbSgpfHwuMSxrPUMubGVuZ3RoO2ZvcihjJiYobD1hPT09ZHx8YXx8Yyk7bSE9PWsmJm51bGwhPShmPUNbbV0pO20rKyl7aWYoaSYmZil7aD0wLGF8fGYub3duZXJEb2N1bWVudD09PWR8fChwKGYpLHM9IWcpO3doaWxlKHk9ZVtoKytdKWlmKHkoZixhfHxkLHMpKXt1LnB1c2goZik7YnJlYWt9YyYmKFQ9RSl9biYmKChmPSF5JiZmKSYmdi0tLG8mJngucHVzaChmKSl9aWYodis9bSxuJiZtIT09dil7aD0wO3doaWxlKHk9dFtoKytdKXkoeCxiLGEscyk7aWYobyl7aWYodj4wKXdoaWxlKG0tLSl4W21dfHxiW21dfHwoYlttXT1qLmNhbGwodSkpO2I9d2UoYil9TC5hcHBseSh1LGIpLGMmJiFvJiZiLmxlbmd0aD4wJiZ2K3QubGVuZ3RoPjEmJm9lLnVuaXF1ZVNvcnQodSl9cmV0dXJuIGMmJihUPUUsbD13KSx4fTtyZXR1cm4gbj9zZShvKTpvfXJldHVybiBzPW9lLmNvbXBpbGU9ZnVuY3Rpb24oZSx0KXt2YXIgbixyPVtdLGk9W10sbz1TW2UrIiAiXTtpZighbyl7dHx8KHQ9YShlKSksbj10Lmxlbmd0aDt3aGlsZShuLS0pKG89Q2UodFtuXSkpW2JdP3IucHVzaChvKTppLnB1c2gobyk7KG89UyhlLEVlKGkscikpKS5zZWxlY3Rvcj1lfXJldHVybiBvfSx1PW9lLnNlbGVjdD1mdW5jdGlvbihlLHQsbixpKXt2YXIgbyx1LGwsYyxmLHA9ImZ1bmN0aW9uIj09dHlwZW9mIGUmJmUsZD0haSYmYShlPXAuc2VsZWN0b3J8fGUpO2lmKG49bnx8W10sMT09PWQubGVuZ3RoKXtpZigodT1kWzBdPWRbMF0uc2xpY2UoMCkpLmxlbmd0aD4yJiYiSUQiPT09KGw9dVswXSkudHlwZSYmOT09PXQubm9kZVR5cGUmJmcmJnIucmVsYXRpdmVbdVsxXS50eXBlXSl7aWYoISh0PShyLmZpbmQuSUQobC5tYXRjaGVzWzBdLnJlcGxhY2UoWixlZSksdCl8fFtdKVswXSkpcmV0dXJuIG47cCYmKHQ9dC5wYXJlbnROb2RlKSxlPWUuc2xpY2UodS5zaGlmdCgpLnZhbHVlLmxlbmd0aCl9bz1WLm5lZWRzQ29udGV4dC50ZXN0KGUpPzA6dS5sZW5ndGg7d2hpbGUoby0tKXtpZihsPXVbb10sci5yZWxhdGl2ZVtjPWwudHlwZV0pYnJlYWs7aWYoKGY9ci5maW5kW2NdKSYmKGk9ZihsLm1hdGNoZXNbMF0ucmVwbGFjZShaLGVlKSxLLnRlc3QodVswXS50eXBlKSYmZ2UodC5wYXJlbnROb2RlKXx8dCkpKXtpZih1LnNwbGljZShvLDEpLCEoZT1pLmxlbmd0aCYmdmUodSkpKXJldHVybiBMLmFwcGx5KG4saSksbjticmVha319fXJldHVybihwfHxzKGUsZCkpKGksdCwhZyxuLCF0fHxLLnRlc3QoZSkmJmdlKHQucGFyZW50Tm9kZSl8fHQpLG59LG4uc29ydFN0YWJsZT1iLnNwbGl0KCIiKS5zb3J0KEQpLmpvaW4oIiIpPT09YixuLmRldGVjdER1cGxpY2F0ZXM9ISFmLHAoKSxuLnNvcnREZXRhY2hlZD11ZShmdW5jdGlvbihlKXtyZXR1cm4gMSZlLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGQuY3JlYXRlRWxlbWVudCgiZmllbGRzZXQiKSl9KSx1ZShmdW5jdGlvbihlKXtyZXR1cm4gZS5pbm5lckhUTUw9IjxhIGhyZWY9JyMnPjwvYT4iLCIjIj09PWUuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoImhyZWYiKX0pfHxsZSgidHlwZXxocmVmfGhlaWdodHx3aWR0aCIsZnVuY3Rpb24oZSx0LG4pe2lmKCFuKXJldHVybiBlLmdldEF0dHJpYnV0ZSh0LCJ0eXBlIj09PXQudG9Mb3dlckNhc2UoKT8xOjIpfSksbi5hdHRyaWJ1dGVzJiZ1ZShmdW5jdGlvbihlKXtyZXR1cm4gZS5pbm5lckhUTUw9IjxpbnB1dC8+IixlLmZpcnN0Q2hpbGQuc2V0QXR0cmlidXRlKCJ2YWx1ZSIsIiIpLCIiPT09ZS5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSgidmFsdWUiKX0pfHxsZSgidmFsdWUiLGZ1bmN0aW9uKGUsdCxuKXtpZighbiYmImlucHV0Ij09PWUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSlyZXR1cm4gZS5kZWZhdWx0VmFsdWV9KSx1ZShmdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09ZS5nZXRBdHRyaWJ1dGUoImRpc2FibGVkIil9KXx8bGUoUCxmdW5jdGlvbihlLHQsbil7dmFyIHI7aWYoIW4pcmV0dXJuITA9PT1lW3RdP3QudG9Mb3dlckNhc2UoKToocj1lLmdldEF0dHJpYnV0ZU5vZGUodCkpJiZyLnNwZWNpZmllZD9yLnZhbHVlOm51bGx9KSxvZX0oZSk7dy5maW5kPUUsdy5leHByPUUuc2VsZWN0b3JzLHcuZXhwclsiOiJdPXcuZXhwci5wc2V1ZG9zLHcudW5pcXVlU29ydD13LnVuaXF1ZT1FLnVuaXF1ZVNvcnQsdy50ZXh0PUUuZ2V0VGV4dCx3LmlzWE1MRG9jPUUuaXNYTUwsdy5jb250YWlucz1FLmNvbnRhaW5zLHcuZXNjYXBlU2VsZWN0b3I9RS5lc2NhcGU7dmFyIGs9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPVtdLGk9dm9pZCAwIT09bjt3aGlsZSgoZT1lW3RdKSYmOSE9PWUubm9kZVR5cGUpaWYoMT09PWUubm9kZVR5cGUpe2lmKGkmJncoZSkuaXMobikpYnJlYWs7ci5wdXNoKGUpfXJldHVybiByfSxTPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPVtdO2U7ZT1lLm5leHRTaWJsaW5nKTE9PT1lLm5vZGVUeXBlJiZlIT09dCYmbi5wdXNoKGUpO3JldHVybiBufSxEPXcuZXhwci5tYXRjaC5uZWVkc0NvbnRleHQ7ZnVuY3Rpb24gTihlLHQpe3JldHVybiBlLm5vZGVOYW1lJiZlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT10LnRvTG93ZXJDYXNlKCl9dmFyIEE9L148KFthLXpdW15cL1wwPjpceDIwXHRcclxuXGZdKilbXHgyMFx0XHJcblxmXSpcLz8+KD86PFwvXDE+fCkkL2k7ZnVuY3Rpb24gaihlLHQsbil7cmV0dXJuIGcodCk/dy5ncmVwKGUsZnVuY3Rpb24oZSxyKXtyZXR1cm4hIXQuY2FsbChlLHIsZSkhPT1ufSk6dC5ub2RlVHlwZT93LmdyZXAoZSxmdW5jdGlvbihlKXtyZXR1cm4gZT09PXQhPT1ufSk6InN0cmluZyIhPXR5cGVvZiB0P3cuZ3JlcChlLGZ1bmN0aW9uKGUpe3JldHVybiB1LmNhbGwodCxlKT4tMSE9PW59KTp3LmZpbHRlcih0LGUsbil9dy5maWx0ZXI9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPXRbMF07cmV0dXJuIG4mJihlPSI6bm90KCIrZSsiKSIpLDE9PT10Lmxlbmd0aCYmMT09PXIubm9kZVR5cGU/dy5maW5kLm1hdGNoZXNTZWxlY3RvcihyLGUpP1tyXTpbXTp3LmZpbmQubWF0Y2hlcyhlLHcuZ3JlcCh0LGZ1bmN0aW9uKGUpe3JldHVybiAxPT09ZS5ub2RlVHlwZX0pKX0sdy5mbi5leHRlbmQoe2ZpbmQ6ZnVuY3Rpb24oZSl7dmFyIHQsbixyPXRoaXMubGVuZ3RoLGk9dGhpcztpZigic3RyaW5nIiE9dHlwZW9mIGUpcmV0dXJuIHRoaXMucHVzaFN0YWNrKHcoZSkuZmlsdGVyKGZ1bmN0aW9uKCl7Zm9yKHQ9MDt0PHI7dCsrKWlmKHcuY29udGFpbnMoaVt0XSx0aGlzKSlyZXR1cm4hMH0pKTtmb3Iobj10aGlzLnB1c2hTdGFjayhbXSksdD0wO3Q8cjt0Kyspdy5maW5kKGUsaVt0XSxuKTtyZXR1cm4gcj4xP3cudW5pcXVlU29ydChuKTpufSxmaWx0ZXI6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGoodGhpcyxlfHxbXSwhMSkpfSxub3Q6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGoodGhpcyxlfHxbXSwhMCkpfSxpczpmdW5jdGlvbihlKXtyZXR1cm4hIWoodGhpcywic3RyaW5nIj09dHlwZW9mIGUmJkQudGVzdChlKT93KGUpOmV8fFtdLCExKS5sZW5ndGh9fSk7dmFyIHEsTD0vXig/OlxzKig8W1x3XFddKz4pW14+XSp8IyhbXHctXSspKSQvOyh3LmZuLmluaXQ9ZnVuY3Rpb24oZSx0LG4pe3ZhciBpLG87aWYoIWUpcmV0dXJuIHRoaXM7aWYobj1ufHxxLCJzdHJpbmciPT10eXBlb2YgZSl7aWYoIShpPSI8Ij09PWVbMF0mJiI+Ij09PWVbZS5sZW5ndGgtMV0mJmUubGVuZ3RoPj0zP1tudWxsLGUsbnVsbF06TC5leGVjKGUpKXx8IWlbMV0mJnQpcmV0dXJuIXR8fHQuanF1ZXJ5Pyh0fHxuKS5maW5kKGUpOnRoaXMuY29uc3RydWN0b3IodCkuZmluZChlKTtpZihpWzFdKXtpZih0PXQgaW5zdGFuY2VvZiB3P3RbMF06dCx3Lm1lcmdlKHRoaXMsdy5wYXJzZUhUTUwoaVsxXSx0JiZ0Lm5vZGVUeXBlP3Qub3duZXJEb2N1bWVudHx8dDpyLCEwKSksQS50ZXN0KGlbMV0pJiZ3LmlzUGxhaW5PYmplY3QodCkpZm9yKGkgaW4gdClnKHRoaXNbaV0pP3RoaXNbaV0odFtpXSk6dGhpcy5hdHRyKGksdFtpXSk7cmV0dXJuIHRoaXN9cmV0dXJuKG89ci5nZXRFbGVtZW50QnlJZChpWzJdKSkmJih0aGlzWzBdPW8sdGhpcy5sZW5ndGg9MSksdGhpc31yZXR1cm4gZS5ub2RlVHlwZT8odGhpc1swXT1lLHRoaXMubGVuZ3RoPTEsdGhpcyk6ZyhlKT92b2lkIDAhPT1uLnJlYWR5P24ucmVhZHkoZSk6ZSh3KTp3Lm1ha2VBcnJheShlLHRoaXMpfSkucHJvdG90eXBlPXcuZm4scT13KHIpO3ZhciBIPS9eKD86cGFyZW50c3xwcmV2KD86VW50aWx8QWxsKSkvLE89e2NoaWxkcmVuOiEwLGNvbnRlbnRzOiEwLG5leHQ6ITAscHJldjohMH07dy5mbi5leHRlbmQoe2hhczpmdW5jdGlvbihlKXt2YXIgdD13KGUsdGhpcyksbj10Lmxlbmd0aDtyZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24oKXtmb3IodmFyIGU9MDtlPG47ZSsrKWlmKHcuY29udGFpbnModGhpcyx0W2VdKSlyZXR1cm4hMH0pfSxjbG9zZXN0OmZ1bmN0aW9uKGUsdCl7dmFyIG4scj0wLGk9dGhpcy5sZW5ndGgsbz1bXSxhPSJzdHJpbmciIT10eXBlb2YgZSYmdyhlKTtpZighRC50ZXN0KGUpKWZvcig7cjxpO3IrKylmb3Iobj10aGlzW3JdO24mJm4hPT10O249bi5wYXJlbnROb2RlKWlmKG4ubm9kZVR5cGU8MTEmJihhP2EuaW5kZXgobik+LTE6MT09PW4ubm9kZVR5cGUmJncuZmluZC5tYXRjaGVzU2VsZWN0b3IobixlKSkpe28ucHVzaChuKTticmVha31yZXR1cm4gdGhpcy5wdXNoU3RhY2soby5sZW5ndGg+MT93LnVuaXF1ZVNvcnQobyk6byl9LGluZGV4OmZ1bmN0aW9uKGUpe3JldHVybiBlPyJzdHJpbmciPT10eXBlb2YgZT91LmNhbGwodyhlKSx0aGlzWzBdKTp1LmNhbGwodGhpcyxlLmpxdWVyeT9lWzBdOmUpOnRoaXNbMF0mJnRoaXNbMF0ucGFyZW50Tm9kZT90aGlzLmZpcnN0KCkucHJldkFsbCgpLmxlbmd0aDotMX0sYWRkOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKHcudW5pcXVlU29ydCh3Lm1lcmdlKHRoaXMuZ2V0KCksdyhlLHQpKSkpfSxhZGRCYWNrOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmFkZChudWxsPT1lP3RoaXMucHJldk9iamVjdDp0aGlzLnByZXZPYmplY3QuZmlsdGVyKGUpKX19KTtmdW5jdGlvbiBQKGUsdCl7d2hpbGUoKGU9ZVt0XSkmJjEhPT1lLm5vZGVUeXBlKTtyZXR1cm4gZX13LmVhY2goe3BhcmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLnBhcmVudE5vZGU7cmV0dXJuIHQmJjExIT09dC5ub2RlVHlwZT90Om51bGx9LHBhcmVudHM6ZnVuY3Rpb24oZSl7cmV0dXJuIGsoZSwicGFyZW50Tm9kZSIpfSxwYXJlbnRzVW50aWw6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBrKGUsInBhcmVudE5vZGUiLG4pfSxuZXh0OmZ1bmN0aW9uKGUpe3JldHVybiBQKGUsIm5leHRTaWJsaW5nIil9LHByZXY6ZnVuY3Rpb24oZSl7cmV0dXJuIFAoZSwicHJldmlvdXNTaWJsaW5nIil9LG5leHRBbGw6ZnVuY3Rpb24oZSl7cmV0dXJuIGsoZSwibmV4dFNpYmxpbmciKX0scHJldkFsbDpmdW5jdGlvbihlKXtyZXR1cm4gayhlLCJwcmV2aW91c1NpYmxpbmciKX0sbmV4dFVudGlsOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gayhlLCJuZXh0U2libGluZyIsbil9LHByZXZVbnRpbDpmdW5jdGlvbihlLHQsbil7cmV0dXJuIGsoZSwicHJldmlvdXNTaWJsaW5nIixuKX0sc2libGluZ3M6ZnVuY3Rpb24oZSl7cmV0dXJuIFMoKGUucGFyZW50Tm9kZXx8e30pLmZpcnN0Q2hpbGQsZSl9LGNoaWxkcmVuOmZ1bmN0aW9uKGUpe3JldHVybiBTKGUuZmlyc3RDaGlsZCl9LGNvbnRlbnRzOmZ1bmN0aW9uKGUpe3JldHVybiBOKGUsImlmcmFtZSIpP2UuY29udGVudERvY3VtZW50OihOKGUsInRlbXBsYXRlIikmJihlPWUuY29udGVudHx8ZSksdy5tZXJnZShbXSxlLmNoaWxkTm9kZXMpKX19LGZ1bmN0aW9uKGUsdCl7dy5mbltlXT1mdW5jdGlvbihuLHIpe3ZhciBpPXcubWFwKHRoaXMsdCxuKTtyZXR1cm4iVW50aWwiIT09ZS5zbGljZSgtNSkmJihyPW4pLHImJiJzdHJpbmciPT10eXBlb2YgciYmKGk9dy5maWx0ZXIocixpKSksdGhpcy5sZW5ndGg+MSYmKE9bZV18fHcudW5pcXVlU29ydChpKSxILnRlc3QoZSkmJmkucmV2ZXJzZSgpKSx0aGlzLnB1c2hTdGFjayhpKX19KTt2YXIgTT0vW15ceDIwXHRcclxuXGZdKy9nO2Z1bmN0aW9uIFIoZSl7dmFyIHQ9e307cmV0dXJuIHcuZWFjaChlLm1hdGNoKE0pfHxbXSxmdW5jdGlvbihlLG4pe3Rbbl09ITB9KSx0fXcuQ2FsbGJhY2tzPWZ1bmN0aW9uKGUpe2U9InN0cmluZyI9PXR5cGVvZiBlP1IoZSk6dy5leHRlbmQoe30sZSk7dmFyIHQsbixyLGksbz1bXSxhPVtdLHM9LTEsdT1mdW5jdGlvbigpe2ZvcihpPWl8fGUub25jZSxyPXQ9ITA7YS5sZW5ndGg7cz0tMSl7bj1hLnNoaWZ0KCk7d2hpbGUoKytzPG8ubGVuZ3RoKSExPT09b1tzXS5hcHBseShuWzBdLG5bMV0pJiZlLnN0b3BPbkZhbHNlJiYocz1vLmxlbmd0aCxuPSExKX1lLm1lbW9yeXx8KG49ITEpLHQ9ITEsaSYmKG89bj9bXToiIil9LGw9e2FkZDpmdW5jdGlvbigpe3JldHVybiBvJiYobiYmIXQmJihzPW8ubGVuZ3RoLTEsYS5wdXNoKG4pKSxmdW5jdGlvbiB0KG4pe3cuZWFjaChuLGZ1bmN0aW9uKG4scil7ZyhyKT9lLnVuaXF1ZSYmbC5oYXMocil8fG8ucHVzaChyKTpyJiZyLmxlbmd0aCYmInN0cmluZyIhPT14KHIpJiZ0KHIpfSl9KGFyZ3VtZW50cyksbiYmIXQmJnUoKSksdGhpc30scmVtb3ZlOmZ1bmN0aW9uKCl7cmV0dXJuIHcuZWFjaChhcmd1bWVudHMsZnVuY3Rpb24oZSx0KXt2YXIgbjt3aGlsZSgobj13LmluQXJyYXkodCxvLG4pKT4tMSlvLnNwbGljZShuLDEpLG48PXMmJnMtLX0pLHRoaXN9LGhhczpmdW5jdGlvbihlKXtyZXR1cm4gZT93LmluQXJyYXkoZSxvKT4tMTpvLmxlbmd0aD4wfSxlbXB0eTpmdW5jdGlvbigpe3JldHVybiBvJiYobz1bXSksdGhpc30sZGlzYWJsZTpmdW5jdGlvbigpe3JldHVybiBpPWE9W10sbz1uPSIiLHRoaXN9LGRpc2FibGVkOmZ1bmN0aW9uKCl7cmV0dXJuIW99LGxvY2s6ZnVuY3Rpb24oKXtyZXR1cm4gaT1hPVtdLG58fHR8fChvPW49IiIpLHRoaXN9LGxvY2tlZDpmdW5jdGlvbigpe3JldHVybiEhaX0sZmlyZVdpdGg6ZnVuY3Rpb24oZSxuKXtyZXR1cm4gaXx8KG49W2UsKG49bnx8W10pLnNsaWNlP24uc2xpY2UoKTpuXSxhLnB1c2gobiksdHx8dSgpKSx0aGlzfSxmaXJlOmZ1bmN0aW9uKCl7cmV0dXJuIGwuZmlyZVdpdGgodGhpcyxhcmd1bWVudHMpLHRoaXN9LGZpcmVkOmZ1bmN0aW9uKCl7cmV0dXJuISFyfX07cmV0dXJuIGx9O2Z1bmN0aW9uIEkoZSl7cmV0dXJuIGV9ZnVuY3Rpb24gVyhlKXt0aHJvdyBlfWZ1bmN0aW9uICQoZSx0LG4scil7dmFyIGk7dHJ5e2UmJmcoaT1lLnByb21pc2UpP2kuY2FsbChlKS5kb25lKHQpLmZhaWwobik6ZSYmZyhpPWUudGhlbik/aS5jYWxsKGUsdCxuKTp0LmFwcGx5KHZvaWQgMCxbZV0uc2xpY2UocikpfWNhdGNoKGUpe24uYXBwbHkodm9pZCAwLFtlXSl9fXcuZXh0ZW5kKHtEZWZlcnJlZDpmdW5jdGlvbih0KXt2YXIgbj1bWyJub3RpZnkiLCJwcm9ncmVzcyIsdy5DYWxsYmFja3MoIm1lbW9yeSIpLHcuQ2FsbGJhY2tzKCJtZW1vcnkiKSwyXSxbInJlc29sdmUiLCJkb25lIix3LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSx3LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwwLCJyZXNvbHZlZCJdLFsicmVqZWN0IiwiZmFpbCIsdy5DYWxsYmFja3MoIm9uY2UgbWVtb3J5Iiksdy5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IiksMSwicmVqZWN0ZWQiXV0scj0icGVuZGluZyIsaT17c3RhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gcn0sYWx3YXlzOmZ1bmN0aW9uKCl7cmV0dXJuIG8uZG9uZShhcmd1bWVudHMpLmZhaWwoYXJndW1lbnRzKSx0aGlzfSwiY2F0Y2giOmZ1bmN0aW9uKGUpe3JldHVybiBpLnRoZW4obnVsbCxlKX0scGlwZTpmdW5jdGlvbigpe3ZhciBlPWFyZ3VtZW50cztyZXR1cm4gdy5EZWZlcnJlZChmdW5jdGlvbih0KXt3LmVhY2gobixmdW5jdGlvbihuLHIpe3ZhciBpPWcoZVtyWzRdXSkmJmVbcls0XV07b1tyWzFdXShmdW5jdGlvbigpe3ZhciBlPWkmJmkuYXBwbHkodGhpcyxhcmd1bWVudHMpO2UmJmcoZS5wcm9taXNlKT9lLnByb21pc2UoKS5wcm9ncmVzcyh0Lm5vdGlmeSkuZG9uZSh0LnJlc29sdmUpLmZhaWwodC5yZWplY3QpOnRbclswXSsiV2l0aCJdKHRoaXMsaT9bZV06YXJndW1lbnRzKX0pfSksZT1udWxsfSkucHJvbWlzZSgpfSx0aGVuOmZ1bmN0aW9uKHQscixpKXt2YXIgbz0wO2Z1bmN0aW9uIGEodCxuLHIsaSl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIHM9dGhpcyx1PWFyZ3VtZW50cyxsPWZ1bmN0aW9uKCl7dmFyIGUsbDtpZighKHQ8bykpe2lmKChlPXIuYXBwbHkocyx1KSk9PT1uLnByb21pc2UoKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJUaGVuYWJsZSBzZWxmLXJlc29sdXRpb24iKTtsPWUmJigib2JqZWN0Ij09dHlwZW9mIGV8fCJmdW5jdGlvbiI9PXR5cGVvZiBlKSYmZS50aGVuLGcobCk/aT9sLmNhbGwoZSxhKG8sbixJLGkpLGEobyxuLFcsaSkpOihvKyssbC5jYWxsKGUsYShvLG4sSSxpKSxhKG8sbixXLGkpLGEobyxuLEksbi5ub3RpZnlXaXRoKSkpOihyIT09SSYmKHM9dm9pZCAwLHU9W2VdKSwoaXx8bi5yZXNvbHZlV2l0aCkocyx1KSl9fSxjPWk/bDpmdW5jdGlvbigpe3RyeXtsKCl9Y2F0Y2goZSl7dy5EZWZlcnJlZC5leGNlcHRpb25Ib29rJiZ3LkRlZmVycmVkLmV4Y2VwdGlvbkhvb2soZSxjLnN0YWNrVHJhY2UpLHQrMT49byYmKHIhPT1XJiYocz12b2lkIDAsdT1bZV0pLG4ucmVqZWN0V2l0aChzLHUpKX19O3Q/YygpOih3LkRlZmVycmVkLmdldFN0YWNrSG9vayYmKGMuc3RhY2tUcmFjZT13LkRlZmVycmVkLmdldFN0YWNrSG9vaygpKSxlLnNldFRpbWVvdXQoYykpfX1yZXR1cm4gdy5EZWZlcnJlZChmdW5jdGlvbihlKXtuWzBdWzNdLmFkZChhKDAsZSxnKGkpP2k6SSxlLm5vdGlmeVdpdGgpKSxuWzFdWzNdLmFkZChhKDAsZSxnKHQpP3Q6SSkpLG5bMl1bM10uYWRkKGEoMCxlLGcocik/cjpXKSl9KS5wcm9taXNlKCl9LHByb21pc2U6ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPWU/dy5leHRlbmQoZSxpKTppfX0sbz17fTtyZXR1cm4gdy5lYWNoKG4sZnVuY3Rpb24oZSx0KXt2YXIgYT10WzJdLHM9dFs1XTtpW3RbMV1dPWEuYWRkLHMmJmEuYWRkKGZ1bmN0aW9uKCl7cj1zfSxuWzMtZV1bMl0uZGlzYWJsZSxuWzMtZV1bM10uZGlzYWJsZSxuWzBdWzJdLmxvY2ssblswXVszXS5sb2NrKSxhLmFkZCh0WzNdLmZpcmUpLG9bdFswXV09ZnVuY3Rpb24oKXtyZXR1cm4gb1t0WzBdKyJXaXRoIl0odGhpcz09PW8/dm9pZCAwOnRoaXMsYXJndW1lbnRzKSx0aGlzfSxvW3RbMF0rIldpdGgiXT1hLmZpcmVXaXRofSksaS5wcm9taXNlKG8pLHQmJnQuY2FsbChvLG8pLG99LHdoZW46ZnVuY3Rpb24oZSl7dmFyIHQ9YXJndW1lbnRzLmxlbmd0aCxuPXQscj1BcnJheShuKSxpPW8uY2FsbChhcmd1bWVudHMpLGE9dy5EZWZlcnJlZCgpLHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKG4pe3JbZV09dGhpcyxpW2VdPWFyZ3VtZW50cy5sZW5ndGg+MT9vLmNhbGwoYXJndW1lbnRzKTpuLC0tdHx8YS5yZXNvbHZlV2l0aChyLGkpfX07aWYodDw9MSYmKCQoZSxhLmRvbmUocyhuKSkucmVzb2x2ZSxhLnJlamVjdCwhdCksInBlbmRpbmciPT09YS5zdGF0ZSgpfHxnKGlbbl0mJmlbbl0udGhlbikpKXJldHVybiBhLnRoZW4oKTt3aGlsZShuLS0pJChpW25dLHMobiksYS5yZWplY3QpO3JldHVybiBhLnByb21pc2UoKX19KTt2YXIgQj0vXihFdmFsfEludGVybmFsfFJhbmdlfFJlZmVyZW5jZXxTeW50YXh8VHlwZXxVUkkpRXJyb3IkLzt3LkRlZmVycmVkLmV4Y2VwdGlvbkhvb2s9ZnVuY3Rpb24odCxuKXtlLmNvbnNvbGUmJmUuY29uc29sZS53YXJuJiZ0JiZCLnRlc3QodC5uYW1lKSYmZS5jb25zb2xlLndhcm4oImpRdWVyeS5EZWZlcnJlZCBleGNlcHRpb246ICIrdC5tZXNzYWdlLHQuc3RhY2ssbil9LHcucmVhZHlFeGNlcHRpb249ZnVuY3Rpb24odCl7ZS5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dGhyb3cgdH0pfTt2YXIgRj13LkRlZmVycmVkKCk7dy5mbi5yZWFkeT1mdW5jdGlvbihlKXtyZXR1cm4gRi50aGVuKGUpWyJjYXRjaCJdKGZ1bmN0aW9uKGUpe3cucmVhZHlFeGNlcHRpb24oZSl9KSx0aGlzfSx3LmV4dGVuZCh7aXNSZWFkeTohMSxyZWFkeVdhaXQ6MSxyZWFkeTpmdW5jdGlvbihlKXsoITA9PT1lPy0tdy5yZWFkeVdhaXQ6dy5pc1JlYWR5KXx8KHcuaXNSZWFkeT0hMCwhMCE9PWUmJi0tdy5yZWFkeVdhaXQ+MHx8Ri5yZXNvbHZlV2l0aChyLFt3XSkpfX0pLHcucmVhZHkudGhlbj1GLnRoZW47ZnVuY3Rpb24gXygpe3IucmVtb3ZlRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsXyksZS5yZW1vdmVFdmVudExpc3RlbmVyKCJsb2FkIixfKSx3LnJlYWR5KCl9ImNvbXBsZXRlIj09PXIucmVhZHlTdGF0ZXx8ImxvYWRpbmciIT09ci5yZWFkeVN0YXRlJiYhci5kb2N1bWVudEVsZW1lbnQuZG9TY3JvbGw/ZS5zZXRUaW1lb3V0KHcucmVhZHkpOihyLmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLF8pLGUuYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsXykpO3ZhciB6PWZ1bmN0aW9uKGUsdCxuLHIsaSxvLGEpe3ZhciBzPTAsdT1lLmxlbmd0aCxsPW51bGw9PW47aWYoIm9iamVjdCI9PT14KG4pKXtpPSEwO2ZvcihzIGluIG4peihlLHQscyxuW3NdLCEwLG8sYSl9ZWxzZSBpZih2b2lkIDAhPT1yJiYoaT0hMCxnKHIpfHwoYT0hMCksbCYmKGE/KHQuY2FsbChlLHIpLHQ9bnVsbCk6KGw9dCx0PWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gbC5jYWxsKHcoZSksbil9KSksdCkpZm9yKDtzPHU7cysrKXQoZVtzXSxuLGE/cjpyLmNhbGwoZVtzXSxzLHQoZVtzXSxuKSkpO3JldHVybiBpP2U6bD90LmNhbGwoZSk6dT90KGVbMF0sbik6b30sWD0vXi1tcy0vLFU9Ly0oW2Etel0pL2c7ZnVuY3Rpb24gVihlLHQpe3JldHVybiB0LnRvVXBwZXJDYXNlKCl9ZnVuY3Rpb24gRyhlKXtyZXR1cm4gZS5yZXBsYWNlKFgsIm1zLSIpLnJlcGxhY2UoVSxWKX12YXIgWT1mdW5jdGlvbihlKXtyZXR1cm4gMT09PWUubm9kZVR5cGV8fDk9PT1lLm5vZGVUeXBlfHwhK2Uubm9kZVR5cGV9O2Z1bmN0aW9uIFEoKXt0aGlzLmV4cGFuZG89dy5leHBhbmRvK1EudWlkKyt9US51aWQ9MSxRLnByb3RvdHlwZT17Y2FjaGU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZVt0aGlzLmV4cGFuZG9dO3JldHVybiB0fHwodD17fSxZKGUpJiYoZS5ub2RlVHlwZT9lW3RoaXMuZXhwYW5kb109dDpPYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0aGlzLmV4cGFuZG8se3ZhbHVlOnQsY29uZmlndXJhYmxlOiEwfSkpKSx0fSxzZXQ6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGk9dGhpcy5jYWNoZShlKTtpZigic3RyaW5nIj09dHlwZW9mIHQpaVtHKHQpXT1uO2Vsc2UgZm9yKHIgaW4gdClpW0cocildPXRbcl07cmV0dXJuIGl9LGdldDpmdW5jdGlvbihlLHQpe3JldHVybiB2b2lkIDA9PT10P3RoaXMuY2FjaGUoZSk6ZVt0aGlzLmV4cGFuZG9dJiZlW3RoaXMuZXhwYW5kb11bRyh0KV19LGFjY2VzczpmdW5jdGlvbihlLHQsbil7cmV0dXJuIHZvaWQgMD09PXR8fHQmJiJzdHJpbmciPT10eXBlb2YgdCYmdm9pZCAwPT09bj90aGlzLmdldChlLHQpOih0aGlzLnNldChlLHQsbiksdm9pZCAwIT09bj9uOnQpfSxyZW1vdmU6ZnVuY3Rpb24oZSx0KXt2YXIgbixyPWVbdGhpcy5leHBhbmRvXTtpZih2b2lkIDAhPT1yKXtpZih2b2lkIDAhPT10KXtuPSh0PUFycmF5LmlzQXJyYXkodCk/dC5tYXAoRyk6KHQ9Ryh0KSlpbiByP1t0XTp0Lm1hdGNoKE0pfHxbXSkubGVuZ3RoO3doaWxlKG4tLSlkZWxldGUgclt0W25dXX0odm9pZCAwPT09dHx8dy5pc0VtcHR5T2JqZWN0KHIpKSYmKGUubm9kZVR5cGU/ZVt0aGlzLmV4cGFuZG9dPXZvaWQgMDpkZWxldGUgZVt0aGlzLmV4cGFuZG9dKX19LGhhc0RhdGE6ZnVuY3Rpb24oZSl7dmFyIHQ9ZVt0aGlzLmV4cGFuZG9dO3JldHVybiB2b2lkIDAhPT10JiYhdy5pc0VtcHR5T2JqZWN0KHQpfX07dmFyIEo9bmV3IFEsSz1uZXcgUSxaPS9eKD86XHtbXHdcV10qXH18XFtbXHdcV10qXF0pJC8sZWU9L1tBLVpdL2c7ZnVuY3Rpb24gdGUoZSl7cmV0dXJuInRydWUiPT09ZXx8ImZhbHNlIiE9PWUmJigibnVsbCI9PT1lP251bGw6ZT09PStlKyIiPytlOloudGVzdChlKT9KU09OLnBhcnNlKGUpOmUpfWZ1bmN0aW9uIG5lKGUsdCxuKXt2YXIgcjtpZih2b2lkIDA9PT1uJiYxPT09ZS5ub2RlVHlwZSlpZihyPSJkYXRhLSIrdC5yZXBsYWNlKGVlLCItJCYiKS50b0xvd2VyQ2FzZSgpLCJzdHJpbmciPT10eXBlb2Yobj1lLmdldEF0dHJpYnV0ZShyKSkpe3RyeXtuPXRlKG4pfWNhdGNoKGUpe31LLnNldChlLHQsbil9ZWxzZSBuPXZvaWQgMDtyZXR1cm4gbn13LmV4dGVuZCh7aGFzRGF0YTpmdW5jdGlvbihlKXtyZXR1cm4gSy5oYXNEYXRhKGUpfHxKLmhhc0RhdGEoZSl9LGRhdGE6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBLLmFjY2VzcyhlLHQsbil9LHJlbW92ZURhdGE6ZnVuY3Rpb24oZSx0KXtLLnJlbW92ZShlLHQpfSxfZGF0YTpmdW5jdGlvbihlLHQsbil7cmV0dXJuIEouYWNjZXNzKGUsdCxuKX0sX3JlbW92ZURhdGE6ZnVuY3Rpb24oZSx0KXtKLnJlbW92ZShlLHQpfX0pLHcuZm4uZXh0ZW5kKHtkYXRhOmZ1bmN0aW9uKGUsdCl7dmFyIG4scixpLG89dGhpc1swXSxhPW8mJm8uYXR0cmlidXRlcztpZih2b2lkIDA9PT1lKXtpZih0aGlzLmxlbmd0aCYmKGk9Sy5nZXQobyksMT09PW8ubm9kZVR5cGUmJiFKLmdldChvLCJoYXNEYXRhQXR0cnMiKSkpe249YS5sZW5ndGg7d2hpbGUobi0tKWFbbl0mJjA9PT0ocj1hW25dLm5hbWUpLmluZGV4T2YoImRhdGEtIikmJihyPUcoci5zbGljZSg1KSksbmUobyxyLGlbcl0pKTtKLnNldChvLCJoYXNEYXRhQXR0cnMiLCEwKX1yZXR1cm4gaX1yZXR1cm4ib2JqZWN0Ij09dHlwZW9mIGU/dGhpcy5lYWNoKGZ1bmN0aW9uKCl7Sy5zZXQodGhpcyxlKX0pOnoodGhpcyxmdW5jdGlvbih0KXt2YXIgbjtpZihvJiZ2b2lkIDA9PT10KXtpZih2b2lkIDAhPT0obj1LLmdldChvLGUpKSlyZXR1cm4gbjtpZih2b2lkIDAhPT0obj1uZShvLGUpKSlyZXR1cm4gbn1lbHNlIHRoaXMuZWFjaChmdW5jdGlvbigpe0suc2V0KHRoaXMsZSx0KX0pfSxudWxsLHQsYXJndW1lbnRzLmxlbmd0aD4xLG51bGwsITApfSxyZW1vdmVEYXRhOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtLLnJlbW92ZSh0aGlzLGUpfSl9fSksdy5leHRlbmQoe3F1ZXVlOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcjtpZihlKXJldHVybiB0PSh0fHwiZngiKSsicXVldWUiLHI9Si5nZXQoZSx0KSxuJiYoIXJ8fEFycmF5LmlzQXJyYXkobik/cj1KLmFjY2VzcyhlLHQsdy5tYWtlQXJyYXkobikpOnIucHVzaChuKSkscnx8W119LGRlcXVldWU6ZnVuY3Rpb24oZSx0KXt0PXR8fCJmeCI7dmFyIG49dy5xdWV1ZShlLHQpLHI9bi5sZW5ndGgsaT1uLnNoaWZ0KCksbz13Ll9xdWV1ZUhvb2tzKGUsdCksYT1mdW5jdGlvbigpe3cuZGVxdWV1ZShlLHQpfTsiaW5wcm9ncmVzcyI9PT1pJiYoaT1uLnNoaWZ0KCksci0tKSxpJiYoImZ4Ij09PXQmJm4udW5zaGlmdCgiaW5wcm9ncmVzcyIpLGRlbGV0ZSBvLnN0b3AsaS5jYWxsKGUsYSxvKSksIXImJm8mJm8uZW1wdHkuZmlyZSgpfSxfcXVldWVIb29rczpmdW5jdGlvbihlLHQpe3ZhciBuPXQrInF1ZXVlSG9va3MiO3JldHVybiBKLmdldChlLG4pfHxKLmFjY2VzcyhlLG4se2VtcHR5OncuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLmFkZChmdW5jdGlvbigpe0oucmVtb3ZlKGUsW3QrInF1ZXVlIixuXSl9KX0pfX0pLHcuZm4uZXh0ZW5kKHtxdWV1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPTI7cmV0dXJuInN0cmluZyIhPXR5cGVvZiBlJiYodD1lLGU9ImZ4IixuLS0pLGFyZ3VtZW50cy5sZW5ndGg8bj93LnF1ZXVlKHRoaXNbMF0sZSk6dm9pZCAwPT09dD90aGlzOnRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBuPXcucXVldWUodGhpcyxlLHQpO3cuX3F1ZXVlSG9va3ModGhpcyxlKSwiZngiPT09ZSYmImlucHJvZ3Jlc3MiIT09blswXSYmdy5kZXF1ZXVlKHRoaXMsZSl9KX0sZGVxdWV1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dy5kZXF1ZXVlKHRoaXMsZSl9KX0sY2xlYXJRdWV1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5xdWV1ZShlfHwiZngiLFtdKX0scHJvbWlzZTpmdW5jdGlvbihlLHQpe3ZhciBuLHI9MSxpPXcuRGVmZXJyZWQoKSxvPXRoaXMsYT10aGlzLmxlbmd0aCxzPWZ1bmN0aW9uKCl7LS1yfHxpLnJlc29sdmVXaXRoKG8sW29dKX07InN0cmluZyIhPXR5cGVvZiBlJiYodD1lLGU9dm9pZCAwKSxlPWV8fCJmeCI7d2hpbGUoYS0tKShuPUouZ2V0KG9bYV0sZSsicXVldWVIb29rcyIpKSYmbi5lbXB0eSYmKHIrKyxuLmVtcHR5LmFkZChzKSk7cmV0dXJuIHMoKSxpLnByb21pc2UodCl9fSk7dmFyIHJlPS9bKy1dPyg/OlxkKlwufClcZCsoPzpbZUVdWystXT9cZCt8KS8uc291cmNlLGllPW5ldyBSZWdFeHAoIl4oPzooWystXSk9fCkoIityZSsiKShbYS16JV0qKSQiLCJpIiksb2U9WyJUb3AiLCJSaWdodCIsIkJvdHRvbSIsIkxlZnQiXSxhZT1mdW5jdGlvbihlLHQpe3JldHVybiJub25lIj09PShlPXR8fGUpLnN0eWxlLmRpc3BsYXl8fCIiPT09ZS5zdHlsZS5kaXNwbGF5JiZ3LmNvbnRhaW5zKGUub3duZXJEb2N1bWVudCxlKSYmIm5vbmUiPT09dy5jc3MoZSwiZGlzcGxheSIpfSxzZT1mdW5jdGlvbihlLHQsbixyKXt2YXIgaSxvLGE9e307Zm9yKG8gaW4gdClhW29dPWUuc3R5bGVbb10sZS5zdHlsZVtvXT10W29dO2k9bi5hcHBseShlLHJ8fFtdKTtmb3IobyBpbiB0KWUuc3R5bGVbb109YVtvXTtyZXR1cm4gaX07ZnVuY3Rpb24gdWUoZSx0LG4scil7dmFyIGksbyxhPTIwLHM9cj9mdW5jdGlvbigpe3JldHVybiByLmN1cigpfTpmdW5jdGlvbigpe3JldHVybiB3LmNzcyhlLHQsIiIpfSx1PXMoKSxsPW4mJm5bM118fCh3LmNzc051bWJlclt0XT8iIjoicHgiKSxjPSh3LmNzc051bWJlclt0XXx8InB4IiE9PWwmJit1KSYmaWUuZXhlYyh3LmNzcyhlLHQpKTtpZihjJiZjWzNdIT09bCl7dS89MixsPWx8fGNbM10sYz0rdXx8MTt3aGlsZShhLS0pdy5zdHlsZShlLHQsYytsKSwoMS1vKSooMS0obz1zKCkvdXx8LjUpKTw9MCYmKGE9MCksYy89bztjKj0yLHcuc3R5bGUoZSx0LGMrbCksbj1ufHxbXX1yZXR1cm4gbiYmKGM9K2N8fCt1fHwwLGk9blsxXT9jKyhuWzFdKzEpKm5bMl06K25bMl0sciYmKHIudW5pdD1sLHIuc3RhcnQ9YyxyLmVuZD1pKSksaX12YXIgbGU9e307ZnVuY3Rpb24gY2UoZSl7dmFyIHQsbj1lLm93bmVyRG9jdW1lbnQscj1lLm5vZGVOYW1lLGk9bGVbcl07cmV0dXJuIGl8fCh0PW4uYm9keS5hcHBlbmRDaGlsZChuLmNyZWF0ZUVsZW1lbnQocikpLGk9dy5jc3ModCwiZGlzcGxheSIpLHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0KSwibm9uZSI9PT1pJiYoaT0iYmxvY2siKSxsZVtyXT1pLGkpfWZ1bmN0aW9uIGZlKGUsdCl7Zm9yKHZhciBuLHIsaT1bXSxvPTAsYT1lLmxlbmd0aDtvPGE7bysrKShyPWVbb10pLnN0eWxlJiYobj1yLnN0eWxlLmRpc3BsYXksdD8oIm5vbmUiPT09biYmKGlbb109Si5nZXQociwiZGlzcGxheSIpfHxudWxsLGlbb118fChyLnN0eWxlLmRpc3BsYXk9IiIpKSwiIj09PXIuc3R5bGUuZGlzcGxheSYmYWUocikmJihpW29dPWNlKHIpKSk6Im5vbmUiIT09biYmKGlbb109Im5vbmUiLEouc2V0KHIsImRpc3BsYXkiLG4pKSk7Zm9yKG89MDtvPGE7bysrKW51bGwhPWlbb10mJihlW29dLnN0eWxlLmRpc3BsYXk9aVtvXSk7cmV0dXJuIGV9dy5mbi5leHRlbmQoe3Nob3c6ZnVuY3Rpb24oKXtyZXR1cm4gZmUodGhpcywhMCl9LGhpZGU6ZnVuY3Rpb24oKXtyZXR1cm4gZmUodGhpcyl9LHRvZ2dsZTpmdW5jdGlvbihlKXtyZXR1cm4iYm9vbGVhbiI9PXR5cGVvZiBlP2U/dGhpcy5zaG93KCk6dGhpcy5oaWRlKCk6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7YWUodGhpcyk/dyh0aGlzKS5zaG93KCk6dyh0aGlzKS5oaWRlKCl9KX19KTt2YXIgcGU9L14oPzpjaGVja2JveHxyYWRpbykkL2ksZGU9LzwoW2Etel1bXlwvXDA+XHgyMFx0XHJcblxmXSspL2ksaGU9L14kfF5tb2R1bGUkfFwvKD86amF2YXxlY21hKXNjcmlwdC9pLGdlPXtvcHRpb246WzEsIjxzZWxlY3QgbXVsdGlwbGU9J211bHRpcGxlJz4iLCI8L3NlbGVjdD4iXSx0aGVhZDpbMSwiPHRhYmxlPiIsIjwvdGFibGU+Il0sY29sOlsyLCI8dGFibGU+PGNvbGdyb3VwPiIsIjwvY29sZ3JvdXA+PC90YWJsZT4iXSx0cjpbMiwiPHRhYmxlPjx0Ym9keT4iLCI8L3Rib2R5PjwvdGFibGU+Il0sdGQ6WzMsIjx0YWJsZT48dGJvZHk+PHRyPiIsIjwvdHI+PC90Ym9keT48L3RhYmxlPiJdLF9kZWZhdWx0OlswLCIiLCIiXX07Z2Uub3B0Z3JvdXA9Z2Uub3B0aW9uLGdlLnRib2R5PWdlLnRmb290PWdlLmNvbGdyb3VwPWdlLmNhcHRpb249Z2UudGhlYWQsZ2UudGg9Z2UudGQ7ZnVuY3Rpb24geWUoZSx0KXt2YXIgbjtyZXR1cm4gbj0idW5kZWZpbmVkIiE9dHlwZW9mIGUuZ2V0RWxlbWVudHNCeVRhZ05hbWU/ZS5nZXRFbGVtZW50c0J5VGFnTmFtZSh0fHwiKiIpOiJ1bmRlZmluZWQiIT10eXBlb2YgZS5xdWVyeVNlbGVjdG9yQWxsP2UucXVlcnlTZWxlY3RvckFsbCh0fHwiKiIpOltdLHZvaWQgMD09PXR8fHQmJk4oZSx0KT93Lm1lcmdlKFtlXSxuKTpufWZ1bmN0aW9uIHZlKGUsdCl7Zm9yKHZhciBuPTAscj1lLmxlbmd0aDtuPHI7bisrKUouc2V0KGVbbl0sImdsb2JhbEV2YWwiLCF0fHxKLmdldCh0W25dLCJnbG9iYWxFdmFsIikpfXZhciBtZT0vPHwmIz9cdys7LztmdW5jdGlvbiB4ZShlLHQsbixyLGkpe2Zvcih2YXIgbyxhLHMsdSxsLGMsZj10LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxwPVtdLGQ9MCxoPWUubGVuZ3RoO2Q8aDtkKyspaWYoKG89ZVtkXSl8fDA9PT1vKWlmKCJvYmplY3QiPT09eChvKSl3Lm1lcmdlKHAsby5ub2RlVHlwZT9bb106byk7ZWxzZSBpZihtZS50ZXN0KG8pKXthPWF8fGYuYXBwZW5kQ2hpbGQodC5jcmVhdGVFbGVtZW50KCJkaXYiKSkscz0oZGUuZXhlYyhvKXx8WyIiLCIiXSlbMV0udG9Mb3dlckNhc2UoKSx1PWdlW3NdfHxnZS5fZGVmYXVsdCxhLmlubmVySFRNTD11WzFdK3cuaHRtbFByZWZpbHRlcihvKSt1WzJdLGM9dVswXTt3aGlsZShjLS0pYT1hLmxhc3RDaGlsZDt3Lm1lcmdlKHAsYS5jaGlsZE5vZGVzKSwoYT1mLmZpcnN0Q2hpbGQpLnRleHRDb250ZW50PSIifWVsc2UgcC5wdXNoKHQuY3JlYXRlVGV4dE5vZGUobykpO2YudGV4dENvbnRlbnQ9IiIsZD0wO3doaWxlKG89cFtkKytdKWlmKHImJncuaW5BcnJheShvLHIpPi0xKWkmJmkucHVzaChvKTtlbHNlIGlmKGw9dy5jb250YWlucyhvLm93bmVyRG9jdW1lbnQsbyksYT15ZShmLmFwcGVuZENoaWxkKG8pLCJzY3JpcHQiKSxsJiZ2ZShhKSxuKXtjPTA7d2hpbGUobz1hW2MrK10paGUudGVzdChvLnR5cGV8fCIiKSYmbi5wdXNoKG8pfXJldHVybiBmfSFmdW5jdGlvbigpe3ZhciBlPXIuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLmFwcGVuZENoaWxkKHIuY3JlYXRlRWxlbWVudCgiZGl2IikpLHQ9ci5jcmVhdGVFbGVtZW50KCJpbnB1dCIpO3Quc2V0QXR0cmlidXRlKCJ0eXBlIiwicmFkaW8iKSx0LnNldEF0dHJpYnV0ZSgiY2hlY2tlZCIsImNoZWNrZWQiKSx0LnNldEF0dHJpYnV0ZSgibmFtZSIsInQiKSxlLmFwcGVuZENoaWxkKHQpLGguY2hlY2tDbG9uZT1lLmNsb25lTm9kZSghMCkuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuY2hlY2tlZCxlLmlubmVySFRNTD0iPHRleHRhcmVhPng8L3RleHRhcmVhPiIsaC5ub0Nsb25lQ2hlY2tlZD0hIWUuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuZGVmYXVsdFZhbHVlfSgpO3ZhciBiZT1yLmRvY3VtZW50RWxlbWVudCx3ZT0vXmtleS8sVGU9L14oPzptb3VzZXxwb2ludGVyfGNvbnRleHRtZW51fGRyYWd8ZHJvcCl8Y2xpY2svLENlPS9eKFteLl0qKSg/OlwuKC4rKXwpLztmdW5jdGlvbiBFZSgpe3JldHVybiEwfWZ1bmN0aW9uIGtlKCl7cmV0dXJuITF9ZnVuY3Rpb24gU2UoKXt0cnl7cmV0dXJuIHIuYWN0aXZlRWxlbWVudH1jYXRjaChlKXt9fWZ1bmN0aW9uIERlKGUsdCxuLHIsaSxvKXt2YXIgYSxzO2lmKCJvYmplY3QiPT10eXBlb2YgdCl7InN0cmluZyIhPXR5cGVvZiBuJiYocj1yfHxuLG49dm9pZCAwKTtmb3IocyBpbiB0KURlKGUscyxuLHIsdFtzXSxvKTtyZXR1cm4gZX1pZihudWxsPT1yJiZudWxsPT1pPyhpPW4scj1uPXZvaWQgMCk6bnVsbD09aSYmKCJzdHJpbmciPT10eXBlb2Ygbj8oaT1yLHI9dm9pZCAwKTooaT1yLHI9bixuPXZvaWQgMCkpLCExPT09aSlpPWtlO2Vsc2UgaWYoIWkpcmV0dXJuIGU7cmV0dXJuIDE9PT1vJiYoYT1pLChpPWZ1bmN0aW9uKGUpe3JldHVybiB3KCkub2ZmKGUpLGEuYXBwbHkodGhpcyxhcmd1bWVudHMpfSkuZ3VpZD1hLmd1aWR8fChhLmd1aWQ9dy5ndWlkKyspKSxlLmVhY2goZnVuY3Rpb24oKXt3LmV2ZW50LmFkZCh0aGlzLHQsaSxyLG4pfSl9dy5ldmVudD17Z2xvYmFsOnt9LGFkZDpmdW5jdGlvbihlLHQsbixyLGkpe3ZhciBvLGEscyx1LGwsYyxmLHAsZCxoLGcseT1KLmdldChlKTtpZih5KXtuLmhhbmRsZXImJihuPShvPW4pLmhhbmRsZXIsaT1vLnNlbGVjdG9yKSxpJiZ3LmZpbmQubWF0Y2hlc1NlbGVjdG9yKGJlLGkpLG4uZ3VpZHx8KG4uZ3VpZD13Lmd1aWQrKyksKHU9eS5ldmVudHMpfHwodT15LmV2ZW50cz17fSksKGE9eS5oYW5kbGUpfHwoYT15LmhhbmRsZT1mdW5jdGlvbih0KXtyZXR1cm4idW5kZWZpbmVkIiE9dHlwZW9mIHcmJncuZXZlbnQudHJpZ2dlcmVkIT09dC50eXBlP3cuZXZlbnQuZGlzcGF0Y2guYXBwbHkoZSxhcmd1bWVudHMpOnZvaWQgMH0pLGw9KHQ9KHR8fCIiKS5tYXRjaChNKXx8WyIiXSkubGVuZ3RoO3doaWxlKGwtLSlkPWc9KHM9Q2UuZXhlYyh0W2xdKXx8W10pWzFdLGg9KHNbMl18fCIiKS5zcGxpdCgiLiIpLnNvcnQoKSxkJiYoZj13LmV2ZW50LnNwZWNpYWxbZF18fHt9LGQ9KGk/Zi5kZWxlZ2F0ZVR5cGU6Zi5iaW5kVHlwZSl8fGQsZj13LmV2ZW50LnNwZWNpYWxbZF18fHt9LGM9dy5leHRlbmQoe3R5cGU6ZCxvcmlnVHlwZTpnLGRhdGE6cixoYW5kbGVyOm4sZ3VpZDpuLmd1aWQsc2VsZWN0b3I6aSxuZWVkc0NvbnRleHQ6aSYmdy5leHByLm1hdGNoLm5lZWRzQ29udGV4dC50ZXN0KGkpLG5hbWVzcGFjZTpoLmpvaW4oIi4iKX0sbyksKHA9dVtkXSl8fCgocD11W2RdPVtdKS5kZWxlZ2F0ZUNvdW50PTAsZi5zZXR1cCYmITEhPT1mLnNldHVwLmNhbGwoZSxyLGgsYSl8fGUuYWRkRXZlbnRMaXN0ZW5lciYmZS5hZGRFdmVudExpc3RlbmVyKGQsYSkpLGYuYWRkJiYoZi5hZGQuY2FsbChlLGMpLGMuaGFuZGxlci5ndWlkfHwoYy5oYW5kbGVyLmd1aWQ9bi5ndWlkKSksaT9wLnNwbGljZShwLmRlbGVnYXRlQ291bnQrKywwLGMpOnAucHVzaChjKSx3LmV2ZW50Lmdsb2JhbFtkXT0hMCl9fSxyZW1vdmU6ZnVuY3Rpb24oZSx0LG4scixpKXt2YXIgbyxhLHMsdSxsLGMsZixwLGQsaCxnLHk9Si5oYXNEYXRhKGUpJiZKLmdldChlKTtpZih5JiYodT15LmV2ZW50cykpe2w9KHQ9KHR8fCIiKS5tYXRjaChNKXx8WyIiXSkubGVuZ3RoO3doaWxlKGwtLSlpZihzPUNlLmV4ZWModFtsXSl8fFtdLGQ9Zz1zWzFdLGg9KHNbMl18fCIiKS5zcGxpdCgiLiIpLnNvcnQoKSxkKXtmPXcuZXZlbnQuc3BlY2lhbFtkXXx8e30scD11W2Q9KHI/Zi5kZWxlZ2F0ZVR5cGU6Zi5iaW5kVHlwZSl8fGRdfHxbXSxzPXNbMl0mJm5ldyBSZWdFeHAoIihefFxcLikiK2guam9pbigiXFwuKD86LipcXC58KSIpKyIoXFwufCQpIiksYT1vPXAubGVuZ3RoO3doaWxlKG8tLSljPXBbb10sIWkmJmchPT1jLm9yaWdUeXBlfHxuJiZuLmd1aWQhPT1jLmd1aWR8fHMmJiFzLnRlc3QoYy5uYW1lc3BhY2UpfHxyJiZyIT09Yy5zZWxlY3RvciYmKCIqKiIhPT1yfHwhYy5zZWxlY3Rvcil8fChwLnNwbGljZShvLDEpLGMuc2VsZWN0b3ImJnAuZGVsZWdhdGVDb3VudC0tLGYucmVtb3ZlJiZmLnJlbW92ZS5jYWxsKGUsYykpO2EmJiFwLmxlbmd0aCYmKGYudGVhcmRvd24mJiExIT09Zi50ZWFyZG93bi5jYWxsKGUsaCx5LmhhbmRsZSl8fHcucmVtb3ZlRXZlbnQoZSxkLHkuaGFuZGxlKSxkZWxldGUgdVtkXSl9ZWxzZSBmb3IoZCBpbiB1KXcuZXZlbnQucmVtb3ZlKGUsZCt0W2xdLG4sciwhMCk7dy5pc0VtcHR5T2JqZWN0KHUpJiZKLnJlbW92ZShlLCJoYW5kbGUgZXZlbnRzIil9fSxkaXNwYXRjaDpmdW5jdGlvbihlKXt2YXIgdD13LmV2ZW50LmZpeChlKSxuLHIsaSxvLGEscyx1PW5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoKSxsPShKLmdldCh0aGlzLCJldmVudHMiKXx8e30pW3QudHlwZV18fFtdLGM9dy5ldmVudC5zcGVjaWFsW3QudHlwZV18fHt9O2Zvcih1WzBdPXQsbj0xO248YXJndW1lbnRzLmxlbmd0aDtuKyspdVtuXT1hcmd1bWVudHNbbl07aWYodC5kZWxlZ2F0ZVRhcmdldD10aGlzLCFjLnByZURpc3BhdGNofHwhMSE9PWMucHJlRGlzcGF0Y2guY2FsbCh0aGlzLHQpKXtzPXcuZXZlbnQuaGFuZGxlcnMuY2FsbCh0aGlzLHQsbCksbj0wO3doaWxlKChvPXNbbisrXSkmJiF0LmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpe3QuY3VycmVudFRhcmdldD1vLmVsZW0scj0wO3doaWxlKChhPW8uaGFuZGxlcnNbcisrXSkmJiF0LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCkpdC5ybmFtZXNwYWNlJiYhdC5ybmFtZXNwYWNlLnRlc3QoYS5uYW1lc3BhY2UpfHwodC5oYW5kbGVPYmo9YSx0LmRhdGE9YS5kYXRhLHZvaWQgMCE9PShpPSgody5ldmVudC5zcGVjaWFsW2Eub3JpZ1R5cGVdfHx7fSkuaGFuZGxlfHxhLmhhbmRsZXIpLmFwcGx5KG8uZWxlbSx1KSkmJiExPT09KHQucmVzdWx0PWkpJiYodC5wcmV2ZW50RGVmYXVsdCgpLHQuc3RvcFByb3BhZ2F0aW9uKCkpKX1yZXR1cm4gYy5wb3N0RGlzcGF0Y2gmJmMucG9zdERpc3BhdGNoLmNhbGwodGhpcyx0KSx0LnJlc3VsdH19LGhhbmRsZXJzOmZ1bmN0aW9uKGUsdCl7dmFyIG4scixpLG8sYSxzPVtdLHU9dC5kZWxlZ2F0ZUNvdW50LGw9ZS50YXJnZXQ7aWYodSYmbC5ub2RlVHlwZSYmISgiY2xpY2siPT09ZS50eXBlJiZlLmJ1dHRvbj49MSkpZm9yKDtsIT09dGhpcztsPWwucGFyZW50Tm9kZXx8dGhpcylpZigxPT09bC5ub2RlVHlwZSYmKCJjbGljayIhPT1lLnR5cGV8fCEwIT09bC5kaXNhYmxlZCkpe2ZvcihvPVtdLGE9e30sbj0wO248dTtuKyspdm9pZCAwPT09YVtpPShyPXRbbl0pLnNlbGVjdG9yKyIgIl0mJihhW2ldPXIubmVlZHNDb250ZXh0P3coaSx0aGlzKS5pbmRleChsKT4tMTp3LmZpbmQoaSx0aGlzLG51bGwsW2xdKS5sZW5ndGgpLGFbaV0mJm8ucHVzaChyKTtvLmxlbmd0aCYmcy5wdXNoKHtlbGVtOmwsaGFuZGxlcnM6b30pfXJldHVybiBsPXRoaXMsdTx0Lmxlbmd0aCYmcy5wdXNoKHtlbGVtOmwsaGFuZGxlcnM6dC5zbGljZSh1KX0pLHN9LGFkZFByb3A6ZnVuY3Rpb24oZSx0KXtPYmplY3QuZGVmaW5lUHJvcGVydHkody5FdmVudC5wcm90b3R5cGUsZSx7ZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsZ2V0OmcodCk/ZnVuY3Rpb24oKXtpZih0aGlzLm9yaWdpbmFsRXZlbnQpcmV0dXJuIHQodGhpcy5vcmlnaW5hbEV2ZW50KX06ZnVuY3Rpb24oKXtpZih0aGlzLm9yaWdpbmFsRXZlbnQpcmV0dXJuIHRoaXMub3JpZ2luYWxFdmVudFtlXX0sc2V0OmZ1bmN0aW9uKHQpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLGUse2VudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwLHZhbHVlOnR9KX19KX0sZml4OmZ1bmN0aW9uKGUpe3JldHVybiBlW3cuZXhwYW5kb10/ZTpuZXcgdy5FdmVudChlKX0sc3BlY2lhbDp7bG9hZDp7bm9CdWJibGU6ITB9LGZvY3VzOnt0cmlnZ2VyOmZ1bmN0aW9uKCl7aWYodGhpcyE9PVNlKCkmJnRoaXMuZm9jdXMpcmV0dXJuIHRoaXMuZm9jdXMoKSwhMX0sZGVsZWdhdGVUeXBlOiJmb2N1c2luIn0sYmx1cjp7dHJpZ2dlcjpmdW5jdGlvbigpe2lmKHRoaXM9PT1TZSgpJiZ0aGlzLmJsdXIpcmV0dXJuIHRoaXMuYmx1cigpLCExfSxkZWxlZ2F0ZVR5cGU6ImZvY3Vzb3V0In0sY2xpY2s6e3RyaWdnZXI6ZnVuY3Rpb24oKXtpZigiY2hlY2tib3giPT09dGhpcy50eXBlJiZ0aGlzLmNsaWNrJiZOKHRoaXMsImlucHV0IikpcmV0dXJuIHRoaXMuY2xpY2soKSwhMX0sX2RlZmF1bHQ6ZnVuY3Rpb24oZSl7cmV0dXJuIE4oZS50YXJnZXQsImEiKX19LGJlZm9yZXVubG9hZDp7cG9zdERpc3BhdGNoOmZ1bmN0aW9uKGUpe3ZvaWQgMCE9PWUucmVzdWx0JiZlLm9yaWdpbmFsRXZlbnQmJihlLm9yaWdpbmFsRXZlbnQucmV0dXJuVmFsdWU9ZS5yZXN1bHQpfX19fSx3LnJlbW92ZUV2ZW50PWZ1bmN0aW9uKGUsdCxuKXtlLnJlbW92ZUV2ZW50TGlzdGVuZXImJmUucmVtb3ZlRXZlbnRMaXN0ZW5lcih0LG4pfSx3LkV2ZW50PWZ1bmN0aW9uKGUsdCl7aWYoISh0aGlzIGluc3RhbmNlb2Ygdy5FdmVudCkpcmV0dXJuIG5ldyB3LkV2ZW50KGUsdCk7ZSYmZS50eXBlPyh0aGlzLm9yaWdpbmFsRXZlbnQ9ZSx0aGlzLnR5cGU9ZS50eXBlLHRoaXMuaXNEZWZhdWx0UHJldmVudGVkPWUuZGVmYXVsdFByZXZlbnRlZHx8dm9pZCAwPT09ZS5kZWZhdWx0UHJldmVudGVkJiYhMT09PWUucmV0dXJuVmFsdWU/RWU6a2UsdGhpcy50YXJnZXQ9ZS50YXJnZXQmJjM9PT1lLnRhcmdldC5ub2RlVHlwZT9lLnRhcmdldC5wYXJlbnROb2RlOmUudGFyZ2V0LHRoaXMuY3VycmVudFRhcmdldD1lLmN1cnJlbnRUYXJnZXQsdGhpcy5yZWxhdGVkVGFyZ2V0PWUucmVsYXRlZFRhcmdldCk6dGhpcy50eXBlPWUsdCYmdy5leHRlbmQodGhpcyx0KSx0aGlzLnRpbWVTdGFtcD1lJiZlLnRpbWVTdGFtcHx8RGF0ZS5ub3coKSx0aGlzW3cuZXhwYW5kb109ITB9LHcuRXZlbnQucHJvdG90eXBlPXtjb25zdHJ1Y3Rvcjp3LkV2ZW50LGlzRGVmYXVsdFByZXZlbnRlZDprZSxpc1Byb3BhZ2F0aW9uU3RvcHBlZDprZSxpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZDprZSxpc1NpbXVsYXRlZDohMSxwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbigpe3ZhciBlPXRoaXMub3JpZ2luYWxFdmVudDt0aGlzLmlzRGVmYXVsdFByZXZlbnRlZD1FZSxlJiYhdGhpcy5pc1NpbXVsYXRlZCYmZS5wcmV2ZW50RGVmYXVsdCgpfSxzdG9wUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9yaWdpbmFsRXZlbnQ7dGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZD1FZSxlJiYhdGhpcy5pc1NpbXVsYXRlZCYmZS5zdG9wUHJvcGFnYXRpb24oKX0sc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ9RWUsZSYmIXRoaXMuaXNTaW11bGF0ZWQmJmUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksdGhpcy5zdG9wUHJvcGFnYXRpb24oKX19LHcuZWFjaCh7YWx0S2V5OiEwLGJ1YmJsZXM6ITAsY2FuY2VsYWJsZTohMCxjaGFuZ2VkVG91Y2hlczohMCxjdHJsS2V5OiEwLGRldGFpbDohMCxldmVudFBoYXNlOiEwLG1ldGFLZXk6ITAscGFnZVg6ITAscGFnZVk6ITAsc2hpZnRLZXk6ITAsdmlldzohMCwiY2hhciI6ITAsY2hhckNvZGU6ITAsa2V5OiEwLGtleUNvZGU6ITAsYnV0dG9uOiEwLGJ1dHRvbnM6ITAsY2xpZW50WDohMCxjbGllbnRZOiEwLG9mZnNldFg6ITAsb2Zmc2V0WTohMCxwb2ludGVySWQ6ITAscG9pbnRlclR5cGU6ITAsc2NyZWVuWDohMCxzY3JlZW5ZOiEwLHRhcmdldFRvdWNoZXM6ITAsdG9FbGVtZW50OiEwLHRvdWNoZXM6ITAsd2hpY2g6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5idXR0b247cmV0dXJuIG51bGw9PWUud2hpY2gmJndlLnRlc3QoZS50eXBlKT9udWxsIT1lLmNoYXJDb2RlP2UuY2hhckNvZGU6ZS5rZXlDb2RlOiFlLndoaWNoJiZ2b2lkIDAhPT10JiZUZS50ZXN0KGUudHlwZSk/MSZ0PzE6MiZ0PzM6NCZ0PzI6MDplLndoaWNofX0sdy5ldmVudC5hZGRQcm9wKSx3LmVhY2goe21vdXNlZW50ZXI6Im1vdXNlb3ZlciIsbW91c2VsZWF2ZToibW91c2VvdXQiLHBvaW50ZXJlbnRlcjoicG9pbnRlcm92ZXIiLHBvaW50ZXJsZWF2ZToicG9pbnRlcm91dCJ9LGZ1bmN0aW9uKGUsdCl7dy5ldmVudC5zcGVjaWFsW2VdPXtkZWxlZ2F0ZVR5cGU6dCxiaW5kVHlwZTp0LGhhbmRsZTpmdW5jdGlvbihlKXt2YXIgbixyPXRoaXMsaT1lLnJlbGF0ZWRUYXJnZXQsbz1lLmhhbmRsZU9iajtyZXR1cm4gaSYmKGk9PT1yfHx3LmNvbnRhaW5zKHIsaSkpfHwoZS50eXBlPW8ub3JpZ1R5cGUsbj1vLmhhbmRsZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLGUudHlwZT10KSxufX19KSx3LmZuLmV4dGVuZCh7b246ZnVuY3Rpb24oZSx0LG4scil7cmV0dXJuIERlKHRoaXMsZSx0LG4scil9LG9uZTpmdW5jdGlvbihlLHQsbixyKXtyZXR1cm4gRGUodGhpcyxlLHQsbixyLDEpfSxvZmY6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGk7aWYoZSYmZS5wcmV2ZW50RGVmYXVsdCYmZS5oYW5kbGVPYmopcmV0dXJuIHI9ZS5oYW5kbGVPYmosdyhlLmRlbGVnYXRlVGFyZ2V0KS5vZmYoci5uYW1lc3BhY2U/ci5vcmlnVHlwZSsiLiIrci5uYW1lc3BhY2U6ci5vcmlnVHlwZSxyLnNlbGVjdG9yLHIuaGFuZGxlciksdGhpcztpZigib2JqZWN0Ij09dHlwZW9mIGUpe2ZvcihpIGluIGUpdGhpcy5vZmYoaSx0LGVbaV0pO3JldHVybiB0aGlzfXJldHVybiExIT09dCYmImZ1bmN0aW9uIiE9dHlwZW9mIHR8fChuPXQsdD12b2lkIDApLCExPT09biYmKG49a2UpLHRoaXMuZWFjaChmdW5jdGlvbigpe3cuZXZlbnQucmVtb3ZlKHRoaXMsZSxuLHQpfSl9fSk7dmFyIE5lPS88KD8hYXJlYXxicnxjb2x8ZW1iZWR8aHJ8aW1nfGlucHV0fGxpbmt8bWV0YXxwYXJhbSkoKFthLXpdW15cL1wwPlx4MjBcdFxyXG5cZl0qKVtePl0qKVwvPi9naSxBZT0vPHNjcmlwdHw8c3R5bGV8PGxpbmsvaSxqZT0vY2hlY2tlZFxzKig/OltePV18PVxzKi5jaGVja2VkLikvaSxxZT0vXlxzKjwhKD86XFtDREFUQVxbfC0tKXwoPzpcXVxdfC0tKT5ccyokL2c7ZnVuY3Rpb24gTGUoZSx0KXtyZXR1cm4gTihlLCJ0YWJsZSIpJiZOKDExIT09dC5ub2RlVHlwZT90OnQuZmlyc3RDaGlsZCwidHIiKT93KGUpLmNoaWxkcmVuKCJ0Ym9keSIpWzBdfHxlOmV9ZnVuY3Rpb24gSGUoZSl7cmV0dXJuIGUudHlwZT0obnVsbCE9PWUuZ2V0QXR0cmlidXRlKCJ0eXBlIikpKyIvIitlLnR5cGUsZX1mdW5jdGlvbiBPZShlKXtyZXR1cm4idHJ1ZS8iPT09KGUudHlwZXx8IiIpLnNsaWNlKDAsNSk/ZS50eXBlPWUudHlwZS5zbGljZSg1KTplLnJlbW92ZUF0dHJpYnV0ZSgidHlwZSIpLGV9ZnVuY3Rpb24gUGUoZSx0KXt2YXIgbixyLGksbyxhLHMsdSxsO2lmKDE9PT10Lm5vZGVUeXBlKXtpZihKLmhhc0RhdGEoZSkmJihvPUouYWNjZXNzKGUpLGE9Si5zZXQodCxvKSxsPW8uZXZlbnRzKSl7ZGVsZXRlIGEuaGFuZGxlLGEuZXZlbnRzPXt9O2ZvcihpIGluIGwpZm9yKG49MCxyPWxbaV0ubGVuZ3RoO248cjtuKyspdy5ldmVudC5hZGQodCxpLGxbaV1bbl0pfUsuaGFzRGF0YShlKSYmKHM9Sy5hY2Nlc3MoZSksdT13LmV4dGVuZCh7fSxzKSxLLnNldCh0LHUpKX19ZnVuY3Rpb24gTWUoZSx0KXt2YXIgbj10Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7ImlucHV0Ij09PW4mJnBlLnRlc3QoZS50eXBlKT90LmNoZWNrZWQ9ZS5jaGVja2VkOiJpbnB1dCIhPT1uJiYidGV4dGFyZWEiIT09bnx8KHQuZGVmYXVsdFZhbHVlPWUuZGVmYXVsdFZhbHVlKX1mdW5jdGlvbiBSZShlLHQsbixyKXt0PWEuYXBwbHkoW10sdCk7dmFyIGksbyxzLHUsbCxjLGY9MCxwPWUubGVuZ3RoLGQ9cC0xLHk9dFswXSx2PWcoeSk7aWYodnx8cD4xJiYic3RyaW5nIj09dHlwZW9mIHkmJiFoLmNoZWNrQ2xvbmUmJmplLnRlc3QoeSkpcmV0dXJuIGUuZWFjaChmdW5jdGlvbihpKXt2YXIgbz1lLmVxKGkpO3YmJih0WzBdPXkuY2FsbCh0aGlzLGksby5odG1sKCkpKSxSZShvLHQsbixyKX0pO2lmKHAmJihpPXhlKHQsZVswXS5vd25lckRvY3VtZW50LCExLGUsciksbz1pLmZpcnN0Q2hpbGQsMT09PWkuY2hpbGROb2Rlcy5sZW5ndGgmJihpPW8pLG98fHIpKXtmb3IodT0ocz13Lm1hcCh5ZShpLCJzY3JpcHQiKSxIZSkpLmxlbmd0aDtmPHA7ZisrKWw9aSxmIT09ZCYmKGw9dy5jbG9uZShsLCEwLCEwKSx1JiZ3Lm1lcmdlKHMseWUobCwic2NyaXB0IikpKSxuLmNhbGwoZVtmXSxsLGYpO2lmKHUpZm9yKGM9c1tzLmxlbmd0aC0xXS5vd25lckRvY3VtZW50LHcubWFwKHMsT2UpLGY9MDtmPHU7ZisrKWw9c1tmXSxoZS50ZXN0KGwudHlwZXx8IiIpJiYhSi5hY2Nlc3MobCwiZ2xvYmFsRXZhbCIpJiZ3LmNvbnRhaW5zKGMsbCkmJihsLnNyYyYmIm1vZHVsZSIhPT0obC50eXBlfHwiIikudG9Mb3dlckNhc2UoKT93Ll9ldmFsVXJsJiZ3Ll9ldmFsVXJsKGwuc3JjKTptKGwudGV4dENvbnRlbnQucmVwbGFjZShxZSwiIiksYyxsKSl9cmV0dXJuIGV9ZnVuY3Rpb24gSWUoZSx0LG4pe2Zvcih2YXIgcixpPXQ/dy5maWx0ZXIodCxlKTplLG89MDtudWxsIT0ocj1pW29dKTtvKyspbnx8MSE9PXIubm9kZVR5cGV8fHcuY2xlYW5EYXRhKHllKHIpKSxyLnBhcmVudE5vZGUmJihuJiZ3LmNvbnRhaW5zKHIub3duZXJEb2N1bWVudCxyKSYmdmUoeWUociwic2NyaXB0IikpLHIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChyKSk7cmV0dXJuIGV9dy5leHRlbmQoe2h0bWxQcmVmaWx0ZXI6ZnVuY3Rpb24oZSl7cmV0dXJuIGUucmVwbGFjZShOZSwiPCQxPjwvJDI+Iil9LGNsb25lOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG8sYSxzPWUuY2xvbmVOb2RlKCEwKSx1PXcuY29udGFpbnMoZS5vd25lckRvY3VtZW50LGUpO2lmKCEoaC5ub0Nsb25lQ2hlY2tlZHx8MSE9PWUubm9kZVR5cGUmJjExIT09ZS5ub2RlVHlwZXx8dy5pc1hNTERvYyhlKSkpZm9yKGE9eWUocykscj0wLGk9KG89eWUoZSkpLmxlbmd0aDtyPGk7cisrKU1lKG9bcl0sYVtyXSk7aWYodClpZihuKWZvcihvPW98fHllKGUpLGE9YXx8eWUocykscj0wLGk9by5sZW5ndGg7cjxpO3IrKylQZShvW3JdLGFbcl0pO2Vsc2UgUGUoZSxzKTtyZXR1cm4oYT15ZShzLCJzY3JpcHQiKSkubGVuZ3RoPjAmJnZlKGEsIXUmJnllKGUsInNjcmlwdCIpKSxzfSxjbGVhbkRhdGE6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LG4scixpPXcuZXZlbnQuc3BlY2lhbCxvPTA7dm9pZCAwIT09KG49ZVtvXSk7bysrKWlmKFkobikpe2lmKHQ9bltKLmV4cGFuZG9dKXtpZih0LmV2ZW50cylmb3IociBpbiB0LmV2ZW50cylpW3JdP3cuZXZlbnQucmVtb3ZlKG4scik6dy5yZW1vdmVFdmVudChuLHIsdC5oYW5kbGUpO25bSi5leHBhbmRvXT12b2lkIDB9bltLLmV4cGFuZG9dJiYobltLLmV4cGFuZG9dPXZvaWQgMCl9fX0pLHcuZm4uZXh0ZW5kKHtkZXRhY2g6ZnVuY3Rpb24oZSl7cmV0dXJuIEllKHRoaXMsZSwhMCl9LHJlbW92ZTpmdW5jdGlvbihlKXtyZXR1cm4gSWUodGhpcyxlKX0sdGV4dDpmdW5jdGlvbihlKXtyZXR1cm4geih0aGlzLGZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lP3cudGV4dCh0aGlzKTp0aGlzLmVtcHR5KCkuZWFjaChmdW5jdGlvbigpezEhPT10aGlzLm5vZGVUeXBlJiYxMSE9PXRoaXMubm9kZVR5cGUmJjkhPT10aGlzLm5vZGVUeXBlfHwodGhpcy50ZXh0Q29udGVudD1lKX0pfSxudWxsLGUsYXJndW1lbnRzLmxlbmd0aCl9LGFwcGVuZDpmdW5jdGlvbigpe3JldHVybiBSZSh0aGlzLGFyZ3VtZW50cyxmdW5jdGlvbihlKXsxIT09dGhpcy5ub2RlVHlwZSYmMTEhPT10aGlzLm5vZGVUeXBlJiY5IT09dGhpcy5ub2RlVHlwZXx8TGUodGhpcyxlKS5hcHBlbmRDaGlsZChlKX0pfSxwcmVwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIFJlKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGUpe2lmKDE9PT10aGlzLm5vZGVUeXBlfHwxMT09PXRoaXMubm9kZVR5cGV8fDk9PT10aGlzLm5vZGVUeXBlKXt2YXIgdD1MZSh0aGlzLGUpO3QuaW5zZXJ0QmVmb3JlKGUsdC5maXJzdENoaWxkKX19KX0sYmVmb3JlOmZ1bmN0aW9uKCl7cmV0dXJuIFJlKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGUpe3RoaXMucGFyZW50Tm9kZSYmdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlLHRoaXMpfSl9LGFmdGVyOmZ1bmN0aW9uKCl7cmV0dXJuIFJlKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGUpe3RoaXMucGFyZW50Tm9kZSYmdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlLHRoaXMubmV4dFNpYmxpbmcpfSl9LGVtcHR5OmZ1bmN0aW9uKCl7Zm9yKHZhciBlLHQ9MDtudWxsIT0oZT10aGlzW3RdKTt0KyspMT09PWUubm9kZVR5cGUmJih3LmNsZWFuRGF0YSh5ZShlLCExKSksZS50ZXh0Q29udGVudD0iIik7cmV0dXJuIHRoaXN9LGNsb25lOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIGU9bnVsbCE9ZSYmZSx0PW51bGw9PXQ/ZTp0LHRoaXMubWFwKGZ1bmN0aW9uKCl7cmV0dXJuIHcuY2xvbmUodGhpcyxlLHQpfSl9LGh0bWw6ZnVuY3Rpb24oZSl7cmV0dXJuIHoodGhpcyxmdW5jdGlvbihlKXt2YXIgdD10aGlzWzBdfHx7fSxuPTAscj10aGlzLmxlbmd0aDtpZih2b2lkIDA9PT1lJiYxPT09dC5ub2RlVHlwZSlyZXR1cm4gdC5pbm5lckhUTUw7aWYoInN0cmluZyI9PXR5cGVvZiBlJiYhQWUudGVzdChlKSYmIWdlWyhkZS5leGVjKGUpfHxbIiIsIiJdKVsxXS50b0xvd2VyQ2FzZSgpXSl7ZT13Lmh0bWxQcmVmaWx0ZXIoZSk7dHJ5e2Zvcig7bjxyO24rKykxPT09KHQ9dGhpc1tuXXx8e30pLm5vZGVUeXBlJiYody5jbGVhbkRhdGEoeWUodCwhMSkpLHQuaW5uZXJIVE1MPWUpO3Q9MH1jYXRjaChlKXt9fXQmJnRoaXMuZW1wdHkoKS5hcHBlbmQoZSl9LG51bGwsZSxhcmd1bWVudHMubGVuZ3RoKX0scmVwbGFjZVdpdGg6ZnVuY3Rpb24oKXt2YXIgZT1bXTtyZXR1cm4gUmUodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24odCl7dmFyIG49dGhpcy5wYXJlbnROb2RlO3cuaW5BcnJheSh0aGlzLGUpPDAmJih3LmNsZWFuRGF0YSh5ZSh0aGlzKSksbiYmbi5yZXBsYWNlQ2hpbGQodCx0aGlzKSl9LGUpfX0pLHcuZWFjaCh7YXBwZW5kVG86ImFwcGVuZCIscHJlcGVuZFRvOiJwcmVwZW5kIixpbnNlcnRCZWZvcmU6ImJlZm9yZSIsaW5zZXJ0QWZ0ZXI6ImFmdGVyIixyZXBsYWNlQWxsOiJyZXBsYWNlV2l0aCJ9LGZ1bmN0aW9uKGUsdCl7dy5mbltlXT1mdW5jdGlvbihlKXtmb3IodmFyIG4scj1bXSxpPXcoZSksbz1pLmxlbmd0aC0xLGE9MDthPD1vO2ErKyluPWE9PT1vP3RoaXM6dGhpcy5jbG9uZSghMCksdyhpW2FdKVt0XShuKSxzLmFwcGx5KHIsbi5nZXQoKSk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKHIpfX0pO3ZhciBXZT1uZXcgUmVnRXhwKCJeKCIrcmUrIikoPyFweClbYS16JV0rJCIsImkiKSwkZT1mdW5jdGlvbih0KXt2YXIgbj10Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXc7cmV0dXJuIG4mJm4ub3BlbmVyfHwobj1lKSxuLmdldENvbXB1dGVkU3R5bGUodCl9LEJlPW5ldyBSZWdFeHAob2Uuam9pbigifCIpLCJpIik7IWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe2lmKGMpe2wuc3R5bGUuY3NzVGV4dD0icG9zaXRpb246YWJzb2x1dGU7bGVmdDotMTExMTFweDt3aWR0aDo2MHB4O21hcmdpbi10b3A6MXB4O3BhZGRpbmc6MDtib3JkZXI6MCIsYy5zdHlsZS5jc3NUZXh0PSJwb3NpdGlvbjpyZWxhdGl2ZTtkaXNwbGF5OmJsb2NrO2JveC1zaXppbmc6Ym9yZGVyLWJveDtvdmVyZmxvdzpzY3JvbGw7bWFyZ2luOmF1dG87Ym9yZGVyOjFweDtwYWRkaW5nOjFweDt3aWR0aDo2MCU7dG9wOjElIixiZS5hcHBlbmRDaGlsZChsKS5hcHBlbmRDaGlsZChjKTt2YXIgdD1lLmdldENvbXB1dGVkU3R5bGUoYyk7aT0iMSUiIT09dC50b3AsdT0xMj09PW4odC5tYXJnaW5MZWZ0KSxjLnN0eWxlLnJpZ2h0PSI2MCUiLHM9MzY9PT1uKHQucmlnaHQpLG89MzY9PT1uKHQud2lkdGgpLGMuc3R5bGUucG9zaXRpb249ImFic29sdXRlIixhPTM2PT09Yy5vZmZzZXRXaWR0aHx8ImFic29sdXRlIixiZS5yZW1vdmVDaGlsZChsKSxjPW51bGx9fWZ1bmN0aW9uIG4oZSl7cmV0dXJuIE1hdGgucm91bmQocGFyc2VGbG9hdChlKSl9dmFyIGksbyxhLHMsdSxsPXIuY3JlYXRlRWxlbWVudCgiZGl2IiksYz1yLmNyZWF0ZUVsZW1lbnQoImRpdiIpO2Muc3R5bGUmJihjLnN0eWxlLmJhY2tncm91bmRDbGlwPSJjb250ZW50LWJveCIsYy5jbG9uZU5vZGUoITApLnN0eWxlLmJhY2tncm91bmRDbGlwPSIiLGguY2xlYXJDbG9uZVN0eWxlPSJjb250ZW50LWJveCI9PT1jLnN0eWxlLmJhY2tncm91bmRDbGlwLHcuZXh0ZW5kKGgse2JveFNpemluZ1JlbGlhYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIHQoKSxvfSxwaXhlbEJveFN0eWxlczpmdW5jdGlvbigpe3JldHVybiB0KCksc30scGl4ZWxQb3NpdGlvbjpmdW5jdGlvbigpe3JldHVybiB0KCksaX0scmVsaWFibGVNYXJnaW5MZWZ0OmZ1bmN0aW9uKCl7cmV0dXJuIHQoKSx1fSxzY3JvbGxib3hTaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHQoKSxhfX0pKX0oKTtmdW5jdGlvbiBGZShlLHQsbil7dmFyIHIsaSxvLGEscz1lLnN0eWxlO3JldHVybihuPW58fCRlKGUpKSYmKCIiIT09KGE9bi5nZXRQcm9wZXJ0eVZhbHVlKHQpfHxuW3RdKXx8dy5jb250YWlucyhlLm93bmVyRG9jdW1lbnQsZSl8fChhPXcuc3R5bGUoZSx0KSksIWgucGl4ZWxCb3hTdHlsZXMoKSYmV2UudGVzdChhKSYmQmUudGVzdCh0KSYmKHI9cy53aWR0aCxpPXMubWluV2lkdGgsbz1zLm1heFdpZHRoLHMubWluV2lkdGg9cy5tYXhXaWR0aD1zLndpZHRoPWEsYT1uLndpZHRoLHMud2lkdGg9cixzLm1pbldpZHRoPWkscy5tYXhXaWR0aD1vKSksdm9pZCAwIT09YT9hKyIiOmF9ZnVuY3Rpb24gX2UoZSx0KXtyZXR1cm57Z2V0OmZ1bmN0aW9uKCl7aWYoIWUoKSlyZXR1cm4odGhpcy5nZXQ9dCkuYXBwbHkodGhpcyxhcmd1bWVudHMpO2RlbGV0ZSB0aGlzLmdldH19fXZhciB6ZT0vXihub25lfHRhYmxlKD8hLWNbZWFdKS4rKS8sWGU9L14tLS8sVWU9e3Bvc2l0aW9uOiJhYnNvbHV0ZSIsdmlzaWJpbGl0eToiaGlkZGVuIixkaXNwbGF5OiJibG9jayJ9LFZlPXtsZXR0ZXJTcGFjaW5nOiIwIixmb250V2VpZ2h0OiI0MDAifSxHZT1bIldlYmtpdCIsIk1veiIsIm1zIl0sWWU9ci5jcmVhdGVFbGVtZW50KCJkaXYiKS5zdHlsZTtmdW5jdGlvbiBRZShlKXtpZihlIGluIFllKXJldHVybiBlO3ZhciB0PWVbMF0udG9VcHBlckNhc2UoKStlLnNsaWNlKDEpLG49R2UubGVuZ3RoO3doaWxlKG4tLSlpZigoZT1HZVtuXSt0KWluIFllKXJldHVybiBlfWZ1bmN0aW9uIEplKGUpe3ZhciB0PXcuY3NzUHJvcHNbZV07cmV0dXJuIHR8fCh0PXcuY3NzUHJvcHNbZV09UWUoZSl8fGUpLHR9ZnVuY3Rpb24gS2UoZSx0LG4pe3ZhciByPWllLmV4ZWModCk7cmV0dXJuIHI/TWF0aC5tYXgoMCxyWzJdLShufHwwKSkrKHJbM118fCJweCIpOnR9ZnVuY3Rpb24gWmUoZSx0LG4scixpLG8pe3ZhciBhPSJ3aWR0aCI9PT10PzE6MCxzPTAsdT0wO2lmKG49PT0ocj8iYm9yZGVyIjoiY29udGVudCIpKXJldHVybiAwO2Zvcig7YTw0O2ErPTIpIm1hcmdpbiI9PT1uJiYodSs9dy5jc3MoZSxuK29lW2FdLCEwLGkpKSxyPygiY29udGVudCI9PT1uJiYodS09dy5jc3MoZSwicGFkZGluZyIrb2VbYV0sITAsaSkpLCJtYXJnaW4iIT09biYmKHUtPXcuY3NzKGUsImJvcmRlciIrb2VbYV0rIldpZHRoIiwhMCxpKSkpOih1Kz13LmNzcyhlLCJwYWRkaW5nIitvZVthXSwhMCxpKSwicGFkZGluZyIhPT1uP3UrPXcuY3NzKGUsImJvcmRlciIrb2VbYV0rIldpZHRoIiwhMCxpKTpzKz13LmNzcyhlLCJib3JkZXIiK29lW2FdKyJXaWR0aCIsITAsaSkpO3JldHVybiFyJiZvPj0wJiYodSs9TWF0aC5tYXgoMCxNYXRoLmNlaWwoZVsib2Zmc2V0Iit0WzBdLnRvVXBwZXJDYXNlKCkrdC5zbGljZSgxKV0tby11LXMtLjUpKSksdX1mdW5jdGlvbiBldChlLHQsbil7dmFyIHI9JGUoZSksaT1GZShlLHQsciksbz0iYm9yZGVyLWJveCI9PT13LmNzcyhlLCJib3hTaXppbmciLCExLHIpLGE9bztpZihXZS50ZXN0KGkpKXtpZighbilyZXR1cm4gaTtpPSJhdXRvIn1yZXR1cm4gYT1hJiYoaC5ib3hTaXppbmdSZWxpYWJsZSgpfHxpPT09ZS5zdHlsZVt0XSksKCJhdXRvIj09PWl8fCFwYXJzZUZsb2F0KGkpJiYiaW5saW5lIj09PXcuY3NzKGUsImRpc3BsYXkiLCExLHIpKSYmKGk9ZVsib2Zmc2V0Iit0WzBdLnRvVXBwZXJDYXNlKCkrdC5zbGljZSgxKV0sYT0hMCksKGk9cGFyc2VGbG9hdChpKXx8MCkrWmUoZSx0LG58fChvPyJib3JkZXIiOiJjb250ZW50IiksYSxyLGkpKyJweCJ9dy5leHRlbmQoe2Nzc0hvb2tzOntvcGFjaXR5OntnZXQ6ZnVuY3Rpb24oZSx0KXtpZih0KXt2YXIgbj1GZShlLCJvcGFjaXR5Iik7cmV0dXJuIiI9PT1uPyIxIjpufX19fSxjc3NOdW1iZXI6e2FuaW1hdGlvbkl0ZXJhdGlvbkNvdW50OiEwLGNvbHVtbkNvdW50OiEwLGZpbGxPcGFjaXR5OiEwLGZsZXhHcm93OiEwLGZsZXhTaHJpbms6ITAsZm9udFdlaWdodDohMCxsaW5lSGVpZ2h0OiEwLG9wYWNpdHk6ITAsb3JkZXI6ITAsb3JwaGFuczohMCx3aWRvd3M6ITAsekluZGV4OiEwLHpvb206ITB9LGNzc1Byb3BzOnt9LHN0eWxlOmZ1bmN0aW9uKGUsdCxuLHIpe2lmKGUmJjMhPT1lLm5vZGVUeXBlJiY4IT09ZS5ub2RlVHlwZSYmZS5zdHlsZSl7dmFyIGksbyxhLHM9Ryh0KSx1PVhlLnRlc3QodCksbD1lLnN0eWxlO2lmKHV8fCh0PUplKHMpKSxhPXcuY3NzSG9va3NbdF18fHcuY3NzSG9va3Nbc10sdm9pZCAwPT09bilyZXR1cm4gYSYmImdldCJpbiBhJiZ2b2lkIDAhPT0oaT1hLmdldChlLCExLHIpKT9pOmxbdF07InN0cmluZyI9PShvPXR5cGVvZiBuKSYmKGk9aWUuZXhlYyhuKSkmJmlbMV0mJihuPXVlKGUsdCxpKSxvPSJudW1iZXIiKSxudWxsIT1uJiZuPT09biYmKCJudW1iZXIiPT09byYmKG4rPWkmJmlbM118fCh3LmNzc051bWJlcltzXT8iIjoicHgiKSksaC5jbGVhckNsb25lU3R5bGV8fCIiIT09bnx8MCE9PXQuaW5kZXhPZigiYmFja2dyb3VuZCIpfHwobFt0XT0iaW5oZXJpdCIpLGEmJiJzZXQiaW4gYSYmdm9pZCAwPT09KG49YS5zZXQoZSxuLHIpKXx8KHU/bC5zZXRQcm9wZXJ0eSh0LG4pOmxbdF09bikpfX0sY3NzOmZ1bmN0aW9uKGUsdCxuLHIpe3ZhciBpLG8sYSxzPUcodCk7cmV0dXJuIFhlLnRlc3QodCl8fCh0PUplKHMpKSwoYT13LmNzc0hvb2tzW3RdfHx3LmNzc0hvb2tzW3NdKSYmImdldCJpbiBhJiYoaT1hLmdldChlLCEwLG4pKSx2b2lkIDA9PT1pJiYoaT1GZShlLHQscikpLCJub3JtYWwiPT09aSYmdCBpbiBWZSYmKGk9VmVbdF0pLCIiPT09bnx8bj8obz1wYXJzZUZsb2F0KGkpLCEwPT09bnx8aXNGaW5pdGUobyk/b3x8MDppKTppfX0pLHcuZWFjaChbImhlaWdodCIsIndpZHRoIl0sZnVuY3Rpb24oZSx0KXt3LmNzc0hvb2tzW3RdPXtnZXQ6ZnVuY3Rpb24oZSxuLHIpe2lmKG4pcmV0dXJuIXplLnRlc3Qody5jc3MoZSwiZGlzcGxheSIpKXx8ZS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCYmZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aD9ldChlLHQscik6c2UoZSxVZSxmdW5jdGlvbigpe3JldHVybiBldChlLHQscil9KX0sc2V0OmZ1bmN0aW9uKGUsbixyKXt2YXIgaSxvPSRlKGUpLGE9ImJvcmRlci1ib3giPT09dy5jc3MoZSwiYm94U2l6aW5nIiwhMSxvKSxzPXImJlplKGUsdCxyLGEsbyk7cmV0dXJuIGEmJmguc2Nyb2xsYm94U2l6ZSgpPT09by5wb3NpdGlvbiYmKHMtPU1hdGguY2VpbChlWyJvZmZzZXQiK3RbMF0udG9VcHBlckNhc2UoKSt0LnNsaWNlKDEpXS1wYXJzZUZsb2F0KG9bdF0pLVplKGUsdCwiYm9yZGVyIiwhMSxvKS0uNSkpLHMmJihpPWllLmV4ZWMobikpJiYicHgiIT09KGlbM118fCJweCIpJiYoZS5zdHlsZVt0XT1uLG49dy5jc3MoZSx0KSksS2UoZSxuLHMpfX19KSx3LmNzc0hvb2tzLm1hcmdpbkxlZnQ9X2UoaC5yZWxpYWJsZU1hcmdpbkxlZnQsZnVuY3Rpb24oZSx0KXtpZih0KXJldHVybihwYXJzZUZsb2F0KEZlKGUsIm1hcmdpbkxlZnQiKSl8fGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdC1zZShlLHttYXJnaW5MZWZ0OjB9LGZ1bmN0aW9uKCl7cmV0dXJuIGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdH0pKSsicHgifSksdy5lYWNoKHttYXJnaW46IiIscGFkZGluZzoiIixib3JkZXI6IldpZHRoIn0sZnVuY3Rpb24oZSx0KXt3LmNzc0hvb2tzW2UrdF09e2V4cGFuZDpmdW5jdGlvbihuKXtmb3IodmFyIHI9MCxpPXt9LG89InN0cmluZyI9PXR5cGVvZiBuP24uc3BsaXQoIiAiKTpbbl07cjw0O3IrKylpW2Urb2Vbcl0rdF09b1tyXXx8b1tyLTJdfHxvWzBdO3JldHVybiBpfX0sIm1hcmdpbiIhPT1lJiYody5jc3NIb29rc1tlK3RdLnNldD1LZSl9KSx3LmZuLmV4dGVuZCh7Y3NzOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHoodGhpcyxmdW5jdGlvbihlLHQsbil7dmFyIHIsaSxvPXt9LGE9MDtpZihBcnJheS5pc0FycmF5KHQpKXtmb3Iocj0kZShlKSxpPXQubGVuZ3RoO2E8aTthKyspb1t0W2FdXT13LmNzcyhlLHRbYV0sITEscik7cmV0dXJuIG99cmV0dXJuIHZvaWQgMCE9PW4/dy5zdHlsZShlLHQsbik6dy5jc3MoZSx0KX0sZSx0LGFyZ3VtZW50cy5sZW5ndGg+MSl9fSk7ZnVuY3Rpb24gdHQoZSx0LG4scixpKXtyZXR1cm4gbmV3IHR0LnByb3RvdHlwZS5pbml0KGUsdCxuLHIsaSl9dy5Ud2Vlbj10dCx0dC5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOnR0LGluaXQ6ZnVuY3Rpb24oZSx0LG4scixpLG8pe3RoaXMuZWxlbT1lLHRoaXMucHJvcD1uLHRoaXMuZWFzaW5nPWl8fHcuZWFzaW5nLl9kZWZhdWx0LHRoaXMub3B0aW9ucz10LHRoaXMuc3RhcnQ9dGhpcy5ub3c9dGhpcy5jdXIoKSx0aGlzLmVuZD1yLHRoaXMudW5pdD1vfHwody5jc3NOdW1iZXJbbl0/IiI6InB4Iil9LGN1cjpmdW5jdGlvbigpe3ZhciBlPXR0LnByb3BIb29rc1t0aGlzLnByb3BdO3JldHVybiBlJiZlLmdldD9lLmdldCh0aGlzKTp0dC5wcm9wSG9va3MuX2RlZmF1bHQuZ2V0KHRoaXMpfSxydW46ZnVuY3Rpb24oZSl7dmFyIHQsbj10dC5wcm9wSG9va3NbdGhpcy5wcm9wXTtyZXR1cm4gdGhpcy5vcHRpb25zLmR1cmF0aW9uP3RoaXMucG9zPXQ9dy5lYXNpbmdbdGhpcy5lYXNpbmddKGUsdGhpcy5vcHRpb25zLmR1cmF0aW9uKmUsMCwxLHRoaXMub3B0aW9ucy5kdXJhdGlvbik6dGhpcy5wb3M9dD1lLHRoaXMubm93PSh0aGlzLmVuZC10aGlzLnN0YXJ0KSp0K3RoaXMuc3RhcnQsdGhpcy5vcHRpb25zLnN0ZXAmJnRoaXMub3B0aW9ucy5zdGVwLmNhbGwodGhpcy5lbGVtLHRoaXMubm93LHRoaXMpLG4mJm4uc2V0P24uc2V0KHRoaXMpOnR0LnByb3BIb29rcy5fZGVmYXVsdC5zZXQodGhpcyksdGhpc319LHR0LnByb3RvdHlwZS5pbml0LnByb3RvdHlwZT10dC5wcm90b3R5cGUsdHQucHJvcEhvb2tzPXtfZGVmYXVsdDp7Z2V0OmZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiAxIT09ZS5lbGVtLm5vZGVUeXBlfHxudWxsIT1lLmVsZW1bZS5wcm9wXSYmbnVsbD09ZS5lbGVtLnN0eWxlW2UucHJvcF0/ZS5lbGVtW2UucHJvcF06KHQ9dy5jc3MoZS5lbGVtLGUucHJvcCwiIikpJiYiYXV0byIhPT10P3Q6MH0sc2V0OmZ1bmN0aW9uKGUpe3cuZnguc3RlcFtlLnByb3BdP3cuZnguc3RlcFtlLnByb3BdKGUpOjEhPT1lLmVsZW0ubm9kZVR5cGV8fG51bGw9PWUuZWxlbS5zdHlsZVt3LmNzc1Byb3BzW2UucHJvcF1dJiYhdy5jc3NIb29rc1tlLnByb3BdP2UuZWxlbVtlLnByb3BdPWUubm93Oncuc3R5bGUoZS5lbGVtLGUucHJvcCxlLm5vdytlLnVuaXQpfX19LHR0LnByb3BIb29rcy5zY3JvbGxUb3A9dHQucHJvcEhvb2tzLnNjcm9sbExlZnQ9e3NldDpmdW5jdGlvbihlKXtlLmVsZW0ubm9kZVR5cGUmJmUuZWxlbS5wYXJlbnROb2RlJiYoZS5lbGVtW2UucHJvcF09ZS5ub3cpfX0sdy5lYXNpbmc9e2xpbmVhcjpmdW5jdGlvbihlKXtyZXR1cm4gZX0sc3dpbmc6ZnVuY3Rpb24oZSl7cmV0dXJuLjUtTWF0aC5jb3MoZSpNYXRoLlBJKS8yfSxfZGVmYXVsdDoic3dpbmcifSx3LmZ4PXR0LnByb3RvdHlwZS5pbml0LHcuZnguc3RlcD17fTt2YXIgbnQscnQsaXQ9L14oPzp0b2dnbGV8c2hvd3xoaWRlKSQvLG90PS9xdWV1ZUhvb2tzJC87ZnVuY3Rpb24gYXQoKXtydCYmKCExPT09ci5oaWRkZW4mJmUucmVxdWVzdEFuaW1hdGlvbkZyYW1lP2UucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGF0KTplLnNldFRpbWVvdXQoYXQsdy5meC5pbnRlcnZhbCksdy5meC50aWNrKCkpfWZ1bmN0aW9uIHN0KCl7cmV0dXJuIGUuc2V0VGltZW91dChmdW5jdGlvbigpe250PXZvaWQgMH0pLG50PURhdGUubm93KCl9ZnVuY3Rpb24gdXQoZSx0KXt2YXIgbixyPTAsaT17aGVpZ2h0OmV9O2Zvcih0PXQ/MTowO3I8NDtyKz0yLXQpaVsibWFyZ2luIisobj1vZVtyXSldPWlbInBhZGRpbmciK25dPWU7cmV0dXJuIHQmJihpLm9wYWNpdHk9aS53aWR0aD1lKSxpfWZ1bmN0aW9uIGx0KGUsdCxuKXtmb3IodmFyIHIsaT0ocHQudHdlZW5lcnNbdF18fFtdKS5jb25jYXQocHQudHdlZW5lcnNbIioiXSksbz0wLGE9aS5sZW5ndGg7bzxhO28rKylpZihyPWlbb10uY2FsbChuLHQsZSkpcmV0dXJuIHJ9ZnVuY3Rpb24gY3QoZSx0LG4pe3ZhciByLGksbyxhLHMsdSxsLGMsZj0id2lkdGgiaW4gdHx8ImhlaWdodCJpbiB0LHA9dGhpcyxkPXt9LGg9ZS5zdHlsZSxnPWUubm9kZVR5cGUmJmFlKGUpLHk9Si5nZXQoZSwiZnhzaG93Iik7bi5xdWV1ZXx8KG51bGw9PShhPXcuX3F1ZXVlSG9va3MoZSwiZngiKSkudW5xdWV1ZWQmJihhLnVucXVldWVkPTAscz1hLmVtcHR5LmZpcmUsYS5lbXB0eS5maXJlPWZ1bmN0aW9uKCl7YS51bnF1ZXVlZHx8cygpfSksYS51bnF1ZXVlZCsrLHAuYWx3YXlzKGZ1bmN0aW9uKCl7cC5hbHdheXMoZnVuY3Rpb24oKXthLnVucXVldWVkLS0sdy5xdWV1ZShlLCJmeCIpLmxlbmd0aHx8YS5lbXB0eS5maXJlKCl9KX0pKTtmb3IociBpbiB0KWlmKGk9dFtyXSxpdC50ZXN0KGkpKXtpZihkZWxldGUgdFtyXSxvPW98fCJ0b2dnbGUiPT09aSxpPT09KGc/ImhpZGUiOiJzaG93Iikpe2lmKCJzaG93IiE9PWl8fCF5fHx2b2lkIDA9PT15W3JdKWNvbnRpbnVlO2c9ITB9ZFtyXT15JiZ5W3JdfHx3LnN0eWxlKGUscil9aWYoKHU9IXcuaXNFbXB0eU9iamVjdCh0KSl8fCF3LmlzRW1wdHlPYmplY3QoZCkpe2YmJjE9PT1lLm5vZGVUeXBlJiYobi5vdmVyZmxvdz1baC5vdmVyZmxvdyxoLm92ZXJmbG93WCxoLm92ZXJmbG93WV0sbnVsbD09KGw9eSYmeS5kaXNwbGF5KSYmKGw9Si5nZXQoZSwiZGlzcGxheSIpKSwibm9uZSI9PT0oYz13LmNzcyhlLCJkaXNwbGF5IikpJiYobD9jPWw6KGZlKFtlXSwhMCksbD1lLnN0eWxlLmRpc3BsYXl8fGwsYz13LmNzcyhlLCJkaXNwbGF5IiksZmUoW2VdKSkpLCgiaW5saW5lIj09PWN8fCJpbmxpbmUtYmxvY2siPT09YyYmbnVsbCE9bCkmJiJub25lIj09PXcuY3NzKGUsImZsb2F0IikmJih1fHwocC5kb25lKGZ1bmN0aW9uKCl7aC5kaXNwbGF5PWx9KSxudWxsPT1sJiYoYz1oLmRpc3BsYXksbD0ibm9uZSI9PT1jPyIiOmMpKSxoLmRpc3BsYXk9ImlubGluZS1ibG9jayIpKSxuLm92ZXJmbG93JiYoaC5vdmVyZmxvdz0iaGlkZGVuIixwLmFsd2F5cyhmdW5jdGlvbigpe2gub3ZlcmZsb3c9bi5vdmVyZmxvd1swXSxoLm92ZXJmbG93WD1uLm92ZXJmbG93WzFdLGgub3ZlcmZsb3dZPW4ub3ZlcmZsb3dbMl19KSksdT0hMTtmb3IociBpbiBkKXV8fCh5PyJoaWRkZW4iaW4geSYmKGc9eS5oaWRkZW4pOnk9Si5hY2Nlc3MoZSwiZnhzaG93Iix7ZGlzcGxheTpsfSksbyYmKHkuaGlkZGVuPSFnKSxnJiZmZShbZV0sITApLHAuZG9uZShmdW5jdGlvbigpe2d8fGZlKFtlXSksSi5yZW1vdmUoZSwiZnhzaG93Iik7Zm9yKHIgaW4gZCl3LnN0eWxlKGUscixkW3JdKX0pKSx1PWx0KGc/eVtyXTowLHIscCksciBpbiB5fHwoeVtyXT11LnN0YXJ0LGcmJih1LmVuZD11LnN0YXJ0LHUuc3RhcnQ9MCkpfX1mdW5jdGlvbiBmdChlLHQpe3ZhciBuLHIsaSxvLGE7Zm9yKG4gaW4gZSlpZihyPUcobiksaT10W3JdLG89ZVtuXSxBcnJheS5pc0FycmF5KG8pJiYoaT1vWzFdLG89ZVtuXT1vWzBdKSxuIT09ciYmKGVbcl09byxkZWxldGUgZVtuXSksKGE9dy5jc3NIb29rc1tyXSkmJiJleHBhbmQiaW4gYSl7bz1hLmV4cGFuZChvKSxkZWxldGUgZVtyXTtmb3IobiBpbiBvKW4gaW4gZXx8KGVbbl09b1tuXSx0W25dPWkpfWVsc2UgdFtyXT1pfWZ1bmN0aW9uIHB0KGUsdCxuKXt2YXIgcixpLG89MCxhPXB0LnByZWZpbHRlcnMubGVuZ3RoLHM9dy5EZWZlcnJlZCgpLmFsd2F5cyhmdW5jdGlvbigpe2RlbGV0ZSB1LmVsZW19KSx1PWZ1bmN0aW9uKCl7aWYoaSlyZXR1cm4hMTtmb3IodmFyIHQ9bnR8fHN0KCksbj1NYXRoLm1heCgwLGwuc3RhcnRUaW1lK2wuZHVyYXRpb24tdCkscj0xLShuL2wuZHVyYXRpb258fDApLG89MCxhPWwudHdlZW5zLmxlbmd0aDtvPGE7bysrKWwudHdlZW5zW29dLnJ1bihyKTtyZXR1cm4gcy5ub3RpZnlXaXRoKGUsW2wscixuXSkscjwxJiZhP246KGF8fHMubm90aWZ5V2l0aChlLFtsLDEsMF0pLHMucmVzb2x2ZVdpdGgoZSxbbF0pLCExKX0sbD1zLnByb21pc2Uoe2VsZW06ZSxwcm9wczp3LmV4dGVuZCh7fSx0KSxvcHRzOncuZXh0ZW5kKCEwLHtzcGVjaWFsRWFzaW5nOnt9LGVhc2luZzp3LmVhc2luZy5fZGVmYXVsdH0sbiksb3JpZ2luYWxQcm9wZXJ0aWVzOnQsb3JpZ2luYWxPcHRpb25zOm4sc3RhcnRUaW1lOm50fHxzdCgpLGR1cmF0aW9uOm4uZHVyYXRpb24sdHdlZW5zOltdLGNyZWF0ZVR3ZWVuOmZ1bmN0aW9uKHQsbil7dmFyIHI9dy5Ud2VlbihlLGwub3B0cyx0LG4sbC5vcHRzLnNwZWNpYWxFYXNpbmdbdF18fGwub3B0cy5lYXNpbmcpO3JldHVybiBsLnR3ZWVucy5wdXNoKHIpLHJ9LHN0b3A6ZnVuY3Rpb24odCl7dmFyIG49MCxyPXQ/bC50d2VlbnMubGVuZ3RoOjA7aWYoaSlyZXR1cm4gdGhpcztmb3IoaT0hMDtuPHI7bisrKWwudHdlZW5zW25dLnJ1bigxKTtyZXR1cm4gdD8ocy5ub3RpZnlXaXRoKGUsW2wsMSwwXSkscy5yZXNvbHZlV2l0aChlLFtsLHRdKSk6cy5yZWplY3RXaXRoKGUsW2wsdF0pLHRoaXN9fSksYz1sLnByb3BzO2ZvcihmdChjLGwub3B0cy5zcGVjaWFsRWFzaW5nKTtvPGE7bysrKWlmKHI9cHQucHJlZmlsdGVyc1tvXS5jYWxsKGwsZSxjLGwub3B0cykpcmV0dXJuIGcoci5zdG9wKSYmKHcuX3F1ZXVlSG9va3MobC5lbGVtLGwub3B0cy5xdWV1ZSkuc3RvcD1yLnN0b3AuYmluZChyKSkscjtyZXR1cm4gdy5tYXAoYyxsdCxsKSxnKGwub3B0cy5zdGFydCkmJmwub3B0cy5zdGFydC5jYWxsKGUsbCksbC5wcm9ncmVzcyhsLm9wdHMucHJvZ3Jlc3MpLmRvbmUobC5vcHRzLmRvbmUsbC5vcHRzLmNvbXBsZXRlKS5mYWlsKGwub3B0cy5mYWlsKS5hbHdheXMobC5vcHRzLmFsd2F5cyksdy5meC50aW1lcih3LmV4dGVuZCh1LHtlbGVtOmUsYW5pbTpsLHF1ZXVlOmwub3B0cy5xdWV1ZX0pKSxsfXcuQW5pbWF0aW9uPXcuZXh0ZW5kKHB0LHt0d2VlbmVyczp7IioiOltmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMuY3JlYXRlVHdlZW4oZSx0KTtyZXR1cm4gdWUobi5lbGVtLGUsaWUuZXhlYyh0KSxuKSxufV19LHR3ZWVuZXI6ZnVuY3Rpb24oZSx0KXtnKGUpPyh0PWUsZT1bIioiXSk6ZT1lLm1hdGNoKE0pO2Zvcih2YXIgbixyPTAsaT1lLmxlbmd0aDtyPGk7cisrKW49ZVtyXSxwdC50d2VlbmVyc1tuXT1wdC50d2VlbmVyc1tuXXx8W10scHQudHdlZW5lcnNbbl0udW5zaGlmdCh0KX0scHJlZmlsdGVyczpbY3RdLHByZWZpbHRlcjpmdW5jdGlvbihlLHQpe3Q/cHQucHJlZmlsdGVycy51bnNoaWZ0KGUpOnB0LnByZWZpbHRlcnMucHVzaChlKX19KSx3LnNwZWVkPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1lJiYib2JqZWN0Ij09dHlwZW9mIGU/dy5leHRlbmQoe30sZSk6e2NvbXBsZXRlOm58fCFuJiZ0fHxnKGUpJiZlLGR1cmF0aW9uOmUsZWFzaW5nOm4mJnR8fHQmJiFnKHQpJiZ0fTtyZXR1cm4gdy5meC5vZmY/ci5kdXJhdGlvbj0wOiJudW1iZXIiIT10eXBlb2Ygci5kdXJhdGlvbiYmKHIuZHVyYXRpb24gaW4gdy5meC5zcGVlZHM/ci5kdXJhdGlvbj13LmZ4LnNwZWVkc1tyLmR1cmF0aW9uXTpyLmR1cmF0aW9uPXcuZnguc3BlZWRzLl9kZWZhdWx0KSxudWxsIT1yLnF1ZXVlJiYhMCE9PXIucXVldWV8fChyLnF1ZXVlPSJmeCIpLHIub2xkPXIuY29tcGxldGUsci5jb21wbGV0ZT1mdW5jdGlvbigpe2coci5vbGQpJiZyLm9sZC5jYWxsKHRoaXMpLHIucXVldWUmJncuZGVxdWV1ZSh0aGlzLHIucXVldWUpfSxyfSx3LmZuLmV4dGVuZCh7ZmFkZVRvOmZ1bmN0aW9uKGUsdCxuLHIpe3JldHVybiB0aGlzLmZpbHRlcihhZSkuY3NzKCJvcGFjaXR5IiwwKS5zaG93KCkuZW5kKCkuYW5pbWF0ZSh7b3BhY2l0eTp0fSxlLG4scil9LGFuaW1hdGU6ZnVuY3Rpb24oZSx0LG4scil7dmFyIGk9dy5pc0VtcHR5T2JqZWN0KGUpLG89dy5zcGVlZCh0LG4sciksYT1mdW5jdGlvbigpe3ZhciB0PXB0KHRoaXMsdy5leHRlbmQoe30sZSksbyk7KGl8fEouZ2V0KHRoaXMsImZpbmlzaCIpKSYmdC5zdG9wKCEwKX07cmV0dXJuIGEuZmluaXNoPWEsaXx8ITE9PT1vLnF1ZXVlP3RoaXMuZWFjaChhKTp0aGlzLnF1ZXVlKG8ucXVldWUsYSl9LHN0b3A6ZnVuY3Rpb24oZSx0LG4pe3ZhciByPWZ1bmN0aW9uKGUpe3ZhciB0PWUuc3RvcDtkZWxldGUgZS5zdG9wLHQobil9O3JldHVybiJzdHJpbmciIT10eXBlb2YgZSYmKG49dCx0PWUsZT12b2lkIDApLHQmJiExIT09ZSYmdGhpcy5xdWV1ZShlfHwiZngiLFtdKSx0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdD0hMCxpPW51bGwhPWUmJmUrInF1ZXVlSG9va3MiLG89dy50aW1lcnMsYT1KLmdldCh0aGlzKTtpZihpKWFbaV0mJmFbaV0uc3RvcCYmcihhW2ldKTtlbHNlIGZvcihpIGluIGEpYVtpXSYmYVtpXS5zdG9wJiZvdC50ZXN0KGkpJiZyKGFbaV0pO2ZvcihpPW8ubGVuZ3RoO2ktLTspb1tpXS5lbGVtIT09dGhpc3x8bnVsbCE9ZSYmb1tpXS5xdWV1ZSE9PWV8fChvW2ldLmFuaW0uc3RvcChuKSx0PSExLG8uc3BsaWNlKGksMSkpOyF0JiZufHx3LmRlcXVldWUodGhpcyxlKX0pfSxmaW5pc2g6ZnVuY3Rpb24oZSl7cmV0dXJuITEhPT1lJiYoZT1lfHwiZngiKSx0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdCxuPUouZ2V0KHRoaXMpLHI9bltlKyJxdWV1ZSJdLGk9bltlKyJxdWV1ZUhvb2tzIl0sbz13LnRpbWVycyxhPXI/ci5sZW5ndGg6MDtmb3Iobi5maW5pc2g9ITAsdy5xdWV1ZSh0aGlzLGUsW10pLGkmJmkuc3RvcCYmaS5zdG9wLmNhbGwodGhpcywhMCksdD1vLmxlbmd0aDt0LS07KW9bdF0uZWxlbT09PXRoaXMmJm9bdF0ucXVldWU9PT1lJiYob1t0XS5hbmltLnN0b3AoITApLG8uc3BsaWNlKHQsMSkpO2Zvcih0PTA7dDxhO3QrKylyW3RdJiZyW3RdLmZpbmlzaCYmclt0XS5maW5pc2guY2FsbCh0aGlzKTtkZWxldGUgbi5maW5pc2h9KX19KSx3LmVhY2goWyJ0b2dnbGUiLCJzaG93IiwiaGlkZSJdLGZ1bmN0aW9uKGUsdCl7dmFyIG49dy5mblt0XTt3LmZuW3RdPWZ1bmN0aW9uKGUscixpKXtyZXR1cm4gbnVsbD09ZXx8ImJvb2xlYW4iPT10eXBlb2YgZT9uLmFwcGx5KHRoaXMsYXJndW1lbnRzKTp0aGlzLmFuaW1hdGUodXQodCwhMCksZSxyLGkpfX0pLHcuZWFjaCh7c2xpZGVEb3duOnV0KCJzaG93Iiksc2xpZGVVcDp1dCgiaGlkZSIpLHNsaWRlVG9nZ2xlOnV0KCJ0b2dnbGUiKSxmYWRlSW46e29wYWNpdHk6InNob3cifSxmYWRlT3V0OntvcGFjaXR5OiJoaWRlIn0sZmFkZVRvZ2dsZTp7b3BhY2l0eToidG9nZ2xlIn19LGZ1bmN0aW9uKGUsdCl7dy5mbltlXT1mdW5jdGlvbihlLG4scil7cmV0dXJuIHRoaXMuYW5pbWF0ZSh0LGUsbixyKX19KSx3LnRpbWVycz1bXSx3LmZ4LnRpY2s9ZnVuY3Rpb24oKXt2YXIgZSx0PTAsbj13LnRpbWVycztmb3IobnQ9RGF0ZS5ub3coKTt0PG4ubGVuZ3RoO3QrKykoZT1uW3RdKSgpfHxuW3RdIT09ZXx8bi5zcGxpY2UodC0tLDEpO24ubGVuZ3RofHx3LmZ4LnN0b3AoKSxudD12b2lkIDB9LHcuZngudGltZXI9ZnVuY3Rpb24oZSl7dy50aW1lcnMucHVzaChlKSx3LmZ4LnN0YXJ0KCl9LHcuZnguaW50ZXJ2YWw9MTMsdy5meC5zdGFydD1mdW5jdGlvbigpe3J0fHwocnQ9ITAsYXQoKSl9LHcuZnguc3RvcD1mdW5jdGlvbigpe3J0PW51bGx9LHcuZnguc3BlZWRzPXtzbG93OjYwMCxmYXN0OjIwMCxfZGVmYXVsdDo0MDB9LHcuZm4uZGVsYXk9ZnVuY3Rpb24odCxuKXtyZXR1cm4gdD13LmZ4P3cuZnguc3BlZWRzW3RdfHx0OnQsbj1ufHwiZngiLHRoaXMucXVldWUobixmdW5jdGlvbihuLHIpe3ZhciBpPWUuc2V0VGltZW91dChuLHQpO3Iuc3RvcD1mdW5jdGlvbigpe2UuY2xlYXJUaW1lb3V0KGkpfX0pfSxmdW5jdGlvbigpe3ZhciBlPXIuY3JlYXRlRWxlbWVudCgiaW5wdXQiKSx0PXIuY3JlYXRlRWxlbWVudCgic2VsZWN0IikuYXBwZW5kQ2hpbGQoci5jcmVhdGVFbGVtZW50KCJvcHRpb24iKSk7ZS50eXBlPSJjaGVja2JveCIsaC5jaGVja09uPSIiIT09ZS52YWx1ZSxoLm9wdFNlbGVjdGVkPXQuc2VsZWN0ZWQsKGU9ci5jcmVhdGVFbGVtZW50KCJpbnB1dCIpKS52YWx1ZT0idCIsZS50eXBlPSJyYWRpbyIsaC5yYWRpb1ZhbHVlPSJ0Ij09PWUudmFsdWV9KCk7dmFyIGR0LGh0PXcuZXhwci5hdHRySGFuZGxlO3cuZm4uZXh0ZW5kKHthdHRyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHoodGhpcyx3LmF0dHIsZSx0LGFyZ3VtZW50cy5sZW5ndGg+MSl9LHJlbW92ZUF0dHI6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3cucmVtb3ZlQXR0cih0aGlzLGUpfSl9fSksdy5leHRlbmQoe2F0dHI6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbz1lLm5vZGVUeXBlO2lmKDMhPT1vJiY4IT09byYmMiE9PW8pcmV0dXJuInVuZGVmaW5lZCI9PXR5cGVvZiBlLmdldEF0dHJpYnV0ZT93LnByb3AoZSx0LG4pOigxPT09byYmdy5pc1hNTERvYyhlKXx8KGk9dy5hdHRySG9va3NbdC50b0xvd2VyQ2FzZSgpXXx8KHcuZXhwci5tYXRjaC5ib29sLnRlc3QodCk/ZHQ6dm9pZCAwKSksdm9pZCAwIT09bj9udWxsPT09bj92b2lkIHcucmVtb3ZlQXR0cihlLHQpOmkmJiJzZXQiaW4gaSYmdm9pZCAwIT09KHI9aS5zZXQoZSxuLHQpKT9yOihlLnNldEF0dHJpYnV0ZSh0LG4rIiIpLG4pOmkmJiJnZXQiaW4gaSYmbnVsbCE9PShyPWkuZ2V0KGUsdCkpP3I6bnVsbD09KHI9dy5maW5kLmF0dHIoZSx0KSk/dm9pZCAwOnIpfSxhdHRySG9va3M6e3R5cGU6e3NldDpmdW5jdGlvbihlLHQpe2lmKCFoLnJhZGlvVmFsdWUmJiJyYWRpbyI9PT10JiZOKGUsImlucHV0Iikpe3ZhciBuPWUudmFsdWU7cmV0dXJuIGUuc2V0QXR0cmlidXRlKCJ0eXBlIix0KSxuJiYoZS52YWx1ZT1uKSx0fX19fSxyZW1vdmVBdHRyOmZ1bmN0aW9uKGUsdCl7dmFyIG4scj0wLGk9dCYmdC5tYXRjaChNKTtpZihpJiYxPT09ZS5ub2RlVHlwZSl3aGlsZShuPWlbcisrXSllLnJlbW92ZUF0dHJpYnV0ZShuKX19KSxkdD17c2V0OmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4hMT09PXQ/dy5yZW1vdmVBdHRyKGUsbik6ZS5zZXRBdHRyaWJ1dGUobixuKSxufX0sdy5lYWNoKHcuZXhwci5tYXRjaC5ib29sLnNvdXJjZS5tYXRjaCgvXHcrL2cpLGZ1bmN0aW9uKGUsdCl7dmFyIG49aHRbdF18fHcuZmluZC5hdHRyO2h0W3RdPWZ1bmN0aW9uKGUsdCxyKXt2YXIgaSxvLGE9dC50b0xvd2VyQ2FzZSgpO3JldHVybiByfHwobz1odFthXSxodFthXT1pLGk9bnVsbCE9bihlLHQscik/YTpudWxsLGh0W2FdPW8pLGl9fSk7dmFyIGd0PS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2kseXQ9L14oPzphfGFyZWEpJC9pO3cuZm4uZXh0ZW5kKHtwcm9wOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHoodGhpcyx3LnByb3AsZSx0LGFyZ3VtZW50cy5sZW5ndGg+MSl9LHJlbW92ZVByb3A6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2RlbGV0ZSB0aGlzW3cucHJvcEZpeFtlXXx8ZV19KX19KSx3LmV4dGVuZCh7cHJvcDpmdW5jdGlvbihlLHQsbil7dmFyIHIsaSxvPWUubm9kZVR5cGU7aWYoMyE9PW8mJjghPT1vJiYyIT09bylyZXR1cm4gMT09PW8mJncuaXNYTUxEb2MoZSl8fCh0PXcucHJvcEZpeFt0XXx8dCxpPXcucHJvcEhvb2tzW3RdKSx2b2lkIDAhPT1uP2kmJiJzZXQiaW4gaSYmdm9pZCAwIT09KHI9aS5zZXQoZSxuLHQpKT9yOmVbdF09bjppJiYiZ2V0ImluIGkmJm51bGwhPT0ocj1pLmdldChlLHQpKT9yOmVbdF19LHByb3BIb29rczp7dGFiSW5kZXg6e2dldDpmdW5jdGlvbihlKXt2YXIgdD13LmZpbmQuYXR0cihlLCJ0YWJpbmRleCIpO3JldHVybiB0P3BhcnNlSW50KHQsMTApOmd0LnRlc3QoZS5ub2RlTmFtZSl8fHl0LnRlc3QoZS5ub2RlTmFtZSkmJmUuaHJlZj8wOi0xfX19LHByb3BGaXg6eyJmb3IiOiJodG1sRm9yIiwiY2xhc3MiOiJjbGFzc05hbWUifX0pLGgub3B0U2VsZWN0ZWR8fCh3LnByb3BIb29rcy5zZWxlY3RlZD17Z2V0OmZ1bmN0aW9uKGUpe3ZhciB0PWUucGFyZW50Tm9kZTtyZXR1cm4gdCYmdC5wYXJlbnROb2RlJiZ0LnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCxudWxsfSxzZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXJlbnROb2RlO3QmJih0LnNlbGVjdGVkSW5kZXgsdC5wYXJlbnROb2RlJiZ0LnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCl9fSksdy5lYWNoKFsidGFiSW5kZXgiLCJyZWFkT25seSIsIm1heExlbmd0aCIsImNlbGxTcGFjaW5nIiwiY2VsbFBhZGRpbmciLCJyb3dTcGFuIiwiY29sU3BhbiIsInVzZU1hcCIsImZyYW1lQm9yZGVyIiwiY29udGVudEVkaXRhYmxlIl0sZnVuY3Rpb24oKXt3LnByb3BGaXhbdGhpcy50b0xvd2VyQ2FzZSgpXT10aGlzfSk7ZnVuY3Rpb24gdnQoZSl7cmV0dXJuKGUubWF0Y2goTSl8fFtdKS5qb2luKCIgIil9ZnVuY3Rpb24gbXQoZSl7cmV0dXJuIGUuZ2V0QXR0cmlidXRlJiZlLmdldEF0dHJpYnV0ZSgiY2xhc3MiKXx8IiJ9ZnVuY3Rpb24geHQoZSl7cmV0dXJuIEFycmF5LmlzQXJyYXkoZSk/ZToic3RyaW5nIj09dHlwZW9mIGU/ZS5tYXRjaChNKXx8W106W119dy5mbi5leHRlbmQoe2FkZENsYXNzOmZ1bmN0aW9uKGUpe3ZhciB0LG4scixpLG8sYSxzLHU9MDtpZihnKGUpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24odCl7dyh0aGlzKS5hZGRDbGFzcyhlLmNhbGwodGhpcyx0LG10KHRoaXMpKSl9KTtpZigodD14dChlKSkubGVuZ3RoKXdoaWxlKG49dGhpc1t1KytdKWlmKGk9bXQobikscj0xPT09bi5ub2RlVHlwZSYmIiAiK3Z0KGkpKyIgIil7YT0wO3doaWxlKG89dFthKytdKXIuaW5kZXhPZigiICIrbysiICIpPDAmJihyKz1vKyIgIik7aSE9PShzPXZ0KHIpKSYmbi5zZXRBdHRyaWJ1dGUoImNsYXNzIixzKX1yZXR1cm4gdGhpc30scmVtb3ZlQ2xhc3M6ZnVuY3Rpb24oZSl7dmFyIHQsbixyLGksbyxhLHMsdT0wO2lmKGcoZSkpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbih0KXt3KHRoaXMpLnJlbW92ZUNsYXNzKGUuY2FsbCh0aGlzLHQsbXQodGhpcykpKX0pO2lmKCFhcmd1bWVudHMubGVuZ3RoKXJldHVybiB0aGlzLmF0dHIoImNsYXNzIiwiIik7aWYoKHQ9eHQoZSkpLmxlbmd0aCl3aGlsZShuPXRoaXNbdSsrXSlpZihpPW10KG4pLHI9MT09PW4ubm9kZVR5cGUmJiIgIit2dChpKSsiICIpe2E9MDt3aGlsZShvPXRbYSsrXSl3aGlsZShyLmluZGV4T2YoIiAiK28rIiAiKT4tMSlyPXIucmVwbGFjZSgiICIrbysiICIsIiAiKTtpIT09KHM9dnQocikpJiZuLnNldEF0dHJpYnV0ZSgiY2xhc3MiLHMpfXJldHVybiB0aGlzfSx0b2dnbGVDbGFzczpmdW5jdGlvbihlLHQpe3ZhciBuPXR5cGVvZiBlLHI9InN0cmluZyI9PT1ufHxBcnJheS5pc0FycmF5KGUpO3JldHVybiJib29sZWFuIj09dHlwZW9mIHQmJnI/dD90aGlzLmFkZENsYXNzKGUpOnRoaXMucmVtb3ZlQ2xhc3MoZSk6ZyhlKT90aGlzLmVhY2goZnVuY3Rpb24obil7dyh0aGlzKS50b2dnbGVDbGFzcyhlLmNhbGwodGhpcyxuLG10KHRoaXMpLHQpLHQpfSk6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIHQsaSxvLGE7aWYocil7aT0wLG89dyh0aGlzKSxhPXh0KGUpO3doaWxlKHQ9YVtpKytdKW8uaGFzQ2xhc3ModCk/by5yZW1vdmVDbGFzcyh0KTpvLmFkZENsYXNzKHQpfWVsc2Ugdm9pZCAwIT09ZSYmImJvb2xlYW4iIT09bnx8KCh0PW10KHRoaXMpKSYmSi5zZXQodGhpcywiX19jbGFzc05hbWVfXyIsdCksdGhpcy5zZXRBdHRyaWJ1dGUmJnRoaXMuc2V0QXR0cmlidXRlKCJjbGFzcyIsdHx8ITE9PT1lPyIiOkouZ2V0KHRoaXMsIl9fY2xhc3NOYW1lX18iKXx8IiIpKX0pfSxoYXNDbGFzczpmdW5jdGlvbihlKXt2YXIgdCxuLHI9MDt0PSIgIitlKyIgIjt3aGlsZShuPXRoaXNbcisrXSlpZigxPT09bi5ub2RlVHlwZSYmKCIgIit2dChtdChuKSkrIiAiKS5pbmRleE9mKHQpPi0xKXJldHVybiEwO3JldHVybiExfX0pO3ZhciBidD0vXHIvZzt3LmZuLmV4dGVuZCh7dmFsOmZ1bmN0aW9uKGUpe3ZhciB0LG4scixpPXRoaXNbMF07e2lmKGFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHI9ZyhlKSx0aGlzLmVhY2goZnVuY3Rpb24obil7dmFyIGk7MT09PXRoaXMubm9kZVR5cGUmJihudWxsPT0oaT1yP2UuY2FsbCh0aGlzLG4sdyh0aGlzKS52YWwoKSk6ZSk/aT0iIjoibnVtYmVyIj09dHlwZW9mIGk/aSs9IiI6QXJyYXkuaXNBcnJheShpKSYmKGk9dy5tYXAoaSxmdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09ZT8iIjplKyIifSkpLCh0PXcudmFsSG9va3NbdGhpcy50eXBlXXx8dy52YWxIb29rc1t0aGlzLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldKSYmInNldCJpbiB0JiZ2b2lkIDAhPT10LnNldCh0aGlzLGksInZhbHVlIil8fCh0aGlzLnZhbHVlPWkpKX0pO2lmKGkpcmV0dXJuKHQ9dy52YWxIb29rc1tpLnR5cGVdfHx3LnZhbEhvb2tzW2kubm9kZU5hbWUudG9Mb3dlckNhc2UoKV0pJiYiZ2V0ImluIHQmJnZvaWQgMCE9PShuPXQuZ2V0KGksInZhbHVlIikpP246InN0cmluZyI9PXR5cGVvZihuPWkudmFsdWUpP24ucmVwbGFjZShidCwiIik6bnVsbD09bj8iIjpufX19KSx3LmV4dGVuZCh7dmFsSG9va3M6e29wdGlvbjp7Z2V0OmZ1bmN0aW9uKGUpe3ZhciB0PXcuZmluZC5hdHRyKGUsInZhbHVlIik7cmV0dXJuIG51bGwhPXQ/dDp2dCh3LnRleHQoZSkpfX0sc2VsZWN0OntnZXQ6ZnVuY3Rpb24oZSl7dmFyIHQsbixyLGk9ZS5vcHRpb25zLG89ZS5zZWxlY3RlZEluZGV4LGE9InNlbGVjdC1vbmUiPT09ZS50eXBlLHM9YT9udWxsOltdLHU9YT9vKzE6aS5sZW5ndGg7Zm9yKHI9bzwwP3U6YT9vOjA7cjx1O3IrKylpZigoKG49aVtyXSkuc2VsZWN0ZWR8fHI9PT1vKSYmIW4uZGlzYWJsZWQmJighbi5wYXJlbnROb2RlLmRpc2FibGVkfHwhTihuLnBhcmVudE5vZGUsIm9wdGdyb3VwIikpKXtpZih0PXcobikudmFsKCksYSlyZXR1cm4gdDtzLnB1c2godCl9cmV0dXJuIHN9LHNldDpmdW5jdGlvbihlLHQpe3ZhciBuLHIsaT1lLm9wdGlvbnMsbz13Lm1ha2VBcnJheSh0KSxhPWkubGVuZ3RoO3doaWxlKGEtLSkoKHI9aVthXSkuc2VsZWN0ZWQ9dy5pbkFycmF5KHcudmFsSG9va3Mub3B0aW9uLmdldChyKSxvKT4tMSkmJihuPSEwKTtyZXR1cm4gbnx8KGUuc2VsZWN0ZWRJbmRleD0tMSksb319fX0pLHcuZWFjaChbInJhZGlvIiwiY2hlY2tib3giXSxmdW5jdGlvbigpe3cudmFsSG9va3NbdGhpc109e3NldDpmdW5jdGlvbihlLHQpe2lmKEFycmF5LmlzQXJyYXkodCkpcmV0dXJuIGUuY2hlY2tlZD13LmluQXJyYXkodyhlKS52YWwoKSx0KT4tMX19LGguY2hlY2tPbnx8KHcudmFsSG9va3NbdGhpc10uZ2V0PWZ1bmN0aW9uKGUpe3JldHVybiBudWxsPT09ZS5nZXRBdHRyaWJ1dGUoInZhbHVlIik/Im9uIjplLnZhbHVlfSl9KSxoLmZvY3VzaW49Im9uZm9jdXNpbiJpbiBlO3ZhciB3dD0vXig/OmZvY3VzaW5mb2N1c3xmb2N1c291dGJsdXIpJC8sVHQ9ZnVuY3Rpb24oZSl7ZS5zdG9wUHJvcGFnYXRpb24oKX07dy5leHRlbmQody5ldmVudCx7dHJpZ2dlcjpmdW5jdGlvbih0LG4saSxvKXt2YXIgYSxzLHUsbCxjLHAsZCxoLHY9W2l8fHJdLG09Zi5jYWxsKHQsInR5cGUiKT90LnR5cGU6dCx4PWYuY2FsbCh0LCJuYW1lc3BhY2UiKT90Lm5hbWVzcGFjZS5zcGxpdCgiLiIpOltdO2lmKHM9aD11PWk9aXx8ciwzIT09aS5ub2RlVHlwZSYmOCE9PWkubm9kZVR5cGUmJiF3dC50ZXN0KG0rdy5ldmVudC50cmlnZ2VyZWQpJiYobS5pbmRleE9mKCIuIik+LTEmJihtPSh4PW0uc3BsaXQoIi4iKSkuc2hpZnQoKSx4LnNvcnQoKSksYz1tLmluZGV4T2YoIjoiKTwwJiYib24iK20sdD10W3cuZXhwYW5kb10/dDpuZXcgdy5FdmVudChtLCJvYmplY3QiPT10eXBlb2YgdCYmdCksdC5pc1RyaWdnZXI9bz8yOjMsdC5uYW1lc3BhY2U9eC5qb2luKCIuIiksdC5ybmFtZXNwYWNlPXQubmFtZXNwYWNlP25ldyBSZWdFeHAoIihefFxcLikiK3guam9pbigiXFwuKD86LipcXC58KSIpKyIoXFwufCQpIik6bnVsbCx0LnJlc3VsdD12b2lkIDAsdC50YXJnZXR8fCh0LnRhcmdldD1pKSxuPW51bGw9PW4/W3RdOncubWFrZUFycmF5KG4sW3RdKSxkPXcuZXZlbnQuc3BlY2lhbFttXXx8e30sb3x8IWQudHJpZ2dlcnx8ITEhPT1kLnRyaWdnZXIuYXBwbHkoaSxuKSkpe2lmKCFvJiYhZC5ub0J1YmJsZSYmIXkoaSkpe2ZvcihsPWQuZGVsZWdhdGVUeXBlfHxtLHd0LnRlc3QobCttKXx8KHM9cy5wYXJlbnROb2RlKTtzO3M9cy5wYXJlbnROb2RlKXYucHVzaChzKSx1PXM7dT09PShpLm93bmVyRG9jdW1lbnR8fHIpJiZ2LnB1c2godS5kZWZhdWx0Vmlld3x8dS5wYXJlbnRXaW5kb3d8fGUpfWE9MDt3aGlsZSgocz12W2ErK10pJiYhdC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpKWg9cyx0LnR5cGU9YT4xP2w6ZC5iaW5kVHlwZXx8bSwocD0oSi5nZXQocywiZXZlbnRzIil8fHt9KVt0LnR5cGVdJiZKLmdldChzLCJoYW5kbGUiKSkmJnAuYXBwbHkocyxuKSwocD1jJiZzW2NdKSYmcC5hcHBseSYmWShzKSYmKHQucmVzdWx0PXAuYXBwbHkocyxuKSwhMT09PXQucmVzdWx0JiZ0LnByZXZlbnREZWZhdWx0KCkpO3JldHVybiB0LnR5cGU9bSxvfHx0LmlzRGVmYXVsdFByZXZlbnRlZCgpfHxkLl9kZWZhdWx0JiYhMSE9PWQuX2RlZmF1bHQuYXBwbHkodi5wb3AoKSxuKXx8IVkoaSl8fGMmJmcoaVttXSkmJiF5KGkpJiYoKHU9aVtjXSkmJihpW2NdPW51bGwpLHcuZXZlbnQudHJpZ2dlcmVkPW0sdC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpJiZoLmFkZEV2ZW50TGlzdGVuZXIobSxUdCksaVttXSgpLHQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSYmaC5yZW1vdmVFdmVudExpc3RlbmVyKG0sVHQpLHcuZXZlbnQudHJpZ2dlcmVkPXZvaWQgMCx1JiYoaVtjXT11KSksdC5yZXN1bHR9fSxzaW11bGF0ZTpmdW5jdGlvbihlLHQsbil7dmFyIHI9dy5leHRlbmQobmV3IHcuRXZlbnQsbix7dHlwZTplLGlzU2ltdWxhdGVkOiEwfSk7dy5ldmVudC50cmlnZ2VyKHIsbnVsbCx0KX19KSx3LmZuLmV4dGVuZCh7dHJpZ2dlcjpmdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt3LmV2ZW50LnRyaWdnZXIoZSx0LHRoaXMpfSl9LHRyaWdnZXJIYW5kbGVyOmZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpc1swXTtpZihuKXJldHVybiB3LmV2ZW50LnRyaWdnZXIoZSx0LG4sITApfX0pLGguZm9jdXNpbnx8dy5lYWNoKHtmb2N1czoiZm9jdXNpbiIsYmx1cjoiZm9jdXNvdXQifSxmdW5jdGlvbihlLHQpe3ZhciBuPWZ1bmN0aW9uKGUpe3cuZXZlbnQuc2ltdWxhdGUodCxlLnRhcmdldCx3LmV2ZW50LmZpeChlKSl9O3cuZXZlbnQuc3BlY2lhbFt0XT17c2V0dXA6ZnVuY3Rpb24oKXt2YXIgcj10aGlzLm93bmVyRG9jdW1lbnR8fHRoaXMsaT1KLmFjY2VzcyhyLHQpO2l8fHIuYWRkRXZlbnRMaXN0ZW5lcihlLG4sITApLEouYWNjZXNzKHIsdCwoaXx8MCkrMSl9LHRlYXJkb3duOmZ1bmN0aW9uKCl7dmFyIHI9dGhpcy5vd25lckRvY3VtZW50fHx0aGlzLGk9Si5hY2Nlc3Mocix0KS0xO2k/Si5hY2Nlc3Mocix0LGkpOihyLnJlbW92ZUV2ZW50TGlzdGVuZXIoZSxuLCEwKSxKLnJlbW92ZShyLHQpKX19fSk7dmFyIEN0PWUubG9jYXRpb24sRXQ9RGF0ZS5ub3coKSxrdD0vXD8vO3cucGFyc2VYTUw9ZnVuY3Rpb24odCl7dmFyIG47aWYoIXR8fCJzdHJpbmciIT10eXBlb2YgdClyZXR1cm4gbnVsbDt0cnl7bj0obmV3IGUuRE9NUGFyc2VyKS5wYXJzZUZyb21TdHJpbmcodCwidGV4dC94bWwiKX1jYXRjaChlKXtuPXZvaWQgMH1yZXR1cm4gbiYmIW4uZ2V0RWxlbWVudHNCeVRhZ05hbWUoInBhcnNlcmVycm9yIikubGVuZ3RofHx3LmVycm9yKCJJbnZhbGlkIFhNTDogIit0KSxufTt2YXIgU3Q9L1xbXF0kLyxEdD0vXHI/XG4vZyxOdD0vXig/OnN1Ym1pdHxidXR0b258aW1hZ2V8cmVzZXR8ZmlsZSkkL2ksQXQ9L14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8a2V5Z2VuKS9pO2Z1bmN0aW9uIGp0KGUsdCxuLHIpe3ZhciBpO2lmKEFycmF5LmlzQXJyYXkodCkpdy5lYWNoKHQsZnVuY3Rpb24odCxpKXtufHxTdC50ZXN0KGUpP3IoZSxpKTpqdChlKyJbIisoIm9iamVjdCI9PXR5cGVvZiBpJiZudWxsIT1pP3Q6IiIpKyJdIixpLG4scil9KTtlbHNlIGlmKG58fCJvYmplY3QiIT09eCh0KSlyKGUsdCk7ZWxzZSBmb3IoaSBpbiB0KWp0KGUrIlsiK2krIl0iLHRbaV0sbixyKX13LnBhcmFtPWZ1bmN0aW9uKGUsdCl7dmFyIG4scj1bXSxpPWZ1bmN0aW9uKGUsdCl7dmFyIG49Zyh0KT90KCk6dDtyW3IubGVuZ3RoXT1lbmNvZGVVUklDb21wb25lbnQoZSkrIj0iK2VuY29kZVVSSUNvbXBvbmVudChudWxsPT1uPyIiOm4pfTtpZihBcnJheS5pc0FycmF5KGUpfHxlLmpxdWVyeSYmIXcuaXNQbGFpbk9iamVjdChlKSl3LmVhY2goZSxmdW5jdGlvbigpe2kodGhpcy5uYW1lLHRoaXMudmFsdWUpfSk7ZWxzZSBmb3IobiBpbiBlKWp0KG4sZVtuXSx0LGkpO3JldHVybiByLmpvaW4oIiYiKX0sdy5mbi5leHRlbmQoe3NlcmlhbGl6ZTpmdW5jdGlvbigpe3JldHVybiB3LnBhcmFtKHRoaXMuc2VyaWFsaXplQXJyYXkoKSl9LHNlcmlhbGl6ZUFycmF5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCl7dmFyIGU9dy5wcm9wKHRoaXMsImVsZW1lbnRzIik7cmV0dXJuIGU/dy5tYWtlQXJyYXkoZSk6dGhpc30pLmZpbHRlcihmdW5jdGlvbigpe3ZhciBlPXRoaXMudHlwZTtyZXR1cm4gdGhpcy5uYW1lJiYhdyh0aGlzKS5pcygiOmRpc2FibGVkIikmJkF0LnRlc3QodGhpcy5ub2RlTmFtZSkmJiFOdC50ZXN0KGUpJiYodGhpcy5jaGVja2VkfHwhcGUudGVzdChlKSl9KS5tYXAoZnVuY3Rpb24oZSx0KXt2YXIgbj13KHRoaXMpLnZhbCgpO3JldHVybiBudWxsPT1uP251bGw6QXJyYXkuaXNBcnJheShuKT93Lm1hcChuLGZ1bmN0aW9uKGUpe3JldHVybntuYW1lOnQubmFtZSx2YWx1ZTplLnJlcGxhY2UoRHQsIlxyXG4iKX19KTp7bmFtZTp0Lm5hbWUsdmFsdWU6bi5yZXBsYWNlKER0LCJcclxuIil9fSkuZ2V0KCl9fSk7dmFyIHF0PS8lMjAvZyxMdD0vIy4qJC8sSHQ9LyhbPyZdKV89W14mXSovLE90PS9eKC4qPyk6WyBcdF0qKFteXHJcbl0qKSQvZ20sUHQ9L14oPzphYm91dHxhcHB8YXBwLXN0b3JhZ2V8ListZXh0ZW5zaW9ufGZpbGV8cmVzfHdpZGdldCk6JC8sTXQ9L14oPzpHRVR8SEVBRCkkLyxSdD0vXlwvXC8vLEl0PXt9LFd0PXt9LCR0PSIqLyIuY29uY2F0KCIqIiksQnQ9ci5jcmVhdGVFbGVtZW50KCJhIik7QnQuaHJlZj1DdC5ocmVmO2Z1bmN0aW9uIEZ0KGUpe3JldHVybiBmdW5jdGlvbih0LG4peyJzdHJpbmciIT10eXBlb2YgdCYmKG49dCx0PSIqIik7dmFyIHIsaT0wLG89dC50b0xvd2VyQ2FzZSgpLm1hdGNoKE0pfHxbXTtpZihnKG4pKXdoaWxlKHI9b1tpKytdKSIrIj09PXJbMF0/KHI9ci5zbGljZSgxKXx8IioiLChlW3JdPWVbcl18fFtdKS51bnNoaWZ0KG4pKTooZVtyXT1lW3JdfHxbXSkucHVzaChuKX19ZnVuY3Rpb24gX3QoZSx0LG4scil7dmFyIGk9e30sbz1lPT09V3Q7ZnVuY3Rpb24gYShzKXt2YXIgdTtyZXR1cm4gaVtzXT0hMCx3LmVhY2goZVtzXXx8W10sZnVuY3Rpb24oZSxzKXt2YXIgbD1zKHQsbixyKTtyZXR1cm4ic3RyaW5nIiE9dHlwZW9mIGx8fG98fGlbbF0/bz8hKHU9bCk6dm9pZCAwOih0LmRhdGFUeXBlcy51bnNoaWZ0KGwpLGEobCksITEpfSksdX1yZXR1cm4gYSh0LmRhdGFUeXBlc1swXSl8fCFpWyIqIl0mJmEoIioiKX1mdW5jdGlvbiB6dChlLHQpe3ZhciBuLHIsaT13LmFqYXhTZXR0aW5ncy5mbGF0T3B0aW9uc3x8e307Zm9yKG4gaW4gdCl2b2lkIDAhPT10W25dJiYoKGlbbl0/ZTpyfHwocj17fSkpW25dPXRbbl0pO3JldHVybiByJiZ3LmV4dGVuZCghMCxlLHIpLGV9ZnVuY3Rpb24gWHQoZSx0LG4pe3ZhciByLGksbyxhLHM9ZS5jb250ZW50cyx1PWUuZGF0YVR5cGVzO3doaWxlKCIqIj09PXVbMF0pdS5zaGlmdCgpLHZvaWQgMD09PXImJihyPWUubWltZVR5cGV8fHQuZ2V0UmVzcG9uc2VIZWFkZXIoIkNvbnRlbnQtVHlwZSIpKTtpZihyKWZvcihpIGluIHMpaWYoc1tpXSYmc1tpXS50ZXN0KHIpKXt1LnVuc2hpZnQoaSk7YnJlYWt9aWYodVswXWluIG4pbz11WzBdO2Vsc2V7Zm9yKGkgaW4gbil7aWYoIXVbMF18fGUuY29udmVydGVyc1tpKyIgIit1WzBdXSl7bz1pO2JyZWFrfWF8fChhPWkpfW89b3x8YX1pZihvKXJldHVybiBvIT09dVswXSYmdS51bnNoaWZ0KG8pLG5bb119ZnVuY3Rpb24gVXQoZSx0LG4scil7dmFyIGksbyxhLHMsdSxsPXt9LGM9ZS5kYXRhVHlwZXMuc2xpY2UoKTtpZihjWzFdKWZvcihhIGluIGUuY29udmVydGVycylsW2EudG9Mb3dlckNhc2UoKV09ZS5jb252ZXJ0ZXJzW2FdO289Yy5zaGlmdCgpO3doaWxlKG8paWYoZS5yZXNwb25zZUZpZWxkc1tvXSYmKG5bZS5yZXNwb25zZUZpZWxkc1tvXV09dCksIXUmJnImJmUuZGF0YUZpbHRlciYmKHQ9ZS5kYXRhRmlsdGVyKHQsZS5kYXRhVHlwZSkpLHU9byxvPWMuc2hpZnQoKSlpZigiKiI9PT1vKW89dTtlbHNlIGlmKCIqIiE9PXUmJnUhPT1vKXtpZighKGE9bFt1KyIgIitvXXx8bFsiKiAiK29dKSlmb3IoaSBpbiBsKWlmKChzPWkuc3BsaXQoIiAiKSlbMV09PT1vJiYoYT1sW3UrIiAiK3NbMF1dfHxsWyIqICIrc1swXV0pKXshMD09PWE/YT1sW2ldOiEwIT09bFtpXSYmKG89c1swXSxjLnVuc2hpZnQoc1sxXSkpO2JyZWFrfWlmKCEwIT09YSlpZihhJiZlWyJ0aHJvd3MiXSl0PWEodCk7ZWxzZSB0cnl7dD1hKHQpfWNhdGNoKGUpe3JldHVybntzdGF0ZToicGFyc2VyZXJyb3IiLGVycm9yOmE/ZToiTm8gY29udmVyc2lvbiBmcm9tICIrdSsiIHRvICIrb319fXJldHVybntzdGF0ZToic3VjY2VzcyIsZGF0YTp0fX13LmV4dGVuZCh7YWN0aXZlOjAsbGFzdE1vZGlmaWVkOnt9LGV0YWc6e30sYWpheFNldHRpbmdzOnt1cmw6Q3QuaHJlZix0eXBlOiJHRVQiLGlzTG9jYWw6UHQudGVzdChDdC5wcm90b2NvbCksZ2xvYmFsOiEwLHByb2Nlc3NEYXRhOiEwLGFzeW5jOiEwLGNvbnRlbnRUeXBlOiJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgiLGFjY2VwdHM6eyIqIjokdCx0ZXh0OiJ0ZXh0L3BsYWluIixodG1sOiJ0ZXh0L2h0bWwiLHhtbDoiYXBwbGljYXRpb24veG1sLCB0ZXh0L3htbCIsanNvbjoiYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0In0sY29udGVudHM6e3htbDovXGJ4bWxcYi8saHRtbDovXGJodG1sLyxqc29uOi9cYmpzb25cYi99LHJlc3BvbnNlRmllbGRzOnt4bWw6InJlc3BvbnNlWE1MIix0ZXh0OiJyZXNwb25zZVRleHQiLGpzb246InJlc3BvbnNlSlNPTiJ9LGNvbnZlcnRlcnM6eyIqIHRleHQiOlN0cmluZywidGV4dCBodG1sIjohMCwidGV4dCBqc29uIjpKU09OLnBhcnNlLCJ0ZXh0IHhtbCI6dy5wYXJzZVhNTH0sZmxhdE9wdGlvbnM6e3VybDohMCxjb250ZXh0OiEwfX0sYWpheFNldHVwOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQ/enQoenQoZSx3LmFqYXhTZXR0aW5ncyksdCk6enQody5hamF4U2V0dGluZ3MsZSl9LGFqYXhQcmVmaWx0ZXI6RnQoSXQpLGFqYXhUcmFuc3BvcnQ6RnQoV3QpLGFqYXg6ZnVuY3Rpb24odCxuKXsib2JqZWN0Ij09dHlwZW9mIHQmJihuPXQsdD12b2lkIDApLG49bnx8e307dmFyIGksbyxhLHMsdSxsLGMsZixwLGQsaD13LmFqYXhTZXR1cCh7fSxuKSxnPWguY29udGV4dHx8aCx5PWguY29udGV4dCYmKGcubm9kZVR5cGV8fGcuanF1ZXJ5KT93KGcpOncuZXZlbnQsdj13LkRlZmVycmVkKCksbT13LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSx4PWguc3RhdHVzQ29kZXx8e30sYj17fSxUPXt9LEM9ImNhbmNlbGVkIixFPXtyZWFkeVN0YXRlOjAsZ2V0UmVzcG9uc2VIZWFkZXI6ZnVuY3Rpb24oZSl7dmFyIHQ7aWYoYyl7aWYoIXMpe3M9e307d2hpbGUodD1PdC5leGVjKGEpKXNbdFsxXS50b0xvd2VyQ2FzZSgpXT10WzJdfXQ9c1tlLnRvTG93ZXJDYXNlKCldfXJldHVybiBudWxsPT10P251bGw6dH0sZ2V0QWxsUmVzcG9uc2VIZWFkZXJzOmZ1bmN0aW9uKCl7cmV0dXJuIGM/YTpudWxsfSxzZXRSZXF1ZXN0SGVhZGVyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIG51bGw9PWMmJihlPVRbZS50b0xvd2VyQ2FzZSgpXT1UW2UudG9Mb3dlckNhc2UoKV18fGUsYltlXT10KSx0aGlzfSxvdmVycmlkZU1pbWVUeXBlOmZ1bmN0aW9uKGUpe3JldHVybiBudWxsPT1jJiYoaC5taW1lVHlwZT1lKSx0aGlzfSxzdGF0dXNDb2RlOmZ1bmN0aW9uKGUpe3ZhciB0O2lmKGUpaWYoYylFLmFsd2F5cyhlW0Uuc3RhdHVzXSk7ZWxzZSBmb3IodCBpbiBlKXhbdF09W3hbdF0sZVt0XV07cmV0dXJuIHRoaXN9LGFib3J0OmZ1bmN0aW9uKGUpe3ZhciB0PWV8fEM7cmV0dXJuIGkmJmkuYWJvcnQodCksaygwLHQpLHRoaXN9fTtpZih2LnByb21pc2UoRSksaC51cmw9KCh0fHxoLnVybHx8Q3QuaHJlZikrIiIpLnJlcGxhY2UoUnQsQ3QucHJvdG9jb2wrIi8vIiksaC50eXBlPW4ubWV0aG9kfHxuLnR5cGV8fGgubWV0aG9kfHxoLnR5cGUsaC5kYXRhVHlwZXM9KGguZGF0YVR5cGV8fCIqIikudG9Mb3dlckNhc2UoKS5tYXRjaChNKXx8WyIiXSxudWxsPT1oLmNyb3NzRG9tYWluKXtsPXIuY3JlYXRlRWxlbWVudCgiYSIpO3RyeXtsLmhyZWY9aC51cmwsbC5ocmVmPWwuaHJlZixoLmNyb3NzRG9tYWluPUJ0LnByb3RvY29sKyIvLyIrQnQuaG9zdCE9bC5wcm90b2NvbCsiLy8iK2wuaG9zdH1jYXRjaChlKXtoLmNyb3NzRG9tYWluPSEwfX1pZihoLmRhdGEmJmgucHJvY2Vzc0RhdGEmJiJzdHJpbmciIT10eXBlb2YgaC5kYXRhJiYoaC5kYXRhPXcucGFyYW0oaC5kYXRhLGgudHJhZGl0aW9uYWwpKSxfdChJdCxoLG4sRSksYylyZXR1cm4gRTsoZj13LmV2ZW50JiZoLmdsb2JhbCkmJjA9PXcuYWN0aXZlKysmJncuZXZlbnQudHJpZ2dlcigiYWpheFN0YXJ0IiksaC50eXBlPWgudHlwZS50b1VwcGVyQ2FzZSgpLGguaGFzQ29udGVudD0hTXQudGVzdChoLnR5cGUpLG89aC51cmwucmVwbGFjZShMdCwiIiksaC5oYXNDb250ZW50P2guZGF0YSYmaC5wcm9jZXNzRGF0YSYmMD09PShoLmNvbnRlbnRUeXBlfHwiIikuaW5kZXhPZigiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIikmJihoLmRhdGE9aC5kYXRhLnJlcGxhY2UocXQsIisiKSk6KGQ9aC51cmwuc2xpY2Uoby5sZW5ndGgpLGguZGF0YSYmKGgucHJvY2Vzc0RhdGF8fCJzdHJpbmciPT10eXBlb2YgaC5kYXRhKSYmKG8rPShrdC50ZXN0KG8pPyImIjoiPyIpK2guZGF0YSxkZWxldGUgaC5kYXRhKSwhMT09PWguY2FjaGUmJihvPW8ucmVwbGFjZShIdCwiJDEiKSxkPShrdC50ZXN0KG8pPyImIjoiPyIpKyJfPSIrRXQrKytkKSxoLnVybD1vK2QpLGguaWZNb2RpZmllZCYmKHcubGFzdE1vZGlmaWVkW29dJiZFLnNldFJlcXVlc3RIZWFkZXIoIklmLU1vZGlmaWVkLVNpbmNlIix3Lmxhc3RNb2RpZmllZFtvXSksdy5ldGFnW29dJiZFLnNldFJlcXVlc3RIZWFkZXIoIklmLU5vbmUtTWF0Y2giLHcuZXRhZ1tvXSkpLChoLmRhdGEmJmguaGFzQ29udGVudCYmITEhPT1oLmNvbnRlbnRUeXBlfHxuLmNvbnRlbnRUeXBlKSYmRS5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLGguY29udGVudFR5cGUpLEUuc2V0UmVxdWVzdEhlYWRlcigiQWNjZXB0IixoLmRhdGFUeXBlc1swXSYmaC5hY2NlcHRzW2guZGF0YVR5cGVzWzBdXT9oLmFjY2VwdHNbaC5kYXRhVHlwZXNbMF1dKygiKiIhPT1oLmRhdGFUeXBlc1swXT8iLCAiKyR0KyI7IHE9MC4wMSI6IiIpOmguYWNjZXB0c1siKiJdKTtmb3IocCBpbiBoLmhlYWRlcnMpRS5zZXRSZXF1ZXN0SGVhZGVyKHAsaC5oZWFkZXJzW3BdKTtpZihoLmJlZm9yZVNlbmQmJighMT09PWguYmVmb3JlU2VuZC5jYWxsKGcsRSxoKXx8YykpcmV0dXJuIEUuYWJvcnQoKTtpZihDPSJhYm9ydCIsbS5hZGQoaC5jb21wbGV0ZSksRS5kb25lKGguc3VjY2VzcyksRS5mYWlsKGguZXJyb3IpLGk9X3QoV3QsaCxuLEUpKXtpZihFLnJlYWR5U3RhdGU9MSxmJiZ5LnRyaWdnZXIoImFqYXhTZW5kIixbRSxoXSksYylyZXR1cm4gRTtoLmFzeW5jJiZoLnRpbWVvdXQ+MCYmKHU9ZS5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7RS5hYm9ydCgidGltZW91dCIpfSxoLnRpbWVvdXQpKTt0cnl7Yz0hMSxpLnNlbmQoYixrKX1jYXRjaChlKXtpZihjKXRocm93IGU7aygtMSxlKX19ZWxzZSBrKC0xLCJObyBUcmFuc3BvcnQiKTtmdW5jdGlvbiBrKHQsbixyLHMpe3ZhciBsLHAsZCxiLFQsQz1uO2N8fChjPSEwLHUmJmUuY2xlYXJUaW1lb3V0KHUpLGk9dm9pZCAwLGE9c3x8IiIsRS5yZWFkeVN0YXRlPXQ+MD80OjAsbD10Pj0yMDAmJnQ8MzAwfHwzMDQ9PT10LHImJihiPVh0KGgsRSxyKSksYj1VdChoLGIsRSxsKSxsPyhoLmlmTW9kaWZpZWQmJigoVD1FLmdldFJlc3BvbnNlSGVhZGVyKCJMYXN0LU1vZGlmaWVkIikpJiYody5sYXN0TW9kaWZpZWRbb109VCksKFQ9RS5nZXRSZXNwb25zZUhlYWRlcigiZXRhZyIpKSYmKHcuZXRhZ1tvXT1UKSksMjA0PT09dHx8IkhFQUQiPT09aC50eXBlP0M9Im5vY29udGVudCI6MzA0PT09dD9DPSJub3Rtb2RpZmllZCI6KEM9Yi5zdGF0ZSxwPWIuZGF0YSxsPSEoZD1iLmVycm9yKSkpOihkPUMsIXQmJkN8fChDPSJlcnJvciIsdDwwJiYodD0wKSkpLEUuc3RhdHVzPXQsRS5zdGF0dXNUZXh0PShufHxDKSsiIixsP3YucmVzb2x2ZVdpdGgoZyxbcCxDLEVdKTp2LnJlamVjdFdpdGgoZyxbRSxDLGRdKSxFLnN0YXR1c0NvZGUoeCkseD12b2lkIDAsZiYmeS50cmlnZ2VyKGw/ImFqYXhTdWNjZXNzIjoiYWpheEVycm9yIixbRSxoLGw/cDpkXSksbS5maXJlV2l0aChnLFtFLENdKSxmJiYoeS50cmlnZ2VyKCJhamF4Q29tcGxldGUiLFtFLGhdKSwtLXcuYWN0aXZlfHx3LmV2ZW50LnRyaWdnZXIoImFqYXhTdG9wIikpKX1yZXR1cm4gRX0sZ2V0SlNPTjpmdW5jdGlvbihlLHQsbil7cmV0dXJuIHcuZ2V0KGUsdCxuLCJqc29uIil9LGdldFNjcmlwdDpmdW5jdGlvbihlLHQpe3JldHVybiB3LmdldChlLHZvaWQgMCx0LCJzY3JpcHQiKX19KSx3LmVhY2goWyJnZXQiLCJwb3N0Il0sZnVuY3Rpb24oZSx0KXt3W3RdPWZ1bmN0aW9uKGUsbixyLGkpe3JldHVybiBnKG4pJiYoaT1pfHxyLHI9bixuPXZvaWQgMCksdy5hamF4KHcuZXh0ZW5kKHt1cmw6ZSx0eXBlOnQsZGF0YVR5cGU6aSxkYXRhOm4sc3VjY2VzczpyfSx3LmlzUGxhaW5PYmplY3QoZSkmJmUpKX19KSx3Ll9ldmFsVXJsPWZ1bmN0aW9uKGUpe3JldHVybiB3LmFqYXgoe3VybDplLHR5cGU6IkdFVCIsZGF0YVR5cGU6InNjcmlwdCIsY2FjaGU6ITAsYXN5bmM6ITEsZ2xvYmFsOiExLCJ0aHJvd3MiOiEwfSl9LHcuZm4uZXh0ZW5kKHt3cmFwQWxsOmZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiB0aGlzWzBdJiYoZyhlKSYmKGU9ZS5jYWxsKHRoaXNbMF0pKSx0PXcoZSx0aGlzWzBdLm93bmVyRG9jdW1lbnQpLmVxKDApLmNsb25lKCEwKSx0aGlzWzBdLnBhcmVudE5vZGUmJnQuaW5zZXJ0QmVmb3JlKHRoaXNbMF0pLHQubWFwKGZ1bmN0aW9uKCl7dmFyIGU9dGhpczt3aGlsZShlLmZpcnN0RWxlbWVudENoaWxkKWU9ZS5maXJzdEVsZW1lbnRDaGlsZDtyZXR1cm4gZX0pLmFwcGVuZCh0aGlzKSksdGhpc30sd3JhcElubmVyOmZ1bmN0aW9uKGUpe3JldHVybiBnKGUpP3RoaXMuZWFjaChmdW5jdGlvbih0KXt3KHRoaXMpLndyYXBJbm5lcihlLmNhbGwodGhpcyx0KSl9KTp0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdD13KHRoaXMpLG49dC5jb250ZW50cygpO24ubGVuZ3RoP24ud3JhcEFsbChlKTp0LmFwcGVuZChlKX0pfSx3cmFwOmZ1bmN0aW9uKGUpe3ZhciB0PWcoZSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihuKXt3KHRoaXMpLndyYXBBbGwodD9lLmNhbGwodGhpcyxuKTplKX0pfSx1bndyYXA6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucGFyZW50KGUpLm5vdCgiYm9keSIpLmVhY2goZnVuY3Rpb24oKXt3KHRoaXMpLnJlcGxhY2VXaXRoKHRoaXMuY2hpbGROb2Rlcyl9KSx0aGlzfX0pLHcuZXhwci5wc2V1ZG9zLmhpZGRlbj1mdW5jdGlvbihlKXtyZXR1cm4hdy5leHByLnBzZXVkb3MudmlzaWJsZShlKX0sdy5leHByLnBzZXVkb3MudmlzaWJsZT1mdW5jdGlvbihlKXtyZXR1cm4hIShlLm9mZnNldFdpZHRofHxlLm9mZnNldEhlaWdodHx8ZS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCl9LHcuYWpheFNldHRpbmdzLnhocj1mdW5jdGlvbigpe3RyeXtyZXR1cm4gbmV3IGUuWE1MSHR0cFJlcXVlc3R9Y2F0Y2goZSl7fX07dmFyIFZ0PXswOjIwMCwxMjIzOjIwNH0sR3Q9dy5hamF4U2V0dGluZ3MueGhyKCk7aC5jb3JzPSEhR3QmJiJ3aXRoQ3JlZGVudGlhbHMiaW4gR3QsaC5hamF4PUd0PSEhR3Qsdy5hamF4VHJhbnNwb3J0KGZ1bmN0aW9uKHQpe3ZhciBuLHI7aWYoaC5jb3JzfHxHdCYmIXQuY3Jvc3NEb21haW4pcmV0dXJue3NlbmQ6ZnVuY3Rpb24oaSxvKXt2YXIgYSxzPXQueGhyKCk7aWYocy5vcGVuKHQudHlwZSx0LnVybCx0LmFzeW5jLHQudXNlcm5hbWUsdC5wYXNzd29yZCksdC54aHJGaWVsZHMpZm9yKGEgaW4gdC54aHJGaWVsZHMpc1thXT10LnhockZpZWxkc1thXTt0Lm1pbWVUeXBlJiZzLm92ZXJyaWRlTWltZVR5cGUmJnMub3ZlcnJpZGVNaW1lVHlwZSh0Lm1pbWVUeXBlKSx0LmNyb3NzRG9tYWlufHxpWyJYLVJlcXVlc3RlZC1XaXRoIl18fChpWyJYLVJlcXVlc3RlZC1XaXRoIl09IlhNTEh0dHBSZXF1ZXN0Iik7Zm9yKGEgaW4gaSlzLnNldFJlcXVlc3RIZWFkZXIoYSxpW2FdKTtuPWZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbigpe24mJihuPXI9cy5vbmxvYWQ9cy5vbmVycm9yPXMub25hYm9ydD1zLm9udGltZW91dD1zLm9ucmVhZHlzdGF0ZWNoYW5nZT1udWxsLCJhYm9ydCI9PT1lP3MuYWJvcnQoKToiZXJyb3IiPT09ZT8ibnVtYmVyIiE9dHlwZW9mIHMuc3RhdHVzP28oMCwiZXJyb3IiKTpvKHMuc3RhdHVzLHMuc3RhdHVzVGV4dCk6byhWdFtzLnN0YXR1c118fHMuc3RhdHVzLHMuc3RhdHVzVGV4dCwidGV4dCIhPT0ocy5yZXNwb25zZVR5cGV8fCJ0ZXh0Iil8fCJzdHJpbmciIT10eXBlb2Ygcy5yZXNwb25zZVRleHQ/e2JpbmFyeTpzLnJlc3BvbnNlfTp7dGV4dDpzLnJlc3BvbnNlVGV4dH0scy5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSkpfX0scy5vbmxvYWQ9bigpLHI9cy5vbmVycm9yPXMub250aW1lb3V0PW4oImVycm9yIiksdm9pZCAwIT09cy5vbmFib3J0P3Mub25hYm9ydD1yOnMub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7ND09PXMucmVhZHlTdGF0ZSYmZS5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7biYmcigpfSl9LG49bigiYWJvcnQiKTt0cnl7cy5zZW5kKHQuaGFzQ29udGVudCYmdC5kYXRhfHxudWxsKX1jYXRjaChlKXtpZihuKXRocm93IGV9fSxhYm9ydDpmdW5jdGlvbigpe24mJm4oKX19fSksdy5hamF4UHJlZmlsdGVyKGZ1bmN0aW9uKGUpe2UuY3Jvc3NEb21haW4mJihlLmNvbnRlbnRzLnNjcmlwdD0hMSl9KSx3LmFqYXhTZXR1cCh7YWNjZXB0czp7c2NyaXB0OiJ0ZXh0L2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2VjbWFzY3JpcHQsIGFwcGxpY2F0aW9uL3gtZWNtYXNjcmlwdCJ9LGNvbnRlbnRzOntzY3JpcHQ6L1xiKD86amF2YXxlY21hKXNjcmlwdFxiL30sY29udmVydGVyczp7InRleHQgc2NyaXB0IjpmdW5jdGlvbihlKXtyZXR1cm4gdy5nbG9iYWxFdmFsKGUpLGV9fX0pLHcuYWpheFByZWZpbHRlcigic2NyaXB0IixmdW5jdGlvbihlKXt2b2lkIDA9PT1lLmNhY2hlJiYoZS5jYWNoZT0hMSksZS5jcm9zc0RvbWFpbiYmKGUudHlwZT0iR0VUIil9KSx3LmFqYXhUcmFuc3BvcnQoInNjcmlwdCIsZnVuY3Rpb24oZSl7aWYoZS5jcm9zc0RvbWFpbil7dmFyIHQsbjtyZXR1cm57c2VuZDpmdW5jdGlvbihpLG8pe3Q9dygiPHNjcmlwdD4iKS5wcm9wKHtjaGFyc2V0OmUuc2NyaXB0Q2hhcnNldCxzcmM6ZS51cmx9KS5vbigibG9hZCBlcnJvciIsbj1mdW5jdGlvbihlKXt0LnJlbW92ZSgpLG49bnVsbCxlJiZvKCJlcnJvciI9PT1lLnR5cGU/NDA0OjIwMCxlLnR5cGUpfSksci5oZWFkLmFwcGVuZENoaWxkKHRbMF0pfSxhYm9ydDpmdW5jdGlvbigpe24mJm4oKX19fX0pO3ZhciBZdD1bXSxRdD0vKD0pXD8oPz0mfCQpfFw/XD8vO3cuYWpheFNldHVwKHtqc29ucDoiY2FsbGJhY2siLGpzb25wQ2FsbGJhY2s6ZnVuY3Rpb24oKXt2YXIgZT1ZdC5wb3AoKXx8dy5leHBhbmRvKyJfIitFdCsrO3JldHVybiB0aGlzW2VdPSEwLGV9fSksdy5hamF4UHJlZmlsdGVyKCJqc29uIGpzb25wIixmdW5jdGlvbih0LG4scil7dmFyIGksbyxhLHM9ITEhPT10Lmpzb25wJiYoUXQudGVzdCh0LnVybCk/InVybCI6InN0cmluZyI9PXR5cGVvZiB0LmRhdGEmJjA9PT0odC5jb250ZW50VHlwZXx8IiIpLmluZGV4T2YoImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpJiZRdC50ZXN0KHQuZGF0YSkmJiJkYXRhIik7aWYoc3x8Impzb25wIj09PXQuZGF0YVR5cGVzWzBdKXJldHVybiBpPXQuanNvbnBDYWxsYmFjaz1nKHQuanNvbnBDYWxsYmFjayk/dC5qc29ucENhbGxiYWNrKCk6dC5qc29ucENhbGxiYWNrLHM/dFtzXT10W3NdLnJlcGxhY2UoUXQsIiQxIitpKTohMSE9PXQuanNvbnAmJih0LnVybCs9KGt0LnRlc3QodC51cmwpPyImIjoiPyIpK3QuanNvbnArIj0iK2kpLHQuY29udmVydGVyc1sic2NyaXB0IGpzb24iXT1mdW5jdGlvbigpe3JldHVybiBhfHx3LmVycm9yKGkrIiB3YXMgbm90IGNhbGxlZCIpLGFbMF19LHQuZGF0YVR5cGVzWzBdPSJqc29uIixvPWVbaV0sZVtpXT1mdW5jdGlvbigpe2E9YXJndW1lbnRzfSxyLmFsd2F5cyhmdW5jdGlvbigpe3ZvaWQgMD09PW8/dyhlKS5yZW1vdmVQcm9wKGkpOmVbaV09byx0W2ldJiYodC5qc29ucENhbGxiYWNrPW4uanNvbnBDYWxsYmFjayxZdC5wdXNoKGkpKSxhJiZnKG8pJiZvKGFbMF0pLGE9bz12b2lkIDB9KSwic2NyaXB0In0pLGguY3JlYXRlSFRNTERvY3VtZW50PWZ1bmN0aW9uKCl7dmFyIGU9ci5pbXBsZW1lbnRhdGlvbi5jcmVhdGVIVE1MRG9jdW1lbnQoIiIpLmJvZHk7cmV0dXJuIGUuaW5uZXJIVE1MPSI8Zm9ybT48L2Zvcm0+PGZvcm0+PC9mb3JtPiIsMj09PWUuY2hpbGROb2Rlcy5sZW5ndGh9KCksdy5wYXJzZUhUTUw9ZnVuY3Rpb24oZSx0LG4pe2lmKCJzdHJpbmciIT10eXBlb2YgZSlyZXR1cm5bXTsiYm9vbGVhbiI9PXR5cGVvZiB0JiYobj10LHQ9ITEpO3ZhciBpLG8sYTtyZXR1cm4gdHx8KGguY3JlYXRlSFRNTERvY3VtZW50PygoaT0odD1yLmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudCgiIikpLmNyZWF0ZUVsZW1lbnQoImJhc2UiKSkuaHJlZj1yLmxvY2F0aW9uLmhyZWYsdC5oZWFkLmFwcGVuZENoaWxkKGkpKTp0PXIpLG89QS5leGVjKGUpLGE9IW4mJltdLG8/W3QuY3JlYXRlRWxlbWVudChvWzFdKV06KG89eGUoW2VdLHQsYSksYSYmYS5sZW5ndGgmJncoYSkucmVtb3ZlKCksdy5tZXJnZShbXSxvLmNoaWxkTm9kZXMpKX0sdy5mbi5sb2FkPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG8sYT10aGlzLHM9ZS5pbmRleE9mKCIgIik7cmV0dXJuIHM+LTEmJihyPXZ0KGUuc2xpY2UocykpLGU9ZS5zbGljZSgwLHMpKSxnKHQpPyhuPXQsdD12b2lkIDApOnQmJiJvYmplY3QiPT10eXBlb2YgdCYmKGk9IlBPU1QiKSxhLmxlbmd0aD4wJiZ3LmFqYXgoe3VybDplLHR5cGU6aXx8IkdFVCIsZGF0YVR5cGU6Imh0bWwiLGRhdGE6dH0pLmRvbmUoZnVuY3Rpb24oZSl7bz1hcmd1bWVudHMsYS5odG1sKHI/dygiPGRpdj4iKS5hcHBlbmQody5wYXJzZUhUTUwoZSkpLmZpbmQocik6ZSl9KS5hbHdheXMobiYmZnVuY3Rpb24oZSx0KXthLmVhY2goZnVuY3Rpb24oKXtuLmFwcGx5KHRoaXMsb3x8W2UucmVzcG9uc2VUZXh0LHQsZV0pfSl9KSx0aGlzfSx3LmVhY2goWyJhamF4U3RhcnQiLCJhamF4U3RvcCIsImFqYXhDb21wbGV0ZSIsImFqYXhFcnJvciIsImFqYXhTdWNjZXNzIiwiYWpheFNlbmQiXSxmdW5jdGlvbihlLHQpe3cuZm5bdF09ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMub24odCxlKX19KSx3LmV4cHIucHNldWRvcy5hbmltYXRlZD1mdW5jdGlvbihlKXtyZXR1cm4gdy5ncmVwKHcudGltZXJzLGZ1bmN0aW9uKHQpe3JldHVybiBlPT09dC5lbGVtfSkubGVuZ3RofSx3Lm9mZnNldD17c2V0T2Zmc2V0OmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG8sYSxzLHUsbCxjPXcuY3NzKGUsInBvc2l0aW9uIiksZj13KGUpLHA9e307InN0YXRpYyI9PT1jJiYoZS5zdHlsZS5wb3NpdGlvbj0icmVsYXRpdmUiKSxzPWYub2Zmc2V0KCksbz13LmNzcyhlLCJ0b3AiKSx1PXcuY3NzKGUsImxlZnQiKSwobD0oImFic29sdXRlIj09PWN8fCJmaXhlZCI9PT1jKSYmKG8rdSkuaW5kZXhPZigiYXV0byIpPi0xKT8oYT0ocj1mLnBvc2l0aW9uKCkpLnRvcCxpPXIubGVmdCk6KGE9cGFyc2VGbG9hdChvKXx8MCxpPXBhcnNlRmxvYXQodSl8fDApLGcodCkmJih0PXQuY2FsbChlLG4sdy5leHRlbmQoe30scykpKSxudWxsIT10LnRvcCYmKHAudG9wPXQudG9wLXMudG9wK2EpLG51bGwhPXQubGVmdCYmKHAubGVmdD10LmxlZnQtcy5sZWZ0K2kpLCJ1c2luZyJpbiB0P3QudXNpbmcuY2FsbChlLHApOmYuY3NzKHApfX0sdy5mbi5leHRlbmQoe29mZnNldDpmdW5jdGlvbihlKXtpZihhcmd1bWVudHMubGVuZ3RoKXJldHVybiB2b2lkIDA9PT1lP3RoaXM6dGhpcy5lYWNoKGZ1bmN0aW9uKHQpe3cub2Zmc2V0LnNldE9mZnNldCh0aGlzLGUsdCl9KTt2YXIgdCxuLHI9dGhpc1swXTtpZihyKXJldHVybiByLmdldENsaWVudFJlY3RzKCkubGVuZ3RoPyh0PXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksbj1yLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcse3RvcDp0LnRvcCtuLnBhZ2VZT2Zmc2V0LGxlZnQ6dC5sZWZ0K24ucGFnZVhPZmZzZXR9KTp7dG9wOjAsbGVmdDowfX0scG9zaXRpb246ZnVuY3Rpb24oKXtpZih0aGlzWzBdKXt2YXIgZSx0LG4scj10aGlzWzBdLGk9e3RvcDowLGxlZnQ6MH07aWYoImZpeGVkIj09PXcuY3NzKHIsInBvc2l0aW9uIikpdD1yLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO2Vsc2V7dD10aGlzLm9mZnNldCgpLG49ci5vd25lckRvY3VtZW50LGU9ci5vZmZzZXRQYXJlbnR8fG4uZG9jdW1lbnRFbGVtZW50O3doaWxlKGUmJihlPT09bi5ib2R5fHxlPT09bi5kb2N1bWVudEVsZW1lbnQpJiYic3RhdGljIj09PXcuY3NzKGUsInBvc2l0aW9uIikpZT1lLnBhcmVudE5vZGU7ZSYmZSE9PXImJjE9PT1lLm5vZGVUeXBlJiYoKGk9dyhlKS5vZmZzZXQoKSkudG9wKz13LmNzcyhlLCJib3JkZXJUb3BXaWR0aCIsITApLGkubGVmdCs9dy5jc3MoZSwiYm9yZGVyTGVmdFdpZHRoIiwhMCkpfXJldHVybnt0b3A6dC50b3AtaS50b3Atdy5jc3MociwibWFyZ2luVG9wIiwhMCksbGVmdDp0LmxlZnQtaS5sZWZ0LXcuY3NzKHIsIm1hcmdpbkxlZnQiLCEwKX19fSxvZmZzZXRQYXJlbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9mZnNldFBhcmVudDt3aGlsZShlJiYic3RhdGljIj09PXcuY3NzKGUsInBvc2l0aW9uIikpZT1lLm9mZnNldFBhcmVudDtyZXR1cm4gZXx8YmV9KX19KSx3LmVhY2goe3Njcm9sbExlZnQ6InBhZ2VYT2Zmc2V0IixzY3JvbGxUb3A6InBhZ2VZT2Zmc2V0In0sZnVuY3Rpb24oZSx0KXt2YXIgbj0icGFnZVlPZmZzZXQiPT09dDt3LmZuW2VdPWZ1bmN0aW9uKHIpe3JldHVybiB6KHRoaXMsZnVuY3Rpb24oZSxyLGkpe3ZhciBvO2lmKHkoZSk/bz1lOjk9PT1lLm5vZGVUeXBlJiYobz1lLmRlZmF1bHRWaWV3KSx2b2lkIDA9PT1pKXJldHVybiBvP29bdF06ZVtyXTtvP28uc2Nyb2xsVG8obj9vLnBhZ2VYT2Zmc2V0Omksbj9pOm8ucGFnZVlPZmZzZXQpOmVbcl09aX0sZSxyLGFyZ3VtZW50cy5sZW5ndGgpfX0pLHcuZWFjaChbInRvcCIsImxlZnQiXSxmdW5jdGlvbihlLHQpe3cuY3NzSG9va3NbdF09X2UoaC5waXhlbFBvc2l0aW9uLGZ1bmN0aW9uKGUsbil7aWYobilyZXR1cm4gbj1GZShlLHQpLFdlLnRlc3Qobik/dyhlKS5wb3NpdGlvbigpW3RdKyJweCI6bn0pfSksdy5lYWNoKHtIZWlnaHQ6ImhlaWdodCIsV2lkdGg6IndpZHRoIn0sZnVuY3Rpb24oZSx0KXt3LmVhY2goe3BhZGRpbmc6ImlubmVyIitlLGNvbnRlbnQ6dCwiIjoib3V0ZXIiK2V9LGZ1bmN0aW9uKG4scil7dy5mbltyXT1mdW5jdGlvbihpLG8pe3ZhciBhPWFyZ3VtZW50cy5sZW5ndGgmJihufHwiYm9vbGVhbiIhPXR5cGVvZiBpKSxzPW58fCghMD09PWl8fCEwPT09bz8ibWFyZ2luIjoiYm9yZGVyIik7cmV0dXJuIHoodGhpcyxmdW5jdGlvbih0LG4saSl7dmFyIG87cmV0dXJuIHkodCk/MD09PXIuaW5kZXhPZigib3V0ZXIiKT90WyJpbm5lciIrZV06dC5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnRbImNsaWVudCIrZV06OT09PXQubm9kZVR5cGU/KG89dC5kb2N1bWVudEVsZW1lbnQsTWF0aC5tYXgodC5ib2R5WyJzY3JvbGwiK2VdLG9bInNjcm9sbCIrZV0sdC5ib2R5WyJvZmZzZXQiK2VdLG9bIm9mZnNldCIrZV0sb1siY2xpZW50IitlXSkpOnZvaWQgMD09PWk/dy5jc3ModCxuLHMpOncuc3R5bGUodCxuLGkscyl9LHQsYT9pOnZvaWQgMCxhKX19KX0pLHcuZWFjaCgiYmx1ciBmb2N1cyBmb2N1c2luIGZvY3Vzb3V0IHJlc2l6ZSBzY3JvbGwgY2xpY2sgZGJsY2xpY2sgbW91c2Vkb3duIG1vdXNldXAgbW91c2Vtb3ZlIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZWVudGVyIG1vdXNlbGVhdmUgY2hhbmdlIHNlbGVjdCBzdWJtaXQga2V5ZG93biBrZXlwcmVzcyBrZXl1cCBjb250ZXh0bWVudSIuc3BsaXQoIiAiKSxmdW5jdGlvbihlLHQpe3cuZm5bdF09ZnVuY3Rpb24oZSxuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD4wP3RoaXMub24odCxudWxsLGUsbik6dGhpcy50cmlnZ2VyKHQpfX0pLHcuZm4uZXh0ZW5kKHtob3ZlcjpmdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLm1vdXNlZW50ZXIoZSkubW91c2VsZWF2ZSh0fHxlKX19KSx3LmZuLmV4dGVuZCh7YmluZDpmdW5jdGlvbihlLHQsbil7cmV0dXJuIHRoaXMub24oZSxudWxsLHQsbil9LHVuYmluZDpmdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLm9mZihlLG51bGwsdCl9LGRlbGVnYXRlOmZ1bmN0aW9uKGUsdCxuLHIpe3JldHVybiB0aGlzLm9uKHQsZSxuLHIpfSx1bmRlbGVnYXRlOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gMT09PWFyZ3VtZW50cy5sZW5ndGg/dGhpcy5vZmYoZSwiKioiKTp0aGlzLm9mZih0LGV8fCIqKiIsbil9fSksdy5wcm94eT1mdW5jdGlvbihlLHQpe3ZhciBuLHIsaTtpZigic3RyaW5nIj09dHlwZW9mIHQmJihuPWVbdF0sdD1lLGU9biksZyhlKSlyZXR1cm4gcj1vLmNhbGwoYXJndW1lbnRzLDIpLGk9ZnVuY3Rpb24oKXtyZXR1cm4gZS5hcHBseSh0fHx0aGlzLHIuY29uY2F0KG8uY2FsbChhcmd1bWVudHMpKSl9LGkuZ3VpZD1lLmd1aWQ9ZS5ndWlkfHx3Lmd1aWQrKyxpfSx3LmhvbGRSZWFkeT1mdW5jdGlvbihlKXtlP3cucmVhZHlXYWl0Kys6dy5yZWFkeSghMCl9LHcuaXNBcnJheT1BcnJheS5pc0FycmF5LHcucGFyc2VKU09OPUpTT04ucGFyc2Usdy5ub2RlTmFtZT1OLHcuaXNGdW5jdGlvbj1nLHcuaXNXaW5kb3c9eSx3LmNhbWVsQ2FzZT1HLHcudHlwZT14LHcubm93PURhdGUubm93LHcuaXNOdW1lcmljPWZ1bmN0aW9uKGUpe3ZhciB0PXcudHlwZShlKTtyZXR1cm4oIm51bWJlciI9PT10fHwic3RyaW5nIj09PXQpJiYhaXNOYU4oZS1wYXJzZUZsb2F0KGUpKX0sImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZCYmZGVmaW5lKCJqcXVlcnkiLFtdLGZ1bmN0aW9uKCl7cmV0dXJuIHd9KTt2YXIgSnQ9ZS5qUXVlcnksS3Q9ZS4kO3JldHVybiB3Lm5vQ29uZmxpY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIGUuJD09PXcmJihlLiQ9S3QpLHQmJmUualF1ZXJ5PT09dyYmKGUualF1ZXJ5PUp0KSx3fSx0fHwoZS5qUXVlcnk9ZS4kPXcpLHd9KTsNCg0KLyohCiAqIGpRdWVyeSBibG9ja1VJIHBsdWdpbgogKiBWZXJzaW9uIDIuNzAuMC0yMDE0LjExLjIzCiAqIFJlcXVpcmVzIGpRdWVyeSB2MS43IG9yIGxhdGVyCiAqCiAqIEV4YW1wbGVzIGF0OiBodHRwOi8vbWFsc3VwLmNvbS9qcXVlcnkvYmxvY2svCiAqIENvcHlyaWdodCAoYykgMjAwNy0yMDEzIE0uIEFsc3VwCiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBhbmQgR1BMIGxpY2Vuc2VzOgogKiBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocAogKiBodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvZ3BsLmh0bWwKICoKICogVGhhbmtzIHRvIEFtaXItSG9zc2VpbiBTb2JoaSBmb3Igc29tZSBleGNlbGxlbnQgY29udHJpYnV0aW9ucyEKICovCgo7KGZ1bmN0aW9uKCkgewovKmpzaGludCBlcWVxZXE6ZmFsc2UgY3VybHk6ZmFsc2UgbGF0ZWRlZjpmYWxzZSAqLwoidXNlIHN0cmljdCI7CgoJZnVuY3Rpb24gc2V0dXAoJCkgewoJCSQuZm4uX2ZhZGVJbiA9ICQuZm4uZmFkZUluOwoKCQl2YXIgbm9PcCA9ICQubm9vcCB8fCBmdW5jdGlvbigpIHt9OwoKCQkvLyB0aGlzIGJpdCBpcyB0byBlbnN1cmUgd2UgZG9uJ3QgY2FsbCBzZXRFeHByZXNzaW9uIHdoZW4gd2Ugc2hvdWxkbid0ICh3aXRoIGV4dHJhIG11c2NsZSB0byBoYW5kbGUKCQkvLyBjb25mdXNpbmcgdXNlckFnZW50IHN0cmluZ3Mgb24gVmlzdGEpCgkJdmFyIG1zaWUgPSAvTVNJRS8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTsKCQl2YXIgaWU2ICA9IC9NU0lFIDYuMC8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSAmJiAhIC9NU0lFIDguMC8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTsKCQl2YXIgbW9kZSA9IGRvY3VtZW50LmRvY3VtZW50TW9kZSB8fCAwOwoJCXZhciBzZXRFeHByID0gJC5pc0Z1bmN0aW9uKCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKS5zdHlsZS5zZXRFeHByZXNzaW9uICk7CgoJCS8vIGdsb2JhbCAkIG1ldGhvZHMgZm9yIGJsb2NraW5nL3VuYmxvY2tpbmcgdGhlIGVudGlyZSBwYWdlCgkJJC5ibG9ja1VJICAgPSBmdW5jdGlvbihvcHRzKSB7IGluc3RhbGwod2luZG93LCBvcHRzKTsgfTsKCQkkLnVuYmxvY2tVSSA9IGZ1bmN0aW9uKG9wdHMpIHsgcmVtb3ZlKHdpbmRvdywgb3B0cyk7IH07CgoJCS8vIGNvbnZlbmllbmNlIG1ldGhvZCBmb3IgcXVpY2sgZ3Jvd2wtbGlrZSBub3RpZmljYXRpb25zICAoaHR0cDovL3d3dy5nb29nbGUuY29tL3NlYXJjaD9xPWdyb3dsKQoJCSQuZ3Jvd2xVSSA9IGZ1bmN0aW9uKHRpdGxlLCBtZXNzYWdlLCB0aW1lb3V0LCBvbkNsb3NlKSB7CgkJCXZhciAkbSA9ICQoJzxkaXYgY2xhc3M9Imdyb3dsVUkiPjwvZGl2PicpOwoJCQlpZiAodGl0bGUpICRtLmFwcGVuZCgnPGgxPicrdGl0bGUrJzwvaDE+Jyk7CgkJCWlmIChtZXNzYWdlKSAkbS5hcHBlbmQoJzxoMj4nK21lc3NhZ2UrJzwvaDI+Jyk7CgkJCWlmICh0aW1lb3V0ID09PSB1bmRlZmluZWQpIHRpbWVvdXQgPSAzMDAwOwoKCQkJLy8gQWRkZWQgYnkga29uYXB1bjogU2V0IHRpbWVvdXQgdG8gMzAgc2Vjb25kcyBpZiB0aGlzIGdyb3dsIGlzIG1vdXNlZCBvdmVyLCBsaWtlIG5vcm1hbCB0b2FzdCBub3RpZmljYXRpb25zCgkJCXZhciBjYWxsQmxvY2sgPSBmdW5jdGlvbihvcHRzKSB7CgkJCQlvcHRzID0gb3B0cyB8fCB7fTsKCgkJCQkkLmJsb2NrVUkoewoJCQkJCW1lc3NhZ2U6ICRtLAoJCQkJCWZhZGVJbiA6IHR5cGVvZiBvcHRzLmZhZGVJbiAgIT09ICd1bmRlZmluZWQnID8gb3B0cy5mYWRlSW4gIDogNzAwLAoJCQkJCWZhZGVPdXQ6IHR5cGVvZiBvcHRzLmZhZGVPdXQgIT09ICd1bmRlZmluZWQnID8gb3B0cy5mYWRlT3V0IDogMTAwMCwKCQkJCQl0aW1lb3V0OiB0eXBlb2Ygb3B0cy50aW1lb3V0ICE9PSAndW5kZWZpbmVkJyA/IG9wdHMudGltZW91dCA6IHRpbWVvdXQsCgkJCQkJY2VudGVyWTogZmFsc2UsCgkJCQkJc2hvd092ZXJsYXk6IGZhbHNlLAoJCQkJCW9uVW5ibG9jazogb25DbG9zZSwKCQkJCQljc3M6ICQuYmxvY2tVSS5kZWZhdWx0cy5ncm93bENTUwoJCQkJfSk7CgkJCX07CgoJCQljYWxsQmxvY2soKTsKCQkJdmFyIG5vbm1vdXNlZE9wYWNpdHkgPSAkbS5jc3MoJ29wYWNpdHknKTsKCQkJJG0ubW91c2VvdmVyKGZ1bmN0aW9uKCkgewoJCQkJY2FsbEJsb2NrKHsKCQkJCQlmYWRlSW46IDAsCgkJCQkJdGltZW91dDogMzAwMDAKCQkJCX0pOwoKCQkJCXZhciBkaXNwbGF5QmxvY2sgPSAkKCcuYmxvY2tNc2cnKTsKCQkJCWRpc3BsYXlCbG9jay5zdG9wKCk7IC8vIGNhbmNlbCBmYWRlb3V0IGlmIGl0IGhhcyBzdGFydGVkCgkJCQlkaXNwbGF5QmxvY2suZmFkZVRvKDMwMCwgMSk7IC8vIG1ha2UgaXQgZWFzaWVyIHRvIHJlYWQgdGhlIG1lc3NhZ2UgYnkgcmVtb3ZpbmcgdHJhbnNwYXJlbmN5CgkJCX0pLm1vdXNlb3V0KGZ1bmN0aW9uKCkgewoJCQkJJCgnLmJsb2NrTXNnJykuZmFkZU91dCgxMDAwKTsKCQkJfSk7CgkJCS8vIEVuZCBrb25hcHVuIGFkZGl0aW9ucwoJCX07CgoJCS8vIHBsdWdpbiBtZXRob2QgZm9yIGJsb2NraW5nIGVsZW1lbnQgY29udGVudAoJCSQuZm4uYmxvY2sgPSBmdW5jdGlvbihvcHRzKSB7CgkJCWlmICggdGhpc1swXSA9PT0gd2luZG93ICkgewoJCQkJJC5ibG9ja1VJKCBvcHRzICk7CgkJCQlyZXR1cm4gdGhpczsKCQkJfQoJCQl2YXIgZnVsbE9wdHMgPSAkLmV4dGVuZCh7fSwgJC5ibG9ja1VJLmRlZmF1bHRzLCBvcHRzIHx8IHt9KTsKCQkJdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJdmFyICRlbCA9ICQodGhpcyk7CgkJCQlpZiAoZnVsbE9wdHMuaWdub3JlSWZCbG9ja2VkICYmICRlbC5kYXRhKCdibG9ja1VJLmlzQmxvY2tlZCcpKQoJCQkJCXJldHVybjsKCQkJCSRlbC51bmJsb2NrKHsgZmFkZU91dDogMCB9KTsKCQkJfSk7CgoJCQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJaWYgKCQuY3NzKHRoaXMsJ3Bvc2l0aW9uJykgPT0gJ3N0YXRpYycpIHsKCQkJCQl0aGlzLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJzsKCQkJCQkkKHRoaXMpLmRhdGEoJ2Jsb2NrVUkuc3RhdGljJywgdHJ1ZSk7CgkJCQl9CgkJCQl0aGlzLnN0eWxlLnpvb20gPSAxOyAvLyBmb3JjZSAnaGFzTGF5b3V0JyBpbiBpZQoJCQkJaW5zdGFsbCh0aGlzLCBvcHRzKTsKCQkJfSk7CgkJfTsKCgkJLy8gcGx1Z2luIG1ldGhvZCBmb3IgdW5ibG9ja2luZyBlbGVtZW50IGNvbnRlbnQKCQkkLmZuLnVuYmxvY2sgPSBmdW5jdGlvbihvcHRzKSB7CgkJCWlmICggdGhpc1swXSA9PT0gd2luZG93ICkgewoJCQkJJC51bmJsb2NrVUkoIG9wdHMgKTsKCQkJCXJldHVybiB0aGlzOwoJCQl9CgkJCXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7CgkJCQlyZW1vdmUodGhpcywgb3B0cyk7CgkJCX0pOwoJCX07CgoJCSQuYmxvY2tVSS52ZXJzaW9uID0gMi43MDsgLy8gMm5kIGdlbmVyYXRpb24gYmxvY2tpbmcgYXQgbm8gZXh0cmEgY29zdCEKCgkJLy8gb3ZlcnJpZGUgdGhlc2UgaW4geW91ciBjb2RlIHRvIGNoYW5nZSB0aGUgZGVmYXVsdCBiZWhhdmlvciBhbmQgc3R5bGUKCQkkLmJsb2NrVUkuZGVmYXVsdHMgPSB7CgkJCS8vIG1lc3NhZ2UgZGlzcGxheWVkIHdoZW4gYmxvY2tpbmcgKHVzZSBudWxsIGZvciBubyBtZXNzYWdlKQoJCQltZXNzYWdlOiAgJzxoMT5QbGVhc2Ugd2FpdC4uLjwvaDE+JywKCgkJCXRpdGxlOiBudWxsLAkJLy8gdGl0bGUgc3RyaW5nOyBvbmx5IHVzZWQgd2hlbiB0aGVtZSA9PSB0cnVlCgkJCWRyYWdnYWJsZTogdHJ1ZSwJLy8gb25seSB1c2VkIHdoZW4gdGhlbWUgPT0gdHJ1ZSAocmVxdWlyZXMganF1ZXJ5LXVpLmpzIHRvIGJlIGxvYWRlZCkKCgkJCXRoZW1lOiBmYWxzZSwgLy8gc2V0IHRvIHRydWUgdG8gdXNlIHdpdGggalF1ZXJ5IFVJIHRoZW1lcwoKCQkJLy8gc3R5bGVzIGZvciB0aGUgbWVzc2FnZSB3aGVuIGJsb2NraW5nOyBpZiB5b3Ugd2lzaCB0byBkaXNhYmxlCgkJCS8vIHRoZXNlIGFuZCB1c2UgYW4gZXh0ZXJuYWwgc3R5bGVzaGVldCB0aGVuIGRvIHRoaXMgaW4geW91ciBjb2RlOgoJCQkvLyAkLmJsb2NrVUkuZGVmYXVsdHMuY3NzID0ge307CgkJCWNzczogewoJCQkJcGFkZGluZzoJMCwKCQkJCW1hcmdpbjoJCTAsCgkJCQl3aWR0aDoJCSczMCUnLAoJCQkJdG9wOgkJJzQwJScsCgkJCQlsZWZ0OgkJJzM1JScsCgkJCQl0ZXh0QWxpZ246CSdjZW50ZXInLAoJCQkJY29sb3I6CQknIzAwMCcsCgkJCQlib3JkZXI6CQknM3B4IHNvbGlkICNhYWEnLAoJCQkJYmFja2dyb3VuZENvbG9yOicjZmZmJywKCQkJCWN1cnNvcjoJCSd3YWl0JwoJCQl9LAoKCQkJLy8gbWluaW1hbCBzdHlsZSBzZXQgdXNlZCB3aGVuIHRoZW1lcyBhcmUgdXNlZAoJCQl0aGVtZWRDU1M6IHsKCQkJCXdpZHRoOgknMzAlJywKCQkJCXRvcDoJJzQwJScsCgkJCQlsZWZ0OgknMzUlJwoJCQl9LAoKCQkJLy8gc3R5bGVzIGZvciB0aGUgb3ZlcmxheQoJCQlvdmVybGF5Q1NTOiAgewoJCQkJYmFja2dyb3VuZENvbG9yOgknIzAwMCcsCgkJCQlvcGFjaXR5OgkJCTAuNiwKCQkJCWN1cnNvcjoJCQkJJ3dhaXQnCgkJCX0sCgoJCQkvLyBzdHlsZSB0byByZXBsYWNlIHdhaXQgY3Vyc29yIGJlZm9yZSB1bmJsb2NraW5nIHRvIGNvcnJlY3QgaXNzdWUKCQkJLy8gb2YgbGluZ2VyaW5nIHdhaXQgY3Vyc29yCgkJCWN1cnNvclJlc2V0OiAnZGVmYXVsdCcsCgoJCQkvLyBzdHlsZXMgYXBwbGllZCB3aGVuIHVzaW5nICQuZ3Jvd2xVSQoJCQlncm93bENTUzogewoJCQkJd2lkdGg6CQknMzUwcHgnLAoJCQkJdG9wOgkJJzEwcHgnLAoJCQkJbGVmdDoJCScnLAoJCQkJcmlnaHQ6CQknMTBweCcsCgkJCQlib3JkZXI6CQknbm9uZScsCgkJCQlwYWRkaW5nOgknNXB4JywKCQkJCW9wYWNpdHk6CTAuNiwKCQkJCWN1cnNvcjoJCSdkZWZhdWx0JywKCQkJCWNvbG9yOgkJJyNmZmYnLAoJCQkJYmFja2dyb3VuZENvbG9yOiAnIzAwMCcsCgkJCQknLXdlYmtpdC1ib3JkZXItcmFkaXVzJzonMTBweCcsCgkJCQknLW1vei1ib3JkZXItcmFkaXVzJzoJJzEwcHgnLAoJCQkJJ2JvcmRlci1yYWRpdXMnOgkJJzEwcHgnCgkJCX0sCgoJCQkvLyBJRSBpc3N1ZXM6ICdhYm91dDpibGFuaycgZmFpbHMgb24gSFRUUFMgYW5kIGphdmFzY3JpcHQ6ZmFsc2UgaXMgcy1sLW8tdwoJCQkvLyAoaGF0IHRpcCB0byBKb3JnZSBILiBOLiBkZSBWYXNjb25jZWxvcykKCQkJLypqc2hpbnQgc2NyaXB0dXJsOnRydWUgKi8KCQkJaWZyYW1lU3JjOiAvXmh0dHBzL2kudGVzdCh3aW5kb3cubG9jYXRpb24uaHJlZiB8fCAnJykgPyAnamF2YXNjcmlwdDpmYWxzZScgOiAnYWJvdXQ6YmxhbmsnLAoKCQkJLy8gZm9yY2UgdXNhZ2Ugb2YgaWZyYW1lIGluIG5vbi1JRSBicm93c2VycyAoaGFuZHkgZm9yIGJsb2NraW5nIGFwcGxldHMpCgkJCWZvcmNlSWZyYW1lOiBmYWxzZSwKCgkJCS8vIHotaW5kZXggZm9yIHRoZSBibG9ja2luZyBvdmVybGF5CgkJCWJhc2VaOiAxMDAwLAoKCQkJLy8gc2V0IHRoZXNlIHRvIHRydWUgdG8gaGF2ZSB0aGUgbWVzc2FnZSBhdXRvbWF0aWNhbGx5IGNlbnRlcmVkCgkJCWNlbnRlclg6IHRydWUsIC8vIDwtLSBvbmx5IGVmZmVjdHMgZWxlbWVudCBibG9ja2luZyAocGFnZSBibG9jayBjb250cm9sbGVkIHZpYSBjc3MgYWJvdmUpCgkJCWNlbnRlclk6IHRydWUsCgoJCQkvLyBhbGxvdyBib2R5IGVsZW1lbnQgdG8gYmUgc3RldGNoZWQgaW4gaWU2OyB0aGlzIG1ha2VzIGJsb2NraW5nIGxvb2sgYmV0dGVyCgkJCS8vIG9uICJzaG9ydCIgcGFnZXMuICBkaXNhYmxlIGlmIHlvdSB3aXNoIHRvIHByZXZlbnQgY2hhbmdlcyB0byB0aGUgYm9keSBoZWlnaHQKCQkJYWxsb3dCb2R5U3RyZXRjaDogdHJ1ZSwKCgkJCS8vIGVuYWJsZSBpZiB5b3Ugd2FudCBrZXkgYW5kIG1vdXNlIGV2ZW50cyB0byBiZSBkaXNhYmxlZCBmb3IgY29udGVudCB0aGF0IGlzIGJsb2NrZWQKCQkJYmluZEV2ZW50czogdHJ1ZSwKCgkJCS8vIGJlIGRlZmF1bHQgYmxvY2tVSSB3aWxsIHN1cHJlc3MgdGFiIG5hdmlnYXRpb24gZnJvbSBsZWF2aW5nIGJsb2NraW5nIGNvbnRlbnQKCQkJLy8gKGlmIGJpbmRFdmVudHMgaXMgdHJ1ZSkKCQkJY29uc3RyYWluVGFiS2V5OiB0cnVlLAoKCQkJLy8gZmFkZUluIHRpbWUgaW4gbWlsbGlzOyBzZXQgdG8gMCB0byBkaXNhYmxlIGZhZGVJbiBvbiBibG9jawoJCQlmYWRlSW46ICAyMDAsCgoJCQkvLyBmYWRlT3V0IHRpbWUgaW4gbWlsbGlzOyBzZXQgdG8gMCB0byBkaXNhYmxlIGZhZGVPdXQgb24gdW5ibG9jawoJCQlmYWRlT3V0OiAgNDAwLAoKCQkJLy8gdGltZSBpbiBtaWxsaXMgdG8gd2FpdCBiZWZvcmUgYXV0by11bmJsb2NraW5nOyBzZXQgdG8gMCB0byBkaXNhYmxlIGF1dG8tdW5ibG9jawoJCQl0aW1lb3V0OiAwLAoKCQkJLy8gZGlzYWJsZSBpZiB5b3UgZG9uJ3Qgd2FudCB0byBzaG93IHRoZSBvdmVybGF5CgkJCXNob3dPdmVybGF5OiB0cnVlLAoKCQkJLy8gaWYgdHJ1ZSwgZm9jdXMgd2lsbCBiZSBwbGFjZWQgaW4gdGhlIGZpcnN0IGF2YWlsYWJsZSBpbnB1dCBmaWVsZCB3aGVuCgkJCS8vIHBhZ2UgYmxvY2tpbmcKCQkJZm9jdXNJbnB1dDogdHJ1ZSwKCiAgICAgICAgICAgIC8vIGVsZW1lbnRzIHRoYXQgY2FuIHJlY2VpdmUgZm9jdXMKICAgICAgICAgICAgZm9jdXNhYmxlRWxlbWVudHM6ICc6aW5wdXQ6ZW5hYmxlZDp2aXNpYmxlJywKCgkJCS8vIHN1cHByZXNzZXMgdGhlIHVzZSBvZiBvdmVybGF5IHN0eWxlcyBvbiBGRi9MaW51eCAoZHVlIHRvIHBlcmZvcm1hbmNlIGlzc3VlcyB3aXRoIG9wYWNpdHkpCgkJCS8vIG5vIGxvbmdlciBuZWVkZWQgaW4gMjAxMgoJCQkvLyBhcHBseVBsYXRmb3JtT3BhY2l0eVJ1bGVzOiB0cnVlLAoKCQkJLy8gY2FsbGJhY2sgbWV0aG9kIGludm9rZWQgd2hlbiBmYWRlSW4gaGFzIGNvbXBsZXRlZCBhbmQgYmxvY2tpbmcgbWVzc2FnZSBpcyB2aXNpYmxlCgkJCW9uQmxvY2s6IG51bGwsCgoJCQkvLyBjYWxsYmFjayBtZXRob2QgaW52b2tlZCB3aGVuIHVuYmxvY2tpbmcgaGFzIGNvbXBsZXRlZDsgdGhlIGNhbGxiYWNrIGlzCgkJCS8vIHBhc3NlZCB0aGUgZWxlbWVudCB0aGF0IGhhcyBiZWVuIHVuYmxvY2tlZCAod2hpY2ggaXMgdGhlIHdpbmRvdyBvYmplY3QgZm9yIHBhZ2UKCQkJLy8gYmxvY2tzKSBhbmQgdGhlIG9wdGlvbnMgdGhhdCB3ZXJlIHBhc3NlZCB0byB0aGUgdW5ibG9jayBjYWxsOgoJCQkvLwlvblVuYmxvY2soZWxlbWVudCwgb3B0aW9ucykKCQkJb25VbmJsb2NrOiBudWxsLAoKCQkJLy8gY2FsbGJhY2sgbWV0aG9kIGludm9rZWQgd2hlbiB0aGUgb3ZlcmxheSBhcmVhIGlzIGNsaWNrZWQuCgkJCS8vIHNldHRpbmcgdGhpcyB3aWxsIHR1cm4gdGhlIGN1cnNvciB0byBhIHBvaW50ZXIsIG90aGVyd2lzZSBjdXJzb3IgZGVmaW5lZCBpbiBvdmVybGF5Q3NzIHdpbGwgYmUgdXNlZC4KCQkJb25PdmVybGF5Q2xpY2s6IG51bGwsCgoJCQkvLyBkb24ndCBhc2s7IGlmIHlvdSByZWFsbHkgbXVzdCBrbm93OiBodHRwOi8vZ3JvdXBzLmdvb2dsZS5jb20vZ3JvdXAvanF1ZXJ5LWVuL2Jyb3dzZV90aHJlYWQvdGhyZWFkLzM2NjQwYTg3MzA1MDM1OTUvMmY2YTc5YTc3YTc4ZTQ5MyMyZjZhNzlhNzdhNzhlNDkzCgkJCXF1aXJrc21vZGVPZmZzZXRIYWNrOiA0LAoKCQkJLy8gY2xhc3MgbmFtZSBvZiB0aGUgbWVzc2FnZSBibG9jawoJCQlibG9ja01zZ0NsYXNzOiAnYmxvY2tNc2cnLAoKCQkJLy8gaWYgaXQgaXMgYWxyZWFkeSBibG9ja2VkLCB0aGVuIGlnbm9yZSBpdCAoZG9uJ3QgdW5ibG9jayBhbmQgcmVibG9jaykKCQkJaWdub3JlSWZCbG9ja2VkOiBmYWxzZQoJCX07CgoJCS8vIHByaXZhdGUgZGF0YSBhbmQgZnVuY3Rpb25zIGZvbGxvdy4uLgoKCQl2YXIgcGFnZUJsb2NrID0gbnVsbDsKCQl2YXIgcGFnZUJsb2NrRWxzID0gW107CgoJCWZ1bmN0aW9uIGluc3RhbGwoZWwsIG9wdHMpIHsKCQkJdmFyIGNzcywgdGhlbWVkQ1NTOwoJCQl2YXIgZnVsbCA9IChlbCA9PSB3aW5kb3cpOwoJCQl2YXIgbXNnID0gKG9wdHMgJiYgb3B0cy5tZXNzYWdlICE9PSB1bmRlZmluZWQgPyBvcHRzLm1lc3NhZ2UgOiB1bmRlZmluZWQpOwoJCQlvcHRzID0gJC5leHRlbmQoe30sICQuYmxvY2tVSS5kZWZhdWx0cywgb3B0cyB8fCB7fSk7CgoJCQlpZiAob3B0cy5pZ25vcmVJZkJsb2NrZWQgJiYgJChlbCkuZGF0YSgnYmxvY2tVSS5pc0Jsb2NrZWQnKSkKCQkJCXJldHVybjsKCgkJCW9wdHMub3ZlcmxheUNTUyA9ICQuZXh0ZW5kKHt9LCAkLmJsb2NrVUkuZGVmYXVsdHMub3ZlcmxheUNTUywgb3B0cy5vdmVybGF5Q1NTIHx8IHt9KTsKCQkJY3NzID0gJC5leHRlbmQoe30sICQuYmxvY2tVSS5kZWZhdWx0cy5jc3MsIG9wdHMuY3NzIHx8IHt9KTsKCQkJaWYgKG9wdHMub25PdmVybGF5Q2xpY2spCgkJCQlvcHRzLm92ZXJsYXlDU1MuY3Vyc29yID0gJ3BvaW50ZXInOwoKCQkJdGhlbWVkQ1NTID0gJC5leHRlbmQoe30sICQuYmxvY2tVSS5kZWZhdWx0cy50aGVtZWRDU1MsIG9wdHMudGhlbWVkQ1NTIHx8IHt9KTsKCQkJbXNnID0gbXNnID09PSB1bmRlZmluZWQgPyBvcHRzLm1lc3NhZ2UgOiBtc2c7CgoJCQkvLyByZW1vdmUgdGhlIGN1cnJlbnQgYmxvY2sgKGlmIHRoZXJlIGlzIG9uZSkKCQkJaWYgKGZ1bGwgJiYgcGFnZUJsb2NrKQoJCQkJcmVtb3ZlKHdpbmRvdywge2ZhZGVPdXQ6MH0pOwoKCQkJLy8gaWYgYW4gZXhpc3RpbmcgZWxlbWVudCBpcyBiZWluZyB1c2VkIGFzIHRoZSBibG9ja2luZyBjb250ZW50IHRoZW4gd2UgY2FwdHVyZQoJCQkvLyBpdHMgY3VycmVudCBwbGFjZSBpbiB0aGUgRE9NIChhbmQgY3VycmVudCBkaXNwbGF5IHN0eWxlKSBzbyB3ZSBjYW4gcmVzdG9yZQoJCQkvLyBpdCB3aGVuIHdlIHVuYmxvY2sKCQkJaWYgKG1zZyAmJiB0eXBlb2YgbXNnICE9ICdzdHJpbmcnICYmIChtc2cucGFyZW50Tm9kZSB8fCBtc2cuanF1ZXJ5KSkgewoJCQkJdmFyIG5vZGUgPSBtc2cuanF1ZXJ5ID8gbXNnWzBdIDogbXNnOwoJCQkJdmFyIGRhdGEgPSB7fTsKCQkJCSQoZWwpLmRhdGEoJ2Jsb2NrVUkuaGlzdG9yeScsIGRhdGEpOwoJCQkJZGF0YS5lbCA9IG5vZGU7CgkJCQlkYXRhLnBhcmVudCA9IG5vZGUucGFyZW50Tm9kZTsKCQkJCWRhdGEuZGlzcGxheSA9IG5vZGUuc3R5bGUuZGlzcGxheTsKCQkJCWRhdGEucG9zaXRpb24gPSBub2RlLnN0eWxlLnBvc2l0aW9uOwoJCQkJaWYgKGRhdGEucGFyZW50KQoJCQkJCWRhdGEucGFyZW50LnJlbW92ZUNoaWxkKG5vZGUpOwoJCQl9CgoJCQkkKGVsKS5kYXRhKCdibG9ja1VJLm9uVW5ibG9jaycsIG9wdHMub25VbmJsb2NrKTsKCQkJdmFyIHogPSBvcHRzLmJhc2VaOwoKCQkJLy8gYmxvY2tVSSB1c2VzIDMgbGF5ZXJzIGZvciBibG9ja2luZywgZm9yIHNpbXBsaWNpdHkgdGhleSBhcmUgYWxsIHVzZWQgb24gZXZlcnkgcGxhdGZvcm07CgkJCS8vIGxheWVyMSBpcyB0aGUgaWZyYW1lIGxheWVyIHdoaWNoIGlzIHVzZWQgdG8gc3VwcmVzcyBibGVlZCB0aHJvdWdoIG9mIHVuZGVybHlpbmcgY29udGVudAoJCQkvLyBsYXllcjIgaXMgdGhlIG92ZXJsYXkgbGF5ZXIgd2hpY2ggaGFzIG9wYWNpdHkgYW5kIGEgd2FpdCBjdXJzb3IgKGJ5IGRlZmF1bHQpCgkJCS8vIGxheWVyMyBpcyB0aGUgbWVzc2FnZSBjb250ZW50IHRoYXQgaXMgZGlzcGxheWVkIHdoaWxlIGJsb2NraW5nCgkJCXZhciBseXIxLCBseXIyLCBseXIzLCBzOwoJCQlpZiAobXNpZSB8fCBvcHRzLmZvcmNlSWZyYW1lKQoJCQkJbHlyMSA9ICQoJzxpZnJhbWUgY2xhc3M9ImJsb2NrVUkiIHN0eWxlPSJ6LWluZGV4OicrICh6KyspICsnO2Rpc3BsYXk6bm9uZTtib3JkZXI6bm9uZTttYXJnaW46MDtwYWRkaW5nOjA7cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTt0b3A6MDtsZWZ0OjAiIHNyYz0iJytvcHRzLmlmcmFtZVNyYysnIj48L2lmcmFtZT4nKTsKCQkJZWxzZQoJCQkJbHlyMSA9ICQoJzxkaXYgY2xhc3M9ImJsb2NrVUkiIHN0eWxlPSJkaXNwbGF5Om5vbmUiPjwvZGl2PicpOwoKCQkJaWYgKG9wdHMudGhlbWUpCgkJCQlseXIyID0gJCgnPGRpdiBjbGFzcz0iYmxvY2tVSSBibG9ja092ZXJsYXkgdWktd2lkZ2V0LW92ZXJsYXkiIHN0eWxlPSJ6LWluZGV4OicrICh6KyspICsnO2Rpc3BsYXk6bm9uZSI+PC9kaXY+Jyk7CgkJCWVsc2UKCQkJCWx5cjIgPSAkKCc8ZGl2IGNsYXNzPSJibG9ja1VJIGJsb2NrT3ZlcmxheSIgc3R5bGU9InotaW5kZXg6JysgKHorKykgKyc7ZGlzcGxheTpub25lO2JvcmRlcjpub25lO21hcmdpbjowO3BhZGRpbmc6MDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO3RvcDowO2xlZnQ6MCI+PC9kaXY+Jyk7CgoJCQlpZiAob3B0cy50aGVtZSAmJiBmdWxsKSB7CgkJCQlzID0gJzxkaXYgY2xhc3M9ImJsb2NrVUkgJyArIG9wdHMuYmxvY2tNc2dDbGFzcyArICcgYmxvY2tQYWdlIHVpLWRpYWxvZyB1aS13aWRnZXQgdWktY29ybmVyLWFsbCIgc3R5bGU9InotaW5kZXg6JysoeisxMCkrJztkaXNwbGF5Om5vbmU7cG9zaXRpb246Zml4ZWQiPic7CgkJCQlpZiAoIG9wdHMudGl0bGUgKSB7CgkJCQkJcyArPSAnPGRpdiBjbGFzcz0idWktd2lkZ2V0LWhlYWRlciB1aS1kaWFsb2ctdGl0bGViYXIgdWktY29ybmVyLWFsbCBibG9ja1RpdGxlIj4nKyhvcHRzLnRpdGxlIHx8ICcmbmJzcDsnKSsnPC9kaXY+JzsKCQkJCX0KCQkJCXMgKz0gJzxkaXYgY2xhc3M9InVpLXdpZGdldC1jb250ZW50IHVpLWRpYWxvZy1jb250ZW50Ij48L2Rpdj4nOwoJCQkJcyArPSAnPC9kaXY+JzsKCQkJfQoJCQllbHNlIGlmIChvcHRzLnRoZW1lKSB7CgkJCQlzID0gJzxkaXYgY2xhc3M9ImJsb2NrVUkgJyArIG9wdHMuYmxvY2tNc2dDbGFzcyArICcgYmxvY2tFbGVtZW50IHVpLWRpYWxvZyB1aS13aWRnZXQgdWktY29ybmVyLWFsbCIgc3R5bGU9InotaW5kZXg6JysoeisxMCkrJztkaXNwbGF5Om5vbmU7cG9zaXRpb246YWJzb2x1dGUiPic7CgkJCQlpZiAoIG9wdHMudGl0bGUgKSB7CgkJCQkJcyArPSAnPGRpdiBjbGFzcz0idWktd2lkZ2V0LWhlYWRlciB1aS1kaWFsb2ctdGl0bGViYXIgdWktY29ybmVyLWFsbCBibG9ja1RpdGxlIj4nKyhvcHRzLnRpdGxlIHx8ICcmbmJzcDsnKSsnPC9kaXY+JzsKCQkJCX0KCQkJCXMgKz0gJzxkaXYgY2xhc3M9InVpLXdpZGdldC1jb250ZW50IHVpLWRpYWxvZy1jb250ZW50Ij48L2Rpdj4nOwoJCQkJcyArPSAnPC9kaXY+JzsKCQkJfQoJCQllbHNlIGlmIChmdWxsKSB7CgkJCQlzID0gJzxkaXYgY2xhc3M9ImJsb2NrVUkgJyArIG9wdHMuYmxvY2tNc2dDbGFzcyArICcgYmxvY2tQYWdlIiBzdHlsZT0iei1pbmRleDonKyh6KzEwKSsnO2Rpc3BsYXk6bm9uZTtwb3NpdGlvbjpmaXhlZCI+PC9kaXY+JzsKCQkJfQoJCQllbHNlIHsKCQkJCXMgPSAnPGRpdiBjbGFzcz0iYmxvY2tVSSAnICsgb3B0cy5ibG9ja01zZ0NsYXNzICsgJyBibG9ja0VsZW1lbnQiIHN0eWxlPSJ6LWluZGV4OicrKHorMTApKyc7ZGlzcGxheTpub25lO3Bvc2l0aW9uOmFic29sdXRlIj48L2Rpdj4nOwoJCQl9CgkJCWx5cjMgPSAkKHMpOwoKCQkJLy8gaWYgd2UgaGF2ZSBhIG1lc3NhZ2UsIHN0eWxlIGl0CgkJCWlmIChtc2cpIHsKCQkJCWlmIChvcHRzLnRoZW1lKSB7CgkJCQkJbHlyMy5jc3ModGhlbWVkQ1NTKTsKCQkJCQlseXIzLmFkZENsYXNzKCd1aS13aWRnZXQtY29udGVudCcpOwoJCQkJfQoJCQkJZWxzZQoJCQkJCWx5cjMuY3NzKGNzcyk7CgkJCX0KCgkJCS8vIHN0eWxlIHRoZSBvdmVybGF5CgkJCWlmICghb3B0cy50aGVtZSAvKiYmICghb3B0cy5hcHBseVBsYXRmb3JtT3BhY2l0eVJ1bGVzKSovKQoJCQkJbHlyMi5jc3Mob3B0cy5vdmVybGF5Q1NTKTsKCQkJbHlyMi5jc3MoJ3Bvc2l0aW9uJywgZnVsbCA/ICdmaXhlZCcgOiAnYWJzb2x1dGUnKTsKCgkJCS8vIG1ha2UgaWZyYW1lIGxheWVyIHRyYW5zcGFyZW50IGluIElFCgkJCWlmIChtc2llIHx8IG9wdHMuZm9yY2VJZnJhbWUpCgkJCQlseXIxLmNzcygnb3BhY2l0eScsMC4wKTsKCgkJCS8vJChbbHlyMVswXSxseXIyWzBdLGx5cjNbMF1dKS5hcHBlbmRUbyhmdWxsID8gJ2JvZHknIDogZWwpOwoJCQl2YXIgbGF5ZXJzID0gW2x5cjEsbHlyMixseXIzXSwgJHBhciA9IGZ1bGwgPyAkKCdib2R5JykgOiAkKGVsKTsKCQkJJC5lYWNoKGxheWVycywgZnVuY3Rpb24oKSB7CgkJCQl0aGlzLmFwcGVuZFRvKCRwYXIpOwoJCQl9KTsKCgkJCWlmIChvcHRzLnRoZW1lICYmIG9wdHMuZHJhZ2dhYmxlICYmICQuZm4uZHJhZ2dhYmxlKSB7CgkJCQlseXIzLmRyYWdnYWJsZSh7CgkJCQkJaGFuZGxlOiAnLnVpLWRpYWxvZy10aXRsZWJhcicsCgkJCQkJY2FuY2VsOiAnbGknCgkJCQl9KTsKCQkJfQoKCQkJLy8gaWU3IG11c3QgdXNlIGFic29sdXRlIHBvc2l0aW9uaW5nIGluIHF1aXJrcyBtb2RlIGFuZCB0byBhY2NvdW50IGZvciBhY3RpdmV4IGlzc3VlcyAod2hlbiBzY3JvbGxpbmcpCgkJCXZhciBleHByID0gc2V0RXhwciAmJiAoISQuc3VwcG9ydC5ib3hNb2RlbCB8fCAkKCdvYmplY3QsZW1iZWQnLCBmdWxsID8gbnVsbCA6IGVsKS5sZW5ndGggPiAwKTsKCQkJaWYgKGllNiB8fCBleHByKSB7CgkJCQkvLyBnaXZlIGJvZHkgMTAwJSBoZWlnaHQKCQkJCWlmIChmdWxsICYmIG9wdHMuYWxsb3dCb2R5U3RyZXRjaCAmJiAkLnN1cHBvcnQuYm94TW9kZWwpCgkJCQkJJCgnaHRtbCxib2R5JykuY3NzKCdoZWlnaHQnLCcxMDAlJyk7CgoJCQkJLy8gZml4IGllNiBpc3N1ZSB3aGVuIGJsb2NrZWQgZWxlbWVudCBoYXMgYSBib3JkZXIgd2lkdGgKCQkJCWlmICgoaWU2IHx8ICEkLnN1cHBvcnQuYm94TW9kZWwpICYmICFmdWxsKSB7CgkJCQkJdmFyIHQgPSBzeihlbCwnYm9yZGVyVG9wV2lkdGgnKSwgbCA9IHN6KGVsLCdib3JkZXJMZWZ0V2lkdGgnKTsKCQkJCQl2YXIgZml4VCA9IHQgPyAnKDAgLSAnK3QrJyknIDogMDsKCQkJCQl2YXIgZml4TCA9IGwgPyAnKDAgLSAnK2wrJyknIDogMDsKCQkJCX0KCgkJCQkvLyBzaW11bGF0ZSBmaXhlZCBwb3NpdGlvbgoJCQkJJC5lYWNoKGxheWVycywgZnVuY3Rpb24oaSxvKSB7CgkJCQkJdmFyIHMgPSBvWzBdLnN0eWxlOwoJCQkJCXMucG9zaXRpb24gPSAnYWJzb2x1dGUnOwoJCQkJCWlmIChpIDwgMikgewoJCQkJCQlpZiAoZnVsbCkKCQkJCQkJCXMuc2V0RXhwcmVzc2lvbignaGVpZ2h0JywnTWF0aC5tYXgoZG9jdW1lbnQuYm9keS5zY3JvbGxIZWlnaHQsIGRvY3VtZW50LmJvZHkub2Zmc2V0SGVpZ2h0KSAtIChqUXVlcnkuc3VwcG9ydC5ib3hNb2RlbD8wOicrb3B0cy5xdWlya3Ntb2RlT2Zmc2V0SGFjaysnKSArICJweCInKTsKCQkJCQkJZWxzZQoJCQkJCQkJcy5zZXRFeHByZXNzaW9uKCdoZWlnaHQnLCd0aGlzLnBhcmVudE5vZGUub2Zmc2V0SGVpZ2h0ICsgInB4IicpOwoJCQkJCQlpZiAoZnVsbCkKCQkJCQkJCXMuc2V0RXhwcmVzc2lvbignd2lkdGgnLCdqUXVlcnkuc3VwcG9ydC5ib3hNb2RlbCAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggfHwgZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aCArICJweCInKTsKCQkJCQkJZWxzZQoJCQkJCQkJcy5zZXRFeHByZXNzaW9uKCd3aWR0aCcsJ3RoaXMucGFyZW50Tm9kZS5vZmZzZXRXaWR0aCArICJweCInKTsKCQkJCQkJaWYgKGZpeEwpIHMuc2V0RXhwcmVzc2lvbignbGVmdCcsIGZpeEwpOwoJCQkJCQlpZiAoZml4VCkgcy5zZXRFeHByZXNzaW9uKCd0b3AnLCBmaXhUKTsKCQkJCQl9CgkJCQkJZWxzZSBpZiAob3B0cy5jZW50ZXJZKSB7CgkJCQkJCWlmIChmdWxsKSBzLnNldEV4cHJlc3Npb24oJ3RvcCcsJyhkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IHx8IGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0KSAvIDIgLSAodGhpcy5vZmZzZXRIZWlnaHQgLyAyKSArIChibGFoID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA/IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgOiBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCkgKyAicHgiJyk7CgkJCQkJCXMubWFyZ2luVG9wID0gMDsKCQkJCQl9CgkJCQkJZWxzZSBpZiAoIW9wdHMuY2VudGVyWSAmJiBmdWxsKSB7CgkJCQkJCXZhciB0b3AgPSAob3B0cy5jc3MgJiYgb3B0cy5jc3MudG9wKSA/IHBhcnNlSW50KG9wdHMuY3NzLnRvcCwgMTApIDogMDsKCQkJCQkJdmFyIGV4cHJlc3Npb24gPSAnKChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wID8gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA6IGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wKSArICcrdG9wKycpICsgInB4Iic7CgkJCQkJCXMuc2V0RXhwcmVzc2lvbigndG9wJyxleHByZXNzaW9uKTsKCQkJCQl9CgkJCQl9KTsKCQkJfQoKCQkJLy8gc2hvdyB0aGUgbWVzc2FnZQoJCQlpZiAobXNnKSB7CgkJCQlpZiAob3B0cy50aGVtZSkKCQkJCQlseXIzLmZpbmQoJy51aS13aWRnZXQtY29udGVudCcpLmFwcGVuZChtc2cpOwoJCQkJZWxzZQoJCQkJCWx5cjMuYXBwZW5kKG1zZyk7CgkJCQlpZiAobXNnLmpxdWVyeSB8fCBtc2cubm9kZVR5cGUpCgkJCQkJJChtc2cpLnNob3coKTsKCQkJfQoKCQkJaWYgKChtc2llIHx8IG9wdHMuZm9yY2VJZnJhbWUpICYmIG9wdHMuc2hvd092ZXJsYXkpCgkJCQlseXIxLnNob3coKTsgLy8gb3BhY2l0eSBpcyB6ZXJvCgkJCWlmIChvcHRzLmZhZGVJbikgewoJCQkJdmFyIGNiID0gb3B0cy5vbkJsb2NrID8gb3B0cy5vbkJsb2NrIDogbm9PcDsKCQkJCXZhciBjYjEgPSAob3B0cy5zaG93T3ZlcmxheSAmJiAhbXNnKSA/IGNiIDogbm9PcDsKCQkJCXZhciBjYjIgPSBtc2cgPyBjYiA6IG5vT3A7CgkJCQlpZiAob3B0cy5zaG93T3ZlcmxheSkKCQkJCQlseXIyLl9mYWRlSW4ob3B0cy5mYWRlSW4sIGNiMSk7CgkJCQlpZiAobXNnKQoJCQkJCWx5cjMuX2ZhZGVJbihvcHRzLmZhZGVJbiwgY2IyKTsKCQkJfQoJCQllbHNlIHsKCQkJCWlmIChvcHRzLnNob3dPdmVybGF5KQoJCQkJCWx5cjIuc2hvdygpOwoJCQkJaWYgKG1zZykKCQkJCQlseXIzLnNob3coKTsKCQkJCWlmIChvcHRzLm9uQmxvY2spCgkJCQkJb3B0cy5vbkJsb2NrLmJpbmQobHlyMykoKTsKCQkJfQoKCQkJLy8gYmluZCBrZXkgYW5kIG1vdXNlIGV2ZW50cwoJCQliaW5kKDEsIGVsLCBvcHRzKTsKCgkJCWlmIChmdWxsKSB7CgkJCQlwYWdlQmxvY2sgPSBseXIzWzBdOwoJCQkJcGFnZUJsb2NrRWxzID0gJChvcHRzLmZvY3VzYWJsZUVsZW1lbnRzLHBhZ2VCbG9jayk7CgkJCQlpZiAob3B0cy5mb2N1c0lucHV0KQoJCQkJCXNldFRpbWVvdXQoZm9jdXMsIDIwKTsKCQkJfQoJCQllbHNlCgkJCQljZW50ZXIobHlyM1swXSwgb3B0cy5jZW50ZXJYLCBvcHRzLmNlbnRlclkpOwoKCQkJaWYgKG9wdHMudGltZW91dCkgewoJCQkJLy8gYXV0by11bmJsb2NrCgkJCQl2YXIgdG8gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewoJCQkJCWlmIChmdWxsKQoJCQkJCQkkLnVuYmxvY2tVSShvcHRzKTsKCQkJCQllbHNlCgkJCQkJCSQoZWwpLnVuYmxvY2sob3B0cyk7CgkJCQl9LCBvcHRzLnRpbWVvdXQpOwoJCQkJJChlbCkuZGF0YSgnYmxvY2tVSS50aW1lb3V0JywgdG8pOwoJCQl9CgkJfQoKCQkvLyByZW1vdmUgdGhlIGJsb2NrCgkJZnVuY3Rpb24gcmVtb3ZlKGVsLCBvcHRzKSB7CgkJCXZhciBjb3VudDsKCQkJdmFyIGZ1bGwgPSAoZWwgPT0gd2luZG93KTsKCQkJdmFyICRlbCA9ICQoZWwpOwoJCQl2YXIgZGF0YSA9ICRlbC5kYXRhKCdibG9ja1VJLmhpc3RvcnknKTsKCQkJdmFyIHRvID0gJGVsLmRhdGEoJ2Jsb2NrVUkudGltZW91dCcpOwoJCQlpZiAodG8pIHsKCQkJCWNsZWFyVGltZW91dCh0byk7CgkJCQkkZWwucmVtb3ZlRGF0YSgnYmxvY2tVSS50aW1lb3V0Jyk7CgkJCX0KCQkJb3B0cyA9ICQuZXh0ZW5kKHt9LCAkLmJsb2NrVUkuZGVmYXVsdHMsIG9wdHMgfHwge30pOwoJCQliaW5kKDAsIGVsLCBvcHRzKTsgLy8gdW5iaW5kIGV2ZW50cwoKCQkJaWYgKG9wdHMub25VbmJsb2NrID09PSBudWxsKSB7CgkJCQlvcHRzLm9uVW5ibG9jayA9ICRlbC5kYXRhKCdibG9ja1VJLm9uVW5ibG9jaycpOwoJCQkJJGVsLnJlbW92ZURhdGEoJ2Jsb2NrVUkub25VbmJsb2NrJyk7CgkJCX0KCgkJCXZhciBlbHM7CgkJCWlmIChmdWxsKSAvLyBjcmF6eSBzZWxlY3RvciB0byBoYW5kbGUgb2RkIGZpZWxkIGVycm9ycyBpbiBpZTYvNwoJCQkJZWxzID0gJCgnYm9keScpLmNoaWxkcmVuKCkuZmlsdGVyKCcuYmxvY2tVSScpLmFkZCgnYm9keSA+IC5ibG9ja1VJJyk7CgkJCWVsc2UKCQkJCWVscyA9ICRlbC5maW5kKCc+LmJsb2NrVUknKTsKCgkJCS8vIGZpeCBjdXJzb3IgaXNzdWUKCQkJaWYgKCBvcHRzLmN1cnNvclJlc2V0ICkgewoJCQkJaWYgKCBlbHMubGVuZ3RoID4gMSApCgkJCQkJZWxzWzFdLnN0eWxlLmN1cnNvciA9IG9wdHMuY3Vyc29yUmVzZXQ7CgkJCQlpZiAoIGVscy5sZW5ndGggPiAyICkKCQkJCQllbHNbMl0uc3R5bGUuY3Vyc29yID0gb3B0cy5jdXJzb3JSZXNldDsKCQkJfQoKCQkJaWYgKGZ1bGwpCgkJCQlwYWdlQmxvY2sgPSBwYWdlQmxvY2tFbHMgPSBudWxsOwoKCQkJaWYgKG9wdHMuZmFkZU91dCkgewoJCQkJY291bnQgPSBlbHMubGVuZ3RoOwoJCQkJZWxzLnN0b3AoKS5mYWRlT3V0KG9wdHMuZmFkZU91dCwgZnVuY3Rpb24oKSB7CgkJCQkJaWYgKCAtLWNvdW50ID09PSAwKQoJCQkJCQlyZXNldChlbHMsZGF0YSxvcHRzLGVsKTsKCQkJCX0pOwoJCQl9CgkJCWVsc2UKCQkJCXJlc2V0KGVscywgZGF0YSwgb3B0cywgZWwpOwoJCX0KCgkJLy8gbW92ZSBibG9ja2luZyBlbGVtZW50IGJhY2sgaW50byB0aGUgRE9NIHdoZXJlIGl0IHN0YXJ0ZWQKCQlmdW5jdGlvbiByZXNldChlbHMsZGF0YSxvcHRzLGVsKSB7CgkJCXZhciAkZWwgPSAkKGVsKTsKCQkJaWYgKCAkZWwuZGF0YSgnYmxvY2tVSS5pc0Jsb2NrZWQnKSApCgkJCQlyZXR1cm47CgoJCQllbHMuZWFjaChmdW5jdGlvbihpLG8pIHsKCQkJCS8vIHJlbW92ZSB2aWEgRE9NIGNhbGxzIHNvIHdlIGRvbid0IGxvc2UgZXZlbnQgaGFuZGxlcnMKCQkJCWlmICh0aGlzLnBhcmVudE5vZGUpCgkJCQkJdGhpcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMpOwoJCQl9KTsKCgkJCWlmIChkYXRhICYmIGRhdGEuZWwpIHsKCQkJCWRhdGEuZWwuc3R5bGUuZGlzcGxheSA9IGRhdGEuZGlzcGxheTsKCQkJCWRhdGEuZWwuc3R5bGUucG9zaXRpb24gPSBkYXRhLnBvc2l0aW9uOwoJCQkJZGF0YS5lbC5zdHlsZS5jdXJzb3IgPSAnZGVmYXVsdCc7IC8vICM1OQoJCQkJaWYgKGRhdGEucGFyZW50KQoJCQkJCWRhdGEucGFyZW50LmFwcGVuZENoaWxkKGRhdGEuZWwpOwoJCQkJJGVsLnJlbW92ZURhdGEoJ2Jsb2NrVUkuaGlzdG9yeScpOwoJCQl9CgoJCQlpZiAoJGVsLmRhdGEoJ2Jsb2NrVUkuc3RhdGljJykpIHsKCQkJCSRlbC5jc3MoJ3Bvc2l0aW9uJywgJ3N0YXRpYycpOyAvLyAjMjIKCQkJfQoKCQkJaWYgKHR5cGVvZiBvcHRzLm9uVW5ibG9jayA9PSAnZnVuY3Rpb24nKQoJCQkJb3B0cy5vblVuYmxvY2soZWwsb3B0cyk7CgoJCQkvLyBmaXggaXNzdWUgaW4gU2FmYXJpIDYgd2hlcmUgYmxvY2sgYXJ0aWZhY3RzIHJlbWFpbiB1bnRpbCByZWZsb3cKCQkJdmFyIGJvZHkgPSAkKGRvY3VtZW50LmJvZHkpLCB3ID0gYm9keS53aWR0aCgpLCBjc3NXID0gYm9keVswXS5zdHlsZS53aWR0aDsKCQkJYm9keS53aWR0aCh3LTEpLndpZHRoKHcpOwoJCQlib2R5WzBdLnN0eWxlLndpZHRoID0gY3NzVzsKCQl9CgoJCS8vIGJpbmQvdW5iaW5kIHRoZSBoYW5kbGVyCgkJZnVuY3Rpb24gYmluZChiLCBlbCwgb3B0cykgewoJCQl2YXIgZnVsbCA9IGVsID09IHdpbmRvdywgJGVsID0gJChlbCk7CgoJCQkvLyBkb24ndCBib3RoZXIgdW5iaW5kaW5nIGlmIHRoZXJlIGlzIG5vdGhpbmcgdG8gdW5iaW5kCgkJCWlmICghYiAmJiAoZnVsbCAmJiAhcGFnZUJsb2NrIHx8ICFmdWxsICYmICEkZWwuZGF0YSgnYmxvY2tVSS5pc0Jsb2NrZWQnKSkpCgkJCQlyZXR1cm47CgoJCQkkZWwuZGF0YSgnYmxvY2tVSS5pc0Jsb2NrZWQnLCBiKTsKCgkJCS8vIGRvbid0IGJpbmQgZXZlbnRzIHdoZW4gb3ZlcmxheSBpcyBub3QgaW4gdXNlIG9yIGlmIGJpbmRFdmVudHMgaXMgZmFsc2UKCQkJaWYgKCFmdWxsIHx8ICFvcHRzLmJpbmRFdmVudHMgfHwgKGIgJiYgIW9wdHMuc2hvd092ZXJsYXkpKQoJCQkJcmV0dXJuOwoKCQkJLy8gYmluZCBhbmNob3JzIGFuZCBpbnB1dHMgZm9yIG1vdXNlIGFuZCBrZXkgZXZlbnRzCgkJCXZhciBldmVudHMgPSAnbW91c2Vkb3duIG1vdXNldXAga2V5ZG93biBrZXlwcmVzcyBrZXl1cCB0b3VjaHN0YXJ0IHRvdWNoZW5kIHRvdWNobW92ZSc7CgkJCWlmIChiKQoJCQkJJChkb2N1bWVudCkuYmluZChldmVudHMsIG9wdHMsIGhhbmRsZXIpOwoJCQllbHNlCgkJCQkkKGRvY3VtZW50KS51bmJpbmQoZXZlbnRzLCBoYW5kbGVyKTsKCgkJLy8gZm9ybWVyIGltcGwuLi4KCQkvLwkJdmFyICRlID0gJCgnYSw6aW5wdXQnKTsKCQkvLwkJYiA/ICRlLmJpbmQoZXZlbnRzLCBvcHRzLCBoYW5kbGVyKSA6ICRlLnVuYmluZChldmVudHMsIGhhbmRsZXIpOwoJCX0KCgkJLy8gZXZlbnQgaGFuZGxlciB0byBzdXBwcmVzcyBrZXlib2FyZC9tb3VzZSBldmVudHMgd2hlbiBibG9ja2luZwoJCWZ1bmN0aW9uIGhhbmRsZXIoZSkgewoJCQkvLyBhbGxvdyB0YWIgbmF2aWdhdGlvbiAoY29uZGl0aW9uYWxseSkKCQkJaWYgKGUudHlwZSA9PT0gJ2tleWRvd24nICYmIGUua2V5Q29kZSAmJiBlLmtleUNvZGUgPT0gOSkgewoJCQkJaWYgKHBhZ2VCbG9jayAmJiBlLmRhdGEuY29uc3RyYWluVGFiS2V5KSB7CgkJCQkJdmFyIGVscyA9IHBhZ2VCbG9ja0VsczsKCQkJCQl2YXIgZndkID0gIWUuc2hpZnRLZXkgJiYgZS50YXJnZXQgPT09IGVsc1tlbHMubGVuZ3RoLTFdOwoJCQkJCXZhciBiYWNrID0gZS5zaGlmdEtleSAmJiBlLnRhcmdldCA9PT0gZWxzWzBdOwoJCQkJCWlmIChmd2QgfHwgYmFjaykgewoJCQkJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7Zm9jdXMoYmFjayk7fSwxMCk7CgkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQl9CgkJCQl9CgkJCX0KCQkJdmFyIG9wdHMgPSBlLmRhdGE7CgkJCXZhciB0YXJnZXQgPSAkKGUudGFyZ2V0KTsKCQkJaWYgKHRhcmdldC5oYXNDbGFzcygnYmxvY2tPdmVybGF5JykgJiYgb3B0cy5vbk92ZXJsYXlDbGljaykKCQkJCW9wdHMub25PdmVybGF5Q2xpY2soZSk7CgoJCQkvLyBhbGxvdyBldmVudHMgd2l0aGluIHRoZSBtZXNzYWdlIGNvbnRlbnQKCQkJaWYgKHRhcmdldC5wYXJlbnRzKCdkaXYuJyArIG9wdHMuYmxvY2tNc2dDbGFzcykubGVuZ3RoID4gMCkKCQkJCXJldHVybiB0cnVlOwoKCQkJLy8gYWxsb3cgZXZlbnRzIGZvciBjb250ZW50IHRoYXQgaXMgbm90IGJlaW5nIGJsb2NrZWQKCQkJcmV0dXJuIHRhcmdldC5wYXJlbnRzKCkuY2hpbGRyZW4oKS5maWx0ZXIoJ2Rpdi5ibG9ja1VJJykubGVuZ3RoID09PSAwOwoJCX0KCgkJZnVuY3Rpb24gZm9jdXMoYmFjaykgewoJCQlpZiAoIXBhZ2VCbG9ja0VscykKCQkJCXJldHVybjsKCQkJdmFyIGUgPSBwYWdlQmxvY2tFbHNbYmFjaz09PXRydWUgPyBwYWdlQmxvY2tFbHMubGVuZ3RoLTEgOiAwXTsKCQkJaWYgKGUpCgkJCQllLmZvY3VzKCk7CgkJfQoKCQlmdW5jdGlvbiBjZW50ZXIoZWwsIHgsIHkpIHsKCQkJdmFyIHAgPSBlbC5wYXJlbnROb2RlLCBzID0gZWwuc3R5bGU7CgkJCXZhciBsID0gKChwLm9mZnNldFdpZHRoIC0gZWwub2Zmc2V0V2lkdGgpLzIpIC0gc3oocCwnYm9yZGVyTGVmdFdpZHRoJyk7CgkJCXZhciB0ID0gKChwLm9mZnNldEhlaWdodCAtIGVsLm9mZnNldEhlaWdodCkvMikgLSBzeihwLCdib3JkZXJUb3BXaWR0aCcpOwoJCQlpZiAoeCkgcy5sZWZ0ID0gbCA+IDAgPyAobCsncHgnKSA6ICcwJzsKCQkJaWYgKHkpIHMudG9wICA9IHQgPiAwID8gKHQrJ3B4JykgOiAnMCc7CgkJfQoKCQlmdW5jdGlvbiBzeihlbCwgcCkgewoJCQlyZXR1cm4gcGFyc2VJbnQoJC5jc3MoZWwscCksMTApfHwwOwoJCX0KCgl9CgoKCS8qZ2xvYmFsIGRlZmluZTp0cnVlICovCglpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kICYmIGRlZmluZS5hbWQualF1ZXJ5KSB7CgkJZGVmaW5lKFsnanF1ZXJ5J10sIHNldHVwKTsKCX0gZWxzZSB7CgkJc2V0dXAoalF1ZXJ5KTsKCX0KCn0pKCk7CgovLyDvv73vv71l77+977+9DQpmdW5jdGlvbiBibG9ja1VJKCkgew0KICAgICQuYmxvY2tVSSh7DQogICAgICAgIG1lc3NhZ2U6ICI8aW1nIHNyYz0nIiArIGxvY2F0aW9uLnByb3RvY29sICsgIi9pbWFnZXMvbG9hZGluZy5naWYnLz4iLA0KICAgICAgICBjc3M6IHsNCiAgICAgICAgICAgIHRvcDogKCQod2luZG93KS5oZWlnaHQoKSAtIDIwMCkgLyAyICsgJ3B4JywNCiAgICAgICAgICAgIGxlZnQ6ICgkKHdpbmRvdykud2lkdGgoKSAtIDQwMCkgLyAyICsgJ3B4JywNCiAgICAgICAgICAgIHdpZHRoOiAnNDAwcHgnDQogICAgICAgIH0NCiAgICB9KTsNCn0NCg0KLyohCiAgKiBCb290c3RyYXAgdjQuMS4xIChodHRwczovL2dldGJvb3RzdHJhcC5jb20vKQogICogQ29weXJpZ2h0IDIwMTEtMjAxOCBUaGUgQm9vdHN0cmFwIEF1dGhvcnMgKGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9ncmFwaHMvY29udHJpYnV0b3JzKQogICogTGljZW5zZWQgdW5kZXIgTUlUIChodHRwczovL2dpdGh1Yi5jb20vdHdicy9ib290c3RyYXAvYmxvYi9tYXN0ZXIvTElDRU5TRSkKICAqLwohZnVuY3Rpb24odCxlKXsib2JqZWN0Ij09dHlwZW9mIGV4cG9ydHMmJiJ1bmRlZmluZWQiIT10eXBlb2YgbW9kdWxlP2UoZXhwb3J0cyxyZXF1aXJlKCJqcXVlcnkiKSxyZXF1aXJlKCJwb3BwZXIuanMiKSk6ImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoWyJleHBvcnRzIiwianF1ZXJ5IiwicG9wcGVyLmpzIl0sZSk6ZSh0LmJvb3RzdHJhcD17fSx0LmpRdWVyeSx0LlBvcHBlcil9KHRoaXMsZnVuY3Rpb24odCxlLGMpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBpKHQsZSl7Zm9yKHZhciBuPTA7bjxlLmxlbmd0aDtuKyspe3ZhciBpPWVbbl07aS5lbnVtZXJhYmxlPWkuZW51bWVyYWJsZXx8ITEsaS5jb25maWd1cmFibGU9ITAsInZhbHVlImluIGkmJihpLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxpLmtleSxpKX19ZnVuY3Rpb24gbyh0LGUsbil7cmV0dXJuIGUmJmkodC5wcm90b3R5cGUsZSksbiYmaSh0LG4pLHR9ZnVuY3Rpb24gaChyKXtmb3IodmFyIHQ9MTt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKXt2YXIgcz1udWxsIT1hcmd1bWVudHNbdF0/YXJndW1lbnRzW3RdOnt9LGU9T2JqZWN0LmtleXMocyk7ImZ1bmN0aW9uIj09dHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMmJihlPWUuY29uY2F0KE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocykuZmlsdGVyKGZ1bmN0aW9uKHQpe3JldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHMsdCkuZW51bWVyYWJsZX0pKSksZS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3ZhciBlLG4saTtlPXIsaT1zW249dF0sbiBpbiBlP09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLG4se3ZhbHVlOmksZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITB9KTplW25dPWl9KX1yZXR1cm4gcn1lPWUmJmUuaGFzT3duUHJvcGVydHkoImRlZmF1bHQiKT9lLmRlZmF1bHQ6ZSxjPWMmJmMuaGFzT3duUHJvcGVydHkoImRlZmF1bHQiKT9jLmRlZmF1bHQ6Yzt2YXIgcixuLHMsYSxsLHUsZixkLF8sZyxtLHAsdixFLHksVCxDLEksQSxELGIsUyx3LE4sTyxrLFAsTCxqLFIsSCxXLE0seCxVLEssRixWLFEsQixZLEcscSx6LFgsSixaLCQsdHQsZXQsbnQsaXQscnQsc3Qsb3QsYXQsbHQsaHQsY3QsdXQsZnQsZHQsX3QsZ3QsbXQscHQsdnQsRXQseXQsVHQsQ3QsSXQsQXQsRHQsYnQsU3Qsd3QsTnQsT3Qsa3QsUHQsTHQsanQsUnQsSHQsV3QsTXQseHQsVXQsS3QsRnQsVnQsUXQsQnQsWXQsR3QscXQsenQsWHQsSnQsWnQsJHQsdGUsZWUsbmUsaWUscmUsc2Usb2UsYWUsbGUsaGUsY2UsdWUsZmUsZGUsX2UsZ2UsbWUscGUsdmUsRWUseWUsVGUsQ2UsSWUsQWUsRGUsYmUsU2Usd2UsTmUsT2Usa2UsUGUsTGUsamUsUmUsSGUsV2UsTWUseGUsVWUsS2UsRmUsVmUsUWUsQmUsWWUsR2UscWUsemUsWGUsSmUsWmUsJGUsdG4sZW4sbm4scm4sc24sb24sYW4sbG4saG4sY24sdW4sZm4sZG4sX24sZ24sbW4scG4sdm4sRW4seW4sVG4sQ249ZnVuY3Rpb24oaSl7dmFyIGU9InRyYW5zaXRpb25lbmQiO2Z1bmN0aW9uIHQodCl7dmFyIGU9dGhpcyxuPSExO3JldHVybiBpKHRoaXMpLm9uZShsLlRSQU5TSVRJT05fRU5ELGZ1bmN0aW9uKCl7bj0hMH0pLHNldFRpbWVvdXQoZnVuY3Rpb24oKXtufHxsLnRyaWdnZXJUcmFuc2l0aW9uRW5kKGUpfSx0KSx0aGlzfXZhciBsPXtUUkFOU0lUSU9OX0VORDoiYnNUcmFuc2l0aW9uRW5kIixnZXRVSUQ6ZnVuY3Rpb24odCl7Zm9yKDt0Kz1+figxZTYqTWF0aC5yYW5kb20oKSksZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodCk7KTtyZXR1cm4gdH0sZ2V0U2VsZWN0b3JGcm9tRWxlbWVudDpmdW5jdGlvbih0KXt2YXIgZT10LmdldEF0dHJpYnV0ZSgiZGF0YS10YXJnZXQiKTtlJiYiIyIhPT1lfHwoZT10LmdldEF0dHJpYnV0ZSgiaHJlZiIpfHwiIik7dHJ5e3JldHVybiAwPGkoZG9jdW1lbnQpLmZpbmQoZSkubGVuZ3RoP2U6bnVsbH1jYXRjaCh0KXtyZXR1cm4gbnVsbH19LGdldFRyYW5zaXRpb25EdXJhdGlvbkZyb21FbGVtZW50OmZ1bmN0aW9uKHQpe2lmKCF0KXJldHVybiAwO3ZhciBlPWkodCkuY3NzKCJ0cmFuc2l0aW9uLWR1cmF0aW9uIik7cmV0dXJuIHBhcnNlRmxvYXQoZSk/KGU9ZS5zcGxpdCgiLCIpWzBdLDFlMypwYXJzZUZsb2F0KGUpKTowfSxyZWZsb3c6ZnVuY3Rpb24odCl7cmV0dXJuIHQub2Zmc2V0SGVpZ2h0fSx0cmlnZ2VyVHJhbnNpdGlvbkVuZDpmdW5jdGlvbih0KXtpKHQpLnRyaWdnZXIoZSl9LHN1cHBvcnRzVHJhbnNpdGlvbkVuZDpmdW5jdGlvbigpe3JldHVybiBCb29sZWFuKGUpfSxpc0VsZW1lbnQ6ZnVuY3Rpb24odCl7cmV0dXJuKHRbMF18fHQpLm5vZGVUeXBlfSx0eXBlQ2hlY2tDb25maWc6ZnVuY3Rpb24odCxlLG4pe2Zvcih2YXIgaSBpbiBuKWlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChuLGkpKXt2YXIgcj1uW2ldLHM9ZVtpXSxvPXMmJmwuaXNFbGVtZW50KHMpPyJlbGVtZW50IjooYT1zLHt9LnRvU3RyaW5nLmNhbGwoYSkubWF0Y2goL1xzKFthLXpdKykvaSlbMV0udG9Mb3dlckNhc2UoKSk7aWYoIW5ldyBSZWdFeHAocikudGVzdChvKSl0aHJvdyBuZXcgRXJyb3IodC50b1VwcGVyQ2FzZSgpKyc6IE9wdGlvbiAiJytpKyciIHByb3ZpZGVkIHR5cGUgIicrbysnIiBidXQgZXhwZWN0ZWQgdHlwZSAiJytyKyciLicpfXZhciBhfX07cmV0dXJuIGkuZm4uZW11bGF0ZVRyYW5zaXRpb25FbmQ9dCxpLmV2ZW50LnNwZWNpYWxbbC5UUkFOU0lUSU9OX0VORF09e2JpbmRUeXBlOmUsZGVsZWdhdGVUeXBlOmUsaGFuZGxlOmZ1bmN0aW9uKHQpe2lmKGkodC50YXJnZXQpLmlzKHRoaXMpKXJldHVybiB0LmhhbmRsZU9iai5oYW5kbGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19LGx9KGUpLEluPShuPSJhbGVydCIsYT0iLiIrKHM9ImJzLmFsZXJ0IiksbD0ocj1lKS5mbltuXSx1PXtDTE9TRToiY2xvc2UiK2EsQ0xPU0VEOiJjbG9zZWQiK2EsQ0xJQ0tfREFUQV9BUEk6ImNsaWNrIithKyIuZGF0YS1hcGkifSxmPSJhbGVydCIsZD0iZmFkZSIsXz0ic2hvdyIsZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGkodCl7dGhpcy5fZWxlbWVudD10fXZhciB0PWkucHJvdG90eXBlO3JldHVybiB0LmNsb3NlPWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX2VsZW1lbnQ7dCYmKGU9dGhpcy5fZ2V0Um9vdEVsZW1lbnQodCkpLHRoaXMuX3RyaWdnZXJDbG9zZUV2ZW50KGUpLmlzRGVmYXVsdFByZXZlbnRlZCgpfHx0aGlzLl9yZW1vdmVFbGVtZW50KGUpfSx0LmRpc3Bvc2U9ZnVuY3Rpb24oKXtyLnJlbW92ZURhdGEodGhpcy5fZWxlbWVudCxzKSx0aGlzLl9lbGVtZW50PW51bGx9LHQuX2dldFJvb3RFbGVtZW50PWZ1bmN0aW9uKHQpe3ZhciBlPUNuLmdldFNlbGVjdG9yRnJvbUVsZW1lbnQodCksbj0hMTtyZXR1cm4gZSYmKG49cihlKVswXSksbnx8KG49cih0KS5jbG9zZXN0KCIuIitmKVswXSksbn0sdC5fdHJpZ2dlckNsb3NlRXZlbnQ9ZnVuY3Rpb24odCl7dmFyIGU9ci5FdmVudCh1LkNMT1NFKTtyZXR1cm4gcih0KS50cmlnZ2VyKGUpLGV9LHQuX3JlbW92ZUVsZW1lbnQ9ZnVuY3Rpb24oZSl7dmFyIG49dGhpcztpZihyKGUpLnJlbW92ZUNsYXNzKF8pLHIoZSkuaGFzQ2xhc3MoZCkpe3ZhciB0PUNuLmdldFRyYW5zaXRpb25EdXJhdGlvbkZyb21FbGVtZW50KGUpO3IoZSkub25lKENuLlRSQU5TSVRJT05fRU5ELGZ1bmN0aW9uKHQpe3JldHVybiBuLl9kZXN0cm95RWxlbWVudChlLHQpfSkuZW11bGF0ZVRyYW5zaXRpb25FbmQodCl9ZWxzZSB0aGlzLl9kZXN0cm95RWxlbWVudChlKX0sdC5fZGVzdHJveUVsZW1lbnQ9ZnVuY3Rpb24odCl7cih0KS5kZXRhY2goKS50cmlnZ2VyKHUuQ0xPU0VEKS5yZW1vdmUoKX0saS5falF1ZXJ5SW50ZXJmYWNlPWZ1bmN0aW9uKG4pe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdD1yKHRoaXMpLGU9dC5kYXRhKHMpO2V8fChlPW5ldyBpKHRoaXMpLHQuZGF0YShzLGUpKSwiY2xvc2UiPT09biYmZVtuXSh0aGlzKX0pfSxpLl9oYW5kbGVEaXNtaXNzPWZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbih0KXt0JiZ0LnByZXZlbnREZWZhdWx0KCksZS5jbG9zZSh0aGlzKX19LG8oaSxudWxsLFt7a2V5OiJWRVJTSU9OIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4iNC4xLjEifX1dKSxpfSgpLHIoZG9jdW1lbnQpLm9uKHUuQ0xJQ0tfREFUQV9BUEksJ1tkYXRhLWRpc21pc3M9ImFsZXJ0Il0nLGcuX2hhbmRsZURpc21pc3MobmV3IGcpKSxyLmZuW25dPWcuX2pRdWVyeUludGVyZmFjZSxyLmZuW25dLkNvbnN0cnVjdG9yPWcsci5mbltuXS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHIuZm5bbl09bCxnLl9qUXVlcnlJbnRlcmZhY2V9LGcpLEFuPShwPSJidXR0b24iLEU9Ii4iKyh2PSJicy5idXR0b24iKSx5PSIuZGF0YS1hcGkiLFQ9KG09ZSkuZm5bcF0sQz0iYWN0aXZlIixJPSJidG4iLEQ9J1tkYXRhLXRvZ2dsZV49ImJ1dHRvbiJdJyxiPSdbZGF0YS10b2dnbGU9ImJ1dHRvbnMiXScsUz0iaW5wdXQiLHc9Ii5hY3RpdmUiLE49Ii5idG4iLE89e0NMSUNLX0RBVEFfQVBJOiJjbGljayIrRSt5LEZPQ1VTX0JMVVJfREFUQV9BUEk6KEE9ImZvY3VzIikrRSt5KyIgYmx1ciIrRSt5fSxrPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gbih0KXt0aGlzLl9lbGVtZW50PXR9dmFyIHQ9bi5wcm90b3R5cGU7cmV0dXJuIHQudG9nZ2xlPWZ1bmN0aW9uKCl7dmFyIHQ9ITAsZT0hMCxuPW0odGhpcy5fZWxlbWVudCkuY2xvc2VzdChiKVswXTtpZihuKXt2YXIgaT1tKHRoaXMuX2VsZW1lbnQpLmZpbmQoUylbMF07aWYoaSl7aWYoInJhZGlvIj09PWkudHlwZSlpZihpLmNoZWNrZWQmJm0odGhpcy5fZWxlbWVudCkuaGFzQ2xhc3MoQykpdD0hMTtlbHNle3ZhciByPW0obikuZmluZCh3KVswXTtyJiZtKHIpLnJlbW92ZUNsYXNzKEMpfWlmKHQpe2lmKGkuaGFzQXR0cmlidXRlKCJkaXNhYmxlZCIpfHxuLmhhc0F0dHJpYnV0ZSgiZGlzYWJsZWQiKXx8aS5jbGFzc0xpc3QuY29udGFpbnMoImRpc2FibGVkIil8fG4uY2xhc3NMaXN0LmNvbnRhaW5zKCJkaXNhYmxlZCIpKXJldHVybjtpLmNoZWNrZWQ9IW0odGhpcy5fZWxlbWVudCkuaGFzQ2xhc3MoQyksbShpKS50cmlnZ2VyKCJjaGFuZ2UiKX1pLmZvY3VzKCksZT0hMX19ZSYmdGhpcy5fZWxlbWVudC5zZXRBdHRyaWJ1dGUoImFyaWEtcHJlc3NlZCIsIW0odGhpcy5fZWxlbWVudCkuaGFzQ2xhc3MoQykpLHQmJm0odGhpcy5fZWxlbWVudCkudG9nZ2xlQ2xhc3MoQyl9LHQuZGlzcG9zZT1mdW5jdGlvbigpe20ucmVtb3ZlRGF0YSh0aGlzLl9lbGVtZW50LHYpLHRoaXMuX2VsZW1lbnQ9bnVsbH0sbi5falF1ZXJ5SW50ZXJmYWNlPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdD1tKHRoaXMpLmRhdGEodik7dHx8KHQ9bmV3IG4odGhpcyksbSh0aGlzKS5kYXRhKHYsdCkpLCJ0b2dnbGUiPT09ZSYmdFtlXSgpfSl9LG8obixudWxsLFt7a2V5OiJWRVJTSU9OIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4iNC4xLjEifX1dKSxufSgpLG0oZG9jdW1lbnQpLm9uKE8uQ0xJQ0tfREFUQV9BUEksRCxmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCk7dmFyIGU9dC50YXJnZXQ7bShlKS5oYXNDbGFzcyhJKXx8KGU9bShlKS5jbG9zZXN0KE4pKSxrLl9qUXVlcnlJbnRlcmZhY2UuY2FsbChtKGUpLCJ0b2dnbGUiKX0pLm9uKE8uRk9DVVNfQkxVUl9EQVRBX0FQSSxELGZ1bmN0aW9uKHQpe3ZhciBlPW0odC50YXJnZXQpLmNsb3Nlc3QoTilbMF07bShlKS50b2dnbGVDbGFzcyhBLC9eZm9jdXMoaW4pPyQvLnRlc3QodC50eXBlKSl9KSxtLmZuW3BdPWsuX2pRdWVyeUludGVyZmFjZSxtLmZuW3BdLkNvbnN0cnVjdG9yPWssbS5mbltwXS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cmV0dXJuIG0uZm5bcF09VCxrLl9qUXVlcnlJbnRlcmZhY2V9LGspLERuPShMPSJjYXJvdXNlbCIsUj0iLiIrKGo9ImJzLmNhcm91c2VsIiksSD0iLmRhdGEtYXBpIixXPShQPWUpLmZuW0xdLE09e2ludGVydmFsOjVlMyxrZXlib2FyZDohMCxzbGlkZTohMSxwYXVzZToiaG92ZXIiLHdyYXA6ITB9LHg9e2ludGVydmFsOiIobnVtYmVyfGJvb2xlYW4pIixrZXlib2FyZDoiYm9vbGVhbiIsc2xpZGU6Iihib29sZWFufHN0cmluZykiLHBhdXNlOiIoc3RyaW5nfGJvb2xlYW4pIix3cmFwOiJib29sZWFuIn0sVT0ibmV4dCIsSz0icHJldiIsRj0ibGVmdCIsVj0icmlnaHQiLFE9e1NMSURFOiJzbGlkZSIrUixTTElEOiJzbGlkIitSLEtFWURPV046ImtleWRvd24iK1IsTU9VU0VFTlRFUjoibW91c2VlbnRlciIrUixNT1VTRUxFQVZFOiJtb3VzZWxlYXZlIitSLFRPVUNIRU5EOiJ0b3VjaGVuZCIrUixMT0FEX0RBVEFfQVBJOiJsb2FkIitSK0gsQ0xJQ0tfREFUQV9BUEk6ImNsaWNrIitSK0h9LEI9ImNhcm91c2VsIixZPSJhY3RpdmUiLEc9InNsaWRlIixxPSJjYXJvdXNlbC1pdGVtLXJpZ2h0Iix6PSJjYXJvdXNlbC1pdGVtLWxlZnQiLFg9ImNhcm91c2VsLWl0ZW0tbmV4dCIsSj0iY2Fyb3VzZWwtaXRlbS1wcmV2IixaPXtBQ1RJVkU6Ii5hY3RpdmUiLEFDVElWRV9JVEVNOiIuYWN0aXZlLmNhcm91c2VsLWl0ZW0iLElURU06Ii5jYXJvdXNlbC1pdGVtIixORVhUX1BSRVY6Ii5jYXJvdXNlbC1pdGVtLW5leHQsIC5jYXJvdXNlbC1pdGVtLXByZXYiLElORElDQVRPUlM6Ii5jYXJvdXNlbC1pbmRpY2F0b3JzIixEQVRBX1NMSURFOiJbZGF0YS1zbGlkZV0sIFtkYXRhLXNsaWRlLXRvXSIsREFUQV9SSURFOidbZGF0YS1yaWRlPSJjYXJvdXNlbCJdJ30sJD1mdW5jdGlvbigpe2Z1bmN0aW9uIHModCxlKXt0aGlzLl9pdGVtcz1udWxsLHRoaXMuX2ludGVydmFsPW51bGwsdGhpcy5fYWN0aXZlRWxlbWVudD1udWxsLHRoaXMuX2lzUGF1c2VkPSExLHRoaXMuX2lzU2xpZGluZz0hMSx0aGlzLnRvdWNoVGltZW91dD1udWxsLHRoaXMuX2NvbmZpZz10aGlzLl9nZXRDb25maWcoZSksdGhpcy5fZWxlbWVudD1QKHQpWzBdLHRoaXMuX2luZGljYXRvcnNFbGVtZW50PVAodGhpcy5fZWxlbWVudCkuZmluZChaLklORElDQVRPUlMpWzBdLHRoaXMuX2FkZEV2ZW50TGlzdGVuZXJzKCl9dmFyIHQ9cy5wcm90b3R5cGU7cmV0dXJuIHQubmV4dD1mdW5jdGlvbigpe3RoaXMuX2lzU2xpZGluZ3x8dGhpcy5fc2xpZGUoVSl9LHQubmV4dFdoZW5WaXNpYmxlPWZ1bmN0aW9uKCl7IWRvY3VtZW50LmhpZGRlbiYmUCh0aGlzLl9lbGVtZW50KS5pcygiOnZpc2libGUiKSYmImhpZGRlbiIhPT1QKHRoaXMuX2VsZW1lbnQpLmNzcygidmlzaWJpbGl0eSIpJiZ0aGlzLm5leHQoKX0sdC5wcmV2PWZ1bmN0aW9uKCl7dGhpcy5faXNTbGlkaW5nfHx0aGlzLl9zbGlkZShLKX0sdC5wYXVzZT1mdW5jdGlvbih0KXt0fHwodGhpcy5faXNQYXVzZWQ9ITApLFAodGhpcy5fZWxlbWVudCkuZmluZChaLk5FWFRfUFJFVilbMF0mJihDbi50cmlnZ2VyVHJhbnNpdGlvbkVuZCh0aGlzLl9lbGVtZW50KSx0aGlzLmN5Y2xlKCEwKSksY2xlYXJJbnRlcnZhbCh0aGlzLl9pbnRlcnZhbCksdGhpcy5faW50ZXJ2YWw9bnVsbH0sdC5jeWNsZT1mdW5jdGlvbih0KXt0fHwodGhpcy5faXNQYXVzZWQ9ITEpLHRoaXMuX2ludGVydmFsJiYoY2xlYXJJbnRlcnZhbCh0aGlzLl9pbnRlcnZhbCksdGhpcy5faW50ZXJ2YWw9bnVsbCksdGhpcy5fY29uZmlnLmludGVydmFsJiYhdGhpcy5faXNQYXVzZWQmJih0aGlzLl9pbnRlcnZhbD1zZXRJbnRlcnZhbCgoZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlP3RoaXMubmV4dFdoZW5WaXNpYmxlOnRoaXMubmV4dCkuYmluZCh0aGlzKSx0aGlzLl9jb25maWcuaW50ZXJ2YWwpKX0sdC50bz1mdW5jdGlvbih0KXt2YXIgZT10aGlzO3RoaXMuX2FjdGl2ZUVsZW1lbnQ9UCh0aGlzLl9lbGVtZW50KS5maW5kKFouQUNUSVZFX0lURU0pWzBdO3ZhciBuPXRoaXMuX2dldEl0ZW1JbmRleCh0aGlzLl9hY3RpdmVFbGVtZW50KTtpZighKHQ+dGhpcy5faXRlbXMubGVuZ3RoLTF8fHQ8MCkpaWYodGhpcy5faXNTbGlkaW5nKVAodGhpcy5fZWxlbWVudCkub25lKFEuU0xJRCxmdW5jdGlvbigpe3JldHVybiBlLnRvKHQpfSk7ZWxzZXtpZihuPT09dClyZXR1cm4gdGhpcy5wYXVzZSgpLHZvaWQgdGhpcy5jeWNsZSgpO3ZhciBpPW48dD9VOks7dGhpcy5fc2xpZGUoaSx0aGlzLl9pdGVtc1t0XSl9fSx0LmRpc3Bvc2U9ZnVuY3Rpb24oKXtQKHRoaXMuX2VsZW1lbnQpLm9mZihSKSxQLnJlbW92ZURhdGEodGhpcy5fZWxlbWVudCxqKSx0aGlzLl9pdGVtcz1udWxsLHRoaXMuX2NvbmZpZz1udWxsLHRoaXMuX2VsZW1lbnQ9bnVsbCx0aGlzLl9pbnRlcnZhbD1udWxsLHRoaXMuX2lzUGF1c2VkPW51bGwsdGhpcy5faXNTbGlkaW5nPW51bGwsdGhpcy5fYWN0aXZlRWxlbWVudD1udWxsLHRoaXMuX2luZGljYXRvcnNFbGVtZW50PW51bGx9LHQuX2dldENvbmZpZz1mdW5jdGlvbih0KXtyZXR1cm4gdD1oKHt9LE0sdCksQ24udHlwZUNoZWNrQ29uZmlnKEwsdCx4KSx0fSx0Ll9hZGRFdmVudExpc3RlbmVycz1mdW5jdGlvbigpe3ZhciBlPXRoaXM7dGhpcy5fY29uZmlnLmtleWJvYXJkJiZQKHRoaXMuX2VsZW1lbnQpLm9uKFEuS0VZRE9XTixmdW5jdGlvbih0KXtyZXR1cm4gZS5fa2V5ZG93bih0KX0pLCJob3ZlciI9PT10aGlzLl9jb25maWcucGF1c2UmJihQKHRoaXMuX2VsZW1lbnQpLm9uKFEuTU9VU0VFTlRFUixmdW5jdGlvbih0KXtyZXR1cm4gZS5wYXVzZSh0KX0pLm9uKFEuTU9VU0VMRUFWRSxmdW5jdGlvbih0KXtyZXR1cm4gZS5jeWNsZSh0KX0pLCJvbnRvdWNoc3RhcnQiaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50JiZQKHRoaXMuX2VsZW1lbnQpLm9uKFEuVE9VQ0hFTkQsZnVuY3Rpb24oKXtlLnBhdXNlKCksZS50b3VjaFRpbWVvdXQmJmNsZWFyVGltZW91dChlLnRvdWNoVGltZW91dCksZS50b3VjaFRpbWVvdXQ9c2V0VGltZW91dChmdW5jdGlvbih0KXtyZXR1cm4gZS5jeWNsZSh0KX0sNTAwK2UuX2NvbmZpZy5pbnRlcnZhbCl9KSl9LHQuX2tleWRvd249ZnVuY3Rpb24odCl7aWYoIS9pbnB1dHx0ZXh0YXJlYS9pLnRlc3QodC50YXJnZXQudGFnTmFtZSkpc3dpdGNoKHQud2hpY2gpe2Nhc2UgMzc6dC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMucHJldigpO2JyZWFrO2Nhc2UgMzk6dC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMubmV4dCgpfX0sdC5fZ2V0SXRlbUluZGV4PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9pdGVtcz1QLm1ha2VBcnJheShQKHQpLnBhcmVudCgpLmZpbmQoWi5JVEVNKSksdGhpcy5faXRlbXMuaW5kZXhPZih0KX0sdC5fZ2V0SXRlbUJ5RGlyZWN0aW9uPWZ1bmN0aW9uKHQsZSl7dmFyIG49dD09PVUsaT10PT09SyxyPXRoaXMuX2dldEl0ZW1JbmRleChlKSxzPXRoaXMuX2l0ZW1zLmxlbmd0aC0xO2lmKChpJiYwPT09cnx8biYmcj09PXMpJiYhdGhpcy5fY29uZmlnLndyYXApcmV0dXJuIGU7dmFyIG89KHIrKHQ9PT1LPy0xOjEpKSV0aGlzLl9pdGVtcy5sZW5ndGg7cmV0dXJuLTE9PT1vP3RoaXMuX2l0ZW1zW3RoaXMuX2l0ZW1zLmxlbmd0aC0xXTp0aGlzLl9pdGVtc1tvXX0sdC5fdHJpZ2dlclNsaWRlRXZlbnQ9ZnVuY3Rpb24odCxlKXt2YXIgbj10aGlzLl9nZXRJdGVtSW5kZXgodCksaT10aGlzLl9nZXRJdGVtSW5kZXgoUCh0aGlzLl9lbGVtZW50KS5maW5kKFouQUNUSVZFX0lURU0pWzBdKSxyPVAuRXZlbnQoUS5TTElERSx7cmVsYXRlZFRhcmdldDp0LGRpcmVjdGlvbjplLGZyb206aSx0bzpufSk7cmV0dXJuIFAodGhpcy5fZWxlbWVudCkudHJpZ2dlcihyKSxyfSx0Ll9zZXRBY3RpdmVJbmRpY2F0b3JFbGVtZW50PWZ1bmN0aW9uKHQpe2lmKHRoaXMuX2luZGljYXRvcnNFbGVtZW50KXtQKHRoaXMuX2luZGljYXRvcnNFbGVtZW50KS5maW5kKFouQUNUSVZFKS5yZW1vdmVDbGFzcyhZKTt2YXIgZT10aGlzLl9pbmRpY2F0b3JzRWxlbWVudC5jaGlsZHJlblt0aGlzLl9nZXRJdGVtSW5kZXgodCldO2UmJlAoZSkuYWRkQ2xhc3MoWSl9fSx0Ll9zbGlkZT1mdW5jdGlvbih0LGUpe3ZhciBuLGkscixzPXRoaXMsbz1QKHRoaXMuX2VsZW1lbnQpLmZpbmQoWi5BQ1RJVkVfSVRFTSlbMF0sYT10aGlzLl9nZXRJdGVtSW5kZXgobyksbD1lfHxvJiZ0aGlzLl9nZXRJdGVtQnlEaXJlY3Rpb24odCxvKSxoPXRoaXMuX2dldEl0ZW1JbmRleChsKSxjPUJvb2xlYW4odGhpcy5faW50ZXJ2YWwpO2lmKHQ9PT1VPyhuPXosaT1YLHI9Rik6KG49cSxpPUoscj1WKSxsJiZQKGwpLmhhc0NsYXNzKFkpKXRoaXMuX2lzU2xpZGluZz0hMTtlbHNlIGlmKCF0aGlzLl90cmlnZ2VyU2xpZGVFdmVudChsLHIpLmlzRGVmYXVsdFByZXZlbnRlZCgpJiZvJiZsKXt0aGlzLl9pc1NsaWRpbmc9ITAsYyYmdGhpcy5wYXVzZSgpLHRoaXMuX3NldEFjdGl2ZUluZGljYXRvckVsZW1lbnQobCk7dmFyIHU9UC5FdmVudChRLlNMSUQse3JlbGF0ZWRUYXJnZXQ6bCxkaXJlY3Rpb246cixmcm9tOmEsdG86aH0pO2lmKFAodGhpcy5fZWxlbWVudCkuaGFzQ2xhc3MoRykpe1AobCkuYWRkQ2xhc3MoaSksQ24ucmVmbG93KGwpLFAobykuYWRkQ2xhc3MobiksUChsKS5hZGRDbGFzcyhuKTt2YXIgZj1Dbi5nZXRUcmFuc2l0aW9uRHVyYXRpb25Gcm9tRWxlbWVudChvKTtQKG8pLm9uZShDbi5UUkFOU0lUSU9OX0VORCxmdW5jdGlvbigpe1AobCkucmVtb3ZlQ2xhc3MobisiICIraSkuYWRkQ2xhc3MoWSksUChvKS5yZW1vdmVDbGFzcyhZKyIgIitpKyIgIituKSxzLl9pc1NsaWRpbmc9ITEsc2V0VGltZW91dChmdW5jdGlvbigpe3JldHVybiBQKHMuX2VsZW1lbnQpLnRyaWdnZXIodSl9LDApfSkuZW11bGF0ZVRyYW5zaXRpb25FbmQoZil9ZWxzZSBQKG8pLnJlbW92ZUNsYXNzKFkpLFAobCkuYWRkQ2xhc3MoWSksdGhpcy5faXNTbGlkaW5nPSExLFAodGhpcy5fZWxlbWVudCkudHJpZ2dlcih1KTtjJiZ0aGlzLmN5Y2xlKCl9fSxzLl9qUXVlcnlJbnRlcmZhY2U9ZnVuY3Rpb24oaSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciB0PVAodGhpcykuZGF0YShqKSxlPWgoe30sTSxQKHRoaXMpLmRhdGEoKSk7Im9iamVjdCI9PXR5cGVvZiBpJiYoZT1oKHt9LGUsaSkpO3ZhciBuPSJzdHJpbmciPT10eXBlb2YgaT9pOmUuc2xpZGU7aWYodHx8KHQ9bmV3IHModGhpcyxlKSxQKHRoaXMpLmRhdGEoaix0KSksIm51bWJlciI9PXR5cGVvZiBpKXQudG8oaSk7ZWxzZSBpZigic3RyaW5nIj09dHlwZW9mIG4pe2lmKCJ1bmRlZmluZWQiPT10eXBlb2YgdFtuXSl0aHJvdyBuZXcgVHlwZUVycm9yKCdObyBtZXRob2QgbmFtZWQgIicrbisnIicpO3Rbbl0oKX1lbHNlIGUuaW50ZXJ2YWwmJih0LnBhdXNlKCksdC5jeWNsZSgpKX0pfSxzLl9kYXRhQXBpQ2xpY2tIYW5kbGVyPWZ1bmN0aW9uKHQpe3ZhciBlPUNuLmdldFNlbGVjdG9yRnJvbUVsZW1lbnQodGhpcyk7aWYoZSl7dmFyIG49UChlKVswXTtpZihuJiZQKG4pLmhhc0NsYXNzKEIpKXt2YXIgaT1oKHt9LFAobikuZGF0YSgpLFAodGhpcykuZGF0YSgpKSxyPXRoaXMuZ2V0QXR0cmlidXRlKCJkYXRhLXNsaWRlLXRvIik7ciYmKGkuaW50ZXJ2YWw9ITEpLHMuX2pRdWVyeUludGVyZmFjZS5jYWxsKFAobiksaSksciYmUChuKS5kYXRhKGopLnRvKHIpLHQucHJldmVudERlZmF1bHQoKX19fSxvKHMsbnVsbCxbe2tleToiVkVSU0lPTiIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIjQuMS4xIn19LHtrZXk6IkRlZmF1bHQiLGdldDpmdW5jdGlvbigpe3JldHVybiBNfX1dKSxzfSgpLFAoZG9jdW1lbnQpLm9uKFEuQ0xJQ0tfREFUQV9BUEksWi5EQVRBX1NMSURFLCQuX2RhdGFBcGlDbGlja0hhbmRsZXIpLFAod2luZG93KS5vbihRLkxPQURfREFUQV9BUEksZnVuY3Rpb24oKXtQKFouREFUQV9SSURFKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIHQ9UCh0aGlzKTskLl9qUXVlcnlJbnRlcmZhY2UuY2FsbCh0LHQuZGF0YSgpKX0pfSksUC5mbltMXT0kLl9qUXVlcnlJbnRlcmZhY2UsUC5mbltMXS5Db25zdHJ1Y3Rvcj0kLFAuZm5bTF0ubm9Db25mbGljdD1mdW5jdGlvbigpe3JldHVybiBQLmZuW0xdPVcsJC5falF1ZXJ5SW50ZXJmYWNlfSwkKSxibj0oZXQ9ImNvbGxhcHNlIixpdD0iLiIrKG50PSJicy5jb2xsYXBzZSIpLHJ0PSh0dD1lKS5mbltldF0sc3Q9e3RvZ2dsZTohMCxwYXJlbnQ6IiJ9LG90PXt0b2dnbGU6ImJvb2xlYW4iLHBhcmVudDoiKHN0cmluZ3xlbGVtZW50KSJ9LGF0PXtTSE9XOiJzaG93IitpdCxTSE9XTjoic2hvd24iK2l0LEhJREU6ImhpZGUiK2l0LEhJRERFTjoiaGlkZGVuIitpdCxDTElDS19EQVRBX0FQSToiY2xpY2siK2l0KyIuZGF0YS1hcGkifSxsdD0ic2hvdyIsaHQ9ImNvbGxhcHNlIixjdD0iY29sbGFwc2luZyIsdXQ9ImNvbGxhcHNlZCIsZnQ9IndpZHRoIixkdD0iaGVpZ2h0IixfdD17QUNUSVZFUzoiLnNob3csIC5jb2xsYXBzaW5nIixEQVRBX1RPR0dMRTonW2RhdGEtdG9nZ2xlPSJjb2xsYXBzZSJdJ30sZ3Q9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKHQsZSl7dGhpcy5faXNUcmFuc2l0aW9uaW5nPSExLHRoaXMuX2VsZW1lbnQ9dCx0aGlzLl9jb25maWc9dGhpcy5fZ2V0Q29uZmlnKGUpLHRoaXMuX3RyaWdnZXJBcnJheT10dC5tYWtlQXJyYXkodHQoJ1tkYXRhLXRvZ2dsZT0iY29sbGFwc2UiXVtocmVmPSIjJyt0LmlkKyciXSxbZGF0YS10b2dnbGU9ImNvbGxhcHNlIl1bZGF0YS10YXJnZXQ9IiMnK3QuaWQrJyJdJykpO2Zvcih2YXIgbj10dChfdC5EQVRBX1RPR0dMRSksaT0wO2k8bi5sZW5ndGg7aSsrKXt2YXIgcj1uW2ldLHM9Q24uZ2V0U2VsZWN0b3JGcm9tRWxlbWVudChyKTtudWxsIT09cyYmMDx0dChzKS5maWx0ZXIodCkubGVuZ3RoJiYodGhpcy5fc2VsZWN0b3I9cyx0aGlzLl90cmlnZ2VyQXJyYXkucHVzaChyKSl9dGhpcy5fcGFyZW50PXRoaXMuX2NvbmZpZy5wYXJlbnQ/dGhpcy5fZ2V0UGFyZW50KCk6bnVsbCx0aGlzLl9jb25maWcucGFyZW50fHx0aGlzLl9hZGRBcmlhQW5kQ29sbGFwc2VkQ2xhc3ModGhpcy5fZWxlbWVudCx0aGlzLl90cmlnZ2VyQXJyYXkpLHRoaXMuX2NvbmZpZy50b2dnbGUmJnRoaXMudG9nZ2xlKCl9dmFyIHQ9YS5wcm90b3R5cGU7cmV0dXJuIHQudG9nZ2xlPWZ1bmN0aW9uKCl7dHQodGhpcy5fZWxlbWVudCkuaGFzQ2xhc3MobHQpP3RoaXMuaGlkZSgpOnRoaXMuc2hvdygpfSx0LnNob3c9ZnVuY3Rpb24oKXt2YXIgdCxlLG49dGhpcztpZighdGhpcy5faXNUcmFuc2l0aW9uaW5nJiYhdHQodGhpcy5fZWxlbWVudCkuaGFzQ2xhc3MobHQpJiYodGhpcy5fcGFyZW50JiYwPT09KHQ9dHQubWFrZUFycmF5KHR0KHRoaXMuX3BhcmVudCkuZmluZChfdC5BQ1RJVkVTKS5maWx0ZXIoJ1tkYXRhLXBhcmVudD0iJyt0aGlzLl9jb25maWcucGFyZW50KyciXScpKSkubGVuZ3RoJiYodD1udWxsKSwhKHQmJihlPXR0KHQpLm5vdCh0aGlzLl9zZWxlY3RvcikuZGF0YShudCkpJiZlLl9pc1RyYW5zaXRpb25pbmcpKSl7dmFyIGk9dHQuRXZlbnQoYXQuU0hPVyk7aWYodHQodGhpcy5fZWxlbWVudCkudHJpZ2dlcihpKSwhaS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSl7dCYmKGEuX2pRdWVyeUludGVyZmFjZS5jYWxsKHR0KHQpLm5vdCh0aGlzLl9zZWxlY3RvciksImhpZGUiKSxlfHx0dCh0KS5kYXRhKG50LG51bGwpKTt2YXIgcj10aGlzLl9nZXREaW1lbnNpb24oKTt0dCh0aGlzLl9lbGVtZW50KS5yZW1vdmVDbGFzcyhodCkuYWRkQ2xhc3MoY3QpLCh0aGlzLl9lbGVtZW50LnN0eWxlW3JdPTApPHRoaXMuX3RyaWdnZXJBcnJheS5sZW5ndGgmJnR0KHRoaXMuX3RyaWdnZXJBcnJheSkucmVtb3ZlQ2xhc3ModXQpLmF0dHIoImFyaWEtZXhwYW5kZWQiLCEwKSx0aGlzLnNldFRyYW5zaXRpb25pbmcoITApO3ZhciBzPSJzY3JvbGwiKyhyWzBdLnRvVXBwZXJDYXNlKCkrci5zbGljZSgxKSksbz1Dbi5nZXRUcmFuc2l0aW9uRHVyYXRpb25Gcm9tRWxlbWVudCh0aGlzLl9lbGVtZW50KTt0dCh0aGlzLl9lbGVtZW50KS5vbmUoQ24uVFJBTlNJVElPTl9FTkQsZnVuY3Rpb24oKXt0dChuLl9lbGVtZW50KS5yZW1vdmVDbGFzcyhjdCkuYWRkQ2xhc3MoaHQpLmFkZENsYXNzKGx0KSxuLl9lbGVtZW50LnN0eWxlW3JdPSIiLG4uc2V0VHJhbnNpdGlvbmluZyghMSksdHQobi5fZWxlbWVudCkudHJpZ2dlcihhdC5TSE9XTil9KS5lbXVsYXRlVHJhbnNpdGlvbkVuZChvKSx0aGlzLl9lbGVtZW50LnN0eWxlW3JdPXRoaXMuX2VsZW1lbnRbc10rInB4In19fSx0LmhpZGU9ZnVuY3Rpb24oKXt2YXIgdD10aGlzO2lmKCF0aGlzLl9pc1RyYW5zaXRpb25pbmcmJnR0KHRoaXMuX2VsZW1lbnQpLmhhc0NsYXNzKGx0KSl7dmFyIGU9dHQuRXZlbnQoYXQuSElERSk7aWYodHQodGhpcy5fZWxlbWVudCkudHJpZ2dlcihlKSwhZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSl7dmFyIG49dGhpcy5fZ2V0RGltZW5zaW9uKCk7aWYodGhpcy5fZWxlbWVudC5zdHlsZVtuXT10aGlzLl9lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpW25dKyJweCIsQ24ucmVmbG93KHRoaXMuX2VsZW1lbnQpLHR0KHRoaXMuX2VsZW1lbnQpLmFkZENsYXNzKGN0KS5yZW1vdmVDbGFzcyhodCkucmVtb3ZlQ2xhc3MobHQpLDA8dGhpcy5fdHJpZ2dlckFycmF5Lmxlbmd0aClmb3IodmFyIGk9MDtpPHRoaXMuX3RyaWdnZXJBcnJheS5sZW5ndGg7aSsrKXt2YXIgcj10aGlzLl90cmlnZ2VyQXJyYXlbaV0scz1Dbi5nZXRTZWxlY3RvckZyb21FbGVtZW50KHIpO2lmKG51bGwhPT1zKXR0KHMpLmhhc0NsYXNzKGx0KXx8dHQocikuYWRkQ2xhc3ModXQpLmF0dHIoImFyaWEtZXhwYW5kZWQiLCExKX10aGlzLnNldFRyYW5zaXRpb25pbmcoITApO3RoaXMuX2VsZW1lbnQuc3R5bGVbbl09IiI7dmFyIG89Q24uZ2V0VHJhbnNpdGlvbkR1cmF0aW9uRnJvbUVsZW1lbnQodGhpcy5fZWxlbWVudCk7dHQodGhpcy5fZWxlbWVudCkub25lKENuLlRSQU5TSVRJT05fRU5ELGZ1bmN0aW9uKCl7dC5zZXRUcmFuc2l0aW9uaW5nKCExKSx0dCh0Ll9lbGVtZW50KS5yZW1vdmVDbGFzcyhjdCkuYWRkQ2xhc3MoaHQpLnRyaWdnZXIoYXQuSElEREVOKX0pLmVtdWxhdGVUcmFuc2l0aW9uRW5kKG8pfX19LHQuc2V0VHJhbnNpdGlvbmluZz1mdW5jdGlvbih0KXt0aGlzLl9pc1RyYW5zaXRpb25pbmc9dH0sdC5kaXNwb3NlPWZ1bmN0aW9uKCl7dHQucmVtb3ZlRGF0YSh0aGlzLl9lbGVtZW50LG50KSx0aGlzLl9jb25maWc9bnVsbCx0aGlzLl9wYXJlbnQ9bnVsbCx0aGlzLl9lbGVtZW50PW51bGwsdGhpcy5fdHJpZ2dlckFycmF5PW51bGwsdGhpcy5faXNUcmFuc2l0aW9uaW5nPW51bGx9LHQuX2dldENvbmZpZz1mdW5jdGlvbih0KXtyZXR1cm4odD1oKHt9LHN0LHQpKS50b2dnbGU9Qm9vbGVhbih0LnRvZ2dsZSksQ24udHlwZUNoZWNrQ29uZmlnKGV0LHQsb3QpLHR9LHQuX2dldERpbWVuc2lvbj1mdW5jdGlvbigpe3JldHVybiB0dCh0aGlzLl9lbGVtZW50KS5oYXNDbGFzcyhmdCk/ZnQ6ZHR9LHQuX2dldFBhcmVudD1mdW5jdGlvbigpe3ZhciBuPXRoaXMsdD1udWxsO0NuLmlzRWxlbWVudCh0aGlzLl9jb25maWcucGFyZW50KT8odD10aGlzLl9jb25maWcucGFyZW50LCJ1bmRlZmluZWQiIT10eXBlb2YgdGhpcy5fY29uZmlnLnBhcmVudC5qcXVlcnkmJih0PXRoaXMuX2NvbmZpZy5wYXJlbnRbMF0pKTp0PXR0KHRoaXMuX2NvbmZpZy5wYXJlbnQpWzBdO3ZhciBlPSdbZGF0YS10b2dnbGU9ImNvbGxhcHNlIl1bZGF0YS1wYXJlbnQ9IicrdGhpcy5fY29uZmlnLnBhcmVudCsnIl0nO3JldHVybiB0dCh0KS5maW5kKGUpLmVhY2goZnVuY3Rpb24odCxlKXtuLl9hZGRBcmlhQW5kQ29sbGFwc2VkQ2xhc3MoYS5fZ2V0VGFyZ2V0RnJvbUVsZW1lbnQoZSksW2VdKX0pLHR9LHQuX2FkZEFyaWFBbmRDb2xsYXBzZWRDbGFzcz1mdW5jdGlvbih0LGUpe2lmKHQpe3ZhciBuPXR0KHQpLmhhc0NsYXNzKGx0KTswPGUubGVuZ3RoJiZ0dChlKS50b2dnbGVDbGFzcyh1dCwhbikuYXR0cigiYXJpYS1leHBhbmRlZCIsbil9fSxhLl9nZXRUYXJnZXRGcm9tRWxlbWVudD1mdW5jdGlvbih0KXt2YXIgZT1Dbi5nZXRTZWxlY3RvckZyb21FbGVtZW50KHQpO3JldHVybiBlP3R0KGUpWzBdOm51bGx9LGEuX2pRdWVyeUludGVyZmFjZT1mdW5jdGlvbihpKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIHQ9dHQodGhpcyksZT10LmRhdGEobnQpLG49aCh7fSxzdCx0LmRhdGEoKSwib2JqZWN0Ij09dHlwZW9mIGkmJmk/aTp7fSk7aWYoIWUmJm4udG9nZ2xlJiYvc2hvd3xoaWRlLy50ZXN0KGkpJiYobi50b2dnbGU9ITEpLGV8fChlPW5ldyBhKHRoaXMsbiksdC5kYXRhKG50LGUpKSwic3RyaW5nIj09dHlwZW9mIGkpe2lmKCJ1bmRlZmluZWQiPT10eXBlb2YgZVtpXSl0aHJvdyBuZXcgVHlwZUVycm9yKCdObyBtZXRob2QgbmFtZWQgIicraSsnIicpO2VbaV0oKX19KX0sbyhhLG51bGwsW3trZXk6IlZFUlNJT04iLGdldDpmdW5jdGlvbigpe3JldHVybiI0LjEuMSJ9fSx7a2V5OiJEZWZhdWx0IixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gc3R9fV0pLGF9KCksdHQoZG9jdW1lbnQpLm9uKGF0LkNMSUNLX0RBVEFfQVBJLF90LkRBVEFfVE9HR0xFLGZ1bmN0aW9uKHQpeyJBIj09PXQuY3VycmVudFRhcmdldC50YWdOYW1lJiZ0LnByZXZlbnREZWZhdWx0KCk7dmFyIG49dHQodGhpcyksZT1Dbi5nZXRTZWxlY3RvckZyb21FbGVtZW50KHRoaXMpO3R0KGUpLmVhY2goZnVuY3Rpb24oKXt2YXIgdD10dCh0aGlzKSxlPXQuZGF0YShudCk/InRvZ2dsZSI6bi5kYXRhKCk7Z3QuX2pRdWVyeUludGVyZmFjZS5jYWxsKHQsZSl9KX0pLHR0LmZuW2V0XT1ndC5falF1ZXJ5SW50ZXJmYWNlLHR0LmZuW2V0XS5Db25zdHJ1Y3Rvcj1ndCx0dC5mbltldF0ubm9Db25mbGljdD1mdW5jdGlvbigpe3JldHVybiB0dC5mbltldF09cnQsZ3QuX2pRdWVyeUludGVyZmFjZX0sZ3QpLFNuPShwdD0iZHJvcGRvd24iLEV0PSIuIisodnQ9ImJzLmRyb3Bkb3duIikseXQ9Ii5kYXRhLWFwaSIsVHQ9KG10PWUpLmZuW3B0XSxDdD1uZXcgUmVnRXhwKCIzOHw0MHwyNyIpLEl0PXtISURFOiJoaWRlIitFdCxISURERU46ImhpZGRlbiIrRXQsU0hPVzoic2hvdyIrRXQsU0hPV046InNob3duIitFdCxDTElDSzoiY2xpY2siK0V0LENMSUNLX0RBVEFfQVBJOiJjbGljayIrRXQreXQsS0VZRE9XTl9EQVRBX0FQSToia2V5ZG93biIrRXQreXQsS0VZVVBfREFUQV9BUEk6ImtleXVwIitFdCt5dH0sQXQ9ImRpc2FibGVkIixEdD0ic2hvdyIsYnQ9ImRyb3B1cCIsU3Q9ImRyb3ByaWdodCIsd3Q9ImRyb3BsZWZ0IixOdD0iZHJvcGRvd24tbWVudS1yaWdodCIsT3Q9InBvc2l0aW9uLXN0YXRpYyIsa3Q9J1tkYXRhLXRvZ2dsZT0iZHJvcGRvd24iXScsUHQ9Ii5kcm9wZG93biBmb3JtIixMdD0iLmRyb3Bkb3duLW1lbnUiLGp0PSIubmF2YmFyLW5hdiIsUnQ9Ii5kcm9wZG93bi1tZW51IC5kcm9wZG93bi1pdGVtOm5vdCguZGlzYWJsZWQpOm5vdCg6ZGlzYWJsZWQpIixIdD0idG9wLXN0YXJ0IixXdD0idG9wLWVuZCIsTXQ9ImJvdHRvbS1zdGFydCIseHQ9ImJvdHRvbS1lbmQiLFV0PSJyaWdodC1zdGFydCIsS3Q9ImxlZnQtc3RhcnQiLEZ0PXtvZmZzZXQ6MCxmbGlwOiEwLGJvdW5kYXJ5OiJzY3JvbGxQYXJlbnQiLHJlZmVyZW5jZToidG9nZ2xlIixkaXNwbGF5OiJkeW5hbWljIn0sVnQ9e29mZnNldDoiKG51bWJlcnxzdHJpbmd8ZnVuY3Rpb24pIixmbGlwOiJib29sZWFuIixib3VuZGFyeToiKHN0cmluZ3xlbGVtZW50KSIscmVmZXJlbmNlOiIoc3RyaW5nfGVsZW1lbnQpIixkaXNwbGF5OiJzdHJpbmcifSxRdD1mdW5jdGlvbigpe2Z1bmN0aW9uIGwodCxlKXt0aGlzLl9lbGVtZW50PXQsdGhpcy5fcG9wcGVyPW51bGwsdGhpcy5fY29uZmlnPXRoaXMuX2dldENvbmZpZyhlKSx0aGlzLl9tZW51PXRoaXMuX2dldE1lbnVFbGVtZW50KCksdGhpcy5faW5OYXZiYXI9dGhpcy5fZGV0ZWN0TmF2YmFyKCksdGhpcy5fYWRkRXZlbnRMaXN0ZW5lcnMoKX12YXIgdD1sLnByb3RvdHlwZTtyZXR1cm4gdC50b2dnbGU9ZnVuY3Rpb24oKXtpZighdGhpcy5fZWxlbWVudC5kaXNhYmxlZCYmIW10KHRoaXMuX2VsZW1lbnQpLmhhc0NsYXNzKEF0KSl7dmFyIHQ9bC5fZ2V0UGFyZW50RnJvbUVsZW1lbnQodGhpcy5fZWxlbWVudCksZT1tdCh0aGlzLl9tZW51KS5oYXNDbGFzcyhEdCk7aWYobC5fY2xlYXJNZW51cygpLCFlKXt2YXIgbj17cmVsYXRlZFRhcmdldDp0aGlzLl9lbGVtZW50fSxpPW10LkV2ZW50KEl0LlNIT1csbik7aWYobXQodCkudHJpZ2dlcihpKSwhaS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSl7aWYoIXRoaXMuX2luTmF2YmFyKXtpZigidW5kZWZpbmVkIj09dHlwZW9mIGMpdGhyb3cgbmV3IFR5cGVFcnJvcigiQm9vdHN0cmFwIGRyb3Bkb3duIHJlcXVpcmUgUG9wcGVyLmpzIChodHRwczovL3BvcHBlci5qcy5vcmcpIik7dmFyIHI9dGhpcy5fZWxlbWVudDsicGFyZW50Ij09PXRoaXMuX2NvbmZpZy5yZWZlcmVuY2U/cj10OkNuLmlzRWxlbWVudCh0aGlzLl9jb25maWcucmVmZXJlbmNlKSYmKHI9dGhpcy5fY29uZmlnLnJlZmVyZW5jZSwidW5kZWZpbmVkIiE9dHlwZW9mIHRoaXMuX2NvbmZpZy5yZWZlcmVuY2UuanF1ZXJ5JiYocj10aGlzLl9jb25maWcucmVmZXJlbmNlWzBdKSksInNjcm9sbFBhcmVudCIhPT10aGlzLl9jb25maWcuYm91bmRhcnkmJm10KHQpLmFkZENsYXNzKE90KSx0aGlzLl9wb3BwZXI9bmV3IGMocix0aGlzLl9tZW51LHRoaXMuX2dldFBvcHBlckNvbmZpZygpKX0ib250b3VjaHN0YXJ0ImluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCYmMD09PW10KHQpLmNsb3Nlc3QoanQpLmxlbmd0aCYmbXQoZG9jdW1lbnQuYm9keSkuY2hpbGRyZW4oKS5vbigibW91c2VvdmVyIixudWxsLG10Lm5vb3ApLHRoaXMuX2VsZW1lbnQuZm9jdXMoKSx0aGlzLl9lbGVtZW50LnNldEF0dHJpYnV0ZSgiYXJpYS1leHBhbmRlZCIsITApLG10KHRoaXMuX21lbnUpLnRvZ2dsZUNsYXNzKER0KSxtdCh0KS50b2dnbGVDbGFzcyhEdCkudHJpZ2dlcihtdC5FdmVudChJdC5TSE9XTixuKSl9fX19LHQuZGlzcG9zZT1mdW5jdGlvbigpe210LnJlbW92ZURhdGEodGhpcy5fZWxlbWVudCx2dCksbXQodGhpcy5fZWxlbWVudCkub2ZmKEV0KSx0aGlzLl9lbGVtZW50PW51bGwsKHRoaXMuX21lbnU9bnVsbCkhPT10aGlzLl9wb3BwZXImJih0aGlzLl9wb3BwZXIuZGVzdHJveSgpLHRoaXMuX3BvcHBlcj1udWxsKX0sdC51cGRhdGU9ZnVuY3Rpb24oKXt0aGlzLl9pbk5hdmJhcj10aGlzLl9kZXRlY3ROYXZiYXIoKSxudWxsIT09dGhpcy5fcG9wcGVyJiZ0aGlzLl9wb3BwZXIuc2NoZWR1bGVVcGRhdGUoKX0sdC5fYWRkRXZlbnRMaXN0ZW5lcnM9ZnVuY3Rpb24oKXt2YXIgZT10aGlzO210KHRoaXMuX2VsZW1lbnQpLm9uKEl0LkNMSUNLLGZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbigpLGUudG9nZ2xlKCl9KX0sdC5fZ2V0Q29uZmlnPWZ1bmN0aW9uKHQpe3JldHVybiB0PWgoe30sdGhpcy5jb25zdHJ1Y3Rvci5EZWZhdWx0LG10KHRoaXMuX2VsZW1lbnQpLmRhdGEoKSx0KSxDbi50eXBlQ2hlY2tDb25maWcocHQsdCx0aGlzLmNvbnN0cnVjdG9yLkRlZmF1bHRUeXBlKSx0fSx0Ll9nZXRNZW51RWxlbWVudD1mdW5jdGlvbigpe2lmKCF0aGlzLl9tZW51KXt2YXIgdD1sLl9nZXRQYXJlbnRGcm9tRWxlbWVudCh0aGlzLl9lbGVtZW50KTt0aGlzLl9tZW51PW10KHQpLmZpbmQoTHQpWzBdfXJldHVybiB0aGlzLl9tZW51fSx0Ll9nZXRQbGFjZW1lbnQ9ZnVuY3Rpb24oKXt2YXIgdD1tdCh0aGlzLl9lbGVtZW50KS5wYXJlbnQoKSxlPU10O3JldHVybiB0Lmhhc0NsYXNzKGJ0KT8oZT1IdCxtdCh0aGlzLl9tZW51KS5oYXNDbGFzcyhOdCkmJihlPVd0KSk6dC5oYXNDbGFzcyhTdCk/ZT1VdDp0Lmhhc0NsYXNzKHd0KT9lPUt0Om10KHRoaXMuX21lbnUpLmhhc0NsYXNzKE50KSYmKGU9eHQpLGV9LHQuX2RldGVjdE5hdmJhcj1mdW5jdGlvbigpe3JldHVybiAwPG10KHRoaXMuX2VsZW1lbnQpLmNsb3Nlc3QoIi5uYXZiYXIiKS5sZW5ndGh9LHQuX2dldFBvcHBlckNvbmZpZz1mdW5jdGlvbigpe3ZhciBlPXRoaXMsdD17fTsiZnVuY3Rpb24iPT10eXBlb2YgdGhpcy5fY29uZmlnLm9mZnNldD90LmZuPWZ1bmN0aW9uKHQpe3JldHVybiB0Lm9mZnNldHM9aCh7fSx0Lm9mZnNldHMsZS5fY29uZmlnLm9mZnNldCh0Lm9mZnNldHMpfHx7fSksdH06dC5vZmZzZXQ9dGhpcy5fY29uZmlnLm9mZnNldDt2YXIgbj17cGxhY2VtZW50OnRoaXMuX2dldFBsYWNlbWVudCgpLG1vZGlmaWVyczp7b2Zmc2V0OnQsZmxpcDp7ZW5hYmxlZDp0aGlzLl9jb25maWcuZmxpcH0scHJldmVudE92ZXJmbG93Ontib3VuZGFyaWVzRWxlbWVudDp0aGlzLl9jb25maWcuYm91bmRhcnl9fX07cmV0dXJuInN0YXRpYyI9PT10aGlzLl9jb25maWcuZGlzcGxheSYmKG4ubW9kaWZpZXJzLmFwcGx5U3R5bGU9e2VuYWJsZWQ6ITF9KSxufSxsLl9qUXVlcnlJbnRlcmZhY2U9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciB0PW10KHRoaXMpLmRhdGEodnQpO2lmKHR8fCh0PW5ldyBsKHRoaXMsIm9iamVjdCI9PXR5cGVvZiBlP2U6bnVsbCksbXQodGhpcykuZGF0YSh2dCx0KSksInN0cmluZyI9PXR5cGVvZiBlKXtpZigidW5kZWZpbmVkIj09dHlwZW9mIHRbZV0pdGhyb3cgbmV3IFR5cGVFcnJvcignTm8gbWV0aG9kIG5hbWVkICInK2UrJyInKTt0W2VdKCl9fSl9LGwuX2NsZWFyTWVudXM9ZnVuY3Rpb24odCl7aWYoIXR8fDMhPT10LndoaWNoJiYoImtleXVwIiE9PXQudHlwZXx8OT09PXQud2hpY2gpKWZvcih2YXIgZT1tdC5tYWtlQXJyYXkobXQoa3QpKSxuPTA7bjxlLmxlbmd0aDtuKyspe3ZhciBpPWwuX2dldFBhcmVudEZyb21FbGVtZW50KGVbbl0pLHI9bXQoZVtuXSkuZGF0YSh2dCkscz17cmVsYXRlZFRhcmdldDplW25dfTtpZihyKXt2YXIgbz1yLl9tZW51O2lmKG10KGkpLmhhc0NsYXNzKER0KSYmISh0JiYoImNsaWNrIj09PXQudHlwZSYmL2lucHV0fHRleHRhcmVhL2kudGVzdCh0LnRhcmdldC50YWdOYW1lKXx8ImtleXVwIj09PXQudHlwZSYmOT09PXQud2hpY2gpJiZtdC5jb250YWlucyhpLHQudGFyZ2V0KSkpe3ZhciBhPW10LkV2ZW50KEl0LkhJREUscyk7bXQoaSkudHJpZ2dlcihhKSxhLmlzRGVmYXVsdFByZXZlbnRlZCgpfHwoIm9udG91Y2hzdGFydCJpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQmJm10KGRvY3VtZW50LmJvZHkpLmNoaWxkcmVuKCkub2ZmKCJtb3VzZW92ZXIiLG51bGwsbXQubm9vcCksZVtuXS5zZXRBdHRyaWJ1dGUoImFyaWEtZXhwYW5kZWQiLCJmYWxzZSIpLG10KG8pLnJlbW92ZUNsYXNzKER0KSxtdChpKS5yZW1vdmVDbGFzcyhEdCkudHJpZ2dlcihtdC5FdmVudChJdC5ISURERU4scykpKX19fX0sbC5fZ2V0UGFyZW50RnJvbUVsZW1lbnQ9ZnVuY3Rpb24odCl7dmFyIGUsbj1Dbi5nZXRTZWxlY3RvckZyb21FbGVtZW50KHQpO3JldHVybiBuJiYoZT1tdChuKVswXSksZXx8dC5wYXJlbnROb2RlfSxsLl9kYXRhQXBpS2V5ZG93bkhhbmRsZXI9ZnVuY3Rpb24odCl7aWYoKC9pbnB1dHx0ZXh0YXJlYS9pLnRlc3QodC50YXJnZXQudGFnTmFtZSk/ISgzMj09PXQud2hpY2h8fDI3IT09dC53aGljaCYmKDQwIT09dC53aGljaCYmMzghPT10LndoaWNofHxtdCh0LnRhcmdldCkuY2xvc2VzdChMdCkubGVuZ3RoKSk6Q3QudGVzdCh0LndoaWNoKSkmJih0LnByZXZlbnREZWZhdWx0KCksdC5zdG9wUHJvcGFnYXRpb24oKSwhdGhpcy5kaXNhYmxlZCYmIW10KHRoaXMpLmhhc0NsYXNzKEF0KSkpe3ZhciBlPWwuX2dldFBhcmVudEZyb21FbGVtZW50KHRoaXMpLG49bXQoZSkuaGFzQ2xhc3MoRHQpO2lmKChufHwyNz09PXQud2hpY2gmJjMyPT09dC53aGljaCkmJighbnx8MjchPT10LndoaWNoJiYzMiE9PXQud2hpY2gpKXt2YXIgaT1tdChlKS5maW5kKFJ0KS5nZXQoKTtpZigwIT09aS5sZW5ndGgpe3ZhciByPWkuaW5kZXhPZih0LnRhcmdldCk7Mzg9PT10LndoaWNoJiYwPHImJnItLSw0MD09PXQud2hpY2gmJnI8aS5sZW5ndGgtMSYmcisrLHI8MCYmKHI9MCksaVtyXS5mb2N1cygpfX1lbHNle2lmKDI3PT09dC53aGljaCl7dmFyIHM9bXQoZSkuZmluZChrdClbMF07bXQocykudHJpZ2dlcigiZm9jdXMiKX1tdCh0aGlzKS50cmlnZ2VyKCJjbGljayIpfX19LG8obCxudWxsLFt7a2V5OiJWRVJTSU9OIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4iNC4xLjEifX0se2tleToiRGVmYXVsdCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIEZ0fX0se2tleToiRGVmYXVsdFR5cGUiLGdldDpmdW5jdGlvbigpe3JldHVybiBWdH19XSksbH0oKSxtdChkb2N1bWVudCkub24oSXQuS0VZRE9XTl9EQVRBX0FQSSxrdCxRdC5fZGF0YUFwaUtleWRvd25IYW5kbGVyKS5vbihJdC5LRVlET1dOX0RBVEFfQVBJLEx0LFF0Ll9kYXRhQXBpS2V5ZG93bkhhbmRsZXIpLm9uKEl0LkNMSUNLX0RBVEFfQVBJKyIgIitJdC5LRVlVUF9EQVRBX0FQSSxRdC5fY2xlYXJNZW51cykub24oSXQuQ0xJQ0tfREFUQV9BUEksa3QsZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHQuc3RvcFByb3BhZ2F0aW9uKCksUXQuX2pRdWVyeUludGVyZmFjZS5jYWxsKG10KHRoaXMpLCJ0b2dnbGUiKX0pLm9uKEl0LkNMSUNLX0RBVEFfQVBJLFB0LGZ1bmN0aW9uKHQpe3Quc3RvcFByb3BhZ2F0aW9uKCl9KSxtdC5mbltwdF09UXQuX2pRdWVyeUludGVyZmFjZSxtdC5mbltwdF0uQ29uc3RydWN0b3I9UXQsbXQuZm5bcHRdLm5vQ29uZmxpY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gbXQuZm5bcHRdPVR0LFF0Ll9qUXVlcnlJbnRlcmZhY2V9LFF0KSx3bj0oWXQ9Im1vZGFsIixxdD0iLiIrKEd0PSJicy5tb2RhbCIpLHp0PShCdD1lKS5mbltZdF0sWHQ9e2JhY2tkcm9wOiEwLGtleWJvYXJkOiEwLGZvY3VzOiEwLHNob3c6ITB9LEp0PXtiYWNrZHJvcDoiKGJvb2xlYW58c3RyaW5nKSIsa2V5Ym9hcmQ6ImJvb2xlYW4iLGZvY3VzOiJib29sZWFuIixzaG93OiJib29sZWFuIn0sWnQ9e0hJREU6ImhpZGUiK3F0LEhJRERFTjoiaGlkZGVuIitxdCxTSE9XOiJzaG93IitxdCxTSE9XTjoic2hvd24iK3F0LEZPQ1VTSU46ImZvY3VzaW4iK3F0LFJFU0laRToicmVzaXplIitxdCxDTElDS19ESVNNSVNTOiJjbGljay5kaXNtaXNzIitxdCxLRVlET1dOX0RJU01JU1M6ImtleWRvd24uZGlzbWlzcyIrcXQsTU9VU0VVUF9ESVNNSVNTOiJtb3VzZXVwLmRpc21pc3MiK3F0LE1PVVNFRE9XTl9ESVNNSVNTOiJtb3VzZWRvd24uZGlzbWlzcyIrcXQsQ0xJQ0tfREFUQV9BUEk6ImNsaWNrIitxdCsiLmRhdGEtYXBpIn0sJHQ9Im1vZGFsLXNjcm9sbGJhci1tZWFzdXJlIix0ZT0ibW9kYWwtYmFja2Ryb3AiLGVlPSJtb2RhbC1vcGVuIixuZT0iZmFkZSIsaWU9InNob3ciLHJlPXtESUFMT0c6Ii5tb2RhbC1kaWFsb2ciLERBVEFfVE9HR0xFOidbZGF0YS10b2dnbGU9Im1vZGFsIl0nLERBVEFfRElTTUlTUzonW2RhdGEtZGlzbWlzcz0ibW9kYWwiXScsRklYRURfQ09OVEVOVDoiLmZpeGVkLXRvcCwgLmZpeGVkLWJvdHRvbSwgLmlzLWZpeGVkLCAuc3RpY2t5LXRvcCIsU1RJQ0tZX0NPTlRFTlQ6Ii5zdGlja3ktdG9wIixOQVZCQVJfVE9HR0xFUjoiLm5hdmJhci10b2dnbGVyIn0sc2U9ZnVuY3Rpb24oKXtmdW5jdGlvbiByKHQsZSl7dGhpcy5fY29uZmlnPXRoaXMuX2dldENvbmZpZyhlKSx0aGlzLl9lbGVtZW50PXQsdGhpcy5fZGlhbG9nPUJ0KHQpLmZpbmQocmUuRElBTE9HKVswXSx0aGlzLl9iYWNrZHJvcD1udWxsLHRoaXMuX2lzU2hvd249ITEsdGhpcy5faXNCb2R5T3ZlcmZsb3dpbmc9ITEsdGhpcy5faWdub3JlQmFja2Ryb3BDbGljaz0hMSx0aGlzLl9zY3JvbGxiYXJXaWR0aD0wfXZhciB0PXIucHJvdG90eXBlO3JldHVybiB0LnRvZ2dsZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5faXNTaG93bj90aGlzLmhpZGUoKTp0aGlzLnNob3codCl9LHQuc2hvdz1mdW5jdGlvbih0KXt2YXIgZT10aGlzO2lmKCF0aGlzLl9pc1RyYW5zaXRpb25pbmcmJiF0aGlzLl9pc1Nob3duKXtCdCh0aGlzLl9lbGVtZW50KS5oYXNDbGFzcyhuZSkmJih0aGlzLl9pc1RyYW5zaXRpb25pbmc9ITApO3ZhciBuPUJ0LkV2ZW50KFp0LlNIT1cse3JlbGF0ZWRUYXJnZXQ6dH0pO0J0KHRoaXMuX2VsZW1lbnQpLnRyaWdnZXIobiksdGhpcy5faXNTaG93bnx8bi5pc0RlZmF1bHRQcmV2ZW50ZWQoKXx8KHRoaXMuX2lzU2hvd249ITAsdGhpcy5fY2hlY2tTY3JvbGxiYXIoKSx0aGlzLl9zZXRTY3JvbGxiYXIoKSx0aGlzLl9hZGp1c3REaWFsb2coKSxCdChkb2N1bWVudC5ib2R5KS5hZGRDbGFzcyhlZSksdGhpcy5fc2V0RXNjYXBlRXZlbnQoKSx0aGlzLl9zZXRSZXNpemVFdmVudCgpLEJ0KHRoaXMuX2VsZW1lbnQpLm9uKFp0LkNMSUNLX0RJU01JU1MscmUuREFUQV9ESVNNSVNTLGZ1bmN0aW9uKHQpe3JldHVybiBlLmhpZGUodCl9KSxCdCh0aGlzLl9kaWFsb2cpLm9uKFp0Lk1PVVNFRE9XTl9ESVNNSVNTLGZ1bmN0aW9uKCl7QnQoZS5fZWxlbWVudCkub25lKFp0Lk1PVVNFVVBfRElTTUlTUyxmdW5jdGlvbih0KXtCdCh0LnRhcmdldCkuaXMoZS5fZWxlbWVudCkmJihlLl9pZ25vcmVCYWNrZHJvcENsaWNrPSEwKX0pfSksdGhpcy5fc2hvd0JhY2tkcm9wKGZ1bmN0aW9uKCl7cmV0dXJuIGUuX3Nob3dFbGVtZW50KHQpfSkpfX0sdC5oaWRlPWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXM7aWYodCYmdC5wcmV2ZW50RGVmYXVsdCgpLCF0aGlzLl9pc1RyYW5zaXRpb25pbmcmJnRoaXMuX2lzU2hvd24pe3ZhciBuPUJ0LkV2ZW50KFp0LkhJREUpO2lmKEJ0KHRoaXMuX2VsZW1lbnQpLnRyaWdnZXIobiksdGhpcy5faXNTaG93biYmIW4uaXNEZWZhdWx0UHJldmVudGVkKCkpe3RoaXMuX2lzU2hvd249ITE7dmFyIGk9QnQodGhpcy5fZWxlbWVudCkuaGFzQ2xhc3MobmUpO2lmKGkmJih0aGlzLl9pc1RyYW5zaXRpb25pbmc9ITApLHRoaXMuX3NldEVzY2FwZUV2ZW50KCksdGhpcy5fc2V0UmVzaXplRXZlbnQoKSxCdChkb2N1bWVudCkub2ZmKFp0LkZPQ1VTSU4pLEJ0KHRoaXMuX2VsZW1lbnQpLnJlbW92ZUNsYXNzKGllKSxCdCh0aGlzLl9lbGVtZW50KS5vZmYoWnQuQ0xJQ0tfRElTTUlTUyksQnQodGhpcy5fZGlhbG9nKS5vZmYoWnQuTU9VU0VET1dOX0RJU01JU1MpLGkpe3ZhciByPUNuLmdldFRyYW5zaXRpb25EdXJhdGlvbkZyb21FbGVtZW50KHRoaXMuX2VsZW1lbnQpO0J0KHRoaXMuX2VsZW1lbnQpLm9uZShDbi5UUkFOU0lUSU9OX0VORCxmdW5jdGlvbih0KXtyZXR1cm4gZS5faGlkZU1vZGFsKHQpfSkuZW11bGF0ZVRyYW5zaXRpb25FbmQocil9ZWxzZSB0aGlzLl9oaWRlTW9kYWwoKX19fSx0LmRpc3Bvc2U9ZnVuY3Rpb24oKXtCdC5yZW1vdmVEYXRhKHRoaXMuX2VsZW1lbnQsR3QpLEJ0KHdpbmRvdyxkb2N1bWVudCx0aGlzLl9lbGVtZW50LHRoaXMuX2JhY2tkcm9wKS5vZmYocXQpLHRoaXMuX2NvbmZpZz1udWxsLHRoaXMuX2VsZW1lbnQ9bnVsbCx0aGlzLl9kaWFsb2c9bnVsbCx0aGlzLl9iYWNrZHJvcD1udWxsLHRoaXMuX2lzU2hvd249bnVsbCx0aGlzLl9pc0JvZHlPdmVyZmxvd2luZz1udWxsLHRoaXMuX2lnbm9yZUJhY2tkcm9wQ2xpY2s9bnVsbCx0aGlzLl9zY3JvbGxiYXJXaWR0aD1udWxsfSx0LmhhbmRsZVVwZGF0ZT1mdW5jdGlvbigpe3RoaXMuX2FkanVzdERpYWxvZygpfSx0Ll9nZXRDb25maWc9ZnVuY3Rpb24odCl7cmV0dXJuIHQ9aCh7fSxYdCx0KSxDbi50eXBlQ2hlY2tDb25maWcoWXQsdCxKdCksdH0sdC5fc2hvd0VsZW1lbnQ9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcyxuPUJ0KHRoaXMuX2VsZW1lbnQpLmhhc0NsYXNzKG5lKTt0aGlzLl9lbGVtZW50LnBhcmVudE5vZGUmJnRoaXMuX2VsZW1lbnQucGFyZW50Tm9kZS5ub2RlVHlwZT09PU5vZGUuRUxFTUVOVF9OT0RFfHxkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuX2VsZW1lbnQpLHRoaXMuX2VsZW1lbnQuc3R5bGUuZGlzcGxheT0iYmxvY2siLHRoaXMuX2VsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCJhcmlhLWhpZGRlbiIpLHRoaXMuX2VsZW1lbnQuc2Nyb2xsVG9wPTAsbiYmQ24ucmVmbG93KHRoaXMuX2VsZW1lbnQpLEJ0KHRoaXMuX2VsZW1lbnQpLmFkZENsYXNzKGllKSx0aGlzLl9jb25maWcuZm9jdXMmJnRoaXMuX2VuZm9yY2VGb2N1cygpO3ZhciBpPUJ0LkV2ZW50KFp0LlNIT1dOLHtyZWxhdGVkVGFyZ2V0OnR9KSxyPWZ1bmN0aW9uKCl7ZS5fY29uZmlnLmZvY3VzJiZlLl9lbGVtZW50LmZvY3VzKCksZS5faXNUcmFuc2l0aW9uaW5nPSExLEJ0KGUuX2VsZW1lbnQpLnRyaWdnZXIoaSl9O2lmKG4pe3ZhciBzPUNuLmdldFRyYW5zaXRpb25EdXJhdGlvbkZyb21FbGVtZW50KHRoaXMuX2VsZW1lbnQpO0J0KHRoaXMuX2RpYWxvZykub25lKENuLlRSQU5TSVRJT05fRU5ELHIpLmVtdWxhdGVUcmFuc2l0aW9uRW5kKHMpfWVsc2UgcigpfSx0Ll9lbmZvcmNlRm9jdXM9ZnVuY3Rpb24oKXt2YXIgZT10aGlzO0J0KGRvY3VtZW50KS5vZmYoWnQuRk9DVVNJTikub24oWnQuRk9DVVNJTixmdW5jdGlvbih0KXtkb2N1bWVudCE9PXQudGFyZ2V0JiZlLl9lbGVtZW50IT09dC50YXJnZXQmJjA9PT1CdChlLl9lbGVtZW50KS5oYXModC50YXJnZXQpLmxlbmd0aCYmZS5fZWxlbWVudC5mb2N1cygpfSl9LHQuX3NldEVzY2FwZUV2ZW50PWZ1bmN0aW9uKCl7dmFyIGU9dGhpczt0aGlzLl9pc1Nob3duJiZ0aGlzLl9jb25maWcua2V5Ym9hcmQ/QnQodGhpcy5fZWxlbWVudCkub24oWnQuS0VZRE9XTl9ESVNNSVNTLGZ1bmN0aW9uKHQpezI3PT09dC53aGljaCYmKHQucHJldmVudERlZmF1bHQoKSxlLmhpZGUoKSl9KTp0aGlzLl9pc1Nob3dufHxCdCh0aGlzLl9lbGVtZW50KS5vZmYoWnQuS0VZRE9XTl9ESVNNSVNTKX0sdC5fc2V0UmVzaXplRXZlbnQ9ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3RoaXMuX2lzU2hvd24/QnQod2luZG93KS5vbihadC5SRVNJWkUsZnVuY3Rpb24odCl7cmV0dXJuIGUuaGFuZGxlVXBkYXRlKHQpfSk6QnQod2luZG93KS5vZmYoWnQuUkVTSVpFKX0sdC5faGlkZU1vZGFsPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpczt0aGlzLl9lbGVtZW50LnN0eWxlLmRpc3BsYXk9Im5vbmUiLHRoaXMuX2VsZW1lbnQuc2V0QXR0cmlidXRlKCJhcmlhLWhpZGRlbiIsITApLHRoaXMuX2lzVHJhbnNpdGlvbmluZz0hMSx0aGlzLl9zaG93QmFja2Ryb3AoZnVuY3Rpb24oKXtCdChkb2N1bWVudC5ib2R5KS5yZW1vdmVDbGFzcyhlZSksdC5fcmVzZXRBZGp1c3RtZW50cygpLHQuX3Jlc2V0U2Nyb2xsYmFyKCksQnQodC5fZWxlbWVudCkudHJpZ2dlcihadC5ISURERU4pfSl9LHQuX3JlbW92ZUJhY2tkcm9wPWZ1bmN0aW9uKCl7dGhpcy5fYmFja2Ryb3AmJihCdCh0aGlzLl9iYWNrZHJvcCkucmVtb3ZlKCksdGhpcy5fYmFja2Ryb3A9bnVsbCl9LHQuX3Nob3dCYWNrZHJvcD1mdW5jdGlvbih0KXt2YXIgZT10aGlzLG49QnQodGhpcy5fZWxlbWVudCkuaGFzQ2xhc3MobmUpP25lOiIiO2lmKHRoaXMuX2lzU2hvd24mJnRoaXMuX2NvbmZpZy5iYWNrZHJvcCl7aWYodGhpcy5fYmFja2Ryb3A9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IiksdGhpcy5fYmFja2Ryb3AuY2xhc3NOYW1lPXRlLG4mJkJ0KHRoaXMuX2JhY2tkcm9wKS5hZGRDbGFzcyhuKSxCdCh0aGlzLl9iYWNrZHJvcCkuYXBwZW5kVG8oZG9jdW1lbnQuYm9keSksQnQodGhpcy5fZWxlbWVudCkub24oWnQuQ0xJQ0tfRElTTUlTUyxmdW5jdGlvbih0KXtlLl9pZ25vcmVCYWNrZHJvcENsaWNrP2UuX2lnbm9yZUJhY2tkcm9wQ2xpY2s9ITE6dC50YXJnZXQ9PT10LmN1cnJlbnRUYXJnZXQmJigic3RhdGljIj09PWUuX2NvbmZpZy5iYWNrZHJvcD9lLl9lbGVtZW50LmZvY3VzKCk6ZS5oaWRlKCkpfSksbiYmQ24ucmVmbG93KHRoaXMuX2JhY2tkcm9wKSxCdCh0aGlzLl9iYWNrZHJvcCkuYWRkQ2xhc3MoaWUpLCF0KXJldHVybjtpZighbilyZXR1cm4gdm9pZCB0KCk7dmFyIGk9Q24uZ2V0VHJhbnNpdGlvbkR1cmF0aW9uRnJvbUVsZW1lbnQodGhpcy5fYmFja2Ryb3ApO0J0KHRoaXMuX2JhY2tkcm9wKS5vbmUoQ24uVFJBTlNJVElPTl9FTkQsdCkuZW11bGF0ZVRyYW5zaXRpb25FbmQoaSl9ZWxzZSBpZighdGhpcy5faXNTaG93biYmdGhpcy5fYmFja2Ryb3Ape0J0KHRoaXMuX2JhY2tkcm9wKS5yZW1vdmVDbGFzcyhpZSk7dmFyIHI9ZnVuY3Rpb24oKXtlLl9yZW1vdmVCYWNrZHJvcCgpLHQmJnQoKX07aWYoQnQodGhpcy5fZWxlbWVudCkuaGFzQ2xhc3MobmUpKXt2YXIgcz1Dbi5nZXRUcmFuc2l0aW9uRHVyYXRpb25Gcm9tRWxlbWVudCh0aGlzLl9iYWNrZHJvcCk7QnQodGhpcy5fYmFja2Ryb3ApLm9uZShDbi5UUkFOU0lUSU9OX0VORCxyKS5lbXVsYXRlVHJhbnNpdGlvbkVuZChzKX1lbHNlIHIoKX1lbHNlIHQmJnQoKX0sdC5fYWRqdXN0RGlhbG9nPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fZWxlbWVudC5zY3JvbGxIZWlnaHQ+ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodDshdGhpcy5faXNCb2R5T3ZlcmZsb3dpbmcmJnQmJih0aGlzLl9lbGVtZW50LnN0eWxlLnBhZGRpbmdMZWZ0PXRoaXMuX3Njcm9sbGJhcldpZHRoKyJweCIpLHRoaXMuX2lzQm9keU92ZXJmbG93aW5nJiYhdCYmKHRoaXMuX2VsZW1lbnQuc3R5bGUucGFkZGluZ1JpZ2h0PXRoaXMuX3Njcm9sbGJhcldpZHRoKyJweCIpfSx0Ll9yZXNldEFkanVzdG1lbnRzPWZ1bmN0aW9uKCl7dGhpcy5fZWxlbWVudC5zdHlsZS5wYWRkaW5nTGVmdD0iIix0aGlzLl9lbGVtZW50LnN0eWxlLnBhZGRpbmdSaWdodD0iIn0sdC5fY2hlY2tTY3JvbGxiYXI9ZnVuY3Rpb24oKXt2YXIgdD1kb2N1bWVudC5ib2R5LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO3RoaXMuX2lzQm9keU92ZXJmbG93aW5nPXQubGVmdCt0LnJpZ2h0PHdpbmRvdy5pbm5lcldpZHRoLHRoaXMuX3Njcm9sbGJhcldpZHRoPXRoaXMuX2dldFNjcm9sbGJhcldpZHRoKCl9LHQuX3NldFNjcm9sbGJhcj1mdW5jdGlvbigpe3ZhciByPXRoaXM7aWYodGhpcy5faXNCb2R5T3ZlcmZsb3dpbmcpe0J0KHJlLkZJWEVEX0NPTlRFTlQpLmVhY2goZnVuY3Rpb24odCxlKXt2YXIgbj1CdChlKVswXS5zdHlsZS5wYWRkaW5nUmlnaHQsaT1CdChlKS5jc3MoInBhZGRpbmctcmlnaHQiKTtCdChlKS5kYXRhKCJwYWRkaW5nLXJpZ2h0IixuKS5jc3MoInBhZGRpbmctcmlnaHQiLHBhcnNlRmxvYXQoaSkrci5fc2Nyb2xsYmFyV2lkdGgrInB4Iil9KSxCdChyZS5TVElDS1lfQ09OVEVOVCkuZWFjaChmdW5jdGlvbih0LGUpe3ZhciBuPUJ0KGUpWzBdLnN0eWxlLm1hcmdpblJpZ2h0LGk9QnQoZSkuY3NzKCJtYXJnaW4tcmlnaHQiKTtCdChlKS5kYXRhKCJtYXJnaW4tcmlnaHQiLG4pLmNzcygibWFyZ2luLXJpZ2h0IixwYXJzZUZsb2F0KGkpLXIuX3Njcm9sbGJhcldpZHRoKyJweCIpfSksQnQocmUuTkFWQkFSX1RPR0dMRVIpLmVhY2goZnVuY3Rpb24odCxlKXt2YXIgbj1CdChlKVswXS5zdHlsZS5tYXJnaW5SaWdodCxpPUJ0KGUpLmNzcygibWFyZ2luLXJpZ2h0Iik7QnQoZSkuZGF0YSgibWFyZ2luLXJpZ2h0IixuKS5jc3MoIm1hcmdpbi1yaWdodCIscGFyc2VGbG9hdChpKStyLl9zY3JvbGxiYXJXaWR0aCsicHgiKX0pO3ZhciB0PWRvY3VtZW50LmJvZHkuc3R5bGUucGFkZGluZ1JpZ2h0LGU9QnQoZG9jdW1lbnQuYm9keSkuY3NzKCJwYWRkaW5nLXJpZ2h0Iik7QnQoZG9jdW1lbnQuYm9keSkuZGF0YSgicGFkZGluZy1yaWdodCIsdCkuY3NzKCJwYWRkaW5nLXJpZ2h0IixwYXJzZUZsb2F0KGUpK3RoaXMuX3Njcm9sbGJhcldpZHRoKyJweCIpfX0sdC5fcmVzZXRTY3JvbGxiYXI9ZnVuY3Rpb24oKXtCdChyZS5GSVhFRF9DT05URU5UKS5lYWNoKGZ1bmN0aW9uKHQsZSl7dmFyIG49QnQoZSkuZGF0YSgicGFkZGluZy1yaWdodCIpOyJ1bmRlZmluZWQiIT10eXBlb2YgbiYmQnQoZSkuY3NzKCJwYWRkaW5nLXJpZ2h0IixuKS5yZW1vdmVEYXRhKCJwYWRkaW5nLXJpZ2h0Iil9KSxCdChyZS5TVElDS1lfQ09OVEVOVCsiLCAiK3JlLk5BVkJBUl9UT0dHTEVSKS5lYWNoKGZ1bmN0aW9uKHQsZSl7dmFyIG49QnQoZSkuZGF0YSgibWFyZ2luLXJpZ2h0Iik7InVuZGVmaW5lZCIhPXR5cGVvZiBuJiZCdChlKS5jc3MoIm1hcmdpbi1yaWdodCIsbikucmVtb3ZlRGF0YSgibWFyZ2luLXJpZ2h0Iil9KTt2YXIgdD1CdChkb2N1bWVudC5ib2R5KS5kYXRhKCJwYWRkaW5nLXJpZ2h0Iik7InVuZGVmaW5lZCIhPXR5cGVvZiB0JiZCdChkb2N1bWVudC5ib2R5KS5jc3MoInBhZGRpbmctcmlnaHQiLHQpLnJlbW92ZURhdGEoInBhZGRpbmctcmlnaHQiKX0sdC5fZ2V0U2Nyb2xsYmFyV2lkdGg9ZnVuY3Rpb24oKXt2YXIgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTt0LmNsYXNzTmFtZT0kdCxkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHQpO3ZhciBlPXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGgtdC5jbGllbnRXaWR0aDtyZXR1cm4gZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0KSxlfSxyLl9qUXVlcnlJbnRlcmZhY2U9ZnVuY3Rpb24obixpKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIHQ9QnQodGhpcykuZGF0YShHdCksZT1oKHt9LFh0LEJ0KHRoaXMpLmRhdGEoKSwib2JqZWN0Ij09dHlwZW9mIG4mJm4/bjp7fSk7aWYodHx8KHQ9bmV3IHIodGhpcyxlKSxCdCh0aGlzKS5kYXRhKEd0LHQpKSwic3RyaW5nIj09dHlwZW9mIG4pe2lmKCJ1bmRlZmluZWQiPT10eXBlb2YgdFtuXSl0aHJvdyBuZXcgVHlwZUVycm9yKCdObyBtZXRob2QgbmFtZWQgIicrbisnIicpO3Rbbl0oaSl9ZWxzZSBlLnNob3cmJnQuc2hvdyhpKX0pfSxvKHIsbnVsbCxbe2tleToiVkVSU0lPTiIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIjQuMS4xIn19LHtrZXk6IkRlZmF1bHQiLGdldDpmdW5jdGlvbigpe3JldHVybiBYdH19XSkscn0oKSxCdChkb2N1bWVudCkub24oWnQuQ0xJQ0tfREFUQV9BUEkscmUuREFUQV9UT0dHTEUsZnVuY3Rpb24odCl7dmFyIGUsbj10aGlzLGk9Q24uZ2V0U2VsZWN0b3JGcm9tRWxlbWVudCh0aGlzKTtpJiYoZT1CdChpKVswXSk7dmFyIHI9QnQoZSkuZGF0YShHdCk/InRvZ2dsZSI6aCh7fSxCdChlKS5kYXRhKCksQnQodGhpcykuZGF0YSgpKTsiQSIhPT10aGlzLnRhZ05hbWUmJiJBUkVBIiE9PXRoaXMudGFnTmFtZXx8dC5wcmV2ZW50RGVmYXVsdCgpO3ZhciBzPUJ0KGUpLm9uZShadC5TSE9XLGZ1bmN0aW9uKHQpe3QuaXNEZWZhdWx0UHJldmVudGVkKCl8fHMub25lKFp0LkhJRERFTixmdW5jdGlvbigpe0J0KG4pLmlzKCI6dmlzaWJsZSIpJiZuLmZvY3VzKCl9KX0pO3NlLl9qUXVlcnlJbnRlcmZhY2UuY2FsbChCdChlKSxyLHRoaXMpfSksQnQuZm5bWXRdPXNlLl9qUXVlcnlJbnRlcmZhY2UsQnQuZm5bWXRdLkNvbnN0cnVjdG9yPXNlLEJ0LmZuW1l0XS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cmV0dXJuIEJ0LmZuW1l0XT16dCxzZS5falF1ZXJ5SW50ZXJmYWNlfSxzZSksTm49KGFlPSJ0b29sdGlwIixoZT0iLiIrKGxlPSJicy50b29sdGlwIiksY2U9KG9lPWUpLmZuW2FlXSx1ZT0iYnMtdG9vbHRpcCIsZmU9bmV3IFJlZ0V4cCgiKF58XFxzKSIrdWUrIlxcUysiLCJnIiksZ2U9e2FuaW1hdGlvbjohMCx0ZW1wbGF0ZTonPGRpdiBjbGFzcz0idG9vbHRpcCIgcm9sZT0idG9vbHRpcCI+PGRpdiBjbGFzcz0iYXJyb3ciPjwvZGl2PjxkaXYgY2xhc3M9InRvb2x0aXAtaW5uZXIiPjwvZGl2PjwvZGl2PicsdHJpZ2dlcjoiaG92ZXIgZm9jdXMiLHRpdGxlOiIiLGRlbGF5OjAsaHRtbDohKF9lPXtBVVRPOiJhdXRvIixUT1A6InRvcCIsUklHSFQ6InJpZ2h0IixCT1RUT006ImJvdHRvbSIsTEVGVDoibGVmdCJ9KSxzZWxlY3RvcjohKGRlPXthbmltYXRpb246ImJvb2xlYW4iLHRlbXBsYXRlOiJzdHJpbmciLHRpdGxlOiIoc3RyaW5nfGVsZW1lbnR8ZnVuY3Rpb24pIix0cmlnZ2VyOiJzdHJpbmciLGRlbGF5OiIobnVtYmVyfG9iamVjdCkiLGh0bWw6ImJvb2xlYW4iLHNlbGVjdG9yOiIoc3RyaW5nfGJvb2xlYW4pIixwbGFjZW1lbnQ6IihzdHJpbmd8ZnVuY3Rpb24pIixvZmZzZXQ6IihudW1iZXJ8c3RyaW5nKSIsY29udGFpbmVyOiIoc3RyaW5nfGVsZW1lbnR8Ym9vbGVhbikiLGZhbGxiYWNrUGxhY2VtZW50OiIoc3RyaW5nfGFycmF5KSIsYm91bmRhcnk6IihzdHJpbmd8ZWxlbWVudCkifSkscGxhY2VtZW50OiJ0b3AiLG9mZnNldDowLGNvbnRhaW5lcjohMSxmYWxsYmFja1BsYWNlbWVudDoiZmxpcCIsYm91bmRhcnk6InNjcm9sbFBhcmVudCJ9LHBlPSJvdXQiLHZlPXtISURFOiJoaWRlIitoZSxISURERU46ImhpZGRlbiIraGUsU0hPVzoobWU9InNob3ciKStoZSxTSE9XTjoic2hvd24iK2hlLElOU0VSVEVEOiJpbnNlcnRlZCIraGUsQ0xJQ0s6ImNsaWNrIitoZSxGT0NVU0lOOiJmb2N1c2luIitoZSxGT0NVU09VVDoiZm9jdXNvdXQiK2hlLE1PVVNFRU5URVI6Im1vdXNlZW50ZXIiK2hlLE1PVVNFTEVBVkU6Im1vdXNlbGVhdmUiK2hlfSxFZT0iZmFkZSIseWU9InNob3ciLFRlPSIudG9vbHRpcC1pbm5lciIsQ2U9Ii5hcnJvdyIsSWU9ImhvdmVyIixBZT0iZm9jdXMiLERlPSJjbGljayIsYmU9Im1hbnVhbCIsU2U9ZnVuY3Rpb24oKXtmdW5jdGlvbiBpKHQsZSl7aWYoInVuZGVmaW5lZCI9PXR5cGVvZiBjKXRocm93IG5ldyBUeXBlRXJyb3IoIkJvb3RzdHJhcCB0b29sdGlwcyByZXF1aXJlIFBvcHBlci5qcyAoaHR0cHM6Ly9wb3BwZXIuanMub3JnKSIpO3RoaXMuX2lzRW5hYmxlZD0hMCx0aGlzLl90aW1lb3V0PTAsdGhpcy5faG92ZXJTdGF0ZT0iIix0aGlzLl9hY3RpdmVUcmlnZ2VyPXt9LHRoaXMuX3BvcHBlcj1udWxsLHRoaXMuZWxlbWVudD10LHRoaXMuY29uZmlnPXRoaXMuX2dldENvbmZpZyhlKSx0aGlzLnRpcD1udWxsLHRoaXMuX3NldExpc3RlbmVycygpfXZhciB0PWkucHJvdG90eXBlO3JldHVybiB0LmVuYWJsZT1mdW5jdGlvbigpe3RoaXMuX2lzRW5hYmxlZD0hMH0sdC5kaXNhYmxlPWZ1bmN0aW9uKCl7dGhpcy5faXNFbmFibGVkPSExfSx0LnRvZ2dsZUVuYWJsZWQ9ZnVuY3Rpb24oKXt0aGlzLl9pc0VuYWJsZWQ9IXRoaXMuX2lzRW5hYmxlZH0sdC50b2dnbGU9ZnVuY3Rpb24odCl7aWYodGhpcy5faXNFbmFibGVkKWlmKHQpe3ZhciBlPXRoaXMuY29uc3RydWN0b3IuREFUQV9LRVksbj1vZSh0LmN1cnJlbnRUYXJnZXQpLmRhdGEoZSk7bnx8KG49bmV3IHRoaXMuY29uc3RydWN0b3IodC5jdXJyZW50VGFyZ2V0LHRoaXMuX2dldERlbGVnYXRlQ29uZmlnKCkpLG9lKHQuY3VycmVudFRhcmdldCkuZGF0YShlLG4pKSxuLl9hY3RpdmVUcmlnZ2VyLmNsaWNrPSFuLl9hY3RpdmVUcmlnZ2VyLmNsaWNrLG4uX2lzV2l0aEFjdGl2ZVRyaWdnZXIoKT9uLl9lbnRlcihudWxsLG4pOm4uX2xlYXZlKG51bGwsbil9ZWxzZXtpZihvZSh0aGlzLmdldFRpcEVsZW1lbnQoKSkuaGFzQ2xhc3MoeWUpKXJldHVybiB2b2lkIHRoaXMuX2xlYXZlKG51bGwsdGhpcyk7dGhpcy5fZW50ZXIobnVsbCx0aGlzKX19LHQuZGlzcG9zZT1mdW5jdGlvbigpe2NsZWFyVGltZW91dCh0aGlzLl90aW1lb3V0KSxvZS5yZW1vdmVEYXRhKHRoaXMuZWxlbWVudCx0aGlzLmNvbnN0cnVjdG9yLkRBVEFfS0VZKSxvZSh0aGlzLmVsZW1lbnQpLm9mZih0aGlzLmNvbnN0cnVjdG9yLkVWRU5UX0tFWSksb2UodGhpcy5lbGVtZW50KS5jbG9zZXN0KCIubW9kYWwiKS5vZmYoImhpZGUuYnMubW9kYWwiKSx0aGlzLnRpcCYmb2UodGhpcy50aXApLnJlbW92ZSgpLHRoaXMuX2lzRW5hYmxlZD1udWxsLHRoaXMuX3RpbWVvdXQ9bnVsbCx0aGlzLl9ob3ZlclN0YXRlPW51bGwsKHRoaXMuX2FjdGl2ZVRyaWdnZXI9bnVsbCkhPT10aGlzLl9wb3BwZXImJnRoaXMuX3BvcHBlci5kZXN0cm95KCksdGhpcy5fcG9wcGVyPW51bGwsdGhpcy5lbGVtZW50PW51bGwsdGhpcy5jb25maWc9bnVsbCx0aGlzLnRpcD1udWxsfSx0LnNob3c9ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2lmKCJub25lIj09PW9lKHRoaXMuZWxlbWVudCkuY3NzKCJkaXNwbGF5IikpdGhyb3cgbmV3IEVycm9yKCJQbGVhc2UgdXNlIHNob3cgb24gdmlzaWJsZSBlbGVtZW50cyIpO3ZhciB0PW9lLkV2ZW50KHRoaXMuY29uc3RydWN0b3IuRXZlbnQuU0hPVyk7aWYodGhpcy5pc1dpdGhDb250ZW50KCkmJnRoaXMuX2lzRW5hYmxlZCl7b2UodGhpcy5lbGVtZW50KS50cmlnZ2VyKHQpO3ZhciBuPW9lLmNvbnRhaW5zKHRoaXMuZWxlbWVudC5vd25lckRvY3VtZW50LmRvY3VtZW50RWxlbWVudCx0aGlzLmVsZW1lbnQpO2lmKHQuaXNEZWZhdWx0UHJldmVudGVkKCl8fCFuKXJldHVybjt2YXIgaT10aGlzLmdldFRpcEVsZW1lbnQoKSxyPUNuLmdldFVJRCh0aGlzLmNvbnN0cnVjdG9yLk5BTUUpO2kuc2V0QXR0cmlidXRlKCJpZCIsciksdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZSgiYXJpYS1kZXNjcmliZWRieSIsciksdGhpcy5zZXRDb250ZW50KCksdGhpcy5jb25maWcuYW5pbWF0aW9uJiZvZShpKS5hZGRDbGFzcyhFZSk7dmFyIHM9ImZ1bmN0aW9uIj09dHlwZW9mIHRoaXMuY29uZmlnLnBsYWNlbWVudD90aGlzLmNvbmZpZy5wbGFjZW1lbnQuY2FsbCh0aGlzLGksdGhpcy5lbGVtZW50KTp0aGlzLmNvbmZpZy5wbGFjZW1lbnQsbz10aGlzLl9nZXRBdHRhY2htZW50KHMpO3RoaXMuYWRkQXR0YWNobWVudENsYXNzKG8pO3ZhciBhPSExPT09dGhpcy5jb25maWcuY29udGFpbmVyP2RvY3VtZW50LmJvZHk6b2UodGhpcy5jb25maWcuY29udGFpbmVyKTtvZShpKS5kYXRhKHRoaXMuY29uc3RydWN0b3IuREFUQV9LRVksdGhpcyksb2UuY29udGFpbnModGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LHRoaXMudGlwKXx8b2UoaSkuYXBwZW5kVG8oYSksb2UodGhpcy5lbGVtZW50KS50cmlnZ2VyKHRoaXMuY29uc3RydWN0b3IuRXZlbnQuSU5TRVJURUQpLHRoaXMuX3BvcHBlcj1uZXcgYyh0aGlzLmVsZW1lbnQsaSx7cGxhY2VtZW50Om8sbW9kaWZpZXJzOntvZmZzZXQ6e29mZnNldDp0aGlzLmNvbmZpZy5vZmZzZXR9LGZsaXA6e2JlaGF2aW9yOnRoaXMuY29uZmlnLmZhbGxiYWNrUGxhY2VtZW50fSxhcnJvdzp7ZWxlbWVudDpDZX0scHJldmVudE92ZXJmbG93Ontib3VuZGFyaWVzRWxlbWVudDp0aGlzLmNvbmZpZy5ib3VuZGFyeX19LG9uQ3JlYXRlOmZ1bmN0aW9uKHQpe3Qub3JpZ2luYWxQbGFjZW1lbnQhPT10LnBsYWNlbWVudCYmZS5faGFuZGxlUG9wcGVyUGxhY2VtZW50Q2hhbmdlKHQpfSxvblVwZGF0ZTpmdW5jdGlvbih0KXtlLl9oYW5kbGVQb3BwZXJQbGFjZW1lbnRDaGFuZ2UodCl9fSksb2UoaSkuYWRkQ2xhc3MoeWUpLCJvbnRvdWNoc3RhcnQiaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50JiZvZShkb2N1bWVudC5ib2R5KS5jaGlsZHJlbigpLm9uKCJtb3VzZW92ZXIiLG51bGwsb2Uubm9vcCk7dmFyIGw9ZnVuY3Rpb24oKXtlLmNvbmZpZy5hbmltYXRpb24mJmUuX2ZpeFRyYW5zaXRpb24oKTt2YXIgdD1lLl9ob3ZlclN0YXRlO2UuX2hvdmVyU3RhdGU9bnVsbCxvZShlLmVsZW1lbnQpLnRyaWdnZXIoZS5jb25zdHJ1Y3Rvci5FdmVudC5TSE9XTiksdD09PXBlJiZlLl9sZWF2ZShudWxsLGUpfTtpZihvZSh0aGlzLnRpcCkuaGFzQ2xhc3MoRWUpKXt2YXIgaD1Dbi5nZXRUcmFuc2l0aW9uRHVyYXRpb25Gcm9tRWxlbWVudCh0aGlzLnRpcCk7b2UodGhpcy50aXApLm9uZShDbi5UUkFOU0lUSU9OX0VORCxsKS5lbXVsYXRlVHJhbnNpdGlvbkVuZChoKX1lbHNlIGwoKX19LHQuaGlkZT1mdW5jdGlvbih0KXt2YXIgZT10aGlzLG49dGhpcy5nZXRUaXBFbGVtZW50KCksaT1vZS5FdmVudCh0aGlzLmNvbnN0cnVjdG9yLkV2ZW50LkhJREUpLHI9ZnVuY3Rpb24oKXtlLl9ob3ZlclN0YXRlIT09bWUmJm4ucGFyZW50Tm9kZSYmbi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG4pLGUuX2NsZWFuVGlwQ2xhc3MoKSxlLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCJhcmlhLWRlc2NyaWJlZGJ5Iiksb2UoZS5lbGVtZW50KS50cmlnZ2VyKGUuY29uc3RydWN0b3IuRXZlbnQuSElEREVOKSxudWxsIT09ZS5fcG9wcGVyJiZlLl9wb3BwZXIuZGVzdHJveSgpLHQmJnQoKX07aWYob2UodGhpcy5lbGVtZW50KS50cmlnZ2VyKGkpLCFpLmlzRGVmYXVsdFByZXZlbnRlZCgpKXtpZihvZShuKS5yZW1vdmVDbGFzcyh5ZSksIm9udG91Y2hzdGFydCJpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQmJm9lKGRvY3VtZW50LmJvZHkpLmNoaWxkcmVuKCkub2ZmKCJtb3VzZW92ZXIiLG51bGwsb2Uubm9vcCksdGhpcy5fYWN0aXZlVHJpZ2dlcltEZV09ITEsdGhpcy5fYWN0aXZlVHJpZ2dlcltBZV09ITEsdGhpcy5fYWN0aXZlVHJpZ2dlcltJZV09ITEsb2UodGhpcy50aXApLmhhc0NsYXNzKEVlKSl7dmFyIHM9Q24uZ2V0VHJhbnNpdGlvbkR1cmF0aW9uRnJvbUVsZW1lbnQobik7b2Uobikub25lKENuLlRSQU5TSVRJT05fRU5ELHIpLmVtdWxhdGVUcmFuc2l0aW9uRW5kKHMpfWVsc2UgcigpO3RoaXMuX2hvdmVyU3RhdGU9IiJ9fSx0LnVwZGF0ZT1mdW5jdGlvbigpe251bGwhPT10aGlzLl9wb3BwZXImJnRoaXMuX3BvcHBlci5zY2hlZHVsZVVwZGF0ZSgpfSx0LmlzV2l0aENvbnRlbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gQm9vbGVhbih0aGlzLmdldFRpdGxlKCkpfSx0LmFkZEF0dGFjaG1lbnRDbGFzcz1mdW5jdGlvbih0KXtvZSh0aGlzLmdldFRpcEVsZW1lbnQoKSkuYWRkQ2xhc3ModWUrIi0iK3QpfSx0LmdldFRpcEVsZW1lbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50aXA9dGhpcy50aXB8fG9lKHRoaXMuY29uZmlnLnRlbXBsYXRlKVswXSx0aGlzLnRpcH0sdC5zZXRDb250ZW50PWZ1bmN0aW9uKCl7dmFyIHQ9b2UodGhpcy5nZXRUaXBFbGVtZW50KCkpO3RoaXMuc2V0RWxlbWVudENvbnRlbnQodC5maW5kKFRlKSx0aGlzLmdldFRpdGxlKCkpLHQucmVtb3ZlQ2xhc3MoRWUrIiAiK3llKX0sdC5zZXRFbGVtZW50Q29udGVudD1mdW5jdGlvbih0LGUpe3ZhciBuPXRoaXMuY29uZmlnLmh0bWw7Im9iamVjdCI9PXR5cGVvZiBlJiYoZS5ub2RlVHlwZXx8ZS5qcXVlcnkpP24/b2UoZSkucGFyZW50KCkuaXModCl8fHQuZW1wdHkoKS5hcHBlbmQoZSk6dC50ZXh0KG9lKGUpLnRleHQoKSk6dFtuPyJodG1sIjoidGV4dCJdKGUpfSx0LmdldFRpdGxlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS1vcmlnaW5hbC10aXRsZSIpO3JldHVybiB0fHwodD0iZnVuY3Rpb24iPT10eXBlb2YgdGhpcy5jb25maWcudGl0bGU/dGhpcy5jb25maWcudGl0bGUuY2FsbCh0aGlzLmVsZW1lbnQpOnRoaXMuY29uZmlnLnRpdGxlKSx0fSx0Ll9nZXRBdHRhY2htZW50PWZ1bmN0aW9uKHQpe3JldHVybiBfZVt0LnRvVXBwZXJDYXNlKCldfSx0Ll9zZXRMaXN0ZW5lcnM9ZnVuY3Rpb24oKXt2YXIgaT10aGlzO3RoaXMuY29uZmlnLnRyaWdnZXIuc3BsaXQoIiAiKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe2lmKCJjbGljayI9PT10KW9lKGkuZWxlbWVudCkub24oaS5jb25zdHJ1Y3Rvci5FdmVudC5DTElDSyxpLmNvbmZpZy5zZWxlY3RvcixmdW5jdGlvbih0KXtyZXR1cm4gaS50b2dnbGUodCl9KTtlbHNlIGlmKHQhPT1iZSl7dmFyIGU9dD09PUllP2kuY29uc3RydWN0b3IuRXZlbnQuTU9VU0VFTlRFUjppLmNvbnN0cnVjdG9yLkV2ZW50LkZPQ1VTSU4sbj10PT09SWU/aS5jb25zdHJ1Y3Rvci5FdmVudC5NT1VTRUxFQVZFOmkuY29uc3RydWN0b3IuRXZlbnQuRk9DVVNPVVQ7b2UoaS5lbGVtZW50KS5vbihlLGkuY29uZmlnLnNlbGVjdG9yLGZ1bmN0aW9uKHQpe3JldHVybiBpLl9lbnRlcih0KX0pLm9uKG4saS5jb25maWcuc2VsZWN0b3IsZnVuY3Rpb24odCl7cmV0dXJuIGkuX2xlYXZlKHQpfSl9b2UoaS5lbGVtZW50KS5jbG9zZXN0KCIubW9kYWwiKS5vbigiaGlkZS5icy5tb2RhbCIsZnVuY3Rpb24oKXtyZXR1cm4gaS5oaWRlKCl9KX0pLHRoaXMuY29uZmlnLnNlbGVjdG9yP3RoaXMuY29uZmlnPWgoe30sdGhpcy5jb25maWcse3RyaWdnZXI6Im1hbnVhbCIsc2VsZWN0b3I6IiJ9KTp0aGlzLl9maXhUaXRsZSgpfSx0Ll9maXhUaXRsZT1mdW5jdGlvbigpe3ZhciB0PXR5cGVvZiB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLW9yaWdpbmFsLXRpdGxlIik7KHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoInRpdGxlIil8fCJzdHJpbmciIT09dCkmJih0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKCJkYXRhLW9yaWdpbmFsLXRpdGxlIix0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCJ0aXRsZSIpfHwiIiksdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZSgidGl0bGUiLCIiKSl9LHQuX2VudGVyPWZ1bmN0aW9uKHQsZSl7dmFyIG49dGhpcy5jb25zdHJ1Y3Rvci5EQVRBX0tFWTsoZT1lfHxvZSh0LmN1cnJlbnRUYXJnZXQpLmRhdGEobikpfHwoZT1uZXcgdGhpcy5jb25zdHJ1Y3Rvcih0LmN1cnJlbnRUYXJnZXQsdGhpcy5fZ2V0RGVsZWdhdGVDb25maWcoKSksb2UodC5jdXJyZW50VGFyZ2V0KS5kYXRhKG4sZSkpLHQmJihlLl9hY3RpdmVUcmlnZ2VyWyJmb2N1c2luIj09PXQudHlwZT9BZTpJZV09ITApLG9lKGUuZ2V0VGlwRWxlbWVudCgpKS5oYXNDbGFzcyh5ZSl8fGUuX2hvdmVyU3RhdGU9PT1tZT9lLl9ob3ZlclN0YXRlPW1lOihjbGVhclRpbWVvdXQoZS5fdGltZW91dCksZS5faG92ZXJTdGF0ZT1tZSxlLmNvbmZpZy5kZWxheSYmZS5jb25maWcuZGVsYXkuc2hvdz9lLl90aW1lb3V0PXNldFRpbWVvdXQoZnVuY3Rpb24oKXtlLl9ob3ZlclN0YXRlPT09bWUmJmUuc2hvdygpfSxlLmNvbmZpZy5kZWxheS5zaG93KTplLnNob3coKSl9LHQuX2xlYXZlPWZ1bmN0aW9uKHQsZSl7dmFyIG49dGhpcy5jb25zdHJ1Y3Rvci5EQVRBX0tFWTsoZT1lfHxvZSh0LmN1cnJlbnRUYXJnZXQpLmRhdGEobikpfHwoZT1uZXcgdGhpcy5jb25zdHJ1Y3Rvcih0LmN1cnJlbnRUYXJnZXQsdGhpcy5fZ2V0RGVsZWdhdGVDb25maWcoKSksb2UodC5jdXJyZW50VGFyZ2V0KS5kYXRhKG4sZSkpLHQmJihlLl9hY3RpdmVUcmlnZ2VyWyJmb2N1c291dCI9PT10LnR5cGU/QWU6SWVdPSExKSxlLl9pc1dpdGhBY3RpdmVUcmlnZ2VyKCl8fChjbGVhclRpbWVvdXQoZS5fdGltZW91dCksZS5faG92ZXJTdGF0ZT1wZSxlLmNvbmZpZy5kZWxheSYmZS5jb25maWcuZGVsYXkuaGlkZT9lLl90aW1lb3V0PXNldFRpbWVvdXQoZnVuY3Rpb24oKXtlLl9ob3ZlclN0YXRlPT09cGUmJmUuaGlkZSgpfSxlLmNvbmZpZy5kZWxheS5oaWRlKTplLmhpZGUoKSl9LHQuX2lzV2l0aEFjdGl2ZVRyaWdnZXI9ZnVuY3Rpb24oKXtmb3IodmFyIHQgaW4gdGhpcy5fYWN0aXZlVHJpZ2dlcilpZih0aGlzLl9hY3RpdmVUcmlnZ2VyW3RdKXJldHVybiEwO3JldHVybiExfSx0Ll9nZXRDb25maWc9ZnVuY3Rpb24odCl7cmV0dXJuIm51bWJlciI9PXR5cGVvZih0PWgoe30sdGhpcy5jb25zdHJ1Y3Rvci5EZWZhdWx0LG9lKHRoaXMuZWxlbWVudCkuZGF0YSgpLCJvYmplY3QiPT10eXBlb2YgdCYmdD90Ont9KSkuZGVsYXkmJih0LmRlbGF5PXtzaG93OnQuZGVsYXksaGlkZTp0LmRlbGF5fSksIm51bWJlciI9PXR5cGVvZiB0LnRpdGxlJiYodC50aXRsZT10LnRpdGxlLnRvU3RyaW5nKCkpLCJudW1iZXIiPT10eXBlb2YgdC5jb250ZW50JiYodC5jb250ZW50PXQuY29udGVudC50b1N0cmluZygpKSxDbi50eXBlQ2hlY2tDb25maWcoYWUsdCx0aGlzLmNvbnN0cnVjdG9yLkRlZmF1bHRUeXBlKSx0fSx0Ll9nZXREZWxlZ2F0ZUNvbmZpZz1mdW5jdGlvbigpe3ZhciB0PXt9O2lmKHRoaXMuY29uZmlnKWZvcih2YXIgZSBpbiB0aGlzLmNvbmZpZyl0aGlzLmNvbnN0cnVjdG9yLkRlZmF1bHRbZV0hPT10aGlzLmNvbmZpZ1tlXSYmKHRbZV09dGhpcy5jb25maWdbZV0pO3JldHVybiB0fSx0Ll9jbGVhblRpcENsYXNzPWZ1bmN0aW9uKCl7dmFyIHQ9b2UodGhpcy5nZXRUaXBFbGVtZW50KCkpLGU9dC5hdHRyKCJjbGFzcyIpLm1hdGNoKGZlKTtudWxsIT09ZSYmMDxlLmxlbmd0aCYmdC5yZW1vdmVDbGFzcyhlLmpvaW4oIiIpKX0sdC5faGFuZGxlUG9wcGVyUGxhY2VtZW50Q2hhbmdlPWZ1bmN0aW9uKHQpe3RoaXMuX2NsZWFuVGlwQ2xhc3MoKSx0aGlzLmFkZEF0dGFjaG1lbnRDbGFzcyh0aGlzLl9nZXRBdHRhY2htZW50KHQucGxhY2VtZW50KSl9LHQuX2ZpeFRyYW5zaXRpb249ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldFRpcEVsZW1lbnQoKSxlPXRoaXMuY29uZmlnLmFuaW1hdGlvbjtudWxsPT09dC5nZXRBdHRyaWJ1dGUoIngtcGxhY2VtZW50IikmJihvZSh0KS5yZW1vdmVDbGFzcyhFZSksdGhpcy5jb25maWcuYW5pbWF0aW9uPSExLHRoaXMuaGlkZSgpLHRoaXMuc2hvdygpLHRoaXMuY29uZmlnLmFuaW1hdGlvbj1lKX0saS5falF1ZXJ5SW50ZXJmYWNlPWZ1bmN0aW9uKG4pe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdD1vZSh0aGlzKS5kYXRhKGxlKSxlPSJvYmplY3QiPT10eXBlb2YgbiYmbjtpZigodHx8IS9kaXNwb3NlfGhpZGUvLnRlc3QobikpJiYodHx8KHQ9bmV3IGkodGhpcyxlKSxvZSh0aGlzKS5kYXRhKGxlLHQpKSwic3RyaW5nIj09dHlwZW9mIG4pKXtpZigidW5kZWZpbmVkIj09dHlwZW9mIHRbbl0pdGhyb3cgbmV3IFR5cGVFcnJvcignTm8gbWV0aG9kIG5hbWVkICInK24rJyInKTt0W25dKCl9fSl9LG8oaSxudWxsLFt7a2V5OiJWRVJTSU9OIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4iNC4xLjEifX0se2tleToiRGVmYXVsdCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGdlfX0se2tleToiTkFNRSIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGFlfX0se2tleToiREFUQV9LRVkiLGdldDpmdW5jdGlvbigpe3JldHVybiBsZX19LHtrZXk6IkV2ZW50IixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdmV9fSx7a2V5OiJFVkVOVF9LRVkiLGdldDpmdW5jdGlvbigpe3JldHVybiBoZX19LHtrZXk6IkRlZmF1bHRUeXBlIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZGV9fV0pLGl9KCksb2UuZm5bYWVdPVNlLl9qUXVlcnlJbnRlcmZhY2Usb2UuZm5bYWVdLkNvbnN0cnVjdG9yPVNlLG9lLmZuW2FlXS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cmV0dXJuIG9lLmZuW2FlXT1jZSxTZS5falF1ZXJ5SW50ZXJmYWNlfSxTZSksT249KE5lPSJwb3BvdmVyIixrZT0iLiIrKE9lPSJicy5wb3BvdmVyIiksUGU9KHdlPWUpLmZuW05lXSxMZT0iYnMtcG9wb3ZlciIsamU9bmV3IFJlZ0V4cCgiKF58XFxzKSIrTGUrIlxcUysiLCJnIiksUmU9aCh7fSxObi5EZWZhdWx0LHtwbGFjZW1lbnQ6InJpZ2h0Iix0cmlnZ2VyOiJjbGljayIsY29udGVudDoiIix0ZW1wbGF0ZTonPGRpdiBjbGFzcz0icG9wb3ZlciIgcm9sZT0idG9vbHRpcCI+PGRpdiBjbGFzcz0iYXJyb3ciPjwvZGl2PjxoMyBjbGFzcz0icG9wb3Zlci1oZWFkZXIiPjwvaDM+PGRpdiBjbGFzcz0icG9wb3Zlci1ib2R5Ij48L2Rpdj48L2Rpdj4nfSksSGU9aCh7fSxObi5EZWZhdWx0VHlwZSx7Y29udGVudDoiKHN0cmluZ3xlbGVtZW50fGZ1bmN0aW9uKSJ9KSxXZT0iZmFkZSIseGU9Ii5wb3BvdmVyLWhlYWRlciIsVWU9Ii5wb3BvdmVyLWJvZHkiLEtlPXtISURFOiJoaWRlIitrZSxISURERU46ImhpZGRlbiIra2UsU0hPVzooTWU9InNob3ciKStrZSxTSE9XTjoic2hvd24iK2tlLElOU0VSVEVEOiJpbnNlcnRlZCIra2UsQ0xJQ0s6ImNsaWNrIitrZSxGT0NVU0lOOiJmb2N1c2luIitrZSxGT0NVU09VVDoiZm9jdXNvdXQiK2tlLE1PVVNFRU5URVI6Im1vdXNlZW50ZXIiK2tlLE1PVVNFTEVBVkU6Im1vdXNlbGVhdmUiK2tlfSxGZT1mdW5jdGlvbih0KXt2YXIgZSxuO2Z1bmN0aW9uIGkoKXtyZXR1cm4gdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl8fHRoaXN9bj10LChlPWkpLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG4ucHJvdG90eXBlKSwoZS5wcm90b3R5cGUuY29uc3RydWN0b3I9ZSkuX19wcm90b19fPW47dmFyIHI9aS5wcm90b3R5cGU7cmV0dXJuIHIuaXNXaXRoQ29udGVudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFRpdGxlKCl8fHRoaXMuX2dldENvbnRlbnQoKX0sci5hZGRBdHRhY2htZW50Q2xhc3M9ZnVuY3Rpb24odCl7d2UodGhpcy5nZXRUaXBFbGVtZW50KCkpLmFkZENsYXNzKExlKyItIit0KX0sci5nZXRUaXBFbGVtZW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudGlwPXRoaXMudGlwfHx3ZSh0aGlzLmNvbmZpZy50ZW1wbGF0ZSlbMF0sdGhpcy50aXB9LHIuc2V0Q29udGVudD1mdW5jdGlvbigpe3ZhciB0PXdlKHRoaXMuZ2V0VGlwRWxlbWVudCgpKTt0aGlzLnNldEVsZW1lbnRDb250ZW50KHQuZmluZCh4ZSksdGhpcy5nZXRUaXRsZSgpKTt2YXIgZT10aGlzLl9nZXRDb250ZW50KCk7ImZ1bmN0aW9uIj09dHlwZW9mIGUmJihlPWUuY2FsbCh0aGlzLmVsZW1lbnQpKSx0aGlzLnNldEVsZW1lbnRDb250ZW50KHQuZmluZChVZSksZSksdC5yZW1vdmVDbGFzcyhXZSsiICIrTWUpfSxyLl9nZXRDb250ZW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtY29udGVudCIpfHx0aGlzLmNvbmZpZy5jb250ZW50fSxyLl9jbGVhblRpcENsYXNzPWZ1bmN0aW9uKCl7dmFyIHQ9d2UodGhpcy5nZXRUaXBFbGVtZW50KCkpLGU9dC5hdHRyKCJjbGFzcyIpLm1hdGNoKGplKTtudWxsIT09ZSYmMDxlLmxlbmd0aCYmdC5yZW1vdmVDbGFzcyhlLmpvaW4oIiIpKX0saS5falF1ZXJ5SW50ZXJmYWNlPWZ1bmN0aW9uKG4pe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdD13ZSh0aGlzKS5kYXRhKE9lKSxlPSJvYmplY3QiPT10eXBlb2Ygbj9uOm51bGw7aWYoKHR8fCEvZGVzdHJveXxoaWRlLy50ZXN0KG4pKSYmKHR8fCh0PW5ldyBpKHRoaXMsZSksd2UodGhpcykuZGF0YShPZSx0KSksInN0cmluZyI9PXR5cGVvZiBuKSl7aWYoInVuZGVmaW5lZCI9PXR5cGVvZiB0W25dKXRocm93IG5ldyBUeXBlRXJyb3IoJ05vIG1ldGhvZCBuYW1lZCAiJytuKyciJyk7dFtuXSgpfX0pfSxvKGksbnVsbCxbe2tleToiVkVSU0lPTiIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIjQuMS4xIn19LHtrZXk6IkRlZmF1bHQiLGdldDpmdW5jdGlvbigpe3JldHVybiBSZX19LHtrZXk6Ik5BTUUiLGdldDpmdW5jdGlvbigpe3JldHVybiBOZX19LHtrZXk6IkRBVEFfS0VZIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gT2V9fSx7a2V5OiJFdmVudCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIEtlfX0se2tleToiRVZFTlRfS0VZIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4ga2V9fSx7a2V5OiJEZWZhdWx0VHlwZSIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIEhlfX1dKSxpfShObiksd2UuZm5bTmVdPUZlLl9qUXVlcnlJbnRlcmZhY2Usd2UuZm5bTmVdLkNvbnN0cnVjdG9yPUZlLHdlLmZuW05lXS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHdlLmZuW05lXT1QZSxGZS5falF1ZXJ5SW50ZXJmYWNlfSxGZSksa249KFFlPSJzY3JvbGxzcHkiLFllPSIuIisoQmU9ImJzLnNjcm9sbHNweSIpLEdlPShWZT1lKS5mbltRZV0scWU9e29mZnNldDoxMCxtZXRob2Q6ImF1dG8iLHRhcmdldDoiIn0semU9e29mZnNldDoibnVtYmVyIixtZXRob2Q6InN0cmluZyIsdGFyZ2V0OiIoc3RyaW5nfGVsZW1lbnQpIn0sWGU9e0FDVElWQVRFOiJhY3RpdmF0ZSIrWWUsU0NST0xMOiJzY3JvbGwiK1llLExPQURfREFUQV9BUEk6ImxvYWQiK1llKyIuZGF0YS1hcGkifSxKZT0iZHJvcGRvd24taXRlbSIsWmU9ImFjdGl2ZSIsJGU9e0RBVEFfU1BZOidbZGF0YS1zcHk9InNjcm9sbCJdJyxBQ1RJVkU6Ii5hY3RpdmUiLE5BVl9MSVNUX0dST1VQOiIubmF2LCAubGlzdC1ncm91cCIsTkFWX0xJTktTOiIubmF2LWxpbmsiLE5BVl9JVEVNUzoiLm5hdi1pdGVtIixMSVNUX0lURU1TOiIubGlzdC1ncm91cC1pdGVtIixEUk9QRE9XTjoiLmRyb3Bkb3duIixEUk9QRE9XTl9JVEVNUzoiLmRyb3Bkb3duLWl0ZW0iLERST1BET1dOX1RPR0dMRToiLmRyb3Bkb3duLXRvZ2dsZSJ9LHRuPSJvZmZzZXQiLGVuPSJwb3NpdGlvbiIsbm49ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKHQsZSl7dmFyIG49dGhpczt0aGlzLl9lbGVtZW50PXQsdGhpcy5fc2Nyb2xsRWxlbWVudD0iQk9EWSI9PT10LnRhZ05hbWU/d2luZG93OnQsdGhpcy5fY29uZmlnPXRoaXMuX2dldENvbmZpZyhlKSx0aGlzLl9zZWxlY3Rvcj10aGlzLl9jb25maWcudGFyZ2V0KyIgIiskZS5OQVZfTElOS1MrIiwiK3RoaXMuX2NvbmZpZy50YXJnZXQrIiAiKyRlLkxJU1RfSVRFTVMrIiwiK3RoaXMuX2NvbmZpZy50YXJnZXQrIiAiKyRlLkRST1BET1dOX0lURU1TLHRoaXMuX29mZnNldHM9W10sdGhpcy5fdGFyZ2V0cz1bXSx0aGlzLl9hY3RpdmVUYXJnZXQ9bnVsbCx0aGlzLl9zY3JvbGxIZWlnaHQ9MCxWZSh0aGlzLl9zY3JvbGxFbGVtZW50KS5vbihYZS5TQ1JPTEwsZnVuY3Rpb24odCl7cmV0dXJuIG4uX3Byb2Nlc3ModCl9KSx0aGlzLnJlZnJlc2goKSx0aGlzLl9wcm9jZXNzKCl9dmFyIHQ9bi5wcm90b3R5cGU7cmV0dXJuIHQucmVmcmVzaD1mdW5jdGlvbigpe3ZhciBlPXRoaXMsdD10aGlzLl9zY3JvbGxFbGVtZW50PT09dGhpcy5fc2Nyb2xsRWxlbWVudC53aW5kb3c/dG46ZW4scj0iYXV0byI9PT10aGlzLl9jb25maWcubWV0aG9kP3Q6dGhpcy5fY29uZmlnLm1ldGhvZCxzPXI9PT1lbj90aGlzLl9nZXRTY3JvbGxUb3AoKTowO3RoaXMuX29mZnNldHM9W10sdGhpcy5fdGFyZ2V0cz1bXSx0aGlzLl9zY3JvbGxIZWlnaHQ9dGhpcy5fZ2V0U2Nyb2xsSGVpZ2h0KCksVmUubWFrZUFycmF5KFZlKHRoaXMuX3NlbGVjdG9yKSkubWFwKGZ1bmN0aW9uKHQpe3ZhciBlLG49Q24uZ2V0U2VsZWN0b3JGcm9tRWxlbWVudCh0KTtpZihuJiYoZT1WZShuKVswXSksZSl7dmFyIGk9ZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtpZihpLndpZHRofHxpLmhlaWdodClyZXR1cm5bVmUoZSlbcl0oKS50b3ArcyxuXX1yZXR1cm4gbnVsbH0pLmZpbHRlcihmdW5jdGlvbih0KXtyZXR1cm4gdH0pLnNvcnQoZnVuY3Rpb24odCxlKXtyZXR1cm4gdFswXS1lWzBdfSkuZm9yRWFjaChmdW5jdGlvbih0KXtlLl9vZmZzZXRzLnB1c2godFswXSksZS5fdGFyZ2V0cy5wdXNoKHRbMV0pfSl9LHQuZGlzcG9zZT1mdW5jdGlvbigpe1ZlLnJlbW92ZURhdGEodGhpcy5fZWxlbWVudCxCZSksVmUodGhpcy5fc2Nyb2xsRWxlbWVudCkub2ZmKFllKSx0aGlzLl9lbGVtZW50PW51bGwsdGhpcy5fc2Nyb2xsRWxlbWVudD1udWxsLHRoaXMuX2NvbmZpZz1udWxsLHRoaXMuX3NlbGVjdG9yPW51bGwsdGhpcy5fb2Zmc2V0cz1udWxsLHRoaXMuX3RhcmdldHM9bnVsbCx0aGlzLl9hY3RpdmVUYXJnZXQ9bnVsbCx0aGlzLl9zY3JvbGxIZWlnaHQ9bnVsbH0sdC5fZ2V0Q29uZmlnPWZ1bmN0aW9uKHQpe2lmKCJzdHJpbmciIT10eXBlb2YodD1oKHt9LHFlLCJvYmplY3QiPT10eXBlb2YgdCYmdD90Ont9KSkudGFyZ2V0KXt2YXIgZT1WZSh0LnRhcmdldCkuYXR0cigiaWQiKTtlfHwoZT1Dbi5nZXRVSUQoUWUpLFZlKHQudGFyZ2V0KS5hdHRyKCJpZCIsZSkpLHQudGFyZ2V0PSIjIitlfXJldHVybiBDbi50eXBlQ2hlY2tDb25maWcoUWUsdCx6ZSksdH0sdC5fZ2V0U2Nyb2xsVG9wPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Njcm9sbEVsZW1lbnQ9PT13aW5kb3c/dGhpcy5fc2Nyb2xsRWxlbWVudC5wYWdlWU9mZnNldDp0aGlzLl9zY3JvbGxFbGVtZW50LnNjcm9sbFRvcH0sdC5fZ2V0U2Nyb2xsSGVpZ2h0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Njcm9sbEVsZW1lbnQuc2Nyb2xsSGVpZ2h0fHxNYXRoLm1heChkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodCxkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsSGVpZ2h0KX0sdC5fZ2V0T2Zmc2V0SGVpZ2h0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Njcm9sbEVsZW1lbnQ9PT13aW5kb3c/d2luZG93LmlubmVySGVpZ2h0OnRoaXMuX3Njcm9sbEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0fSx0Ll9wcm9jZXNzPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fZ2V0U2Nyb2xsVG9wKCkrdGhpcy5fY29uZmlnLm9mZnNldCxlPXRoaXMuX2dldFNjcm9sbEhlaWdodCgpLG49dGhpcy5fY29uZmlnLm9mZnNldCtlLXRoaXMuX2dldE9mZnNldEhlaWdodCgpO2lmKHRoaXMuX3Njcm9sbEhlaWdodCE9PWUmJnRoaXMucmVmcmVzaCgpLG48PXQpe3ZhciBpPXRoaXMuX3RhcmdldHNbdGhpcy5fdGFyZ2V0cy5sZW5ndGgtMV07dGhpcy5fYWN0aXZlVGFyZ2V0IT09aSYmdGhpcy5fYWN0aXZhdGUoaSl9ZWxzZXtpZih0aGlzLl9hY3RpdmVUYXJnZXQmJnQ8dGhpcy5fb2Zmc2V0c1swXSYmMDx0aGlzLl9vZmZzZXRzWzBdKXJldHVybiB0aGlzLl9hY3RpdmVUYXJnZXQ9bnVsbCx2b2lkIHRoaXMuX2NsZWFyKCk7Zm9yKHZhciByPXRoaXMuX29mZnNldHMubGVuZ3RoO3ItLTspe3RoaXMuX2FjdGl2ZVRhcmdldCE9PXRoaXMuX3RhcmdldHNbcl0mJnQ+PXRoaXMuX29mZnNldHNbcl0mJigidW5kZWZpbmVkIj09dHlwZW9mIHRoaXMuX29mZnNldHNbcisxXXx8dDx0aGlzLl9vZmZzZXRzW3IrMV0pJiZ0aGlzLl9hY3RpdmF0ZSh0aGlzLl90YXJnZXRzW3JdKX19fSx0Ll9hY3RpdmF0ZT1mdW5jdGlvbihlKXt0aGlzLl9hY3RpdmVUYXJnZXQ9ZSx0aGlzLl9jbGVhcigpO3ZhciB0PXRoaXMuX3NlbGVjdG9yLnNwbGl0KCIsIik7dD10Lm1hcChmdW5jdGlvbih0KXtyZXR1cm4gdCsnW2RhdGEtdGFyZ2V0PSInK2UrJyJdLCcrdCsnW2hyZWY9IicrZSsnIl0nfSk7dmFyIG49VmUodC5qb2luKCIsIikpO24uaGFzQ2xhc3MoSmUpPyhuLmNsb3Nlc3QoJGUuRFJPUERPV04pLmZpbmQoJGUuRFJPUERPV05fVE9HR0xFKS5hZGRDbGFzcyhaZSksbi5hZGRDbGFzcyhaZSkpOihuLmFkZENsYXNzKFplKSxuLnBhcmVudHMoJGUuTkFWX0xJU1RfR1JPVVApLnByZXYoJGUuTkFWX0xJTktTKyIsICIrJGUuTElTVF9JVEVNUykuYWRkQ2xhc3MoWmUpLG4ucGFyZW50cygkZS5OQVZfTElTVF9HUk9VUCkucHJldigkZS5OQVZfSVRFTVMpLmNoaWxkcmVuKCRlLk5BVl9MSU5LUykuYWRkQ2xhc3MoWmUpKSxWZSh0aGlzLl9zY3JvbGxFbGVtZW50KS50cmlnZ2VyKFhlLkFDVElWQVRFLHtyZWxhdGVkVGFyZ2V0OmV9KX0sdC5fY2xlYXI9ZnVuY3Rpb24oKXtWZSh0aGlzLl9zZWxlY3RvcikuZmlsdGVyKCRlLkFDVElWRSkucmVtb3ZlQ2xhc3MoWmUpfSxuLl9qUXVlcnlJbnRlcmZhY2U9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciB0PVZlKHRoaXMpLmRhdGEoQmUpO2lmKHR8fCh0PW5ldyBuKHRoaXMsIm9iamVjdCI9PXR5cGVvZiBlJiZlKSxWZSh0aGlzKS5kYXRhKEJlLHQpKSwic3RyaW5nIj09dHlwZW9mIGUpe2lmKCJ1bmRlZmluZWQiPT10eXBlb2YgdFtlXSl0aHJvdyBuZXcgVHlwZUVycm9yKCdObyBtZXRob2QgbmFtZWQgIicrZSsnIicpO3RbZV0oKX19KX0sbyhuLG51bGwsW3trZXk6IlZFUlNJT04iLGdldDpmdW5jdGlvbigpe3JldHVybiI0LjEuMSJ9fSx7a2V5OiJEZWZhdWx0IixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gcWV9fV0pLG59KCksVmUod2luZG93KS5vbihYZS5MT0FEX0RBVEFfQVBJLGZ1bmN0aW9uKCl7Zm9yKHZhciB0PVZlLm1ha2VBcnJheShWZSgkZS5EQVRBX1NQWSkpLGU9dC5sZW5ndGg7ZS0tOyl7dmFyIG49VmUodFtlXSk7bm4uX2pRdWVyeUludGVyZmFjZS5jYWxsKG4sbi5kYXRhKCkpfX0pLFZlLmZuW1FlXT1ubi5falF1ZXJ5SW50ZXJmYWNlLFZlLmZuW1FlXS5Db25zdHJ1Y3Rvcj1ubixWZS5mbltRZV0ubm9Db25mbGljdD1mdW5jdGlvbigpe3JldHVybiBWZS5mbltRZV09R2Usbm4uX2pRdWVyeUludGVyZmFjZX0sbm4pLFBuPShvbj0iLiIrKHNuPSJicy50YWIiKSxhbj0ocm49ZSkuZm4udGFiLGxuPXtISURFOiJoaWRlIitvbixISURERU46ImhpZGRlbiIrb24sU0hPVzoic2hvdyIrb24sU0hPV046InNob3duIitvbixDTElDS19EQVRBX0FQSToiY2xpY2siK29uKyIuZGF0YS1hcGkifSxobj0iZHJvcGRvd24tbWVudSIsY249ImFjdGl2ZSIsdW49ImRpc2FibGVkIixmbj0iZmFkZSIsZG49InNob3ciLF9uPSIuZHJvcGRvd24iLGduPSIubmF2LCAubGlzdC1ncm91cCIsbW49Ii5hY3RpdmUiLHBuPSI+IGxpID4gLmFjdGl2ZSIsdm49J1tkYXRhLXRvZ2dsZT0idGFiIl0sIFtkYXRhLXRvZ2dsZT0icGlsbCJdLCBbZGF0YS10b2dnbGU9Imxpc3QiXScsRW49Ii5kcm9wZG93bi10b2dnbGUiLHluPSI+IC5kcm9wZG93bi1tZW51IC5hY3RpdmUiLFRuPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gaSh0KXt0aGlzLl9lbGVtZW50PXR9dmFyIHQ9aS5wcm90b3R5cGU7cmV0dXJuIHQuc2hvdz1mdW5jdGlvbigpe3ZhciBuPXRoaXM7aWYoISh0aGlzLl9lbGVtZW50LnBhcmVudE5vZGUmJnRoaXMuX2VsZW1lbnQucGFyZW50Tm9kZS5ub2RlVHlwZT09PU5vZGUuRUxFTUVOVF9OT0RFJiZybih0aGlzLl9lbGVtZW50KS5oYXNDbGFzcyhjbil8fHJuKHRoaXMuX2VsZW1lbnQpLmhhc0NsYXNzKHVuKSkpe3ZhciB0LGksZT1ybih0aGlzLl9lbGVtZW50KS5jbG9zZXN0KGduKVswXSxyPUNuLmdldFNlbGVjdG9yRnJvbUVsZW1lbnQodGhpcy5fZWxlbWVudCk7aWYoZSl7dmFyIHM9IlVMIj09PWUubm9kZU5hbWU/cG46bW47aT0oaT1ybi5tYWtlQXJyYXkocm4oZSkuZmluZChzKSkpW2kubGVuZ3RoLTFdfXZhciBvPXJuLkV2ZW50KGxuLkhJREUse3JlbGF0ZWRUYXJnZXQ6dGhpcy5fZWxlbWVudH0pLGE9cm4uRXZlbnQobG4uU0hPVyx7cmVsYXRlZFRhcmdldDppfSk7aWYoaSYmcm4oaSkudHJpZ2dlcihvKSxybih0aGlzLl9lbGVtZW50KS50cmlnZ2VyKGEpLCFhLmlzRGVmYXVsdFByZXZlbnRlZCgpJiYhby5pc0RlZmF1bHRQcmV2ZW50ZWQoKSl7ciYmKHQ9cm4ocilbMF0pLHRoaXMuX2FjdGl2YXRlKHRoaXMuX2VsZW1lbnQsZSk7dmFyIGw9ZnVuY3Rpb24oKXt2YXIgdD1ybi5FdmVudChsbi5ISURERU4se3JlbGF0ZWRUYXJnZXQ6bi5fZWxlbWVudH0pLGU9cm4uRXZlbnQobG4uU0hPV04se3JlbGF0ZWRUYXJnZXQ6aX0pO3JuKGkpLnRyaWdnZXIodCkscm4obi5fZWxlbWVudCkudHJpZ2dlcihlKX07dD90aGlzLl9hY3RpdmF0ZSh0LHQucGFyZW50Tm9kZSxsKTpsKCl9fX0sdC5kaXNwb3NlPWZ1bmN0aW9uKCl7cm4ucmVtb3ZlRGF0YSh0aGlzLl9lbGVtZW50LHNuKSx0aGlzLl9lbGVtZW50PW51bGx9LHQuX2FjdGl2YXRlPWZ1bmN0aW9uKHQsZSxuKXt2YXIgaT10aGlzLHI9KCJVTCI9PT1lLm5vZGVOYW1lP3JuKGUpLmZpbmQocG4pOnJuKGUpLmNoaWxkcmVuKG1uKSlbMF0scz1uJiZyJiZybihyKS5oYXNDbGFzcyhmbiksbz1mdW5jdGlvbigpe3JldHVybiBpLl90cmFuc2l0aW9uQ29tcGxldGUodCxyLG4pfTtpZihyJiZzKXt2YXIgYT1Dbi5nZXRUcmFuc2l0aW9uRHVyYXRpb25Gcm9tRWxlbWVudChyKTtybihyKS5vbmUoQ24uVFJBTlNJVElPTl9FTkQsbykuZW11bGF0ZVRyYW5zaXRpb25FbmQoYSl9ZWxzZSBvKCl9LHQuX3RyYW5zaXRpb25Db21wbGV0ZT1mdW5jdGlvbih0LGUsbil7aWYoZSl7cm4oZSkucmVtb3ZlQ2xhc3MoZG4rIiAiK2NuKTt2YXIgaT1ybihlLnBhcmVudE5vZGUpLmZpbmQoeW4pWzBdO2kmJnJuKGkpLnJlbW92ZUNsYXNzKGNuKSwidGFiIj09PWUuZ2V0QXR0cmlidXRlKCJyb2xlIikmJmUuc2V0QXR0cmlidXRlKCJhcmlhLXNlbGVjdGVkIiwhMSl9aWYocm4odCkuYWRkQ2xhc3MoY24pLCJ0YWIiPT09dC5nZXRBdHRyaWJ1dGUoInJvbGUiKSYmdC5zZXRBdHRyaWJ1dGUoImFyaWEtc2VsZWN0ZWQiLCEwKSxDbi5yZWZsb3codCkscm4odCkuYWRkQ2xhc3MoZG4pLHQucGFyZW50Tm9kZSYmcm4odC5wYXJlbnROb2RlKS5oYXNDbGFzcyhobikpe3ZhciByPXJuKHQpLmNsb3Nlc3QoX24pWzBdO3ImJnJuKHIpLmZpbmQoRW4pLmFkZENsYXNzKGNuKSx0LnNldEF0dHJpYnV0ZSgiYXJpYS1leHBhbmRlZCIsITApfW4mJm4oKX0saS5falF1ZXJ5SW50ZXJmYWNlPWZ1bmN0aW9uKG4pe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdD1ybih0aGlzKSxlPXQuZGF0YShzbik7aWYoZXx8KGU9bmV3IGkodGhpcyksdC5kYXRhKHNuLGUpKSwic3RyaW5nIj09dHlwZW9mIG4pe2lmKCJ1bmRlZmluZWQiPT10eXBlb2YgZVtuXSl0aHJvdyBuZXcgVHlwZUVycm9yKCdObyBtZXRob2QgbmFtZWQgIicrbisnIicpO2Vbbl0oKX19KX0sbyhpLG51bGwsW3trZXk6IlZFUlNJT04iLGdldDpmdW5jdGlvbigpe3JldHVybiI0LjEuMSJ9fV0pLGl9KCkscm4oZG9jdW1lbnQpLm9uKGxuLkNMSUNLX0RBVEFfQVBJLHZuLGZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSxUbi5falF1ZXJ5SW50ZXJmYWNlLmNhbGwocm4odGhpcyksInNob3ciKX0pLHJuLmZuLnRhYj1Ubi5falF1ZXJ5SW50ZXJmYWNlLHJuLmZuLnRhYi5Db25zdHJ1Y3Rvcj1Ubixybi5mbi50YWIubm9Db25mbGljdD1mdW5jdGlvbigpe3JldHVybiBybi5mbi50YWI9YW4sVG4uX2pRdWVyeUludGVyZmFjZX0sVG4pOyFmdW5jdGlvbih0KXtpZigidW5kZWZpbmVkIj09dHlwZW9mIHQpdGhyb3cgbmV3IFR5cGVFcnJvcigiQm9vdHN0cmFwJ3MgSmF2YVNjcmlwdCByZXF1aXJlcyBqUXVlcnkuIGpRdWVyeSBtdXN0IGJlIGluY2x1ZGVkIGJlZm9yZSBCb290c3RyYXAncyBKYXZhU2NyaXB0LiIpO3ZhciBlPXQuZm4uanF1ZXJ5LnNwbGl0KCIgIilbMF0uc3BsaXQoIi4iKTtpZihlWzBdPDImJmVbMV08OXx8MT09PWVbMF0mJjk9PT1lWzFdJiZlWzJdPDF8fDQ8PWVbMF0pdGhyb3cgbmV3IEVycm9yKCJCb290c3RyYXAncyBKYXZhU2NyaXB0IHJlcXVpcmVzIGF0IGxlYXN0IGpRdWVyeSB2MS45LjEgYnV0IGxlc3MgdGhhbiB2NC4wLjAiKX0oZSksdC5VdGlsPUNuLHQuQWxlcnQ9SW4sdC5CdXR0b249QW4sdC5DYXJvdXNlbD1Ebix0LkNvbGxhcHNlPWJuLHQuRHJvcGRvd249U24sdC5Nb2RhbD13bix0LlBvcG92ZXI9T24sdC5TY3JvbGxzcHk9a24sdC5UYWI9UG4sdC5Ub29sdGlwPU5uLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KX0pOwovLyMgc291cmNlTWFwcGluZ1VSTD1ib290c3RyYXAubWluLmpzLm1hcA0KLyohDQogKiBWdWUuanMgdjIuNS4xMw0KICogKGMpIDIwMTQtMjAxNyBFdmFuIFlvdQ0KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLg0KICovDQohZnVuY3Rpb24odCxlKXsib2JqZWN0Ij09dHlwZW9mIGV4cG9ydHMmJiJ1bmRlZmluZWQiIT10eXBlb2YgbW9kdWxlP21vZHVsZS5leHBvcnRzPWUoKToiZnVuY3Rpb24iPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShlKTp0LlZ1ZT1lKCl9KHRoaXMsZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gdCh0KXtyZXR1cm4gdm9pZCAwPT09dHx8bnVsbD09PXR9ZnVuY3Rpb24gZSh0KXtyZXR1cm4gdm9pZCAwIT09dCYmbnVsbCE9PXR9ZnVuY3Rpb24gbih0KXtyZXR1cm4hMD09PXR9ZnVuY3Rpb24gcih0KXtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIHR8fCJudW1iZXIiPT10eXBlb2YgdHx8InN5bWJvbCI9PXR5cGVvZiB0fHwiYm9vbGVhbiI9PXR5cGVvZiB0fWZ1bmN0aW9uIGkodCl7cmV0dXJuIG51bGwhPT10JiYib2JqZWN0Ij09dHlwZW9mIHR9ZnVuY3Rpb24gbyh0KXtyZXR1cm4iW29iamVjdCBPYmplY3RdIj09PU5uLmNhbGwodCl9ZnVuY3Rpb24gYSh0KXt2YXIgZT1wYXJzZUZsb2F0KFN0cmluZyh0KSk7cmV0dXJuIGU+PTAmJk1hdGguZmxvb3IoZSk9PT1lJiZpc0Zpbml0ZSh0KX1mdW5jdGlvbiBzKHQpe3JldHVybiBudWxsPT10PyIiOiJvYmplY3QiPT10eXBlb2YgdD9KU09OLnN0cmluZ2lmeSh0LG51bGwsMik6U3RyaW5nKHQpfWZ1bmN0aW9uIGModCl7dmFyIGU9cGFyc2VGbG9hdCh0KTtyZXR1cm4gaXNOYU4oZSk/dDplfWZ1bmN0aW9uIHUodCxlKXtmb3IodmFyIG49T2JqZWN0LmNyZWF0ZShudWxsKSxyPXQuc3BsaXQoIiwiKSxpPTA7aTxyLmxlbmd0aDtpKyspbltyW2ldXT0hMDtyZXR1cm4gZT9mdW5jdGlvbih0KXtyZXR1cm4gblt0LnRvTG93ZXJDYXNlKCldfTpmdW5jdGlvbih0KXtyZXR1cm4gblt0XX19ZnVuY3Rpb24gbCh0LGUpe2lmKHQubGVuZ3RoKXt2YXIgbj10LmluZGV4T2YoZSk7aWYobj4tMSlyZXR1cm4gdC5zcGxpY2UobiwxKX19ZnVuY3Rpb24gZih0LGUpe3JldHVybiBNbi5jYWxsKHQsZSl9ZnVuY3Rpb24gcCh0KXt2YXIgZT1PYmplY3QuY3JlYXRlKG51bGwpO3JldHVybiBmdW5jdGlvbihuKXtyZXR1cm4gZVtuXXx8KGVbbl09dChuKSl9fWZ1bmN0aW9uIGQodCxlKXtmdW5jdGlvbiBuKG4pe3ZhciByPWFyZ3VtZW50cy5sZW5ndGg7cmV0dXJuIHI/cj4xP3QuYXBwbHkoZSxhcmd1bWVudHMpOnQuY2FsbChlLG4pOnQuY2FsbChlKX1yZXR1cm4gbi5fbGVuZ3RoPXQubGVuZ3RoLG59ZnVuY3Rpb24gdih0LGUpe2U9ZXx8MDtmb3IodmFyIG49dC5sZW5ndGgtZSxyPW5ldyBBcnJheShuKTtuLS07KXJbbl09dFtuK2VdO3JldHVybiByfWZ1bmN0aW9uIGgodCxlKXtmb3IodmFyIG4gaW4gZSl0W25dPWVbbl07cmV0dXJuIHR9ZnVuY3Rpb24gbSh0KXtmb3IodmFyIGU9e30sbj0wO248dC5sZW5ndGg7bisrKXRbbl0mJmgoZSx0W25dKTtyZXR1cm4gZX1mdW5jdGlvbiB5KHQsZSxuKXt9ZnVuY3Rpb24gZyh0LGUpe2lmKHQ9PT1lKXJldHVybiEwO3ZhciBuPWkodCkscj1pKGUpO2lmKCFufHwhcilyZXR1cm4hbiYmIXImJlN0cmluZyh0KT09PVN0cmluZyhlKTt0cnl7dmFyIG89QXJyYXkuaXNBcnJheSh0KSxhPUFycmF5LmlzQXJyYXkoZSk7aWYobyYmYSlyZXR1cm4gdC5sZW5ndGg9PT1lLmxlbmd0aCYmdC5ldmVyeShmdW5jdGlvbih0LG4pe3JldHVybiBnKHQsZVtuXSl9KTtpZihvfHxhKXJldHVybiExO3ZhciBzPU9iamVjdC5rZXlzKHQpLGM9T2JqZWN0LmtleXMoZSk7cmV0dXJuIHMubGVuZ3RoPT09Yy5sZW5ndGgmJnMuZXZlcnkoZnVuY3Rpb24obil7cmV0dXJuIGcodFtuXSxlW25dKX0pfWNhdGNoKHQpe3JldHVybiExfX1mdW5jdGlvbiBfKHQsZSl7Zm9yKHZhciBuPTA7bjx0Lmxlbmd0aDtuKyspaWYoZyh0W25dLGUpKXJldHVybiBuO3JldHVybi0xfWZ1bmN0aW9uIGIodCl7dmFyIGU9ITE7cmV0dXJuIGZ1bmN0aW9uKCl7ZXx8KGU9ITAsdC5hcHBseSh0aGlzLGFyZ3VtZW50cykpfX1mdW5jdGlvbiAkKHQpe3ZhciBlPSh0KyIiKS5jaGFyQ29kZUF0KDApO3JldHVybiAzNj09PWV8fDk1PT09ZX1mdW5jdGlvbiBDKHQsZSxuLHIpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LGUse3ZhbHVlOm4sZW51bWVyYWJsZTohIXIsd3JpdGFibGU6ITAsY29uZmlndXJhYmxlOiEwfSl9ZnVuY3Rpb24gdyh0KXtyZXR1cm4iZnVuY3Rpb24iPT10eXBlb2YgdCYmL25hdGl2ZSBjb2RlLy50ZXN0KHQudG9TdHJpbmcoKSl9ZnVuY3Rpb24geCh0KXtyZXR1cm4gbmV3IG1yKHZvaWQgMCx2b2lkIDAsdm9pZCAwLFN0cmluZyh0KSl9ZnVuY3Rpb24gayh0LGUpe3ZhciBuPXQuY29tcG9uZW50T3B0aW9ucyxyPW5ldyBtcih0LnRhZyx0LmRhdGEsdC5jaGlsZHJlbix0LnRleHQsdC5lbG0sdC5jb250ZXh0LG4sdC5hc3luY0ZhY3RvcnkpO3JldHVybiByLm5zPXQubnMsci5pc1N0YXRpYz10LmlzU3RhdGljLHIua2V5PXQua2V5LHIuaXNDb21tZW50PXQuaXNDb21tZW50LHIuZm5Db250ZXh0PXQuZm5Db250ZXh0LHIuZm5PcHRpb25zPXQuZm5PcHRpb25zLHIuZm5TY29wZUlkPXQuZm5TY29wZUlkLHIuaXNDbG9uZWQ9ITAsZSYmKHQuY2hpbGRyZW4mJihyLmNoaWxkcmVuPUEodC5jaGlsZHJlbiwhMCkpLG4mJm4uY2hpbGRyZW4mJihuLmNoaWxkcmVuPUEobi5jaGlsZHJlbiwhMCkpKSxyfWZ1bmN0aW9uIEEodCxlKXtmb3IodmFyIG49dC5sZW5ndGgscj1uZXcgQXJyYXkobiksaT0wO2k8bjtpKyspcltpXT1rKHRbaV0sZSk7cmV0dXJuIHJ9ZnVuY3Rpb24gTyh0LGUsbil7dC5fX3Byb3RvX189ZX1mdW5jdGlvbiBTKHQsZSxuKXtmb3IodmFyIHI9MCxpPW4ubGVuZ3RoO3I8aTtyKyspe3ZhciBvPW5bcl07Qyh0LG8sZVtvXSl9fWZ1bmN0aW9uIFQodCxlKXtpZihpKHQpJiYhKHQgaW5zdGFuY2VvZiBtcikpe3ZhciBuO3JldHVybiBmKHQsIl9fb2JfXyIpJiZ0Ll9fb2JfXyBpbnN0YW5jZW9mIHdyP249dC5fX29iX186Q3Iuc2hvdWxkQ29udmVydCYmIXVyKCkmJihBcnJheS5pc0FycmF5KHQpfHxvKHQpKSYmT2JqZWN0LmlzRXh0ZW5zaWJsZSh0KSYmIXQuX2lzVnVlJiYobj1uZXcgd3IodCkpLGUmJm4mJm4udm1Db3VudCsrLG59fWZ1bmN0aW9uIEUodCxlLG4scixpKXt2YXIgbz1uZXcgdnIsYT1PYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHQsZSk7aWYoIWF8fCExIT09YS5jb25maWd1cmFibGUpe3ZhciBzPWEmJmEuZ2V0LGM9YSYmYS5zZXQsdT0haSYmVChuKTtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxlLHtlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXt2YXIgZT1zP3MuY2FsbCh0KTpuO3JldHVybiB2ci50YXJnZXQmJihvLmRlcGVuZCgpLHUmJih1LmRlcC5kZXBlbmQoKSxBcnJheS5pc0FycmF5KGUpJiZJKGUpKSksZX0sc2V0OmZ1bmN0aW9uKGUpe3ZhciByPXM/cy5jYWxsKHQpOm47ZT09PXJ8fGUhPWUmJnIhPXJ8fChjP2MuY2FsbCh0LGUpOm49ZSx1PSFpJiZUKGUpLG8ubm90aWZ5KCkpfX0pfX1mdW5jdGlvbiBqKHQsZSxuKXtpZihBcnJheS5pc0FycmF5KHQpJiZhKGUpKXJldHVybiB0Lmxlbmd0aD1NYXRoLm1heCh0Lmxlbmd0aCxlKSx0LnNwbGljZShlLDEsbiksbjtpZihlIGluIHQmJiEoZSBpbiBPYmplY3QucHJvdG90eXBlKSlyZXR1cm4gdFtlXT1uLG47dmFyIHI9dC5fX29iX187cmV0dXJuIHQuX2lzVnVlfHxyJiZyLnZtQ291bnQ/bjpyPyhFKHIudmFsdWUsZSxuKSxyLmRlcC5ub3RpZnkoKSxuKToodFtlXT1uLG4pfWZ1bmN0aW9uIE4odCxlKXtpZihBcnJheS5pc0FycmF5KHQpJiZhKGUpKXQuc3BsaWNlKGUsMSk7ZWxzZXt2YXIgbj10Ll9fb2JfXzt0Ll9pc1Z1ZXx8biYmbi52bUNvdW50fHxmKHQsZSkmJihkZWxldGUgdFtlXSxuJiZuLmRlcC5ub3RpZnkoKSl9fWZ1bmN0aW9uIEkodCl7Zm9yKHZhciBlPXZvaWQgMCxuPTAscj10Lmxlbmd0aDtuPHI7bisrKShlPXRbbl0pJiZlLl9fb2JfXyYmZS5fX29iX18uZGVwLmRlcGVuZCgpLEFycmF5LmlzQXJyYXkoZSkmJkkoZSl9ZnVuY3Rpb24gTCh0LGUpe2lmKCFlKXJldHVybiB0O2Zvcih2YXIgbixyLGksYT1PYmplY3Qua2V5cyhlKSxzPTA7czxhLmxlbmd0aDtzKyspcj10W249YVtzXV0saT1lW25dLGYodCxuKT9vKHIpJiZvKGkpJiZMKHIsaSk6aih0LG4saSk7cmV0dXJuIHR9ZnVuY3Rpb24gTSh0LGUsbil7cmV0dXJuIG4/ZnVuY3Rpb24oKXt2YXIgcj0iZnVuY3Rpb24iPT10eXBlb2YgZT9lLmNhbGwobixuKTplLGk9ImZ1bmN0aW9uIj09dHlwZW9mIHQ/dC5jYWxsKG4sbik6dDtyZXR1cm4gcj9MKHIsaSk6aX06ZT90P2Z1bmN0aW9uKCl7cmV0dXJuIEwoImZ1bmN0aW9uIj09dHlwZW9mIGU/ZS5jYWxsKHRoaXMsdGhpcyk6ZSwiZnVuY3Rpb24iPT10eXBlb2YgdD90LmNhbGwodGhpcyx0aGlzKTp0KX06ZTp0fWZ1bmN0aW9uIEQodCxlKXtyZXR1cm4gZT90P3QuY29uY2F0KGUpOkFycmF5LmlzQXJyYXkoZSk/ZTpbZV06dH1mdW5jdGlvbiBQKHQsZSxuLHIpe3ZhciBpPU9iamVjdC5jcmVhdGUodHx8bnVsbCk7cmV0dXJuIGU/aChpLGUpOml9ZnVuY3Rpb24gRih0LGUsbil7ZnVuY3Rpb24gcihyKXt2YXIgaT14cltyXXx8T3I7dVtyXT1pKHRbcl0sZVtyXSxuLHIpfSJmdW5jdGlvbiI9PXR5cGVvZiBlJiYoZT1lLm9wdGlvbnMpLGZ1bmN0aW9uKHQsZSl7dmFyIG49dC5wcm9wcztpZihuKXt2YXIgcixpLGE9e307aWYoQXJyYXkuaXNBcnJheShuKSlmb3Iocj1uLmxlbmd0aDtyLS07KSJzdHJpbmciPT10eXBlb2YoaT1uW3JdKSYmKGFbUG4oaSldPXt0eXBlOm51bGx9KTtlbHNlIGlmKG8obikpZm9yKHZhciBzIGluIG4paT1uW3NdLGFbUG4ocyldPW8oaSk/aTp7dHlwZTppfTt0LnByb3BzPWF9fShlKSxmdW5jdGlvbih0LGUpe3ZhciBuPXQuaW5qZWN0O2lmKG4pe3ZhciByPXQuaW5qZWN0PXt9O2lmKEFycmF5LmlzQXJyYXkobikpZm9yKHZhciBpPTA7aTxuLmxlbmd0aDtpKyspcltuW2ldXT17ZnJvbTpuW2ldfTtlbHNlIGlmKG8obikpZm9yKHZhciBhIGluIG4pe3ZhciBzPW5bYV07clthXT1vKHMpP2goe2Zyb206YX0scyk6e2Zyb206c319fX0oZSksZnVuY3Rpb24odCl7dmFyIGU9dC5kaXJlY3RpdmVzO2lmKGUpZm9yKHZhciBuIGluIGUpe3ZhciByPWVbbl07ImZ1bmN0aW9uIj09dHlwZW9mIHImJihlW25dPXtiaW5kOnIsdXBkYXRlOnJ9KX19KGUpO3ZhciBpPWUuZXh0ZW5kcztpZihpJiYodD1GKHQsaSxuKSksZS5taXhpbnMpZm9yKHZhciBhPTAscz1lLm1peGlucy5sZW5ndGg7YTxzO2ErKyl0PUYodCxlLm1peGluc1thXSxuKTt2YXIgYyx1PXt9O2ZvcihjIGluIHQpcihjKTtmb3IoYyBpbiBlKWYodCxjKXx8cihjKTtyZXR1cm4gdX1mdW5jdGlvbiBSKHQsZSxuLHIpe2lmKCJzdHJpbmciPT10eXBlb2Ygbil7dmFyIGk9dFtlXTtpZihmKGksbikpcmV0dXJuIGlbbl07dmFyIG89UG4obik7aWYoZihpLG8pKXJldHVybiBpW29dO3ZhciBhPUZuKG8pO2lmKGYoaSxhKSlyZXR1cm4gaVthXTtyZXR1cm4gaVtuXXx8aVtvXXx8aVthXX19ZnVuY3Rpb24gSCh0LGUsbixyKXt2YXIgaT1lW3RdLG89IWYobix0KSxhPW5bdF07aWYoVShCb29sZWFuLGkudHlwZSkmJihvJiYhZihpLCJkZWZhdWx0Iik/YT0hMTpVKFN0cmluZyxpLnR5cGUpfHwiIiE9PWEmJmEhPT1Ibih0KXx8KGE9ITApKSx2b2lkIDA9PT1hKXthPWZ1bmN0aW9uKHQsZSxuKXtpZighZihlLCJkZWZhdWx0IikpcmV0dXJuO3ZhciByPWUuZGVmYXVsdDtpZih0JiZ0LiRvcHRpb25zLnByb3BzRGF0YSYmdm9pZCAwPT09dC4kb3B0aW9ucy5wcm9wc0RhdGFbbl0mJnZvaWQgMCE9PXQuX3Byb3BzW25dKXJldHVybiB0Ll9wcm9wc1tuXTtyZXR1cm4iZnVuY3Rpb24iPT10eXBlb2YgciYmIkZ1bmN0aW9uIiE9PUIoZS50eXBlKT9yLmNhbGwodCk6cn0ocixpLHQpO3ZhciBzPUNyLnNob3VsZENvbnZlcnQ7Q3Iuc2hvdWxkQ29udmVydD0hMCxUKGEpLENyLnNob3VsZENvbnZlcnQ9c31yZXR1cm4gYX1mdW5jdGlvbiBCKHQpe3ZhciBlPXQmJnQudG9TdHJpbmcoKS5tYXRjaCgvXlxzKmZ1bmN0aW9uIChcdyspLyk7cmV0dXJuIGU/ZVsxXToiIn1mdW5jdGlvbiBVKHQsZSl7aWYoIUFycmF5LmlzQXJyYXkoZSkpcmV0dXJuIEIoZSk9PT1CKHQpO2Zvcih2YXIgbj0wLHI9ZS5sZW5ndGg7bjxyO24rKylpZihCKGVbbl0pPT09Qih0KSlyZXR1cm4hMDtyZXR1cm4hMX1mdW5jdGlvbiBWKHQsZSxuKXtpZihlKWZvcih2YXIgcj1lO3I9ci4kcGFyZW50Oyl7dmFyIGk9ci4kb3B0aW9ucy5lcnJvckNhcHR1cmVkO2lmKGkpZm9yKHZhciBvPTA7bzxpLmxlbmd0aDtvKyspdHJ5e2lmKCExPT09aVtvXS5jYWxsKHIsdCxlLG4pKXJldHVybn1jYXRjaCh0KXt6KHQsciwiZXJyb3JDYXB0dXJlZCBob29rIil9fXoodCxlLG4pfWZ1bmN0aW9uIHoodCxlLG4pe2lmKEpuLmVycm9ySGFuZGxlcil0cnl7cmV0dXJuIEpuLmVycm9ySGFuZGxlci5jYWxsKG51bGwsdCxlLG4pfWNhdGNoKHQpe0sodCxudWxsLCJjb25maWcuZXJyb3JIYW5kbGVyIil9Syh0LGUsbil9ZnVuY3Rpb24gSyh0LGUsbil7aWYoIUduJiYhWm58fCJ1bmRlZmluZWQiPT10eXBlb2YgY29uc29sZSl0aHJvdyB0O2NvbnNvbGUuZXJyb3IodCl9ZnVuY3Rpb24gSigpe1RyPSExO3ZhciB0PVNyLnNsaWNlKDApO1NyLmxlbmd0aD0wO2Zvcih2YXIgZT0wO2U8dC5sZW5ndGg7ZSsrKXRbZV0oKX1mdW5jdGlvbiBxKHQsZSl7dmFyIG47aWYoU3IucHVzaChmdW5jdGlvbigpe2lmKHQpdHJ5e3QuY2FsbChlKX1jYXRjaCh0KXtWKHQsZSwibmV4dFRpY2siKX1lbHNlIG4mJm4oZSl9KSxUcnx8KFRyPSEwLEVyP0FyKCk6a3IoKSksIXQmJiJ1bmRlZmluZWQiIT10eXBlb2YgUHJvbWlzZSlyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24odCl7bj10fSl9ZnVuY3Rpb24gVyh0KXtHKHQsTXIpLE1yLmNsZWFyKCl9ZnVuY3Rpb24gRyh0LGUpe3ZhciBuLHIsbz1BcnJheS5pc0FycmF5KHQpO2lmKChvfHxpKHQpKSYmIU9iamVjdC5pc0Zyb3plbih0KSl7aWYodC5fX29iX18pe3ZhciBhPXQuX19vYl9fLmRlcC5pZDtpZihlLmhhcyhhKSlyZXR1cm47ZS5hZGQoYSl9aWYobylmb3Iobj10Lmxlbmd0aDtuLS07KUcodFtuXSxlKTtlbHNlIGZvcihuPShyPU9iamVjdC5rZXlzKHQpKS5sZW5ndGg7bi0tOylHKHRbcltuXV0sZSl9fWZ1bmN0aW9uIFoodCl7ZnVuY3Rpb24gZSgpe3ZhciB0PWFyZ3VtZW50cyxuPWUuZm5zO2lmKCFBcnJheS5pc0FycmF5KG4pKXJldHVybiBuLmFwcGx5KG51bGwsYXJndW1lbnRzKTtmb3IodmFyIHI9bi5zbGljZSgpLGk9MDtpPHIubGVuZ3RoO2krKylyW2ldLmFwcGx5KG51bGwsdCl9cmV0dXJuIGUuZm5zPXQsZX1mdW5jdGlvbiBYKGUsbixyLGksbyl7dmFyIGEscyxjLHU7Zm9yKGEgaW4gZSlzPWVbYV0sYz1uW2FdLHU9RHIoYSksdChzKXx8KHQoYyk/KHQocy5mbnMpJiYocz1lW2FdPVoocykpLHIodS5uYW1lLHMsdS5vbmNlLHUuY2FwdHVyZSx1LnBhc3NpdmUsdS5wYXJhbXMpKTpzIT09YyYmKGMuZm5zPXMsZVthXT1jKSk7Zm9yKGEgaW4gbil0KGVbYV0pJiZpKCh1PURyKGEpKS5uYW1lLG5bYV0sdS5jYXB0dXJlKX1mdW5jdGlvbiBZKHIsaSxvKXtmdW5jdGlvbiBhKCl7by5hcHBseSh0aGlzLGFyZ3VtZW50cyksbChzLmZucyxhKX1yIGluc3RhbmNlb2YgbXImJihyPXIuZGF0YS5ob29rfHwoci5kYXRhLmhvb2s9e30pKTt2YXIgcyxjPXJbaV07dChjKT9zPVooW2FdKTplKGMuZm5zKSYmbihjLm1lcmdlZCk/KHM9YykuZm5zLnB1c2goYSk6cz1aKFtjLGFdKSxzLm1lcmdlZD0hMCxyW2ldPXN9ZnVuY3Rpb24gUSh0LG4scixpLG8pe2lmKGUobikpe2lmKGYobixyKSlyZXR1cm4gdFtyXT1uW3JdLG98fGRlbGV0ZSBuW3JdLCEwO2lmKGYobixpKSlyZXR1cm4gdFtyXT1uW2ldLG98fGRlbGV0ZSBuW2ldLCEwfXJldHVybiExfWZ1bmN0aW9uIHR0KHQpe3JldHVybiBlKHQpJiZlKHQudGV4dCkmJmZ1bmN0aW9uKHQpe3JldHVybiExPT09dH0odC5pc0NvbW1lbnQpfWZ1bmN0aW9uIGV0KGksbyl7dmFyIGEscyxjLHUsbD1bXTtmb3IoYT0wO2E8aS5sZW5ndGg7YSsrKXQocz1pW2FdKXx8ImJvb2xlYW4iPT10eXBlb2Ygc3x8KHU9bFtjPWwubGVuZ3RoLTFdLEFycmF5LmlzQXJyYXkocyk/cy5sZW5ndGg+MCYmKHR0KChzPWV0KHMsKG98fCIiKSsiXyIrYSkpWzBdKSYmdHQodSkmJihsW2NdPXgodS50ZXh0K3NbMF0udGV4dCkscy5zaGlmdCgpKSxsLnB1c2guYXBwbHkobCxzKSk6cihzKT90dCh1KT9sW2NdPXgodS50ZXh0K3MpOiIiIT09cyYmbC5wdXNoKHgocykpOnR0KHMpJiZ0dCh1KT9sW2NdPXgodS50ZXh0K3MudGV4dCk6KG4oaS5faXNWTGlzdCkmJmUocy50YWcpJiZ0KHMua2V5KSYmZShvKSYmKHMua2V5PSJfX3ZsaXN0IitvKyJfIithKyJfXyIpLGwucHVzaChzKSkpO3JldHVybiBsfWZ1bmN0aW9uIG50KHQsZSl7cmV0dXJuKHQuX19lc01vZHVsZXx8ZnImJiJNb2R1bGUiPT09dFtTeW1ib2wudG9TdHJpbmdUYWddKSYmKHQ9dC5kZWZhdWx0KSxpKHQpP2UuZXh0ZW5kKHQpOnR9ZnVuY3Rpb24gcnQodCl7cmV0dXJuIHQuaXNDb21tZW50JiZ0LmFzeW5jRmFjdG9yeX1mdW5jdGlvbiBpdCh0KXtpZihBcnJheS5pc0FycmF5KHQpKWZvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKXt2YXIgcj10W25dO2lmKGUocikmJihlKHIuY29tcG9uZW50T3B0aW9ucyl8fHJ0KHIpKSlyZXR1cm4gcn19ZnVuY3Rpb24gb3QodCxlLG4pe24/THIuJG9uY2UodCxlKTpMci4kb24odCxlKX1mdW5jdGlvbiBhdCh0LGUpe0xyLiRvZmYodCxlKX1mdW5jdGlvbiBzdCh0LGUsbil7THI9dCxYKGUsbnx8e30sb3QsYXQpLExyPXZvaWQgMH1mdW5jdGlvbiBjdCh0LGUpe3ZhciBuPXt9O2lmKCF0KXJldHVybiBuO2Zvcih2YXIgcj0wLGk9dC5sZW5ndGg7cjxpO3IrKyl7dmFyIG89dFtyXSxhPW8uZGF0YTtpZihhJiZhLmF0dHJzJiZhLmF0dHJzLnNsb3QmJmRlbGV0ZSBhLmF0dHJzLnNsb3Qsby5jb250ZXh0IT09ZSYmby5mbkNvbnRleHQhPT1lfHwhYXx8bnVsbD09YS5zbG90KShuLmRlZmF1bHR8fChuLmRlZmF1bHQ9W10pKS5wdXNoKG8pO2Vsc2V7dmFyIHM9YS5zbG90LGM9bltzXXx8KG5bc109W10pOyJ0ZW1wbGF0ZSI9PT1vLnRhZz9jLnB1c2guYXBwbHkoYyxvLmNoaWxkcmVufHxbXSk6Yy5wdXNoKG8pfX1mb3IodmFyIHUgaW4gbiluW3VdLmV2ZXJ5KHV0KSYmZGVsZXRlIG5bdV07cmV0dXJuIG59ZnVuY3Rpb24gdXQodCl7cmV0dXJuIHQuaXNDb21tZW50JiYhdC5hc3luY0ZhY3Rvcnl8fCIgIj09PXQudGV4dH1mdW5jdGlvbiBsdCh0LGUpe2U9ZXx8e307Zm9yKHZhciBuPTA7bjx0Lmxlbmd0aDtuKyspQXJyYXkuaXNBcnJheSh0W25dKT9sdCh0W25dLGUpOmVbdFtuXS5rZXldPXRbbl0uZm47cmV0dXJuIGV9ZnVuY3Rpb24gZnQodCl7Zm9yKDt0JiYodD10LiRwYXJlbnQpOylpZih0Ll9pbmFjdGl2ZSlyZXR1cm4hMDtyZXR1cm4hMX1mdW5jdGlvbiBwdCh0LGUpe2lmKGUpe2lmKHQuX2RpcmVjdEluYWN0aXZlPSExLGZ0KHQpKXJldHVybn1lbHNlIGlmKHQuX2RpcmVjdEluYWN0aXZlKXJldHVybjtpZih0Ll9pbmFjdGl2ZXx8bnVsbD09PXQuX2luYWN0aXZlKXt0Ll9pbmFjdGl2ZT0hMTtmb3IodmFyIG49MDtuPHQuJGNoaWxkcmVuLmxlbmd0aDtuKyspcHQodC4kY2hpbGRyZW5bbl0pO3Z0KHQsImFjdGl2YXRlZCIpfX1mdW5jdGlvbiBkdCh0LGUpe2lmKCEoZSYmKHQuX2RpcmVjdEluYWN0aXZlPSEwLGZ0KHQpKXx8dC5faW5hY3RpdmUpKXt0Ll9pbmFjdGl2ZT0hMDtmb3IodmFyIG49MDtuPHQuJGNoaWxkcmVuLmxlbmd0aDtuKyspZHQodC4kY2hpbGRyZW5bbl0pO3Z0KHQsImRlYWN0aXZhdGVkIil9fWZ1bmN0aW9uIHZ0KHQsZSl7dmFyIG49dC4kb3B0aW9uc1tlXTtpZihuKWZvcih2YXIgcj0wLGk9bi5sZW5ndGg7cjxpO3IrKyl0cnl7bltyXS5jYWxsKHQpfWNhdGNoKG4pe1Yobix0LGUrIiBob29rIil9dC5faGFzSG9va0V2ZW50JiZ0LiRlbWl0KCJob29rOiIrZSl9ZnVuY3Rpb24gaHQoKXtVcj0hMDt2YXIgdCxlO2ZvcihGci5zb3J0KGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQuaWQtZS5pZH0pLFZyPTA7VnI8RnIubGVuZ3RoO1ZyKyspZT0odD1GcltWcl0pLmlkLEhyW2VdPW51bGwsdC5ydW4oKTt2YXIgbj1Sci5zbGljZSgpLHI9RnIuc2xpY2UoKTtWcj1Gci5sZW5ndGg9UnIubGVuZ3RoPTAsSHI9e30sQnI9VXI9ITEsZnVuY3Rpb24odCl7Zm9yKHZhciBlPTA7ZTx0Lmxlbmd0aDtlKyspdFtlXS5faW5hY3RpdmU9ITAscHQodFtlXSwhMCl9KG4pLGZ1bmN0aW9uKHQpe3ZhciBlPXQubGVuZ3RoO2Zvcig7ZS0tOyl7dmFyIG49dFtlXSxyPW4udm07ci5fd2F0Y2hlcj09PW4mJnIuX2lzTW91bnRlZCYmdnQociwidXBkYXRlZCIpfX0ociksbHImJkpuLmRldnRvb2xzJiZsci5lbWl0KCJmbHVzaCIpfWZ1bmN0aW9uIG10KHQsZSxuKXtKci5nZXQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc1tlXVtuXX0sSnIuc2V0PWZ1bmN0aW9uKHQpe3RoaXNbZV1bbl09dH0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsbixKcil9ZnVuY3Rpb24geXQodCl7dC5fd2F0Y2hlcnM9W107dmFyIGU9dC4kb3B0aW9ucztlLnByb3BzJiZmdW5jdGlvbih0LGUpe3ZhciBuPXQuJG9wdGlvbnMucHJvcHNEYXRhfHx7fSxyPXQuX3Byb3BzPXt9LGk9dC4kb3B0aW9ucy5fcHJvcEtleXM9W10sbz0hdC4kcGFyZW50O0NyLnNob3VsZENvbnZlcnQ9bzt2YXIgYT1mdW5jdGlvbihvKXtpLnB1c2gobyk7dmFyIGE9SChvLGUsbix0KTtFKHIsbyxhKSxvIGluIHR8fG10KHQsIl9wcm9wcyIsbyl9O2Zvcih2YXIgcyBpbiBlKWEocyk7Q3Iuc2hvdWxkQ29udmVydD0hMH0odCxlLnByb3BzKSxlLm1ldGhvZHMmJmZ1bmN0aW9uKHQsZSl7dC4kb3B0aW9ucy5wcm9wcztmb3IodmFyIG4gaW4gZSl0W25dPW51bGw9PWVbbl0/eTpkKGVbbl0sdCl9KHQsZS5tZXRob2RzKSxlLmRhdGE/ZnVuY3Rpb24odCl7dmFyIGU9dC4kb3B0aW9ucy5kYXRhO2U9dC5fZGF0YT0iZnVuY3Rpb24iPT10eXBlb2YgZT9mdW5jdGlvbih0LGUpe3RyeXtyZXR1cm4gdC5jYWxsKGUsZSl9Y2F0Y2godCl7cmV0dXJuIFYodCxlLCJkYXRhKCkiKSx7fX19KGUsdCk6ZXx8e30sbyhlKXx8KGU9e30pO3ZhciBuPU9iamVjdC5rZXlzKGUpLHI9dC4kb3B0aW9ucy5wcm9wcyxpPSh0LiRvcHRpb25zLm1ldGhvZHMsbi5sZW5ndGgpO2Zvcig7aS0tOyl7dmFyIGE9bltpXTtyJiZmKHIsYSl8fCQoYSl8fG10KHQsIl9kYXRhIixhKX1UKGUsITApfSh0KTpUKHQuX2RhdGE9e30sITApLGUuY29tcHV0ZWQmJmZ1bmN0aW9uKHQsZSl7dmFyIG49dC5fY29tcHV0ZWRXYXRjaGVycz1PYmplY3QuY3JlYXRlKG51bGwpLHI9dXIoKTtmb3IodmFyIGkgaW4gZSl7dmFyIG89ZVtpXSxhPSJmdW5jdGlvbiI9PXR5cGVvZiBvP286by5nZXQ7cnx8KG5baV09bmV3IEtyKHQsYXx8eSx5LHFyKSksaSBpbiB0fHxndCh0LGksbyl9fSh0LGUuY29tcHV0ZWQpLGUud2F0Y2gmJmUud2F0Y2ghPT1pciYmZnVuY3Rpb24odCxlKXtmb3IodmFyIG4gaW4gZSl7dmFyIHI9ZVtuXTtpZihBcnJheS5pc0FycmF5KHIpKWZvcih2YXIgaT0wO2k8ci5sZW5ndGg7aSsrKWJ0KHQsbixyW2ldKTtlbHNlIGJ0KHQsbixyKX19KHQsZS53YXRjaCl9ZnVuY3Rpb24gZ3QodCxlLG4pe3ZhciByPSF1cigpOyJmdW5jdGlvbiI9PXR5cGVvZiBuPyhKci5nZXQ9cj9fdChlKTpuLEpyLnNldD15KTooSnIuZ2V0PW4uZ2V0P3ImJiExIT09bi5jYWNoZT9fdChlKTpuLmdldDp5LEpyLnNldD1uLnNldD9uLnNldDp5KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxlLEpyKX1mdW5jdGlvbiBfdCh0KXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgZT10aGlzLl9jb21wdXRlZFdhdGNoZXJzJiZ0aGlzLl9jb21wdXRlZFdhdGNoZXJzW3RdO2lmKGUpcmV0dXJuIGUuZGlydHkmJmUuZXZhbHVhdGUoKSx2ci50YXJnZXQmJmUuZGVwZW5kKCksZS52YWx1ZX19ZnVuY3Rpb24gYnQodCxlLG4scil7cmV0dXJuIG8obikmJihyPW4sbj1uLmhhbmRsZXIpLCJzdHJpbmciPT10eXBlb2YgbiYmKG49dFtuXSksdC4kd2F0Y2goZSxuLHIpfWZ1bmN0aW9uICR0KHQsZSl7aWYodCl7Zm9yKHZhciBuPU9iamVjdC5jcmVhdGUobnVsbCkscj1mcj9SZWZsZWN0Lm93bktleXModCkuZmlsdGVyKGZ1bmN0aW9uKGUpe3JldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHQsZSkuZW51bWVyYWJsZX0pOk9iamVjdC5rZXlzKHQpLGk9MDtpPHIubGVuZ3RoO2krKyl7Zm9yKHZhciBvPXJbaV0sYT10W29dLmZyb20scz1lO3M7KXtpZihzLl9wcm92aWRlZCYmYSBpbiBzLl9wcm92aWRlZCl7bltvXT1zLl9wcm92aWRlZFthXTticmVha31zPXMuJHBhcmVudH1pZighcyYmImRlZmF1bHQiaW4gdFtvXSl7dmFyIGM9dFtvXS5kZWZhdWx0O25bb109ImZ1bmN0aW9uIj09dHlwZW9mIGM/Yy5jYWxsKGUpOmN9fXJldHVybiBufX1mdW5jdGlvbiBDdCh0LG4pe3ZhciByLG8sYSxzLGM7aWYoQXJyYXkuaXNBcnJheSh0KXx8InN0cmluZyI9PXR5cGVvZiB0KWZvcihyPW5ldyBBcnJheSh0Lmxlbmd0aCksbz0wLGE9dC5sZW5ndGg7bzxhO28rKylyW29dPW4odFtvXSxvKTtlbHNlIGlmKCJudW1iZXIiPT10eXBlb2YgdClmb3Iocj1uZXcgQXJyYXkodCksbz0wO288dDtvKyspcltvXT1uKG8rMSxvKTtlbHNlIGlmKGkodCkpZm9yKHM9T2JqZWN0LmtleXModCkscj1uZXcgQXJyYXkocy5sZW5ndGgpLG89MCxhPXMubGVuZ3RoO288YTtvKyspYz1zW29dLHJbb109bih0W2NdLGMsbyk7cmV0dXJuIGUocikmJihyLl9pc1ZMaXN0PSEwKSxyfWZ1bmN0aW9uIHd0KHQsZSxuLHIpe3ZhciBpLG89dGhpcy4kc2NvcGVkU2xvdHNbdF07aWYobyluPW58fHt9LHImJihuPWgoaCh7fSxyKSxuKSksaT1vKG4pfHxlO2Vsc2V7dmFyIGE9dGhpcy4kc2xvdHNbdF07YSYmKGEuX3JlbmRlcmVkPSEwKSxpPWF8fGV9dmFyIHM9biYmbi5zbG90O3JldHVybiBzP3RoaXMuJGNyZWF0ZUVsZW1lbnQoInRlbXBsYXRlIix7c2xvdDpzfSxpKTppfWZ1bmN0aW9uIHh0KHQpe3JldHVybiBSKHRoaXMuJG9wdGlvbnMsImZpbHRlcnMiLHQpfHxVbn1mdW5jdGlvbiBrdCh0LGUsbixyKXt2YXIgaT1Kbi5rZXlDb2Rlc1tlXXx8bjtyZXR1cm4gaT9BcnJheS5pc0FycmF5KGkpPy0xPT09aS5pbmRleE9mKHQpOmkhPT10OnI/SG4ocikhPT1lOnZvaWQgMH1mdW5jdGlvbiBBdCh0LGUsbixyLG8pe2lmKG4paWYoaShuKSl7QXJyYXkuaXNBcnJheShuKSYmKG49bShuKSk7dmFyIGEscz1mdW5jdGlvbihpKXtpZigiY2xhc3MiPT09aXx8InN0eWxlIj09PWl8fExuKGkpKWE9dDtlbHNle3ZhciBzPXQuYXR0cnMmJnQuYXR0cnMudHlwZTthPXJ8fEpuLm11c3RVc2VQcm9wKGUscyxpKT90LmRvbVByb3BzfHwodC5kb21Qcm9wcz17fSk6dC5hdHRyc3x8KHQuYXR0cnM9e30pfWlmKCEoaSBpbiBhKSYmKGFbaV09bltpXSxvKSl7KHQub258fCh0Lm9uPXt9KSlbInVwZGF0ZToiK2ldPWZ1bmN0aW9uKHQpe25baV09dH19fTtmb3IodmFyIGMgaW4gbilzKGMpfWVsc2U7cmV0dXJuIHR9ZnVuY3Rpb24gT3QodCxlKXt2YXIgbj10aGlzLl9zdGF0aWNUcmVlc3x8KHRoaXMuX3N0YXRpY1RyZWVzPVtdKSxyPW5bdF07cmV0dXJuIHImJiFlP0FycmF5LmlzQXJyYXkocik/QShyKTprKHIpOihyPW5bdF09dGhpcy4kb3B0aW9ucy5zdGF0aWNSZW5kZXJGbnNbdF0uY2FsbCh0aGlzLl9yZW5kZXJQcm94eSxudWxsLHRoaXMpLFR0KHIsIl9fc3RhdGljX18iK3QsITEpLHIpfWZ1bmN0aW9uIFN0KHQsZSxuKXtyZXR1cm4gVHQodCwiX19vbmNlX18iK2UrKG4/Il8iK246IiIpLCEwKSx0fWZ1bmN0aW9uIFR0KHQsZSxuKXtpZihBcnJheS5pc0FycmF5KHQpKWZvcih2YXIgcj0wO3I8dC5sZW5ndGg7cisrKXRbcl0mJiJzdHJpbmciIT10eXBlb2YgdFtyXSYmRXQodFtyXSxlKyJfIityLG4pO2Vsc2UgRXQodCxlLG4pfWZ1bmN0aW9uIEV0KHQsZSxuKXt0LmlzU3RhdGljPSEwLHQua2V5PWUsdC5pc09uY2U9bn1mdW5jdGlvbiBqdCh0LGUpe2lmKGUpaWYobyhlKSl7dmFyIG49dC5vbj10Lm9uP2goe30sdC5vbik6e307Zm9yKHZhciByIGluIGUpe3ZhciBpPW5bcl0sYT1lW3JdO25bcl09aT9bXS5jb25jYXQoaSxhKTphfX1lbHNlO3JldHVybiB0fWZ1bmN0aW9uIE50KHQpe3QuX289U3QsdC5fbj1jLHQuX3M9cyx0Ll9sPUN0LHQuX3Q9d3QsdC5fcT1nLHQuX2k9Xyx0Ll9tPU90LHQuX2Y9eHQsdC5faz1rdCx0Ll9iPUF0LHQuX3Y9eCx0Ll9lPWdyLHQuX3U9bHQsdC5fZz1qdH1mdW5jdGlvbiBJdCh0LGUscixpLG8pe3ZhciBhPW8ub3B0aW9uczt0aGlzLmRhdGE9dCx0aGlzLnByb3BzPWUsdGhpcy5jaGlsZHJlbj1yLHRoaXMucGFyZW50PWksdGhpcy5saXN0ZW5lcnM9dC5vbnx8am4sdGhpcy5pbmplY3Rpb25zPSR0KGEuaW5qZWN0LGkpLHRoaXMuc2xvdHM9ZnVuY3Rpb24oKXtyZXR1cm4gY3QocixpKX07dmFyIHM9T2JqZWN0LmNyZWF0ZShpKSxjPW4oYS5fY29tcGlsZWQpLHU9IWM7YyYmKHRoaXMuJG9wdGlvbnM9YSx0aGlzLiRzbG90cz10aGlzLnNsb3RzKCksdGhpcy4kc2NvcGVkU2xvdHM9dC5zY29wZWRTbG90c3x8am4pLGEuX3Njb3BlSWQ/dGhpcy5fYz1mdW5jdGlvbih0LGUsbixyKXt2YXIgbz1EdChzLHQsZSxuLHIsdSk7cmV0dXJuIG8mJihvLmZuU2NvcGVJZD1hLl9zY29wZUlkLG8uZm5Db250ZXh0PWkpLG99OnRoaXMuX2M9ZnVuY3Rpb24odCxlLG4scil7cmV0dXJuIER0KHMsdCxlLG4scix1KX19ZnVuY3Rpb24gTHQodCxlKXtmb3IodmFyIG4gaW4gZSl0W1BuKG4pXT1lW25dfWZ1bmN0aW9uIE10KHIsbyxhLHMsYyl7aWYoIXQocikpe3ZhciB1PWEuJG9wdGlvbnMuX2Jhc2U7aWYoaShyKSYmKHI9dS5leHRlbmQocikpLCJmdW5jdGlvbiI9PXR5cGVvZiByKXt2YXIgbDtpZih0KHIuY2lkKSYmKGw9cix2b2lkIDA9PT0ocj1mdW5jdGlvbihyLG8sYSl7aWYobihyLmVycm9yKSYmZShyLmVycm9yQ29tcCkpcmV0dXJuIHIuZXJyb3JDb21wO2lmKGUoci5yZXNvbHZlZCkpcmV0dXJuIHIucmVzb2x2ZWQ7aWYobihyLmxvYWRpbmcpJiZlKHIubG9hZGluZ0NvbXApKXJldHVybiByLmxvYWRpbmdDb21wO2lmKCFlKHIuY29udGV4dHMpKXt2YXIgcz1yLmNvbnRleHRzPVthXSxjPSEwLHU9ZnVuY3Rpb24oKXtmb3IodmFyIHQ9MCxlPXMubGVuZ3RoO3Q8ZTt0Kyspc1t0XS4kZm9yY2VVcGRhdGUoKX0sbD1iKGZ1bmN0aW9uKHQpe3IucmVzb2x2ZWQ9bnQodCxvKSxjfHx1KCl9KSxmPWIoZnVuY3Rpb24odCl7ZShyLmVycm9yQ29tcCkmJihyLmVycm9yPSEwLHUoKSl9KSxwPXIobCxmKTtyZXR1cm4gaShwKSYmKCJmdW5jdGlvbiI9PXR5cGVvZiBwLnRoZW4/dChyLnJlc29sdmVkKSYmcC50aGVuKGwsZik6ZShwLmNvbXBvbmVudCkmJiJmdW5jdGlvbiI9PXR5cGVvZiBwLmNvbXBvbmVudC50aGVuJiYocC5jb21wb25lbnQudGhlbihsLGYpLGUocC5lcnJvcikmJihyLmVycm9yQ29tcD1udChwLmVycm9yLG8pKSxlKHAubG9hZGluZykmJihyLmxvYWRpbmdDb21wPW50KHAubG9hZGluZyxvKSwwPT09cC5kZWxheT9yLmxvYWRpbmc9ITA6c2V0VGltZW91dChmdW5jdGlvbigpe3Qoci5yZXNvbHZlZCkmJnQoci5lcnJvcikmJihyLmxvYWRpbmc9ITAsdSgpKX0scC5kZWxheXx8MjAwKSksZShwLnRpbWVvdXQpJiZzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dChyLnJlc29sdmVkKSYmZihudWxsKX0scC50aW1lb3V0KSkpLGM9ITEsci5sb2FkaW5nP3IubG9hZGluZ0NvbXA6ci5yZXNvbHZlZH1yLmNvbnRleHRzLnB1c2goYSl9KGwsdSxhKSkpKXJldHVybiBmdW5jdGlvbih0LGUsbixyLGkpe3ZhciBvPWdyKCk7cmV0dXJuIG8uYXN5bmNGYWN0b3J5PXQsby5hc3luY01ldGE9e2RhdGE6ZSxjb250ZXh0Om4sY2hpbGRyZW46cix0YWc6aX0sb30obCxvLGEscyxjKTtvPW98fHt9LEZ0KHIpLGUoby5tb2RlbCkmJmZ1bmN0aW9uKHQsbil7dmFyIHI9dC5tb2RlbCYmdC5tb2RlbC5wcm9wfHwidmFsdWUiLGk9dC5tb2RlbCYmdC5tb2RlbC5ldmVudHx8ImlucHV0Ijsobi5wcm9wc3x8KG4ucHJvcHM9e30pKVtyXT1uLm1vZGVsLnZhbHVlO3ZhciBvPW4ub258fChuLm9uPXt9KTtlKG9baV0pP29baV09W24ubW9kZWwuY2FsbGJhY2tdLmNvbmNhdChvW2ldKTpvW2ldPW4ubW9kZWwuY2FsbGJhY2t9KHIub3B0aW9ucyxvKTt2YXIgZj1mdW5jdGlvbihuLHIsaSl7dmFyIG89ci5vcHRpb25zLnByb3BzO2lmKCF0KG8pKXt2YXIgYT17fSxzPW4uYXR0cnMsYz1uLnByb3BzO2lmKGUocyl8fGUoYykpZm9yKHZhciB1IGluIG8pe3ZhciBsPUhuKHUpO1EoYSxjLHUsbCwhMCl8fFEoYSxzLHUsbCwhMSl9cmV0dXJuIGF9fShvLHIpO2lmKG4oci5vcHRpb25zLmZ1bmN0aW9uYWwpKXJldHVybiBmdW5jdGlvbih0LG4scixpLG8pe3ZhciBhPXQub3B0aW9ucyxzPXt9LGM9YS5wcm9wcztpZihlKGMpKWZvcih2YXIgdSBpbiBjKXNbdV09SCh1LGMsbnx8am4pO2Vsc2UgZShyLmF0dHJzKSYmTHQocyxyLmF0dHJzKSxlKHIucHJvcHMpJiZMdChzLHIucHJvcHMpO3ZhciBsPW5ldyBJdChyLHMsbyxpLHQpLGY9YS5yZW5kZXIuY2FsbChudWxsLGwuX2MsbCk7cmV0dXJuIGYgaW5zdGFuY2VvZiBtciYmKGYuZm5Db250ZXh0PWksZi5mbk9wdGlvbnM9YSxyLnNsb3QmJigoZi5kYXRhfHwoZi5kYXRhPXt9KSkuc2xvdD1yLnNsb3QpKSxmfShyLGYsbyxhLHMpO3ZhciBwPW8ub247aWYoby5vbj1vLm5hdGl2ZU9uLG4oci5vcHRpb25zLmFic3RyYWN0KSl7dmFyIGQ9by5zbG90O289e30sZCYmKG8uc2xvdD1kKX0hZnVuY3Rpb24odCl7dC5ob29rfHwodC5ob29rPXt9KTtmb3IodmFyIGU9MDtlPEdyLmxlbmd0aDtlKyspe3ZhciBuPUdyW2VdLHI9dC5ob29rW25dLGk9V3Jbbl07dC5ob29rW25dPXI/ZnVuY3Rpb24odCxlKXtyZXR1cm4gZnVuY3Rpb24obixyLGksbyl7dChuLHIsaSxvKSxlKG4scixpLG8pfX0oaSxyKTppfX0obyk7dmFyIHY9ci5vcHRpb25zLm5hbWV8fGM7cmV0dXJuIG5ldyBtcigidnVlLWNvbXBvbmVudC0iK3IuY2lkKyh2PyItIit2OiIiKSxvLHZvaWQgMCx2b2lkIDAsdm9pZCAwLGEse0N0b3I6cixwcm9wc0RhdGE6ZixsaXN0ZW5lcnM6cCx0YWc6YyxjaGlsZHJlbjpzfSxsKX19fWZ1bmN0aW9uIER0KHQsaSxvLGEscyxjKXtyZXR1cm4oQXJyYXkuaXNBcnJheShvKXx8cihvKSkmJihzPWEsYT1vLG89dm9pZCAwKSxuKGMpJiYocz1YciksZnVuY3Rpb24odCxuLGksbyxhKXtpZihlKGkpJiZlKGkuX19vYl9fKSlyZXR1cm4gZ3IoKTtlKGkpJiZlKGkuaXMpJiYobj1pLmlzKTtpZighbilyZXR1cm4gZ3IoKTtBcnJheS5pc0FycmF5KG8pJiYiZnVuY3Rpb24iPT10eXBlb2Ygb1swXSYmKChpPWl8fHt9KS5zY29wZWRTbG90cz17ZGVmYXVsdDpvWzBdfSxvLmxlbmd0aD0wKTthPT09WHI/bz1mdW5jdGlvbih0KXtyZXR1cm4gcih0KT9beCh0KV06QXJyYXkuaXNBcnJheSh0KT9ldCh0KTp2b2lkIDB9KG8pOmE9PT1aciYmKG89ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTA7ZTx0Lmxlbmd0aDtlKyspaWYoQXJyYXkuaXNBcnJheSh0W2VdKSlyZXR1cm4gQXJyYXkucHJvdG90eXBlLmNvbmNhdC5hcHBseShbXSx0KTtyZXR1cm4gdH0obykpO3ZhciBzLGM7aWYoInN0cmluZyI9PXR5cGVvZiBuKXt2YXIgdTtjPXQuJHZub2RlJiZ0LiR2bm9kZS5uc3x8Sm4uZ2V0VGFnTmFtZXNwYWNlKG4pLHM9Sm4uaXNSZXNlcnZlZFRhZyhuKT9uZXcgbXIoSm4ucGFyc2VQbGF0Zm9ybVRhZ05hbWUobiksaSxvLHZvaWQgMCx2b2lkIDAsdCk6ZSh1PVIodC4kb3B0aW9ucywiY29tcG9uZW50cyIsbikpP010KHUsaSx0LG8sbik6bmV3IG1yKG4saSxvLHZvaWQgMCx2b2lkIDAsdCl9ZWxzZSBzPU10KG4saSx0LG8pO3JldHVybiBlKHMpPyhjJiZQdChzLGMpLHMpOmdyKCl9KHQsaSxvLGEscyl9ZnVuY3Rpb24gUHQocixpLG8pe2lmKHIubnM9aSwiZm9yZWlnbk9iamVjdCI9PT1yLnRhZyYmKGk9dm9pZCAwLG89ITApLGUoci5jaGlsZHJlbikpZm9yKHZhciBhPTAscz1yLmNoaWxkcmVuLmxlbmd0aDthPHM7YSsrKXt2YXIgYz1yLmNoaWxkcmVuW2FdO2UoYy50YWcpJiYodChjLm5zKXx8bihvKSkmJlB0KGMsaSxvKX19ZnVuY3Rpb24gRnQodCl7dmFyIGU9dC5vcHRpb25zO2lmKHQuc3VwZXIpe3ZhciBuPUZ0KHQuc3VwZXIpO2lmKG4hPT10LnN1cGVyT3B0aW9ucyl7dC5zdXBlck9wdGlvbnM9bjt2YXIgcj1mdW5jdGlvbih0KXt2YXIgZSxuPXQub3B0aW9ucyxyPXQuZXh0ZW5kT3B0aW9ucyxpPXQuc2VhbGVkT3B0aW9ucztmb3IodmFyIG8gaW4gbiluW29dIT09aVtvXSYmKGV8fChlPXt9KSxlW29dPWZ1bmN0aW9uKHQsZSxuKXt7aWYoQXJyYXkuaXNBcnJheSh0KSl7dmFyIHI9W107bj1BcnJheS5pc0FycmF5KG4pP246W25dLGU9QXJyYXkuaXNBcnJheShlKT9lOltlXTtmb3IodmFyIGk9MDtpPHQubGVuZ3RoO2krKykoZS5pbmRleE9mKHRbaV0pPj0wfHxuLmluZGV4T2YodFtpXSk8MCkmJnIucHVzaCh0W2ldKTtyZXR1cm4gcn1yZXR1cm4gdH19KG5bb10scltvXSxpW29dKSk7cmV0dXJuIGV9KHQpO3ImJmgodC5leHRlbmRPcHRpb25zLHIpLChlPXQub3B0aW9ucz1GKG4sdC5leHRlbmRPcHRpb25zKSkubmFtZSYmKGUuY29tcG9uZW50c1tlLm5hbWVdPXQpfX1yZXR1cm4gZX1mdW5jdGlvbiBSdCh0KXt0aGlzLl9pbml0KHQpfWZ1bmN0aW9uIEh0KHQpe3QuY2lkPTA7dmFyIGU9MTt0LmV4dGVuZD1mdW5jdGlvbih0KXt0PXR8fHt9O3ZhciBuPXRoaXMscj1uLmNpZCxpPXQuX0N0b3J8fCh0Ll9DdG9yPXt9KTtpZihpW3JdKXJldHVybiBpW3JdO3ZhciBvPXQubmFtZXx8bi5vcHRpb25zLm5hbWUsYT1mdW5jdGlvbih0KXt0aGlzLl9pbml0KHQpfTtyZXR1cm4gYS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShuLnByb3RvdHlwZSksYS5wcm90b3R5cGUuY29uc3RydWN0b3I9YSxhLmNpZD1lKyssYS5vcHRpb25zPUYobi5vcHRpb25zLHQpLGEuc3VwZXI9bixhLm9wdGlvbnMucHJvcHMmJmZ1bmN0aW9uKHQpe3ZhciBlPXQub3B0aW9ucy5wcm9wcztmb3IodmFyIG4gaW4gZSltdCh0LnByb3RvdHlwZSwiX3Byb3BzIixuKX0oYSksYS5vcHRpb25zLmNvbXB1dGVkJiZmdW5jdGlvbih0KXt2YXIgZT10Lm9wdGlvbnMuY29tcHV0ZWQ7Zm9yKHZhciBuIGluIGUpZ3QodC5wcm90b3R5cGUsbixlW25dKX0oYSksYS5leHRlbmQ9bi5leHRlbmQsYS5taXhpbj1uLm1peGluLGEudXNlPW4udXNlLHpuLmZvckVhY2goZnVuY3Rpb24odCl7YVt0XT1uW3RdfSksbyYmKGEub3B0aW9ucy5jb21wb25lbnRzW29dPWEpLGEuc3VwZXJPcHRpb25zPW4ub3B0aW9ucyxhLmV4dGVuZE9wdGlvbnM9dCxhLnNlYWxlZE9wdGlvbnM9aCh7fSxhLm9wdGlvbnMpLGlbcl09YSxhfX1mdW5jdGlvbiBCdCh0KXtyZXR1cm4gdCYmKHQuQ3Rvci5vcHRpb25zLm5hbWV8fHQudGFnKX1mdW5jdGlvbiBVdCh0LGUpe3JldHVybiBBcnJheS5pc0FycmF5KHQpP3QuaW5kZXhPZihlKT4tMToic3RyaW5nIj09dHlwZW9mIHQ/dC5zcGxpdCgiLCIpLmluZGV4T2YoZSk+LTE6ISFmdW5jdGlvbih0KXtyZXR1cm4iW29iamVjdCBSZWdFeHBdIj09PU5uLmNhbGwodCl9KHQpJiZ0LnRlc3QoZSl9ZnVuY3Rpb24gVnQodCxlKXt2YXIgbj10LmNhY2hlLHI9dC5rZXlzLGk9dC5fdm5vZGU7Zm9yKHZhciBvIGluIG4pe3ZhciBhPW5bb107aWYoYSl7dmFyIHM9QnQoYS5jb21wb25lbnRPcHRpb25zKTtzJiYhZShzKSYmenQobixvLHIsaSl9fX1mdW5jdGlvbiB6dCh0LGUsbixyKXt2YXIgaT10W2VdOyFpfHxyJiZpLnRhZz09PXIudGFnfHxpLmNvbXBvbmVudEluc3RhbmNlLiRkZXN0cm95KCksdFtlXT1udWxsLGwobixlKX1mdW5jdGlvbiBLdCh0KXtmb3IodmFyIG49dC5kYXRhLHI9dCxpPXQ7ZShpLmNvbXBvbmVudEluc3RhbmNlKTspKGk9aS5jb21wb25lbnRJbnN0YW5jZS5fdm5vZGUpJiZpLmRhdGEmJihuPUp0KGkuZGF0YSxuKSk7Zm9yKDtlKHI9ci5wYXJlbnQpOylyJiZyLmRhdGEmJihuPUp0KG4sci5kYXRhKSk7cmV0dXJuIGZ1bmN0aW9uKHQsbil7aWYoZSh0KXx8ZShuKSlyZXR1cm4gcXQodCxXdChuKSk7cmV0dXJuIiJ9KG4uc3RhdGljQ2xhc3Msbi5jbGFzcyl9ZnVuY3Rpb24gSnQodCxuKXtyZXR1cm57c3RhdGljQ2xhc3M6cXQodC5zdGF0aWNDbGFzcyxuLnN0YXRpY0NsYXNzKSxjbGFzczplKHQuY2xhc3MpP1t0LmNsYXNzLG4uY2xhc3NdOm4uY2xhc3N9fWZ1bmN0aW9uIHF0KHQsZSl7cmV0dXJuIHQ/ZT90KyIgIitlOnQ6ZXx8IiJ9ZnVuY3Rpb24gV3QodCl7cmV0dXJuIEFycmF5LmlzQXJyYXkodCk/ZnVuY3Rpb24odCl7Zm9yKHZhciBuLHI9IiIsaT0wLG89dC5sZW5ndGg7aTxvO2krKyllKG49V3QodFtpXSkpJiYiIiE9PW4mJihyJiYocis9IiAiKSxyKz1uKTtyZXR1cm4gcn0odCk6aSh0KT9mdW5jdGlvbih0KXt2YXIgZT0iIjtmb3IodmFyIG4gaW4gdCl0W25dJiYoZSYmKGUrPSIgIiksZSs9bik7cmV0dXJuIGV9KHQpOiJzdHJpbmciPT10eXBlb2YgdD90OiIifWZ1bmN0aW9uIEd0KHQpe3JldHVybiBiaSh0KT8ic3ZnIjoibWF0aCI9PT10PyJtYXRoIjp2b2lkIDB9ZnVuY3Rpb24gWnQodCl7aWYoInN0cmluZyI9PXR5cGVvZiB0KXt2YXIgZT1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKHQpO3JldHVybiBlfHxkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKX1yZXR1cm4gdH1mdW5jdGlvbiBYdCh0LGUpe3ZhciBuPXQuZGF0YS5yZWY7aWYobil7dmFyIHI9dC5jb250ZXh0LGk9dC5jb21wb25lbnRJbnN0YW5jZXx8dC5lbG0sbz1yLiRyZWZzO2U/QXJyYXkuaXNBcnJheShvW25dKT9sKG9bbl0saSk6b1tuXT09PWkmJihvW25dPXZvaWQgMCk6dC5kYXRhLnJlZkluRm9yP0FycmF5LmlzQXJyYXkob1tuXSk/b1tuXS5pbmRleE9mKGkpPDAmJm9bbl0ucHVzaChpKTpvW25dPVtpXTpvW25dPWl9fWZ1bmN0aW9uIFl0KHIsaSl7cmV0dXJuIHIua2V5PT09aS5rZXkmJihyLnRhZz09PWkudGFnJiZyLmlzQ29tbWVudD09PWkuaXNDb21tZW50JiZlKHIuZGF0YSk9PT1lKGkuZGF0YSkmJmZ1bmN0aW9uKHQsbil7aWYoImlucHV0IiE9PXQudGFnKXJldHVybiEwO3ZhciByLGk9ZShyPXQuZGF0YSkmJmUocj1yLmF0dHJzKSYmci50eXBlLG89ZShyPW4uZGF0YSkmJmUocj1yLmF0dHJzKSYmci50eXBlO3JldHVybiBpPT09b3x8d2koaSkmJndpKG8pfShyLGkpfHxuKHIuaXNBc3luY1BsYWNlaG9sZGVyKSYmci5hc3luY0ZhY3Rvcnk9PT1pLmFzeW5jRmFjdG9yeSYmdChpLmFzeW5jRmFjdG9yeS5lcnJvcikpfWZ1bmN0aW9uIFF0KHQsbixyKXt2YXIgaSxvLGE9e307Zm9yKGk9bjtpPD1yOysraSllKG89dFtpXS5rZXkpJiYoYVtvXT1pKTtyZXR1cm4gYX1mdW5jdGlvbiB0ZSh0LGUpeyh0LmRhdGEuZGlyZWN0aXZlc3x8ZS5kYXRhLmRpcmVjdGl2ZXMpJiZmdW5jdGlvbih0LGUpe3ZhciBuLHIsaSxvPXQ9PT1BaSxhPWU9PT1BaSxzPWVlKHQuZGF0YS5kaXJlY3RpdmVzLHQuY29udGV4dCksYz1lZShlLmRhdGEuZGlyZWN0aXZlcyxlLmNvbnRleHQpLHU9W10sbD1bXTtmb3IobiBpbiBjKXI9c1tuXSxpPWNbbl0scj8oaS5vbGRWYWx1ZT1yLnZhbHVlLG5lKGksInVwZGF0ZSIsZSx0KSxpLmRlZiYmaS5kZWYuY29tcG9uZW50VXBkYXRlZCYmbC5wdXNoKGkpKToobmUoaSwiYmluZCIsZSx0KSxpLmRlZiYmaS5kZWYuaW5zZXJ0ZWQmJnUucHVzaChpKSk7aWYodS5sZW5ndGgpe3ZhciBmPWZ1bmN0aW9uKCl7Zm9yKHZhciBuPTA7bjx1Lmxlbmd0aDtuKyspbmUodVtuXSwiaW5zZXJ0ZWQiLGUsdCl9O28/WShlLCJpbnNlcnQiLGYpOmYoKX1sLmxlbmd0aCYmWShlLCJwb3N0cGF0Y2giLGZ1bmN0aW9uKCl7Zm9yKHZhciBuPTA7bjxsLmxlbmd0aDtuKyspbmUobFtuXSwiY29tcG9uZW50VXBkYXRlZCIsZSx0KX0pO2lmKCFvKWZvcihuIGluIHMpY1tuXXx8bmUoc1tuXSwidW5iaW5kIix0LHQsYSl9KHQsZSl9ZnVuY3Rpb24gZWUodCxlKXt2YXIgbj1PYmplY3QuY3JlYXRlKG51bGwpO2lmKCF0KXJldHVybiBuO3ZhciByLGk7Zm9yKHI9MDtyPHQubGVuZ3RoO3IrKykoaT10W3JdKS5tb2RpZmllcnN8fChpLm1vZGlmaWVycz1UaSksbltmdW5jdGlvbih0KXtyZXR1cm4gdC5yYXdOYW1lfHx0Lm5hbWUrIi4iK09iamVjdC5rZXlzKHQubW9kaWZpZXJzfHx7fSkuam9pbigiLiIpfShpKV09aSxpLmRlZj1SKGUuJG9wdGlvbnMsImRpcmVjdGl2ZXMiLGkubmFtZSk7cmV0dXJuIG59ZnVuY3Rpb24gbmUodCxlLG4scixpKXt2YXIgbz10LmRlZiYmdC5kZWZbZV07aWYobyl0cnl7byhuLmVsbSx0LG4scixpKX1jYXRjaChyKXtWKHIsbi5jb250ZXh0LCJkaXJlY3RpdmUgIit0Lm5hbWUrIiAiK2UrIiBob29rIil9fWZ1bmN0aW9uIHJlKG4scil7dmFyIGk9ci5jb21wb25lbnRPcHRpb25zO2lmKCEoZShpKSYmITE9PT1pLkN0b3Iub3B0aW9ucy5pbmhlcml0QXR0cnN8fHQobi5kYXRhLmF0dHJzKSYmdChyLmRhdGEuYXR0cnMpKSl7dmFyIG8sYSxzPXIuZWxtLGM9bi5kYXRhLmF0dHJzfHx7fSx1PXIuZGF0YS5hdHRyc3x8e307ZSh1Ll9fb2JfXykmJih1PXIuZGF0YS5hdHRycz1oKHt9LHUpKTtmb3IobyBpbiB1KWE9dVtvXSxjW29dIT09YSYmaWUocyxvLGEpOyhRbnx8ZXIpJiZ1LnZhbHVlIT09Yy52YWx1ZSYmaWUocywidmFsdWUiLHUudmFsdWUpO2ZvcihvIGluIGMpdCh1W29dKSYmKGhpKG8pP3MucmVtb3ZlQXR0cmlidXRlTlModmksbWkobykpOnBpKG8pfHxzLnJlbW92ZUF0dHJpYnV0ZShvKSl9fWZ1bmN0aW9uIGllKHQsZSxuKXtpZihkaShlKSl5aShuKT90LnJlbW92ZUF0dHJpYnV0ZShlKToobj0iYWxsb3dmdWxsc2NyZWVuIj09PWUmJiJFTUJFRCI9PT10LnRhZ05hbWU/InRydWUiOmUsdC5zZXRBdHRyaWJ1dGUoZSxuKSk7ZWxzZSBpZihwaShlKSl0LnNldEF0dHJpYnV0ZShlLHlpKG4pfHwiZmFsc2UiPT09bj8iZmFsc2UiOiJ0cnVlIik7ZWxzZSBpZihoaShlKSl5aShuKT90LnJlbW92ZUF0dHJpYnV0ZU5TKHZpLG1pKGUpKTp0LnNldEF0dHJpYnV0ZU5TKHZpLGUsbik7ZWxzZSBpZih5aShuKSl0LnJlbW92ZUF0dHJpYnV0ZShlKTtlbHNle2lmKFFuJiYhdHImJiJURVhUQVJFQSI9PT10LnRhZ05hbWUmJiJwbGFjZWhvbGRlciI9PT1lJiYhdC5fX2llcGgpe3ZhciByPWZ1bmN0aW9uKGUpe2Uuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksdC5yZW1vdmVFdmVudExpc3RlbmVyKCJpbnB1dCIscil9O3QuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLHIpLHQuX19pZXBoPSEwfXQuc2V0QXR0cmlidXRlKGUsbil9fWZ1bmN0aW9uIG9lKG4scil7dmFyIGk9ci5lbG0sbz1yLmRhdGEsYT1uLmRhdGE7aWYoISh0KG8uc3RhdGljQ2xhc3MpJiZ0KG8uY2xhc3MpJiYodChhKXx8dChhLnN0YXRpY0NsYXNzKSYmdChhLmNsYXNzKSkpKXt2YXIgcz1LdChyKSxjPWkuX3RyYW5zaXRpb25DbGFzc2VzO2UoYykmJihzPXF0KHMsV3QoYykpKSxzIT09aS5fcHJldkNsYXNzJiYoaS5zZXRBdHRyaWJ1dGUoImNsYXNzIixzKSxpLl9wcmV2Q2xhc3M9cyl9fWZ1bmN0aW9uIGFlKHQpe2Z1bmN0aW9uIGUoKXsoYXx8KGE9W10pKS5wdXNoKHQuc2xpY2UodixpKS50cmltKCkpLHY9aSsxfXZhciBuLHIsaSxvLGEscz0hMSxjPSExLHU9ITEsbD0hMSxmPTAscD0wLGQ9MCx2PTA7Zm9yKGk9MDtpPHQubGVuZ3RoO2krKylpZihyPW4sbj10LmNoYXJDb2RlQXQoaSkscykzOT09PW4mJjkyIT09ciYmKHM9ITEpO2Vsc2UgaWYoYykzND09PW4mJjkyIT09ciYmKGM9ITEpO2Vsc2UgaWYodSk5Nj09PW4mJjkyIT09ciYmKHU9ITEpO2Vsc2UgaWYobCk0Nz09PW4mJjkyIT09ciYmKGw9ITEpO2Vsc2UgaWYoMTI0IT09bnx8MTI0PT09dC5jaGFyQ29kZUF0KGkrMSl8fDEyND09PXQuY2hhckNvZGVBdChpLTEpfHxmfHxwfHxkKXtzd2l0Y2gobil7Y2FzZSAzNDpjPSEwO2JyZWFrO2Nhc2UgMzk6cz0hMDticmVhaztjYXNlIDk2OnU9ITA7YnJlYWs7Y2FzZSA0MDpkKys7YnJlYWs7Y2FzZSA0MTpkLS07YnJlYWs7Y2FzZSA5MTpwKys7YnJlYWs7Y2FzZSA5MzpwLS07YnJlYWs7Y2FzZSAxMjM6ZisrO2JyZWFrO2Nhc2UgMTI1OmYtLX1pZig0Nz09PW4pe2Zvcih2YXIgaD1pLTEsbT12b2lkIDA7aD49MCYmIiAiPT09KG09dC5jaGFyQXQoaCkpO2gtLSk7bSYmSWkudGVzdChtKXx8KGw9ITApfX1lbHNlIHZvaWQgMD09PW8/KHY9aSsxLG89dC5zbGljZSgwLGkpLnRyaW0oKSk6ZSgpO2lmKHZvaWQgMD09PW8/bz10LnNsaWNlKDAsaSkudHJpbSgpOjAhPT12JiZlKCksYSlmb3IoaT0wO2k8YS5sZW5ndGg7aSsrKW89ZnVuY3Rpb24odCxlKXt2YXIgbj1lLmluZGV4T2YoIigiKTt7aWYobjwwKXJldHVybidfZigiJytlKyciKSgnK3QrIikiO3ZhciByPWUuc2xpY2UoMCxuKSxpPWUuc2xpY2UobisxKTtyZXR1cm4nX2YoIicrcisnIikoJyt0KyIsIitpfX0obyxhW2ldKTtyZXR1cm4gb31mdW5jdGlvbiBzZSh0KXtjb25zb2xlLmVycm9yKCJbVnVlIGNvbXBpbGVyXTogIit0KX1mdW5jdGlvbiBjZSh0LGUpe3JldHVybiB0P3QubWFwKGZ1bmN0aW9uKHQpe3JldHVybiB0W2VdfSkuZmlsdGVyKGZ1bmN0aW9uKHQpe3JldHVybiB0fSk6W119ZnVuY3Rpb24gdWUodCxlLG4peyh0LnByb3BzfHwodC5wcm9wcz1bXSkpLnB1c2goe25hbWU6ZSx2YWx1ZTpufSksdC5wbGFpbj0hMX1mdW5jdGlvbiBsZSh0LGUsbil7KHQuYXR0cnN8fCh0LmF0dHJzPVtdKSkucHVzaCh7bmFtZTplLHZhbHVlOm59KSx0LnBsYWluPSExfWZ1bmN0aW9uIGZlKHQsZSxuKXt0LmF0dHJzTWFwW2VdPW4sdC5hdHRyc0xpc3QucHVzaCh7bmFtZTplLHZhbHVlOm59KX1mdW5jdGlvbiBwZSh0LGUsbixyLGksbyl7KHQuZGlyZWN0aXZlc3x8KHQuZGlyZWN0aXZlcz1bXSkpLnB1c2goe25hbWU6ZSxyYXdOYW1lOm4sdmFsdWU6cixhcmc6aSxtb2RpZmllcnM6b30pLHQucGxhaW49ITF9ZnVuY3Rpb24gZGUodCxlLG4scixpLG8peyhyPXJ8fGpuKS5jYXB0dXJlJiYoZGVsZXRlIHIuY2FwdHVyZSxlPSIhIitlKSxyLm9uY2UmJihkZWxldGUgci5vbmNlLGU9In4iK2UpLHIucGFzc2l2ZSYmKGRlbGV0ZSByLnBhc3NpdmUsZT0iJiIrZSksImNsaWNrIj09PWUmJihyLnJpZ2h0PyhlPSJjb250ZXh0bWVudSIsZGVsZXRlIHIucmlnaHQpOnIubWlkZGxlJiYoZT0ibW91c2V1cCIpKTt2YXIgYTtyLm5hdGl2ZT8oZGVsZXRlIHIubmF0aXZlLGE9dC5uYXRpdmVFdmVudHN8fCh0Lm5hdGl2ZUV2ZW50cz17fSkpOmE9dC5ldmVudHN8fCh0LmV2ZW50cz17fSk7dmFyIHM9e3ZhbHVlOm59O3IhPT1qbiYmKHMubW9kaWZpZXJzPXIpO3ZhciBjPWFbZV07QXJyYXkuaXNBcnJheShjKT9pP2MudW5zaGlmdChzKTpjLnB1c2gocyk6YVtlXT1jP2k/W3MsY106W2Msc106cyx0LnBsYWluPSExfWZ1bmN0aW9uIHZlKHQsZSxuKXt2YXIgcj1oZSh0LCI6IitlKXx8aGUodCwidi1iaW5kOiIrZSk7aWYobnVsbCE9cilyZXR1cm4gYWUocik7aWYoITEhPT1uKXt2YXIgaT1oZSh0LGUpO2lmKG51bGwhPWkpcmV0dXJuIEpTT04uc3RyaW5naWZ5KGkpfX1mdW5jdGlvbiBoZSh0LGUsbil7dmFyIHI7aWYobnVsbCE9KHI9dC5hdHRyc01hcFtlXSkpZm9yKHZhciBpPXQuYXR0cnNMaXN0LG89MCxhPWkubGVuZ3RoO288YTtvKyspaWYoaVtvXS5uYW1lPT09ZSl7aS5zcGxpY2UobywxKTticmVha31yZXR1cm4gbiYmZGVsZXRlIHQuYXR0cnNNYXBbZV0scn1mdW5jdGlvbiBtZSh0LGUsbil7dmFyIHI9bnx8e30saT0iJCR2IjtyLnRyaW0mJihpPSIodHlwZW9mICQkdiA9PT0gJ3N0cmluZyc/ICQkdi50cmltKCk6ICQkdikiKSxyLm51bWJlciYmKGk9Il9uKCIraSsiKSIpO3ZhciBvPXllKGUsaSk7dC5tb2RlbD17dmFsdWU6IigiK2UrIikiLGV4cHJlc3Npb246JyInK2UrJyInLGNhbGxiYWNrOiJmdW5jdGlvbiAoJCR2KSB7IitvKyJ9In19ZnVuY3Rpb24geWUodCxlKXt2YXIgbj1mdW5jdGlvbih0KXtpZihlaT10Lmxlbmd0aCx0LmluZGV4T2YoIlsiKTwwfHx0Lmxhc3RJbmRleE9mKCJdIik8ZWktMSlyZXR1cm4oaWk9dC5sYXN0SW5kZXhPZigiLiIpKT4tMT97ZXhwOnQuc2xpY2UoMCxpaSksa2V5OiciJyt0LnNsaWNlKGlpKzEpKyciJ306e2V4cDp0LGtleTpudWxsfTtuaT10LGlpPW9pPWFpPTA7Zm9yKDshX2UoKTspYmUocmk9Z2UoKSk/JGUocmkpOjkxPT09cmkmJmZ1bmN0aW9uKHQpe3ZhciBlPTE7b2k9aWk7Zm9yKDshX2UoKTspaWYodD1nZSgpLGJlKHQpKSRlKHQpO2Vsc2UgaWYoOTE9PT10JiZlKyssOTM9PT10JiZlLS0sMD09PWUpe2FpPWlpO2JyZWFrfX0ocmkpO3JldHVybntleHA6dC5zbGljZSgwLG9pKSxrZXk6dC5zbGljZShvaSsxLGFpKX19KHQpO3JldHVybiBudWxsPT09bi5rZXk/dCsiPSIrZToiJHNldCgiK24uZXhwKyIsICIrbi5rZXkrIiwgIitlKyIpIn1mdW5jdGlvbiBnZSgpe3JldHVybiBuaS5jaGFyQ29kZUF0KCsraWkpfWZ1bmN0aW9uIF9lKCl7cmV0dXJuIGlpPj1laX1mdW5jdGlvbiBiZSh0KXtyZXR1cm4gMzQ9PT10fHwzOT09PXR9ZnVuY3Rpb24gJGUodCl7Zm9yKHZhciBlPXQ7IV9lKCkmJih0PWdlKCkpIT09ZTspO31mdW5jdGlvbiBDZSh0LGUsbixyLGkpe2U9ZnVuY3Rpb24odCl7cmV0dXJuIHQuX3dpdGhUYXNrfHwodC5fd2l0aFRhc2s9ZnVuY3Rpb24oKXtFcj0hMDt2YXIgZT10LmFwcGx5KG51bGwsYXJndW1lbnRzKTtyZXR1cm4gRXI9ITEsZX0pfShlKSxuJiYoZT1mdW5jdGlvbih0LGUsbil7dmFyIHI9c2k7cmV0dXJuIGZ1bmN0aW9uIGkoKXtudWxsIT09dC5hcHBseShudWxsLGFyZ3VtZW50cykmJndlKGUsaSxuLHIpfX0oZSx0LHIpKSxzaS5hZGRFdmVudExpc3RlbmVyKHQsZSxvcj97Y2FwdHVyZTpyLHBhc3NpdmU6aX06cil9ZnVuY3Rpb24gd2UodCxlLG4scil7KHJ8fHNpKS5yZW1vdmVFdmVudExpc3RlbmVyKHQsZS5fd2l0aFRhc2t8fGUsbil9ZnVuY3Rpb24geGUobixyKXtpZighdChuLmRhdGEub24pfHwhdChyLmRhdGEub24pKXt2YXIgaT1yLmRhdGEub258fHt9LG89bi5kYXRhLm9ufHx7fTtzaT1yLmVsbSxmdW5jdGlvbih0KXtpZihlKHRbTGldKSl7dmFyIG49UW4/ImNoYW5nZSI6ImlucHV0Ijt0W25dPVtdLmNvbmNhdCh0W0xpXSx0W25dfHxbXSksZGVsZXRlIHRbTGldfWUodFtNaV0pJiYodC5jaGFuZ2U9W10uY29uY2F0KHRbTWldLHQuY2hhbmdlfHxbXSksZGVsZXRlIHRbTWldKX0oaSksWChpLG8sQ2Usd2Usci5jb250ZXh0KSxzaT12b2lkIDB9fWZ1bmN0aW9uIGtlKG4scil7aWYoIXQobi5kYXRhLmRvbVByb3BzKXx8IXQoci5kYXRhLmRvbVByb3BzKSl7dmFyIGksbyxhPXIuZWxtLHM9bi5kYXRhLmRvbVByb3BzfHx7fSx1PXIuZGF0YS5kb21Qcm9wc3x8e307ZSh1Ll9fb2JfXykmJih1PXIuZGF0YS5kb21Qcm9wcz1oKHt9LHUpKTtmb3IoaSBpbiBzKXQodVtpXSkmJihhW2ldPSIiKTtmb3IoaSBpbiB1KXtpZihvPXVbaV0sInRleHRDb250ZW50Ij09PWl8fCJpbm5lckhUTUwiPT09aSl7aWYoci5jaGlsZHJlbiYmKHIuY2hpbGRyZW4ubGVuZ3RoPTApLG89PT1zW2ldKWNvbnRpbnVlOzE9PT1hLmNoaWxkTm9kZXMubGVuZ3RoJiZhLnJlbW92ZUNoaWxkKGEuY2hpbGROb2Rlc1swXSl9aWYoInZhbHVlIj09PWkpe2EuX3ZhbHVlPW87dmFyIGw9dChvKT8iIjpTdHJpbmcobyk7KGZ1bmN0aW9uKHQsbil7cmV0dXJuIXQuY29tcG9zaW5nJiYoIk9QVElPTiI9PT10LnRhZ05hbWV8fGZ1bmN0aW9uKHQsZSl7dmFyIG49ITA7dHJ5e249ZG9jdW1lbnQuYWN0aXZlRWxlbWVudCE9PXR9Y2F0Y2godCl7fXJldHVybiBuJiZ0LnZhbHVlIT09ZX0odCxuKXx8ZnVuY3Rpb24odCxuKXt2YXIgcj10LnZhbHVlLGk9dC5fdk1vZGlmaWVycztpZihlKGkpKXtpZihpLmxhenkpcmV0dXJuITE7aWYoaS5udW1iZXIpcmV0dXJuIGMocikhPT1jKG4pO2lmKGkudHJpbSlyZXR1cm4gci50cmltKCkhPT1uLnRyaW0oKX1yZXR1cm4gciE9PW59KHQsbikpfSkoYSxsKSYmKGEudmFsdWU9bCl9ZWxzZSBhW2ldPW99fX1mdW5jdGlvbiBBZSh0KXt2YXIgZT1PZSh0LnN0eWxlKTtyZXR1cm4gdC5zdGF0aWNTdHlsZT9oKHQuc3RhdGljU3R5bGUsZSk6ZX1mdW5jdGlvbiBPZSh0KXtyZXR1cm4gQXJyYXkuaXNBcnJheSh0KT9tKHQpOiJzdHJpbmciPT10eXBlb2YgdD9GaSh0KTp0fWZ1bmN0aW9uIFNlKG4scil7dmFyIGk9ci5kYXRhLG89bi5kYXRhO2lmKCEodChpLnN0YXRpY1N0eWxlKSYmdChpLnN0eWxlKSYmdChvLnN0YXRpY1N0eWxlKSYmdChvLnN0eWxlKSkpe3ZhciBhLHMsYz1yLmVsbSx1PW8uc3RhdGljU3R5bGUsbD1vLm5vcm1hbGl6ZWRTdHlsZXx8by5zdHlsZXx8e30sZj11fHxsLHA9T2Uoci5kYXRhLnN0eWxlKXx8e307ci5kYXRhLm5vcm1hbGl6ZWRTdHlsZT1lKHAuX19vYl9fKT9oKHt9LHApOnA7dmFyIGQ9ZnVuY3Rpb24odCxlKXt2YXIgbixyPXt9O2lmKGUpZm9yKHZhciBpPXQ7aS5jb21wb25lbnRJbnN0YW5jZTspKGk9aS5jb21wb25lbnRJbnN0YW5jZS5fdm5vZGUpJiZpLmRhdGEmJihuPUFlKGkuZGF0YSkpJiZoKHIsbik7KG49QWUodC5kYXRhKSkmJmgocixuKTtmb3IodmFyIG89dDtvPW8ucGFyZW50OylvLmRhdGEmJihuPUFlKG8uZGF0YSkpJiZoKHIsbik7cmV0dXJuIHJ9KHIsITApO2ZvcihzIGluIGYpdChkW3NdKSYmQmkoYyxzLCIiKTtmb3IocyBpbiBkKShhPWRbc10pIT09ZltzXSYmQmkoYyxzLG51bGw9PWE/IiI6YSl9fWZ1bmN0aW9uIFRlKHQsZSl7aWYoZSYmKGU9ZS50cmltKCkpKWlmKHQuY2xhc3NMaXN0KWUuaW5kZXhPZigiICIpPi0xP2Uuc3BsaXQoL1xzKy8pLmZvckVhY2goZnVuY3Rpb24oZSl7cmV0dXJuIHQuY2xhc3NMaXN0LmFkZChlKX0pOnQuY2xhc3NMaXN0LmFkZChlKTtlbHNle3ZhciBuPSIgIisodC5nZXRBdHRyaWJ1dGUoImNsYXNzIil8fCIiKSsiICI7bi5pbmRleE9mKCIgIitlKyIgIik8MCYmdC5zZXRBdHRyaWJ1dGUoImNsYXNzIiwobitlKS50cmltKCkpfX1mdW5jdGlvbiBFZSh0LGUpe2lmKGUmJihlPWUudHJpbSgpKSlpZih0LmNsYXNzTGlzdCllLmluZGV4T2YoIiAiKT4tMT9lLnNwbGl0KC9ccysvKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3JldHVybiB0LmNsYXNzTGlzdC5yZW1vdmUoZSl9KTp0LmNsYXNzTGlzdC5yZW1vdmUoZSksdC5jbGFzc0xpc3QubGVuZ3RofHx0LnJlbW92ZUF0dHJpYnV0ZSgiY2xhc3MiKTtlbHNle2Zvcih2YXIgbj0iICIrKHQuZ2V0QXR0cmlidXRlKCJjbGFzcyIpfHwiIikrIiAiLHI9IiAiK2UrIiAiO24uaW5kZXhPZihyKT49MDspbj1uLnJlcGxhY2UociwiICIpOyhuPW4udHJpbSgpKT90LnNldEF0dHJpYnV0ZSgiY2xhc3MiLG4pOnQucmVtb3ZlQXR0cmlidXRlKCJjbGFzcyIpfX1mdW5jdGlvbiBqZSh0KXtpZih0KXtpZigib2JqZWN0Ij09dHlwZW9mIHQpe3ZhciBlPXt9O3JldHVybiExIT09dC5jc3MmJmgoZSxLaSh0Lm5hbWV8fCJ2IikpLGgoZSx0KSxlfXJldHVybiJzdHJpbmciPT10eXBlb2YgdD9LaSh0KTp2b2lkIDB9fWZ1bmN0aW9uIE5lKHQpe1FpKGZ1bmN0aW9uKCl7UWkodCl9KX1mdW5jdGlvbiBJZSh0LGUpe3ZhciBuPXQuX3RyYW5zaXRpb25DbGFzc2VzfHwodC5fdHJhbnNpdGlvbkNsYXNzZXM9W10pO24uaW5kZXhPZihlKTwwJiYobi5wdXNoKGUpLFRlKHQsZSkpfWZ1bmN0aW9uIExlKHQsZSl7dC5fdHJhbnNpdGlvbkNsYXNzZXMmJmwodC5fdHJhbnNpdGlvbkNsYXNzZXMsZSksRWUodCxlKX1mdW5jdGlvbiBNZSh0LGUsbil7dmFyIHI9RGUodCxlKSxpPXIudHlwZSxvPXIudGltZW91dCxhPXIucHJvcENvdW50O2lmKCFpKXJldHVybiBuKCk7dmFyIHM9aT09PXFpP1ppOllpLGM9MCx1PWZ1bmN0aW9uKCl7dC5yZW1vdmVFdmVudExpc3RlbmVyKHMsbCksbigpfSxsPWZ1bmN0aW9uKGUpe2UudGFyZ2V0PT09dCYmKytjPj1hJiZ1KCl9O3NldFRpbWVvdXQoZnVuY3Rpb24oKXtjPGEmJnUoKX0sbysxKSx0LmFkZEV2ZW50TGlzdGVuZXIocyxsKX1mdW5jdGlvbiBEZSh0LGUpe3ZhciBuLHI9d2luZG93LmdldENvbXB1dGVkU3R5bGUodCksaT1yW0dpKyJEZWxheSJdLnNwbGl0KCIsICIpLG89cltHaSsiRHVyYXRpb24iXS5zcGxpdCgiLCAiKSxhPVBlKGksbykscz1yW1hpKyJEZWxheSJdLnNwbGl0KCIsICIpLGM9cltYaSsiRHVyYXRpb24iXS5zcGxpdCgiLCAiKSx1PVBlKHMsYyksbD0wLGY9MDtlPT09cWk/YT4wJiYobj1xaSxsPWEsZj1vLmxlbmd0aCk6ZT09PVdpP3U+MCYmKG49V2ksbD11LGY9Yy5sZW5ndGgpOmY9KG49KGw9TWF0aC5tYXgoYSx1KSk+MD9hPnU/cWk6V2k6bnVsbCk/bj09PXFpP28ubGVuZ3RoOmMubGVuZ3RoOjA7cmV0dXJue3R5cGU6bix0aW1lb3V0OmwscHJvcENvdW50OmYsaGFzVHJhbnNmb3JtOm49PT1xaSYmdG8udGVzdChyW0dpKyJQcm9wZXJ0eSJdKX19ZnVuY3Rpb24gUGUodCxlKXtmb3IoO3QubGVuZ3RoPGUubGVuZ3RoOyl0PXQuY29uY2F0KHQpO3JldHVybiBNYXRoLm1heC5hcHBseShudWxsLGUubWFwKGZ1bmN0aW9uKGUsbil7cmV0dXJuIEZlKGUpK0ZlKHRbbl0pfSkpfWZ1bmN0aW9uIEZlKHQpe3JldHVybiAxZTMqTnVtYmVyKHQuc2xpY2UoMCwtMSkpfWZ1bmN0aW9uIFJlKG4scil7dmFyIG89bi5lbG07ZShvLl9sZWF2ZUNiKSYmKG8uX2xlYXZlQ2IuY2FuY2VsbGVkPSEwLG8uX2xlYXZlQ2IoKSk7dmFyIGE9amUobi5kYXRhLnRyYW5zaXRpb24pO2lmKCF0KGEpJiYhZShvLl9lbnRlckNiKSYmMT09PW8ubm9kZVR5cGUpe2Zvcih2YXIgcz1hLmNzcyx1PWEudHlwZSxsPWEuZW50ZXJDbGFzcyxmPWEuZW50ZXJUb0NsYXNzLHA9YS5lbnRlckFjdGl2ZUNsYXNzLGQ9YS5hcHBlYXJDbGFzcyx2PWEuYXBwZWFyVG9DbGFzcyxoPWEuYXBwZWFyQWN0aXZlQ2xhc3MsbT1hLmJlZm9yZUVudGVyLHk9YS5lbnRlcixnPWEuYWZ0ZXJFbnRlcixfPWEuZW50ZXJDYW5jZWxsZWQsJD1hLmJlZm9yZUFwcGVhcixDPWEuYXBwZWFyLHc9YS5hZnRlckFwcGVhcix4PWEuYXBwZWFyQ2FuY2VsbGVkLGs9YS5kdXJhdGlvbixBPVByLE89UHIuJHZub2RlO08mJk8ucGFyZW50OylBPShPPU8ucGFyZW50KS5jb250ZXh0O3ZhciBTPSFBLl9pc01vdW50ZWR8fCFuLmlzUm9vdEluc2VydDtpZighU3x8Q3x8IiI9PT1DKXt2YXIgVD1TJiZkP2Q6bCxFPVMmJmg/aDpwLGo9UyYmdj92OmYsTj1TPyR8fG06bSxJPVMmJiJmdW5jdGlvbiI9PXR5cGVvZiBDP0M6eSxMPVM/d3x8ZzpnLE09Uz94fHxfOl8sRD1jKGkoayk/ay5lbnRlcjprKSxQPSExIT09cyYmIXRyLEY9VWUoSSksUj1vLl9lbnRlckNiPWIoZnVuY3Rpb24oKXtQJiYoTGUobyxqKSxMZShvLEUpKSxSLmNhbmNlbGxlZD8oUCYmTGUobyxUKSxNJiZNKG8pKTpMJiZMKG8pLG8uX2VudGVyQ2I9bnVsbH0pO24uZGF0YS5zaG93fHxZKG4sImluc2VydCIsZnVuY3Rpb24oKXt2YXIgdD1vLnBhcmVudE5vZGUsZT10JiZ0Ll9wZW5kaW5nJiZ0Ll9wZW5kaW5nW24ua2V5XTtlJiZlLnRhZz09PW4udGFnJiZlLmVsbS5fbGVhdmVDYiYmZS5lbG0uX2xlYXZlQ2IoKSxJJiZJKG8sUil9KSxOJiZOKG8pLFAmJihJZShvLFQpLEllKG8sRSksTmUoZnVuY3Rpb24oKXtJZShvLGopLExlKG8sVCksUi5jYW5jZWxsZWR8fEZ8fChCZShEKT9zZXRUaW1lb3V0KFIsRCk6TWUobyx1LFIpKX0pKSxuLmRhdGEuc2hvdyYmKHImJnIoKSxJJiZJKG8sUikpLFB8fEZ8fFIoKX19fWZ1bmN0aW9uIEhlKG4scil7ZnVuY3Rpb24gbygpe3guY2FuY2VsbGVkfHwobi5kYXRhLnNob3d8fCgoYS5wYXJlbnROb2RlLl9wZW5kaW5nfHwoYS5wYXJlbnROb2RlLl9wZW5kaW5nPXt9KSlbbi5rZXldPW4pLHYmJnYoYSksJCYmKEllKGEsZiksSWUoYSxkKSxOZShmdW5jdGlvbigpe0llKGEscCksTGUoYSxmKSx4LmNhbmNlbGxlZHx8Q3x8KEJlKHcpP3NldFRpbWVvdXQoeCx3KTpNZShhLGwseCkpfSkpLGgmJmgoYSx4KSwkfHxDfHx4KCkpfXZhciBhPW4uZWxtO2UoYS5fZW50ZXJDYikmJihhLl9lbnRlckNiLmNhbmNlbGxlZD0hMCxhLl9lbnRlckNiKCkpO3ZhciBzPWplKG4uZGF0YS50cmFuc2l0aW9uKTtpZih0KHMpfHwxIT09YS5ub2RlVHlwZSlyZXR1cm4gcigpO2lmKCFlKGEuX2xlYXZlQ2IpKXt2YXIgdT1zLmNzcyxsPXMudHlwZSxmPXMubGVhdmVDbGFzcyxwPXMubGVhdmVUb0NsYXNzLGQ9cy5sZWF2ZUFjdGl2ZUNsYXNzLHY9cy5iZWZvcmVMZWF2ZSxoPXMubGVhdmUsbT1zLmFmdGVyTGVhdmUseT1zLmxlYXZlQ2FuY2VsbGVkLGc9cy5kZWxheUxlYXZlLF89cy5kdXJhdGlvbiwkPSExIT09dSYmIXRyLEM9VWUoaCksdz1jKGkoXyk/Xy5sZWF2ZTpfKSx4PWEuX2xlYXZlQ2I9YihmdW5jdGlvbigpe2EucGFyZW50Tm9kZSYmYS5wYXJlbnROb2RlLl9wZW5kaW5nJiYoYS5wYXJlbnROb2RlLl9wZW5kaW5nW24ua2V5XT1udWxsKSwkJiYoTGUoYSxwKSxMZShhLGQpKSx4LmNhbmNlbGxlZD8oJCYmTGUoYSxmKSx5JiZ5KGEpKToocigpLG0mJm0oYSkpLGEuX2xlYXZlQ2I9bnVsbH0pO2c/ZyhvKTpvKCl9fWZ1bmN0aW9uIEJlKHQpe3JldHVybiJudW1iZXIiPT10eXBlb2YgdCYmIWlzTmFOKHQpfWZ1bmN0aW9uIFVlKG4pe2lmKHQobikpcmV0dXJuITE7dmFyIHI9bi5mbnM7cmV0dXJuIGUocik/VWUoQXJyYXkuaXNBcnJheShyKT9yWzBdOnIpOihuLl9sZW5ndGh8fG4ubGVuZ3RoKT4xfWZ1bmN0aW9uIFZlKHQsZSl7ITAhPT1lLmRhdGEuc2hvdyYmUmUoZSl9ZnVuY3Rpb24gemUodCxlLG4pe0tlKHQsZSxuKSwoUW58fGVyKSYmc2V0VGltZW91dChmdW5jdGlvbigpe0tlKHQsZSxuKX0sMCl9ZnVuY3Rpb24gS2UodCxlLG4pe3ZhciByPWUudmFsdWUsaT10Lm11bHRpcGxlO2lmKCFpfHxBcnJheS5pc0FycmF5KHIpKXtmb3IodmFyIG8sYSxzPTAsYz10Lm9wdGlvbnMubGVuZ3RoO3M8YztzKyspaWYoYT10Lm9wdGlvbnNbc10saSlvPV8ocixxZShhKSk+LTEsYS5zZWxlY3RlZCE9PW8mJihhLnNlbGVjdGVkPW8pO2Vsc2UgaWYoZyhxZShhKSxyKSlyZXR1cm4gdm9pZCh0LnNlbGVjdGVkSW5kZXghPT1zJiYodC5zZWxlY3RlZEluZGV4PXMpKTtpfHwodC5zZWxlY3RlZEluZGV4PS0xKX19ZnVuY3Rpb24gSmUodCxlKXtyZXR1cm4gZS5ldmVyeShmdW5jdGlvbihlKXtyZXR1cm4hZyhlLHQpfSl9ZnVuY3Rpb24gcWUodCl7cmV0dXJuIl92YWx1ZSJpbiB0P3QuX3ZhbHVlOnQudmFsdWV9ZnVuY3Rpb24gV2UodCl7dC50YXJnZXQuY29tcG9zaW5nPSEwfWZ1bmN0aW9uIEdlKHQpe3QudGFyZ2V0LmNvbXBvc2luZyYmKHQudGFyZ2V0LmNvbXBvc2luZz0hMSxaZSh0LnRhcmdldCwiaW5wdXQiKSl9ZnVuY3Rpb24gWmUodCxlKXt2YXIgbj1kb2N1bWVudC5jcmVhdGVFdmVudCgiSFRNTEV2ZW50cyIpO24uaW5pdEV2ZW50KGUsITAsITApLHQuZGlzcGF0Y2hFdmVudChuKX1mdW5jdGlvbiBYZSh0KXtyZXR1cm4hdC5jb21wb25lbnRJbnN0YW5jZXx8dC5kYXRhJiZ0LmRhdGEudHJhbnNpdGlvbj90OlhlKHQuY29tcG9uZW50SW5zdGFuY2UuX3Zub2RlKX1mdW5jdGlvbiBZZSh0KXt2YXIgZT10JiZ0LmNvbXBvbmVudE9wdGlvbnM7cmV0dXJuIGUmJmUuQ3Rvci5vcHRpb25zLmFic3RyYWN0P1llKGl0KGUuY2hpbGRyZW4pKTp0fWZ1bmN0aW9uIFFlKHQpe3ZhciBlPXt9LG49dC4kb3B0aW9ucztmb3IodmFyIHIgaW4gbi5wcm9wc0RhdGEpZVtyXT10W3JdO3ZhciBpPW4uX3BhcmVudExpc3RlbmVycztmb3IodmFyIG8gaW4gaSllW1BuKG8pXT1pW29dO3JldHVybiBlfWZ1bmN0aW9uIHRuKHQsZSl7aWYoL1xkLWtlZXAtYWxpdmUkLy50ZXN0KGUudGFnKSlyZXR1cm4gdCgia2VlcC1hbGl2ZSIse3Byb3BzOmUuY29tcG9uZW50T3B0aW9ucy5wcm9wc0RhdGF9KX1mdW5jdGlvbiBlbih0KXt0LmVsbS5fbW92ZUNiJiZ0LmVsbS5fbW92ZUNiKCksdC5lbG0uX2VudGVyQ2ImJnQuZWxtLl9lbnRlckNiKCl9ZnVuY3Rpb24gbm4odCl7dC5kYXRhLm5ld1Bvcz10LmVsbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKX1mdW5jdGlvbiBybih0KXt2YXIgZT10LmRhdGEucG9zLG49dC5kYXRhLm5ld1BvcyxyPWUubGVmdC1uLmxlZnQsaT1lLnRvcC1uLnRvcDtpZihyfHxpKXt0LmRhdGEubW92ZWQ9ITA7dmFyIG89dC5lbG0uc3R5bGU7by50cmFuc2Zvcm09by5XZWJraXRUcmFuc2Zvcm09InRyYW5zbGF0ZSgiK3IrInB4LCIraSsicHgpIixvLnRyYW5zaXRpb25EdXJhdGlvbj0iMHMifX1mdW5jdGlvbiBvbih0LGUpe3ZhciBuPWU/em86Vm87cmV0dXJuIHQucmVwbGFjZShuLGZ1bmN0aW9uKHQpe3JldHVybiBVb1t0XX0pfWZ1bmN0aW9uIGFuKHQsZSxuKXtyZXR1cm57dHlwZToxLHRhZzp0LGF0dHJzTGlzdDplLGF0dHJzTWFwOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT17fSxuPTAscj10Lmxlbmd0aDtuPHI7bisrKWVbdFtuXS5uYW1lXT10W25dLnZhbHVlO3JldHVybiBlfShlKSxwYXJlbnQ6bixjaGlsZHJlbjpbXX19ZnVuY3Rpb24gc24odCxlKXtmdW5jdGlvbiBuKHQpe3QucHJlJiYocz0hMSksTG8odC50YWcpJiYoYz0hMSk7Zm9yKHZhciBuPTA7bjxJby5sZW5ndGg7bisrKUlvW25dKHQsZSl9VG89ZS53YXJufHxzZSxMbz1lLmlzUHJlVGFnfHxCbixNbz1lLm11c3RVc2VQcm9wfHxCbixEbz1lLmdldFRhZ05hbWVzcGFjZXx8Qm4sam89Y2UoZS5tb2R1bGVzLCJ0cmFuc2Zvcm1Ob2RlIiksTm89Y2UoZS5tb2R1bGVzLCJwcmVUcmFuc2Zvcm1Ob2RlIiksSW89Y2UoZS5tb2R1bGVzLCJwb3N0VHJhbnNmb3JtTm9kZSIpLEVvPWUuZGVsaW1pdGVyczt2YXIgcixpLG89W10sYT0hMSE9PWUucHJlc2VydmVXaGl0ZXNwYWNlLHM9ITEsYz0hMTtyZXR1cm4gZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBuKGUpe2wrPWUsdD10LnN1YnN0cmluZyhlKX1mdW5jdGlvbiByKHQsbixyKXt2YXIgaSxzO2lmKG51bGw9PW4mJihuPWwpLG51bGw9PXImJihyPWwpLHQmJihzPXQudG9Mb3dlckNhc2UoKSksdClmb3IoaT1hLmxlbmd0aC0xO2k+PTAmJmFbaV0ubG93ZXJDYXNlZFRhZyE9PXM7aS0tKTtlbHNlIGk9MDtpZihpPj0wKXtmb3IodmFyIGM9YS5sZW5ndGgtMTtjPj1pO2MtLSllLmVuZCYmZS5lbmQoYVtjXS50YWcsbixyKTthLmxlbmd0aD1pLG89aSYmYVtpLTFdLnRhZ31lbHNlImJyIj09PXM/ZS5zdGFydCYmZS5zdGFydCh0LFtdLCEwLG4scik6InAiPT09cyYmKGUuc3RhcnQmJmUuc3RhcnQodCxbXSwhMSxuLHIpLGUuZW5kJiZlLmVuZCh0LG4scikpfWZvcih2YXIgaSxvLGE9W10scz1lLmV4cGVjdEhUTUwsYz1lLmlzVW5hcnlUYWd8fEJuLHU9ZS5jYW5CZUxlZnRPcGVuVGFnfHxCbixsPTA7dDspe2lmKGk9dCxvJiZIbyhvKSl7dmFyIGY9MCxwPW8udG9Mb3dlckNhc2UoKSxkPUJvW3BdfHwoQm9bcF09bmV3IFJlZ0V4cCgiKFtcXHNcXFNdKj8pKDwvIitwKyJbXj5dKj4pIiwiaSIpKSx2PXQucmVwbGFjZShkLGZ1bmN0aW9uKHQsbixyKXtyZXR1cm4gZj1yLmxlbmd0aCxIbyhwKXx8Im5vc2NyaXB0Ij09PXB8fChuPW4ucmVwbGFjZSgvPCEtLShbXHNcU10qPyktLT4vZywiJDEiKS5yZXBsYWNlKC88IVxbQ0RBVEFcWyhbXHNcU10qPyldXT4vZywiJDEiKSksSm8ocCxuKSYmKG49bi5zbGljZSgxKSksZS5jaGFycyYmZS5jaGFycyhuKSwiIn0pO2wrPXQubGVuZ3RoLXYubGVuZ3RoLHQ9dixyKHAsbC1mLGwpfWVsc2V7dmFyIGg9dC5pbmRleE9mKCI8Iik7aWYoMD09PWgpe2lmKEFvLnRlc3QodCkpe3ZhciBtPXQuaW5kZXhPZigiLS1ceDNlIik7aWYobT49MCl7ZS5zaG91bGRLZWVwQ29tbWVudCYmZS5jb21tZW50KHQuc3Vic3RyaW5nKDQsbSkpLG4obSszKTtjb250aW51ZX19aWYoT28udGVzdCh0KSl7dmFyIHk9dC5pbmRleE9mKCJdPiIpO2lmKHk+PTApe24oeSsyKTtjb250aW51ZX19dmFyIGc9dC5tYXRjaChrbyk7aWYoZyl7bihnWzBdLmxlbmd0aCk7Y29udGludWV9dmFyIF89dC5tYXRjaCh4byk7aWYoXyl7dmFyIGI9bDtuKF9bMF0ubGVuZ3RoKSxyKF9bMV0sYixsKTtjb250aW51ZX12YXIgJD1mdW5jdGlvbigpe3ZhciBlPXQubWF0Y2goQ28pO2lmKGUpe3ZhciByPXt0YWdOYW1lOmVbMV0sYXR0cnM6W10sc3RhcnQ6bH07bihlWzBdLmxlbmd0aCk7Zm9yKHZhciBpLG87IShpPXQubWF0Y2god28pKSYmKG89dC5tYXRjaChfbykpOyluKG9bMF0ubGVuZ3RoKSxyLmF0dHJzLnB1c2gobyk7aWYoaSlyZXR1cm4gci51bmFyeVNsYXNoPWlbMV0sbihpWzBdLmxlbmd0aCksci5lbmQ9bCxyfX0oKTtpZigkKXshZnVuY3Rpb24odCl7dmFyIG49dC50YWdOYW1lLGk9dC51bmFyeVNsYXNoO3MmJigicCI9PT1vJiZnbyhuKSYmcihvKSx1KG4pJiZvPT09biYmcihuKSk7Zm9yKHZhciBsPWMobil8fCEhaSxmPXQuYXR0cnMubGVuZ3RoLHA9bmV3IEFycmF5KGYpLGQ9MDtkPGY7ZCsrKXt2YXIgdj10LmF0dHJzW2RdO1NvJiYtMT09PXZbMF0uaW5kZXhPZignIiInKSYmKCIiPT09dlszXSYmZGVsZXRlIHZbM10sIiI9PT12WzRdJiZkZWxldGUgdls0XSwiIj09PXZbNV0mJmRlbGV0ZSB2WzVdKTt2YXIgaD12WzNdfHx2WzRdfHx2WzVdfHwiIixtPSJhIj09PW4mJiJocmVmIj09PXZbMV0/ZS5zaG91bGREZWNvZGVOZXdsaW5lc0ZvckhyZWY6ZS5zaG91bGREZWNvZGVOZXdsaW5lcztwW2RdPXtuYW1lOnZbMV0sdmFsdWU6b24oaCxtKX19bHx8KGEucHVzaCh7dGFnOm4sbG93ZXJDYXNlZFRhZzpuLnRvTG93ZXJDYXNlKCksYXR0cnM6cH0pLG89biksZS5zdGFydCYmZS5zdGFydChuLHAsbCx0LnN0YXJ0LHQuZW5kKX0oJCksSm8obyx0KSYmbigxKTtjb250aW51ZX19dmFyIEM9dm9pZCAwLHc9dm9pZCAwLHg9dm9pZCAwO2lmKGg+PTApe2Zvcih3PXQuc2xpY2UoaCk7ISh4by50ZXN0KHcpfHxDby50ZXN0KHcpfHxBby50ZXN0KHcpfHxPby50ZXN0KHcpfHwoeD13LmluZGV4T2YoIjwiLDEpKTwwKTspaCs9eCx3PXQuc2xpY2UoaCk7Qz10LnN1YnN0cmluZygwLGgpLG4oaCl9aDwwJiYoQz10LHQ9IiIpLGUuY2hhcnMmJkMmJmUuY2hhcnMoQyl9aWYodD09PWkpe2UuY2hhcnMmJmUuY2hhcnModCk7YnJlYWt9fXIoKX0odCx7d2FybjpUbyxleHBlY3RIVE1MOmUuZXhwZWN0SFRNTCxpc1VuYXJ5VGFnOmUuaXNVbmFyeVRhZyxjYW5CZUxlZnRPcGVuVGFnOmUuY2FuQmVMZWZ0T3BlblRhZyxzaG91bGREZWNvZGVOZXdsaW5lczplLnNob3VsZERlY29kZU5ld2xpbmVzLHNob3VsZERlY29kZU5ld2xpbmVzRm9ySHJlZjplLnNob3VsZERlY29kZU5ld2xpbmVzRm9ySHJlZixzaG91bGRLZWVwQ29tbWVudDplLmNvbW1lbnRzLHN0YXJ0OmZ1bmN0aW9uKHQsYSx1KXt2YXIgbD1pJiZpLm5zfHxEbyh0KTtRbiYmInN2ZyI9PT1sJiYoYT1mdW5jdGlvbih0KXtmb3IodmFyIGU9W10sbj0wO248dC5sZW5ndGg7bisrKXt2YXIgcj10W25dO25hLnRlc3Qoci5uYW1lKXx8KHIubmFtZT1yLm5hbWUucmVwbGFjZShyYSwiIiksZS5wdXNoKHIpKX1yZXR1cm4gZX0oYSkpO3ZhciBmPWFuKHQsYSxpKTtsJiYoZi5ucz1sKSxmdW5jdGlvbih0KXtyZXR1cm4ic3R5bGUiPT09dC50YWd8fCJzY3JpcHQiPT09dC50YWcmJighdC5hdHRyc01hcC50eXBlfHwidGV4dC9qYXZhc2NyaXB0Ij09PXQuYXR0cnNNYXAudHlwZSl9KGYpJiYhdXIoKSYmKGYuZm9yYmlkZGVuPSEwKTtmb3IodmFyIHA9MDtwPE5vLmxlbmd0aDtwKyspZj1Ob1twXShmLGUpfHxmO2lmKHN8fCghZnVuY3Rpb24odCl7bnVsbCE9aGUodCwidi1wcmUiKSYmKHQucHJlPSEwKX0oZiksZi5wcmUmJihzPSEwKSksTG8oZi50YWcpJiYoYz0hMCkscz9mdW5jdGlvbih0KXt2YXIgZT10LmF0dHJzTGlzdC5sZW5ndGg7aWYoZSlmb3IodmFyIG49dC5hdHRycz1uZXcgQXJyYXkoZSkscj0wO3I8ZTtyKyspbltyXT17bmFtZTp0LmF0dHJzTGlzdFtyXS5uYW1lLHZhbHVlOkpTT04uc3RyaW5naWZ5KHQuYXR0cnNMaXN0W3JdLnZhbHVlKX07ZWxzZSB0LnByZXx8KHQucGxhaW49ITApfShmKTpmLnByb2Nlc3NlZHx8KHVuKGYpLGZ1bmN0aW9uKHQpe3ZhciBlPWhlKHQsInYtaWYiKTtpZihlKXQuaWY9ZSxsbih0LHtleHA6ZSxibG9jazp0fSk7ZWxzZXtudWxsIT1oZSh0LCJ2LWVsc2UiKSYmKHQuZWxzZT0hMCk7dmFyIG49aGUodCwidi1lbHNlLWlmIik7biYmKHQuZWxzZWlmPW4pfX0oZiksZnVuY3Rpb24odCl7bnVsbCE9aGUodCwidi1vbmNlIikmJih0Lm9uY2U9ITApfShmKSxjbihmLGUpKSxyP28ubGVuZ3RofHxyLmlmJiYoZi5lbHNlaWZ8fGYuZWxzZSkmJmxuKHIse2V4cDpmLmVsc2VpZixibG9jazpmfSk6cj1mLGkmJiFmLmZvcmJpZGRlbilpZihmLmVsc2VpZnx8Zi5lbHNlKSFmdW5jdGlvbih0LGUpe3ZhciBuPWZ1bmN0aW9uKHQpe3ZhciBlPXQubGVuZ3RoO2Zvcig7ZS0tOyl7aWYoMT09PXRbZV0udHlwZSlyZXR1cm4gdFtlXTt0LnBvcCgpfX0oZS5jaGlsZHJlbik7biYmbi5pZiYmbG4obix7ZXhwOnQuZWxzZWlmLGJsb2NrOnR9KX0oZixpKTtlbHNlIGlmKGYuc2xvdFNjb3BlKXtpLnBsYWluPSExO3ZhciBkPWYuc2xvdFRhcmdldHx8JyJkZWZhdWx0Iic7KGkuc2NvcGVkU2xvdHN8fChpLnNjb3BlZFNsb3RzPXt9KSlbZF09Zn1lbHNlIGkuY2hpbGRyZW4ucHVzaChmKSxmLnBhcmVudD1pO3U/bihmKTooaT1mLG8ucHVzaChmKSl9LGVuZDpmdW5jdGlvbigpe3ZhciB0PW9bby5sZW5ndGgtMV0sZT10LmNoaWxkcmVuW3QuY2hpbGRyZW4ubGVuZ3RoLTFdO2UmJjM9PT1lLnR5cGUmJiIgIj09PWUudGV4dCYmIWMmJnQuY2hpbGRyZW4ucG9wKCksby5sZW5ndGgtPTEsaT1vW28ubGVuZ3RoLTFdLG4odCl9LGNoYXJzOmZ1bmN0aW9uKHQpe2lmKGkmJighUW58fCJ0ZXh0YXJlYSIhPT1pLnRhZ3x8aS5hdHRyc01hcC5wbGFjZWhvbGRlciE9PXQpKXt2YXIgZT1pLmNoaWxkcmVuO2lmKHQ9Y3x8dC50cmltKCk/ZnVuY3Rpb24odCl7cmV0dXJuInNjcmlwdCI9PT10LnRhZ3x8InN0eWxlIj09PXQudGFnfShpKT90OmVhKHQpOmEmJmUubGVuZ3RoPyIgIjoiIil7dmFyIG47IXMmJiIgIiE9PXQmJihuPWZ1bmN0aW9uKHQsZSl7dmFyIG49ZT9mbyhlKTp1bztpZihuLnRlc3QodCkpe2Zvcih2YXIgcixpLG8sYT1bXSxzPVtdLGM9bi5sYXN0SW5kZXg9MDtyPW4uZXhlYyh0KTspeyhpPXIuaW5kZXgpPmMmJihzLnB1c2gobz10LnNsaWNlKGMsaSkpLGEucHVzaChKU09OLnN0cmluZ2lmeShvKSkpO3ZhciB1PWFlKHJbMV0udHJpbSgpKTthLnB1c2goIl9zKCIrdSsiKSIpLHMucHVzaCh7IkBiaW5kaW5nIjp1fSksYz1pK3JbMF0ubGVuZ3RofXJldHVybiBjPHQubGVuZ3RoJiYocy5wdXNoKG89dC5zbGljZShjKSksYS5wdXNoKEpTT04uc3RyaW5naWZ5KG8pKSkse2V4cHJlc3Npb246YS5qb2luKCIrIiksdG9rZW5zOnN9fX0odCxFbykpP2UucHVzaCh7dHlwZToyLGV4cHJlc3Npb246bi5leHByZXNzaW9uLHRva2VuczpuLnRva2Vucyx0ZXh0OnR9KToiICI9PT10JiZlLmxlbmd0aCYmIiAiPT09ZVtlLmxlbmd0aC0xXS50ZXh0fHxlLnB1c2goe3R5cGU6Myx0ZXh0OnR9KX19fSxjb21tZW50OmZ1bmN0aW9uKHQpe2kuY2hpbGRyZW4ucHVzaCh7dHlwZTozLHRleHQ6dCxpc0NvbW1lbnQ6ITB9KX19KSxyfWZ1bmN0aW9uIGNuKHQsZSl7IWZ1bmN0aW9uKHQpe3ZhciBlPXZlKHQsImtleSIpO2UmJih0LmtleT1lKX0odCksdC5wbGFpbj0hdC5rZXkmJiF0LmF0dHJzTGlzdC5sZW5ndGgsZnVuY3Rpb24odCl7dmFyIGU9dmUodCwicmVmIik7ZSYmKHQucmVmPWUsdC5yZWZJbkZvcj1mdW5jdGlvbih0KXt2YXIgZT10O2Zvcig7ZTspe2lmKHZvaWQgMCE9PWUuZm9yKXJldHVybiEwO2U9ZS5wYXJlbnR9cmV0dXJuITF9KHQpKX0odCksZnVuY3Rpb24odCl7aWYoInNsb3QiPT09dC50YWcpdC5zbG90TmFtZT12ZSh0LCJuYW1lIik7ZWxzZXt2YXIgZTsidGVtcGxhdGUiPT09dC50YWc/KGU9aGUodCwic2NvcGUiKSx0LnNsb3RTY29wZT1lfHxoZSh0LCJzbG90LXNjb3BlIikpOihlPWhlKHQsInNsb3Qtc2NvcGUiKSkmJih0LnNsb3RTY29wZT1lKTt2YXIgbj12ZSh0LCJzbG90Iik7biYmKHQuc2xvdFRhcmdldD0nIiInPT09bj8nImRlZmF1bHQiJzpuLCJ0ZW1wbGF0ZSI9PT10LnRhZ3x8dC5zbG90U2NvcGV8fGxlKHQsInNsb3QiLG4pKX19KHQpLGZ1bmN0aW9uKHQpe3ZhciBlOyhlPXZlKHQsImlzIikpJiYodC5jb21wb25lbnQ9ZSk7bnVsbCE9aGUodCwiaW5saW5lLXRlbXBsYXRlIikmJih0LmlubGluZVRlbXBsYXRlPSEwKX0odCk7Zm9yKHZhciBuPTA7bjxqby5sZW5ndGg7bisrKXQ9am9bbl0odCxlKXx8dDshZnVuY3Rpb24odCl7dmFyIGUsbixyLGksbyxhLHMsYz10LmF0dHJzTGlzdDtmb3IoZT0wLG49Yy5sZW5ndGg7ZTxuO2UrKylpZihyPWk9Y1tlXS5uYW1lLG89Y1tlXS52YWx1ZSxXby50ZXN0KHIpKWlmKHQuaGFzQmluZGluZ3M9ITAsKGE9ZnVuY3Rpb24odCl7dmFyIGU9dC5tYXRjaCh0YSk7aWYoZSl7dmFyIG49e307cmV0dXJuIGUuZm9yRWFjaChmdW5jdGlvbih0KXtuW3Quc2xpY2UoMSldPSEwfSksbn19KHIpKSYmKHI9ci5yZXBsYWNlKHRhLCIiKSksUW8udGVzdChyKSlyPXIucmVwbGFjZShRbywiIiksbz1hZShvKSxzPSExLGEmJihhLnByb3AmJihzPSEwLCJpbm5lckh0bWwiPT09KHI9UG4ocikpJiYocj0iaW5uZXJIVE1MIikpLGEuY2FtZWwmJihyPVBuKHIpKSxhLnN5bmMmJmRlKHQsInVwZGF0ZToiK1BuKHIpLHllKG8sIiRldmVudCIpKSksc3x8IXQuY29tcG9uZW50JiZNbyh0LnRhZyx0LmF0dHJzTWFwLnR5cGUscik/dWUodCxyLG8pOmxlKHQscixvKTtlbHNlIGlmKHFvLnRlc3Qocikpcj1yLnJlcGxhY2UocW8sIiIpLGRlKHQscixvLGEsITEpO2Vsc2V7dmFyIHU9KHI9ci5yZXBsYWNlKFdvLCIiKSkubWF0Y2goWW8pLGw9dSYmdVsxXTtsJiYocj1yLnNsaWNlKDAsLShsLmxlbmd0aCsxKSkpLHBlKHQscixpLG8sbCxhKX1lbHNlIGxlKHQscixKU09OLnN0cmluZ2lmeShvKSksIXQuY29tcG9uZW50JiYibXV0ZWQiPT09ciYmTW8odC50YWcsdC5hdHRyc01hcC50eXBlLHIpJiZ1ZSh0LHIsInRydWUiKX0odCl9ZnVuY3Rpb24gdW4odCl7dmFyIGU7aWYoZT1oZSh0LCJ2LWZvciIpKXt2YXIgbj1mdW5jdGlvbih0KXt2YXIgZT10Lm1hdGNoKEdvKTtpZighZSlyZXR1cm47dmFyIG49e307bi5mb3I9ZVsyXS50cmltKCk7dmFyIHI9ZVsxXS50cmltKCkucmVwbGFjZShYbywiIiksaT1yLm1hdGNoKFpvKTtpPyhuLmFsaWFzPXIucmVwbGFjZShabywiIiksbi5pdGVyYXRvcjE9aVsxXS50cmltKCksaVsyXSYmKG4uaXRlcmF0b3IyPWlbMl0udHJpbSgpKSk6bi5hbGlhcz1yO3JldHVybiBufShlKTtuJiZoKHQsbil9fWZ1bmN0aW9uIGxuKHQsZSl7dC5pZkNvbmRpdGlvbnN8fCh0LmlmQ29uZGl0aW9ucz1bXSksdC5pZkNvbmRpdGlvbnMucHVzaChlKX1mdW5jdGlvbiBmbih0KXtyZXR1cm4gYW4odC50YWcsdC5hdHRyc0xpc3Quc2xpY2UoKSx0LnBhcmVudCl9ZnVuY3Rpb24gcG4odCl7aWYodC5zdGF0aWM9ZnVuY3Rpb24odCl7aWYoMj09PXQudHlwZSlyZXR1cm4hMTtpZigzPT09dC50eXBlKXJldHVybiEwO3JldHVybiEoIXQucHJlJiYodC5oYXNCaW5kaW5nc3x8dC5pZnx8dC5mb3J8fEluKHQudGFnKXx8IUZvKHQudGFnKXx8ZnVuY3Rpb24odCl7Zm9yKDt0LnBhcmVudDspe2lmKCJ0ZW1wbGF0ZSIhPT0odD10LnBhcmVudCkudGFnKXJldHVybiExO2lmKHQuZm9yKXJldHVybiEwfXJldHVybiExfSh0KXx8IU9iamVjdC5rZXlzKHQpLmV2ZXJ5KFBvKSkpfSh0KSwxPT09dC50eXBlKXtpZighRm8odC50YWcpJiYic2xvdCIhPT10LnRhZyYmbnVsbD09dC5hdHRyc01hcFsiaW5saW5lLXRlbXBsYXRlIl0pcmV0dXJuO2Zvcih2YXIgZT0wLG49dC5jaGlsZHJlbi5sZW5ndGg7ZTxuO2UrKyl7dmFyIHI9dC5jaGlsZHJlbltlXTtwbihyKSxyLnN0YXRpY3x8KHQuc3RhdGljPSExKX1pZih0LmlmQ29uZGl0aW9ucylmb3IodmFyIGk9MSxvPXQuaWZDb25kaXRpb25zLmxlbmd0aDtpPG87aSsrKXt2YXIgYT10LmlmQ29uZGl0aW9uc1tpXS5ibG9jaztwbihhKSxhLnN0YXRpY3x8KHQuc3RhdGljPSExKX19fWZ1bmN0aW9uIGRuKHQsZSl7aWYoMT09PXQudHlwZSl7aWYoKHQuc3RhdGljfHx0Lm9uY2UpJiYodC5zdGF0aWNJbkZvcj1lKSx0LnN0YXRpYyYmdC5jaGlsZHJlbi5sZW5ndGgmJigxIT09dC5jaGlsZHJlbi5sZW5ndGh8fDMhPT10LmNoaWxkcmVuWzBdLnR5cGUpKXJldHVybiB2b2lkKHQuc3RhdGljUm9vdD0hMCk7aWYodC5zdGF0aWNSb290PSExLHQuY2hpbGRyZW4pZm9yKHZhciBuPTAscj10LmNoaWxkcmVuLmxlbmd0aDtuPHI7bisrKWRuKHQuY2hpbGRyZW5bbl0sZXx8ISF0LmZvcik7aWYodC5pZkNvbmRpdGlvbnMpZm9yKHZhciBpPTEsbz10LmlmQ29uZGl0aW9ucy5sZW5ndGg7aTxvO2krKylkbih0LmlmQ29uZGl0aW9uc1tpXS5ibG9jayxlKX19ZnVuY3Rpb24gdm4odCxlLG4pe3ZhciByPWU/Im5hdGl2ZU9uOnsiOiJvbjp7Ijtmb3IodmFyIGkgaW4gdClyKz0nIicraSsnIjonK2huKGksdFtpXSkrIiwiO3JldHVybiByLnNsaWNlKDAsLTEpKyJ9In1mdW5jdGlvbiBobih0LGUpe2lmKCFlKXJldHVybiJmdW5jdGlvbigpe30iO2lmKEFycmF5LmlzQXJyYXkoZSkpcmV0dXJuIlsiK2UubWFwKGZ1bmN0aW9uKGUpe3JldHVybiBobih0LGUpfSkuam9pbigiLCIpKyJdIjt2YXIgbj1jYS50ZXN0KGUudmFsdWUpLHI9c2EudGVzdChlLnZhbHVlKTtpZihlLm1vZGlmaWVycyl7dmFyIGk9IiIsbz0iIixhPVtdO2Zvcih2YXIgcyBpbiBlLm1vZGlmaWVycylpZihmYVtzXSlvKz1mYVtzXSx1YVtzXSYmYS5wdXNoKHMpO2Vsc2UgaWYoImV4YWN0Ij09PXMpe3ZhciBjPWUubW9kaWZpZXJzO28rPWxhKFsiY3RybCIsInNoaWZ0IiwiYWx0IiwibWV0YSJdLmZpbHRlcihmdW5jdGlvbih0KXtyZXR1cm4hY1t0XX0pLm1hcChmdW5jdGlvbih0KXtyZXR1cm4iJGV2ZW50LiIrdCsiS2V5In0pLmpvaW4oInx8IikpfWVsc2UgYS5wdXNoKHMpO2EubGVuZ3RoJiYoaSs9ZnVuY3Rpb24odCl7cmV0dXJuImlmKCEoJ2J1dHRvbicgaW4gJGV2ZW50KSYmIit0Lm1hcChtbikuam9pbigiJiYiKSsiKXJldHVybiBudWxsOyJ9KGEpKSxvJiYoaSs9byk7cmV0dXJuImZ1bmN0aW9uKCRldmVudCl7IitpKyhuP2UudmFsdWUrIigkZXZlbnQpIjpyPyIoIitlLnZhbHVlKyIpKCRldmVudCkiOmUudmFsdWUpKyJ9In1yZXR1cm4gbnx8cj9lLnZhbHVlOiJmdW5jdGlvbigkZXZlbnQpeyIrZS52YWx1ZSsifSJ9ZnVuY3Rpb24gbW4odCl7dmFyIGU9cGFyc2VJbnQodCwxMCk7aWYoZSlyZXR1cm4iJGV2ZW50LmtleUNvZGUhPT0iK2U7dmFyIG49dWFbdF07cmV0dXJuIl9rKCRldmVudC5rZXlDb2RlLCIrSlNPTi5zdHJpbmdpZnkodCkrIiwiK0pTT04uc3RyaW5naWZ5KG4pKyIsJGV2ZW50LmtleSkifWZ1bmN0aW9uIHluKHQsZSl7dmFyIG49bmV3IGRhKGUpO3JldHVybntyZW5kZXI6IndpdGgodGhpcyl7cmV0dXJuICIrKHQ/Z24odCxuKTonX2MoImRpdiIpJykrIn0iLHN0YXRpY1JlbmRlckZuczpuLnN0YXRpY1JlbmRlckZuc319ZnVuY3Rpb24gZ24odCxlKXtpZih0LnN0YXRpY1Jvb3QmJiF0LnN0YXRpY1Byb2Nlc3NlZClyZXR1cm4gX24odCxlKTtpZih0Lm9uY2UmJiF0Lm9uY2VQcm9jZXNzZWQpcmV0dXJuIGJuKHQsZSk7aWYodC5mb3ImJiF0LmZvclByb2Nlc3NlZClyZXR1cm4gZnVuY3Rpb24odCxlLG4scil7dmFyIGk9dC5mb3Isbz10LmFsaWFzLGE9dC5pdGVyYXRvcjE/IiwiK3QuaXRlcmF0b3IxOiIiLHM9dC5pdGVyYXRvcjI/IiwiK3QuaXRlcmF0b3IyOiIiO3JldHVybiB0LmZvclByb2Nlc3NlZD0hMCwocnx8Il9sIikrIigoIitpKyIpLGZ1bmN0aW9uKCIrbythK3MrIil7cmV0dXJuICIrKG58fGduKSh0LGUpKyJ9KSJ9KHQsZSk7aWYodC5pZiYmIXQuaWZQcm9jZXNzZWQpcmV0dXJuICRuKHQsZSk7aWYoInRlbXBsYXRlIiE9PXQudGFnfHx0LnNsb3RUYXJnZXQpe2lmKCJzbG90Ij09PXQudGFnKXJldHVybiBmdW5jdGlvbih0LGUpe3ZhciBuPXQuc2xvdE5hbWV8fCciZGVmYXVsdCInLHI9a24odCxlKSxpPSJfdCgiK24rKHI/IiwiK3I6IiIpLG89dC5hdHRycyYmInsiK3QuYXR0cnMubWFwKGZ1bmN0aW9uKHQpe3JldHVybiBQbih0Lm5hbWUpKyI6Iit0LnZhbHVlfSkuam9pbigiLCIpKyJ9IixhPXQuYXR0cnNNYXBbInYtYmluZCJdOyFvJiYhYXx8cnx8KGkrPSIsbnVsbCIpO28mJihpKz0iLCIrbyk7YSYmKGkrPShvPyIiOiIsbnVsbCIpKyIsIithKTtyZXR1cm4gaSsiKSJ9KHQsZSk7dmFyIG47aWYodC5jb21wb25lbnQpbj1mdW5jdGlvbih0LGUsbil7dmFyIHI9ZS5pbmxpbmVUZW1wbGF0ZT9udWxsOmtuKGUsbiwhMCk7cmV0dXJuIl9jKCIrdCsiLCIrd24oZSxuKSsocj8iLCIrcjoiIikrIikifSh0LmNvbXBvbmVudCx0LGUpO2Vsc2V7dmFyIHI9dC5wbGFpbj92b2lkIDA6d24odCxlKSxpPXQuaW5saW5lVGVtcGxhdGU/bnVsbDprbih0LGUsITApO249Il9jKCciK3QudGFnKyInIisocj8iLCIrcjoiIikrKGk/IiwiK2k6IiIpKyIpIn1mb3IodmFyIG89MDtvPGUudHJhbnNmb3Jtcy5sZW5ndGg7bysrKW49ZS50cmFuc2Zvcm1zW29dKHQsbik7cmV0dXJuIG59cmV0dXJuIGtuKHQsZSl8fCJ2b2lkIDAifWZ1bmN0aW9uIF9uKHQsZSl7cmV0dXJuIHQuc3RhdGljUHJvY2Vzc2VkPSEwLGUuc3RhdGljUmVuZGVyRm5zLnB1c2goIndpdGgodGhpcyl7cmV0dXJuICIrZ24odCxlKSsifSIpLCJfbSgiKyhlLnN0YXRpY1JlbmRlckZucy5sZW5ndGgtMSkrKHQuc3RhdGljSW5Gb3I/Iix0cnVlIjoiIikrIikifWZ1bmN0aW9uIGJuKHQsZSl7aWYodC5vbmNlUHJvY2Vzc2VkPSEwLHQuaWYmJiF0LmlmUHJvY2Vzc2VkKXJldHVybiAkbih0LGUpO2lmKHQuc3RhdGljSW5Gb3Ipe2Zvcih2YXIgbj0iIixyPXQucGFyZW50O3I7KXtpZihyLmZvcil7bj1yLmtleTticmVha31yPXIucGFyZW50fXJldHVybiBuPyJfbygiK2duKHQsZSkrIiwiK2Uub25jZUlkKysrIiwiK24rIikiOmduKHQsZSl9cmV0dXJuIF9uKHQsZSl9ZnVuY3Rpb24gJG4odCxlLG4scil7cmV0dXJuIHQuaWZQcm9jZXNzZWQ9ITAsQ24odC5pZkNvbmRpdGlvbnMuc2xpY2UoKSxlLG4scil9ZnVuY3Rpb24gQ24odCxlLG4scil7ZnVuY3Rpb24gaSh0KXtyZXR1cm4gbj9uKHQsZSk6dC5vbmNlP2JuKHQsZSk6Z24odCxlKX1pZighdC5sZW5ndGgpcmV0dXJuIHJ8fCJfZSgpIjt2YXIgbz10LnNoaWZ0KCk7cmV0dXJuIG8uZXhwPyIoIitvLmV4cCsiKT8iK2koby5ibG9jaykrIjoiK0NuKHQsZSxuLHIpOiIiK2koby5ibG9jayl9ZnVuY3Rpb24gd24odCxlKXt2YXIgbj0ieyIscj1mdW5jdGlvbih0LGUpe3ZhciBuPXQuZGlyZWN0aXZlcztpZighbilyZXR1cm47dmFyIHIsaSxvLGEscz0iZGlyZWN0aXZlczpbIixjPSExO2ZvcihyPTAsaT1uLmxlbmd0aDtyPGk7cisrKXtvPW5bcl0sYT0hMDt2YXIgdT1lLmRpcmVjdGl2ZXNbby5uYW1lXTt1JiYoYT0hIXUodCxvLGUud2FybikpLGEmJihjPSEwLHMrPSd7bmFtZToiJytvLm5hbWUrJyIscmF3TmFtZToiJytvLnJhd05hbWUrJyInKyhvLnZhbHVlPyIsdmFsdWU6KCIrby52YWx1ZSsiKSxleHByZXNzaW9uOiIrSlNPTi5zdHJpbmdpZnkoby52YWx1ZSk6IiIpKyhvLmFyZz8nLGFyZzoiJytvLmFyZysnIic6IiIpKyhvLm1vZGlmaWVycz8iLG1vZGlmaWVyczoiK0pTT04uc3RyaW5naWZ5KG8ubW9kaWZpZXJzKToiIikrIn0sIil9aWYoYylyZXR1cm4gcy5zbGljZSgwLC0xKSsiXSJ9KHQsZSk7ciYmKG4rPXIrIiwiKSx0LmtleSYmKG4rPSJrZXk6Iit0LmtleSsiLCIpLHQucmVmJiYobis9InJlZjoiK3QucmVmKyIsIiksdC5yZWZJbkZvciYmKG4rPSJyZWZJbkZvcjp0cnVlLCIpLHQucHJlJiYobis9InByZTp0cnVlLCIpLHQuY29tcG9uZW50JiYobis9J3RhZzoiJyt0LnRhZysnIiwnKTtmb3IodmFyIGk9MDtpPGUuZGF0YUdlbkZucy5sZW5ndGg7aSsrKW4rPWUuZGF0YUdlbkZuc1tpXSh0KTtpZih0LmF0dHJzJiYobis9ImF0dHJzOnsiK09uKHQuYXR0cnMpKyJ9LCIpLHQucHJvcHMmJihuKz0iZG9tUHJvcHM6eyIrT24odC5wcm9wcykrIn0sIiksdC5ldmVudHMmJihuKz12bih0LmV2ZW50cywhMSxlLndhcm4pKyIsIiksdC5uYXRpdmVFdmVudHMmJihuKz12bih0Lm5hdGl2ZUV2ZW50cywhMCxlLndhcm4pKyIsIiksdC5zbG90VGFyZ2V0JiYhdC5zbG90U2NvcGUmJihuKz0ic2xvdDoiK3Quc2xvdFRhcmdldCsiLCIpLHQuc2NvcGVkU2xvdHMmJihuKz1mdW5jdGlvbih0LGUpe3JldHVybiJzY29wZWRTbG90czpfdShbIitPYmplY3Qua2V5cyh0KS5tYXAoZnVuY3Rpb24obil7cmV0dXJuIHhuKG4sdFtuXSxlKX0pLmpvaW4oIiwiKSsiXSkifSh0LnNjb3BlZFNsb3RzLGUpKyIsIiksdC5tb2RlbCYmKG4rPSJtb2RlbDp7dmFsdWU6Iit0Lm1vZGVsLnZhbHVlKyIsY2FsbGJhY2s6Iit0Lm1vZGVsLmNhbGxiYWNrKyIsZXhwcmVzc2lvbjoiK3QubW9kZWwuZXhwcmVzc2lvbisifSwiKSx0LmlubGluZVRlbXBsYXRlKXt2YXIgbz1mdW5jdGlvbih0LGUpe3ZhciBuPXQuY2hpbGRyZW5bMF07aWYoMT09PW4udHlwZSl7dmFyIHI9eW4obixlLm9wdGlvbnMpO3JldHVybiJpbmxpbmVUZW1wbGF0ZTp7cmVuZGVyOmZ1bmN0aW9uKCl7IityLnJlbmRlcisifSxzdGF0aWNSZW5kZXJGbnM6WyIrci5zdGF0aWNSZW5kZXJGbnMubWFwKGZ1bmN0aW9uKHQpe3JldHVybiJmdW5jdGlvbigpeyIrdCsifSJ9KS5qb2luKCIsIikrIl19In19KHQsZSk7byYmKG4rPW8rIiwiKX1yZXR1cm4gbj1uLnJlcGxhY2UoLywkLywiIikrIn0iLHQud3JhcERhdGEmJihuPXQud3JhcERhdGEobikpLHQud3JhcExpc3RlbmVycyYmKG49dC53cmFwTGlzdGVuZXJzKG4pKSxufWZ1bmN0aW9uIHhuKHQsZSxuKXtpZihlLmZvciYmIWUuZm9yUHJvY2Vzc2VkKXJldHVybiBmdW5jdGlvbih0LGUsbil7dmFyIHI9ZS5mb3IsaT1lLmFsaWFzLG89ZS5pdGVyYXRvcjE/IiwiK2UuaXRlcmF0b3IxOiIiLGE9ZS5pdGVyYXRvcjI/IiwiK2UuaXRlcmF0b3IyOiIiO3JldHVybiBlLmZvclByb2Nlc3NlZD0hMCwiX2woKCIrcisiKSxmdW5jdGlvbigiK2krbythKyIpe3JldHVybiAiK3huKHQsZSxuKSsifSkifSh0LGUsbik7cmV0dXJuIntrZXk6Iit0KyIsZm46IisoImZ1bmN0aW9uKCIrU3RyaW5nKGUuc2xvdFNjb3BlKSsiKXtyZXR1cm4gIisoInRlbXBsYXRlIj09PWUudGFnP2UuaWY/ZS5pZisiPyIrKGtuKGUsbil8fCJ1bmRlZmluZWQiKSsiOnVuZGVmaW5lZCI6a24oZSxuKXx8InVuZGVmaW5lZCI6Z24oZSxuKSkrIn0iKSsifSJ9ZnVuY3Rpb24ga24odCxlLG4scixpKXt2YXIgbz10LmNoaWxkcmVuO2lmKG8ubGVuZ3RoKXt2YXIgYT1vWzBdO2lmKDE9PT1vLmxlbmd0aCYmYS5mb3ImJiJ0ZW1wbGF0ZSIhPT1hLnRhZyYmInNsb3QiIT09YS50YWcpcmV0dXJuKHJ8fGduKShhLGUpO3ZhciBzPW4/ZnVuY3Rpb24odCxlKXtmb3IodmFyIG49MCxyPTA7cjx0Lmxlbmd0aDtyKyspe3ZhciBpPXRbcl07aWYoMT09PWkudHlwZSl7aWYoQW4oaSl8fGkuaWZDb25kaXRpb25zJiZpLmlmQ29uZGl0aW9ucy5zb21lKGZ1bmN0aW9uKHQpe3JldHVybiBBbih0LmJsb2NrKX0pKXtuPTI7YnJlYWt9KGUoaSl8fGkuaWZDb25kaXRpb25zJiZpLmlmQ29uZGl0aW9ucy5zb21lKGZ1bmN0aW9uKHQpe3JldHVybiBlKHQuYmxvY2spfSkpJiYobj0xKX19cmV0dXJuIG59KG8sZS5tYXliZUNvbXBvbmVudCk6MCxjPWl8fGZ1bmN0aW9uKHQsZSl7aWYoMT09PXQudHlwZSlyZXR1cm4gZ24odCxlKTtyZXR1cm4gMz09PXQudHlwZSYmdC5pc0NvbW1lbnQ/ZnVuY3Rpb24odCl7cmV0dXJuIl9lKCIrSlNPTi5zdHJpbmdpZnkodC50ZXh0KSsiKSJ9KHQpOmZ1bmN0aW9uKHQpe3JldHVybiJfdigiKygyPT09dC50eXBlP3QuZXhwcmVzc2lvbjpTbihKU09OLnN0cmluZ2lmeSh0LnRleHQpKSkrIikifSh0KX07cmV0dXJuIlsiK28ubWFwKGZ1bmN0aW9uKHQpe3JldHVybiBjKHQsZSl9KS5qb2luKCIsIikrIl0iKyhzPyIsIitzOiIiKX19ZnVuY3Rpb24gQW4odCl7cmV0dXJuIHZvaWQgMCE9PXQuZm9yfHwidGVtcGxhdGUiPT09dC50YWd8fCJzbG90Ij09PXQudGFnfWZ1bmN0aW9uIE9uKHQpe2Zvcih2YXIgZT0iIixuPTA7bjx0Lmxlbmd0aDtuKyspe3ZhciByPXRbbl07ZSs9JyInK3IubmFtZSsnIjonK1NuKHIudmFsdWUpKyIsIn1yZXR1cm4gZS5zbGljZSgwLC0xKX1mdW5jdGlvbiBTbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9cdTIwMjgvZywiXFx1MjAyOCIpLnJlcGxhY2UoL1x1MjAyOS9nLCJcXHUyMDI5Iil9ZnVuY3Rpb24gVG4odCxlKXt0cnl7cmV0dXJuIG5ldyBGdW5jdGlvbih0KX1jYXRjaChuKXtyZXR1cm4gZS5wdXNoKHtlcnI6bixjb2RlOnR9KSx5fX1mdW5jdGlvbiBFbih0KXtyZXR1cm4gUm89Um98fGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLFJvLmlubmVySFRNTD10Pyc8YSBocmVmPSJcbiIvPic6JzxkaXYgYT0iXG4iLz4nLFJvLmlubmVySFRNTC5pbmRleE9mKCImIzEwOyIpPjB9dmFyIGpuPU9iamVjdC5mcmVlemUoe30pLE5uPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcsSW49dSgic2xvdCxjb21wb25lbnQiLCEwKSxMbj11KCJrZXkscmVmLHNsb3Qsc2xvdC1zY29wZSxpcyIpLE1uPU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksRG49Ly0oXHcpL2csUG49cChmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKERuLGZ1bmN0aW9uKHQsZSl7cmV0dXJuIGU/ZS50b1VwcGVyQ2FzZSgpOiIifSl9KSxGbj1wKGZ1bmN0aW9uKHQpe3JldHVybiB0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK3Quc2xpY2UoMSl9KSxSbj0vXEIoW0EtWl0pL2csSG49cChmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKFJuLCItJDEiKS50b0xvd2VyQ2FzZSgpfSksQm49ZnVuY3Rpb24odCxlLG4pe3JldHVybiExfSxVbj1mdW5jdGlvbih0KXtyZXR1cm4gdH0sVm49ImRhdGEtc2VydmVyLXJlbmRlcmVkIix6bj1bImNvbXBvbmVudCIsImRpcmVjdGl2ZSIsImZpbHRlciJdLEtuPVsiYmVmb3JlQ3JlYXRlIiwiY3JlYXRlZCIsImJlZm9yZU1vdW50IiwibW91bnRlZCIsImJlZm9yZVVwZGF0ZSIsInVwZGF0ZWQiLCJiZWZvcmVEZXN0cm95IiwiZGVzdHJveWVkIiwiYWN0aXZhdGVkIiwiZGVhY3RpdmF0ZWQiLCJlcnJvckNhcHR1cmVkIl0sSm49e29wdGlvbk1lcmdlU3RyYXRlZ2llczpPYmplY3QuY3JlYXRlKG51bGwpLHNpbGVudDohMSxwcm9kdWN0aW9uVGlwOiExLGRldnRvb2xzOiExLHBlcmZvcm1hbmNlOiExLGVycm9ySGFuZGxlcjpudWxsLHdhcm5IYW5kbGVyOm51bGwsaWdub3JlZEVsZW1lbnRzOltdLGtleUNvZGVzOk9iamVjdC5jcmVhdGUobnVsbCksaXNSZXNlcnZlZFRhZzpCbixpc1Jlc2VydmVkQXR0cjpCbixpc1Vua25vd25FbGVtZW50OkJuLGdldFRhZ05hbWVzcGFjZTp5LHBhcnNlUGxhdGZvcm1UYWdOYW1lOlVuLG11c3RVc2VQcm9wOkJuLF9saWZlY3ljbGVIb29rczpLbn0scW49L1teXHcuJF0vLFduPSJfX3Byb3RvX18iaW57fSxHbj0idW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyxabj0idW5kZWZpbmVkIiE9dHlwZW9mIFdYRW52aXJvbm1lbnQmJiEhV1hFbnZpcm9ubWVudC5wbGF0Zm9ybSxYbj1abiYmV1hFbnZpcm9ubWVudC5wbGF0Zm9ybS50b0xvd2VyQ2FzZSgpLFluPUduJiZ3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLFFuPVluJiYvbXNpZXx0cmlkZW50Ly50ZXN0KFluKSx0cj1ZbiYmWW4uaW5kZXhPZigibXNpZSA5LjAiKT4wLGVyPVluJiZZbi5pbmRleE9mKCJlZGdlLyIpPjAsbnI9WW4mJlluLmluZGV4T2YoImFuZHJvaWQiKT4wfHwiYW5kcm9pZCI9PT1Ybixycj1ZbiYmL2lwaG9uZXxpcGFkfGlwb2R8aW9zLy50ZXN0KFluKXx8ImlvcyI9PT1Ybixpcj0oWW4mJi9jaHJvbWVcL1xkKy8udGVzdChZbikse30ud2F0Y2gpLG9yPSExO2lmKEduKXRyeXt2YXIgYXI9e307T2JqZWN0LmRlZmluZVByb3BlcnR5KGFyLCJwYXNzaXZlIix7Z2V0OmZ1bmN0aW9uKCl7b3I9ITB9fSksd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInRlc3QtcGFzc2l2ZSIsbnVsbCxhcil9Y2F0Y2godCl7fXZhciBzcixjcix1cj1mdW5jdGlvbigpe3JldHVybiB2b2lkIDA9PT1zciYmKHNyPSFHbiYmInVuZGVmaW5lZCIhPXR5cGVvZiBnbG9iYWwmJiJzZXJ2ZXIiPT09Z2xvYmFsLnByb2Nlc3MuZW52LlZVRV9FTlYpLHNyfSxscj1HbiYmd2luZG93Ll9fVlVFX0RFVlRPT0xTX0dMT0JBTF9IT09LX18sZnI9InVuZGVmaW5lZCIhPXR5cGVvZiBTeW1ib2wmJncoU3ltYm9sKSYmInVuZGVmaW5lZCIhPXR5cGVvZiBSZWZsZWN0JiZ3KFJlZmxlY3Qub3duS2V5cyk7Y3I9InVuZGVmaW5lZCIhPXR5cGVvZiBTZXQmJncoU2V0KT9TZXQ6ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7dGhpcy5zZXQ9T2JqZWN0LmNyZWF0ZShudWxsKX1yZXR1cm4gdC5wcm90b3R5cGUuaGFzPWZ1bmN0aW9uKHQpe3JldHVybiEwPT09dGhpcy5zZXRbdF19LHQucHJvdG90eXBlLmFkZD1mdW5jdGlvbih0KXt0aGlzLnNldFt0XT0hMH0sdC5wcm90b3R5cGUuY2xlYXI9ZnVuY3Rpb24oKXt0aGlzLnNldD1PYmplY3QuY3JlYXRlKG51bGwpfSx0fSgpO3ZhciBwcj15LGRyPTAsdnI9ZnVuY3Rpb24oKXt0aGlzLmlkPWRyKyssdGhpcy5zdWJzPVtdfTt2ci5wcm90b3R5cGUuYWRkU3ViPWZ1bmN0aW9uKHQpe3RoaXMuc3Vicy5wdXNoKHQpfSx2ci5wcm90b3R5cGUucmVtb3ZlU3ViPWZ1bmN0aW9uKHQpe2wodGhpcy5zdWJzLHQpfSx2ci5wcm90b3R5cGUuZGVwZW5kPWZ1bmN0aW9uKCl7dnIudGFyZ2V0JiZ2ci50YXJnZXQuYWRkRGVwKHRoaXMpfSx2ci5wcm90b3R5cGUubm90aWZ5PWZ1bmN0aW9uKCl7Zm9yKHZhciB0PXRoaXMuc3Vicy5zbGljZSgpLGU9MCxuPXQubGVuZ3RoO2U8bjtlKyspdFtlXS51cGRhdGUoKX0sdnIudGFyZ2V0PW51bGw7dmFyIGhyPVtdLG1yPWZ1bmN0aW9uKHQsZSxuLHIsaSxvLGEscyl7dGhpcy50YWc9dCx0aGlzLmRhdGE9ZSx0aGlzLmNoaWxkcmVuPW4sdGhpcy50ZXh0PXIsdGhpcy5lbG09aSx0aGlzLm5zPXZvaWQgMCx0aGlzLmNvbnRleHQ9byx0aGlzLmZuQ29udGV4dD12b2lkIDAsdGhpcy5mbk9wdGlvbnM9dm9pZCAwLHRoaXMuZm5TY29wZUlkPXZvaWQgMCx0aGlzLmtleT1lJiZlLmtleSx0aGlzLmNvbXBvbmVudE9wdGlvbnM9YSx0aGlzLmNvbXBvbmVudEluc3RhbmNlPXZvaWQgMCx0aGlzLnBhcmVudD12b2lkIDAsdGhpcy5yYXc9ITEsdGhpcy5pc1N0YXRpYz0hMSx0aGlzLmlzUm9vdEluc2VydD0hMCx0aGlzLmlzQ29tbWVudD0hMSx0aGlzLmlzQ2xvbmVkPSExLHRoaXMuaXNPbmNlPSExLHRoaXMuYXN5bmNGYWN0b3J5PXMsdGhpcy5hc3luY01ldGE9dm9pZCAwLHRoaXMuaXNBc3luY1BsYWNlaG9sZGVyPSExfSx5cj17Y2hpbGQ6e2NvbmZpZ3VyYWJsZTohMH19O3lyLmNoaWxkLmdldD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbXBvbmVudEluc3RhbmNlfSxPYmplY3QuZGVmaW5lUHJvcGVydGllcyhtci5wcm90b3R5cGUseXIpO3ZhciBncj1mdW5jdGlvbih0KXt2b2lkIDA9PT10JiYodD0iIik7dmFyIGU9bmV3IG1yO3JldHVybiBlLnRleHQ9dCxlLmlzQ29tbWVudD0hMCxlfSxfcj1BcnJheS5wcm90b3R5cGUsYnI9T2JqZWN0LmNyZWF0ZShfcik7WyJwdXNoIiwicG9wIiwic2hpZnQiLCJ1bnNoaWZ0Iiwic3BsaWNlIiwic29ydCIsInJldmVyc2UiXS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3ZhciBlPV9yW3RdO0MoYnIsdCxmdW5jdGlvbigpe2Zvcih2YXIgbj1bXSxyPWFyZ3VtZW50cy5sZW5ndGg7ci0tOyluW3JdPWFyZ3VtZW50c1tyXTt2YXIgaSxvPWUuYXBwbHkodGhpcyxuKSxhPXRoaXMuX19vYl9fO3N3aXRjaCh0KXtjYXNlInB1c2giOmNhc2UidW5zaGlmdCI6aT1uO2JyZWFrO2Nhc2Uic3BsaWNlIjppPW4uc2xpY2UoMil9cmV0dXJuIGkmJmEub2JzZXJ2ZUFycmF5KGkpLGEuZGVwLm5vdGlmeSgpLG99KX0pO3ZhciAkcj1PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhiciksQ3I9e3Nob3VsZENvbnZlcnQ6ITB9LHdyPWZ1bmN0aW9uKHQpe2lmKHRoaXMudmFsdWU9dCx0aGlzLmRlcD1uZXcgdnIsdGhpcy52bUNvdW50PTAsQyh0LCJfX29iX18iLHRoaXMpLEFycmF5LmlzQXJyYXkodCkpeyhXbj9POlMpKHQsYnIsJHIpLHRoaXMub2JzZXJ2ZUFycmF5KHQpfWVsc2UgdGhpcy53YWxrKHQpfTt3ci5wcm90b3R5cGUud2Fsaz1mdW5jdGlvbih0KXtmb3IodmFyIGU9T2JqZWN0LmtleXModCksbj0wO248ZS5sZW5ndGg7bisrKUUodCxlW25dLHRbZVtuXV0pfSx3ci5wcm90b3R5cGUub2JzZXJ2ZUFycmF5PWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wLG49dC5sZW5ndGg7ZTxuO2UrKylUKHRbZV0pfTt2YXIgeHI9Sm4ub3B0aW9uTWVyZ2VTdHJhdGVnaWVzO3hyLmRhdGE9ZnVuY3Rpb24odCxlLG4pe3JldHVybiBuP00odCxlLG4pOmUmJiJmdW5jdGlvbiIhPXR5cGVvZiBlP3Q6TSh0LGUpfSxLbi5mb3JFYWNoKGZ1bmN0aW9uKHQpe3hyW3RdPUR9KSx6bi5mb3JFYWNoKGZ1bmN0aW9uKHQpe3hyW3QrInMiXT1QfSkseHIud2F0Y2g9ZnVuY3Rpb24odCxlLG4scil7aWYodD09PWlyJiYodD12b2lkIDApLGU9PT1pciYmKGU9dm9pZCAwKSwhZSlyZXR1cm4gT2JqZWN0LmNyZWF0ZSh0fHxudWxsKTtpZighdClyZXR1cm4gZTt2YXIgaT17fTtoKGksdCk7Zm9yKHZhciBvIGluIGUpe3ZhciBhPWlbb10scz1lW29dO2EmJiFBcnJheS5pc0FycmF5KGEpJiYoYT1bYV0pLGlbb109YT9hLmNvbmNhdChzKTpBcnJheS5pc0FycmF5KHMpP3M6W3NdfXJldHVybiBpfSx4ci5wcm9wcz14ci5tZXRob2RzPXhyLmluamVjdD14ci5jb21wdXRlZD1mdW5jdGlvbih0LGUsbixyKXtpZighdClyZXR1cm4gZTt2YXIgaT1PYmplY3QuY3JlYXRlKG51bGwpO3JldHVybiBoKGksdCksZSYmaChpLGUpLGl9LHhyLnByb3ZpZGU9TTt2YXIga3IsQXIsT3I9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdm9pZCAwPT09ZT90OmV9LFNyPVtdLFRyPSExLEVyPSExO2lmKCJ1bmRlZmluZWQiIT10eXBlb2Ygc2V0SW1tZWRpYXRlJiZ3KHNldEltbWVkaWF0ZSkpQXI9ZnVuY3Rpb24oKXtzZXRJbW1lZGlhdGUoSil9O2Vsc2UgaWYoInVuZGVmaW5lZCI9PXR5cGVvZiBNZXNzYWdlQ2hhbm5lbHx8IXcoTWVzc2FnZUNoYW5uZWwpJiYiW29iamVjdCBNZXNzYWdlQ2hhbm5lbENvbnN0cnVjdG9yXSIhPT1NZXNzYWdlQ2hhbm5lbC50b1N0cmluZygpKUFyPWZ1bmN0aW9uKCl7c2V0VGltZW91dChKLDApfTtlbHNle3ZhciBqcj1uZXcgTWVzc2FnZUNoYW5uZWwsTnI9anIucG9ydDI7anIucG9ydDEub25tZXNzYWdlPUosQXI9ZnVuY3Rpb24oKXtOci5wb3N0TWVzc2FnZSgxKX19aWYoInVuZGVmaW5lZCIhPXR5cGVvZiBQcm9taXNlJiZ3KFByb21pc2UpKXt2YXIgSXI9UHJvbWlzZS5yZXNvbHZlKCk7a3I9ZnVuY3Rpb24oKXtJci50aGVuKEopLHJyJiZzZXRUaW1lb3V0KHkpfX1lbHNlIGtyPUFyO3ZhciBMcixNcj1uZXcgY3IsRHI9cChmdW5jdGlvbih0KXt2YXIgZT0iJiI9PT10LmNoYXJBdCgwKSxuPSJ+Ij09PSh0PWU/dC5zbGljZSgxKTp0KS5jaGFyQXQoMCkscj0iISI9PT0odD1uP3Quc2xpY2UoMSk6dCkuY2hhckF0KDApO3JldHVybiB0PXI/dC5zbGljZSgxKTp0LHtuYW1lOnQsb25jZTpuLGNhcHR1cmU6cixwYXNzaXZlOmV9fSksUHI9bnVsbCxGcj1bXSxScj1bXSxIcj17fSxCcj0hMSxVcj0hMSxWcj0wLHpyPTAsS3I9ZnVuY3Rpb24odCxlLG4scixpKXt0aGlzLnZtPXQsaSYmKHQuX3dhdGNoZXI9dGhpcyksdC5fd2F0Y2hlcnMucHVzaCh0aGlzKSxyPyh0aGlzLmRlZXA9ISFyLmRlZXAsdGhpcy51c2VyPSEhci51c2VyLHRoaXMubGF6eT0hIXIubGF6eSx0aGlzLnN5bmM9ISFyLnN5bmMpOnRoaXMuZGVlcD10aGlzLnVzZXI9dGhpcy5sYXp5PXRoaXMuc3luYz0hMSx0aGlzLmNiPW4sdGhpcy5pZD0rK3pyLHRoaXMuYWN0aXZlPSEwLHRoaXMuZGlydHk9dGhpcy5sYXp5LHRoaXMuZGVwcz1bXSx0aGlzLm5ld0RlcHM9W10sdGhpcy5kZXBJZHM9bmV3IGNyLHRoaXMubmV3RGVwSWRzPW5ldyBjcix0aGlzLmV4cHJlc3Npb249IiIsImZ1bmN0aW9uIj09dHlwZW9mIGU/dGhpcy5nZXR0ZXI9ZToodGhpcy5nZXR0ZXI9ZnVuY3Rpb24odCl7aWYoIXFuLnRlc3QodCkpe3ZhciBlPXQuc3BsaXQoIi4iKTtyZXR1cm4gZnVuY3Rpb24odCl7Zm9yKHZhciBuPTA7bjxlLmxlbmd0aDtuKyspe2lmKCF0KXJldHVybjt0PXRbZVtuXV19cmV0dXJuIHR9fX0oZSksdGhpcy5nZXR0ZXJ8fCh0aGlzLmdldHRlcj1mdW5jdGlvbigpe30pKSx0aGlzLnZhbHVlPXRoaXMubGF6eT92b2lkIDA6dGhpcy5nZXQoKX07S3IucHJvdG90eXBlLmdldD1mdW5jdGlvbigpeyFmdW5jdGlvbih0KXt2ci50YXJnZXQmJmhyLnB1c2godnIudGFyZ2V0KSx2ci50YXJnZXQ9dH0odGhpcyk7dmFyIHQsZT10aGlzLnZtO3RyeXt0PXRoaXMuZ2V0dGVyLmNhbGwoZSxlKX1jYXRjaCh0KXtpZighdGhpcy51c2VyKXRocm93IHQ7Vih0LGUsJ2dldHRlciBmb3Igd2F0Y2hlciAiJyt0aGlzLmV4cHJlc3Npb24rJyInKX1maW5hbGx5e3RoaXMuZGVlcCYmVyh0KSx2ci50YXJnZXQ9aHIucG9wKCksdGhpcy5jbGVhbnVwRGVwcygpfXJldHVybiB0fSxLci5wcm90b3R5cGUuYWRkRGVwPWZ1bmN0aW9uKHQpe3ZhciBlPXQuaWQ7dGhpcy5uZXdEZXBJZHMuaGFzKGUpfHwodGhpcy5uZXdEZXBJZHMuYWRkKGUpLHRoaXMubmV3RGVwcy5wdXNoKHQpLHRoaXMuZGVwSWRzLmhhcyhlKXx8dC5hZGRTdWIodGhpcykpfSxLci5wcm90b3R5cGUuY2xlYW51cERlcHM9ZnVuY3Rpb24oKXtmb3IodmFyIHQ9dGhpcy5kZXBzLmxlbmd0aDt0LS07KXt2YXIgZT10aGlzLmRlcHNbdF07dGhpcy5uZXdEZXBJZHMuaGFzKGUuaWQpfHxlLnJlbW92ZVN1Yih0aGlzKX12YXIgbj10aGlzLmRlcElkczt0aGlzLmRlcElkcz10aGlzLm5ld0RlcElkcyx0aGlzLm5ld0RlcElkcz1uLHRoaXMubmV3RGVwSWRzLmNsZWFyKCksbj10aGlzLmRlcHMsdGhpcy5kZXBzPXRoaXMubmV3RGVwcyx0aGlzLm5ld0RlcHM9bix0aGlzLm5ld0RlcHMubGVuZ3RoPTB9LEtyLnByb3RvdHlwZS51cGRhdGU9ZnVuY3Rpb24oKXt0aGlzLmxhenk/dGhpcy5kaXJ0eT0hMDp0aGlzLnN5bmM/dGhpcy5ydW4oKTpmdW5jdGlvbih0KXt2YXIgZT10LmlkO2lmKG51bGw9PUhyW2VdKXtpZihIcltlXT0hMCxVcil7Zm9yKHZhciBuPUZyLmxlbmd0aC0xO24+VnImJkZyW25dLmlkPnQuaWQ7KW4tLTtGci5zcGxpY2UobisxLDAsdCl9ZWxzZSBGci5wdXNoKHQpO0JyfHwoQnI9ITAscShodCkpfX0odGhpcyl9LEtyLnByb3RvdHlwZS5ydW49ZnVuY3Rpb24oKXtpZih0aGlzLmFjdGl2ZSl7dmFyIHQ9dGhpcy5nZXQoKTtpZih0IT09dGhpcy52YWx1ZXx8aSh0KXx8dGhpcy5kZWVwKXt2YXIgZT10aGlzLnZhbHVlO2lmKHRoaXMudmFsdWU9dCx0aGlzLnVzZXIpdHJ5e3RoaXMuY2IuY2FsbCh0aGlzLnZtLHQsZSl9Y2F0Y2godCl7Vih0LHRoaXMudm0sJ2NhbGxiYWNrIGZvciB3YXRjaGVyICInK3RoaXMuZXhwcmVzc2lvbisnIicpfWVsc2UgdGhpcy5jYi5jYWxsKHRoaXMudm0sdCxlKX19fSxLci5wcm90b3R5cGUuZXZhbHVhdGU9ZnVuY3Rpb24oKXt0aGlzLnZhbHVlPXRoaXMuZ2V0KCksdGhpcy5kaXJ0eT0hMX0sS3IucHJvdG90eXBlLmRlcGVuZD1mdW5jdGlvbigpe2Zvcih2YXIgdD10aGlzLmRlcHMubGVuZ3RoO3QtLTspdGhpcy5kZXBzW3RdLmRlcGVuZCgpfSxLci5wcm90b3R5cGUudGVhcmRvd249ZnVuY3Rpb24oKXtpZih0aGlzLmFjdGl2ZSl7dGhpcy52bS5faXNCZWluZ0Rlc3Ryb3llZHx8bCh0aGlzLnZtLl93YXRjaGVycyx0aGlzKTtmb3IodmFyIHQ9dGhpcy5kZXBzLmxlbmd0aDt0LS07KXRoaXMuZGVwc1t0XS5yZW1vdmVTdWIodGhpcyk7dGhpcy5hY3RpdmU9ITF9fTt2YXIgSnI9e2VudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLGdldDp5LHNldDp5fSxxcj17bGF6eTohMH07TnQoSXQucHJvdG90eXBlKTt2YXIgV3I9e2luaXQ6ZnVuY3Rpb24odCxuLHIsaSl7aWYoIXQuY29tcG9uZW50SW5zdGFuY2V8fHQuY29tcG9uZW50SW5zdGFuY2UuX2lzRGVzdHJveWVkKXsodC5jb21wb25lbnRJbnN0YW5jZT1mdW5jdGlvbih0LG4scixpKXt2YXIgbz17X2lzQ29tcG9uZW50OiEwLHBhcmVudDpuLF9wYXJlbnRWbm9kZTp0LF9wYXJlbnRFbG06cnx8bnVsbCxfcmVmRWxtOml8fG51bGx9LGE9dC5kYXRhLmlubGluZVRlbXBsYXRlO3JldHVybiBlKGEpJiYoby5yZW5kZXI9YS5yZW5kZXIsby5zdGF0aWNSZW5kZXJGbnM9YS5zdGF0aWNSZW5kZXJGbnMpLG5ldyB0LmNvbXBvbmVudE9wdGlvbnMuQ3RvcihvKX0odCxQcixyLGkpKS4kbW91bnQobj90LmVsbTp2b2lkIDAsbil9ZWxzZSBpZih0LmRhdGEua2VlcEFsaXZlKXt2YXIgbz10O1dyLnByZXBhdGNoKG8sbyl9fSxwcmVwYXRjaDpmdW5jdGlvbih0LGUpe3ZhciBuPWUuY29tcG9uZW50T3B0aW9uczshZnVuY3Rpb24odCxlLG4scixpKXt2YXIgbz0hIShpfHx0LiRvcHRpb25zLl9yZW5kZXJDaGlsZHJlbnx8ci5kYXRhLnNjb3BlZFNsb3RzfHx0LiRzY29wZWRTbG90cyE9PWpuKTtpZih0LiRvcHRpb25zLl9wYXJlbnRWbm9kZT1yLHQuJHZub2RlPXIsdC5fdm5vZGUmJih0Ll92bm9kZS5wYXJlbnQ9ciksdC4kb3B0aW9ucy5fcmVuZGVyQ2hpbGRyZW49aSx0LiRhdHRycz1yLmRhdGEmJnIuZGF0YS5hdHRyc3x8am4sdC4kbGlzdGVuZXJzPW58fGpuLGUmJnQuJG9wdGlvbnMucHJvcHMpe0NyLnNob3VsZENvbnZlcnQ9ITE7Zm9yKHZhciBhPXQuX3Byb3BzLHM9dC4kb3B0aW9ucy5fcHJvcEtleXN8fFtdLGM9MDtjPHMubGVuZ3RoO2MrKyl7dmFyIHU9c1tjXTthW3VdPUgodSx0LiRvcHRpb25zLnByb3BzLGUsdCl9Q3Iuc2hvdWxkQ29udmVydD0hMCx0LiRvcHRpb25zLnByb3BzRGF0YT1lfWlmKG4pe3ZhciBsPXQuJG9wdGlvbnMuX3BhcmVudExpc3RlbmVyczt0LiRvcHRpb25zLl9wYXJlbnRMaXN0ZW5lcnM9bixzdCh0LG4sbCl9byYmKHQuJHNsb3RzPWN0KGksci5jb250ZXh0KSx0LiRmb3JjZVVwZGF0ZSgpKX0oZS5jb21wb25lbnRJbnN0YW5jZT10LmNvbXBvbmVudEluc3RhbmNlLG4ucHJvcHNEYXRhLG4ubGlzdGVuZXJzLGUsbi5jaGlsZHJlbil9LGluc2VydDpmdW5jdGlvbih0KXt2YXIgZT10LmNvbnRleHQsbj10LmNvbXBvbmVudEluc3RhbmNlO24uX2lzTW91bnRlZHx8KG4uX2lzTW91bnRlZD0hMCx2dChuLCJtb3VudGVkIikpLHQuZGF0YS5rZWVwQWxpdmUmJihlLl9pc01vdW50ZWQ/ZnVuY3Rpb24odCl7dC5faW5hY3RpdmU9ITEsUnIucHVzaCh0KX0obik6cHQobiwhMCkpfSxkZXN0cm95OmZ1bmN0aW9uKHQpe3ZhciBlPXQuY29tcG9uZW50SW5zdGFuY2U7ZS5faXNEZXN0cm95ZWR8fCh0LmRhdGEua2VlcEFsaXZlP2R0KGUsITApOmUuJGRlc3Ryb3koKSl9fSxHcj1PYmplY3Qua2V5cyhXciksWnI9MSxYcj0yLFlyPTA7IWZ1bmN0aW9uKHQpe3QucHJvdG90eXBlLl9pbml0PWZ1bmN0aW9uKHQpe3RoaXMuX3VpZD1ZcisrLHRoaXMuX2lzVnVlPSEwLHQmJnQuX2lzQ29tcG9uZW50P2Z1bmN0aW9uKHQsZSl7dmFyIG49dC4kb3B0aW9ucz1PYmplY3QuY3JlYXRlKHQuY29uc3RydWN0b3Iub3B0aW9ucykscj1lLl9wYXJlbnRWbm9kZTtuLnBhcmVudD1lLnBhcmVudCxuLl9wYXJlbnRWbm9kZT1yLG4uX3BhcmVudEVsbT1lLl9wYXJlbnRFbG0sbi5fcmVmRWxtPWUuX3JlZkVsbTt2YXIgaT1yLmNvbXBvbmVudE9wdGlvbnM7bi5wcm9wc0RhdGE9aS5wcm9wc0RhdGEsbi5fcGFyZW50TGlzdGVuZXJzPWkubGlzdGVuZXJzLG4uX3JlbmRlckNoaWxkcmVuPWkuY2hpbGRyZW4sbi5fY29tcG9uZW50VGFnPWkudGFnLGUucmVuZGVyJiYobi5yZW5kZXI9ZS5yZW5kZXIsbi5zdGF0aWNSZW5kZXJGbnM9ZS5zdGF0aWNSZW5kZXJGbnMpfSh0aGlzLHQpOnRoaXMuJG9wdGlvbnM9RihGdCh0aGlzLmNvbnN0cnVjdG9yKSx0fHx7fSx0aGlzKSx0aGlzLl9yZW5kZXJQcm94eT10aGlzLHRoaXMuX3NlbGY9dGhpcyxmdW5jdGlvbih0KXt2YXIgZT10LiRvcHRpb25zLG49ZS5wYXJlbnQ7aWYobiYmIWUuYWJzdHJhY3Qpe2Zvcig7bi4kb3B0aW9ucy5hYnN0cmFjdCYmbi4kcGFyZW50OyluPW4uJHBhcmVudDtuLiRjaGlsZHJlbi5wdXNoKHQpfXQuJHBhcmVudD1uLHQuJHJvb3Q9bj9uLiRyb290OnQsdC4kY2hpbGRyZW49W10sdC4kcmVmcz17fSx0Ll93YXRjaGVyPW51bGwsdC5faW5hY3RpdmU9bnVsbCx0Ll9kaXJlY3RJbmFjdGl2ZT0hMSx0Ll9pc01vdW50ZWQ9ITEsdC5faXNEZXN0cm95ZWQ9ITEsdC5faXNCZWluZ0Rlc3Ryb3llZD0hMX0odGhpcyksZnVuY3Rpb24odCl7dC5fZXZlbnRzPU9iamVjdC5jcmVhdGUobnVsbCksdC5faGFzSG9va0V2ZW50PSExO3ZhciBlPXQuJG9wdGlvbnMuX3BhcmVudExpc3RlbmVycztlJiZzdCh0LGUpfSh0aGlzKSxmdW5jdGlvbih0KXt0Ll92bm9kZT1udWxsLHQuX3N0YXRpY1RyZWVzPW51bGw7dmFyIGU9dC4kb3B0aW9ucyxuPXQuJHZub2RlPWUuX3BhcmVudFZub2RlLHI9biYmbi5jb250ZXh0O3QuJHNsb3RzPWN0KGUuX3JlbmRlckNoaWxkcmVuLHIpLHQuJHNjb3BlZFNsb3RzPWpuLHQuX2M9ZnVuY3Rpb24oZSxuLHIsaSl7cmV0dXJuIER0KHQsZSxuLHIsaSwhMSl9LHQuJGNyZWF0ZUVsZW1lbnQ9ZnVuY3Rpb24oZSxuLHIsaSl7cmV0dXJuIER0KHQsZSxuLHIsaSwhMCl9O3ZhciBpPW4mJm4uZGF0YTtFKHQsIiRhdHRycyIsaSYmaS5hdHRyc3x8am4sMCwhMCksRSh0LCIkbGlzdGVuZXJzIixlLl9wYXJlbnRMaXN0ZW5lcnN8fGpuLDAsITApfSh0aGlzKSx2dCh0aGlzLCJiZWZvcmVDcmVhdGUiKSxmdW5jdGlvbih0KXt2YXIgZT0kdCh0LiRvcHRpb25zLmluamVjdCx0KTtlJiYoQ3Iuc2hvdWxkQ29udmVydD0hMSxPYmplY3Qua2V5cyhlKS5mb3JFYWNoKGZ1bmN0aW9uKG4pe0UodCxuLGVbbl0pfSksQ3Iuc2hvdWxkQ29udmVydD0hMCl9KHRoaXMpLHl0KHRoaXMpLGZ1bmN0aW9uKHQpe3ZhciBlPXQuJG9wdGlvbnMucHJvdmlkZTtlJiYodC5fcHJvdmlkZWQ9ImZ1bmN0aW9uIj09dHlwZW9mIGU/ZS5jYWxsKHQpOmUpfSh0aGlzKSx2dCh0aGlzLCJjcmVhdGVkIiksdGhpcy4kb3B0aW9ucy5lbCYmdGhpcy4kbW91bnQodGhpcy4kb3B0aW9ucy5lbCl9fShSdCksZnVuY3Rpb24odCl7dmFyIGU9e307ZS5nZXQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGF0YX07dmFyIG49e307bi5nZXQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcHJvcHN9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSwiJGRhdGEiLGUpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSwiJHByb3BzIixuKSx0LnByb3RvdHlwZS4kc2V0PWosdC5wcm90b3R5cGUuJGRlbGV0ZT1OLHQucHJvdG90eXBlLiR3YXRjaD1mdW5jdGlvbih0LGUsbil7aWYobyhlKSlyZXR1cm4gYnQodGhpcyx0LGUsbik7KG49bnx8e30pLnVzZXI9ITA7dmFyIHI9bmV3IEtyKHRoaXMsdCxlLG4pO3JldHVybiBuLmltbWVkaWF0ZSYmZS5jYWxsKHRoaXMsci52YWx1ZSksZnVuY3Rpb24oKXtyLnRlYXJkb3duKCl9fX0oUnQpLGZ1bmN0aW9uKHQpe3ZhciBlPS9eaG9vazovO3QucHJvdG90eXBlLiRvbj1mdW5jdGlvbih0LG4pe2lmKEFycmF5LmlzQXJyYXkodCkpZm9yKHZhciByPTAsaT10Lmxlbmd0aDtyPGk7cisrKXRoaXMuJG9uKHRbcl0sbik7ZWxzZSh0aGlzLl9ldmVudHNbdF18fCh0aGlzLl9ldmVudHNbdF09W10pKS5wdXNoKG4pLGUudGVzdCh0KSYmKHRoaXMuX2hhc0hvb2tFdmVudD0hMCk7cmV0dXJuIHRoaXN9LHQucHJvdG90eXBlLiRvbmNlPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbigpe3IuJG9mZih0LG4pLGUuYXBwbHkocixhcmd1bWVudHMpfXZhciByPXRoaXM7cmV0dXJuIG4uZm49ZSxyLiRvbih0LG4pLHJ9LHQucHJvdG90eXBlLiRvZmY9ZnVuY3Rpb24odCxlKXtpZighYXJndW1lbnRzLmxlbmd0aClyZXR1cm4gdGhpcy5fZXZlbnRzPU9iamVjdC5jcmVhdGUobnVsbCksdGhpcztpZihBcnJheS5pc0FycmF5KHQpKXtmb3IodmFyIG49MCxyPXQubGVuZ3RoO248cjtuKyspdGhpcy4kb2ZmKHRbbl0sZSk7cmV0dXJuIHRoaXN9dmFyIGk9dGhpcy5fZXZlbnRzW3RdO2lmKCFpKXJldHVybiB0aGlzO2lmKCFlKXJldHVybiB0aGlzLl9ldmVudHNbdF09bnVsbCx0aGlzO2lmKGUpZm9yKHZhciBvLGE9aS5sZW5ndGg7YS0tOylpZigobz1pW2FdKT09PWV8fG8uZm49PT1lKXtpLnNwbGljZShhLDEpO2JyZWFrfXJldHVybiB0aGlzfSx0LnByb3RvdHlwZS4kZW1pdD1mdW5jdGlvbih0KXt2YXIgZT10aGlzLG49ZS5fZXZlbnRzW3RdO2lmKG4pe249bi5sZW5ndGg+MT92KG4pOm47Zm9yKHZhciByPXYoYXJndW1lbnRzLDEpLGk9MCxvPW4ubGVuZ3RoO2k8bztpKyspdHJ5e25baV0uYXBwbHkoZSxyKX1jYXRjaChuKXtWKG4sZSwnZXZlbnQgaGFuZGxlciBmb3IgIicrdCsnIicpfX1yZXR1cm4gZX19KFJ0KSxmdW5jdGlvbih0KXt0LnByb3RvdHlwZS5fdXBkYXRlPWZ1bmN0aW9uKHQsZSl7dGhpcy5faXNNb3VudGVkJiZ2dCh0aGlzLCJiZWZvcmVVcGRhdGUiKTt2YXIgbj10aGlzLiRlbCxyPXRoaXMuX3Zub2RlLGk9UHI7UHI9dGhpcyx0aGlzLl92bm9kZT10LHI/dGhpcy4kZWw9dGhpcy5fX3BhdGNoX18ocix0KToodGhpcy4kZWw9dGhpcy5fX3BhdGNoX18odGhpcy4kZWwsdCxlLCExLHRoaXMuJG9wdGlvbnMuX3BhcmVudEVsbSx0aGlzLiRvcHRpb25zLl9yZWZFbG0pLHRoaXMuJG9wdGlvbnMuX3BhcmVudEVsbT10aGlzLiRvcHRpb25zLl9yZWZFbG09bnVsbCksUHI9aSxuJiYobi5fX3Z1ZV9fPW51bGwpLHRoaXMuJGVsJiYodGhpcy4kZWwuX192dWVfXz10aGlzKSx0aGlzLiR2bm9kZSYmdGhpcy4kcGFyZW50JiZ0aGlzLiR2bm9kZT09PXRoaXMuJHBhcmVudC5fdm5vZGUmJih0aGlzLiRwYXJlbnQuJGVsPXRoaXMuJGVsKX0sdC5wcm90b3R5cGUuJGZvcmNlVXBkYXRlPWZ1bmN0aW9uKCl7dGhpcy5fd2F0Y2hlciYmdGhpcy5fd2F0Y2hlci51cGRhdGUoKX0sdC5wcm90b3R5cGUuJGRlc3Ryb3k9ZnVuY3Rpb24oKXtpZighdGhpcy5faXNCZWluZ0Rlc3Ryb3llZCl7dnQodGhpcywiYmVmb3JlRGVzdHJveSIpLHRoaXMuX2lzQmVpbmdEZXN0cm95ZWQ9ITA7dmFyIHQ9dGhpcy4kcGFyZW50OyF0fHx0Ll9pc0JlaW5nRGVzdHJveWVkfHx0aGlzLiRvcHRpb25zLmFic3RyYWN0fHxsKHQuJGNoaWxkcmVuLHRoaXMpLHRoaXMuX3dhdGNoZXImJnRoaXMuX3dhdGNoZXIudGVhcmRvd24oKTtmb3IodmFyIGU9dGhpcy5fd2F0Y2hlcnMubGVuZ3RoO2UtLTspdGhpcy5fd2F0Y2hlcnNbZV0udGVhcmRvd24oKTt0aGlzLl9kYXRhLl9fb2JfXyYmdGhpcy5fZGF0YS5fX29iX18udm1Db3VudC0tLHRoaXMuX2lzRGVzdHJveWVkPSEwLHRoaXMuX19wYXRjaF9fKHRoaXMuX3Zub2RlLG51bGwpLHZ0KHRoaXMsImRlc3Ryb3llZCIpLHRoaXMuJG9mZigpLHRoaXMuJGVsJiYodGhpcy4kZWwuX192dWVfXz1udWxsKSx0aGlzLiR2bm9kZSYmKHRoaXMuJHZub2RlLnBhcmVudD1udWxsKX19fShSdCksZnVuY3Rpb24odCl7TnQodC5wcm90b3R5cGUpLHQucHJvdG90eXBlLiRuZXh0VGljaz1mdW5jdGlvbih0KXtyZXR1cm4gcSh0LHRoaXMpfSx0LnByb3RvdHlwZS5fcmVuZGVyPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxlPXQuJG9wdGlvbnMsbj1lLnJlbmRlcixyPWUuX3BhcmVudFZub2RlO2lmKHQuX2lzTW91bnRlZClmb3IodmFyIGkgaW4gdC4kc2xvdHMpe3ZhciBvPXQuJHNsb3RzW2ldOyhvLl9yZW5kZXJlZHx8b1swXSYmb1swXS5lbG0pJiYodC4kc2xvdHNbaV09QShvLCEwKSl9dC4kc2NvcGVkU2xvdHM9ciYmci5kYXRhLnNjb3BlZFNsb3RzfHxqbix0LiR2bm9kZT1yO3ZhciBhO3RyeXthPW4uY2FsbCh0Ll9yZW5kZXJQcm94eSx0LiRjcmVhdGVFbGVtZW50KX1jYXRjaChlKXtWKGUsdCwicmVuZGVyIiksYT10Ll92bm9kZX1yZXR1cm4gYSBpbnN0YW5jZW9mIG1yfHwoYT1ncigpKSxhLnBhcmVudD1yLGF9fShSdCk7dmFyIFFyPVtTdHJpbmcsUmVnRXhwLEFycmF5XSx0aT17S2VlcEFsaXZlOntuYW1lOiJrZWVwLWFsaXZlIixhYnN0cmFjdDohMCxwcm9wczp7aW5jbHVkZTpRcixleGNsdWRlOlFyLG1heDpbU3RyaW5nLE51bWJlcl19LGNyZWF0ZWQ6ZnVuY3Rpb24oKXt0aGlzLmNhY2hlPU9iamVjdC5jcmVhdGUobnVsbCksdGhpcy5rZXlzPVtdfSxkZXN0cm95ZWQ6ZnVuY3Rpb24oKXtmb3IodmFyIHQgaW4gdGhpcy5jYWNoZSl6dCh0aGlzLmNhY2hlLHQsdGhpcy5rZXlzKX0sd2F0Y2g6e2luY2x1ZGU6ZnVuY3Rpb24odCl7VnQodGhpcyxmdW5jdGlvbihlKXtyZXR1cm4gVXQodCxlKX0pfSxleGNsdWRlOmZ1bmN0aW9uKHQpe1Z0KHRoaXMsZnVuY3Rpb24oZSl7cmV0dXJuIVV0KHQsZSl9KX19LHJlbmRlcjpmdW5jdGlvbigpe3ZhciB0PXRoaXMuJHNsb3RzLmRlZmF1bHQsZT1pdCh0KSxuPWUmJmUuY29tcG9uZW50T3B0aW9ucztpZihuKXt2YXIgcj1CdChuKSxpPXRoaXMuaW5jbHVkZSxvPXRoaXMuZXhjbHVkZTtpZihpJiYoIXJ8fCFVdChpLHIpKXx8byYmciYmVXQobyxyKSlyZXR1cm4gZTt2YXIgYT10aGlzLmNhY2hlLHM9dGhpcy5rZXlzLGM9bnVsbD09ZS5rZXk/bi5DdG9yLmNpZCsobi50YWc/Ijo6IituLnRhZzoiIik6ZS5rZXk7YVtjXT8oZS5jb21wb25lbnRJbnN0YW5jZT1hW2NdLmNvbXBvbmVudEluc3RhbmNlLGwocyxjKSxzLnB1c2goYykpOihhW2NdPWUscy5wdXNoKGMpLHRoaXMubWF4JiZzLmxlbmd0aD5wYXJzZUludCh0aGlzLm1heCkmJnp0KGEsc1swXSxzLHRoaXMuX3Zub2RlKSksZS5kYXRhLmtlZXBBbGl2ZT0hMH1yZXR1cm4gZXx8dCYmdFswXX19fTshZnVuY3Rpb24odCl7dmFyIGU9e307ZS5nZXQ9ZnVuY3Rpb24oKXtyZXR1cm4gSm59LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJjb25maWciLGUpLHQudXRpbD17d2FybjpwcixleHRlbmQ6aCxtZXJnZU9wdGlvbnM6RixkZWZpbmVSZWFjdGl2ZTpFfSx0LnNldD1qLHQuZGVsZXRlPU4sdC5uZXh0VGljaz1xLHQub3B0aW9ucz1PYmplY3QuY3JlYXRlKG51bGwpLHpuLmZvckVhY2goZnVuY3Rpb24oZSl7dC5vcHRpb25zW2UrInMiXT1PYmplY3QuY3JlYXRlKG51bGwpfSksdC5vcHRpb25zLl9iYXNlPXQsaCh0Lm9wdGlvbnMuY29tcG9uZW50cyx0aSksZnVuY3Rpb24odCl7dC51c2U9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5faW5zdGFsbGVkUGx1Z2luc3x8KHRoaXMuX2luc3RhbGxlZFBsdWdpbnM9W10pO2lmKGUuaW5kZXhPZih0KT4tMSlyZXR1cm4gdGhpczt2YXIgbj12KGFyZ3VtZW50cywxKTtyZXR1cm4gbi51bnNoaWZ0KHRoaXMpLCJmdW5jdGlvbiI9PXR5cGVvZiB0Lmluc3RhbGw/dC5pbnN0YWxsLmFwcGx5KHQsbik6ImZ1bmN0aW9uIj09dHlwZW9mIHQmJnQuYXBwbHkobnVsbCxuKSxlLnB1c2godCksdGhpc319KHQpLGZ1bmN0aW9uKHQpe3QubWl4aW49ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMub3B0aW9ucz1GKHRoaXMub3B0aW9ucyx0KSx0aGlzfX0odCksSHQodCksZnVuY3Rpb24odCl7em4uZm9yRWFjaChmdW5jdGlvbihlKXt0W2VdPWZ1bmN0aW9uKHQsbil7cmV0dXJuIG4/KCJjb21wb25lbnQiPT09ZSYmbyhuKSYmKG4ubmFtZT1uLm5hbWV8fHQsbj10aGlzLm9wdGlvbnMuX2Jhc2UuZXh0ZW5kKG4pKSwiZGlyZWN0aXZlIj09PWUmJiJmdW5jdGlvbiI9PXR5cGVvZiBuJiYobj17YmluZDpuLHVwZGF0ZTpufSksdGhpcy5vcHRpb25zW2UrInMiXVt0XT1uLG4pOnRoaXMub3B0aW9uc1tlKyJzIl1bdF19fSl9KHQpfShSdCksT2JqZWN0LmRlZmluZVByb3BlcnR5KFJ0LnByb3RvdHlwZSwiJGlzU2VydmVyIix7Z2V0OnVyfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KFJ0LnByb3RvdHlwZSwiJHNzckNvbnRleHQiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kdm5vZGUmJnRoaXMuJHZub2RlLnNzckNvbnRleHR9fSksUnQudmVyc2lvbj0iMi41LjEzIjt2YXIgZWksbmkscmksaWksb2ksYWksc2ksY2ksdWk9dSgic3R5bGUsY2xhc3MiKSxsaT11KCJpbnB1dCx0ZXh0YXJlYSxvcHRpb24sc2VsZWN0LHByb2dyZXNzIiksZmk9ZnVuY3Rpb24odCxlLG4pe3JldHVybiJ2YWx1ZSI9PT1uJiZsaSh0KSYmImJ1dHRvbiIhPT1lfHwic2VsZWN0ZWQiPT09biYmIm9wdGlvbiI9PT10fHwiY2hlY2tlZCI9PT1uJiYiaW5wdXQiPT09dHx8Im11dGVkIj09PW4mJiJ2aWRlbyI9PT10fSxwaT11KCJjb250ZW50ZWRpdGFibGUsZHJhZ2dhYmxlLHNwZWxsY2hlY2siKSxkaT11KCJhbGxvd2Z1bGxzY3JlZW4sYXN5bmMsYXV0b2ZvY3VzLGF1dG9wbGF5LGNoZWNrZWQsY29tcGFjdCxjb250cm9scyxkZWNsYXJlLGRlZmF1bHQsZGVmYXVsdGNoZWNrZWQsZGVmYXVsdG11dGVkLGRlZmF1bHRzZWxlY3RlZCxkZWZlcixkaXNhYmxlZCxlbmFibGVkLGZvcm1ub3ZhbGlkYXRlLGhpZGRlbixpbmRldGVybWluYXRlLGluZXJ0LGlzbWFwLGl0ZW1zY29wZSxsb29wLG11bHRpcGxlLG11dGVkLG5vaHJlZixub3Jlc2l6ZSxub3NoYWRlLG5vdmFsaWRhdGUsbm93cmFwLG9wZW4scGF1c2VvbmV4aXQscmVhZG9ubHkscmVxdWlyZWQscmV2ZXJzZWQsc2NvcGVkLHNlYW1sZXNzLHNlbGVjdGVkLHNvcnRhYmxlLHRyYW5zbGF0ZSx0cnVlc3BlZWQsdHlwZW11c3RtYXRjaCx2aXNpYmxlIiksdmk9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiLGhpPWZ1bmN0aW9uKHQpe3JldHVybiI6Ij09PXQuY2hhckF0KDUpJiYieGxpbmsiPT09dC5zbGljZSgwLDUpfSxtaT1mdW5jdGlvbih0KXtyZXR1cm4gaGkodCk/dC5zbGljZSg2LHQubGVuZ3RoKToiIn0seWk9ZnVuY3Rpb24odCl7cmV0dXJuIG51bGw9PXR8fCExPT09dH0sZ2k9e3N2ZzoiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLG1hdGg6Imh0dHA6Ly93d3cudzMub3JnLzE5OTgvTWF0aC9NYXRoTUwifSxfaT11KCJodG1sLGJvZHksYmFzZSxoZWFkLGxpbmssbWV0YSxzdHlsZSx0aXRsZSxhZGRyZXNzLGFydGljbGUsYXNpZGUsZm9vdGVyLGhlYWRlcixoMSxoMixoMyxoNCxoNSxoNixoZ3JvdXAsbmF2LHNlY3Rpb24sZGl2LGRkLGRsLGR0LGZpZ2NhcHRpb24sZmlndXJlLHBpY3R1cmUsaHIsaW1nLGxpLG1haW4sb2wscCxwcmUsdWwsYSxiLGFiYnIsYmRpLGJkbyxicixjaXRlLGNvZGUsZGF0YSxkZm4sZW0saSxrYmQsbWFyayxxLHJwLHJ0LHJ0YyxydWJ5LHMsc2FtcCxzbWFsbCxzcGFuLHN0cm9uZyxzdWIsc3VwLHRpbWUsdSx2YXIsd2JyLGFyZWEsYXVkaW8sbWFwLHRyYWNrLHZpZGVvLGVtYmVkLG9iamVjdCxwYXJhbSxzb3VyY2UsY2FudmFzLHNjcmlwdCxub3NjcmlwdCxkZWwsaW5zLGNhcHRpb24sY29sLGNvbGdyb3VwLHRhYmxlLHRoZWFkLHRib2R5LHRkLHRoLHRyLGJ1dHRvbixkYXRhbGlzdCxmaWVsZHNldCxmb3JtLGlucHV0LGxhYmVsLGxlZ2VuZCxtZXRlcixvcHRncm91cCxvcHRpb24sb3V0cHV0LHByb2dyZXNzLHNlbGVjdCx0ZXh0YXJlYSxkZXRhaWxzLGRpYWxvZyxtZW51LG1lbnVpdGVtLHN1bW1hcnksY29udGVudCxlbGVtZW50LHNoYWRvdyx0ZW1wbGF0ZSxibG9ja3F1b3RlLGlmcmFtZSx0Zm9vdCIpLGJpPXUoInN2ZyxhbmltYXRlLGNpcmNsZSxjbGlwcGF0aCxjdXJzb3IsZGVmcyxkZXNjLGVsbGlwc2UsZmlsdGVyLGZvbnQtZmFjZSxmb3JlaWduT2JqZWN0LGcsZ2x5cGgsaW1hZ2UsbGluZSxtYXJrZXIsbWFzayxtaXNzaW5nLWdseXBoLHBhdGgscGF0dGVybixwb2x5Z29uLHBvbHlsaW5lLHJlY3Qsc3dpdGNoLHN5bWJvbCx0ZXh0LHRleHRwYXRoLHRzcGFuLHVzZSx2aWV3IiwhMCksJGk9ZnVuY3Rpb24odCl7cmV0dXJuIF9pKHQpfHxiaSh0KX0sQ2k9T2JqZWN0LmNyZWF0ZShudWxsKSx3aT11KCJ0ZXh0LG51bWJlcixwYXNzd29yZCxzZWFyY2gsZW1haWwsdGVsLHVybCIpLHhpPU9iamVjdC5mcmVlemUoe2NyZWF0ZUVsZW1lbnQ6ZnVuY3Rpb24odCxlKXt2YXIgbj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KHQpO3JldHVybiJzZWxlY3QiIT09dD9uOihlLmRhdGEmJmUuZGF0YS5hdHRycyYmdm9pZCAwIT09ZS5kYXRhLmF0dHJzLm11bHRpcGxlJiZuLnNldEF0dHJpYnV0ZSgibXVsdGlwbGUiLCJtdWx0aXBsZSIpLG4pfSxjcmVhdGVFbGVtZW50TlM6ZnVuY3Rpb24odCxlKXtyZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKGdpW3RdLGUpfSxjcmVhdGVUZXh0Tm9kZTpmdW5jdGlvbih0KXtyZXR1cm4gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodCl9LGNyZWF0ZUNvbW1lbnQ6ZnVuY3Rpb24odCl7cmV0dXJuIGRvY3VtZW50LmNyZWF0ZUNvbW1lbnQodCl9LGluc2VydEJlZm9yZTpmdW5jdGlvbih0LGUsbil7dC5pbnNlcnRCZWZvcmUoZSxuKX0scmVtb3ZlQ2hpbGQ6ZnVuY3Rpb24odCxlKXt0LnJlbW92ZUNoaWxkKGUpfSxhcHBlbmRDaGlsZDpmdW5jdGlvbih0LGUpe3QuYXBwZW5kQ2hpbGQoZSl9LHBhcmVudE5vZGU6ZnVuY3Rpb24odCl7cmV0dXJuIHQucGFyZW50Tm9kZX0sbmV4dFNpYmxpbmc6ZnVuY3Rpb24odCl7cmV0dXJuIHQubmV4dFNpYmxpbmd9LHRhZ05hbWU6ZnVuY3Rpb24odCl7cmV0dXJuIHQudGFnTmFtZX0sc2V0VGV4dENvbnRlbnQ6ZnVuY3Rpb24odCxlKXt0LnRleHRDb250ZW50PWV9LHNldEF0dHJpYnV0ZTpmdW5jdGlvbih0LGUsbil7dC5zZXRBdHRyaWJ1dGUoZSxuKX19KSxraT17Y3JlYXRlOmZ1bmN0aW9uKHQsZSl7WHQoZSl9LHVwZGF0ZTpmdW5jdGlvbih0LGUpe3QuZGF0YS5yZWYhPT1lLmRhdGEucmVmJiYoWHQodCwhMCksWHQoZSkpfSxkZXN0cm95OmZ1bmN0aW9uKHQpe1h0KHQsITApfX0sQWk9bmV3IG1yKCIiLHt9LFtdKSxPaT1bImNyZWF0ZSIsImFjdGl2YXRlIiwidXBkYXRlIiwicmVtb3ZlIiwiZGVzdHJveSJdLFNpPXtjcmVhdGU6dGUsdXBkYXRlOnRlLGRlc3Ryb3k6ZnVuY3Rpb24odCl7dGUodCxBaSl9fSxUaT1PYmplY3QuY3JlYXRlKG51bGwpLEVpPVtraSxTaV0samk9e2NyZWF0ZTpyZSx1cGRhdGU6cmV9LE5pPXtjcmVhdGU6b2UsdXBkYXRlOm9lfSxJaT0vW1x3KS4rXC1fJFxdXS8sTGk9Il9fciIsTWk9Il9fYyIsRGk9e2NyZWF0ZTp4ZSx1cGRhdGU6eGV9LFBpPXtjcmVhdGU6a2UsdXBkYXRlOmtlfSxGaT1wKGZ1bmN0aW9uKHQpe3ZhciBlPXt9LG49LzooLispLztyZXR1cm4gdC5zcGxpdCgvOyg/IVteKF0qXCkpL2cpLmZvckVhY2goZnVuY3Rpb24odCl7aWYodCl7dmFyIHI9dC5zcGxpdChuKTtyLmxlbmd0aD4xJiYoZVtyWzBdLnRyaW0oKV09clsxXS50cmltKCkpfX0pLGV9KSxSaT0vXi0tLyxIaT0vXHMqIWltcG9ydGFudCQvLEJpPWZ1bmN0aW9uKHQsZSxuKXtpZihSaS50ZXN0KGUpKXQuc3R5bGUuc2V0UHJvcGVydHkoZSxuKTtlbHNlIGlmKEhpLnRlc3QobikpdC5zdHlsZS5zZXRQcm9wZXJ0eShlLG4ucmVwbGFjZShIaSwiIiksImltcG9ydGFudCIpO2Vsc2V7dmFyIHI9VmkoZSk7aWYoQXJyYXkuaXNBcnJheShuKSlmb3IodmFyIGk9MCxvPW4ubGVuZ3RoO2k8bztpKyspdC5zdHlsZVtyXT1uW2ldO2Vsc2UgdC5zdHlsZVtyXT1ufX0sVWk9WyJXZWJraXQiLCJNb3oiLCJtcyJdLFZpPXAoZnVuY3Rpb24odCl7aWYoY2k9Y2l8fGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLnN0eWxlLCJmaWx0ZXIiIT09KHQ9UG4odCkpJiZ0IGluIGNpKXJldHVybiB0O2Zvcih2YXIgZT10LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK3Quc2xpY2UoMSksbj0wO248VWkubGVuZ3RoO24rKyl7dmFyIHI9VWlbbl0rZTtpZihyIGluIGNpKXJldHVybiByfX0pLHppPXtjcmVhdGU6U2UsdXBkYXRlOlNlfSxLaT1wKGZ1bmN0aW9uKHQpe3JldHVybntlbnRlckNsYXNzOnQrIi1lbnRlciIsZW50ZXJUb0NsYXNzOnQrIi1lbnRlci10byIsZW50ZXJBY3RpdmVDbGFzczp0KyItZW50ZXItYWN0aXZlIixsZWF2ZUNsYXNzOnQrIi1sZWF2ZSIsbGVhdmVUb0NsYXNzOnQrIi1sZWF2ZS10byIsbGVhdmVBY3RpdmVDbGFzczp0KyItbGVhdmUtYWN0aXZlIn19KSxKaT1HbiYmIXRyLHFpPSJ0cmFuc2l0aW9uIixXaT0iYW5pbWF0aW9uIixHaT0idHJhbnNpdGlvbiIsWmk9InRyYW5zaXRpb25lbmQiLFhpPSJhbmltYXRpb24iLFlpPSJhbmltYXRpb25lbmQiO0ppJiYodm9pZCAwPT09d2luZG93Lm9udHJhbnNpdGlvbmVuZCYmdm9pZCAwIT09d2luZG93Lm9ud2Via2l0dHJhbnNpdGlvbmVuZCYmKEdpPSJXZWJraXRUcmFuc2l0aW9uIixaaT0id2Via2l0VHJhbnNpdGlvbkVuZCIpLHZvaWQgMD09PXdpbmRvdy5vbmFuaW1hdGlvbmVuZCYmdm9pZCAwIT09d2luZG93Lm9ud2Via2l0YW5pbWF0aW9uZW5kJiYoWGk9IldlYmtpdEFuaW1hdGlvbiIsWWk9IndlYmtpdEFuaW1hdGlvbkVuZCIpKTt2YXIgUWk9R24/d2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZT93aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lLmJpbmQod2luZG93KTpzZXRUaW1lb3V0OmZ1bmN0aW9uKHQpe3JldHVybiB0KCl9LHRvPS9cYih0cmFuc2Zvcm18YWxsKSgsfCQpLyxlbz1mdW5jdGlvbihpKXtmdW5jdGlvbiBvKHQpe3ZhciBuPUEucGFyZW50Tm9kZSh0KTtlKG4pJiZBLnJlbW92ZUNoaWxkKG4sdCl9ZnVuY3Rpb24gYSh0LHIsaSxvLGEpe2lmKHQuaXNSb290SW5zZXJ0PSFhLCFmdW5jdGlvbih0LHIsaSxvKXt2YXIgYT10LmRhdGE7aWYoZShhKSl7dmFyIHU9ZSh0LmNvbXBvbmVudEluc3RhbmNlKSYmYS5rZWVwQWxpdmU7aWYoZShhPWEuaG9vaykmJmUoYT1hLmluaXQpJiZhKHQsITEsaSxvKSxlKHQuY29tcG9uZW50SW5zdGFuY2UpKXJldHVybiBzKHQsciksbih1KSYmZnVuY3Rpb24odCxuLHIsaSl7Zm9yKHZhciBvLGE9dDthLmNvbXBvbmVudEluc3RhbmNlOylpZihhPWEuY29tcG9uZW50SW5zdGFuY2UuX3Zub2RlLGUobz1hLmRhdGEpJiZlKG89by50cmFuc2l0aW9uKSl7Zm9yKG89MDtvPHguYWN0aXZhdGUubGVuZ3RoOysrbyl4LmFjdGl2YXRlW29dKEFpLGEpO24ucHVzaChhKTticmVha31jKHIsdC5lbG0saSl9KHQscixpLG8pLCEwfX0odCxyLGksbykpe3ZhciB1PXQuZGF0YSxmPXQuY2hpbGRyZW4sdj10LnRhZztlKHYpPyh0LmVsbT10Lm5zP0EuY3JlYXRlRWxlbWVudE5TKHQubnMsdik6QS5jcmVhdGVFbGVtZW50KHYsdCksZCh0KSxsKHQsZixyKSxlKHUpJiZwKHQsciksYyhpLHQuZWxtLG8pKTpuKHQuaXNDb21tZW50KT8odC5lbG09QS5jcmVhdGVDb21tZW50KHQudGV4dCksYyhpLHQuZWxtLG8pKToodC5lbG09QS5jcmVhdGVUZXh0Tm9kZSh0LnRleHQpLGMoaSx0LmVsbSxvKSl9fWZ1bmN0aW9uIHModCxuKXtlKHQuZGF0YS5wZW5kaW5nSW5zZXJ0KSYmKG4ucHVzaC5hcHBseShuLHQuZGF0YS5wZW5kaW5nSW5zZXJ0KSx0LmRhdGEucGVuZGluZ0luc2VydD1udWxsKSx0LmVsbT10LmNvbXBvbmVudEluc3RhbmNlLiRlbCxmKHQpPyhwKHQsbiksZCh0KSk6KFh0KHQpLG4ucHVzaCh0KSl9ZnVuY3Rpb24gYyh0LG4scil7ZSh0KSYmKGUocik/ci5wYXJlbnROb2RlPT09dCYmQS5pbnNlcnRCZWZvcmUodCxuLHIpOkEuYXBwZW5kQ2hpbGQodCxuKSl9ZnVuY3Rpb24gbCh0LGUsbil7aWYoQXJyYXkuaXNBcnJheShlKSlmb3IodmFyIGk9MDtpPGUubGVuZ3RoOysraSlhKGVbaV0sbix0LmVsbSxudWxsLCEwKTtlbHNlIHIodC50ZXh0KSYmQS5hcHBlbmRDaGlsZCh0LmVsbSxBLmNyZWF0ZVRleHROb2RlKFN0cmluZyh0LnRleHQpKSl9ZnVuY3Rpb24gZih0KXtmb3IoO3QuY29tcG9uZW50SW5zdGFuY2U7KXQ9dC5jb21wb25lbnRJbnN0YW5jZS5fdm5vZGU7cmV0dXJuIGUodC50YWcpfWZ1bmN0aW9uIHAodCxuKXtmb3IodmFyIHI9MDtyPHguY3JlYXRlLmxlbmd0aDsrK3IpeC5jcmVhdGVbcl0oQWksdCk7ZShDPXQuZGF0YS5ob29rKSYmKGUoQy5jcmVhdGUpJiZDLmNyZWF0ZShBaSx0KSxlKEMuaW5zZXJ0KSYmbi5wdXNoKHQpKX1mdW5jdGlvbiBkKHQpe3ZhciBuO2lmKGUobj10LmZuU2NvcGVJZCkpQS5zZXRBdHRyaWJ1dGUodC5lbG0sbiwiIik7ZWxzZSBmb3IodmFyIHI9dDtyOyllKG49ci5jb250ZXh0KSYmZShuPW4uJG9wdGlvbnMuX3Njb3BlSWQpJiZBLnNldEF0dHJpYnV0ZSh0LmVsbSxuLCIiKSxyPXIucGFyZW50O2Uobj1QcikmJm4hPT10LmNvbnRleHQmJm4hPT10LmZuQ29udGV4dCYmZShuPW4uJG9wdGlvbnMuX3Njb3BlSWQpJiZBLnNldEF0dHJpYnV0ZSh0LmVsbSxuLCIiKX1mdW5jdGlvbiB2KHQsZSxuLHIsaSxvKXtmb3IoO3I8PWk7KytyKWEobltyXSxvLHQsZSl9ZnVuY3Rpb24gaCh0KXt2YXIgbixyLGk9dC5kYXRhO2lmKGUoaSkpZm9yKGUobj1pLmhvb2spJiZlKG49bi5kZXN0cm95KSYmbih0KSxuPTA7bjx4LmRlc3Ryb3kubGVuZ3RoOysrbil4LmRlc3Ryb3lbbl0odCk7aWYoZShuPXQuY2hpbGRyZW4pKWZvcihyPTA7cjx0LmNoaWxkcmVuLmxlbmd0aDsrK3IpaCh0LmNoaWxkcmVuW3JdKX1mdW5jdGlvbiBtKHQsbixyLGkpe2Zvcig7cjw9aTsrK3Ipe3ZhciBhPW5bcl07ZShhKSYmKGUoYS50YWcpPyh5KGEpLGgoYSkpOm8oYS5lbG0pKX19ZnVuY3Rpb24geSh0LG4pe2lmKGUobil8fGUodC5kYXRhKSl7dmFyIHIsaT14LnJlbW92ZS5sZW5ndGgrMTtmb3IoZShuKT9uLmxpc3RlbmVycys9aTpuPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbigpezA9PS0tbi5saXN0ZW5lcnMmJm8odCl9cmV0dXJuIG4ubGlzdGVuZXJzPWUsbn0odC5lbG0saSksZShyPXQuY29tcG9uZW50SW5zdGFuY2UpJiZlKHI9ci5fdm5vZGUpJiZlKHIuZGF0YSkmJnkocixuKSxyPTA7cjx4LnJlbW92ZS5sZW5ndGg7KytyKXgucmVtb3ZlW3JdKHQsbik7ZShyPXQuZGF0YS5ob29rKSYmZShyPXIucmVtb3ZlKT9yKHQsbik6bigpfWVsc2Ugbyh0LmVsbSl9ZnVuY3Rpb24gZyhuLHIsaSxvLHMpe2Zvcih2YXIgYyx1LGwsZj0wLHA9MCxkPXIubGVuZ3RoLTEsaD1yWzBdLHk9cltkXSxnPWkubGVuZ3RoLTEsYj1pWzBdLCQ9aVtnXSxDPSFzO2Y8PWQmJnA8PWc7KXQoaCk/aD1yWysrZl06dCh5KT95PXJbLS1kXTpZdChoLGIpPyhfKGgsYixvKSxoPXJbKytmXSxiPWlbKytwXSk6WXQoeSwkKT8oXyh5LCQsbykseT1yWy0tZF0sJD1pWy0tZ10pOll0KGgsJCk/KF8oaCwkLG8pLEMmJkEuaW5zZXJ0QmVmb3JlKG4saC5lbG0sQS5uZXh0U2libGluZyh5LmVsbSkpLGg9clsrK2ZdLCQ9aVstLWddKTpZdCh5LGIpPyhfKHksYixvKSxDJiZBLmluc2VydEJlZm9yZShuLHkuZWxtLGguZWxtKSx5PXJbLS1kXSxiPWlbKytwXSk6KHQoYykmJihjPVF0KHIsZixkKSksdCh1PWUoYi5rZXkpP2NbYi5rZXldOmZ1bmN0aW9uKHQsbixyLGkpe2Zvcih2YXIgbz1yO288aTtvKyspe3ZhciBhPW5bb107aWYoZShhKSYmWXQodCxhKSlyZXR1cm4gb319KGIscixmLGQpKT9hKGIsbyxuLGguZWxtKTpZdChsPXJbdV0sYik/KF8obCxiLG8pLHJbdV09dm9pZCAwLEMmJkEuaW5zZXJ0QmVmb3JlKG4sbC5lbG0saC5lbG0pKTphKGIsbyxuLGguZWxtKSxiPWlbKytwXSk7Zj5kP3Yobix0KGlbZysxXSk/bnVsbDppW2crMV0uZWxtLGkscCxnLG8pOnA+ZyYmbSgwLHIsZixkKX1mdW5jdGlvbiBfKHIsaSxvLGEpe2lmKHIhPT1pKXt2YXIgcz1pLmVsbT1yLmVsbTtpZihuKHIuaXNBc3luY1BsYWNlaG9sZGVyKSllKGkuYXN5bmNGYWN0b3J5LnJlc29sdmVkKT8kKHIuZWxtLGksbyk6aS5pc0FzeW5jUGxhY2Vob2xkZXI9ITA7ZWxzZSBpZihuKGkuaXNTdGF0aWMpJiZuKHIuaXNTdGF0aWMpJiZpLmtleT09PXIua2V5JiYobihpLmlzQ2xvbmVkKXx8bihpLmlzT25jZSkpKWkuY29tcG9uZW50SW5zdGFuY2U9ci5jb21wb25lbnRJbnN0YW5jZTtlbHNle3ZhciBjLHU9aS5kYXRhO2UodSkmJmUoYz11Lmhvb2spJiZlKGM9Yy5wcmVwYXRjaCkmJmMocixpKTt2YXIgbD1yLmNoaWxkcmVuLHA9aS5jaGlsZHJlbjtpZihlKHUpJiZmKGkpKXtmb3IoYz0wO2M8eC51cGRhdGUubGVuZ3RoOysrYyl4LnVwZGF0ZVtjXShyLGkpO2UoYz11Lmhvb2spJiZlKGM9Yy51cGRhdGUpJiZjKHIsaSl9dChpLnRleHQpP2UobCkmJmUocCk/bCE9PXAmJmcocyxsLHAsbyxhKTplKHApPyhlKHIudGV4dCkmJkEuc2V0VGV4dENvbnRlbnQocywiIiksdihzLG51bGwscCwwLHAubGVuZ3RoLTEsbykpOmUobCk/bSgwLGwsMCxsLmxlbmd0aC0xKTplKHIudGV4dCkmJkEuc2V0VGV4dENvbnRlbnQocywiIik6ci50ZXh0IT09aS50ZXh0JiZBLnNldFRleHRDb250ZW50KHMsaS50ZXh0KSxlKHUpJiZlKGM9dS5ob29rKSYmZShjPWMucG9zdHBhdGNoKSYmYyhyLGkpfX19ZnVuY3Rpb24gYih0LHIsaSl7aWYobihpKSYmZSh0LnBhcmVudCkpdC5wYXJlbnQuZGF0YS5wZW5kaW5nSW5zZXJ0PXI7ZWxzZSBmb3IodmFyIG89MDtvPHIubGVuZ3RoOysrbylyW29dLmRhdGEuaG9vay5pbnNlcnQocltvXSl9ZnVuY3Rpb24gJCh0LHIsaSxvKXt2YXIgYSxjPXIudGFnLHU9ci5kYXRhLGY9ci5jaGlsZHJlbjtpZihvPW98fHUmJnUucHJlLHIuZWxtPXQsbihyLmlzQ29tbWVudCkmJmUoci5hc3luY0ZhY3RvcnkpKXJldHVybiByLmlzQXN5bmNQbGFjZWhvbGRlcj0hMCwhMDtpZihlKHUpJiYoZShhPXUuaG9vaykmJmUoYT1hLmluaXQpJiZhKHIsITApLGUoYT1yLmNvbXBvbmVudEluc3RhbmNlKSkpcmV0dXJuIHMocixpKSwhMDtpZihlKGMpKXtpZihlKGYpKWlmKHQuaGFzQ2hpbGROb2RlcygpKWlmKGUoYT11KSYmZShhPWEuZG9tUHJvcHMpJiZlKGE9YS5pbm5lckhUTUwpKXtpZihhIT09dC5pbm5lckhUTUwpcmV0dXJuITF9ZWxzZXtmb3IodmFyIGQ9ITAsdj10LmZpcnN0Q2hpbGQsaD0wO2g8Zi5sZW5ndGg7aCsrKXtpZighdnx8ISQodixmW2hdLGksbykpe2Q9ITE7YnJlYWt9dj12Lm5leHRTaWJsaW5nfWlmKCFkfHx2KXJldHVybiExfWVsc2UgbChyLGYsaSk7aWYoZSh1KSl7dmFyIG09ITE7Zm9yKHZhciB5IGluIHUpaWYoIU8oeSkpe209ITAscChyLGkpO2JyZWFrfSFtJiZ1LmNsYXNzJiZXKHUuY2xhc3MpfX1lbHNlIHQuZGF0YSE9PXIudGV4dCYmKHQuZGF0YT1yLnRleHQpO3JldHVybiEwfXZhciBDLHcseD17fSxrPWkubW9kdWxlcyxBPWkubm9kZU9wcztmb3IoQz0wO0M8T2kubGVuZ3RoOysrQylmb3IoeFtPaVtDXV09W10sdz0wO3c8ay5sZW5ndGg7Kyt3KWUoa1t3XVtPaVtDXV0pJiZ4W09pW0NdXS5wdXNoKGtbd11bT2lbQ11dKTt2YXIgTz11KCJhdHRycyxjbGFzcyxzdGF0aWNDbGFzcyxzdGF0aWNTdHlsZSxrZXkiKTtyZXR1cm4gZnVuY3Rpb24ocixpLG8scyxjLHUpe2lmKCF0KGkpKXt2YXIgbD0hMSxwPVtdO2lmKHQocikpbD0hMCxhKGkscCxjLHUpO2Vsc2V7dmFyIGQ9ZShyLm5vZGVUeXBlKTtpZighZCYmWXQocixpKSlfKHIsaSxwLHMpO2Vsc2V7aWYoZCl7aWYoMT09PXIubm9kZVR5cGUmJnIuaGFzQXR0cmlidXRlKFZuKSYmKHIucmVtb3ZlQXR0cmlidXRlKFZuKSxvPSEwKSxuKG8pJiYkKHIsaSxwKSlyZXR1cm4gYihpLHAsITApLHI7cj1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IG1yKEEudGFnTmFtZSh0KS50b0xvd2VyQ2FzZSgpLHt9LFtdLHZvaWQgMCx0KX0ocil9dmFyIHY9ci5lbG0seT1BLnBhcmVudE5vZGUodik7aWYoYShpLHAsdi5fbGVhdmVDYj9udWxsOnksQS5uZXh0U2libGluZyh2KSksZShpLnBhcmVudCkpZm9yKHZhciBnPWkucGFyZW50LEM9ZihpKTtnOyl7Zm9yKHZhciB3PTA7dzx4LmRlc3Ryb3kubGVuZ3RoOysrdyl4LmRlc3Ryb3lbd10oZyk7aWYoZy5lbG09aS5lbG0sQyl7Zm9yKHZhciBrPTA7azx4LmNyZWF0ZS5sZW5ndGg7KytrKXguY3JlYXRlW2tdKEFpLGcpO3ZhciBPPWcuZGF0YS5ob29rLmluc2VydDtpZihPLm1lcmdlZClmb3IodmFyIFM9MTtTPE8uZm5zLmxlbmd0aDtTKyspTy5mbnNbU10oKX1lbHNlIFh0KGcpO2c9Zy5wYXJlbnR9ZSh5KT9tKDAsW3JdLDAsMCk6ZShyLnRhZykmJmgocil9fXJldHVybiBiKGkscCxsKSxpLmVsbX1lKHIpJiZoKHIpfX0oe25vZGVPcHM6eGksbW9kdWxlczpbamksTmksRGksUGksemksR24/e2NyZWF0ZTpWZSxhY3RpdmF0ZTpWZSxyZW1vdmU6ZnVuY3Rpb24odCxlKXshMCE9PXQuZGF0YS5zaG93P0hlKHQsZSk6ZSgpfX06e31dLmNvbmNhdChFaSl9KTt0ciYmZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigic2VsZWN0aW9uY2hhbmdlIixmdW5jdGlvbigpe3ZhciB0PWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7dCYmdC52bW9kZWwmJlplKHQsImlucHV0Iil9KTt2YXIgbm89e2luc2VydGVkOmZ1bmN0aW9uKHQsZSxuLHIpeyJzZWxlY3QiPT09bi50YWc/KHIuZWxtJiYhci5lbG0uX3ZPcHRpb25zP1kobiwicG9zdHBhdGNoIixmdW5jdGlvbigpe25vLmNvbXBvbmVudFVwZGF0ZWQodCxlLG4pfSk6emUodCxlLG4uY29udGV4dCksdC5fdk9wdGlvbnM9W10ubWFwLmNhbGwodC5vcHRpb25zLHFlKSk6KCJ0ZXh0YXJlYSI9PT1uLnRhZ3x8d2kodC50eXBlKSkmJih0Ll92TW9kaWZpZXJzPWUubW9kaWZpZXJzLGUubW9kaWZpZXJzLmxhenl8fCh0LmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsR2UpLG5yfHwodC5hZGRFdmVudExpc3RlbmVyKCJjb21wb3NpdGlvbnN0YXJ0IixXZSksdC5hZGRFdmVudExpc3RlbmVyKCJjb21wb3NpdGlvbmVuZCIsR2UpKSx0ciYmKHQudm1vZGVsPSEwKSkpfSxjb21wb25lbnRVcGRhdGVkOmZ1bmN0aW9uKHQsZSxuKXtpZigic2VsZWN0Ij09PW4udGFnKXt6ZSh0LGUsbi5jb250ZXh0KTt2YXIgcj10Ll92T3B0aW9ucyxpPXQuX3ZPcHRpb25zPVtdLm1hcC5jYWxsKHQub3B0aW9ucyxxZSk7aWYoaS5zb21lKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIWcodCxyW2VdKX0pKXsodC5tdWx0aXBsZT9lLnZhbHVlLnNvbWUoZnVuY3Rpb24odCl7cmV0dXJuIEplKHQsaSl9KTplLnZhbHVlIT09ZS5vbGRWYWx1ZSYmSmUoZS52YWx1ZSxpKSkmJlplKHQsImNoYW5nZSIpfX19fSxybz17bW9kZWw6bm8sc2hvdzp7YmluZDpmdW5jdGlvbih0LGUsbil7dmFyIHI9ZS52YWx1ZSxpPShuPVhlKG4pKS5kYXRhJiZuLmRhdGEudHJhbnNpdGlvbixvPXQuX192T3JpZ2luYWxEaXNwbGF5PSJub25lIj09PXQuc3R5bGUuZGlzcGxheT8iIjp0LnN0eWxlLmRpc3BsYXk7ciYmaT8obi5kYXRhLnNob3c9ITAsUmUobixmdW5jdGlvbigpe3Quc3R5bGUuZGlzcGxheT1vfSkpOnQuc3R5bGUuZGlzcGxheT1yP286Im5vbmUifSx1cGRhdGU6ZnVuY3Rpb24odCxlLG4pe3ZhciByPWUudmFsdWU7aWYociE9PWUub2xkVmFsdWUpeyhuPVhlKG4pKS5kYXRhJiZuLmRhdGEudHJhbnNpdGlvbj8obi5kYXRhLnNob3c9ITAscj9SZShuLGZ1bmN0aW9uKCl7dC5zdHlsZS5kaXNwbGF5PXQuX192T3JpZ2luYWxEaXNwbGF5fSk6SGUobixmdW5jdGlvbigpe3Quc3R5bGUuZGlzcGxheT0ibm9uZSJ9KSk6dC5zdHlsZS5kaXNwbGF5PXI/dC5fX3ZPcmlnaW5hbERpc3BsYXk6Im5vbmUifX0sdW5iaW5kOmZ1bmN0aW9uKHQsZSxuLHIsaSl7aXx8KHQuc3R5bGUuZGlzcGxheT10Ll9fdk9yaWdpbmFsRGlzcGxheSl9fX0saW89e25hbWU6U3RyaW5nLGFwcGVhcjpCb29sZWFuLGNzczpCb29sZWFuLG1vZGU6U3RyaW5nLHR5cGU6U3RyaW5nLGVudGVyQ2xhc3M6U3RyaW5nLGxlYXZlQ2xhc3M6U3RyaW5nLGVudGVyVG9DbGFzczpTdHJpbmcsbGVhdmVUb0NsYXNzOlN0cmluZyxlbnRlckFjdGl2ZUNsYXNzOlN0cmluZyxsZWF2ZUFjdGl2ZUNsYXNzOlN0cmluZyxhcHBlYXJDbGFzczpTdHJpbmcsYXBwZWFyQWN0aXZlQ2xhc3M6U3RyaW5nLGFwcGVhclRvQ2xhc3M6U3RyaW5nLGR1cmF0aW9uOltOdW1iZXIsU3RyaW5nLE9iamVjdF19LG9vPXtuYW1lOiJ0cmFuc2l0aW9uIixwcm9wczppbyxhYnN0cmFjdDohMCxyZW5kZXI6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcyxuPXRoaXMuJHNsb3RzLmRlZmF1bHQ7aWYobiYmKG49bi5maWx0ZXIoZnVuY3Rpb24odCl7cmV0dXJuIHQudGFnfHxydCh0KX0pKS5sZW5ndGgpe3ZhciBpPXRoaXMubW9kZSxvPW5bMF07aWYoZnVuY3Rpb24odCl7Zm9yKDt0PXQucGFyZW50OylpZih0LmRhdGEudHJhbnNpdGlvbilyZXR1cm4hMH0odGhpcy4kdm5vZGUpKXJldHVybiBvO3ZhciBhPVllKG8pO2lmKCFhKXJldHVybiBvO2lmKHRoaXMuX2xlYXZpbmcpcmV0dXJuIHRuKHQsbyk7dmFyIHM9Il9fdHJhbnNpdGlvbi0iK3RoaXMuX3VpZCsiLSI7YS5rZXk9bnVsbD09YS5rZXk/YS5pc0NvbW1lbnQ/cysiY29tbWVudCI6cythLnRhZzpyKGEua2V5KT8wPT09U3RyaW5nKGEua2V5KS5pbmRleE9mKHMpP2Eua2V5OnMrYS5rZXk6YS5rZXk7dmFyIGM9KGEuZGF0YXx8KGEuZGF0YT17fSkpLnRyYW5zaXRpb249UWUodGhpcyksdT10aGlzLl92bm9kZSxsPVllKHUpO2lmKGEuZGF0YS5kaXJlY3RpdmVzJiZhLmRhdGEuZGlyZWN0aXZlcy5zb21lKGZ1bmN0aW9uKHQpe3JldHVybiJzaG93Ij09PXQubmFtZX0pJiYoYS5kYXRhLnNob3c9ITApLGwmJmwuZGF0YSYmIWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUua2V5PT09dC5rZXkmJmUudGFnPT09dC50YWd9KGEsbCkmJiFydChsKSYmKCFsLmNvbXBvbmVudEluc3RhbmNlfHwhbC5jb21wb25lbnRJbnN0YW5jZS5fdm5vZGUuaXNDb21tZW50KSl7dmFyIGY9bC5kYXRhLnRyYW5zaXRpb249aCh7fSxjKTtpZigib3V0LWluIj09PWkpcmV0dXJuIHRoaXMuX2xlYXZpbmc9ITAsWShmLCJhZnRlckxlYXZlIixmdW5jdGlvbigpe2UuX2xlYXZpbmc9ITEsZS4kZm9yY2VVcGRhdGUoKX0pLHRuKHQsbyk7aWYoImluLW91dCI9PT1pKXtpZihydChhKSlyZXR1cm4gdTt2YXIgcCxkPWZ1bmN0aW9uKCl7cCgpfTtZKGMsImFmdGVyRW50ZXIiLGQpLFkoYywiZW50ZXJDYW5jZWxsZWQiLGQpLFkoZiwiZGVsYXlMZWF2ZSIsZnVuY3Rpb24odCl7cD10fSl9fXJldHVybiBvfX19LGFvPWgoe3RhZzpTdHJpbmcsbW92ZUNsYXNzOlN0cmluZ30saW8pO2RlbGV0ZSBhby5tb2RlO3ZhciBzbz17VHJhbnNpdGlvbjpvbyxUcmFuc2l0aW9uR3JvdXA6e3Byb3BzOmFvLHJlbmRlcjpmdW5jdGlvbih0KXtmb3IodmFyIGU9dGhpcy50YWd8fHRoaXMuJHZub2RlLmRhdGEudGFnfHwic3BhbiIsbj1PYmplY3QuY3JlYXRlKG51bGwpLHI9dGhpcy5wcmV2Q2hpbGRyZW49dGhpcy5jaGlsZHJlbixpPXRoaXMuJHNsb3RzLmRlZmF1bHR8fFtdLG89dGhpcy5jaGlsZHJlbj1bXSxhPVFlKHRoaXMpLHM9MDtzPGkubGVuZ3RoO3MrKyl7dmFyIGM9aVtzXTtjLnRhZyYmbnVsbCE9Yy5rZXkmJjAhPT1TdHJpbmcoYy5rZXkpLmluZGV4T2YoIl9fdmxpc3QiKSYmKG8ucHVzaChjKSxuW2Mua2V5XT1jLChjLmRhdGF8fChjLmRhdGE9e30pKS50cmFuc2l0aW9uPWEpfWlmKHIpe2Zvcih2YXIgdT1bXSxsPVtdLGY9MDtmPHIubGVuZ3RoO2YrKyl7dmFyIHA9cltmXTtwLmRhdGEudHJhbnNpdGlvbj1hLHAuZGF0YS5wb3M9cC5lbG0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksbltwLmtleV0/dS5wdXNoKHApOmwucHVzaChwKX10aGlzLmtlcHQ9dChlLG51bGwsdSksdGhpcy5yZW1vdmVkPWx9cmV0dXJuIHQoZSxudWxsLG8pfSxiZWZvcmVVcGRhdGU6ZnVuY3Rpb24oKXt0aGlzLl9fcGF0Y2hfXyh0aGlzLl92bm9kZSx0aGlzLmtlcHQsITEsITApLHRoaXMuX3Zub2RlPXRoaXMua2VwdH0sdXBkYXRlZDpmdW5jdGlvbigpe3ZhciB0PXRoaXMucHJldkNoaWxkcmVuLGU9dGhpcy5tb3ZlQ2xhc3N8fCh0aGlzLm5hbWV8fCJ2IikrIi1tb3ZlIjt0Lmxlbmd0aCYmdGhpcy5oYXNNb3ZlKHRbMF0uZWxtLGUpJiYodC5mb3JFYWNoKGVuKSx0LmZvckVhY2gobm4pLHQuZm9yRWFjaChybiksdGhpcy5fcmVmbG93PWRvY3VtZW50LmJvZHkub2Zmc2V0SGVpZ2h0LHQuZm9yRWFjaChmdW5jdGlvbih0KXtpZih0LmRhdGEubW92ZWQpe3ZhciBuPXQuZWxtLHI9bi5zdHlsZTtJZShuLGUpLHIudHJhbnNmb3JtPXIuV2Via2l0VHJhbnNmb3JtPXIudHJhbnNpdGlvbkR1cmF0aW9uPSIiLG4uYWRkRXZlbnRMaXN0ZW5lcihaaSxuLl9tb3ZlQ2I9ZnVuY3Rpb24gdChyKXtyJiYhL3RyYW5zZm9ybSQvLnRlc3Qoci5wcm9wZXJ0eU5hbWUpfHwobi5yZW1vdmVFdmVudExpc3RlbmVyKFppLHQpLG4uX21vdmVDYj1udWxsLExlKG4sZSkpfSl9fSkpfSxtZXRob2RzOntoYXNNb3ZlOmZ1bmN0aW9uKHQsZSl7aWYoIUppKXJldHVybiExO2lmKHRoaXMuX2hhc01vdmUpcmV0dXJuIHRoaXMuX2hhc01vdmU7dmFyIG49dC5jbG9uZU5vZGUoKTt0Ll90cmFuc2l0aW9uQ2xhc3NlcyYmdC5fdHJhbnNpdGlvbkNsYXNzZXMuZm9yRWFjaChmdW5jdGlvbih0KXtFZShuLHQpfSksVGUobixlKSxuLnN0eWxlLmRpc3BsYXk9Im5vbmUiLHRoaXMuJGVsLmFwcGVuZENoaWxkKG4pO3ZhciByPURlKG4pO3JldHVybiB0aGlzLiRlbC5yZW1vdmVDaGlsZChuKSx0aGlzLl9oYXNNb3ZlPXIuaGFzVHJhbnNmb3JtfX19fTtSdC5jb25maWcubXVzdFVzZVByb3A9ZmksUnQuY29uZmlnLmlzUmVzZXJ2ZWRUYWc9JGksUnQuY29uZmlnLmlzUmVzZXJ2ZWRBdHRyPXVpLFJ0LmNvbmZpZy5nZXRUYWdOYW1lc3BhY2U9R3QsUnQuY29uZmlnLmlzVW5rbm93bkVsZW1lbnQ9ZnVuY3Rpb24odCl7aWYoIUduKXJldHVybiEwO2lmKCRpKHQpKXJldHVybiExO2lmKHQ9dC50b0xvd2VyQ2FzZSgpLG51bGwhPUNpW3RdKXJldHVybiBDaVt0XTt2YXIgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KHQpO3JldHVybiB0LmluZGV4T2YoIi0iKT4tMT9DaVt0XT1lLmNvbnN0cnVjdG9yPT09d2luZG93LkhUTUxVbmtub3duRWxlbWVudHx8ZS5jb25zdHJ1Y3Rvcj09PXdpbmRvdy5IVE1MRWxlbWVudDpDaVt0XT0vSFRNTFVua25vd25FbGVtZW50Ly50ZXN0KGUudG9TdHJpbmcoKSl9LGgoUnQub3B0aW9ucy5kaXJlY3RpdmVzLHJvKSxoKFJ0Lm9wdGlvbnMuY29tcG9uZW50cyxzbyksUnQucHJvdG90eXBlLl9fcGF0Y2hfXz1Hbj9lbzp5LFJ0LnByb3RvdHlwZS4kbW91bnQ9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdD10JiZHbj9adCh0KTp2b2lkIDAsZnVuY3Rpb24odCxlLG4pe3QuJGVsPWUsdC4kb3B0aW9ucy5yZW5kZXJ8fCh0LiRvcHRpb25zLnJlbmRlcj1nciksdnQodCwiYmVmb3JlTW91bnQiKTt2YXIgcjtyZXR1cm4gcj1mdW5jdGlvbigpe3QuX3VwZGF0ZSh0Ll9yZW5kZXIoKSxuKX0sbmV3IEtyKHQscix5LG51bGwsITApLG49ITEsbnVsbD09dC4kdm5vZGUmJih0Ll9pc01vdW50ZWQ9ITAsdnQodCwibW91bnRlZCIpKSx0fSh0aGlzLHQsZSl9LFJ0Lm5leHRUaWNrKGZ1bmN0aW9uKCl7Sm4uZGV2dG9vbHMmJmxyJiZsci5lbWl0KCJpbml0IixSdCl9LDApO3ZhciBjbyx1bz0vXHtceygoPzoufFxuKSs/KVx9XH0vZyxsbz0vWy0uKis/XiR7fSgpfFtcXVwvXFxdL2csZm89cChmdW5jdGlvbih0KXt2YXIgZT10WzBdLnJlcGxhY2UobG8sIlxcJCYiKSxuPXRbMV0ucmVwbGFjZShsbywiXFwkJiIpO3JldHVybiBuZXcgUmVnRXhwKGUrIigoPzoufFxcbikrPykiK24sImciKX0pLHBvPXtzdGF0aWNLZXlzOlsic3RhdGljQ2xhc3MiXSx0cmFuc2Zvcm1Ob2RlOmZ1bmN0aW9uKHQsZSl7ZS53YXJuO3ZhciBuPWhlKHQsImNsYXNzIik7biYmKHQuc3RhdGljQ2xhc3M9SlNPTi5zdHJpbmdpZnkobikpO3ZhciByPXZlKHQsImNsYXNzIiwhMSk7ciYmKHQuY2xhc3NCaW5kaW5nPXIpfSxnZW5EYXRhOmZ1bmN0aW9uKHQpe3ZhciBlPSIiO3JldHVybiB0LnN0YXRpY0NsYXNzJiYoZSs9InN0YXRpY0NsYXNzOiIrdC5zdGF0aWNDbGFzcysiLCIpLHQuY2xhc3NCaW5kaW5nJiYoZSs9ImNsYXNzOiIrdC5jbGFzc0JpbmRpbmcrIiwiKSxlfX0sdm89e3N0YXRpY0tleXM6WyJzdGF0aWNTdHlsZSJdLHRyYW5zZm9ybU5vZGU6ZnVuY3Rpb24odCxlKXtlLndhcm47dmFyIG49aGUodCwic3R5bGUiKTtuJiYodC5zdGF0aWNTdHlsZT1KU09OLnN0cmluZ2lmeShGaShuKSkpO3ZhciByPXZlKHQsInN0eWxlIiwhMSk7ciYmKHQuc3R5bGVCaW5kaW5nPXIpfSxnZW5EYXRhOmZ1bmN0aW9uKHQpe3ZhciBlPSIiO3JldHVybiB0LnN0YXRpY1N0eWxlJiYoZSs9InN0YXRpY1N0eWxlOiIrdC5zdGF0aWNTdHlsZSsiLCIpLHQuc3R5bGVCaW5kaW5nJiYoZSs9InN0eWxlOigiK3Quc3R5bGVCaW5kaW5nKyIpLCIpLGV9fSxobz1mdW5jdGlvbih0KXtyZXR1cm4gY289Y298fGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLGNvLmlubmVySFRNTD10LGNvLnRleHRDb250ZW50fSxtbz11KCJhcmVhLGJhc2UsYnIsY29sLGVtYmVkLGZyYW1lLGhyLGltZyxpbnB1dCxpc2luZGV4LGtleWdlbixsaW5rLG1ldGEscGFyYW0sc291cmNlLHRyYWNrLHdiciIpLHlvPXUoImNvbGdyb3VwLGRkLGR0LGxpLG9wdGlvbnMscCx0ZCx0Zm9vdCx0aCx0aGVhZCx0cixzb3VyY2UiKSxnbz11KCJhZGRyZXNzLGFydGljbGUsYXNpZGUsYmFzZSxibG9ja3F1b3RlLGJvZHksY2FwdGlvbixjb2wsY29sZ3JvdXAsZGQsZGV0YWlscyxkaWFsb2csZGl2LGRsLGR0LGZpZWxkc2V0LGZpZ2NhcHRpb24sZmlndXJlLGZvb3Rlcixmb3JtLGgxLGgyLGgzLGg0LGg1LGg2LGhlYWQsaGVhZGVyLGhncm91cCxocixodG1sLGxlZ2VuZCxsaSxtZW51aXRlbSxtZXRhLG9wdGdyb3VwLG9wdGlvbixwYXJhbSxycCxydCxzb3VyY2Usc3R5bGUsc3VtbWFyeSx0Ym9keSx0ZCx0Zm9vdCx0aCx0aGVhZCx0aXRsZSx0cix0cmFjayIpLF9vPS9eXHMqKFteXHMiJzw+XC89XSspKD86XHMqKD0pXHMqKD86IihbXiJdKikiK3wnKFteJ10qKScrfChbXlxzIic9PD5gXSspKSk/Lyxibz0iW2EtekEtWl9dW1xcd1xcLVxcLl0qIiwkbz0iKCg/OiIrYm8rIlxcOik/IitibysiKSIsQ289bmV3IFJlZ0V4cCgiXjwiKyRvKSx3bz0vXlxzKihcLz8pPi8seG89bmV3IFJlZ0V4cCgiXjxcXC8iKyRvKyJbXj5dKj4iKSxrbz0vXjwhRE9DVFlQRSBbXj5dKz4vaSxBbz0vXjwhLS0vLE9vPS9ePCFcWy8sU289ITE7IngiLnJlcGxhY2UoL3goLik/L2csZnVuY3Rpb24odCxlKXtTbz0iIj09PWV9KTt2YXIgVG8sRW8sam8sTm8sSW8sTG8sTW8sRG8sUG8sRm8sUm8sSG89dSgic2NyaXB0LHN0eWxlLHRleHRhcmVhIiwhMCksQm89e30sVW89eyImbHQ7IjoiPCIsIiZndDsiOiI+IiwiJnF1b3Q7IjonIicsIiZhbXA7IjoiJiIsIiYjMTA7IjoiXG4iLCImIzk7IjoiXHQifSxWbz0vJig/Omx0fGd0fHF1b3R8YW1wKTsvZyx6bz0vJig/Omx0fGd0fHF1b3R8YW1wfCMxMHwjOSk7L2csS289dSgicHJlLHRleHRhcmVhIiwhMCksSm89ZnVuY3Rpb24odCxlKXtyZXR1cm4gdCYmS28odCkmJiJcbiI9PT1lWzBdfSxxbz0vXkB8XnYtb246LyxXbz0vXnYtfF5AfF46LyxHbz0vKC4qPylccysoPzppbnxvZilccysoLiopLyxabz0vLChbXixcfVxdXSopKD86LChbXixcfVxdXSopKT8kLyxYbz0vXlwofFwpJC9nLFlvPS86KC4qKSQvLFFvPS9eOnxedi1iaW5kOi8sdGE9L1wuW14uXSsvZyxlYT1wKGhvKSxuYT0vXnhtbG5zOk5TXGQrLyxyYT0vXk5TXGQrOi8saWE9W3BvLHZvLHtwcmVUcmFuc2Zvcm1Ob2RlOmZ1bmN0aW9uKHQsZSl7aWYoImlucHV0Ij09PXQudGFnKXt2YXIgbj10LmF0dHJzTWFwO2lmKG5bInYtbW9kZWwiXSYmKG5bInYtYmluZDp0eXBlIl18fG5bIjp0eXBlIl0pKXt2YXIgcj12ZSh0LCJ0eXBlIiksaT1oZSh0LCJ2LWlmIiwhMCksbz1pPyImJigiK2krIikiOiIiLGE9bnVsbCE9aGUodCwidi1lbHNlIiwhMCkscz1oZSh0LCJ2LWVsc2UtaWYiLCEwKSxjPWZuKHQpO3VuKGMpLGZlKGMsInR5cGUiLCJjaGVja2JveCIpLGNuKGMsZSksYy5wcm9jZXNzZWQ9ITAsYy5pZj0iKCIrcisiKT09PSdjaGVja2JveCciK28sbG4oYyx7ZXhwOmMuaWYsYmxvY2s6Y30pO3ZhciB1PWZuKHQpO2hlKHUsInYtZm9yIiwhMCksZmUodSwidHlwZSIsInJhZGlvIiksY24odSxlKSxsbihjLHtleHA6IigiK3IrIik9PT0ncmFkaW8nIitvLGJsb2NrOnV9KTt2YXIgbD1mbih0KTtyZXR1cm4gaGUobCwidi1mb3IiLCEwKSxmZShsLCI6dHlwZSIsciksY24obCxlKSxsbihjLHtleHA6aSxibG9jazpsfSksYT9jLmVsc2U9ITA6cyYmKGMuZWxzZWlmPXMpLGN9fX19XSxvYT17ZXhwZWN0SFRNTDohMCxtb2R1bGVzOmlhLGRpcmVjdGl2ZXM6e21vZGVsOmZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1lLnZhbHVlLGk9ZS5tb2RpZmllcnMsbz10LnRhZyxhPXQuYXR0cnNNYXAudHlwZTtpZih0LmNvbXBvbmVudClyZXR1cm4gbWUodCxyLGkpLCExO2lmKCJzZWxlY3QiPT09bykhZnVuY3Rpb24odCxlLG4pe3ZhciByPSd2YXIgJCRzZWxlY3RlZFZhbCA9IEFycmF5LnByb3RvdHlwZS5maWx0ZXIuY2FsbCgkZXZlbnQudGFyZ2V0Lm9wdGlvbnMsZnVuY3Rpb24obyl7cmV0dXJuIG8uc2VsZWN0ZWR9KS5tYXAoZnVuY3Rpb24obyl7dmFyIHZhbCA9ICJfdmFsdWUiIGluIG8gPyBvLl92YWx1ZSA6IG8udmFsdWU7cmV0dXJuICcrKG4mJm4ubnVtYmVyPyJfbih2YWwpIjoidmFsIikrIn0pOyI7cj1yKyIgIit5ZShlLCIkZXZlbnQudGFyZ2V0Lm11bHRpcGxlID8gJCRzZWxlY3RlZFZhbCA6ICQkc2VsZWN0ZWRWYWxbMF0iKSxkZSh0LCJjaGFuZ2UiLHIsbnVsbCwhMCl9KHQscixpKTtlbHNlIGlmKCJpbnB1dCI9PT1vJiYiY2hlY2tib3giPT09YSkhZnVuY3Rpb24odCxlLG4pe3ZhciByPW4mJm4ubnVtYmVyLGk9dmUodCwidmFsdWUiKXx8Im51bGwiLG89dmUodCwidHJ1ZS12YWx1ZSIpfHwidHJ1ZSIsYT12ZSh0LCJmYWxzZS12YWx1ZSIpfHwiZmFsc2UiO3VlKHQsImNoZWNrZWQiLCJBcnJheS5pc0FycmF5KCIrZSsiKT9faSgiK2UrIiwiK2krIik+LTEiKygidHJ1ZSI9PT1vPyI6KCIrZSsiKSI6IjpfcSgiK2UrIiwiK28rIikiKSksZGUodCwiY2hhbmdlIiwidmFyICQkYT0iK2UrIiwkJGVsPSRldmVudC50YXJnZXQsJCRjPSQkZWwuY2hlY2tlZD8oIitvKyIpOigiK2ErIik7aWYoQXJyYXkuaXNBcnJheSgkJGEpKXt2YXIgJCR2PSIrKHI/Il9uKCIraSsiKSI6aSkrIiwkJGk9X2koJCRhLCQkdik7aWYoJCRlbC5jaGVja2VkKXskJGk8MCYmKCIrZSsiPSQkYS5jb25jYXQoWyQkdl0pKX1lbHNleyQkaT4tMSYmKCIrZSsiPSQkYS5zbGljZSgwLCQkaSkuY29uY2F0KCQkYS5zbGljZSgkJGkrMSkpKX19ZWxzZXsiK3llKGUsIiQkYyIpKyJ9IixudWxsLCEwKX0odCxyLGkpO2Vsc2UgaWYoImlucHV0Ij09PW8mJiJyYWRpbyI9PT1hKSFmdW5jdGlvbih0LGUsbil7dmFyIHI9biYmbi5udW1iZXIsaT12ZSh0LCJ2YWx1ZSIpfHwibnVsbCI7dWUodCwiY2hlY2tlZCIsIl9xKCIrZSsiLCIrKGk9cj8iX24oIitpKyIpIjppKSsiKSIpLGRlKHQsImNoYW5nZSIseWUoZSxpKSxudWxsLCEwKX0odCxyLGkpO2Vsc2UgaWYoImlucHV0Ij09PW98fCJ0ZXh0YXJlYSI9PT1vKSFmdW5jdGlvbih0LGUsbil7dmFyIHI9dC5hdHRyc01hcC50eXBlLGk9bnx8e30sbz1pLmxhenksYT1pLm51bWJlcixzPWkudHJpbSxjPSFvJiYicmFuZ2UiIT09cix1PW8/ImNoYW5nZSI6InJhbmdlIj09PXI/TGk6ImlucHV0IixsPSIkZXZlbnQudGFyZ2V0LnZhbHVlIjtzJiYobD0iJGV2ZW50LnRhcmdldC52YWx1ZS50cmltKCkiKSxhJiYobD0iX24oIitsKyIpIik7dmFyIGY9eWUoZSxsKTtjJiYoZj0iaWYoJGV2ZW50LnRhcmdldC5jb21wb3NpbmcpcmV0dXJuOyIrZiksdWUodCwidmFsdWUiLCIoIitlKyIpIiksZGUodCx1LGYsbnVsbCwhMCksKHN8fGEpJiZkZSh0LCJibHVyIiwiJGZvcmNlVXBkYXRlKCkiKX0odCxyLGkpO2Vsc2UgaWYoIUpuLmlzUmVzZXJ2ZWRUYWcobykpcmV0dXJuIG1lKHQscixpKSwhMTtyZXR1cm4hMH0sdGV4dDpmdW5jdGlvbih0LGUpe2UudmFsdWUmJnVlKHQsInRleHRDb250ZW50IiwiX3MoIitlLnZhbHVlKyIpIil9LGh0bWw6ZnVuY3Rpb24odCxlKXtlLnZhbHVlJiZ1ZSh0LCJpbm5lckhUTUwiLCJfcygiK2UudmFsdWUrIikiKX19LGlzUHJlVGFnOmZ1bmN0aW9uKHQpe3JldHVybiJwcmUiPT09dH0saXNVbmFyeVRhZzptbyxtdXN0VXNlUHJvcDpmaSxjYW5CZUxlZnRPcGVuVGFnOnlvLGlzUmVzZXJ2ZWRUYWc6JGksZ2V0VGFnTmFtZXNwYWNlOkd0LHN0YXRpY0tleXM6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVkdWNlKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQuY29uY2F0KGUuc3RhdGljS2V5c3x8W10pfSxbXSkuam9pbigiLCIpfShpYSl9LGFhPXAoZnVuY3Rpb24odCl7cmV0dXJuIHUoInR5cGUsdGFnLGF0dHJzTGlzdCxhdHRyc01hcCxwbGFpbixwYXJlbnQsY2hpbGRyZW4sYXR0cnMiKyh0PyIsIit0OiIiKSl9KSxzYT0vXlxzKihbXHckX10rfFwoW14pXSo/XCkpXHMqPT58XmZ1bmN0aW9uXHMqXCgvLGNhPS9eXHMqW0EtWmEtel8kXVtcdyRdKig/OlwuW0EtWmEtel8kXVtcdyRdKnxcWycuKj8nXXxcWyIuKj8iXXxcW1xkK118XFtbQS1aYS16XyRdW1x3JF0qXSkqXHMqJC8sdWE9e2VzYzoyNyx0YWI6OSxlbnRlcjoxMyxzcGFjZTozMix1cDozOCxsZWZ0OjM3LHJpZ2h0OjM5LGRvd246NDAsZGVsZXRlOls4LDQ2XX0sbGE9ZnVuY3Rpb24odCl7cmV0dXJuImlmKCIrdCsiKXJldHVybiBudWxsOyJ9LGZhPXtzdG9wOiIkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7IixwcmV2ZW50OiIkZXZlbnQucHJldmVudERlZmF1bHQoKTsiLHNlbGY6bGEoIiRldmVudC50YXJnZXQgIT09ICRldmVudC5jdXJyZW50VGFyZ2V0IiksY3RybDpsYSgiISRldmVudC5jdHJsS2V5Iiksc2hpZnQ6bGEoIiEkZXZlbnQuc2hpZnRLZXkiKSxhbHQ6bGEoIiEkZXZlbnQuYWx0S2V5IiksbWV0YTpsYSgiISRldmVudC5tZXRhS2V5IiksbGVmdDpsYSgiJ2J1dHRvbicgaW4gJGV2ZW50ICYmICRldmVudC5idXR0b24gIT09IDAiKSxtaWRkbGU6bGEoIididXR0b24nIGluICRldmVudCAmJiAkZXZlbnQuYnV0dG9uICE9PSAxIikscmlnaHQ6bGEoIididXR0b24nIGluICRldmVudCAmJiAkZXZlbnQuYnV0dG9uICE9PSAyIil9LHBhPXtvbjpmdW5jdGlvbih0LGUpe3Qud3JhcExpc3RlbmVycz1mdW5jdGlvbih0KXtyZXR1cm4iX2coIit0KyIsIitlLnZhbHVlKyIpIn19LGJpbmQ6ZnVuY3Rpb24odCxlKXt0LndyYXBEYXRhPWZ1bmN0aW9uKG4pe3JldHVybiJfYigiK24rIiwnIit0LnRhZysiJywiK2UudmFsdWUrIiwiKyhlLm1vZGlmaWVycyYmZS5tb2RpZmllcnMucHJvcD8idHJ1ZSI6ImZhbHNlIikrKGUubW9kaWZpZXJzJiZlLm1vZGlmaWVycy5zeW5jPyIsdHJ1ZSI6IiIpKyIpIn19LGNsb2FrOnl9LGRhPWZ1bmN0aW9uKHQpe3RoaXMub3B0aW9ucz10LHRoaXMud2Fybj10Lndhcm58fHNlLHRoaXMudHJhbnNmb3Jtcz1jZSh0Lm1vZHVsZXMsInRyYW5zZm9ybUNvZGUiKSx0aGlzLmRhdGFHZW5GbnM9Y2UodC5tb2R1bGVzLCJnZW5EYXRhIiksdGhpcy5kaXJlY3RpdmVzPWgoaCh7fSxwYSksdC5kaXJlY3RpdmVzKTt2YXIgZT10LmlzUmVzZXJ2ZWRUYWd8fEJuO3RoaXMubWF5YmVDb21wb25lbnQ9ZnVuY3Rpb24odCl7cmV0dXJuIWUodC50YWcpfSx0aGlzLm9uY2VJZD0wLHRoaXMuc3RhdGljUmVuZGVyRm5zPVtdfSx2YT0obmV3IFJlZ0V4cCgiXFxiIisiZG8saWYsZm9yLGxldCxuZXcsdHJ5LHZhcixjYXNlLGVsc2Usd2l0aCxhd2FpdCxicmVhayxjYXRjaCxjbGFzcyxjb25zdCxzdXBlcix0aHJvdyx3aGlsZSx5aWVsZCxkZWxldGUsZXhwb3J0LGltcG9ydCxyZXR1cm4sc3dpdGNoLGRlZmF1bHQsZXh0ZW5kcyxmaW5hbGx5LGNvbnRpbnVlLGRlYnVnZ2VyLGZ1bmN0aW9uLGFyZ3VtZW50cyIuc3BsaXQoIiwiKS5qb2luKCJcXGJ8XFxiIikrIlxcYiIpLG5ldyBSZWdFeHAoIlxcYiIrImRlbGV0ZSx0eXBlb2Ysdm9pZCIuc3BsaXQoIiwiKS5qb2luKCJcXHMqXFwoW15cXCldKlxcKXxcXGIiKSsiXFxzKlxcKFteXFwpXSpcXCkiKSxmdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSl7ZnVuY3Rpb24gbihuLHIpe3ZhciBpPU9iamVjdC5jcmVhdGUoZSksbz1bXSxhPVtdO2lmKGkud2Fybj1mdW5jdGlvbih0LGUpeyhlP2E6bykucHVzaCh0KX0scil7ci5tb2R1bGVzJiYoaS5tb2R1bGVzPShlLm1vZHVsZXN8fFtdKS5jb25jYXQoci5tb2R1bGVzKSksci5kaXJlY3RpdmVzJiYoaS5kaXJlY3RpdmVzPWgoT2JqZWN0LmNyZWF0ZShlLmRpcmVjdGl2ZXN8fG51bGwpLHIuZGlyZWN0aXZlcykpO2Zvcih2YXIgcyBpbiByKSJtb2R1bGVzIiE9PXMmJiJkaXJlY3RpdmVzIiE9PXMmJihpW3NdPXJbc10pfXZhciBjPXQobixpKTtyZXR1cm4gYy5lcnJvcnM9byxjLnRpcHM9YSxjfXJldHVybntjb21waWxlOm4sY29tcGlsZVRvRnVuY3Rpb25zOmZ1bmN0aW9uKHQpe3ZhciBlPU9iamVjdC5jcmVhdGUobnVsbCk7cmV0dXJuIGZ1bmN0aW9uKG4scixpKXsocj1oKHt9LHIpKS53YXJuLGRlbGV0ZSByLndhcm47dmFyIG89ci5kZWxpbWl0ZXJzP1N0cmluZyhyLmRlbGltaXRlcnMpK246bjtpZihlW29dKXJldHVybiBlW29dO3ZhciBhPXQobixyKSxzPXt9LGM9W107cmV0dXJuIHMucmVuZGVyPVRuKGEucmVuZGVyLGMpLHMuc3RhdGljUmVuZGVyRm5zPWEuc3RhdGljUmVuZGVyRm5zLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gVG4odCxjKX0pLGVbb109c319KG4pfX19KGZ1bmN0aW9uKHQsZSl7dmFyIG49c24odC50cmltKCksZSk7ITEhPT1lLm9wdGltaXplJiZmdW5jdGlvbih0LGUpe3QmJihQbz1hYShlLnN0YXRpY0tleXN8fCIiKSxGbz1lLmlzUmVzZXJ2ZWRUYWd8fEJuLHBuKHQpLGRuKHQsITEpKX0obixlKTt2YXIgcj15bihuLGUpO3JldHVybnthc3Q6bixyZW5kZXI6ci5yZW5kZXIsc3RhdGljUmVuZGVyRm5zOnIuc3RhdGljUmVuZGVyRm5zfX0pKG9hKS5jb21waWxlVG9GdW5jdGlvbnMpLGhhPSEhR24mJkVuKCExKSxtYT0hIUduJiZFbighMCkseWE9cChmdW5jdGlvbih0KXt2YXIgZT1adCh0KTtyZXR1cm4gZSYmZS5pbm5lckhUTUx9KSxnYT1SdC5wcm90b3R5cGUuJG1vdW50O3JldHVybiBSdC5wcm90b3R5cGUuJG1vdW50PWZ1bmN0aW9uKHQsZSl7aWYoKHQ9dCYmWnQodCkpPT09ZG9jdW1lbnQuYm9keXx8dD09PWRvY3VtZW50LmRvY3VtZW50RWxlbWVudClyZXR1cm4gdGhpczt2YXIgbj10aGlzLiRvcHRpb25zO2lmKCFuLnJlbmRlcil7dmFyIHI9bi50ZW1wbGF0ZTtpZihyKWlmKCJzdHJpbmciPT10eXBlb2YgcikiIyI9PT1yLmNoYXJBdCgwKSYmKHI9eWEocikpO2Vsc2V7aWYoIXIubm9kZVR5cGUpcmV0dXJuIHRoaXM7cj1yLmlubmVySFRNTH1lbHNlIHQmJihyPWZ1bmN0aW9uKHQpe2lmKHQub3V0ZXJIVE1MKXJldHVybiB0Lm91dGVySFRNTDt2YXIgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTtyZXR1cm4gZS5hcHBlbmRDaGlsZCh0LmNsb25lTm9kZSghMCkpLGUuaW5uZXJIVE1MfSh0KSk7aWYocil7dmFyIGk9dmEocix7c2hvdWxkRGVjb2RlTmV3bGluZXM6aGEsc2hvdWxkRGVjb2RlTmV3bGluZXNGb3JIcmVmOm1hLGRlbGltaXRlcnM6bi5kZWxpbWl0ZXJzLGNvbW1lbnRzOm4uY29tbWVudHN9LHRoaXMpLG89aS5yZW5kZXIsYT1pLnN0YXRpY1JlbmRlckZucztuLnJlbmRlcj1vLG4uc3RhdGljUmVuZGVyRm5zPWF9fXJldHVybiBnYS5jYWxsKHRoaXMsdCxlKX0sUnQuY29tcGlsZT12YSxSdH0pOw0KLyogYXhpb3MgdjAuMTcuMCB8IChjKSAyMDE3IGJ5IE1hdHQgWmFicmlza2llICovCiFmdW5jdGlvbihlLHQpeyJvYmplY3QiPT10eXBlb2YgZXhwb3J0cyYmIm9iamVjdCI9PXR5cGVvZiBtb2R1bGU/bW9kdWxlLmV4cG9ydHM9dCgpOiJmdW5jdGlvbiI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFtdLHQpOiJvYmplY3QiPT10eXBlb2YgZXhwb3J0cz9leHBvcnRzLmF4aW9zPXQoKTplLmF4aW9zPXQoKX0odGhpcyxmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihlKXtmdW5jdGlvbiB0KHIpe2lmKG5bcl0pcmV0dXJuIG5bcl0uZXhwb3J0czt2YXIgbz1uW3JdPXtleHBvcnRzOnt9LGlkOnIsbG9hZGVkOiExfTtyZXR1cm4gZVtyXS5jYWxsKG8uZXhwb3J0cyxvLG8uZXhwb3J0cyx0KSxvLmxvYWRlZD0hMCxvLmV4cG9ydHN9dmFyIG49e307cmV0dXJuIHQubT1lLHQuYz1uLHQucD0iIix0KDApfShbZnVuY3Rpb24oZSx0LG4pe2UuZXhwb3J0cz1uKDEpfSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHIoZSl7dmFyIHQ9bmV3IHMoZSksbj1pKHMucHJvdG90eXBlLnJlcXVlc3QsdCk7cmV0dXJuIG8uZXh0ZW5kKG4scy5wcm90b3R5cGUsdCksby5leHRlbmQobix0KSxufXZhciBvPW4oMiksaT1uKDMpLHM9big1KSx1PW4oNiksYT1yKHUpO2EuQXhpb3M9cyxhLmNyZWF0ZT1mdW5jdGlvbihlKXtyZXR1cm4gcihvLm1lcmdlKHUsZSkpfSxhLkNhbmNlbD1uKDIzKSxhLkNhbmNlbFRva2VuPW4oMjQpLGEuaXNDYW5jZWw9bigyMCksYS5hbGw9ZnVuY3Rpb24oZSl7cmV0dXJuIFByb21pc2UuYWxsKGUpfSxhLnNwcmVhZD1uKDI1KSxlLmV4cG9ydHM9YSxlLmV4cG9ydHMuZGVmYXVsdD1hfSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHIoZSl7cmV0dXJuIltvYmplY3QgQXJyYXldIj09PVIuY2FsbChlKX1mdW5jdGlvbiBvKGUpe3JldHVybiJbb2JqZWN0IEFycmF5QnVmZmVyXSI9PT1SLmNhbGwoZSl9ZnVuY3Rpb24gaShlKXtyZXR1cm4idW5kZWZpbmVkIiE9dHlwZW9mIEZvcm1EYXRhJiZlIGluc3RhbmNlb2YgRm9ybURhdGF9ZnVuY3Rpb24gcyhlKXt2YXIgdDtyZXR1cm4gdD0idW5kZWZpbmVkIiE9dHlwZW9mIEFycmF5QnVmZmVyJiZBcnJheUJ1ZmZlci5pc1ZpZXc/QXJyYXlCdWZmZXIuaXNWaWV3KGUpOmUmJmUuYnVmZmVyJiZlLmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyfWZ1bmN0aW9uIHUoZSl7cmV0dXJuInN0cmluZyI9PXR5cGVvZiBlfWZ1bmN0aW9uIGEoZSl7cmV0dXJuIm51bWJlciI9PXR5cGVvZiBlfWZ1bmN0aW9uIGMoZSl7cmV0dXJuInVuZGVmaW5lZCI9PXR5cGVvZiBlfWZ1bmN0aW9uIGYoZSl7cmV0dXJuIG51bGwhPT1lJiYib2JqZWN0Ij09dHlwZW9mIGV9ZnVuY3Rpb24gcChlKXtyZXR1cm4iW29iamVjdCBEYXRlXSI9PT1SLmNhbGwoZSl9ZnVuY3Rpb24gZChlKXtyZXR1cm4iW29iamVjdCBGaWxlXSI9PT1SLmNhbGwoZSl9ZnVuY3Rpb24gbChlKXtyZXR1cm4iW29iamVjdCBCbG9iXSI9PT1SLmNhbGwoZSl9ZnVuY3Rpb24gaChlKXtyZXR1cm4iW29iamVjdCBGdW5jdGlvbl0iPT09Ui5jYWxsKGUpfWZ1bmN0aW9uIG0oZSl7cmV0dXJuIGYoZSkmJmgoZS5waXBlKX1mdW5jdGlvbiB5KGUpe3JldHVybiJ1bmRlZmluZWQiIT10eXBlb2YgVVJMU2VhcmNoUGFyYW1zJiZlIGluc3RhbmNlb2YgVVJMU2VhcmNoUGFyYW1zfWZ1bmN0aW9uIHcoZSl7cmV0dXJuIGUucmVwbGFjZSgvXlxzKi8sIiIpLnJlcGxhY2UoL1xzKiQvLCIiKX1mdW5jdGlvbiBnKCl7cmV0dXJuKCJ1bmRlZmluZWQiPT10eXBlb2YgbmF2aWdhdG9yfHwiUmVhY3ROYXRpdmUiIT09bmF2aWdhdG9yLnByb2R1Y3QpJiYoInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cmJiJ1bmRlZmluZWQiIT10eXBlb2YgZG9jdW1lbnQpfWZ1bmN0aW9uIHYoZSx0KXtpZihudWxsIT09ZSYmInVuZGVmaW5lZCIhPXR5cGVvZiBlKWlmKCJvYmplY3QiPT10eXBlb2YgZXx8cihlKXx8KGU9W2VdKSxyKGUpKWZvcih2YXIgbj0wLG89ZS5sZW5ndGg7bjxvO24rKyl0LmNhbGwobnVsbCxlW25dLG4sZSk7ZWxzZSBmb3IodmFyIGkgaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxpKSYmdC5jYWxsKG51bGwsZVtpXSxpLGUpfWZ1bmN0aW9uIHgoKXtmdW5jdGlvbiBlKGUsbil7Im9iamVjdCI9PXR5cGVvZiB0W25dJiYib2JqZWN0Ij09dHlwZW9mIGU/dFtuXT14KHRbbl0sZSk6dFtuXT1lfWZvcih2YXIgdD17fSxuPTAscj1hcmd1bWVudHMubGVuZ3RoO248cjtuKyspdihhcmd1bWVudHNbbl0sZSk7cmV0dXJuIHR9ZnVuY3Rpb24gYihlLHQsbil7cmV0dXJuIHYodCxmdW5jdGlvbih0LHIpe24mJiJmdW5jdGlvbiI9PXR5cGVvZiB0P2Vbcl09RSh0LG4pOmVbcl09dH0pLGV9dmFyIEU9bigzKSxDPW4oNCksUj1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO2UuZXhwb3J0cz17aXNBcnJheTpyLGlzQXJyYXlCdWZmZXI6byxpc0J1ZmZlcjpDLGlzRm9ybURhdGE6aSxpc0FycmF5QnVmZmVyVmlldzpzLGlzU3RyaW5nOnUsaXNOdW1iZXI6YSxpc09iamVjdDpmLGlzVW5kZWZpbmVkOmMsaXNEYXRlOnAsaXNGaWxlOmQsaXNCbG9iOmwsaXNGdW5jdGlvbjpoLGlzU3RyZWFtOm0saXNVUkxTZWFyY2hQYXJhbXM6eSxpc1N0YW5kYXJkQnJvd3NlckVudjpnLGZvckVhY2g6dixtZXJnZTp4LGV4dGVuZDpiLHRyaW06d319LGZ1bmN0aW9uKGUsdCl7InVzZSBzdHJpY3QiO2UuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3JldHVybiBmdW5jdGlvbigpe2Zvcih2YXIgbj1uZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCkscj0wO3I8bi5sZW5ndGg7cisrKW5bcl09YXJndW1lbnRzW3JdO3JldHVybiBlLmFwcGx5KHQsbil9fX0sZnVuY3Rpb24oZSx0KXtmdW5jdGlvbiBuKGUpe3JldHVybiEhZS5jb25zdHJ1Y3RvciYmImZ1bmN0aW9uIj09dHlwZW9mIGUuY29uc3RydWN0b3IuaXNCdWZmZXImJmUuY29uc3RydWN0b3IuaXNCdWZmZXIoZSl9ZnVuY3Rpb24gcihlKXtyZXR1cm4iZnVuY3Rpb24iPT10eXBlb2YgZS5yZWFkRmxvYXRMRSYmImZ1bmN0aW9uIj09dHlwZW9mIGUuc2xpY2UmJm4oZS5zbGljZSgwLDApKX0vKiEKCSAqIERldGVybWluZSBpZiBhbiBvYmplY3QgaXMgYSBCdWZmZXIKCSAqCgkgKiBAYXV0aG9yICAgRmVyb3NzIEFib3VraGFkaWplaCA8ZmVyb3NzQGZlcm9zcy5vcmc+IDxodHRwOi8vZmVyb3NzLm9yZz4KCSAqIEBsaWNlbnNlICBNSVQKCSAqLwplLmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPWUmJihuKGUpfHxyKGUpfHwhIWUuX2lzQnVmZmVyKX19LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gcihlKXt0aGlzLmRlZmF1bHRzPWUsdGhpcy5pbnRlcmNlcHRvcnM9e3JlcXVlc3Q6bmV3IHMscmVzcG9uc2U6bmV3IHN9fXZhciBvPW4oNiksaT1uKDIpLHM9bigxNyksdT1uKDE4KTtyLnByb3RvdHlwZS5yZXF1ZXN0PWZ1bmN0aW9uKGUpeyJzdHJpbmciPT10eXBlb2YgZSYmKGU9aS5tZXJnZSh7dXJsOmFyZ3VtZW50c1swXX0sYXJndW1lbnRzWzFdKSksZT1pLm1lcmdlKG8sdGhpcy5kZWZhdWx0cyx7bWV0aG9kOiJnZXQifSxlKSxlLm1ldGhvZD1lLm1ldGhvZC50b0xvd2VyQ2FzZSgpO3ZhciB0PVt1LHZvaWQgMF0sbj1Qcm9taXNlLnJlc29sdmUoZSk7Zm9yKHRoaXMuaW50ZXJjZXB0b3JzLnJlcXVlc3QuZm9yRWFjaChmdW5jdGlvbihlKXt0LnVuc2hpZnQoZS5mdWxmaWxsZWQsZS5yZWplY3RlZCl9KSx0aGlzLmludGVyY2VwdG9ycy5yZXNwb25zZS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3QucHVzaChlLmZ1bGZpbGxlZCxlLnJlamVjdGVkKX0pO3QubGVuZ3RoOyluPW4udGhlbih0LnNoaWZ0KCksdC5zaGlmdCgpKTtyZXR1cm4gbn0saS5mb3JFYWNoKFsiZGVsZXRlIiwiZ2V0IiwiaGVhZCIsIm9wdGlvbnMiXSxmdW5jdGlvbihlKXtyLnByb3RvdHlwZVtlXT1mdW5jdGlvbih0LG4pe3JldHVybiB0aGlzLnJlcXVlc3QoaS5tZXJnZShufHx7fSx7bWV0aG9kOmUsdXJsOnR9KSl9fSksaS5mb3JFYWNoKFsicG9zdCIsInB1dCIsInBhdGNoIl0sZnVuY3Rpb24oZSl7ci5wcm90b3R5cGVbZV09ZnVuY3Rpb24odCxuLHIpe3JldHVybiB0aGlzLnJlcXVlc3QoaS5tZXJnZShyfHx7fSx7bWV0aG9kOmUsdXJsOnQsZGF0YTpufSkpfX0pLGUuZXhwb3J0cz1yfSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHIoZSx0KXshaS5pc1VuZGVmaW5lZChlKSYmaS5pc1VuZGVmaW5lZChlWyJDb250ZW50LVR5cGUiXSkmJihlWyJDb250ZW50LVR5cGUiXT10KX1mdW5jdGlvbiBvKCl7dmFyIGU7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiBYTUxIdHRwUmVxdWVzdD9lPW4oOCk6InVuZGVmaW5lZCIhPXR5cGVvZiBwcm9jZXNzJiYoZT1uKDgpKSxlfXZhciBpPW4oMikscz1uKDcpLHU9eyJDb250ZW50LVR5cGUiOiJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQifSxhPXthZGFwdGVyOm8oKSx0cmFuc2Zvcm1SZXF1ZXN0OltmdW5jdGlvbihlLHQpe3JldHVybiBzKHQsIkNvbnRlbnQtVHlwZSIpLGkuaXNGb3JtRGF0YShlKXx8aS5pc0FycmF5QnVmZmVyKGUpfHxpLmlzQnVmZmVyKGUpfHxpLmlzU3RyZWFtKGUpfHxpLmlzRmlsZShlKXx8aS5pc0Jsb2IoZSk/ZTppLmlzQXJyYXlCdWZmZXJWaWV3KGUpP2UuYnVmZmVyOmkuaXNVUkxTZWFyY2hQYXJhbXMoZSk/KHIodCwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkO2NoYXJzZXQ9dXRmLTgiKSxlLnRvU3RyaW5nKCkpOmkuaXNPYmplY3QoZSk/KHIodCwiYXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04IiksSlNPTi5zdHJpbmdpZnkoZSkpOmV9XSx0cmFuc2Zvcm1SZXNwb25zZTpbZnVuY3Rpb24oZSl7aWYoInN0cmluZyI9PXR5cGVvZiBlKXRyeXtlPUpTT04ucGFyc2UoZSl9Y2F0Y2goZSl7fXJldHVybiBlfV0sdGltZW91dDowLHhzcmZDb29raWVOYW1lOiJYU1JGLVRPS0VOIix4c3JmSGVhZGVyTmFtZToiWC1YU1JGLVRPS0VOIixtYXhDb250ZW50TGVuZ3RoOi0xLHZhbGlkYXRlU3RhdHVzOmZ1bmN0aW9uKGUpe3JldHVybiBlPj0yMDAmJmU8MzAwfX07YS5oZWFkZXJzPXtjb21tb246e0FjY2VwdDoiYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qIn19LGkuZm9yRWFjaChbImRlbGV0ZSIsImdldCIsImhlYWQiXSxmdW5jdGlvbihlKXthLmhlYWRlcnNbZV09e319KSxpLmZvckVhY2goWyJwb3N0IiwicHV0IiwicGF0Y2giXSxmdW5jdGlvbihlKXthLmhlYWRlcnNbZV09aS5tZXJnZSh1KX0pLGUuZXhwb3J0cz1hfSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO3ZhciByPW4oMik7ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7ci5mb3JFYWNoKGUsZnVuY3Rpb24obixyKXtyIT09dCYmci50b1VwcGVyQ2FzZSgpPT09dC50b1VwcGVyQ2FzZSgpJiYoZVt0XT1uLGRlbGV0ZSBlW3JdKX0pfX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0Ijt2YXIgcj1uKDIpLG89big5KSxpPW4oMTIpLHM9bigxMyksdT1uKDE0KSxhPW4oMTApLGM9InVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cmJndpbmRvdy5idG9hJiZ3aW5kb3cuYnRvYS5iaW5kKHdpbmRvdyl8fG4oMTUpO2UuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24odCxmKXt2YXIgcD1lLmRhdGEsZD1lLmhlYWRlcnM7ci5pc0Zvcm1EYXRhKHApJiZkZWxldGUgZFsiQ29udGVudC1UeXBlIl07dmFyIGw9bmV3IFhNTEh0dHBSZXF1ZXN0LGg9Im9ucmVhZHlzdGF0ZWNoYW5nZSIsbT0hMTtpZih3aW5kb3cuWE1MSHR0cFJlcXVlc3R8fCJ1bmRlZmluZWQiPT10eXBlb2Ygd2luZG93fHwhd2luZG93LlhEb21haW5SZXF1ZXN0fHwid2l0aENyZWRlbnRpYWxzImluIGx8fHUoZS51cmwpfHwobD1uZXcgd2luZG93LlhEb21haW5SZXF1ZXN0LGg9Im9ubG9hZCIsbT0hMCxsLm9ucHJvZ3Jlc3M9ZnVuY3Rpb24oKXt9LGwub250aW1lb3V0PWZ1bmN0aW9uKCl7fSksZS5hdXRoKXt2YXIgeT1lLmF1dGgudXNlcm5hbWV8fCIiLHc9ZS5hdXRoLnBhc3N3b3JkfHwiIjtkLkF1dGhvcml6YXRpb249IkJhc2ljICIrYyh5KyI6Iit3KX1pZihsLm9wZW4oZS5tZXRob2QudG9VcHBlckNhc2UoKSxpKGUudXJsLGUucGFyYW1zLGUucGFyYW1zU2VyaWFsaXplciksITApLGwudGltZW91dD1lLnRpbWVvdXQsbFtoXT1mdW5jdGlvbigpe2lmKGwmJig0PT09bC5yZWFkeVN0YXRlfHxtKSYmKDAhPT1sLnN0YXR1c3x8bC5yZXNwb25zZVVSTCYmMD09PWwucmVzcG9uc2VVUkwuaW5kZXhPZigiZmlsZToiKSkpe3ZhciBuPSJnZXRBbGxSZXNwb25zZUhlYWRlcnMiaW4gbD9zKGwuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkpOm51bGwscj1lLnJlc3BvbnNlVHlwZSYmInRleHQiIT09ZS5yZXNwb25zZVR5cGU/bC5yZXNwb25zZTpsLnJlc3BvbnNlVGV4dCxpPXtkYXRhOnIsc3RhdHVzOjEyMjM9PT1sLnN0YXR1cz8yMDQ6bC5zdGF0dXMsc3RhdHVzVGV4dDoxMjIzPT09bC5zdGF0dXM/Ik5vIENvbnRlbnQiOmwuc3RhdHVzVGV4dCxoZWFkZXJzOm4sY29uZmlnOmUscmVxdWVzdDpsfTtvKHQsZixpKSxsPW51bGx9fSxsLm9uZXJyb3I9ZnVuY3Rpb24oKXtmKGEoIk5ldHdvcmsgRXJyb3IiLGUsbnVsbCxsKSksbD1udWxsfSxsLm9udGltZW91dD1mdW5jdGlvbigpe2YoYSgidGltZW91dCBvZiAiK2UudGltZW91dCsibXMgZXhjZWVkZWQiLGUsIkVDT05OQUJPUlRFRCIsbCkpLGw9bnVsbH0sci5pc1N0YW5kYXJkQnJvd3NlckVudigpKXt2YXIgZz1uKDE2KSx2PShlLndpdGhDcmVkZW50aWFsc3x8dShlLnVybCkpJiZlLnhzcmZDb29raWVOYW1lP2cucmVhZChlLnhzcmZDb29raWVOYW1lKTp2b2lkIDA7diYmKGRbZS54c3JmSGVhZGVyTmFtZV09dil9aWYoInNldFJlcXVlc3RIZWFkZXIiaW4gbCYmci5mb3JFYWNoKGQsZnVuY3Rpb24oZSx0KXsidW5kZWZpbmVkIj09dHlwZW9mIHAmJiJjb250ZW50LXR5cGUiPT09dC50b0xvd2VyQ2FzZSgpP2RlbGV0ZSBkW3RdOmwuc2V0UmVxdWVzdEhlYWRlcih0LGUpfSksZS53aXRoQ3JlZGVudGlhbHMmJihsLndpdGhDcmVkZW50aWFscz0hMCksZS5yZXNwb25zZVR5cGUpdHJ5e2wucmVzcG9uc2VUeXBlPWUucmVzcG9uc2VUeXBlfWNhdGNoKHQpe2lmKCJqc29uIiE9PWUucmVzcG9uc2VUeXBlKXRocm93IHR9ImZ1bmN0aW9uIj09dHlwZW9mIGUub25Eb3dubG9hZFByb2dyZXNzJiZsLmFkZEV2ZW50TGlzdGVuZXIoInByb2dyZXNzIixlLm9uRG93bmxvYWRQcm9ncmVzcyksImZ1bmN0aW9uIj09dHlwZW9mIGUub25VcGxvYWRQcm9ncmVzcyYmbC51cGxvYWQmJmwudXBsb2FkLmFkZEV2ZW50TGlzdGVuZXIoInByb2dyZXNzIixlLm9uVXBsb2FkUHJvZ3Jlc3MpLGUuY2FuY2VsVG9rZW4mJmUuY2FuY2VsVG9rZW4ucHJvbWlzZS50aGVuKGZ1bmN0aW9uKGUpe2wmJihsLmFib3J0KCksZihlKSxsPW51bGwpfSksdm9pZCAwPT09cCYmKHA9bnVsbCksbC5zZW5kKHApfSl9fSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO3ZhciByPW4oMTApO2UuZXhwb3J0cz1mdW5jdGlvbihlLHQsbil7dmFyIG89bi5jb25maWcudmFsaWRhdGVTdGF0dXM7bi5zdGF0dXMmJm8mJiFvKG4uc3RhdHVzKT90KHIoIlJlcXVlc3QgZmFpbGVkIHdpdGggc3RhdHVzIGNvZGUgIituLnN0YXR1cyxuLmNvbmZpZyxudWxsLG4ucmVxdWVzdCxuKSk6ZShuKX19LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7dmFyIHI9bigxMSk7ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCxuLG8saSl7dmFyIHM9bmV3IEVycm9yKGUpO3JldHVybiByKHMsdCxuLG8saSl9fSxmdW5jdGlvbihlLHQpeyJ1c2Ugc3RyaWN0IjtlLmV4cG9ydHM9ZnVuY3Rpb24oZSx0LG4scixvKXtyZXR1cm4gZS5jb25maWc9dCxuJiYoZS5jb2RlPW4pLGUucmVxdWVzdD1yLGUucmVzcG9uc2U9byxlfX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiByKGUpe3JldHVybiBlbmNvZGVVUklDb21wb25lbnQoZSkucmVwbGFjZSgvJTQwL2dpLCJAIikucmVwbGFjZSgvJTNBL2dpLCI6IikucmVwbGFjZSgvJTI0L2csIiQiKS5yZXBsYWNlKC8lMkMvZ2ksIiwiKS5yZXBsYWNlKC8lMjAvZywiKyIpLnJlcGxhY2UoLyU1Qi9naSwiWyIpLnJlcGxhY2UoLyU1RC9naSwiXSIpfXZhciBvPW4oMik7ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCxuKXtpZighdClyZXR1cm4gZTt2YXIgaTtpZihuKWk9bih0KTtlbHNlIGlmKG8uaXNVUkxTZWFyY2hQYXJhbXModCkpaT10LnRvU3RyaW5nKCk7ZWxzZXt2YXIgcz1bXTtvLmZvckVhY2godCxmdW5jdGlvbihlLHQpe251bGwhPT1lJiYidW5kZWZpbmVkIiE9dHlwZW9mIGUmJihvLmlzQXJyYXkoZSkmJih0Kz0iW10iKSxvLmlzQXJyYXkoZSl8fChlPVtlXSksby5mb3JFYWNoKGUsZnVuY3Rpb24oZSl7by5pc0RhdGUoZSk/ZT1lLnRvSVNPU3RyaW5nKCk6by5pc09iamVjdChlKSYmKGU9SlNPTi5zdHJpbmdpZnkoZSkpLHMucHVzaChyKHQpKyI9IityKGUpKX0pKX0pLGk9cy5qb2luKCImIil9cmV0dXJuIGkmJihlKz0oZS5pbmRleE9mKCI/Iik9PT0tMT8iPyI6IiYiKStpKSxlfX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0Ijt2YXIgcj1uKDIpLG89WyJhZ2UiLCJhdXRob3JpemF0aW9uIiwiY29udGVudC1sZW5ndGgiLCJjb250ZW50LXR5cGUiLCJldGFnIiwiZXhwaXJlcyIsImZyb20iLCJob3N0IiwiaWYtbW9kaWZpZWQtc2luY2UiLCJpZi11bm1vZGlmaWVkLXNpbmNlIiwibGFzdC1tb2RpZmllZCIsImxvY2F0aW9uIiwibWF4LWZvcndhcmRzIiwicHJveHktYXV0aG9yaXphdGlvbiIsInJlZmVyZXIiLCJyZXRyeS1hZnRlciIsInVzZXItYWdlbnQiXTtlLmV4cG9ydHM9ZnVuY3Rpb24oZSl7dmFyIHQsbixpLHM9e307cmV0dXJuIGU/KHIuZm9yRWFjaChlLnNwbGl0KCJcbiIpLGZ1bmN0aW9uKGUpe2lmKGk9ZS5pbmRleE9mKCI6IiksdD1yLnRyaW0oZS5zdWJzdHIoMCxpKSkudG9Mb3dlckNhc2UoKSxuPXIudHJpbShlLnN1YnN0cihpKzEpKSx0KXtpZihzW3RdJiZvLmluZGV4T2YodCk+PTApcmV0dXJuOyJzZXQtY29va2llIj09PXQ/c1t0XT0oc1t0XT9zW3RdOltdKS5jb25jYXQoW25dKTpzW3RdPXNbdF0/c1t0XSsiLCAiK246bn19KSxzKTpzfX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0Ijt2YXIgcj1uKDIpO2UuZXhwb3J0cz1yLmlzU3RhbmRhcmRCcm93c2VyRW52KCk/ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe3ZhciB0PWU7cmV0dXJuIG4mJihvLnNldEF0dHJpYnV0ZSgiaHJlZiIsdCksdD1vLmhyZWYpLG8uc2V0QXR0cmlidXRlKCJocmVmIix0KSx7aHJlZjpvLmhyZWYscHJvdG9jb2w6by5wcm90b2NvbD9vLnByb3RvY29sLnJlcGxhY2UoLzokLywiIik6IiIsaG9zdDpvLmhvc3Qsc2VhcmNoOm8uc2VhcmNoP28uc2VhcmNoLnJlcGxhY2UoL15cPy8sIiIpOiIiLGhhc2g6by5oYXNoP28uaGFzaC5yZXBsYWNlKC9eIy8sIiIpOiIiLGhvc3RuYW1lOm8uaG9zdG5hbWUscG9ydDpvLnBvcnQscGF0aG5hbWU6Ii8iPT09by5wYXRobmFtZS5jaGFyQXQoMCk/by5wYXRobmFtZToiLyIrby5wYXRobmFtZX19dmFyIHQsbj0vKG1zaWV8dHJpZGVudCkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpLG89ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpO3JldHVybiB0PWUod2luZG93LmxvY2F0aW9uLmhyZWYpLGZ1bmN0aW9uKG4pe3ZhciBvPXIuaXNTdHJpbmcobik/ZShuKTpuO3JldHVybiBvLnByb3RvY29sPT09dC5wcm90b2NvbCYmby5ob3N0PT09dC5ob3N0fX0oKTpmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiEwfX0oKX0sZnVuY3Rpb24oZSx0KXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbigpe3RoaXMubWVzc2FnZT0iU3RyaW5nIGNvbnRhaW5zIGFuIGludmFsaWQgY2hhcmFjdGVyIn1mdW5jdGlvbiByKGUpe2Zvcih2YXIgdCxyLGk9U3RyaW5nKGUpLHM9IiIsdT0wLGE9bztpLmNoYXJBdCgwfHUpfHwoYT0iPSIsdSUxKTtzKz1hLmNoYXJBdCg2MyZ0Pj44LXUlMSo4KSl7aWYocj1pLmNoYXJDb2RlQXQodSs9Ljc1KSxyPjI1NSl0aHJvdyBuZXcgbjt0PXQ8PDh8cn1yZXR1cm4gc312YXIgbz0iQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz0iO24ucHJvdG90eXBlPW5ldyBFcnJvcixuLnByb3RvdHlwZS5jb2RlPTUsbi5wcm90b3R5cGUubmFtZT0iSW52YWxpZENoYXJhY3RlckVycm9yIixlLmV4cG9ydHM9cn0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0Ijt2YXIgcj1uKDIpO2UuZXhwb3J0cz1yLmlzU3RhbmRhcmRCcm93c2VyRW52KCk/ZnVuY3Rpb24oKXtyZXR1cm57d3JpdGU6ZnVuY3Rpb24oZSx0LG4sbyxpLHMpe3ZhciB1PVtdO3UucHVzaChlKyI9IitlbmNvZGVVUklDb21wb25lbnQodCkpLHIuaXNOdW1iZXIobikmJnUucHVzaCgiZXhwaXJlcz0iK25ldyBEYXRlKG4pLnRvR01UU3RyaW5nKCkpLHIuaXNTdHJpbmcobykmJnUucHVzaCgicGF0aD0iK28pLHIuaXNTdHJpbmcoaSkmJnUucHVzaCgiZG9tYWluPSIraSkscz09PSEwJiZ1LnB1c2goInNlY3VyZSIpLGRvY3VtZW50LmNvb2tpZT11LmpvaW4oIjsgIil9LHJlYWQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZG9jdW1lbnQuY29va2llLm1hdGNoKG5ldyBSZWdFeHAoIihefDtcXHMqKSgiK2UrIik9KFteO10qKSIpKTtyZXR1cm4gdD9kZWNvZGVVUklDb21wb25lbnQodFszXSk6bnVsbH0scmVtb3ZlOmZ1bmN0aW9uKGUpe3RoaXMud3JpdGUoZSwiIixEYXRlLm5vdygpLTg2NGU1KX19fSgpOmZ1bmN0aW9uKCl7cmV0dXJue3dyaXRlOmZ1bmN0aW9uKCl7fSxyZWFkOmZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LHJlbW92ZTpmdW5jdGlvbigpe319fSgpfSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHIoKXt0aGlzLmhhbmRsZXJzPVtdfXZhciBvPW4oMik7ci5wcm90b3R5cGUudXNlPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuaGFuZGxlcnMucHVzaCh7ZnVsZmlsbGVkOmUscmVqZWN0ZWQ6dH0pLHRoaXMuaGFuZGxlcnMubGVuZ3RoLTF9LHIucHJvdG90eXBlLmVqZWN0PWZ1bmN0aW9uKGUpe3RoaXMuaGFuZGxlcnNbZV0mJih0aGlzLmhhbmRsZXJzW2VdPW51bGwpfSxyLnByb3RvdHlwZS5mb3JFYWNoPWZ1bmN0aW9uKGUpe28uZm9yRWFjaCh0aGlzLmhhbmRsZXJzLGZ1bmN0aW9uKHQpe251bGwhPT10JiZlKHQpfSl9LGUuZXhwb3J0cz1yfSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHIoZSl7ZS5jYW5jZWxUb2tlbiYmZS5jYW5jZWxUb2tlbi50aHJvd0lmUmVxdWVzdGVkKCl9dmFyIG89bigyKSxpPW4oMTkpLHM9bigyMCksdT1uKDYpLGE9bigyMSksYz1uKDIyKTtlLmV4cG9ydHM9ZnVuY3Rpb24oZSl7cihlKSxlLmJhc2VVUkwmJiFhKGUudXJsKSYmKGUudXJsPWMoZS5iYXNlVVJMLGUudXJsKSksZS5oZWFkZXJzPWUuaGVhZGVyc3x8e30sZS5kYXRhPWkoZS5kYXRhLGUuaGVhZGVycyxlLnRyYW5zZm9ybVJlcXVlc3QpLGUuaGVhZGVycz1vLm1lcmdlKGUuaGVhZGVycy5jb21tb258fHt9LGUuaGVhZGVyc1tlLm1ldGhvZF18fHt9LGUuaGVhZGVyc3x8e30pLG8uZm9yRWFjaChbImRlbGV0ZSIsImdldCIsImhlYWQiLCJwb3N0IiwicHV0IiwicGF0Y2giLCJjb21tb24iXSxmdW5jdGlvbih0KXtkZWxldGUgZS5oZWFkZXJzW3RdfSk7dmFyIHQ9ZS5hZGFwdGVyfHx1LmFkYXB0ZXI7cmV0dXJuIHQoZSkudGhlbihmdW5jdGlvbih0KXtyZXR1cm4gcihlKSx0LmRhdGE9aSh0LmRhdGEsdC5oZWFkZXJzLGUudHJhbnNmb3JtUmVzcG9uc2UpLHR9LGZ1bmN0aW9uKHQpe3JldHVybiBzKHQpfHwocihlKSx0JiZ0LnJlc3BvbnNlJiYodC5yZXNwb25zZS5kYXRhPWkodC5yZXNwb25zZS5kYXRhLHQucmVzcG9uc2UuaGVhZGVycyxlLnRyYW5zZm9ybVJlc3BvbnNlKSkpLFByb21pc2UucmVqZWN0KHQpfSl9fSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO3ZhciByPW4oMik7ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gci5mb3JFYWNoKG4sZnVuY3Rpb24obil7ZT1uKGUsdCl9KSxlfX0sZnVuY3Rpb24oZSx0KXsidXNlIHN0cmljdCI7ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiEoIWV8fCFlLl9fQ0FOQ0VMX18pfX0sZnVuY3Rpb24oZSx0KXsidXNlIHN0cmljdCI7ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybi9eKFthLXpdW2EtelxkXCtcLVwuXSo6KT9cL1wvL2kudGVzdChlKX19LGZ1bmN0aW9uKGUsdCl7InVzZSBzdHJpY3QiO2UuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3JldHVybiB0P2UucmVwbGFjZSgvXC8rJC8sIiIpKyIvIit0LnJlcGxhY2UoL15cLysvLCIiKTplfX0sZnVuY3Rpb24oZSx0KXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbihlKXt0aGlzLm1lc3NhZ2U9ZX1uLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiJDYW5jZWwiKyh0aGlzLm1lc3NhZ2U/IjogIit0aGlzLm1lc3NhZ2U6IiIpfSxuLnByb3RvdHlwZS5fX0NBTkNFTF9fPSEwLGUuZXhwb3J0cz1ufSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHIoZSl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIGUpdGhyb3cgbmV3IFR5cGVFcnJvcigiZXhlY3V0b3IgbXVzdCBiZSBhIGZ1bmN0aW9uLiIpO3ZhciB0O3RoaXMucHJvbWlzZT1uZXcgUHJvbWlzZShmdW5jdGlvbihlKXt0PWV9KTt2YXIgbj10aGlzO2UoZnVuY3Rpb24oZSl7bi5yZWFzb258fChuLnJlYXNvbj1uZXcgbyhlKSx0KG4ucmVhc29uKSl9KX12YXIgbz1uKDIzKTtyLnByb3RvdHlwZS50aHJvd0lmUmVxdWVzdGVkPWZ1bmN0aW9uKCl7aWYodGhpcy5yZWFzb24pdGhyb3cgdGhpcy5yZWFzb259LHIuc291cmNlPWZ1bmN0aW9uKCl7dmFyIGUsdD1uZXcgcihmdW5jdGlvbih0KXtlPXR9KTtyZXR1cm57dG9rZW46dCxjYW5jZWw6ZX19LGUuZXhwb3J0cz1yfSxmdW5jdGlvbihlLHQpeyJ1c2Ugc3RyaWN0IjtlLmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybiBlLmFwcGx5KG51bGwsdCl9fX1dKX0pOwoNCi8vIOezu+e1semMr+iqpOimlueqlw0KZnVuY3Rpb24gZXJyb3JNb2RhbChtZXNzYWdlKSB7DQogICAgJC51bmJsb2NrVUkoKTsNCiAgICBzd2FsKHsNCiAgICAgICAgdGl0bGU6ICLmk43kvZzlpLHmlZciLA0KICAgICAgICBodG1sOiAi6KuL5rS957O757Wx566h55CG5ZOhITxiclw+IiArICghbWVzc2FnZSA/ICIiIDogbWVzc2FnZS5yZXBsYWNlKC9eLio/PGJvZHlbXj5dKj4oLio/KTxcL2JvZHk+Lio/JC9pLCAiJDEiKSksDQogICAgICAgIHR5cGU6ICJlcnJvciIsDQogICAgICAgIC8vdGltZXI6IDMwMDAsDQogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAi56K65a6aIiwNCiAgICAgICAgd2lkdGg6ICghbWVzc2FnZSA/IDUwMCA6IDEyMDApDQogICAgfSkudGhlbigNCiAgICAgICAgZnVuY3Rpb24gKHJlc3VsdCkgeyB9DQogICAgKTsNCn0NCg0KLy8g5YSy5a2Y5pmC5ZG85Y+r55qEZnVuY3Rpb24NCi8vIOeCuuS6humBv+WFjUNTUkbmlLvmk4osIOacg+WPluW+l1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbg0KLy8g5YWI5LiK5YKz5qqU5qGILCDlho3lr6vlhaVEQg0KZnVuY3Rpb24gYWpheFVwbG9hZChzYXZlVXJsLCBkYXRhLCB1cGxvYWRVcmwsIGZvcm1kYXRhKSB7DQogICAgLy9hbGVydChKU09OLnN0cmluZ2lmeShkYXRhKSk7DQoNCiAgICAkLmFqYXgoew0KICAgICAgICB1cmw6IHNhdmVVcmwsDQogICAgICAgIHR5cGU6ICJQT1NUIiwNCiAgICAgICAgZGF0YVR5cGU6ICdqc29uJywNCiAgICAgICAgZGF0YTogew0KICAgICAgICAgICAgX19SZXF1ZXN0VmVyaWZpY2F0aW9uVG9rZW46ICQoJ1tuYW1lPV9fUmVxdWVzdFZlcmlmaWNhdGlvblRva2VuXScpLnZhbCgpLA0KICAgICAgICAgICAgZm9ybTogZGF0YQ0KICAgICAgICB9LA0KICAgICAgICBiZWZvcmVTZW5kOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBibG9ja1VJKCk7DQogICAgICAgIH0sDQogICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7DQogICAgICAgICAgICAkLmFqYXgoew0KICAgICAgICAgICAgICAgIHVybDogdXBsb2FkVXJsLA0KICAgICAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwNCiAgICAgICAgICAgICAgICBkYXRhOiBmb3JtZGF0YSwNCiAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogZmFsc2UsDQogICAgICAgICAgICAgICAgcHJvY2Vzc0RhdGE6IGZhbHNlLA0KICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXNwb25zZSkgew0KICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KHJlc3BvbnNlKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGFqYXhSZXNwb25zZSgi5YSy5a2YIiwgZGF0YSk7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgYWpheE9wdGlvbnMsIHRocm93bkVycm9yKSB7DQogICAgICAgICAgICAgICAgICAgIGVycm9yTW9kYWwoeGhyLnJlc3BvbnNlVGV4dCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQoNCg0KDQogICAgICAgIH0sDQogICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBhamF4T3B0aW9ucywgdGhyb3duRXJyb3IpIHsNCiAgICAgICAgICAgIGVycm9yTW9kYWwoeGhyLnJlc3BvbnNlVGV4dCk7DQogICAgICAgIH0sDQogICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAkLnVuYmxvY2tVSSgpOw0KICAgICAgICB9DQogICAgfSk7DQp9DQoNCg0KLy8g5YSy5a2Y5pmC5ZG85Y+r55qEZnVuY3Rpb24NCi8vIOeCuuS6humBv+WFjUNTUkbmlLvmk4osIOacg+WPluW+l1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbg0KLy8g56ys5LqM5YCL5Y+D5pW454K655Wr6Z2i6LOH5paZLCDmnKrlgrPlhaXmmYLpoJDoqK3mipNbbmFtZT1mb3JtXeWOu3NlcmlhbGl6ZQ0KZnVuY3Rpb24gYWpheFNhdmUoc2F2ZVVybCwgZGF0YSkgew0KICAgIC8vYWxlcnQoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOw0KDQogICAgJC5hamF4KHsNCiAgICAgICAgdXJsOiBzYXZlVXJsLA0KICAgICAgICB0eXBlOiAiUE9TVCIsDQogICAgICAgIGRhdGFUeXBlOiAnanNvbicsDQogICAgICAgIGRhdGE6IHsNCiAgICAgICAgICAgIF9fUmVxdWVzdFZlcmlmaWNhdGlvblRva2VuOiAkKCdbbmFtZT1fX1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbl0nKS52YWwoKSwNCiAgICAgICAgICAgIGZvcm06IGRhdGENCiAgICAgICAgfSwNCiAgICAgICAgYmVmb3JlU2VuZDogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgYmxvY2tVSSgpOw0KICAgICAgICB9LA0KICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgew0KICAgICAgICAgICAgYWpheFJlc3BvbnNlKCLlhLLlrZgiLCBkYXRhKTsNCiAgICAgICAgfSwNCiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIGFqYXhPcHRpb25zLCB0aHJvd25FcnJvcikgew0KICAgICAgICAgICAgZXJyb3JNb2RhbCh4aHIucmVzcG9uc2VUZXh0KTsNCiAgICAgICAgfSwNCiAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICQudW5ibG9ja1VJKCk7DQogICAgICAgIH0NCiAgICB9KTsNCn0NCg0KLy8gYWpheOWbnuimhuioiuaBrw0KZnVuY3Rpb24gYWpheFJlc3BvbnNlKGFjdGlvblR5cGVUZXh0LCBkYXRhLCBtZXNzYWdlLCBlbGFwc2UpIHsNCiAgICBpZiAoIWRhdGEuU3VjY2Vzcykgew0KICAgICAgICAkKCIudmFsaWRhdGlvbi1zdW1tYXJ5LWVycm9ycyB1bCBsaSIpLnJlbW92ZSgpOw0KICAgICAgICAkLmVhY2goZGF0YS5NZXNzYWdlLCBmdW5jdGlvbiAoaW5kZXgsIGl0ZW0pIHsNCiAgICAgICAgICAgICQoIi52YWxpZGF0aW9uLXN1bW1hcnktZXJyb3JzIHVsIikuYXBwZW5kKCQoIjxsaT4iKS50ZXh0KGl0ZW0pKTsNCiAgICAgICAgfSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgc3dhbCh7DQogICAgICAgICAgICB0aXRsZTogIuWujOaIkCIsDQogICAgICAgICAgICBodG1sOiAhbWVzc2FnZSA/IGFjdGlvblR5cGVUZXh0ICsgIuaIkOWKnyEiIDogbWVzc2FnZSwNCiAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwNCiAgICAgICAgICAgIHRpbWVyOiAhZWxhcHNlID8gMjAwMCA6IGVsYXBzZSwNCiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZQ0KICAgICAgICB9KS50aGVuKChyZXN1bHQpID0+IHsNCiAgICAgICAgICAgIGlmIChyZXN1bHQuZGlzbWlzcyA9PT0gc3dhbC5EaXNtaXNzUmVhc29uLnRpbWVyKSB7DQogICAgICAgICAgICAgICAgaWYgKCFkYXRhLkxpbmspIHsNCiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9IGRhdGEuTGluazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0NCn0NCg0KDQovLyDot7Poh7PliY3kuIDpoIENCmZ1bmN0aW9uIHByZXZpb3VzUGFnZShsaW5rKSB7DQogICAgbG9jYXRpb24uaHJlZiA9IGRvY3VtZW50LnJlZmVycmVyOw0KfQ0KDQovLyDliKrpmaTnorroqo3oppbnqpdmdW5jdGlvbg0KLy8g5pyD5YWI6Lez5Ye65Yiq6Zmk56K66KqNDQovLyDoi6XpqZforYnkuI3miJDlip8sIOacg+i3s+WHuumMr+iqpOioiuaBryjpoa/npLrlvoznq69jb250cm9sbGVyIG1lc3NhZ2UpDQovLyDoi6XliKrpmaTkuI3miJDlip8sIOacg+i3s+WHuuezu+e1semMr+iqpOioiuaBrw0KZnVuY3Rpb24gY29uZmlybURpYWxvZyhwYXRoLCBkZWxldGVLZXksIG1lc3NhZ2UpIHsNCiAgICB2YXIgZGF0YSA9IHt9Ow0KICAgIGRhdGEuX19SZXF1ZXN0VmVyaWZpY2F0aW9uVG9rZW4gPSAkKCdbbmFtZT1fX1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbl0nKS52YWwoKTsNCiAgICBkYXRhLmlkID0gZGVsZXRlS2V5Ow0KDQogICAgLy8gYWxlcnQocGF0aCk7DQogICAgLy8gYWxlcnQoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOw0KDQogICAgc3dhbCh7DQogICAgICAgIHRpdGxlOiAn56K66KqN6KaW56qXJywNCiAgICAgICAgdGV4dDogIueiuuiqjeimgSIgKyAoISFtZXNzYWdlID8gbWVzc2FnZSA6ICLliKrpmaQiKSArICLoqbLnrYbos4fmlpk/IiwNCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnLA0KICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLA0KICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwNCiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnorroqo0nLA0KICAgICAgICBjb25maXJtQnV0dG9uQ2xhc3M6ICdidG4gYnRuLXN1Y2Nlc3MnLA0KICAgICAgICBjYW5jZWxCdXR0b25Db2xvcjogJyNkMzMnLA0KICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5ZCmJywNCiAgICAgICAgY2FuY2VsQnV0dG9uQ2xhc3M6ICdidG4gYnRuLWRhbmdlcicNCiAgICB9KS50aGVuKA0KICAgICAgICBmdW5jdGlvbiAoaXNDb25maXJtKSB7DQogICAgICAgICAgICAkLmJsb2NrVUkoeyBtZXNzYWdlOiAiIiB9KTsNCiAgICAgICAgICAgICQuYWpheCh7DQogICAgICAgICAgICAgICAgdXJsOiBwYXRoLA0KICAgICAgICAgICAgICAgIHR5cGU6ICJERUxFVEUiLA0KICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsDQogICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgYWpheFJlc3BvbnNlKCghIW1lc3NhZ2UgPyBtZXNzYWdlIDogIuWIqumZpCIpLCBkYXRhKTsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBhamF4T3B0aW9ucywgdGhyb3duRXJyb3IpIHsNCiAgICAgICAgICAgICAgICAgICAgZXJyb3JNb2RhbCh4aHIucmVzcG9uc2VUZXh0KTsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICQudW5ibG9ja1VJKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0sDQogICAgICAgIGZ1bmN0aW9uIChkaXNtaXNzKSB7DQogICAgICAgICAgICBpZiAoZGlzbWlzcyA9PT0gJ2NhbmNlbCcpIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICApOw0KfQ0KDQoNCi8vIOeiuuiqjeimlueql2Z1bmN0aW9uDQovLyDmnIPlhYjot7Plh7rliKrpmaTnorroqo0NCi8vIOiLpempl+itieS4jeaIkOWKnywg5pyD6Lez5Ye66Yyv6Kqk6KiK5oGvKOmhr+ekuuW+jOerr2NvbnRyb2xsZXIgbWVzc2FnZSkNCi8vIOiLpeWIqumZpOS4jeaIkOWKnywg5pyD6Lez5Ye657O757Wx6Yyv6Kqk6KiK5oGvDQpmdW5jdGlvbiBjb25maXJtKHBhdGgsIGRhdGEsIG1lc3NhZ2UpIHsNCiAgICAvLyBhbGVydChwYXRoKTsNCiAgICBkYXRhLl9fUmVxdWVzdFZlcmlmaWNhdGlvblRva2VuID0gJCgnW25hbWU9X19SZXF1ZXN0VmVyaWZpY2F0aW9uVG9rZW5dJykudmFsKCk7DQoNCiAgICBzd2FsKHsNCiAgICAgICAgdGl0bGU6ICfnorroqo3oppbnqpcnLA0KICAgICAgICB0ZXh0OiAi56K66KqN6KaBIiArIG1lc3NhZ2UgKyAi6Kmy562G6LOH5paZPyIsDQogICAgICAgIHR5cGU6ICd3YXJuaW5nJywNCiAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwNCiAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsDQogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56K66KqNJywNCiAgICAgICAgY29uZmlybUJ1dHRvbkNsYXNzOiAnYnRuIGJ0bi1zdWNjZXNzJywNCiAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICcjZDMzJywNCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WQpicsDQogICAgICAgIGNhbmNlbEJ1dHRvbkNsYXNzOiAnYnRuIGJ0bi1kYW5nZXInDQogICAgfSkudGhlbigNCiAgICAgICAgZnVuY3Rpb24gKGlzQ29uZmlybSkgew0KICAgICAgICAgICAgJC5ibG9ja1VJKHsgbWVzc2FnZTogIiIgfSk7DQogICAgICAgICAgICAkLmFqYXgoew0KICAgICAgICAgICAgICAgIHVybDogcGF0aCwNCiAgICAgICAgICAgICAgICB0eXBlOiAiUE9TVCIsDQogICAgICAgICAgICAgICAgZGF0YTogZGF0YSwNCiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgew0KICAgICAgICAgICAgICAgICAgICBhamF4UmVzcG9uc2UobWVzc2FnZSwgZGF0YSk7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgYWpheE9wdGlvbnMsIHRocm93bkVycm9yKSB7DQogICAgICAgICAgICAgICAgICAgIGVycm9yTW9kYWwoeGhyLnJlc3BvbnNlVGV4dCk7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAkLnVuYmxvY2tVSSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9LA0KICAgICAgICBmdW5jdGlvbiAoZGlzbWlzcykgew0KICAgICAgICAgICAgaWYgKGRpc21pc3MgPT09ICdjYW5jZWwnKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgKTsNCn0NCg0KDQovL+mAmeijoeaYr+ioreWumnNlc3Npb24gdGltZW91dOWAkuaVuOaZgumWkw0KZnVuY3Rpb24gc2V0VGltZXIoc2Vjb25kcykgew0KDQogICAgdmFyIGludGVydmFsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgew0KICAgICAgICBpZiAoc2Vjb25kcyA+IDApIHsNCiAgICAgICAgICAgIHNlY29uZHMtLTsNCiAgICAgICAgICAgIC8vaWYgKHNlY29uZHMgJSAzID09IDAgKSBhbGVydChzZWNvbmRzKTsNCiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHNlY29uZHMpOw0KICAgICAgICAgICAgLy/lpoLmnpx0aW1lb3XlsLHmj5DnpLroqIrmga/nmbvlh7oNCiAgICAgICAgICAgIGlmIChzZWNvbmRzID09PSAwKSB7DQogICAgICAgICAgICAgICAgc3dhbCh7DQogICAgICAgICAgICAgICAgICAgIHRpdGxlOiAi55m75Ye6IiwNCiAgICAgICAgICAgICAgICAgICAgaHRtbDogIjxmb250IGNvbG9yPSdyZWQnPuaCqOeahOmWkue9ruaZgumWk+mBjuS5hSE8YnI+5bey6KKr57O757Wx55m75Ye677yM6KuL6YeN5paw55m75YWlITwvZm9udD4iLA0KICAgICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsDQogICAgICAgICAgICAgICAgICAgIHRpbWVyOiAzMDAwLA0KICAgICAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UNCiAgICAgICAgICAgICAgICB9KS50aGVuKA0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAocmVzdWx0KSB7IH0sDQogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChkaXNtaXNzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGlzbWlzcyA9PT0gJ3RpbWVyJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNsb2dvdXRGb3JtJykuc3VibWl0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0gZWxzZSB7IC8v5YCS5pW45pmC6ZaT5bey57WQ5p2f77yM5bCH6Kmy5L2/55So6ICF55m75Ye65bCO5ZCR55m75YWl6aCBDQogICAgICAgICAgICBjbGVhckludGVydmFsKGludGVydmFsKTsgLy/muIXpmaTmraTlgJLmlbjmlrnms5UNCiAgICAgICAgfQ0KICAgIH0sIDEwMDApOy8v6Kit5a6a5q+P56eS6ZCY5Z+36KGMDQoNCiAgICByZXR1cm4gaW50ZXJ2YWw7DQp9DQoNCi8vIOe3qOi8r+OAgeWIqumZpCBidXR0b24NCi8vIGVkaXRQYXRoIDog57eo6Lyv6Lev5b6RDQovLyBkZWxldGVQYXRoIDog5Yiq6Zmk6Lev5b6RIA0KLy8gaWQgOiBrZXkNCmZ1bmN0aW9uIGVkaXREZWxldGVCdXR0b24oZWRpdFBhdGgsIGRlbGV0ZVBhdGgsIGlkKSB7DQogICAgLy9hbGVydChidXR0b25zKTsNCiAgICByZXR1cm4gZWRpdEJ1dHRvbihlZGl0UGF0aCwgaWQpICsgZGVsZXRlQnV0dG9uKGRlbGV0ZVBhdGgsIGlkKTsNCn0NCg0KDQovLyDnt6jovK8gYnV0dG9uDQovLyBlZGl0UGF0aCA6IOe3qOi8r+i3r+W+kQ0KLy8gaWQgOiBrZXkNCmZ1bmN0aW9uIGVkaXRCdXR0b24oZWRpdFBhdGgsIGlkKSB7DQogICAgdmFyIGJ1dHRvbiA9ICI8YnV0dG9uIGNsYXNzPSdidG4gYnRuLXByaW1hcnkgYnRuLXNtJyBvbkNsaWNrPVwibG9jYXRpb24uaHJlZj0nIiArIGVkaXRQYXRoICsgaWQgKyAiJ1wiPjxpIGNsYXNzPSdmYSBmYS1lZGl0Jz48L2k+57eo6LyvPC9idXR0b24+ICI7DQoNCiAgICAvL2FsZXJ0KGJ1dHRvbnMpOw0KICAgIHJldHVybiBidXR0b247DQp9DQoNCi8vIOWIqumZpCBidXR0b24NCi8vIGRlbGV0ZVBhdGggOiDliKrpmaTot6/lvpEgDQovLyBpZCA6IGtleQ0KZnVuY3Rpb24gZGVsZXRlQnV0dG9uKGRlbGV0ZVBhdGgsIGlkKSB7DQogICAgdmFyIGJ1dHRvbiA9ICI8YnV0dG9uIGNsYXNzPSdidG4gYnRuLWRhbmdlciBidG4tc20nIG9uQ2xpY2s9J2NvbmZpcm1EaWFsb2coXCIiICsgZGVsZXRlUGF0aCArICJcIiwgXCIiICsgaWQgKyAiXCIpJz48aSBjbGFzcz0nZmEgZmEtcmVtb3ZlJz48L2k+5Yiq6ZmkPC9idXR0b24+ICI7DQoNCiAgICAvL2FsZXJ0KGJ1dHRvbik7DQogICAgcmV0dXJuIGJ1dHRvbjsNCn0NCg0KLy8g5YiX5Y2wIGJ1dHRvbg0KLy8gZWRpdFBhdGggOiDliJfljbDot6/lvpENCi8vIGlkIDoga2V5DQpmdW5jdGlvbiBwcmludEJ1dHRvbihwcmludFBhdGgsIGlkKSB7DQogICAgdmFyIGJ1dHRvbiA9ICI8YnV0dG9uIGNsYXNzPSdidG4gYnRuLWluZm8gYnRuLXNtJyBvbkNsaWNrPVwid2luZG93Lm9wZW4oJyIgKyBwcmludFBhdGggKyAiP2tleT0iICsgaWQgKyAiJywgJ19ibGFuaycpIFwiPjxpIGNsYXNzPSdmYSBmYS1lZGl0Jz48L2k+5YiX5Y2wPC9idXR0b24+ICI7DQogICAgLy9hbGVydChidXR0b25zKTsNCiAgICByZXR1cm4gYnV0dG9uOw0KfQ0KDQpmdW5jdGlvbiBlcnJvck1lc3NhZ2UobWVzc2FnZSkgew0KICAgIHN3YWwoew0KICAgICAgICB0aXRsZTogIumMr+iqpCIsDQogICAgICAgIHRleHQ6IG1lc3NhZ2UsDQogICAgICAgIHR5cGU6ICJlcnJvciIsDQogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAi56K65a6aIiwNCiAgICB9KTsNCn0NCg0KZnVuY3Rpb24gd2FybmluZ01lc3NhZ2UobWVzc2FnZSkgew0KICAgIHN3YWwoew0KICAgICAgICB0aXRsZTogIuitpuekuiIsDQogICAgICAgIHRleHQ6IG1lc3NhZ2UsDQogICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwNCiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICLnorrlrpoiLA0KICAgIH0pOw0KfQ0KDQpmdW5jdGlvbiBleHBvcnRFeGNlbChwYXRoLCBtb2RlbCwgZmlsZU5hbWUpIHsNCiAgICAvL2FsZXJ0KEpTT04uc3RyaW5naWZ5KG1vZGVsKSk7DQogICAgYmxvY2tVSSgpOw0KICAgIGF4aW9zLmdldChwYXRoLCB7DQogICAgICAgIHBhcmFtczogbW9kZWwsDQogICAgICAgIG1ldGhvZDogJ2dldCcsDQogICAgICAgIHdpdGhDcmVkZW50aWFsczogdHJ1ZSwNCiAgICAgICAgcmVzcG9uc2VUeXBlOiAnYmxvYicsDQogICAgICAgIGhlYWRlcnM6IHsNCiAgICAgICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnNwcmVhZHNoZWV0bWwuc2hlZXQnLA0KICAgICAgICB9LA0KICAgIH0pLnRoZW4oKHJlc3BvbnNlKSA9PiB7DQogICAgICAgIGRvd25sb2FkKHJlc3BvbnNlLmRhdGEsIGZpbGVOYW1lKTsNCiAgICAgICAgJC51bmJsb2NrVUkoKTsNCiAgICB9KTsNCn0NCg0KDQovLyDkuIrlgrPmqpTmoYgNCmZ1bmN0aW9uIHVwbG9hZEZpbGUoZmlsZSkgew0KICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOw0KICAgIHZhciBkZWZlcnJlZCA9ICQuRGVmZXJyZWQoKTsNCg0KICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZXZlbnQpIHsNCiAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShldmVudC50YXJnZXQucmVzdWx0KTsNCiAgICB9Ow0KDQogICAgcmVhZGVyLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgIGRlZmVycmVkLnJlamVjdCh0aGlzKTsNCiAgICB9Ow0KDQogICAgaWYgKC9eaW1hZ2UvLnRlc3QoZmlsZS50eXBlKSkgew0KICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICByZWFkZXIucmVhZEFzVGV4dChmaWxlKTsNCiAgICB9DQoNCiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpOw0KfQ0KLy8g5bCHSnNvbuaXpeacn+i9ieaIkOaXpeacn+agvOW8jw0KZnVuY3Rpb24gSnNvbjJEYXRlKHN0cikgew0KICAgIC8vYWxlcnQoc3RyKTsNCiAgICBpZiAoc3RyID09ICIvRGF0ZSgtNjIxMzU1OTY4MDAwMDApLyIpIHJldHVybiBudWxsOw0KICAgIHJldHVybiBuZXcgRGF0ZShwYXJzZUludChzdHIuc3Vic3RyKDYpLCAxMCkpLmYoInl5eXkvTU0vZGQiKTsNCn0NCg0KZnVuY3Rpb24gSVNPRGF0ZTJTdHIoc3RyKSB7DQogICAgcmV0dXJuIHN0ci5zdWJzdHJpbmcoMCwgMTApLnJlcGxhY2UoLy0vZywgIi8iKTsNCn0NCg0KZnVuY3Rpb24gZGF0ZTJTdHIoZGF0ZSkgew0KICAgIHZhciB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpOw0KICAgIHZhciBtb250aCA9IGxwYWQoKGRhdGUuZ2V0TW9udGgoKSArIDEpLCAyLCAiMCIpOw0KICAgIHZhciBkYXkgPSBscGFkKGRhdGUuZ2V0RGF0ZSgpLCAyLCAiMCIpOw0KICAgIHJldHVybiBkYXRlID8gKHllYXIgKyAiLyIgKyBtb250aCArICIvIiArIGRheSkgOiAiIjsNCn0NCg0KZnVuY3Rpb24gcGFyc2VKc29uRGF0ZShqc29uRGF0ZVN0cmluZykgew0KICAgIHJldHVybiBuZXcgRGF0ZShwYXJzZUludChqc29uRGF0ZVN0cmluZy5yZXBsYWNlKCcvRGF0ZSgnLCAnJykpKTsNCn0NCg0KDQovLyDku7vmnJ/moLzlvI/ovYnmj5sNCmZ1bmN0aW9uIHBhcnNlRGF0ZShzdHIpIHsNCiAgICBpZiAoIXN0cikgcmV0dXJuIG51bGw7DQogICAgaWYgKGlzVmFsaWREYXRlKHN0cikpIHsNCiAgICAgICAgdmFyIHRlbXBEYXRlID0gc3RyLnNwbGl0KCcvJyk7DQogICAgICAgIHZhciB5ZWFyID0gdGVtcERhdGVbMF07IC8vIGFsZXJ0KHllYXIpOw0KICAgICAgICB2YXIgbW9udGggPSB0ZW1wRGF0ZVsxXTsgLy8gYWxlcnQobW9udGgpOw0KICAgICAgICB2YXIgZGF5ID0gdGVtcERhdGVbMl07IC8vIGFsZXJ0KGRheSk7DQogICAgICAgICAgICAgICAgDQogICAgICAgIC8vcGxlYXNlIHB1dCBhdHRlbnRpb24gdG8gdGhlIG1vbnRoIChwYXJ0c1swXSksIEphdmFzY3JpcHQgY291bnRzIG1vbnRocyBmcm9tIDANCiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHllYXIsIG1vbnRoIC0gMSwgZGF5KTsNCiAgICB9DQogICAgcmV0dXJuIHVuZGVmaW5lZDsNCn0NCg0KZnVuY3Rpb24gcmFuZ2Uoc3RhcnQsIGVuZCkgew0KICAgIHJldHVybiAobmV3IEFycmF5KGVuZCAtIHN0YXJ0ICsgMSkpLmZpbGwodW5kZWZpbmVkKS5tYXAoKF8sIGkpID0+IGkgKyBzdGFydCk7DQp9DQoNCg0KDQovLyDpqZforYnml6XmnJ8NCmZ1bmN0aW9uIGlzVmFsaWREYXRlKGRhdGVTdHJpbmcpIHsNCiAgICBpZiAoIS9eKFxkezR9KShcL3wtKShcZHsxLDJ9KShcL3wtKShcZHsxLDJ9KSQvLnRlc3QoZGF0ZVN0cmluZykgfHwgZGF0ZVN0cmluZy5sZW5ndGggIT0gMTApIHJldHVybiBmYWxzZTsNCg0KICAgIHZhciB0ZW1wRGF0ZSA9IGRhdGVTdHJpbmcuc3BsaXQoJy8nKTsNCiAgICB2YXIgdmFsaWQgPSB0cnVlOw0KICAgIHZhciB5ZWFyID0gdGVtcERhdGVbMF07IC8vIGFsZXJ0KHllYXIpOw0KICAgIHZhciBtb250aCA9IHRlbXBEYXRlWzFdOyAvLyBhbGVydChtb250aCk7DQogICAgdmFyIGRheSA9IHRlbXBEYXRlWzJdOyAvLyBhbGVydChkYXkpOw0KDQogICAgaWYgKChtb250aCA8IDEpIHx8IChtb250aCA+IDEyKSkgdmFsaWQgPSBmYWxzZTsNCiAgICBlbHNlIGlmICgoZGF5IDwgMSkgfHwgKGRheSA+IDMxKSkgdmFsaWQgPSBmYWxzZTsNCiAgICBlbHNlIGlmICgoKG1vbnRoID09IDQpIHx8IChtb250aCA9PSA2KSB8fCAobW9udGggPT0gOSkgfHwgKG1vbnRoID09IDExKSkgJiYgKGRheSA+IDMwKSkgdmFsaWQgPSBmYWxzZTsNCiAgICBlbHNlIGlmICgobW9udGggPT0gMikgJiYgKCgoeWVhciAlIDQwMCkgPT0gMCkgfHwgKCh5ZWFyICUgNCkgPT0gMCkpICYmICgoeWVhciAlIDEwMCkgIT0gMCkgJiYgKGRheSA+IDI5KSkgdmFsaWQgPSBmYWxzZTsNCiAgICBlbHNlIGlmICgobW9udGggPT0gMikgJiYgKCh5ZWFyICUgMTAwKSA9PSAwKSAmJiAoZGF5ID4gMjkpKSB2YWxpZCA9IGZhbHNlOw0KICAgIGVsc2UgaWYgKChtb250aCA9PSAyKSAmJiAoZGF5ID4gMjgpKSB2YWxpZCA9IGZhbHNlOw0KICAgIA0KICAgIHJldHVybiB2YWxpZDsNCn0NCg0KLy8g6YeR6Yyi56ym6JmfDQpmdW5jdGlvbiBmb3JtYXROdW1iZXIobnVtKSB7DQogICAgcmV0dXJuICghbnVtID8gMCA6IG51bS50b1N0cmluZygpLnJlcGxhY2UoLyhcZCkoPz0oXGR7M30pKyg/IVxkKSkvZywgIiQxLCIpKTsNCn0NCg0KLy8g5aKe5Yqg5aSp5pW4DQovLyB2YXIgZGF0ID0gbmV3IERhdGUoKTsNCi8vIGFsZXJ0KGRhdC5hZGREYXlzKDUpKQ0KRGF0ZS5wcm90b3R5cGUuYWRkRGF5cyA9IGZ1bmN0aW9uIChkYXlzKSB7DQogICAgdGhpcy5zZXREYXRlKHRoaXMuZ2V0RGF0ZSgpICsgZGF5cyk7DQogICAgcmV0dXJuIHRoaXM7DQp9DQoNCkRhdGUucHJvdG90eXBlLmFkZE1vbnRocyA9IGZ1bmN0aW9uICh2YWx1ZSkgew0KICAgIHZhciBuID0gdGhpcy5nZXREYXRlKCk7DQogICAgdGhpcy5zZXREYXRlKDEpOw0KICAgIHRoaXMuc2V0TW9udGgodGhpcy5nZXRNb250aCgpICsgdmFsdWUpOw0KICAgIHRoaXMuc2V0RGF0ZShNYXRoLm1pbihuLCB0aGlzLmdldERheXNJbk1vbnRoKCkpKTsNCiAgICByZXR1cm4gdGhpczsNCn07DQoNCmZ1bmN0aW9uIHBhZChudW1iZXIpIHsNCiAgICB2YXIgciA9IFN0cmluZyhudW1iZXIpOw0KICAgIGlmIChyLmxlbmd0aCA9PT0gMSkgew0KICAgICAgICByID0gJzAnICsgcjsNCiAgICB9DQogICAgcmV0dXJuIHI7DQp9DQoNCkRhdGUucHJvdG90eXBlLnRvSVNPU3RyaW5nID0gZnVuY3Rpb24gKCkgew0KICAgIHJldHVybiB0aGlzLmdldFVUQ0Z1bGxZZWFyKCkNCiAgICAgICAgKyAnLScgKyBwYWQodGhpcy5nZXRVVENNb250aCgpICsgMSkNCiAgICAgICAgKyAnLScgKyBwYWQodGhpcy5nZXRVVENEYXRlKCkpDQogICAgICAgICsgJ1QnICsgcGFkKHRoaXMuZ2V0VVRDSG91cnMoKSkNCiAgICAgICAgKyAnOicgKyBwYWQodGhpcy5nZXRVVENNaW51dGVzKCkpDQogICAgICAgICsgJzonICsgcGFkKHRoaXMuZ2V0VVRDU2Vjb25kcygpKQ0KICAgICAgICArICcuJyArIFN0cmluZygodGhpcy5nZXRVVENNaWxsaXNlY29uZHMoKSAvIDEwMDApLnRvRml4ZWQoMykpLnNsaWNlKDIsIDUpDQogICAgICAgICsgJ1onOw0KfTsNCg0KDQovLyBsZWZ0IHBhZGRpbmcgcyB3aXRoIGMgdG8gYSB0b3RhbCBvZiBuIGNoYXJzDQovLyBscGFkKCdldXJla2EnLCAxMCwgJyonKQ0KZnVuY3Rpb24gbHBhZChpbnB1dCwgd2lkdGgsIHBhZGRpbmcpIHsNCiAgICB2YXIgc3RyID0gJycgKyBpbnB1dDsNCiAgICB3aGlsZSAoc3RyLmxlbmd0aCA8IHdpZHRoKSB7DQogICAgICAgIHN0ciA9IHBhZGRpbmcgKyBzdHI7DQogICAgfQ0KICAgIHJldHVybiBzdHI7DQp9DQoNCi8vIHJpZ2h0IHBhZGRpbmcgcyB3aXRoIGMgdG8gYSB0b3RhbCBvZiBuIGNoYXJzDQovLyBycGFkKCdldXJla2EnLCAnKicsIDEwKQ0KZnVuY3Rpb24gcnBhZChzLCB3aWR0aCwgcGFkZGluZykgew0KICAgIHZhciBzdHIgPSAnJyArIGlucHV0Ow0KICAgIHdoaWxlIChzdHIubGVuZ3RoIDwgd2lkdGgpIHsNCiAgICAgICAgc3RyID0gc3RyICsgcGFkZGluZzsNCiAgICAgfQ0KICAgIHJldHVybiBzdHI7DQp9DQoNCmZ1bmN0aW9uIGRkbERlc2NyaXB0aW9uKGpzb25BcnJheSwgY29tcGFyZUtleSkgew0KICAgIGlmICghY29tcGFyZUtleSkgcmV0dXJuICIiOw0KICAgIHZhciByZXN1bHQgPSBqc29uQXJyYXkuZmlsdGVyKGZ1bmN0aW9uIChlbnRyeSkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZW50cnlbIkNvZGUiXSA9PT0gY29tcGFyZUtleTsNCiAgICAgICAgICAgICAgICB9KS5tYXAoZnVuY3Rpb24gKGVudHJ5KSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBlbnRyeVsiRGVzY3JpcHRpb24iXTsNCiAgICAgICAgICAgICAgICB9KTsNCg0KICAgIHJldHVybiByZXN1bHQudG9TdHJpbmcoKTsNCn0NCg0KDQpmdW5jdGlvbiBieXRlTGVuZ3RoKHN0cikgew0KICAgIC8vIHJldHVybnMgdGhlIGJ5dGUgbGVuZ3RoIG9mIGFuIHV0Zjggc3RyaW5nDQogICAgdmFyIHMgPSBzdHIubGVuZ3RoOw0KICAgIGZvciAodmFyIGkgPSBzdHIubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsNCiAgICAgICAgdmFyIGNvZGUgPSBzdHIuY2hhckNvZGVBdChpKTsNCiAgICAgICAgaWYgKGNvZGUgPiAweDdmICYmIGNvZGUgPD0gMHg3ZmYpIHMrKzsNCiAgICAgICAgZWxzZSBpZiAoY29kZSA+IDB4N2ZmICYmIGNvZGUgPD0gMHhmZmZmKSBzICs9IDI7DQogICAgICAgIGlmIChjb2RlID49IDB4REMwMCAmJiBjb2RlIDw9IDB4REZGRikgaS0tOyAvL3RyYWlsIHN1cnJvZ2F0ZQ0KICAgIH0NCiAgICByZXR1cm4gczsNCn0NCg0KZnVuY3Rpb24gY2FwaXRhbGl6ZUZpcnN0TGV0dGVyKHN0cmluZykgew0KICAgIHJldHVybiBzdHJpbmcuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBzdHJpbmcuc2xpY2UoMSk7DQp9DQovL2Rvd25sb2FkLmpzIHY0LjIxLCBieSBkYW5kYXZpczsgMjAwOC0yMDE4LiBbTUlUXSBzZWUgaHR0cDovL2Rhbm1sLmNvbS9kb3dubG9hZC5odG1sIGZvciB0ZXN0cy91c2FnZQo7KGZ1bmN0aW9uKHJvb3QsZmFjdG9yeSl7dHlwZW9mIGRlZmluZT09ImZ1bmN0aW9uIiYmZGVmaW5lLmFtZD9kZWZpbmUoW10sZmFjdG9yeSk6dHlwZW9mIGV4cG9ydHM9PSJvYmplY3QiP21vZHVsZS5leHBvcnRzPWZhY3RvcnkoKTpyb290LmRvd25sb2FkPWZhY3RvcnkoKX0pKHRoaXMsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24gZG93bmxvYWQoZGF0YSxzdHJGaWxlTmFtZSxzdHJNaW1lVHlwZSl7dmFyIHNlbGY9d2luZG93LGRlZmF1bHRNaW1lPSJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0iLG1pbWVUeXBlPXN0ck1pbWVUeXBlfHxkZWZhdWx0TWltZSxwYXlsb2FkPWRhdGEsdXJsPSFzdHJGaWxlTmFtZSYmIXN0ck1pbWVUeXBlJiZwYXlsb2FkLGFuY2hvcj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIiksdG9TdHJpbmc9ZnVuY3Rpb24oYSl7cmV0dXJuIFN0cmluZyhhKX0sbXlCbG9iPXNlbGYuQmxvYnx8c2VsZi5Nb3pCbG9ifHxzZWxmLldlYktpdEJsb2J8fHRvU3RyaW5nLGZpbGVOYW1lPXN0ckZpbGVOYW1lfHwiZG93bmxvYWQiLGJsb2IscmVhZGVyO215QmxvYj1teUJsb2IuY2FsbD9teUJsb2IuYmluZChzZWxmKTpCbG9iLFN0cmluZyh0aGlzKT09PSJ0cnVlIiYmKHBheWxvYWQ9W3BheWxvYWQsbWltZVR5cGVdLG1pbWVUeXBlPXBheWxvYWRbMF0scGF5bG9hZD1wYXlsb2FkWzFdKTtpZih1cmwmJnVybC5sZW5ndGg8MjA0OCl7ZmlsZU5hbWU9dXJsLnNwbGl0KCIvIikucG9wKCkuc3BsaXQoIj8iKVswXSxhbmNob3IuaHJlZj11cmw7aWYoYW5jaG9yLmhyZWYuaW5kZXhPZih1cmwpIT09LTEpe3ZhciBhamF4PW5ldyBYTUxIdHRwUmVxdWVzdDtyZXR1cm4gYWpheC5vcGVuKCJHRVQiLHVybCwhMCksYWpheC5yZXNwb25zZVR5cGU9ImJsb2IiLGFqYXgub25sb2FkPWZ1bmN0aW9uKGUpe2Rvd25sb2FkKGUudGFyZ2V0LnJlc3BvbnNlLGZpbGVOYW1lLGRlZmF1bHRNaW1lKX0sc2V0VGltZW91dChmdW5jdGlvbigpe2FqYXguc2VuZCgpfSwwKSxhamF4fX1pZigvXmRhdGE6KFtcdystXStcL1tcdysuLV0rKT9bLDtdLy50ZXN0KHBheWxvYWQpKXtpZighKHBheWxvYWQubGVuZ3RoPjIwOTYxMDMuNDI0JiZteUJsb2IhPT10b1N0cmluZykpcmV0dXJuIG5hdmlnYXRvci5tc1NhdmVCbG9iP25hdmlnYXRvci5tc1NhdmVCbG9iKGRhdGFVcmxUb0Jsb2IocGF5bG9hZCksZmlsZU5hbWUpOnNhdmVyKHBheWxvYWQpO3BheWxvYWQ9ZGF0YVVybFRvQmxvYihwYXlsb2FkKSxtaW1lVHlwZT1wYXlsb2FkLnR5cGV8fGRlZmF1bHRNaW1lfWVsc2UgaWYoLyhbXHg4MC1ceGZmXSkvLnRlc3QocGF5bG9hZCkpe3ZhciBpPTAsdGVtcFVpQXJyPW5ldyBVaW50OEFycmF5KHBheWxvYWQubGVuZ3RoKSxteD10ZW1wVWlBcnIubGVuZ3RoO2ZvcihpO2k8bXg7KytpKXRlbXBVaUFycltpXT1wYXlsb2FkLmNoYXJDb2RlQXQoaSk7cGF5bG9hZD1uZXcgbXlCbG9iKFt0ZW1wVWlBcnJdLHt0eXBlOm1pbWVUeXBlfSl9YmxvYj1wYXlsb2FkIGluc3RhbmNlb2YgbXlCbG9iP3BheWxvYWQ6bmV3IG15QmxvYihbcGF5bG9hZF0se3R5cGU6bWltZVR5cGV9KTtmdW5jdGlvbiBkYXRhVXJsVG9CbG9iKHN0clVybCl7dmFyIHBhcnRzPXN0clVybC5zcGxpdCgvWzo7LF0vKSx0eXBlPXBhcnRzWzFdLGluZGV4RGVjb2Rlcj1zdHJVcmwuaW5kZXhPZigiY2hhcnNldCIpPjA/MzoyLGRlY29kZXI9cGFydHNbaW5kZXhEZWNvZGVyXT09ImJhc2U2NCI/YXRvYjpkZWNvZGVVUklDb21wb25lbnQsYmluRGF0YT1kZWNvZGVyKHBhcnRzLnBvcCgpKSxteD1iaW5EYXRhLmxlbmd0aCxpPTAsdWlBcnI9bmV3IFVpbnQ4QXJyYXkobXgpO2ZvcihpO2k8bXg7KytpKXVpQXJyW2ldPWJpbkRhdGEuY2hhckNvZGVBdChpKTtyZXR1cm4gbmV3IG15QmxvYihbdWlBcnJdLHt0eXBlOnR5cGV9KX1mdW5jdGlvbiBzYXZlcih1cmwsd2luTW9kZSl7aWYoImRvd25sb2FkImluIGFuY2hvcilyZXR1cm4gYW5jaG9yLmhyZWY9dXJsLGFuY2hvci5zZXRBdHRyaWJ1dGUoImRvd25sb2FkIixmaWxlTmFtZSksYW5jaG9yLmNsYXNzTmFtZT0iZG93bmxvYWQtanMtbGluayIsYW5jaG9yLmlubmVySFRNTD0iZG93bmxvYWRpbmcuLi4iLGFuY2hvci5zdHlsZS5kaXNwbGF5PSJub25lIixhbmNob3IuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLGZ1bmN0aW9uKGUpe2Uuc3RvcFByb3BhZ2F0aW9uKCksdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCJjbGljayIsYXJndW1lbnRzLmNhbGxlZSl9KSxkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGFuY2hvciksc2V0VGltZW91dChmdW5jdGlvbigpe2FuY2hvci5jbGljaygpLGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoYW5jaG9yKSx3aW5Nb2RlPT09ITAmJnNldFRpbWVvdXQoZnVuY3Rpb24oKXtzZWxmLlVSTC5yZXZva2VPYmplY3RVUkwoYW5jaG9yLmhyZWYpfSwyNTApfSw2NiksITA7aWYoLyhWZXJzaW9uKVwvKFxkKylcLihcZCspKD86XC4oXGQrKSk/LipTYWZhcmlcLy8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSlyZXR1cm4vXmRhdGE6Ly50ZXN0KHVybCkmJih1cmw9ImRhdGE6Iit1cmwucmVwbGFjZSgvXmRhdGE6KFtcd1wvXC1cK10rKS8sZGVmYXVsdE1pbWUpKSx3aW5kb3cub3Blbih1cmwpfHxjb25maXJtKCJEaXNwbGF5aW5nIE5ldyBEb2N1bWVudFxuXG5Vc2UgU2F2ZSBBcy4uLiB0byBkb3dubG9hZCwgdGhlbiBjbGljayBiYWNrIHRvIHJldHVybiB0byB0aGlzIHBhZ2UuIikmJihsb2NhdGlvbi5ocmVmPXVybCksITA7dmFyIGY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaWZyYW1lIik7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChmKSwhd2luTW9kZSYmL15kYXRhOi8udGVzdCh1cmwpJiYodXJsPSJkYXRhOiIrdXJsLnJlcGxhY2UoL15kYXRhOihbXHdcL1wtXCtdKykvLGRlZmF1bHRNaW1lKSksZi5zcmM9dXJsLHNldFRpbWVvdXQoZnVuY3Rpb24oKXtkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGYpfSwzMzMpfWlmKG5hdmlnYXRvci5tc1NhdmVCbG9iKXJldHVybiBuYXZpZ2F0b3IubXNTYXZlQmxvYihibG9iLGZpbGVOYW1lKTtpZihzZWxmLlVSTClzYXZlcihzZWxmLlVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYiksITApO2Vsc2V7aWYodHlwZW9mIGJsb2I9PSJzdHJpbmcifHxibG9iLmNvbnN0cnVjdG9yPT09dG9TdHJpbmcpdHJ5e3JldHVybiBzYXZlcigiZGF0YToiK21pbWVUeXBlKyI7YmFzZTY0LCIrc2VsZi5idG9hKGJsb2IpKX1jYXRjaCh5KXtyZXR1cm4gc2F2ZXIoImRhdGE6IittaW1lVHlwZSsiLCIrZW5jb2RlVVJJQ29tcG9uZW50KGJsb2IpKX1yZWFkZXI9bmV3IEZpbGVSZWFkZXIscmVhZGVyLm9ubG9hZD1mdW5jdGlvbihlKXtzYXZlcih0aGlzLnJlc3VsdCl9LHJlYWRlci5yZWFkQXNEYXRhVVJMKGJsb2IpfXJldHVybiEwfX0pOwoNCiFmdW5jdGlvbihlLHQpeyJvYmplY3QiPT10eXBlb2YgZXhwb3J0cyYmInVuZGVmaW5lZCIhPXR5cGVvZiBtb2R1bGU/bW9kdWxlLmV4cG9ydHM9dCgpOiJmdW5jdGlvbiI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKHQpOmUubW9tZW50PXQoKX0odGhpcyxmdW5jdGlvbigpeyJ1c2Ugc3RyaWN0Ijt2YXIgZSxpO2Z1bmN0aW9uIGMoKXtyZXR1cm4gZS5hcHBseShudWxsLGFyZ3VtZW50cyl9ZnVuY3Rpb24gbyhlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIEFycmF5fHwiW29iamVjdCBBcnJheV0iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUpfWZ1bmN0aW9uIHUoZSl7cmV0dXJuIG51bGwhPWUmJiJbb2JqZWN0IE9iamVjdF0iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUpfWZ1bmN0aW9uIGwoZSl7cmV0dXJuIHZvaWQgMD09PWV9ZnVuY3Rpb24gZChlKXtyZXR1cm4ibnVtYmVyIj09dHlwZW9mIGV8fCJbb2JqZWN0IE51bWJlcl0iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUpfWZ1bmN0aW9uIGgoZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBEYXRlfHwiW29iamVjdCBEYXRlXSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZSl9ZnVuY3Rpb24gZihlLHQpe3ZhciBuLHM9W107Zm9yKG49MDtuPGUubGVuZ3RoOysrbilzLnB1c2godChlW25dLG4pKTtyZXR1cm4gc31mdW5jdGlvbiBtKGUsdCl7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLHQpfWZ1bmN0aW9uIF8oZSx0KXtmb3IodmFyIG4gaW4gdCltKHQsbikmJihlW25dPXRbbl0pO3JldHVybiBtKHQsInRvU3RyaW5nIikmJihlLnRvU3RyaW5nPXQudG9TdHJpbmcpLG0odCwidmFsdWVPZiIpJiYoZS52YWx1ZU9mPXQudmFsdWVPZiksZX1mdW5jdGlvbiB5KGUsdCxuLHMpe3JldHVybiBPdChlLHQsbixzLCEwKS51dGMoKX1mdW5jdGlvbiBnKGUpe3JldHVybiBudWxsPT1lLl9wZiYmKGUuX3BmPXtlbXB0eTohMSx1bnVzZWRUb2tlbnM6W10sdW51c2VkSW5wdXQ6W10sb3ZlcmZsb3c6LTIsY2hhcnNMZWZ0T3ZlcjowLG51bGxJbnB1dDohMSxpbnZhbGlkTW9udGg6bnVsbCxpbnZhbGlkRm9ybWF0OiExLHVzZXJJbnZhbGlkYXRlZDohMSxpc286ITEscGFyc2VkRGF0ZVBhcnRzOltdLG1lcmlkaWVtOm51bGwscmZjMjgyMjohMSx3ZWVrZGF5TWlzbWF0Y2g6ITF9KSxlLl9wZn1mdW5jdGlvbiBwKGUpe2lmKG51bGw9PWUuX2lzVmFsaWQpe3ZhciB0PWcoZSksbj1pLmNhbGwodC5wYXJzZWREYXRlUGFydHMsZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPWV9KSxzPSFpc05hTihlLl9kLmdldFRpbWUoKSkmJnQub3ZlcmZsb3c8MCYmIXQuZW1wdHkmJiF0LmludmFsaWRNb250aCYmIXQuaW52YWxpZFdlZWtkYXkmJiF0LndlZWtkYXlNaXNtYXRjaCYmIXQubnVsbElucHV0JiYhdC5pbnZhbGlkRm9ybWF0JiYhdC51c2VySW52YWxpZGF0ZWQmJighdC5tZXJpZGllbXx8dC5tZXJpZGllbSYmbik7aWYoZS5fc3RyaWN0JiYocz1zJiYwPT09dC5jaGFyc0xlZnRPdmVyJiYwPT09dC51bnVzZWRUb2tlbnMubGVuZ3RoJiZ2b2lkIDA9PT10LmJpZ0hvdXIpLG51bGwhPU9iamVjdC5pc0Zyb3plbiYmT2JqZWN0LmlzRnJvemVuKGUpKXJldHVybiBzO2UuX2lzVmFsaWQ9c31yZXR1cm4gZS5faXNWYWxpZH1mdW5jdGlvbiB2KGUpe3ZhciB0PXkoTmFOKTtyZXR1cm4gbnVsbCE9ZT9fKGcodCksZSk6Zyh0KS51c2VySW52YWxpZGF0ZWQ9ITAsdH1pPUFycmF5LnByb3RvdHlwZS5zb21lP0FycmF5LnByb3RvdHlwZS5zb21lOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1PYmplY3QodGhpcyksbj10Lmxlbmd0aD4+PjAscz0wO3M8bjtzKyspaWYocyBpbiB0JiZlLmNhbGwodGhpcyx0W3NdLHMsdCkpcmV0dXJuITA7cmV0dXJuITF9O3ZhciByPWMubW9tZW50UHJvcGVydGllcz1bXTtmdW5jdGlvbiB3KGUsdCl7dmFyIG4scyxpO2lmKGwodC5faXNBTW9tZW50T2JqZWN0KXx8KGUuX2lzQU1vbWVudE9iamVjdD10Ll9pc0FNb21lbnRPYmplY3QpLGwodC5faSl8fChlLl9pPXQuX2kpLGwodC5fZil8fChlLl9mPXQuX2YpLGwodC5fbCl8fChlLl9sPXQuX2wpLGwodC5fc3RyaWN0KXx8KGUuX3N0cmljdD10Ll9zdHJpY3QpLGwodC5fdHptKXx8KGUuX3R6bT10Ll90em0pLGwodC5faXNVVEMpfHwoZS5faXNVVEM9dC5faXNVVEMpLGwodC5fb2Zmc2V0KXx8KGUuX29mZnNldD10Ll9vZmZzZXQpLGwodC5fcGYpfHwoZS5fcGY9Zyh0KSksbCh0Ll9sb2NhbGUpfHwoZS5fbG9jYWxlPXQuX2xvY2FsZSksMDxyLmxlbmd0aClmb3Iobj0wO248ci5sZW5ndGg7bisrKWwoaT10W3M9cltuXV0pfHwoZVtzXT1pKTtyZXR1cm4gZX12YXIgdD0hMTtmdW5jdGlvbiBNKGUpe3codGhpcyxlKSx0aGlzLl9kPW5ldyBEYXRlKG51bGwhPWUuX2Q/ZS5fZC5nZXRUaW1lKCk6TmFOKSx0aGlzLmlzVmFsaWQoKXx8KHRoaXMuX2Q9bmV3IERhdGUoTmFOKSksITE9PT10JiYodD0hMCxjLnVwZGF0ZU9mZnNldCh0aGlzKSx0PSExKX1mdW5jdGlvbiBTKGUpe3JldHVybiBlIGluc3RhbmNlb2YgTXx8bnVsbCE9ZSYmbnVsbCE9ZS5faXNBTW9tZW50T2JqZWN0fWZ1bmN0aW9uIEQoZSl7cmV0dXJuIGU8MD9NYXRoLmNlaWwoZSl8fDA6TWF0aC5mbG9vcihlKX1mdW5jdGlvbiBrKGUpe3ZhciB0PStlLG49MDtyZXR1cm4gMCE9PXQmJmlzRmluaXRlKHQpJiYobj1EKHQpKSxufWZ1bmN0aW9uIGEoZSx0LG4pe3ZhciBzLGk9TWF0aC5taW4oZS5sZW5ndGgsdC5sZW5ndGgpLHI9TWF0aC5hYnMoZS5sZW5ndGgtdC5sZW5ndGgpLGE9MDtmb3Iocz0wO3M8aTtzKyspKG4mJmVbc10hPT10W3NdfHwhbiYmayhlW3NdKSE9PWsodFtzXSkpJiZhKys7cmV0dXJuIGErcn1mdW5jdGlvbiBZKGUpeyExPT09Yy5zdXBwcmVzc0RlcHJlY2F0aW9uV2FybmluZ3MmJiJ1bmRlZmluZWQiIT10eXBlb2YgY29uc29sZSYmY29uc29sZS53YXJuJiZjb25zb2xlLndhcm4oIkRlcHJlY2F0aW9uIHdhcm5pbmc6ICIrZSl9ZnVuY3Rpb24gbihpLHIpe3ZhciBhPSEwO3JldHVybiBfKGZ1bmN0aW9uKCl7aWYobnVsbCE9Yy5kZXByZWNhdGlvbkhhbmRsZXImJmMuZGVwcmVjYXRpb25IYW5kbGVyKG51bGwsaSksYSl7Zm9yKHZhciBlLHQ9W10sbj0wO248YXJndW1lbnRzLmxlbmd0aDtuKyspe2lmKGU9IiIsIm9iamVjdCI9PXR5cGVvZiBhcmd1bWVudHNbbl0pe2Zvcih2YXIgcyBpbiBlKz0iXG5bIituKyJdICIsYXJndW1lbnRzWzBdKWUrPXMrIjogIithcmd1bWVudHNbMF1bc10rIiwgIjtlPWUuc2xpY2UoMCwtMil9ZWxzZSBlPWFyZ3VtZW50c1tuXTt0LnB1c2goZSl9WShpKyJcbkFyZ3VtZW50czogIitBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0KS5qb2luKCIiKSsiXG4iKyhuZXcgRXJyb3IpLnN0YWNrKSxhPSExfXJldHVybiByLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0scil9dmFyIHMsTz17fTtmdW5jdGlvbiBUKGUsdCl7bnVsbCE9Yy5kZXByZWNhdGlvbkhhbmRsZXImJmMuZGVwcmVjYXRpb25IYW5kbGVyKGUsdCksT1tlXXx8KFkodCksT1tlXT0hMCl9ZnVuY3Rpb24geChlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIEZ1bmN0aW9ufHwiW29iamVjdCBGdW5jdGlvbl0iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUpfWZ1bmN0aW9uIGIoZSx0KXt2YXIgbixzPV8oe30sZSk7Zm9yKG4gaW4gdCltKHQsbikmJih1KGVbbl0pJiZ1KHRbbl0pPyhzW25dPXt9LF8oc1tuXSxlW25dKSxfKHNbbl0sdFtuXSkpOm51bGwhPXRbbl0/c1tuXT10W25dOmRlbGV0ZSBzW25dKTtmb3IobiBpbiBlKW0oZSxuKSYmIW0odCxuKSYmdShlW25dKSYmKHNbbl09Xyh7fSxzW25dKSk7cmV0dXJuIHN9ZnVuY3Rpb24gUChlKXtudWxsIT1lJiZ0aGlzLnNldChlKX1jLnN1cHByZXNzRGVwcmVjYXRpb25XYXJuaW5ncz0hMSxjLmRlcHJlY2F0aW9uSGFuZGxlcj1udWxsLHM9T2JqZWN0LmtleXM/T2JqZWN0LmtleXM6ZnVuY3Rpb24oZSl7dmFyIHQsbj1bXTtmb3IodCBpbiBlKW0oZSx0KSYmbi5wdXNoKHQpO3JldHVybiBufTt2YXIgVz17fTtmdW5jdGlvbiBIKGUsdCl7dmFyIG49ZS50b0xvd2VyQ2FzZSgpO1dbbl09V1tuKyJzIl09V1t0XT1lfWZ1bmN0aW9uIFIoZSl7cmV0dXJuInN0cmluZyI9PXR5cGVvZiBlP1dbZV18fFdbZS50b0xvd2VyQ2FzZSgpXTp2b2lkIDB9ZnVuY3Rpb24gQyhlKXt2YXIgdCxuLHM9e307Zm9yKG4gaW4gZSltKGUsbikmJih0PVIobikpJiYoc1t0XT1lW25dKTtyZXR1cm4gc312YXIgRj17fTtmdW5jdGlvbiBMKGUsdCl7RltlXT10fWZ1bmN0aW9uIFUoZSx0LG4pe3ZhciBzPSIiK01hdGguYWJzKGUpLGk9dC1zLmxlbmd0aDtyZXR1cm4oMDw9ZT9uPyIrIjoiIjoiLSIpK01hdGgucG93KDEwLE1hdGgubWF4KDAsaSkpLnRvU3RyaW5nKCkuc3Vic3RyKDEpK3N9dmFyIE49LyhcW1teXFtdKlxdKXwoXFwpPyhbSGhdbW0oc3MpP3xNb3xNTT9NP00/fERvfERERG98REQ/RD9EP3xkZGQ/ZD98ZG8/fHdbb3x3XT98V1tvfFddP3xRbz98WVlZWVlZfFlZWVlZfFlZWVl8WVl8Z2coZ2dnPyk/fEdHKEdHRz8pP3xlfEV8YXxBfGhoP3xISD98a2s/fG1tP3xzcz98U3sxLDl9fHh8WHx6ej98Wlo/fC4pL2csRz0vKFxbW15cW10qXF0pfChcXCk/KExUU3xMVHxMTD9MP0w/fGx7MSw0fSkvZyxWPXt9LEU9e307ZnVuY3Rpb24gSShlLHQsbixzKXt2YXIgaT1zOyJzdHJpbmciPT10eXBlb2YgcyYmKGk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc1tzXSgpfSksZSYmKEVbZV09aSksdCYmKEVbdFswXV09ZnVuY3Rpb24oKXtyZXR1cm4gVShpLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0WzFdLHRbMl0pfSksbiYmKEVbbl09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkub3JkaW5hbChpLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxlKX0pfWZ1bmN0aW9uIEEoZSx0KXtyZXR1cm4gZS5pc1ZhbGlkKCk/KHQ9aih0LGUubG9jYWxlRGF0YSgpKSxWW3RdPVZbdF18fGZ1bmN0aW9uKHMpe3ZhciBlLGksdCxyPXMubWF0Y2goTik7Zm9yKGU9MCxpPXIubGVuZ3RoO2U8aTtlKyspRVtyW2VdXT9yW2VdPUVbcltlXV06cltlXT0odD1yW2VdKS5tYXRjaCgvXFtbXHNcU10vKT90LnJlcGxhY2UoL15cW3xcXSQvZywiIik6dC5yZXBsYWNlKC9cXC9nLCIiKTtyZXR1cm4gZnVuY3Rpb24oZSl7dmFyIHQsbj0iIjtmb3IodD0wO3Q8aTt0Kyspbis9eChyW3RdKT9yW3RdLmNhbGwoZSxzKTpyW3RdO3JldHVybiBufX0odCksVlt0XShlKSk6ZS5sb2NhbGVEYXRhKCkuaW52YWxpZERhdGUoKX1mdW5jdGlvbiBqKGUsdCl7dmFyIG49NTtmdW5jdGlvbiBzKGUpe3JldHVybiB0LmxvbmdEYXRlRm9ybWF0KGUpfHxlfWZvcihHLmxhc3RJbmRleD0wOzA8PW4mJkcudGVzdChlKTspZT1lLnJlcGxhY2UoRyxzKSxHLmxhc3RJbmRleD0wLG4tPTE7cmV0dXJuIGV9dmFyIFo9L1xkLyx6PS9cZFxkLywkPS9cZHszfS8scT0vXGR7NH0vLEo9L1srLV0/XGR7Nn0vLEI9L1xkXGQ/LyxRPS9cZFxkXGRcZD8vLFg9L1xkXGRcZFxkXGRcZD8vLEs9L1xkezEsM30vLGVlPS9cZHsxLDR9Lyx0ZT0vWystXT9cZHsxLDZ9LyxuZT0vXGQrLyxzZT0vWystXT9cZCsvLGllPS9afFsrLV1cZFxkOj9cZFxkL2dpLHJlPS9afFsrLV1cZFxkKD86Oj9cZFxkKT8vZ2ksYWU9L1swLTldezAsMjU2fVsnYS16XHUwMEEwLVx1MDVGRlx1MDcwMC1cdUQ3RkZcdUY5MDAtXHVGRENGXHVGREYwLVx1RkYwN1x1RkYxMC1cdUZGRUZdezEsMjU2fXxbXHUwNjAwLVx1MDZGRlwvXXsxLDI1Nn0oXHMqP1tcdTA2MDAtXHUwNkZGXXsxLDI1Nn0pezEsMn0vaSxvZT17fTtmdW5jdGlvbiB1ZShlLG4scyl7b2VbZV09eChuKT9uOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUmJnM/czpufX1mdW5jdGlvbiBsZShlLHQpe3JldHVybiBtKG9lLGUpP29lW2VdKHQuX3N0cmljdCx0Ll9sb2NhbGUpOm5ldyBSZWdFeHAoZGUoZS5yZXBsYWNlKCJcXCIsIiIpLnJlcGxhY2UoL1xcKFxbKXxcXChcXSl8XFsoW15cXVxbXSopXF18XFwoLikvZyxmdW5jdGlvbihlLHQsbixzLGkpe3JldHVybiB0fHxufHxzfHxpfSkpKX1mdW5jdGlvbiBkZShlKXtyZXR1cm4gZS5yZXBsYWNlKC9bLVwvXFxeJCorPy4oKXxbXF17fV0vZywiXFwkJiIpfXZhciBoZT17fTtmdW5jdGlvbiBjZShlLG4pe3ZhciB0LHM9bjtmb3IoInN0cmluZyI9PXR5cGVvZiBlJiYoZT1bZV0pLGQobikmJihzPWZ1bmN0aW9uKGUsdCl7dFtuXT1rKGUpfSksdD0wO3Q8ZS5sZW5ndGg7dCsrKWhlW2VbdF1dPXN9ZnVuY3Rpb24gZmUoZSxpKXtjZShlLGZ1bmN0aW9uKGUsdCxuLHMpe24uX3c9bi5fd3x8e30saShlLG4uX3csbixzKX0pfXZhciBtZT0wLF9lPTEseWU9MixnZT0zLHBlPTQsdmU9NSx3ZT02LE1lPTcsU2U9ODtmdW5jdGlvbiBEZShlKXtyZXR1cm4ga2UoZSk/MzY2OjM2NX1mdW5jdGlvbiBrZShlKXtyZXR1cm4gZSU0PT0wJiZlJTEwMCE9MHx8ZSU0MDA9PTB9SSgiWSIsMCwwLGZ1bmN0aW9uKCl7dmFyIGU9dGhpcy55ZWFyKCk7cmV0dXJuIGU8PTk5OTk/IiIrZToiKyIrZX0pLEkoMCxbIllZIiwyXSwwLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMueWVhcigpJTEwMH0pLEkoMCxbIllZWVkiLDRdLDAsInllYXIiKSxJKDAsWyJZWVlZWSIsNV0sMCwieWVhciIpLEkoMCxbIllZWVlZWSIsNiwhMF0sMCwieWVhciIpLEgoInllYXIiLCJ5IiksTCgieWVhciIsMSksdWUoIlkiLHNlKSx1ZSgiWVkiLEIseiksdWUoIllZWVkiLGVlLHEpLHVlKCJZWVlZWSIsdGUsSiksdWUoIllZWVlZWSIsdGUsSiksY2UoWyJZWVlZWSIsIllZWVlZWSJdLG1lKSxjZSgiWVlZWSIsZnVuY3Rpb24oZSx0KXt0W21lXT0yPT09ZS5sZW5ndGg/Yy5wYXJzZVR3b0RpZ2l0WWVhcihlKTprKGUpfSksY2UoIllZIixmdW5jdGlvbihlLHQpe3RbbWVdPWMucGFyc2VUd29EaWdpdFllYXIoZSl9KSxjZSgiWSIsZnVuY3Rpb24oZSx0KXt0W21lXT1wYXJzZUludChlLDEwKX0pLGMucGFyc2VUd29EaWdpdFllYXI9ZnVuY3Rpb24oZSl7cmV0dXJuIGsoZSkrKDY4PGsoZSk/MTkwMDoyZTMpfTt2YXIgWWUsT2U9VGUoIkZ1bGxZZWFyIiwhMCk7ZnVuY3Rpb24gVGUodCxuKXtyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPWU/KGJlKHRoaXMsdCxlKSxjLnVwZGF0ZU9mZnNldCh0aGlzLG4pLHRoaXMpOnhlKHRoaXMsdCl9fWZ1bmN0aW9uIHhlKGUsdCl7cmV0dXJuIGUuaXNWYWxpZCgpP2UuX2RbImdldCIrKGUuX2lzVVRDPyJVVEMiOiIiKSt0XSgpOk5hTn1mdW5jdGlvbiBiZShlLHQsbil7ZS5pc1ZhbGlkKCkmJiFpc05hTihuKSYmKCJGdWxsWWVhciI9PT10JiZrZShlLnllYXIoKSkmJjE9PT1lLm1vbnRoKCkmJjI5PT09ZS5kYXRlKCk/ZS5fZFsic2V0IisoZS5faXNVVEM/IlVUQyI6IiIpK3RdKG4sZS5tb250aCgpLFBlKG4sZS5tb250aCgpKSk6ZS5fZFsic2V0IisoZS5faXNVVEM/IlVUQyI6IiIpK3RdKG4pKX1mdW5jdGlvbiBQZShlLHQpe2lmKGlzTmFOKGUpfHxpc05hTih0KSlyZXR1cm4gTmFOO3ZhciBuLHM9KHQlKG49MTIpK24pJW47cmV0dXJuIGUrPSh0LXMpLzEyLDE9PT1zP2tlKGUpPzI5OjI4OjMxLXMlNyUyfVllPUFycmF5LnByb3RvdHlwZS5pbmRleE9mP0FycmF5LnByb3RvdHlwZS5pbmRleE9mOmZ1bmN0aW9uKGUpe3ZhciB0O2Zvcih0PTA7dDx0aGlzLmxlbmd0aDsrK3QpaWYodGhpc1t0XT09PWUpcmV0dXJuIHQ7cmV0dXJuLTF9LEkoIk0iLFsiTU0iLDJdLCJNbyIsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb250aCgpKzF9KSxJKCJNTU0iLDAsMCxmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkubW9udGhzU2hvcnQodGhpcyxlKX0pLEkoIk1NTU0iLDAsMCxmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkubW9udGhzKHRoaXMsZSl9KSxIKCJtb250aCIsIk0iKSxMKCJtb250aCIsOCksdWUoIk0iLEIpLHVlKCJNTSIsQix6KSx1ZSgiTU1NIixmdW5jdGlvbihlLHQpe3JldHVybiB0Lm1vbnRoc1Nob3J0UmVnZXgoZSl9KSx1ZSgiTU1NTSIsZnVuY3Rpb24oZSx0KXtyZXR1cm4gdC5tb250aHNSZWdleChlKX0pLGNlKFsiTSIsIk1NIl0sZnVuY3Rpb24oZSx0KXt0W19lXT1rKGUpLTF9KSxjZShbIk1NTSIsIk1NTU0iXSxmdW5jdGlvbihlLHQsbixzKXt2YXIgaT1uLl9sb2NhbGUubW9udGhzUGFyc2UoZSxzLG4uX3N0cmljdCk7bnVsbCE9aT90W19lXT1pOmcobikuaW52YWxpZE1vbnRoPWV9KTt2YXIgV2U9L0Rbb0RdPyhcW1teXFtcXV0qXF18XHMpK01NTU0/LyxIZT0iSmFudWFyeV9GZWJydWFyeV9NYXJjaF9BcHJpbF9NYXlfSnVuZV9KdWx5X0F1Z3VzdF9TZXB0ZW1iZXJfT2N0b2Jlcl9Ob3ZlbWJlcl9EZWNlbWJlciIuc3BsaXQoIl8iKTt2YXIgUmU9Ikphbl9GZWJfTWFyX0Fwcl9NYXlfSnVuX0p1bF9BdWdfU2VwX09jdF9Ob3ZfRGVjIi5zcGxpdCgiXyIpO2Z1bmN0aW9uIENlKGUsdCl7dmFyIG47aWYoIWUuaXNWYWxpZCgpKXJldHVybiBlO2lmKCJzdHJpbmciPT10eXBlb2YgdClpZigvXlxkKyQvLnRlc3QodCkpdD1rKHQpO2Vsc2UgaWYoIWQodD1lLmxvY2FsZURhdGEoKS5tb250aHNQYXJzZSh0KSkpcmV0dXJuIGU7cmV0dXJuIG49TWF0aC5taW4oZS5kYXRlKCksUGUoZS55ZWFyKCksdCkpLGUuX2RbInNldCIrKGUuX2lzVVRDPyJVVEMiOiIiKSsiTW9udGgiXSh0LG4pLGV9ZnVuY3Rpb24gRmUoZSl7cmV0dXJuIG51bGwhPWU/KENlKHRoaXMsZSksYy51cGRhdGVPZmZzZXQodGhpcywhMCksdGhpcyk6eGUodGhpcywiTW9udGgiKX12YXIgTGU9YWU7dmFyIFVlPWFlO2Z1bmN0aW9uIE5lKCl7ZnVuY3Rpb24gZShlLHQpe3JldHVybiB0Lmxlbmd0aC1lLmxlbmd0aH12YXIgdCxuLHM9W10saT1bXSxyPVtdO2Zvcih0PTA7dDwxMjt0Kyspbj15KFsyZTMsdF0pLHMucHVzaCh0aGlzLm1vbnRoc1Nob3J0KG4sIiIpKSxpLnB1c2godGhpcy5tb250aHMobiwiIikpLHIucHVzaCh0aGlzLm1vbnRocyhuLCIiKSksci5wdXNoKHRoaXMubW9udGhzU2hvcnQobiwiIikpO2ZvcihzLnNvcnQoZSksaS5zb3J0KGUpLHIuc29ydChlKSx0PTA7dDwxMjt0Kyspc1t0XT1kZShzW3RdKSxpW3RdPWRlKGlbdF0pO2Zvcih0PTA7dDwyNDt0Kyspclt0XT1kZShyW3RdKTt0aGlzLl9tb250aHNSZWdleD1uZXcgUmVnRXhwKCJeKCIrci5qb2luKCJ8IikrIikiLCJpIiksdGhpcy5fbW9udGhzU2hvcnRSZWdleD10aGlzLl9tb250aHNSZWdleCx0aGlzLl9tb250aHNTdHJpY3RSZWdleD1uZXcgUmVnRXhwKCJeKCIraS5qb2luKCJ8IikrIikiLCJpIiksdGhpcy5fbW9udGhzU2hvcnRTdHJpY3RSZWdleD1uZXcgUmVnRXhwKCJeKCIrcy5qb2luKCJ8IikrIikiLCJpIil9ZnVuY3Rpb24gR2UoZSl7dmFyIHQ9bmV3IERhdGUoRGF0ZS5VVEMuYXBwbHkobnVsbCxhcmd1bWVudHMpKTtyZXR1cm4gZTwxMDAmJjA8PWUmJmlzRmluaXRlKHQuZ2V0VVRDRnVsbFllYXIoKSkmJnQuc2V0VVRDRnVsbFllYXIoZSksdH1mdW5jdGlvbiBWZShlLHQsbil7dmFyIHM9Nyt0LW47cmV0dXJuLSgoNytHZShlLDAscykuZ2V0VVRDRGF5KCktdCklNykrcy0xfWZ1bmN0aW9uIEVlKGUsdCxuLHMsaSl7dmFyIHIsYSxvPTErNyoodC0xKSsoNytuLXMpJTcrVmUoZSxzLGkpO3JldHVybiBvPD0wP2E9RGUocj1lLTEpK286bz5EZShlKT8ocj1lKzEsYT1vLURlKGUpKToocj1lLGE9bykse3llYXI6cixkYXlPZlllYXI6YX19ZnVuY3Rpb24gSWUoZSx0LG4pe3ZhciBzLGkscj1WZShlLnllYXIoKSx0LG4pLGE9TWF0aC5mbG9vcigoZS5kYXlPZlllYXIoKS1yLTEpLzcpKzE7cmV0dXJuIGE8MT9zPWErQWUoaT1lLnllYXIoKS0xLHQsbik6YT5BZShlLnllYXIoKSx0LG4pPyhzPWEtQWUoZS55ZWFyKCksdCxuKSxpPWUueWVhcigpKzEpOihpPWUueWVhcigpLHM9YSkse3dlZWs6cyx5ZWFyOml9fWZ1bmN0aW9uIEFlKGUsdCxuKXt2YXIgcz1WZShlLHQsbiksaT1WZShlKzEsdCxuKTtyZXR1cm4oRGUoZSktcytpKS83fUkoInciLFsid3ciLDJdLCJ3byIsIndlZWsiKSxJKCJXIixbIldXIiwyXSwiV28iLCJpc29XZWVrIiksSCgid2VlayIsInciKSxIKCJpc29XZWVrIiwiVyIpLEwoIndlZWsiLDUpLEwoImlzb1dlZWsiLDUpLHVlKCJ3IixCKSx1ZSgid3ciLEIseiksdWUoIlciLEIpLHVlKCJXVyIsQix6KSxmZShbInciLCJ3dyIsIlciLCJXVyJdLGZ1bmN0aW9uKGUsdCxuLHMpe3Rbcy5zdWJzdHIoMCwxKV09ayhlKX0pO0koImQiLDAsImRvIiwiZGF5IiksSSgiZGQiLDAsMCxmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkud2Vla2RheXNNaW4odGhpcyxlKX0pLEkoImRkZCIsMCwwLGZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmxvY2FsZURhdGEoKS53ZWVrZGF5c1Nob3J0KHRoaXMsZSl9KSxJKCJkZGRkIiwwLDAsZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLndlZWtkYXlzKHRoaXMsZSl9KSxJKCJlIiwwLDAsIndlZWtkYXkiKSxJKCJFIiwwLDAsImlzb1dlZWtkYXkiKSxIKCJkYXkiLCJkIiksSCgid2Vla2RheSIsImUiKSxIKCJpc29XZWVrZGF5IiwiRSIpLEwoImRheSIsMTEpLEwoIndlZWtkYXkiLDExKSxMKCJpc29XZWVrZGF5IiwxMSksdWUoImQiLEIpLHVlKCJlIixCKSx1ZSgiRSIsQiksdWUoImRkIixmdW5jdGlvbihlLHQpe3JldHVybiB0LndlZWtkYXlzTWluUmVnZXgoZSl9KSx1ZSgiZGRkIixmdW5jdGlvbihlLHQpe3JldHVybiB0LndlZWtkYXlzU2hvcnRSZWdleChlKX0pLHVlKCJkZGRkIixmdW5jdGlvbihlLHQpe3JldHVybiB0LndlZWtkYXlzUmVnZXgoZSl9KSxmZShbImRkIiwiZGRkIiwiZGRkZCJdLGZ1bmN0aW9uKGUsdCxuLHMpe3ZhciBpPW4uX2xvY2FsZS53ZWVrZGF5c1BhcnNlKGUscyxuLl9zdHJpY3QpO251bGwhPWk/dC5kPWk6ZyhuKS5pbnZhbGlkV2Vla2RheT1lfSksZmUoWyJkIiwiZSIsIkUiXSxmdW5jdGlvbihlLHQsbixzKXt0W3NdPWsoZSl9KTt2YXIgamU9IlN1bmRheV9Nb25kYXlfVHVlc2RheV9XZWRuZXNkYXlfVGh1cnNkYXlfRnJpZGF5X1NhdHVyZGF5Ii5zcGxpdCgiXyIpO3ZhciBaZT0iU3VuX01vbl9UdWVfV2VkX1RodV9GcmlfU2F0Ii5zcGxpdCgiXyIpO3ZhciB6ZT0iU3VfTW9fVHVfV2VfVGhfRnJfU2EiLnNwbGl0KCJfIik7dmFyICRlPWFlO3ZhciBxZT1hZTt2YXIgSmU9YWU7ZnVuY3Rpb24gQmUoKXtmdW5jdGlvbiBlKGUsdCl7cmV0dXJuIHQubGVuZ3RoLWUubGVuZ3RofXZhciB0LG4scyxpLHIsYT1bXSxvPVtdLHU9W10sbD1bXTtmb3IodD0wO3Q8Nzt0Kyspbj15KFsyZTMsMV0pLmRheSh0KSxzPXRoaXMud2Vla2RheXNNaW4obiwiIiksaT10aGlzLndlZWtkYXlzU2hvcnQobiwiIikscj10aGlzLndlZWtkYXlzKG4sIiIpLGEucHVzaChzKSxvLnB1c2goaSksdS5wdXNoKHIpLGwucHVzaChzKSxsLnB1c2goaSksbC5wdXNoKHIpO2ZvcihhLnNvcnQoZSksby5zb3J0KGUpLHUuc29ydChlKSxsLnNvcnQoZSksdD0wO3Q8Nzt0Kyspb1t0XT1kZShvW3RdKSx1W3RdPWRlKHVbdF0pLGxbdF09ZGUobFt0XSk7dGhpcy5fd2Vla2RheXNSZWdleD1uZXcgUmVnRXhwKCJeKCIrbC5qb2luKCJ8IikrIikiLCJpIiksdGhpcy5fd2Vla2RheXNTaG9ydFJlZ2V4PXRoaXMuX3dlZWtkYXlzUmVnZXgsdGhpcy5fd2Vla2RheXNNaW5SZWdleD10aGlzLl93ZWVrZGF5c1JlZ2V4LHRoaXMuX3dlZWtkYXlzU3RyaWN0UmVnZXg9bmV3IFJlZ0V4cCgiXigiK3Uuam9pbigifCIpKyIpIiwiaSIpLHRoaXMuX3dlZWtkYXlzU2hvcnRTdHJpY3RSZWdleD1uZXcgUmVnRXhwKCJeKCIrby5qb2luKCJ8IikrIikiLCJpIiksdGhpcy5fd2Vla2RheXNNaW5TdHJpY3RSZWdleD1uZXcgUmVnRXhwKCJeKCIrYS5qb2luKCJ8IikrIikiLCJpIil9ZnVuY3Rpb24gUWUoKXtyZXR1cm4gdGhpcy5ob3VycygpJTEyfHwxMn1mdW5jdGlvbiBYZShlLHQpe0koZSwwLDAsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkubWVyaWRpZW0odGhpcy5ob3VycygpLHRoaXMubWludXRlcygpLHQpfSl9ZnVuY3Rpb24gS2UoZSx0KXtyZXR1cm4gdC5fbWVyaWRpZW1QYXJzZX1JKCJIIixbIkhIIiwyXSwwLCJob3VyIiksSSgiaCIsWyJoaCIsMl0sMCxRZSksSSgiayIsWyJrayIsMl0sMCxmdW5jdGlvbigpe3JldHVybiB0aGlzLmhvdXJzKCl8fDI0fSksSSgiaG1tIiwwLDAsZnVuY3Rpb24oKXtyZXR1cm4iIitRZS5hcHBseSh0aGlzKStVKHRoaXMubWludXRlcygpLDIpfSksSSgiaG1tc3MiLDAsMCxmdW5jdGlvbigpe3JldHVybiIiK1FlLmFwcGx5KHRoaXMpK1UodGhpcy5taW51dGVzKCksMikrVSh0aGlzLnNlY29uZHMoKSwyKX0pLEkoIkhtbSIsMCwwLGZ1bmN0aW9uKCl7cmV0dXJuIiIrdGhpcy5ob3VycygpK1UodGhpcy5taW51dGVzKCksMil9KSxJKCJIbW1zcyIsMCwwLGZ1bmN0aW9uKCl7cmV0dXJuIiIrdGhpcy5ob3VycygpK1UodGhpcy5taW51dGVzKCksMikrVSh0aGlzLnNlY29uZHMoKSwyKX0pLFhlKCJhIiwhMCksWGUoIkEiLCExKSxIKCJob3VyIiwiaCIpLEwoImhvdXIiLDEzKSx1ZSgiYSIsS2UpLHVlKCJBIixLZSksdWUoIkgiLEIpLHVlKCJoIixCKSx1ZSgiayIsQiksdWUoIkhIIixCLHopLHVlKCJoaCIsQix6KSx1ZSgia2siLEIseiksdWUoImhtbSIsUSksdWUoImhtbXNzIixYKSx1ZSgiSG1tIixRKSx1ZSgiSG1tc3MiLFgpLGNlKFsiSCIsIkhIIl0sZ2UpLGNlKFsiayIsImtrIl0sZnVuY3Rpb24oZSx0LG4pe3ZhciBzPWsoZSk7dFtnZV09MjQ9PT1zPzA6c30pLGNlKFsiYSIsIkEiXSxmdW5jdGlvbihlLHQsbil7bi5faXNQbT1uLl9sb2NhbGUuaXNQTShlKSxuLl9tZXJpZGllbT1lfSksY2UoWyJoIiwiaGgiXSxmdW5jdGlvbihlLHQsbil7dFtnZV09ayhlKSxnKG4pLmJpZ0hvdXI9ITB9KSxjZSgiaG1tIixmdW5jdGlvbihlLHQsbil7dmFyIHM9ZS5sZW5ndGgtMjt0W2dlXT1rKGUuc3Vic3RyKDAscykpLHRbcGVdPWsoZS5zdWJzdHIocykpLGcobikuYmlnSG91cj0hMH0pLGNlKCJobW1zcyIsZnVuY3Rpb24oZSx0LG4pe3ZhciBzPWUubGVuZ3RoLTQsaT1lLmxlbmd0aC0yO3RbZ2VdPWsoZS5zdWJzdHIoMCxzKSksdFtwZV09ayhlLnN1YnN0cihzLDIpKSx0W3ZlXT1rKGUuc3Vic3RyKGkpKSxnKG4pLmJpZ0hvdXI9ITB9KSxjZSgiSG1tIixmdW5jdGlvbihlLHQsbil7dmFyIHM9ZS5sZW5ndGgtMjt0W2dlXT1rKGUuc3Vic3RyKDAscykpLHRbcGVdPWsoZS5zdWJzdHIocykpfSksY2UoIkhtbXNzIixmdW5jdGlvbihlLHQsbil7dmFyIHM9ZS5sZW5ndGgtNCxpPWUubGVuZ3RoLTI7dFtnZV09ayhlLnN1YnN0cigwLHMpKSx0W3BlXT1rKGUuc3Vic3RyKHMsMikpLHRbdmVdPWsoZS5zdWJzdHIoaSkpfSk7dmFyIGV0LHR0PVRlKCJIb3VycyIsITApLG50PXtjYWxlbmRhcjp7c2FtZURheToiW1RvZGF5IGF0XSBMVCIsbmV4dERheToiW1RvbW9ycm93IGF0XSBMVCIsbmV4dFdlZWs6ImRkZGQgW2F0XSBMVCIsbGFzdERheToiW1llc3RlcmRheSBhdF0gTFQiLGxhc3RXZWVrOiJbTGFzdF0gZGRkZCBbYXRdIExUIixzYW1lRWxzZToiTCJ9LGxvbmdEYXRlRm9ybWF0OntMVFM6Img6bW06c3MgQSIsTFQ6Img6bW0gQSIsTDoiTU0vREQvWVlZWSIsTEw6Ik1NTU0gRCwgWVlZWSIsTExMOiJNTU1NIEQsIFlZWVkgaDptbSBBIixMTExMOiJkZGRkLCBNTU1NIEQsIFlZWVkgaDptbSBBIn0saW52YWxpZERhdGU6IkludmFsaWQgZGF0ZSIsb3JkaW5hbDoiJWQiLGRheU9mTW9udGhPcmRpbmFsUGFyc2U6L1xkezEsMn0vLHJlbGF0aXZlVGltZTp7ZnV0dXJlOiJpbiAlcyIscGFzdDoiJXMgYWdvIixzOiJhIGZldyBzZWNvbmRzIixzczoiJWQgc2Vjb25kcyIsbToiYSBtaW51dGUiLG1tOiIlZCBtaW51dGVzIixoOiJhbiBob3VyIixoaDoiJWQgaG91cnMiLGQ6ImEgZGF5IixkZDoiJWQgZGF5cyIsTToiYSBtb250aCIsTU06IiVkIG1vbnRocyIseToiYSB5ZWFyIix5eToiJWQgeWVhcnMifSxtb250aHM6SGUsbW9udGhzU2hvcnQ6UmUsd2Vlazp7ZG93OjAsZG95OjZ9LHdlZWtkYXlzOmplLHdlZWtkYXlzTWluOnplLHdlZWtkYXlzU2hvcnQ6WmUsbWVyaWRpZW1QYXJzZTovW2FwXVwuP20/XC4/L2l9LHN0PXt9LGl0PXt9O2Z1bmN0aW9uIHJ0KGUpe3JldHVybiBlP2UudG9Mb3dlckNhc2UoKS5yZXBsYWNlKCJfIiwiLSIpOmV9ZnVuY3Rpb24gYXQoZSl7dmFyIHQ9bnVsbDtpZighc3RbZV0mJiJ1bmRlZmluZWQiIT10eXBlb2YgbW9kdWxlJiZtb2R1bGUmJm1vZHVsZS5leHBvcnRzKXRyeXt0PWV0Ll9hYmJyLHJlcXVpcmUoIi4vbG9jYWxlLyIrZSksb3QodCl9Y2F0Y2goZSl7fXJldHVybiBzdFtlXX1mdW5jdGlvbiBvdChlLHQpe3ZhciBuO3JldHVybiBlJiYoKG49bCh0KT9sdChlKTp1dChlLHQpKT9ldD1uOiJ1bmRlZmluZWQiIT10eXBlb2YgY29uc29sZSYmY29uc29sZS53YXJuJiZjb25zb2xlLndhcm4oIkxvY2FsZSAiK2UrIiBub3QgZm91bmQuIERpZCB5b3UgZm9yZ2V0IHRvIGxvYWQgaXQ/IikpLGV0Ll9hYmJyfWZ1bmN0aW9uIHV0KGUsdCl7aWYobnVsbCE9PXQpe3ZhciBuLHM9bnQ7aWYodC5hYmJyPWUsbnVsbCE9c3RbZV0pVCgiZGVmaW5lTG9jYWxlT3ZlcnJpZGUiLCJ1c2UgbW9tZW50LnVwZGF0ZUxvY2FsZShsb2NhbGVOYW1lLCBjb25maWcpIHRvIGNoYW5nZSBhbiBleGlzdGluZyBsb2NhbGUuIG1vbWVudC5kZWZpbmVMb2NhbGUobG9jYWxlTmFtZSwgY29uZmlnKSBzaG91bGQgb25seSBiZSB1c2VkIGZvciBjcmVhdGluZyBhIG5ldyBsb2NhbGUgU2VlIGh0dHA6Ly9tb21lbnRqcy5jb20vZ3VpZGVzLyMvd2FybmluZ3MvZGVmaW5lLWxvY2FsZS8gZm9yIG1vcmUgaW5mby4iKSxzPXN0W2VdLl9jb25maWc7ZWxzZSBpZihudWxsIT10LnBhcmVudExvY2FsZSlpZihudWxsIT1zdFt0LnBhcmVudExvY2FsZV0pcz1zdFt0LnBhcmVudExvY2FsZV0uX2NvbmZpZztlbHNle2lmKG51bGw9PShuPWF0KHQucGFyZW50TG9jYWxlKSkpcmV0dXJuIGl0W3QucGFyZW50TG9jYWxlXXx8KGl0W3QucGFyZW50TG9jYWxlXT1bXSksaXRbdC5wYXJlbnRMb2NhbGVdLnB1c2goe25hbWU6ZSxjb25maWc6dH0pLG51bGw7cz1uLl9jb25maWd9cmV0dXJuIHN0W2VdPW5ldyBQKGIocyx0KSksaXRbZV0mJml0W2VdLmZvckVhY2goZnVuY3Rpb24oZSl7dXQoZS5uYW1lLGUuY29uZmlnKX0pLG90KGUpLHN0W2VdfXJldHVybiBkZWxldGUgc3RbZV0sbnVsbH1mdW5jdGlvbiBsdChlKXt2YXIgdDtpZihlJiZlLl9sb2NhbGUmJmUuX2xvY2FsZS5fYWJiciYmKGU9ZS5fbG9jYWxlLl9hYmJyKSwhZSlyZXR1cm4gZXQ7aWYoIW8oZSkpe2lmKHQ9YXQoZSkpcmV0dXJuIHQ7ZT1bZV19cmV0dXJuIGZ1bmN0aW9uKGUpe2Zvcih2YXIgdCxuLHMsaSxyPTA7cjxlLmxlbmd0aDspe2Zvcih0PShpPXJ0KGVbcl0pLnNwbGl0KCItIikpLmxlbmd0aCxuPShuPXJ0KGVbcisxXSkpP24uc3BsaXQoIi0iKTpudWxsOzA8dDspe2lmKHM9YXQoaS5zbGljZSgwLHQpLmpvaW4oIi0iKSkpcmV0dXJuIHM7aWYobiYmbi5sZW5ndGg+PXQmJmEoaSxuLCEwKT49dC0xKWJyZWFrO3QtLX1yKyt9cmV0dXJuIGV0fShlKX1mdW5jdGlvbiBkdChlKXt2YXIgdCxuPWUuX2E7cmV0dXJuIG4mJi0yPT09ZyhlKS5vdmVyZmxvdyYmKHQ9bltfZV08MHx8MTE8bltfZV0/X2U6blt5ZV08MXx8blt5ZV0+UGUoblttZV0sbltfZV0pP3llOm5bZ2VdPDB8fDI0PG5bZ2VdfHwyND09PW5bZ2VdJiYoMCE9PW5bcGVdfHwwIT09blt2ZV18fDAhPT1uW3dlXSk/Z2U6bltwZV08MHx8NTk8bltwZV0/cGU6blt2ZV08MHx8NTk8blt2ZV0/dmU6blt3ZV08MHx8OTk5PG5bd2VdP3dlOi0xLGcoZSkuX292ZXJmbG93RGF5T2ZZZWFyJiYodDxtZXx8eWU8dCkmJih0PXllKSxnKGUpLl9vdmVyZmxvd1dlZWtzJiYtMT09PXQmJih0PU1lKSxnKGUpLl9vdmVyZmxvd1dlZWtkYXkmJi0xPT09dCYmKHQ9U2UpLGcoZSkub3ZlcmZsb3c9dCksZX1mdW5jdGlvbiBodChlLHQsbil7cmV0dXJuIG51bGwhPWU/ZTpudWxsIT10P3Q6bn1mdW5jdGlvbiBjdChlKXt2YXIgdCxuLHMsaSxyLGE9W107aWYoIWUuX2Qpe3ZhciBvLHU7Zm9yKG89ZSx1PW5ldyBEYXRlKGMubm93KCkpLHM9by5fdXNlVVRDP1t1LmdldFVUQ0Z1bGxZZWFyKCksdS5nZXRVVENNb250aCgpLHUuZ2V0VVRDRGF0ZSgpXTpbdS5nZXRGdWxsWWVhcigpLHUuZ2V0TW9udGgoKSx1LmdldERhdGUoKV0sZS5fdyYmbnVsbD09ZS5fYVt5ZV0mJm51bGw9PWUuX2FbX2VdJiZmdW5jdGlvbihlKXt2YXIgdCxuLHMsaSxyLGEsbyx1O2lmKG51bGwhPSh0PWUuX3cpLkdHfHxudWxsIT10Lld8fG51bGwhPXQuRSlyPTEsYT00LG49aHQodC5HRyxlLl9hW21lXSxJZShUdCgpLDEsNCkueWVhcikscz1odCh0LlcsMSksKChpPWh0KHQuRSwxKSk8MXx8NzxpKSYmKHU9ITApO2Vsc2V7cj1lLl9sb2NhbGUuX3dlZWsuZG93LGE9ZS5fbG9jYWxlLl93ZWVrLmRveTt2YXIgbD1JZShUdCgpLHIsYSk7bj1odCh0LmdnLGUuX2FbbWVdLGwueWVhcikscz1odCh0LncsbC53ZWVrKSxudWxsIT10LmQ/KChpPXQuZCk8MHx8NjxpKSYmKHU9ITApOm51bGwhPXQuZT8oaT10LmUrciwodC5lPDB8fDY8dC5lKSYmKHU9ITApKTppPXJ9czwxfHxzPkFlKG4scixhKT9nKGUpLl9vdmVyZmxvd1dlZWtzPSEwOm51bGwhPXU/ZyhlKS5fb3ZlcmZsb3dXZWVrZGF5PSEwOihvPUVlKG4scyxpLHIsYSksZS5fYVttZV09by55ZWFyLGUuX2RheU9mWWVhcj1vLmRheU9mWWVhcil9KGUpLG51bGwhPWUuX2RheU9mWWVhciYmKHI9aHQoZS5fYVttZV0sc1ttZV0pLChlLl9kYXlPZlllYXI+RGUocil8fDA9PT1lLl9kYXlPZlllYXIpJiYoZyhlKS5fb3ZlcmZsb3dEYXlPZlllYXI9ITApLG49R2UociwwLGUuX2RheU9mWWVhciksZS5fYVtfZV09bi5nZXRVVENNb250aCgpLGUuX2FbeWVdPW4uZ2V0VVRDRGF0ZSgpKSx0PTA7dDwzJiZudWxsPT1lLl9hW3RdOysrdCllLl9hW3RdPWFbdF09c1t0XTtmb3IoO3Q8Nzt0KyspZS5fYVt0XT1hW3RdPW51bGw9PWUuX2FbdF0/Mj09PXQ/MTowOmUuX2FbdF07MjQ9PT1lLl9hW2dlXSYmMD09PWUuX2FbcGVdJiYwPT09ZS5fYVt2ZV0mJjA9PT1lLl9hW3dlXSYmKGUuX25leHREYXk9ITAsZS5fYVtnZV09MCksZS5fZD0oZS5fdXNlVVRDP0dlOmZ1bmN0aW9uKGUsdCxuLHMsaSxyLGEpe3ZhciBvPW5ldyBEYXRlKGUsdCxuLHMsaSxyLGEpO3JldHVybiBlPDEwMCYmMDw9ZSYmaXNGaW5pdGUoby5nZXRGdWxsWWVhcigpKSYmby5zZXRGdWxsWWVhcihlKSxvfSkuYXBwbHkobnVsbCxhKSxpPWUuX3VzZVVUQz9lLl9kLmdldFVUQ0RheSgpOmUuX2QuZ2V0RGF5KCksbnVsbCE9ZS5fdHptJiZlLl9kLnNldFVUQ01pbnV0ZXMoZS5fZC5nZXRVVENNaW51dGVzKCktZS5fdHptKSxlLl9uZXh0RGF5JiYoZS5fYVtnZV09MjQpLGUuX3cmJnZvaWQgMCE9PWUuX3cuZCYmZS5fdy5kIT09aSYmKGcoZSkud2Vla2RheU1pc21hdGNoPSEwKX19dmFyIGZ0PS9eXHMqKCg/OlsrLV1cZHs2fXxcZHs0fSktKD86XGRcZC1cZFxkfFdcZFxkLVxkfFdcZFxkfFxkXGRcZHxcZFxkKSkoPzooVHwgKShcZFxkKD86OlxkXGQoPzo6XGRcZCg/OlsuLF1cZCspPyk/KT8pKFtcK1wtXVxkXGQoPzo6P1xkXGQpP3xccypaKT8pPyQvLG10PS9eXHMqKCg/OlsrLV1cZHs2fXxcZHs0fSkoPzpcZFxkXGRcZHxXXGRcZFxkfFdcZFxkfFxkXGRcZHxcZFxkKSkoPzooVHwgKShcZFxkKD86XGRcZCg/OlxkXGQoPzpbLixdXGQrKT8pPyk/KShbXCtcLV1cZFxkKD86Oj9cZFxkKT98XHMqWik/KT8kLyxfdD0vWnxbKy1dXGRcZCg/Ojo/XGRcZCk/Lyx5dD1bWyJZWVlZWVktTU0tREQiLC9bKy1dXGR7Nn0tXGRcZC1cZFxkL10sWyJZWVlZLU1NLUREIiwvXGR7NH0tXGRcZC1cZFxkL10sWyJHR0dHLVtXXVdXLUUiLC9cZHs0fS1XXGRcZC1cZC9dLFsiR0dHRy1bV11XVyIsL1xkezR9LVdcZFxkLywhMV0sWyJZWVlZLURERCIsL1xkezR9LVxkezN9L10sWyJZWVlZLU1NIiwvXGR7NH0tXGRcZC8sITFdLFsiWVlZWVlZTU1ERCIsL1srLV1cZHsxMH0vXSxbIllZWVlNTUREIiwvXGR7OH0vXSxbIkdHR0dbV11XV0UiLC9cZHs0fVdcZHszfS9dLFsiR0dHR1tXXVdXIiwvXGR7NH1XXGR7Mn0vLCExXSxbIllZWVlEREQiLC9cZHs3fS9dXSxndD1bWyJISDptbTpzcy5TU1NTIiwvXGRcZDpcZFxkOlxkXGRcLlxkKy9dLFsiSEg6bW06c3MsU1NTUyIsL1xkXGQ6XGRcZDpcZFxkLFxkKy9dLFsiSEg6bW06c3MiLC9cZFxkOlxkXGQ6XGRcZC9dLFsiSEg6bW0iLC9cZFxkOlxkXGQvXSxbIkhIbW1zcy5TU1NTIiwvXGRcZFxkXGRcZFxkXC5cZCsvXSxbIkhIbW1zcyxTU1NTIiwvXGRcZFxkXGRcZFxkLFxkKy9dLFsiSEhtbXNzIiwvXGRcZFxkXGRcZFxkL10sWyJISG1tIiwvXGRcZFxkXGQvXSxbIkhIIiwvXGRcZC9dXSxwdD0vXlwvP0RhdGVcKChcLT9cZCspL2k7ZnVuY3Rpb24gdnQoZSl7dmFyIHQsbixzLGkscixhLG89ZS5faSx1PWZ0LmV4ZWMobyl8fG10LmV4ZWMobyk7aWYodSl7Zm9yKGcoZSkuaXNvPSEwLHQ9MCxuPXl0Lmxlbmd0aDt0PG47dCsrKWlmKHl0W3RdWzFdLmV4ZWModVsxXSkpe2k9eXRbdF1bMF0scz0hMSE9PXl0W3RdWzJdO2JyZWFrfWlmKG51bGw9PWkpcmV0dXJuIHZvaWQoZS5faXNWYWxpZD0hMSk7aWYodVszXSl7Zm9yKHQ9MCxuPWd0Lmxlbmd0aDt0PG47dCsrKWlmKGd0W3RdWzFdLmV4ZWModVszXSkpe3I9KHVbMl18fCIgIikrZ3RbdF1bMF07YnJlYWt9aWYobnVsbD09cilyZXR1cm4gdm9pZChlLl9pc1ZhbGlkPSExKX1pZighcyYmbnVsbCE9cilyZXR1cm4gdm9pZChlLl9pc1ZhbGlkPSExKTtpZih1WzRdKXtpZighX3QuZXhlYyh1WzRdKSlyZXR1cm4gdm9pZChlLl9pc1ZhbGlkPSExKTthPSJaIn1lLl9mPWkrKHJ8fCIiKSsoYXx8IiIpLGt0KGUpfWVsc2UgZS5faXNWYWxpZD0hMX12YXIgd3Q9L14oPzooTW9ufFR1ZXxXZWR8VGh1fEZyaXxTYXR8U3VuKSw/XHMpPyhcZHsxLDJ9KVxzKEphbnxGZWJ8TWFyfEFwcnxNYXl8SnVufEp1bHxBdWd8U2VwfE9jdHxOb3Z8RGVjKVxzKFxkezIsNH0pXHMoXGRcZCk6KFxkXGQpKD86OihcZFxkKSk/XHMoPzooVVR8R01UfFtFQ01QXVtTRF1UKXwoW1p6XSl8KFsrLV1cZHs0fSkpJC87ZnVuY3Rpb24gTXQoZSx0LG4scyxpLHIpe3ZhciBhPVtmdW5jdGlvbihlKXt2YXIgdD1wYXJzZUludChlLDEwKTt7aWYodDw9NDkpcmV0dXJuIDJlMyt0O2lmKHQ8PTk5OSlyZXR1cm4gMTkwMCt0fXJldHVybiB0fShlKSxSZS5pbmRleE9mKHQpLHBhcnNlSW50KG4sMTApLHBhcnNlSW50KHMsMTApLHBhcnNlSW50KGksMTApXTtyZXR1cm4gciYmYS5wdXNoKHBhcnNlSW50KHIsMTApKSxhfXZhciBTdD17VVQ6MCxHTVQ6MCxFRFQ6LTI0MCxFU1Q6LTMwMCxDRFQ6LTMwMCxDU1Q6LTM2MCxNRFQ6LTM2MCxNU1Q6LTQyMCxQRFQ6LTQyMCxQU1Q6LTQ4MH07ZnVuY3Rpb24gRHQoZSl7dmFyIHQsbixzLGk9d3QuZXhlYyhlLl9pLnJlcGxhY2UoL1woW14pXSpcKXxbXG5cdF0vZywiICIpLnJlcGxhY2UoLyhcc1xzKykvZywiICIpLnJlcGxhY2UoL15cc1xzKi8sIiIpLnJlcGxhY2UoL1xzXHMqJC8sIiIpKTtpZihpKXt2YXIgcj1NdChpWzRdLGlbM10saVsyXSxpWzVdLGlbNl0saVs3XSk7aWYodD1pWzFdLG49cixzPWUsdCYmWmUuaW5kZXhPZih0KSE9PW5ldyBEYXRlKG5bMF0sblsxXSxuWzJdKS5nZXREYXkoKSYmKGcocykud2Vla2RheU1pc21hdGNoPSEwLCEocy5faXNWYWxpZD0hMSkpKXJldHVybjtlLl9hPXIsZS5fdHptPWZ1bmN0aW9uKGUsdCxuKXtpZihlKXJldHVybiBTdFtlXTtpZih0KXJldHVybiAwO3ZhciBzPXBhcnNlSW50KG4sMTApLGk9cyUxMDA7cmV0dXJuKHMtaSkvMTAwKjYwK2l9KGlbOF0saVs5XSxpWzEwXSksZS5fZD1HZS5hcHBseShudWxsLGUuX2EpLGUuX2Quc2V0VVRDTWludXRlcyhlLl9kLmdldFVUQ01pbnV0ZXMoKS1lLl90em0pLGcoZSkucmZjMjgyMj0hMH1lbHNlIGUuX2lzVmFsaWQ9ITF9ZnVuY3Rpb24ga3QoZSl7aWYoZS5fZiE9PWMuSVNPXzg2MDEpaWYoZS5fZiE9PWMuUkZDXzI4MjIpe2UuX2E9W10sZyhlKS5lbXB0eT0hMDt2YXIgdCxuLHMsaSxyLGEsbyx1LGw9IiIrZS5faSxkPWwubGVuZ3RoLGg9MDtmb3Iocz1qKGUuX2YsZS5fbG9jYWxlKS5tYXRjaChOKXx8W10sdD0wO3Q8cy5sZW5ndGg7dCsrKWk9c1t0XSwobj0obC5tYXRjaChsZShpLGUpKXx8W10pWzBdKSYmKDA8KHI9bC5zdWJzdHIoMCxsLmluZGV4T2YobikpKS5sZW5ndGgmJmcoZSkudW51c2VkSW5wdXQucHVzaChyKSxsPWwuc2xpY2UobC5pbmRleE9mKG4pK24ubGVuZ3RoKSxoKz1uLmxlbmd0aCksRVtpXT8obj9nKGUpLmVtcHR5PSExOmcoZSkudW51c2VkVG9rZW5zLnB1c2goaSksYT1pLHU9ZSxudWxsIT0obz1uKSYmbShoZSxhKSYmaGVbYV0obyx1Ll9hLHUsYSkpOmUuX3N0cmljdCYmIW4mJmcoZSkudW51c2VkVG9rZW5zLnB1c2goaSk7ZyhlKS5jaGFyc0xlZnRPdmVyPWQtaCwwPGwubGVuZ3RoJiZnKGUpLnVudXNlZElucHV0LnB1c2gobCksZS5fYVtnZV08PTEyJiYhMD09PWcoZSkuYmlnSG91ciYmMDxlLl9hW2dlXSYmKGcoZSkuYmlnSG91cj12b2lkIDApLGcoZSkucGFyc2VkRGF0ZVBhcnRzPWUuX2Euc2xpY2UoMCksZyhlKS5tZXJpZGllbT1lLl9tZXJpZGllbSxlLl9hW2dlXT1mdW5jdGlvbihlLHQsbil7dmFyIHM7aWYobnVsbD09bilyZXR1cm4gdDtyZXR1cm4gbnVsbCE9ZS5tZXJpZGllbUhvdXI/ZS5tZXJpZGllbUhvdXIodCxuKToobnVsbCE9ZS5pc1BNJiYoKHM9ZS5pc1BNKG4pKSYmdDwxMiYmKHQrPTEyKSxzfHwxMiE9PXR8fCh0PTApKSx0KX0oZS5fbG9jYWxlLGUuX2FbZ2VdLGUuX21lcmlkaWVtKSxjdChlKSxkdChlKX1lbHNlIER0KGUpO2Vsc2UgdnQoZSl9ZnVuY3Rpb24gWXQoZSl7dmFyIHQsbixzLGkscj1lLl9pLGE9ZS5fZjtyZXR1cm4gZS5fbG9jYWxlPWUuX2xvY2FsZXx8bHQoZS5fbCksbnVsbD09PXJ8fHZvaWQgMD09PWEmJiIiPT09cj92KHtudWxsSW5wdXQ6ITB9KTooInN0cmluZyI9PXR5cGVvZiByJiYoZS5faT1yPWUuX2xvY2FsZS5wcmVwYXJzZShyKSksUyhyKT9uZXcgTShkdChyKSk6KGgocik/ZS5fZD1yOm8oYSk/ZnVuY3Rpb24oZSl7dmFyIHQsbixzLGkscjtpZigwPT09ZS5fZi5sZW5ndGgpcmV0dXJuIGcoZSkuaW52YWxpZEZvcm1hdD0hMCxlLl9kPW5ldyBEYXRlKE5hTik7Zm9yKGk9MDtpPGUuX2YubGVuZ3RoO2krKylyPTAsdD13KHt9LGUpLG51bGwhPWUuX3VzZVVUQyYmKHQuX3VzZVVUQz1lLl91c2VVVEMpLHQuX2Y9ZS5fZltpXSxrdCh0KSxwKHQpJiYocis9Zyh0KS5jaGFyc0xlZnRPdmVyLHIrPTEwKmcodCkudW51c2VkVG9rZW5zLmxlbmd0aCxnKHQpLnNjb3JlPXIsKG51bGw9PXN8fHI8cykmJihzPXIsbj10KSk7XyhlLG58fHQpfShlKTphP2t0KGUpOmwobj0odD1lKS5faSk/dC5fZD1uZXcgRGF0ZShjLm5vdygpKTpoKG4pP3QuX2Q9bmV3IERhdGUobi52YWx1ZU9mKCkpOiJzdHJpbmciPT10eXBlb2Ygbj8ocz10LG51bGw9PT0oaT1wdC5leGVjKHMuX2kpKT8odnQocyksITE9PT1zLl9pc1ZhbGlkJiYoZGVsZXRlIHMuX2lzVmFsaWQsRHQocyksITE9PT1zLl9pc1ZhbGlkJiYoZGVsZXRlIHMuX2lzVmFsaWQsYy5jcmVhdGVGcm9tSW5wdXRGYWxsYmFjayhzKSkpKTpzLl9kPW5ldyBEYXRlKCtpWzFdKSk6byhuKT8odC5fYT1mKG4uc2xpY2UoMCksZnVuY3Rpb24oZSl7cmV0dXJuIHBhcnNlSW50KGUsMTApfSksY3QodCkpOnUobik/ZnVuY3Rpb24oZSl7aWYoIWUuX2Qpe3ZhciB0PUMoZS5faSk7ZS5fYT1mKFt0LnllYXIsdC5tb250aCx0LmRheXx8dC5kYXRlLHQuaG91cix0Lm1pbnV0ZSx0LnNlY29uZCx0Lm1pbGxpc2Vjb25kXSxmdW5jdGlvbihlKXtyZXR1cm4gZSYmcGFyc2VJbnQoZSwxMCl9KSxjdChlKX19KHQpOmQobik/dC5fZD1uZXcgRGF0ZShuKTpjLmNyZWF0ZUZyb21JbnB1dEZhbGxiYWNrKHQpLHAoZSl8fChlLl9kPW51bGwpLGUpKX1mdW5jdGlvbiBPdChlLHQsbixzLGkpe3ZhciByLGE9e307cmV0dXJuITAhPT1uJiYhMSE9PW58fChzPW4sbj12b2lkIDApLCh1KGUpJiZmdW5jdGlvbihlKXtpZihPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcylyZXR1cm4gMD09PU9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGUpLmxlbmd0aDt2YXIgdDtmb3IodCBpbiBlKWlmKGUuaGFzT3duUHJvcGVydHkodCkpcmV0dXJuITE7cmV0dXJuITB9KGUpfHxvKGUpJiYwPT09ZS5sZW5ndGgpJiYoZT12b2lkIDApLGEuX2lzQU1vbWVudE9iamVjdD0hMCxhLl91c2VVVEM9YS5faXNVVEM9aSxhLl9sPW4sYS5faT1lLGEuX2Y9dCxhLl9zdHJpY3Q9cywocj1uZXcgTShkdChZdChhKSkpKS5fbmV4dERheSYmKHIuYWRkKDEsImQiKSxyLl9uZXh0RGF5PXZvaWQgMCkscn1mdW5jdGlvbiBUdChlLHQsbixzKXtyZXR1cm4gT3QoZSx0LG4scywhMSl9Yy5jcmVhdGVGcm9tSW5wdXRGYWxsYmFjaz1uKCJ2YWx1ZSBwcm92aWRlZCBpcyBub3QgaW4gYSByZWNvZ25pemVkIFJGQzI4MjIgb3IgSVNPIGZvcm1hdC4gbW9tZW50IGNvbnN0cnVjdGlvbiBmYWxscyBiYWNrIHRvIGpzIERhdGUoKSwgd2hpY2ggaXMgbm90IHJlbGlhYmxlIGFjcm9zcyBhbGwgYnJvd3NlcnMgYW5kIHZlcnNpb25zLiBOb24gUkZDMjgyMi9JU08gZGF0ZSBmb3JtYXRzIGFyZSBkaXNjb3VyYWdlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIGFuIHVwY29taW5nIG1ham9yIHJlbGVhc2UuIFBsZWFzZSByZWZlciB0byBodHRwOi8vbW9tZW50anMuY29tL2d1aWRlcy8jL3dhcm5pbmdzL2pzLWRhdGUvIGZvciBtb3JlIGluZm8uIixmdW5jdGlvbihlKXtlLl9kPW5ldyBEYXRlKGUuX2krKGUuX3VzZVVUQz8iIFVUQyI6IiIpKX0pLGMuSVNPXzg2MDE9ZnVuY3Rpb24oKXt9LGMuUkZDXzI4MjI9ZnVuY3Rpb24oKXt9O3ZhciB4dD1uKCJtb21lbnQoKS5taW4gaXMgZGVwcmVjYXRlZCwgdXNlIG1vbWVudC5tYXggaW5zdGVhZC4gaHR0cDovL21vbWVudGpzLmNvbS9ndWlkZXMvIy93YXJuaW5ncy9taW4tbWF4LyIsZnVuY3Rpb24oKXt2YXIgZT1UdC5hcHBseShudWxsLGFyZ3VtZW50cyk7cmV0dXJuIHRoaXMuaXNWYWxpZCgpJiZlLmlzVmFsaWQoKT9lPHRoaXM/dGhpczplOnYoKX0pLGJ0PW4oIm1vbWVudCgpLm1heCBpcyBkZXByZWNhdGVkLCB1c2UgbW9tZW50Lm1pbiBpbnN0ZWFkLiBodHRwOi8vbW9tZW50anMuY29tL2d1aWRlcy8jL3dhcm5pbmdzL21pbi1tYXgvIixmdW5jdGlvbigpe3ZhciBlPVR0LmFwcGx5KG51bGwsYXJndW1lbnRzKTtyZXR1cm4gdGhpcy5pc1ZhbGlkKCkmJmUuaXNWYWxpZCgpP3RoaXM8ZT90aGlzOmU6digpfSk7ZnVuY3Rpb24gUHQoZSx0KXt2YXIgbixzO2lmKDE9PT10Lmxlbmd0aCYmbyh0WzBdKSYmKHQ9dFswXSksIXQubGVuZ3RoKXJldHVybiBUdCgpO2ZvcihuPXRbMF0scz0xO3M8dC5sZW5ndGg7KytzKXRbc10uaXNWYWxpZCgpJiYhdFtzXVtlXShuKXx8KG49dFtzXSk7cmV0dXJuIG59dmFyIFd0PVsieWVhciIsInF1YXJ0ZXIiLCJtb250aCIsIndlZWsiLCJkYXkiLCJob3VyIiwibWludXRlIiwic2Vjb25kIiwibWlsbGlzZWNvbmQiXTtmdW5jdGlvbiBIdChlKXt2YXIgdD1DKGUpLG49dC55ZWFyfHwwLHM9dC5xdWFydGVyfHwwLGk9dC5tb250aHx8MCxyPXQud2Vla3x8MCxhPXQuZGF5fHwwLG89dC5ob3VyfHwwLHU9dC5taW51dGV8fDAsbD10LnNlY29uZHx8MCxkPXQubWlsbGlzZWNvbmR8fDA7dGhpcy5faXNWYWxpZD1mdW5jdGlvbihlKXtmb3IodmFyIHQgaW4gZSlpZigtMT09PVllLmNhbGwoV3QsdCl8fG51bGwhPWVbdF0mJmlzTmFOKGVbdF0pKXJldHVybiExO2Zvcih2YXIgbj0hMSxzPTA7czxXdC5sZW5ndGg7KytzKWlmKGVbV3Rbc11dKXtpZihuKXJldHVybiExO3BhcnNlRmxvYXQoZVtXdFtzXV0pIT09ayhlW1d0W3NdXSkmJihuPSEwKX1yZXR1cm4hMH0odCksdGhpcy5fbWlsbGlzZWNvbmRzPStkKzFlMypsKzZlNCp1KzFlMypvKjYwKjYwLHRoaXMuX2RheXM9K2ErNypyLHRoaXMuX21vbnRocz0raSszKnMrMTIqbix0aGlzLl9kYXRhPXt9LHRoaXMuX2xvY2FsZT1sdCgpLHRoaXMuX2J1YmJsZSgpfWZ1bmN0aW9uIFJ0KGUpe3JldHVybiBlIGluc3RhbmNlb2YgSHR9ZnVuY3Rpb24gQ3QoZSl7cmV0dXJuIGU8MD8tMSpNYXRoLnJvdW5kKC0xKmUpOk1hdGgucm91bmQoZSl9ZnVuY3Rpb24gRnQoZSxuKXtJKGUsMCwwLGZ1bmN0aW9uKCl7dmFyIGU9dGhpcy51dGNPZmZzZXQoKSx0PSIrIjtyZXR1cm4gZTwwJiYoZT0tZSx0PSItIiksdCtVKH5+KGUvNjApLDIpK24rVSh+fmUlNjAsMil9KX1GdCgiWiIsIjoiKSxGdCgiWloiLCIiKSx1ZSgiWiIscmUpLHVlKCJaWiIscmUpLGNlKFsiWiIsIlpaIl0sZnVuY3Rpb24oZSx0LG4pe24uX3VzZVVUQz0hMCxuLl90em09VXQocmUsZSl9KTt2YXIgTHQ9LyhbXCtcLV18XGRcZCkvZ2k7ZnVuY3Rpb24gVXQoZSx0KXt2YXIgbj0odHx8IiIpLm1hdGNoKGUpO2lmKG51bGw9PT1uKXJldHVybiBudWxsO3ZhciBzPSgobltuLmxlbmd0aC0xXXx8W10pKyIiKS5tYXRjaChMdCl8fFsiLSIsMCwwXSxpPTYwKnNbMV0rayhzWzJdKTtyZXR1cm4gMD09PWk/MDoiKyI9PT1zWzBdP2k6LWl9ZnVuY3Rpb24gTnQoZSx0KXt2YXIgbixzO3JldHVybiB0Ll9pc1VUQz8obj10LmNsb25lKCkscz0oUyhlKXx8aChlKT9lLnZhbHVlT2YoKTpUdChlKS52YWx1ZU9mKCkpLW4udmFsdWVPZigpLG4uX2Quc2V0VGltZShuLl9kLnZhbHVlT2YoKStzKSxjLnVwZGF0ZU9mZnNldChuLCExKSxuKTpUdChlKS5sb2NhbCgpfWZ1bmN0aW9uIEd0KGUpe3JldHVybiAxNSotTWF0aC5yb3VuZChlLl9kLmdldFRpbWV6b25lT2Zmc2V0KCkvMTUpfWZ1bmN0aW9uIFZ0KCl7cmV0dXJuISF0aGlzLmlzVmFsaWQoKSYmKHRoaXMuX2lzVVRDJiYwPT09dGhpcy5fb2Zmc2V0KX1jLnVwZGF0ZU9mZnNldD1mdW5jdGlvbigpe307dmFyIEV0PS9eKFwtfFwrKT8oPzooXGQqKVsuIF0pPyhcZCspXDooXGQrKSg/Olw6KFxkKykoXC5cZCopPyk/JC8sSXQ9L14oLXxcKyk/UCg/OihbLStdP1swLTksLl0qKVkpPyg/OihbLStdP1swLTksLl0qKU0pPyg/OihbLStdP1swLTksLl0qKVcpPyg/OihbLStdP1swLTksLl0qKUQpPyg/OlQoPzooWy0rXT9bMC05LC5dKilIKT8oPzooWy0rXT9bMC05LC5dKilNKT8oPzooWy0rXT9bMC05LC5dKilTKT8pPyQvO2Z1bmN0aW9uIEF0KGUsdCl7dmFyIG4scyxpLHI9ZSxhPW51bGw7cmV0dXJuIFJ0KGUpP3I9e21zOmUuX21pbGxpc2Vjb25kcyxkOmUuX2RheXMsTTplLl9tb250aHN9OmQoZSk/KHI9e30sdD9yW3RdPWU6ci5taWxsaXNlY29uZHM9ZSk6KGE9RXQuZXhlYyhlKSk/KG49Ii0iPT09YVsxXT8tMToxLHI9e3k6MCxkOmsoYVt5ZV0pKm4saDprKGFbZ2VdKSpuLG06ayhhW3BlXSkqbixzOmsoYVt2ZV0pKm4sbXM6ayhDdCgxZTMqYVt3ZV0pKSpufSk6KGE9SXQuZXhlYyhlKSk/KG49Ii0iPT09YVsxXT8tMTooYVsxXSwxKSxyPXt5Omp0KGFbMl0sbiksTTpqdChhWzNdLG4pLHc6anQoYVs0XSxuKSxkOmp0KGFbNV0sbiksaDpqdChhWzZdLG4pLG06anQoYVs3XSxuKSxzOmp0KGFbOF0sbil9KTpudWxsPT1yP3I9e306Im9iamVjdCI9PXR5cGVvZiByJiYoImZyb20iaW4gcnx8InRvImluIHIpJiYoaT1mdW5jdGlvbihlLHQpe3ZhciBuO2lmKCFlLmlzVmFsaWQoKXx8IXQuaXNWYWxpZCgpKXJldHVybnttaWxsaXNlY29uZHM6MCxtb250aHM6MH07dD1OdCh0LGUpLGUuaXNCZWZvcmUodCk/bj1adChlLHQpOigobj1adCh0LGUpKS5taWxsaXNlY29uZHM9LW4ubWlsbGlzZWNvbmRzLG4ubW9udGhzPS1uLm1vbnRocyk7cmV0dXJuIG59KFR0KHIuZnJvbSksVHQoci50bykpLChyPXt9KS5tcz1pLm1pbGxpc2Vjb25kcyxyLk09aS5tb250aHMpLHM9bmV3IEh0KHIpLFJ0KGUpJiZtKGUsIl9sb2NhbGUiKSYmKHMuX2xvY2FsZT1lLl9sb2NhbGUpLHN9ZnVuY3Rpb24ganQoZSx0KXt2YXIgbj1lJiZwYXJzZUZsb2F0KGUucmVwbGFjZSgiLCIsIi4iKSk7cmV0dXJuKGlzTmFOKG4pPzA6bikqdH1mdW5jdGlvbiBadChlLHQpe3ZhciBuPXttaWxsaXNlY29uZHM6MCxtb250aHM6MH07cmV0dXJuIG4ubW9udGhzPXQubW9udGgoKS1lLm1vbnRoKCkrMTIqKHQueWVhcigpLWUueWVhcigpKSxlLmNsb25lKCkuYWRkKG4ubW9udGhzLCJNIikuaXNBZnRlcih0KSYmLS1uLm1vbnRocyxuLm1pbGxpc2Vjb25kcz0rdC0rZS5jbG9uZSgpLmFkZChuLm1vbnRocywiTSIpLG59ZnVuY3Rpb24genQocyxpKXtyZXR1cm4gZnVuY3Rpb24oZSx0KXt2YXIgbjtyZXR1cm4gbnVsbD09PXR8fGlzTmFOKCt0KXx8KFQoaSwibW9tZW50KCkuIitpKyIocGVyaW9kLCBudW1iZXIpIGlzIGRlcHJlY2F0ZWQuIFBsZWFzZSB1c2UgbW9tZW50KCkuIitpKyIobnVtYmVyLCBwZXJpb2QpLiBTZWUgaHR0cDovL21vbWVudGpzLmNvbS9ndWlkZXMvIy93YXJuaW5ncy9hZGQtaW52ZXJ0ZWQtcGFyYW0vIGZvciBtb3JlIGluZm8uIiksbj1lLGU9dCx0PW4pLCR0KHRoaXMsQXQoZT0ic3RyaW5nIj09dHlwZW9mIGU/K2U6ZSx0KSxzKSx0aGlzfX1mdW5jdGlvbiAkdChlLHQsbixzKXt2YXIgaT10Ll9taWxsaXNlY29uZHMscj1DdCh0Ll9kYXlzKSxhPUN0KHQuX21vbnRocyk7ZS5pc1ZhbGlkKCkmJihzPW51bGw9PXN8fHMsYSYmQ2UoZSx4ZShlLCJNb250aCIpK2EqbiksciYmYmUoZSwiRGF0ZSIseGUoZSwiRGF0ZSIpK3IqbiksaSYmZS5fZC5zZXRUaW1lKGUuX2QudmFsdWVPZigpK2kqbikscyYmYy51cGRhdGVPZmZzZXQoZSxyfHxhKSl9QXQuZm49SHQucHJvdG90eXBlLEF0LmludmFsaWQ9ZnVuY3Rpb24oKXtyZXR1cm4gQXQoTmFOKX07dmFyIHF0PXp0KDEsImFkZCIpLEp0PXp0KC0xLCJzdWJ0cmFjdCIpO2Z1bmN0aW9uIEJ0KGUsdCl7dmFyIG49MTIqKHQueWVhcigpLWUueWVhcigpKSsodC5tb250aCgpLWUubW9udGgoKSkscz1lLmNsb25lKCkuYWRkKG4sIm1vbnRocyIpO3JldHVybi0obisodC1zPDA/KHQtcykvKHMtZS5jbG9uZSgpLmFkZChuLTEsIm1vbnRocyIpKToodC1zKS8oZS5jbG9uZSgpLmFkZChuKzEsIm1vbnRocyIpLXMpKSl8fDB9ZnVuY3Rpb24gUXQoZSl7dmFyIHQ7cmV0dXJuIHZvaWQgMD09PWU/dGhpcy5fbG9jYWxlLl9hYmJyOihudWxsIT0odD1sdChlKSkmJih0aGlzLl9sb2NhbGU9dCksdGhpcyl9Yy5kZWZhdWx0Rm9ybWF0PSJZWVlZLU1NLUREVEhIOm1tOnNzWiIsYy5kZWZhdWx0Rm9ybWF0VXRjPSJZWVlZLU1NLUREVEhIOm1tOnNzW1pdIjt2YXIgWHQ9bigibW9tZW50KCkubGFuZygpIGlzIGRlcHJlY2F0ZWQuIEluc3RlYWQsIHVzZSBtb21lbnQoKS5sb2NhbGVEYXRhKCkgdG8gZ2V0IHRoZSBsYW5ndWFnZSBjb25maWd1cmF0aW9uLiBVc2UgbW9tZW50KCkubG9jYWxlKCkgdG8gY2hhbmdlIGxhbmd1YWdlcy4iLGZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lP3RoaXMubG9jYWxlRGF0YSgpOnRoaXMubG9jYWxlKGUpfSk7ZnVuY3Rpb24gS3QoKXtyZXR1cm4gdGhpcy5fbG9jYWxlfWZ1bmN0aW9uIGVuKGUsdCl7SSgwLFtlLGUubGVuZ3RoXSwwLHQpfWZ1bmN0aW9uIHRuKGUsdCxuLHMsaSl7dmFyIHI7cmV0dXJuIG51bGw9PWU/SWUodGhpcyxzLGkpLnllYXI6KChyPUFlKGUscyxpKSk8dCYmKHQ9ciksZnVuY3Rpb24oZSx0LG4scyxpKXt2YXIgcj1FZShlLHQsbixzLGkpLGE9R2Uoci55ZWFyLDAsci5kYXlPZlllYXIpO3JldHVybiB0aGlzLnllYXIoYS5nZXRVVENGdWxsWWVhcigpKSx0aGlzLm1vbnRoKGEuZ2V0VVRDTW9udGgoKSksdGhpcy5kYXRlKGEuZ2V0VVRDRGF0ZSgpKSx0aGlzfS5jYWxsKHRoaXMsZSx0LG4scyxpKSl9SSgwLFsiZ2ciLDJdLDAsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy53ZWVrWWVhcigpJTEwMH0pLEkoMCxbIkdHIiwyXSwwLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNvV2Vla1llYXIoKSUxMDB9KSxlbigiZ2dnZyIsIndlZWtZZWFyIiksZW4oImdnZ2dnIiwid2Vla1llYXIiKSxlbigiR0dHRyIsImlzb1dlZWtZZWFyIiksZW4oIkdHR0dHIiwiaXNvV2Vla1llYXIiKSxIKCJ3ZWVrWWVhciIsImdnIiksSCgiaXNvV2Vla1llYXIiLCJHRyIpLEwoIndlZWtZZWFyIiwxKSxMKCJpc29XZWVrWWVhciIsMSksdWUoIkciLHNlKSx1ZSgiZyIsc2UpLHVlKCJHRyIsQix6KSx1ZSgiZ2ciLEIseiksdWUoIkdHR0ciLGVlLHEpLHVlKCJnZ2dnIixlZSxxKSx1ZSgiR0dHR0ciLHRlLEopLHVlKCJnZ2dnZyIsdGUsSiksZmUoWyJnZ2dnIiwiZ2dnZ2ciLCJHR0dHIiwiR0dHR0ciXSxmdW5jdGlvbihlLHQsbixzKXt0W3Muc3Vic3RyKDAsMildPWsoZSl9KSxmZShbImdnIiwiR0ciXSxmdW5jdGlvbihlLHQsbixzKXt0W3NdPWMucGFyc2VUd29EaWdpdFllYXIoZSl9KSxJKCJRIiwwLCJRbyIsInF1YXJ0ZXIiKSxIKCJxdWFydGVyIiwiUSIpLEwoInF1YXJ0ZXIiLDcpLHVlKCJRIixaKSxjZSgiUSIsZnVuY3Rpb24oZSx0KXt0W19lXT0zKihrKGUpLTEpfSksSSgiRCIsWyJERCIsMl0sIkRvIiwiZGF0ZSIpLEgoImRhdGUiLCJEIiksTCgiZGF0ZSIsOSksdWUoIkQiLEIpLHVlKCJERCIsQix6KSx1ZSgiRG8iLGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGU/dC5fZGF5T2ZNb250aE9yZGluYWxQYXJzZXx8dC5fb3JkaW5hbFBhcnNlOnQuX2RheU9mTW9udGhPcmRpbmFsUGFyc2VMZW5pZW50fSksY2UoWyJEIiwiREQiXSx5ZSksY2UoIkRvIixmdW5jdGlvbihlLHQpe3RbeWVdPWsoZS5tYXRjaChCKVswXSl9KTt2YXIgbm49VGUoIkRhdGUiLCEwKTtJKCJEREQiLFsiRERERCIsM10sIkRERG8iLCJkYXlPZlllYXIiKSxIKCJkYXlPZlllYXIiLCJEREQiKSxMKCJkYXlPZlllYXIiLDQpLHVlKCJEREQiLEspLHVlKCJEREREIiwkKSxjZShbIkRERCIsIkREREQiXSxmdW5jdGlvbihlLHQsbil7bi5fZGF5T2ZZZWFyPWsoZSl9KSxJKCJtIixbIm1tIiwyXSwwLCJtaW51dGUiKSxIKCJtaW51dGUiLCJtIiksTCgibWludXRlIiwxNCksdWUoIm0iLEIpLHVlKCJtbSIsQix6KSxjZShbIm0iLCJtbSJdLHBlKTt2YXIgc249VGUoIk1pbnV0ZXMiLCExKTtJKCJzIixbInNzIiwyXSwwLCJzZWNvbmQiKSxIKCJzZWNvbmQiLCJzIiksTCgic2Vjb25kIiwxNSksdWUoInMiLEIpLHVlKCJzcyIsQix6KSxjZShbInMiLCJzcyJdLHZlKTt2YXIgcm4sYW49VGUoIlNlY29uZHMiLCExKTtmb3IoSSgiUyIsMCwwLGZ1bmN0aW9uKCl7cmV0dXJufn4odGhpcy5taWxsaXNlY29uZCgpLzEwMCl9KSxJKDAsWyJTUyIsMl0sMCxmdW5jdGlvbigpe3JldHVybn5+KHRoaXMubWlsbGlzZWNvbmQoKS8xMCl9KSxJKDAsWyJTU1MiLDNdLDAsIm1pbGxpc2Vjb25kIiksSSgwLFsiU1NTUyIsNF0sMCxmdW5jdGlvbigpe3JldHVybiAxMCp0aGlzLm1pbGxpc2Vjb25kKCl9KSxJKDAsWyJTU1NTUyIsNV0sMCxmdW5jdGlvbigpe3JldHVybiAxMDAqdGhpcy5taWxsaXNlY29uZCgpfSksSSgwLFsiU1NTU1NTIiw2XSwwLGZ1bmN0aW9uKCl7cmV0dXJuIDFlMyp0aGlzLm1pbGxpc2Vjb25kKCl9KSxJKDAsWyJTU1NTU1NTIiw3XSwwLGZ1bmN0aW9uKCl7cmV0dXJuIDFlNCp0aGlzLm1pbGxpc2Vjb25kKCl9KSxJKDAsWyJTU1NTU1NTUyIsOF0sMCxmdW5jdGlvbigpe3JldHVybiAxZTUqdGhpcy5taWxsaXNlY29uZCgpfSksSSgwLFsiU1NTU1NTU1NTIiw5XSwwLGZ1bmN0aW9uKCl7cmV0dXJuIDFlNip0aGlzLm1pbGxpc2Vjb25kKCl9KSxIKCJtaWxsaXNlY29uZCIsIm1zIiksTCgibWlsbGlzZWNvbmQiLDE2KSx1ZSgiUyIsSyxaKSx1ZSgiU1MiLEsseiksdWUoIlNTUyIsSywkKSxybj0iU1NTUyI7cm4ubGVuZ3RoPD05O3JuKz0iUyIpdWUocm4sbmUpO2Z1bmN0aW9uIG9uKGUsdCl7dFt3ZV09aygxZTMqKCIwLiIrZSkpfWZvcihybj0iUyI7cm4ubGVuZ3RoPD05O3JuKz0iUyIpY2Uocm4sb24pO3ZhciB1bj1UZSgiTWlsbGlzZWNvbmRzIiwhMSk7SSgieiIsMCwwLCJ6b25lQWJiciIpLEkoInp6IiwwLDAsInpvbmVOYW1lIik7dmFyIGxuPU0ucHJvdG90eXBlO2Z1bmN0aW9uIGRuKGUpe3JldHVybiBlfWxuLmFkZD1xdCxsbi5jYWxlbmRhcj1mdW5jdGlvbihlLHQpe3ZhciBuPWV8fFR0KCkscz1OdChuLHRoaXMpLnN0YXJ0T2YoImRheSIpLGk9Yy5jYWxlbmRhckZvcm1hdCh0aGlzLHMpfHwic2FtZUVsc2UiLHI9dCYmKHgodFtpXSk/dFtpXS5jYWxsKHRoaXMsbik6dFtpXSk7cmV0dXJuIHRoaXMuZm9ybWF0KHJ8fHRoaXMubG9jYWxlRGF0YSgpLmNhbGVuZGFyKGksdGhpcyxUdChuKSkpfSxsbi5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgTSh0aGlzKX0sbG4uZGlmZj1mdW5jdGlvbihlLHQsbil7dmFyIHMsaSxyO2lmKCF0aGlzLmlzVmFsaWQoKSlyZXR1cm4gTmFOO2lmKCEocz1OdChlLHRoaXMpKS5pc1ZhbGlkKCkpcmV0dXJuIE5hTjtzd2l0Y2goaT02ZTQqKHMudXRjT2Zmc2V0KCktdGhpcy51dGNPZmZzZXQoKSksdD1SKHQpKXtjYXNlInllYXIiOnI9QnQodGhpcyxzKS8xMjticmVhaztjYXNlIm1vbnRoIjpyPUJ0KHRoaXMscyk7YnJlYWs7Y2FzZSJxdWFydGVyIjpyPUJ0KHRoaXMscykvMzticmVhaztjYXNlInNlY29uZCI6cj0odGhpcy1zKS8xZTM7YnJlYWs7Y2FzZSJtaW51dGUiOnI9KHRoaXMtcykvNmU0O2JyZWFrO2Nhc2UiaG91ciI6cj0odGhpcy1zKS8zNmU1O2JyZWFrO2Nhc2UiZGF5IjpyPSh0aGlzLXMtaSkvODY0ZTU7YnJlYWs7Y2FzZSJ3ZWVrIjpyPSh0aGlzLXMtaSkvNjA0OGU1O2JyZWFrO2RlZmF1bHQ6cj10aGlzLXN9cmV0dXJuIG4/cjpEKHIpfSxsbi5lbmRPZj1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09KGU9UihlKSl8fCJtaWxsaXNlY29uZCI9PT1lP3RoaXM6KCJkYXRlIj09PWUmJihlPSJkYXkiKSx0aGlzLnN0YXJ0T2YoZSkuYWRkKDEsImlzb1dlZWsiPT09ZT8id2VlayI6ZSkuc3VidHJhY3QoMSwibXMiKSl9LGxuLmZvcm1hdD1mdW5jdGlvbihlKXtlfHwoZT10aGlzLmlzVXRjKCk/Yy5kZWZhdWx0Rm9ybWF0VXRjOmMuZGVmYXVsdEZvcm1hdCk7dmFyIHQ9QSh0aGlzLGUpO3JldHVybiB0aGlzLmxvY2FsZURhdGEoKS5wb3N0Zm9ybWF0KHQpfSxsbi5mcm9tPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuaXNWYWxpZCgpJiYoUyhlKSYmZS5pc1ZhbGlkKCl8fFR0KGUpLmlzVmFsaWQoKSk/QXQoe3RvOnRoaXMsZnJvbTplfSkubG9jYWxlKHRoaXMubG9jYWxlKCkpLmh1bWFuaXplKCF0KTp0aGlzLmxvY2FsZURhdGEoKS5pbnZhbGlkRGF0ZSgpfSxsbi5mcm9tTm93PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmZyb20oVHQoKSxlKX0sbG4udG89ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5pc1ZhbGlkKCkmJihTKGUpJiZlLmlzVmFsaWQoKXx8VHQoZSkuaXNWYWxpZCgpKT9BdCh7ZnJvbTp0aGlzLHRvOmV9KS5sb2NhbGUodGhpcy5sb2NhbGUoKSkuaHVtYW5pemUoIXQpOnRoaXMubG9jYWxlRGF0YSgpLmludmFsaWREYXRlKCl9LGxuLnRvTm93PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnRvKFR0KCksZSl9LGxuLmdldD1mdW5jdGlvbihlKXtyZXR1cm4geCh0aGlzW2U9UihlKV0pP3RoaXNbZV0oKTp0aGlzfSxsbi5pbnZhbGlkQXQ9ZnVuY3Rpb24oKXtyZXR1cm4gZyh0aGlzKS5vdmVyZmxvd30sbG4uaXNBZnRlcj1mdW5jdGlvbihlLHQpe3ZhciBuPVMoZSk/ZTpUdChlKTtyZXR1cm4hKCF0aGlzLmlzVmFsaWQoKXx8IW4uaXNWYWxpZCgpKSYmKCJtaWxsaXNlY29uZCI9PT0odD1SKGwodCk/Im1pbGxpc2Vjb25kIjp0KSk/dGhpcy52YWx1ZU9mKCk+bi52YWx1ZU9mKCk6bi52YWx1ZU9mKCk8dGhpcy5jbG9uZSgpLnN0YXJ0T2YodCkudmFsdWVPZigpKX0sbG4uaXNCZWZvcmU9ZnVuY3Rpb24oZSx0KXt2YXIgbj1TKGUpP2U6VHQoZSk7cmV0dXJuISghdGhpcy5pc1ZhbGlkKCl8fCFuLmlzVmFsaWQoKSkmJigibWlsbGlzZWNvbmQiPT09KHQ9UihsKHQpPyJtaWxsaXNlY29uZCI6dCkpP3RoaXMudmFsdWVPZigpPG4udmFsdWVPZigpOnRoaXMuY2xvbmUoKS5lbmRPZih0KS52YWx1ZU9mKCk8bi52YWx1ZU9mKCkpfSxsbi5pc0JldHdlZW49ZnVuY3Rpb24oZSx0LG4scyl7cmV0dXJuKCIoIj09PShzPXN8fCIoKSIpWzBdP3RoaXMuaXNBZnRlcihlLG4pOiF0aGlzLmlzQmVmb3JlKGUsbikpJiYoIikiPT09c1sxXT90aGlzLmlzQmVmb3JlKHQsbik6IXRoaXMuaXNBZnRlcih0LG4pKX0sbG4uaXNTYW1lPWZ1bmN0aW9uKGUsdCl7dmFyIG4scz1TKGUpP2U6VHQoZSk7cmV0dXJuISghdGhpcy5pc1ZhbGlkKCl8fCFzLmlzVmFsaWQoKSkmJigibWlsbGlzZWNvbmQiPT09KHQ9Uih0fHwibWlsbGlzZWNvbmQiKSk/dGhpcy52YWx1ZU9mKCk9PT1zLnZhbHVlT2YoKToobj1zLnZhbHVlT2YoKSx0aGlzLmNsb25lKCkuc3RhcnRPZih0KS52YWx1ZU9mKCk8PW4mJm48PXRoaXMuY2xvbmUoKS5lbmRPZih0KS52YWx1ZU9mKCkpKX0sbG4uaXNTYW1lT3JBZnRlcj1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmlzU2FtZShlLHQpfHx0aGlzLmlzQWZ0ZXIoZSx0KX0sbG4uaXNTYW1lT3JCZWZvcmU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5pc1NhbWUoZSx0KXx8dGhpcy5pc0JlZm9yZShlLHQpfSxsbi5pc1ZhbGlkPWZ1bmN0aW9uKCl7cmV0dXJuIHAodGhpcyl9LGxuLmxhbmc9WHQsbG4ubG9jYWxlPVF0LGxuLmxvY2FsZURhdGE9S3QsbG4ubWF4PWJ0LGxuLm1pbj14dCxsbi5wYXJzaW5nRmxhZ3M9ZnVuY3Rpb24oKXtyZXR1cm4gXyh7fSxnKHRoaXMpKX0sbG4uc2V0PWZ1bmN0aW9uKGUsdCl7aWYoIm9iamVjdCI9PXR5cGVvZiBlKWZvcih2YXIgbj1mdW5jdGlvbihlKXt2YXIgdD1bXTtmb3IodmFyIG4gaW4gZSl0LnB1c2goe3VuaXQ6bixwcmlvcml0eTpGW25dfSk7cmV0dXJuIHQuc29ydChmdW5jdGlvbihlLHQpe3JldHVybiBlLnByaW9yaXR5LXQucHJpb3JpdHl9KSx0fShlPUMoZSkpLHM9MDtzPG4ubGVuZ3RoO3MrKyl0aGlzW25bc10udW5pdF0oZVtuW3NdLnVuaXRdKTtlbHNlIGlmKHgodGhpc1tlPVIoZSldKSlyZXR1cm4gdGhpc1tlXSh0KTtyZXR1cm4gdGhpc30sbG4uc3RhcnRPZj1mdW5jdGlvbihlKXtzd2l0Y2goZT1SKGUpKXtjYXNlInllYXIiOnRoaXMubW9udGgoMCk7Y2FzZSJxdWFydGVyIjpjYXNlIm1vbnRoIjp0aGlzLmRhdGUoMSk7Y2FzZSJ3ZWVrIjpjYXNlImlzb1dlZWsiOmNhc2UiZGF5IjpjYXNlImRhdGUiOnRoaXMuaG91cnMoMCk7Y2FzZSJob3VyIjp0aGlzLm1pbnV0ZXMoMCk7Y2FzZSJtaW51dGUiOnRoaXMuc2Vjb25kcygwKTtjYXNlInNlY29uZCI6dGhpcy5taWxsaXNlY29uZHMoMCl9cmV0dXJuIndlZWsiPT09ZSYmdGhpcy53ZWVrZGF5KDApLCJpc29XZWVrIj09PWUmJnRoaXMuaXNvV2Vla2RheSgxKSwicXVhcnRlciI9PT1lJiZ0aGlzLm1vbnRoKDMqTWF0aC5mbG9vcih0aGlzLm1vbnRoKCkvMykpLHRoaXN9LGxuLnN1YnRyYWN0PUp0LGxuLnRvQXJyYXk9ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3JldHVybltlLnllYXIoKSxlLm1vbnRoKCksZS5kYXRlKCksZS5ob3VyKCksZS5taW51dGUoKSxlLnNlY29uZCgpLGUubWlsbGlzZWNvbmQoKV19LGxuLnRvT2JqZWN0PWZ1bmN0aW9uKCl7dmFyIGU9dGhpcztyZXR1cm57eWVhcnM6ZS55ZWFyKCksbW9udGhzOmUubW9udGgoKSxkYXRlOmUuZGF0ZSgpLGhvdXJzOmUuaG91cnMoKSxtaW51dGVzOmUubWludXRlcygpLHNlY29uZHM6ZS5zZWNvbmRzKCksbWlsbGlzZWNvbmRzOmUubWlsbGlzZWNvbmRzKCl9fSxsbi50b0RhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IERhdGUodGhpcy52YWx1ZU9mKCkpfSxsbi50b0lTT1N0cmluZz1mdW5jdGlvbihlKXtpZighdGhpcy5pc1ZhbGlkKCkpcmV0dXJuIG51bGw7dmFyIHQ9ITAhPT1lLG49dD90aGlzLmNsb25lKCkudXRjKCk6dGhpcztyZXR1cm4gbi55ZWFyKCk8MHx8OTk5OTxuLnllYXIoKT9BKG4sdD8iWVlZWVlZLU1NLUREW1RdSEg6bW06c3MuU1NTW1pdIjoiWVlZWVlZLU1NLUREW1RdSEg6bW06c3MuU1NTWiIpOngoRGF0ZS5wcm90b3R5cGUudG9JU09TdHJpbmcpP3Q/dGhpcy50b0RhdGUoKS50b0lTT1N0cmluZygpOm5ldyBEYXRlKHRoaXMudmFsdWVPZigpKzYwKnRoaXMudXRjT2Zmc2V0KCkqMWUzKS50b0lTT1N0cmluZygpLnJlcGxhY2UoIloiLEEobiwiWiIpKTpBKG4sdD8iWVlZWS1NTS1ERFtUXUhIOm1tOnNzLlNTU1taXSI6IllZWVktTU0tRERbVF1ISDptbTpzcy5TU1NaIil9LGxuLmluc3BlY3Q9ZnVuY3Rpb24oKXtpZighdGhpcy5pc1ZhbGlkKCkpcmV0dXJuIm1vbWVudC5pbnZhbGlkKC8qICIrdGhpcy5faSsiICovKSI7dmFyIGU9Im1vbWVudCIsdD0iIjt0aGlzLmlzTG9jYWwoKXx8KGU9MD09PXRoaXMudXRjT2Zmc2V0KCk/Im1vbWVudC51dGMiOiJtb21lbnQucGFyc2Vab25lIix0PSJaIik7dmFyIG49IlsiK2UrJygiXScscz0wPD10aGlzLnllYXIoKSYmdGhpcy55ZWFyKCk8PTk5OTk/IllZWVkiOiJZWVlZWVkiLGk9dCsnWyIpXSc7cmV0dXJuIHRoaXMuZm9ybWF0KG4rcysiLU1NLUREW1RdSEg6bW06c3MuU1NTIitpKX0sbG4udG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNWYWxpZCgpP3RoaXMudG9JU09TdHJpbmcoKTpudWxsfSxsbi50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNsb25lKCkubG9jYWxlKCJlbiIpLmZvcm1hdCgiZGRkIE1NTSBERCBZWVlZIEhIOm1tOnNzIFtHTVRdWloiKX0sbG4udW5peD1mdW5jdGlvbigpe3JldHVybiBNYXRoLmZsb29yKHRoaXMudmFsdWVPZigpLzFlMyl9LGxuLnZhbHVlT2Y9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZC52YWx1ZU9mKCktNmU0Kih0aGlzLl9vZmZzZXR8fDApfSxsbi5jcmVhdGlvbkRhdGE9ZnVuY3Rpb24oKXtyZXR1cm57aW5wdXQ6dGhpcy5faSxmb3JtYXQ6dGhpcy5fZixsb2NhbGU6dGhpcy5fbG9jYWxlLGlzVVRDOnRoaXMuX2lzVVRDLHN0cmljdDp0aGlzLl9zdHJpY3R9fSxsbi55ZWFyPU9lLGxuLmlzTGVhcFllYXI9ZnVuY3Rpb24oKXtyZXR1cm4ga2UodGhpcy55ZWFyKCkpfSxsbi53ZWVrWWVhcj1mdW5jdGlvbihlKXtyZXR1cm4gdG4uY2FsbCh0aGlzLGUsdGhpcy53ZWVrKCksdGhpcy53ZWVrZGF5KCksdGhpcy5sb2NhbGVEYXRhKCkuX3dlZWsuZG93LHRoaXMubG9jYWxlRGF0YSgpLl93ZWVrLmRveSl9LGxuLmlzb1dlZWtZZWFyPWZ1bmN0aW9uKGUpe3JldHVybiB0bi5jYWxsKHRoaXMsZSx0aGlzLmlzb1dlZWsoKSx0aGlzLmlzb1dlZWtkYXkoKSwxLDQpfSxsbi5xdWFydGVyPWxuLnF1YXJ0ZXJzPWZ1bmN0aW9uKGUpe3JldHVybiBudWxsPT1lP01hdGguY2VpbCgodGhpcy5tb250aCgpKzEpLzMpOnRoaXMubW9udGgoMyooZS0xKSt0aGlzLm1vbnRoKCklMyl9LGxuLm1vbnRoPUZlLGxuLmRheXNJbk1vbnRoPWZ1bmN0aW9uKCl7cmV0dXJuIFBlKHRoaXMueWVhcigpLHRoaXMubW9udGgoKSl9LGxuLndlZWs9bG4ud2Vla3M9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5sb2NhbGVEYXRhKCkud2Vlayh0aGlzKTtyZXR1cm4gbnVsbD09ZT90OnRoaXMuYWRkKDcqKGUtdCksImQiKX0sbG4uaXNvV2Vlaz1sbi5pc29XZWVrcz1mdW5jdGlvbihlKXt2YXIgdD1JZSh0aGlzLDEsNCkud2VlaztyZXR1cm4gbnVsbD09ZT90OnRoaXMuYWRkKDcqKGUtdCksImQiKX0sbG4ud2Vla3NJblllYXI9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmxvY2FsZURhdGEoKS5fd2VlaztyZXR1cm4gQWUodGhpcy55ZWFyKCksZS5kb3csZS5kb3kpfSxsbi5pc29XZWVrc0luWWVhcj1mdW5jdGlvbigpe3JldHVybiBBZSh0aGlzLnllYXIoKSwxLDQpfSxsbi5kYXRlPW5uLGxuLmRheT1sbi5kYXlzPWZ1bmN0aW9uKGUpe2lmKCF0aGlzLmlzVmFsaWQoKSlyZXR1cm4gbnVsbCE9ZT90aGlzOk5hTjt2YXIgdCxuLHM9dGhpcy5faXNVVEM/dGhpcy5fZC5nZXRVVENEYXkoKTp0aGlzLl9kLmdldERheSgpO3JldHVybiBudWxsIT1lPyh0PWUsbj10aGlzLmxvY2FsZURhdGEoKSxlPSJzdHJpbmciIT10eXBlb2YgdD90OmlzTmFOKHQpPyJudW1iZXIiPT10eXBlb2YodD1uLndlZWtkYXlzUGFyc2UodCkpP3Q6bnVsbDpwYXJzZUludCh0LDEwKSx0aGlzLmFkZChlLXMsImQiKSk6c30sbG4ud2Vla2RheT1mdW5jdGlvbihlKXtpZighdGhpcy5pc1ZhbGlkKCkpcmV0dXJuIG51bGwhPWU/dGhpczpOYU47dmFyIHQ9KHRoaXMuZGF5KCkrNy10aGlzLmxvY2FsZURhdGEoKS5fd2Vlay5kb3cpJTc7cmV0dXJuIG51bGw9PWU/dDp0aGlzLmFkZChlLXQsImQiKX0sbG4uaXNvV2Vla2RheT1mdW5jdGlvbihlKXtpZighdGhpcy5pc1ZhbGlkKCkpcmV0dXJuIG51bGwhPWU/dGhpczpOYU47aWYobnVsbCE9ZSl7dmFyIHQ9KG49ZSxzPXRoaXMubG9jYWxlRGF0YSgpLCJzdHJpbmciPT10eXBlb2Ygbj9zLndlZWtkYXlzUGFyc2UobiklN3x8Nzppc05hTihuKT9udWxsOm4pO3JldHVybiB0aGlzLmRheSh0aGlzLmRheSgpJTc/dDp0LTcpfXJldHVybiB0aGlzLmRheSgpfHw3O3ZhciBuLHN9LGxuLmRheU9mWWVhcj1mdW5jdGlvbihlKXt2YXIgdD1NYXRoLnJvdW5kKCh0aGlzLmNsb25lKCkuc3RhcnRPZigiZGF5IiktdGhpcy5jbG9uZSgpLnN0YXJ0T2YoInllYXIiKSkvODY0ZTUpKzE7cmV0dXJuIG51bGw9PWU/dDp0aGlzLmFkZChlLXQsImQiKX0sbG4uaG91cj1sbi5ob3Vycz10dCxsbi5taW51dGU9bG4ubWludXRlcz1zbixsbi5zZWNvbmQ9bG4uc2Vjb25kcz1hbixsbi5taWxsaXNlY29uZD1sbi5taWxsaXNlY29uZHM9dW4sbG4udXRjT2Zmc2V0PWZ1bmN0aW9uKGUsdCxuKXt2YXIgcyxpPXRoaXMuX29mZnNldHx8MDtpZighdGhpcy5pc1ZhbGlkKCkpcmV0dXJuIG51bGwhPWU/dGhpczpOYU47aWYobnVsbCE9ZSl7aWYoInN0cmluZyI9PXR5cGVvZiBlKXtpZihudWxsPT09KGU9VXQocmUsZSkpKXJldHVybiB0aGlzfWVsc2UgTWF0aC5hYnMoZSk8MTYmJiFuJiYoZSo9NjApO3JldHVybiF0aGlzLl9pc1VUQyYmdCYmKHM9R3QodGhpcykpLHRoaXMuX29mZnNldD1lLHRoaXMuX2lzVVRDPSEwLG51bGwhPXMmJnRoaXMuYWRkKHMsIm0iKSxpIT09ZSYmKCF0fHx0aGlzLl9jaGFuZ2VJblByb2dyZXNzPyR0KHRoaXMsQXQoZS1pLCJtIiksMSwhMSk6dGhpcy5fY2hhbmdlSW5Qcm9ncmVzc3x8KHRoaXMuX2NoYW5nZUluUHJvZ3Jlc3M9ITAsYy51cGRhdGVPZmZzZXQodGhpcywhMCksdGhpcy5fY2hhbmdlSW5Qcm9ncmVzcz1udWxsKSksdGhpc31yZXR1cm4gdGhpcy5faXNVVEM/aTpHdCh0aGlzKX0sbG4udXRjPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnV0Y09mZnNldCgwLGUpfSxsbi5sb2NhbD1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5faXNVVEMmJih0aGlzLnV0Y09mZnNldCgwLGUpLHRoaXMuX2lzVVRDPSExLGUmJnRoaXMuc3VidHJhY3QoR3QodGhpcyksIm0iKSksdGhpc30sbG4ucGFyc2Vab25lPWZ1bmN0aW9uKCl7aWYobnVsbCE9dGhpcy5fdHptKXRoaXMudXRjT2Zmc2V0KHRoaXMuX3R6bSwhMSwhMCk7ZWxzZSBpZigic3RyaW5nIj09dHlwZW9mIHRoaXMuX2kpe3ZhciBlPVV0KGllLHRoaXMuX2kpO251bGwhPWU/dGhpcy51dGNPZmZzZXQoZSk6dGhpcy51dGNPZmZzZXQoMCwhMCl9cmV0dXJuIHRoaXN9LGxuLmhhc0FsaWduZWRIb3VyT2Zmc2V0PWZ1bmN0aW9uKGUpe3JldHVybiEhdGhpcy5pc1ZhbGlkKCkmJihlPWU/VHQoZSkudXRjT2Zmc2V0KCk6MCwodGhpcy51dGNPZmZzZXQoKS1lKSU2MD09MCl9LGxuLmlzRFNUPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudXRjT2Zmc2V0KCk+dGhpcy5jbG9uZSgpLm1vbnRoKDApLnV0Y09mZnNldCgpfHx0aGlzLnV0Y09mZnNldCgpPnRoaXMuY2xvbmUoKS5tb250aCg1KS51dGNPZmZzZXQoKX0sbG4uaXNMb2NhbD1mdW5jdGlvbigpe3JldHVybiEhdGhpcy5pc1ZhbGlkKCkmJiF0aGlzLl9pc1VUQ30sbG4uaXNVdGNPZmZzZXQ9ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMuaXNWYWxpZCgpJiZ0aGlzLl9pc1VUQ30sbG4uaXNVdGM9VnQsbG4uaXNVVEM9VnQsbG4uem9uZUFiYnI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNVVEM/IlVUQyI6IiJ9LGxuLnpvbmVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzVVRDPyJDb29yZGluYXRlZCBVbml2ZXJzYWwgVGltZSI6IiJ9LGxuLmRhdGVzPW4oImRhdGVzIGFjY2Vzc29yIGlzIGRlcHJlY2F0ZWQuIFVzZSBkYXRlIGluc3RlYWQuIixubiksbG4ubW9udGhzPW4oIm1vbnRocyBhY2Nlc3NvciBpcyBkZXByZWNhdGVkLiBVc2UgbW9udGggaW5zdGVhZCIsRmUpLGxuLnllYXJzPW4oInllYXJzIGFjY2Vzc29yIGlzIGRlcHJlY2F0ZWQuIFVzZSB5ZWFyIGluc3RlYWQiLE9lKSxsbi56b25lPW4oIm1vbWVudCgpLnpvbmUgaXMgZGVwcmVjYXRlZCwgdXNlIG1vbWVudCgpLnV0Y09mZnNldCBpbnN0ZWFkLiBodHRwOi8vbW9tZW50anMuY29tL2d1aWRlcy8jL3dhcm5pbmdzL3pvbmUvIixmdW5jdGlvbihlLHQpe3JldHVybiBudWxsIT1lPygic3RyaW5nIiE9dHlwZW9mIGUmJihlPS1lKSx0aGlzLnV0Y09mZnNldChlLHQpLHRoaXMpOi10aGlzLnV0Y09mZnNldCgpfSksbG4uaXNEU1RTaGlmdGVkPW4oImlzRFNUU2hpZnRlZCBpcyBkZXByZWNhdGVkLiBTZWUgaHR0cDovL21vbWVudGpzLmNvbS9ndWlkZXMvIy93YXJuaW5ncy9kc3Qtc2hpZnRlZC8gZm9yIG1vcmUgaW5mb3JtYXRpb24iLGZ1bmN0aW9uKCl7aWYoIWwodGhpcy5faXNEU1RTaGlmdGVkKSlyZXR1cm4gdGhpcy5faXNEU1RTaGlmdGVkO3ZhciBlPXt9O2lmKHcoZSx0aGlzKSwoZT1ZdChlKSkuX2Epe3ZhciB0PWUuX2lzVVRDP3koZS5fYSk6VHQoZS5fYSk7dGhpcy5faXNEU1RTaGlmdGVkPXRoaXMuaXNWYWxpZCgpJiYwPGEoZS5fYSx0LnRvQXJyYXkoKSl9ZWxzZSB0aGlzLl9pc0RTVFNoaWZ0ZWQ9ITE7cmV0dXJuIHRoaXMuX2lzRFNUU2hpZnRlZH0pO3ZhciBobj1QLnByb3RvdHlwZTtmdW5jdGlvbiBjbihlLHQsbixzKXt2YXIgaT1sdCgpLHI9eSgpLnNldChzLHQpO3JldHVybiBpW25dKHIsZSl9ZnVuY3Rpb24gZm4oZSx0LG4pe2lmKGQoZSkmJih0PWUsZT12b2lkIDApLGU9ZXx8IiIsbnVsbCE9dClyZXR1cm4gY24oZSx0LG4sIm1vbnRoIik7dmFyIHMsaT1bXTtmb3Iocz0wO3M8MTI7cysrKWlbc109Y24oZSxzLG4sIm1vbnRoIik7cmV0dXJuIGl9ZnVuY3Rpb24gbW4oZSx0LG4scyl7ImJvb2xlYW4iPT10eXBlb2YgZT9kKHQpJiYobj10LHQ9dm9pZCAwKToodD1lLGU9ITEsZChuPXQpJiYobj10LHQ9dm9pZCAwKSksdD10fHwiIjt2YXIgaSxyPWx0KCksYT1lP3IuX3dlZWsuZG93OjA7aWYobnVsbCE9bilyZXR1cm4gY24odCwobithKSU3LHMsImRheSIpO3ZhciBvPVtdO2ZvcihpPTA7aTw3O2krKylvW2ldPWNuKHQsKGkrYSklNyxzLCJkYXkiKTtyZXR1cm4gb31obi5jYWxlbmRhcj1mdW5jdGlvbihlLHQsbil7dmFyIHM9dGhpcy5fY2FsZW5kYXJbZV18fHRoaXMuX2NhbGVuZGFyLnNhbWVFbHNlO3JldHVybiB4KHMpP3MuY2FsbCh0LG4pOnN9LGhuLmxvbmdEYXRlRm9ybWF0PWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2xvbmdEYXRlRm9ybWF0W2VdLG49dGhpcy5fbG9uZ0RhdGVGb3JtYXRbZS50b1VwcGVyQ2FzZSgpXTtyZXR1cm4gdHx8IW4/dDoodGhpcy5fbG9uZ0RhdGVGb3JtYXRbZV09bi5yZXBsYWNlKC9NTU1NfE1NfEREfGRkZGQvZyxmdW5jdGlvbihlKXtyZXR1cm4gZS5zbGljZSgxKX0pLHRoaXMuX2xvbmdEYXRlRm9ybWF0W2VdKX0saG4uaW52YWxpZERhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faW52YWxpZERhdGV9LGhuLm9yZGluYWw9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX29yZGluYWwucmVwbGFjZSgiJWQiLGUpfSxobi5wcmVwYXJzZT1kbixobi5wb3N0Zm9ybWF0PWRuLGhuLnJlbGF0aXZlVGltZT1mdW5jdGlvbihlLHQsbixzKXt2YXIgaT10aGlzLl9yZWxhdGl2ZVRpbWVbbl07cmV0dXJuIHgoaSk/aShlLHQsbixzKTppLnJlcGxhY2UoLyVkL2ksZSl9LGhuLnBhc3RGdXR1cmU9ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLl9yZWxhdGl2ZVRpbWVbMDxlPyJmdXR1cmUiOiJwYXN0Il07cmV0dXJuIHgobik/bih0KTpuLnJlcGxhY2UoLyVzL2ksdCl9LGhuLnNldD1mdW5jdGlvbihlKXt2YXIgdCxuO2ZvcihuIGluIGUpeCh0PWVbbl0pP3RoaXNbbl09dDp0aGlzWyJfIituXT10O3RoaXMuX2NvbmZpZz1lLHRoaXMuX2RheU9mTW9udGhPcmRpbmFsUGFyc2VMZW5pZW50PW5ldyBSZWdFeHAoKHRoaXMuX2RheU9mTW9udGhPcmRpbmFsUGFyc2Uuc291cmNlfHx0aGlzLl9vcmRpbmFsUGFyc2Uuc291cmNlKSsifCIrL1xkezEsMn0vLnNvdXJjZSl9LGhuLm1vbnRocz1mdW5jdGlvbihlLHQpe3JldHVybiBlP28odGhpcy5fbW9udGhzKT90aGlzLl9tb250aHNbZS5tb250aCgpXTp0aGlzLl9tb250aHNbKHRoaXMuX21vbnRocy5pc0Zvcm1hdHx8V2UpLnRlc3QodCk/ImZvcm1hdCI6InN0YW5kYWxvbmUiXVtlLm1vbnRoKCldOm8odGhpcy5fbW9udGhzKT90aGlzLl9tb250aHM6dGhpcy5fbW9udGhzLnN0YW5kYWxvbmV9LGhuLm1vbnRoc1Nob3J0PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGU/byh0aGlzLl9tb250aHNTaG9ydCk/dGhpcy5fbW9udGhzU2hvcnRbZS5tb250aCgpXTp0aGlzLl9tb250aHNTaG9ydFtXZS50ZXN0KHQpPyJmb3JtYXQiOiJzdGFuZGFsb25lIl1bZS5tb250aCgpXTpvKHRoaXMuX21vbnRoc1Nob3J0KT90aGlzLl9tb250aHNTaG9ydDp0aGlzLl9tb250aHNTaG9ydC5zdGFuZGFsb25lfSxobi5tb250aHNQYXJzZT1mdW5jdGlvbihlLHQsbil7dmFyIHMsaSxyO2lmKHRoaXMuX21vbnRoc1BhcnNlRXhhY3QpcmV0dXJuIGZ1bmN0aW9uKGUsdCxuKXt2YXIgcyxpLHIsYT1lLnRvTG9jYWxlTG93ZXJDYXNlKCk7aWYoIXRoaXMuX21vbnRoc1BhcnNlKWZvcih0aGlzLl9tb250aHNQYXJzZT1bXSx0aGlzLl9sb25nTW9udGhzUGFyc2U9W10sdGhpcy5fc2hvcnRNb250aHNQYXJzZT1bXSxzPTA7czwxMjsrK3Mpcj15KFsyZTMsc10pLHRoaXMuX3Nob3J0TW9udGhzUGFyc2Vbc109dGhpcy5tb250aHNTaG9ydChyLCIiKS50b0xvY2FsZUxvd2VyQ2FzZSgpLHRoaXMuX2xvbmdNb250aHNQYXJzZVtzXT10aGlzLm1vbnRocyhyLCIiKS50b0xvY2FsZUxvd2VyQ2FzZSgpO3JldHVybiBuPyJNTU0iPT09dD8tMSE9PShpPVllLmNhbGwodGhpcy5fc2hvcnRNb250aHNQYXJzZSxhKSk/aTpudWxsOi0xIT09KGk9WWUuY2FsbCh0aGlzLl9sb25nTW9udGhzUGFyc2UsYSkpP2k6bnVsbDoiTU1NIj09PXQ/LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX3Nob3J0TW9udGhzUGFyc2UsYSkpP2k6LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX2xvbmdNb250aHNQYXJzZSxhKSk/aTpudWxsOi0xIT09KGk9WWUuY2FsbCh0aGlzLl9sb25nTW9udGhzUGFyc2UsYSkpP2k6LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX3Nob3J0TW9udGhzUGFyc2UsYSkpP2k6bnVsbH0uY2FsbCh0aGlzLGUsdCxuKTtmb3IodGhpcy5fbW9udGhzUGFyc2V8fCh0aGlzLl9tb250aHNQYXJzZT1bXSx0aGlzLl9sb25nTW9udGhzUGFyc2U9W10sdGhpcy5fc2hvcnRNb250aHNQYXJzZT1bXSkscz0wO3M8MTI7cysrKXtpZihpPXkoWzJlMyxzXSksbiYmIXRoaXMuX2xvbmdNb250aHNQYXJzZVtzXSYmKHRoaXMuX2xvbmdNb250aHNQYXJzZVtzXT1uZXcgUmVnRXhwKCJeIit0aGlzLm1vbnRocyhpLCIiKS5yZXBsYWNlKCIuIiwiIikrIiQiLCJpIiksdGhpcy5fc2hvcnRNb250aHNQYXJzZVtzXT1uZXcgUmVnRXhwKCJeIit0aGlzLm1vbnRoc1Nob3J0KGksIiIpLnJlcGxhY2UoIi4iLCIiKSsiJCIsImkiKSksbnx8dGhpcy5fbW9udGhzUGFyc2Vbc118fChyPSJeIit0aGlzLm1vbnRocyhpLCIiKSsifF4iK3RoaXMubW9udGhzU2hvcnQoaSwiIiksdGhpcy5fbW9udGhzUGFyc2Vbc109bmV3IFJlZ0V4cChyLnJlcGxhY2UoIi4iLCIiKSwiaSIpKSxuJiYiTU1NTSI9PT10JiZ0aGlzLl9sb25nTW9udGhzUGFyc2Vbc10udGVzdChlKSlyZXR1cm4gcztpZihuJiYiTU1NIj09PXQmJnRoaXMuX3Nob3J0TW9udGhzUGFyc2Vbc10udGVzdChlKSlyZXR1cm4gcztpZighbiYmdGhpcy5fbW9udGhzUGFyc2Vbc10udGVzdChlKSlyZXR1cm4gc319LGhuLm1vbnRoc1JlZ2V4PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9tb250aHNQYXJzZUV4YWN0PyhtKHRoaXMsIl9tb250aHNSZWdleCIpfHxOZS5jYWxsKHRoaXMpLGU/dGhpcy5fbW9udGhzU3RyaWN0UmVnZXg6dGhpcy5fbW9udGhzUmVnZXgpOihtKHRoaXMsIl9tb250aHNSZWdleCIpfHwodGhpcy5fbW9udGhzUmVnZXg9VWUpLHRoaXMuX21vbnRoc1N0cmljdFJlZ2V4JiZlP3RoaXMuX21vbnRoc1N0cmljdFJlZ2V4OnRoaXMuX21vbnRoc1JlZ2V4KX0saG4ubW9udGhzU2hvcnRSZWdleD1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fbW9udGhzUGFyc2VFeGFjdD8obSh0aGlzLCJfbW9udGhzUmVnZXgiKXx8TmUuY2FsbCh0aGlzKSxlP3RoaXMuX21vbnRoc1Nob3J0U3RyaWN0UmVnZXg6dGhpcy5fbW9udGhzU2hvcnRSZWdleCk6KG0odGhpcywiX21vbnRoc1Nob3J0UmVnZXgiKXx8KHRoaXMuX21vbnRoc1Nob3J0UmVnZXg9TGUpLHRoaXMuX21vbnRoc1Nob3J0U3RyaWN0UmVnZXgmJmU/dGhpcy5fbW9udGhzU2hvcnRTdHJpY3RSZWdleDp0aGlzLl9tb250aHNTaG9ydFJlZ2V4KX0saG4ud2Vlaz1mdW5jdGlvbihlKXtyZXR1cm4gSWUoZSx0aGlzLl93ZWVrLmRvdyx0aGlzLl93ZWVrLmRveSkud2Vla30saG4uZmlyc3REYXlPZlllYXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fd2Vlay5kb3l9LGhuLmZpcnN0RGF5T2ZXZWVrPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3dlZWsuZG93fSxobi53ZWVrZGF5cz1mdW5jdGlvbihlLHQpe3JldHVybiBlP28odGhpcy5fd2Vla2RheXMpP3RoaXMuX3dlZWtkYXlzW2UuZGF5KCldOnRoaXMuX3dlZWtkYXlzW3RoaXMuX3dlZWtkYXlzLmlzRm9ybWF0LnRlc3QodCk/ImZvcm1hdCI6InN0YW5kYWxvbmUiXVtlLmRheSgpXTpvKHRoaXMuX3dlZWtkYXlzKT90aGlzLl93ZWVrZGF5czp0aGlzLl93ZWVrZGF5cy5zdGFuZGFsb25lfSxobi53ZWVrZGF5c01pbj1mdW5jdGlvbihlKXtyZXR1cm4gZT90aGlzLl93ZWVrZGF5c01pbltlLmRheSgpXTp0aGlzLl93ZWVrZGF5c01pbn0saG4ud2Vla2RheXNTaG9ydD1mdW5jdGlvbihlKXtyZXR1cm4gZT90aGlzLl93ZWVrZGF5c1Nob3J0W2UuZGF5KCldOnRoaXMuX3dlZWtkYXlzU2hvcnR9LGhuLndlZWtkYXlzUGFyc2U9ZnVuY3Rpb24oZSx0LG4pe3ZhciBzLGkscjtpZih0aGlzLl93ZWVrZGF5c1BhcnNlRXhhY3QpcmV0dXJuIGZ1bmN0aW9uKGUsdCxuKXt2YXIgcyxpLHIsYT1lLnRvTG9jYWxlTG93ZXJDYXNlKCk7aWYoIXRoaXMuX3dlZWtkYXlzUGFyc2UpZm9yKHRoaXMuX3dlZWtkYXlzUGFyc2U9W10sdGhpcy5fc2hvcnRXZWVrZGF5c1BhcnNlPVtdLHRoaXMuX21pbldlZWtkYXlzUGFyc2U9W10scz0wO3M8NzsrK3Mpcj15KFsyZTMsMV0pLmRheShzKSx0aGlzLl9taW5XZWVrZGF5c1BhcnNlW3NdPXRoaXMud2Vla2RheXNNaW4ociwiIikudG9Mb2NhbGVMb3dlckNhc2UoKSx0aGlzLl9zaG9ydFdlZWtkYXlzUGFyc2Vbc109dGhpcy53ZWVrZGF5c1Nob3J0KHIsIiIpLnRvTG9jYWxlTG93ZXJDYXNlKCksdGhpcy5fd2Vla2RheXNQYXJzZVtzXT10aGlzLndlZWtkYXlzKHIsIiIpLnRvTG9jYWxlTG93ZXJDYXNlKCk7cmV0dXJuIG4/ImRkZGQiPT09dD8tMSE9PShpPVllLmNhbGwodGhpcy5fd2Vla2RheXNQYXJzZSxhKSk/aTpudWxsOiJkZGQiPT09dD8tMSE9PShpPVllLmNhbGwodGhpcy5fc2hvcnRXZWVrZGF5c1BhcnNlLGEpKT9pOm51bGw6LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX21pbldlZWtkYXlzUGFyc2UsYSkpP2k6bnVsbDoiZGRkZCI9PT10Py0xIT09KGk9WWUuY2FsbCh0aGlzLl93ZWVrZGF5c1BhcnNlLGEpKT9pOi0xIT09KGk9WWUuY2FsbCh0aGlzLl9zaG9ydFdlZWtkYXlzUGFyc2UsYSkpP2k6LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX21pbldlZWtkYXlzUGFyc2UsYSkpP2k6bnVsbDoiZGRkIj09PXQ/LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZSxhKSk/aTotMSE9PShpPVllLmNhbGwodGhpcy5fd2Vla2RheXNQYXJzZSxhKSk/aTotMSE9PShpPVllLmNhbGwodGhpcy5fbWluV2Vla2RheXNQYXJzZSxhKSk/aTpudWxsOi0xIT09KGk9WWUuY2FsbCh0aGlzLl9taW5XZWVrZGF5c1BhcnNlLGEpKT9pOi0xIT09KGk9WWUuY2FsbCh0aGlzLl93ZWVrZGF5c1BhcnNlLGEpKT9pOi0xIT09KGk9WWUuY2FsbCh0aGlzLl9zaG9ydFdlZWtkYXlzUGFyc2UsYSkpP2k6bnVsbH0uY2FsbCh0aGlzLGUsdCxuKTtmb3IodGhpcy5fd2Vla2RheXNQYXJzZXx8KHRoaXMuX3dlZWtkYXlzUGFyc2U9W10sdGhpcy5fbWluV2Vla2RheXNQYXJzZT1bXSx0aGlzLl9zaG9ydFdlZWtkYXlzUGFyc2U9W10sdGhpcy5fZnVsbFdlZWtkYXlzUGFyc2U9W10pLHM9MDtzPDc7cysrKXtpZihpPXkoWzJlMywxXSkuZGF5KHMpLG4mJiF0aGlzLl9mdWxsV2Vla2RheXNQYXJzZVtzXSYmKHRoaXMuX2Z1bGxXZWVrZGF5c1BhcnNlW3NdPW5ldyBSZWdFeHAoIl4iK3RoaXMud2Vla2RheXMoaSwiIikucmVwbGFjZSgiLiIsIlxcLj8iKSsiJCIsImkiKSx0aGlzLl9zaG9ydFdlZWtkYXlzUGFyc2Vbc109bmV3IFJlZ0V4cCgiXiIrdGhpcy53ZWVrZGF5c1Nob3J0KGksIiIpLnJlcGxhY2UoIi4iLCJcXC4/IikrIiQiLCJpIiksdGhpcy5fbWluV2Vla2RheXNQYXJzZVtzXT1uZXcgUmVnRXhwKCJeIit0aGlzLndlZWtkYXlzTWluKGksIiIpLnJlcGxhY2UoIi4iLCJcXC4/IikrIiQiLCJpIikpLHRoaXMuX3dlZWtkYXlzUGFyc2Vbc118fChyPSJeIit0aGlzLndlZWtkYXlzKGksIiIpKyJ8XiIrdGhpcy53ZWVrZGF5c1Nob3J0KGksIiIpKyJ8XiIrdGhpcy53ZWVrZGF5c01pbihpLCIiKSx0aGlzLl93ZWVrZGF5c1BhcnNlW3NdPW5ldyBSZWdFeHAoci5yZXBsYWNlKCIuIiwiIiksImkiKSksbiYmImRkZGQiPT09dCYmdGhpcy5fZnVsbFdlZWtkYXlzUGFyc2Vbc10udGVzdChlKSlyZXR1cm4gcztpZihuJiYiZGRkIj09PXQmJnRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZVtzXS50ZXN0KGUpKXJldHVybiBzO2lmKG4mJiJkZCI9PT10JiZ0aGlzLl9taW5XZWVrZGF5c1BhcnNlW3NdLnRlc3QoZSkpcmV0dXJuIHM7aWYoIW4mJnRoaXMuX3dlZWtkYXlzUGFyc2Vbc10udGVzdChlKSlyZXR1cm4gc319LGhuLndlZWtkYXlzUmVnZXg9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX3dlZWtkYXlzUGFyc2VFeGFjdD8obSh0aGlzLCJfd2Vla2RheXNSZWdleCIpfHxCZS5jYWxsKHRoaXMpLGU/dGhpcy5fd2Vla2RheXNTdHJpY3RSZWdleDp0aGlzLl93ZWVrZGF5c1JlZ2V4KToobSh0aGlzLCJfd2Vla2RheXNSZWdleCIpfHwodGhpcy5fd2Vla2RheXNSZWdleD0kZSksdGhpcy5fd2Vla2RheXNTdHJpY3RSZWdleCYmZT90aGlzLl93ZWVrZGF5c1N0cmljdFJlZ2V4OnRoaXMuX3dlZWtkYXlzUmVnZXgpfSxobi53ZWVrZGF5c1Nob3J0UmVnZXg9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX3dlZWtkYXlzUGFyc2VFeGFjdD8obSh0aGlzLCJfd2Vla2RheXNSZWdleCIpfHxCZS5jYWxsKHRoaXMpLGU/dGhpcy5fd2Vla2RheXNTaG9ydFN0cmljdFJlZ2V4OnRoaXMuX3dlZWtkYXlzU2hvcnRSZWdleCk6KG0odGhpcywiX3dlZWtkYXlzU2hvcnRSZWdleCIpfHwodGhpcy5fd2Vla2RheXNTaG9ydFJlZ2V4PXFlKSx0aGlzLl93ZWVrZGF5c1Nob3J0U3RyaWN0UmVnZXgmJmU/dGhpcy5fd2Vla2RheXNTaG9ydFN0cmljdFJlZ2V4OnRoaXMuX3dlZWtkYXlzU2hvcnRSZWdleCl9LGhuLndlZWtkYXlzTWluUmVnZXg9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX3dlZWtkYXlzUGFyc2VFeGFjdD8obSh0aGlzLCJfd2Vla2RheXNSZWdleCIpfHxCZS5jYWxsKHRoaXMpLGU/dGhpcy5fd2Vla2RheXNNaW5TdHJpY3RSZWdleDp0aGlzLl93ZWVrZGF5c01pblJlZ2V4KToobSh0aGlzLCJfd2Vla2RheXNNaW5SZWdleCIpfHwodGhpcy5fd2Vla2RheXNNaW5SZWdleD1KZSksdGhpcy5fd2Vla2RheXNNaW5TdHJpY3RSZWdleCYmZT90aGlzLl93ZWVrZGF5c01pblN0cmljdFJlZ2V4OnRoaXMuX3dlZWtkYXlzTWluUmVnZXgpfSxobi5pc1BNPWZ1bmN0aW9uKGUpe3JldHVybiJwIj09PShlKyIiKS50b0xvd2VyQ2FzZSgpLmNoYXJBdCgwKX0saG4ubWVyaWRpZW09ZnVuY3Rpb24oZSx0LG4pe3JldHVybiAxMTxlP24/InBtIjoiUE0iOm4/ImFtIjoiQU0ifSxvdCgiZW4iLHtkYXlPZk1vbnRoT3JkaW5hbFBhcnNlOi9cZHsxLDJ9KHRofHN0fG5kfHJkKS8sb3JkaW5hbDpmdW5jdGlvbihlKXt2YXIgdD1lJTEwO3JldHVybiBlKygxPT09ayhlJTEwMC8xMCk/InRoIjoxPT09dD8ic3QiOjI9PT10PyJuZCI6Mz09PXQ/InJkIjoidGgiKX19KSxjLmxhbmc9bigibW9tZW50LmxhbmcgaXMgZGVwcmVjYXRlZC4gVXNlIG1vbWVudC5sb2NhbGUgaW5zdGVhZC4iLG90KSxjLmxhbmdEYXRhPW4oIm1vbWVudC5sYW5nRGF0YSBpcyBkZXByZWNhdGVkLiBVc2UgbW9tZW50LmxvY2FsZURhdGEgaW5zdGVhZC4iLGx0KTt2YXIgX249TWF0aC5hYnM7ZnVuY3Rpb24geW4oZSx0LG4scyl7dmFyIGk9QXQodCxuKTtyZXR1cm4gZS5fbWlsbGlzZWNvbmRzKz1zKmkuX21pbGxpc2Vjb25kcyxlLl9kYXlzKz1zKmkuX2RheXMsZS5fbW9udGhzKz1zKmkuX21vbnRocyxlLl9idWJibGUoKX1mdW5jdGlvbiBnbihlKXtyZXR1cm4gZTwwP01hdGguZmxvb3IoZSk6TWF0aC5jZWlsKGUpfWZ1bmN0aW9uIHBuKGUpe3JldHVybiA0ODAwKmUvMTQ2MDk3fWZ1bmN0aW9uIHZuKGUpe3JldHVybiAxNDYwOTcqZS80ODAwfWZ1bmN0aW9uIHduKGUpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiB0aGlzLmFzKGUpfX12YXIgTW49d24oIm1zIiksU249d24oInMiKSxEbj13bigibSIpLGtuPXduKCJoIiksWW49d24oImQiKSxPbj13bigidyIpLFRuPXduKCJNIikseG49d24oInkiKTtmdW5jdGlvbiBibihlKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc1ZhbGlkKCk/dGhpcy5fZGF0YVtlXTpOYU59fXZhciBQbj1ibigibWlsbGlzZWNvbmRzIiksV249Ym4oInNlY29uZHMiKSxIbj1ibigibWludXRlcyIpLFJuPWJuKCJob3VycyIpLENuPWJuKCJkYXlzIiksRm49Ym4oIm1vbnRocyIpLExuPWJuKCJ5ZWFycyIpO3ZhciBVbj1NYXRoLnJvdW5kLE5uPXtzczo0NCxzOjQ1LG06NDUsaDoyMixkOjI2LE06MTF9O3ZhciBHbj1NYXRoLmFicztmdW5jdGlvbiBWbihlKXtyZXR1cm4oMDxlKS0oZTwwKXx8K2V9ZnVuY3Rpb24gRW4oKXtpZighdGhpcy5pc1ZhbGlkKCkpcmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLmludmFsaWREYXRlKCk7dmFyIGUsdCxuPUduKHRoaXMuX21pbGxpc2Vjb25kcykvMWUzLHM9R24odGhpcy5fZGF5cyksaT1Hbih0aGlzLl9tb250aHMpO3Q9RCgoZT1EKG4vNjApKS82MCksbiU9NjAsZSU9NjA7dmFyIHI9RChpLzEyKSxhPWklPTEyLG89cyx1PXQsbD1lLGQ9bj9uLnRvRml4ZWQoMykucmVwbGFjZSgvXC4/MCskLywiIik6IiIsaD10aGlzLmFzU2Vjb25kcygpO2lmKCFoKXJldHVybiJQMEQiO3ZhciBjPWg8MD8iLSI6IiIsZj1Wbih0aGlzLl9tb250aHMpIT09Vm4oaCk/Ii0iOiIiLG09Vm4odGhpcy5fZGF5cykhPT1WbihoKT8iLSI6IiIsXz1Wbih0aGlzLl9taWxsaXNlY29uZHMpIT09Vm4oaCk/Ii0iOiIiO3JldHVybiBjKyJQIisocj9mK3IrIlkiOiIiKSsoYT9mK2ErIk0iOiIiKSsobz9tK28rIkQiOiIiKSsodXx8bHx8ZD8iVCI6IiIpKyh1P18rdSsiSCI6IiIpKyhsP18rbCsiTSI6IiIpKyhkP18rZCsiUyI6IiIpfXZhciBJbj1IdC5wcm90b3R5cGU7cmV0dXJuIEluLmlzVmFsaWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNWYWxpZH0sSW4uYWJzPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fZGF0YTtyZXR1cm4gdGhpcy5fbWlsbGlzZWNvbmRzPV9uKHRoaXMuX21pbGxpc2Vjb25kcyksdGhpcy5fZGF5cz1fbih0aGlzLl9kYXlzKSx0aGlzLl9tb250aHM9X24odGhpcy5fbW9udGhzKSxlLm1pbGxpc2Vjb25kcz1fbihlLm1pbGxpc2Vjb25kcyksZS5zZWNvbmRzPV9uKGUuc2Vjb25kcyksZS5taW51dGVzPV9uKGUubWludXRlcyksZS5ob3Vycz1fbihlLmhvdXJzKSxlLm1vbnRocz1fbihlLm1vbnRocyksZS55ZWFycz1fbihlLnllYXJzKSx0aGlzfSxJbi5hZGQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4geW4odGhpcyxlLHQsMSl9LEluLnN1YnRyYWN0PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHluKHRoaXMsZSx0LC0xKX0sSW4uYXM9ZnVuY3Rpb24oZSl7aWYoIXRoaXMuaXNWYWxpZCgpKXJldHVybiBOYU47dmFyIHQsbixzPXRoaXMuX21pbGxpc2Vjb25kcztpZigibW9udGgiPT09KGU9UihlKSl8fCJ5ZWFyIj09PWUpcmV0dXJuIHQ9dGhpcy5fZGF5cytzLzg2NGU1LG49dGhpcy5fbW9udGhzK3BuKHQpLCJtb250aCI9PT1lP246bi8xMjtzd2l0Y2godD10aGlzLl9kYXlzK01hdGgucm91bmQodm4odGhpcy5fbW9udGhzKSksZSl7Y2FzZSJ3ZWVrIjpyZXR1cm4gdC83K3MvNjA0OGU1O2Nhc2UiZGF5IjpyZXR1cm4gdCtzLzg2NGU1O2Nhc2UiaG91ciI6cmV0dXJuIDI0KnQrcy8zNmU1O2Nhc2UibWludXRlIjpyZXR1cm4gMTQ0MCp0K3MvNmU0O2Nhc2Uic2Vjb25kIjpyZXR1cm4gODY0MDAqdCtzLzFlMztjYXNlIm1pbGxpc2Vjb25kIjpyZXR1cm4gTWF0aC5mbG9vcig4NjRlNSp0KStzO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJVbmtub3duIHVuaXQgIitlKX19LEluLmFzTWlsbGlzZWNvbmRzPU1uLEluLmFzU2Vjb25kcz1TbixJbi5hc01pbnV0ZXM9RG4sSW4uYXNIb3Vycz1rbixJbi5hc0RheXM9WW4sSW4uYXNXZWVrcz1PbixJbi5hc01vbnRocz1UbixJbi5hc1llYXJzPXhuLEluLnZhbHVlT2Y9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc1ZhbGlkKCk/dGhpcy5fbWlsbGlzZWNvbmRzKzg2NGU1KnRoaXMuX2RheXMrdGhpcy5fbW9udGhzJTEyKjI1OTJlNiszMTUzNmU2KmsodGhpcy5fbW9udGhzLzEyKTpOYU59LEluLl9idWJibGU9ZnVuY3Rpb24oKXt2YXIgZSx0LG4scyxpLHI9dGhpcy5fbWlsbGlzZWNvbmRzLGE9dGhpcy5fZGF5cyxvPXRoaXMuX21vbnRocyx1PXRoaXMuX2RhdGE7cmV0dXJuIDA8PXImJjA8PWEmJjA8PW98fHI8PTAmJmE8PTAmJm88PTB8fChyKz04NjRlNSpnbih2bihvKSthKSxvPWE9MCksdS5taWxsaXNlY29uZHM9ciUxZTMsZT1EKHIvMWUzKSx1LnNlY29uZHM9ZSU2MCx0PUQoZS82MCksdS5taW51dGVzPXQlNjAsbj1EKHQvNjApLHUuaG91cnM9biUyNCxvKz1pPUQocG4oYSs9RChuLzI0KSkpLGEtPWduKHZuKGkpKSxzPUQoby8xMiksbyU9MTIsdS5kYXlzPWEsdS5tb250aHM9byx1LnllYXJzPXMsdGhpc30sSW4uY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gQXQodGhpcyl9LEluLmdldD1mdW5jdGlvbihlKXtyZXR1cm4gZT1SKGUpLHRoaXMuaXNWYWxpZCgpP3RoaXNbZSsicyJdKCk6TmFOfSxJbi5taWxsaXNlY29uZHM9UG4sSW4uc2Vjb25kcz1XbixJbi5taW51dGVzPUhuLEluLmhvdXJzPVJuLEluLmRheXM9Q24sSW4ud2Vla3M9ZnVuY3Rpb24oKXtyZXR1cm4gRCh0aGlzLmRheXMoKS83KX0sSW4ubW9udGhzPUZuLEluLnllYXJzPUxuLEluLmh1bWFuaXplPWZ1bmN0aW9uKGUpe2lmKCF0aGlzLmlzVmFsaWQoKSlyZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkuaW52YWxpZERhdGUoKTt2YXIgdCxuLHMsaSxyLGEsbyx1LGwsZCxoLGM9dGhpcy5sb2NhbGVEYXRhKCksZj0obj0hZSxzPWMsaT1BdCh0PXRoaXMpLmFicygpLHI9VW4oaS5hcygicyIpKSxhPVVuKGkuYXMoIm0iKSksbz1VbihpLmFzKCJoIikpLHU9VW4oaS5hcygiZCIpKSxsPVVuKGkuYXMoIk0iKSksZD1VbihpLmFzKCJ5IikpLChoPXI8PU5uLnNzJiZbInMiLHJdfHxyPE5uLnMmJlsic3MiLHJdfHxhPD0xJiZbIm0iXXx8YTxObi5tJiZbIm1tIixhXXx8bzw9MSYmWyJoIl18fG88Tm4uaCYmWyJoaCIsb118fHU8PTEmJlsiZCJdfHx1PE5uLmQmJlsiZGQiLHVdfHxsPD0xJiZbIk0iXXx8bDxObi5NJiZbIk1NIixsXXx8ZDw9MSYmWyJ5Il18fFsieXkiLGRdKVsyXT1uLGhbM109MDwrdCxoWzRdPXMsZnVuY3Rpb24oZSx0LG4scyxpKXtyZXR1cm4gaS5yZWxhdGl2ZVRpbWUodHx8MSwhIW4sZSxzKX0uYXBwbHkobnVsbCxoKSk7cmV0dXJuIGUmJihmPWMucGFzdEZ1dHVyZSgrdGhpcyxmKSksYy5wb3N0Zm9ybWF0KGYpfSxJbi50b0lTT1N0cmluZz1FbixJbi50b1N0cmluZz1FbixJbi50b0pTT049RW4sSW4ubG9jYWxlPVF0LEluLmxvY2FsZURhdGE9S3QsSW4udG9Jc29TdHJpbmc9bigidG9Jc29TdHJpbmcoKSBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIHRvSVNPU3RyaW5nKCkgaW5zdGVhZCAobm90aWNlIHRoZSBjYXBpdGFscykiLEVuKSxJbi5sYW5nPVh0LEkoIlgiLDAsMCwidW5peCIpLEkoIngiLDAsMCwidmFsdWVPZiIpLHVlKCJ4IixzZSksdWUoIlgiLC9bKy1dP1xkKyhcLlxkezEsM30pPy8pLGNlKCJYIixmdW5jdGlvbihlLHQsbil7bi5fZD1uZXcgRGF0ZSgxZTMqcGFyc2VGbG9hdChlLDEwKSl9KSxjZSgieCIsZnVuY3Rpb24oZSx0LG4pe24uX2Q9bmV3IERhdGUoayhlKSl9KSxjLnZlcnNpb249IjIuMjIuMiIsZT1UdCxjLmZuPWxuLGMubWluPWZ1bmN0aW9uKCl7cmV0dXJuIFB0KCJpc0JlZm9yZSIsW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMCkpfSxjLm1heD1mdW5jdGlvbigpe3JldHVybiBQdCgiaXNBZnRlciIsW10uc2xpY2UuY2FsbChhcmd1bWVudHMsMCkpfSxjLm5vdz1mdW5jdGlvbigpe3JldHVybiBEYXRlLm5vdz9EYXRlLm5vdygpOituZXcgRGF0ZX0sYy51dGM9eSxjLnVuaXg9ZnVuY3Rpb24oZSl7cmV0dXJuIFR0KDFlMyplKX0sYy5tb250aHM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZm4oZSx0LCJtb250aHMiKX0sYy5pc0RhdGU9aCxjLmxvY2FsZT1vdCxjLmludmFsaWQ9dixjLmR1cmF0aW9uPUF0LGMuaXNNb21lbnQ9UyxjLndlZWtkYXlzPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gbW4oZSx0LG4sIndlZWtkYXlzIil9LGMucGFyc2Vab25lPWZ1bmN0aW9uKCl7cmV0dXJuIFR0LmFwcGx5KG51bGwsYXJndW1lbnRzKS5wYXJzZVpvbmUoKX0sYy5sb2NhbGVEYXRhPWx0LGMuaXNEdXJhdGlvbj1SdCxjLm1vbnRoc1Nob3J0PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGZuKGUsdCwibW9udGhzU2hvcnQiKX0sYy53ZWVrZGF5c01pbj1mdW5jdGlvbihlLHQsbil7cmV0dXJuIG1uKGUsdCxuLCJ3ZWVrZGF5c01pbiIpfSxjLmRlZmluZUxvY2FsZT11dCxjLnVwZGF0ZUxvY2FsZT1mdW5jdGlvbihlLHQpe2lmKG51bGwhPXQpe3ZhciBuLHMsaT1udDtudWxsIT0ocz1hdChlKSkmJihpPXMuX2NvbmZpZyksKG49bmV3IFAodD1iKGksdCkpKS5wYXJlbnRMb2NhbGU9c3RbZV0sc3RbZV09bixvdChlKX1lbHNlIG51bGwhPXN0W2VdJiYobnVsbCE9c3RbZV0ucGFyZW50TG9jYWxlP3N0W2VdPXN0W2VdLnBhcmVudExvY2FsZTpudWxsIT1zdFtlXSYmZGVsZXRlIHN0W2VdKTtyZXR1cm4gc3RbZV19LGMubG9jYWxlcz1mdW5jdGlvbigpe3JldHVybiBzKHN0KX0sYy53ZWVrZGF5c1Nob3J0PWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gbW4oZSx0LG4sIndlZWtkYXlzU2hvcnQiKX0sYy5ub3JtYWxpemVVbml0cz1SLGMucmVsYXRpdmVUaW1lUm91bmRpbmc9ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMD09PWU/VW46ImZ1bmN0aW9uIj09dHlwZW9mIGUmJihVbj1lLCEwKX0sYy5yZWxhdGl2ZVRpbWVUaHJlc2hvbGQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdm9pZCAwIT09Tm5bZV0mJih2b2lkIDA9PT10P05uW2VdOihObltlXT10LCJzIj09PWUmJihObi5zcz10LTEpLCEwKSl9LGMuY2FsZW5kYXJGb3JtYXQ9ZnVuY3Rpb24oZSx0KXt2YXIgbj1lLmRpZmYodCwiZGF5cyIsITApO3JldHVybiBuPC02PyJzYW1lRWxzZSI6bjwtMT8ibGFzdFdlZWsiOm48MD8ibGFzdERheSI6bjwxPyJzYW1lRGF5IjpuPDI/Im5leHREYXkiOm48Nz8ibmV4dFdlZWsiOiJzYW1lRWxzZSJ9LGMucHJvdG90eXBlPWxuLGMuSFRNTDVfRk1UPXtEQVRFVElNRV9MT0NBTDoiWVlZWS1NTS1ERFRISDptbSIsREFURVRJTUVfTE9DQUxfU0VDT05EUzoiWVlZWS1NTS1ERFRISDptbTpzcyIsREFURVRJTUVfTE9DQUxfTVM6IllZWVktTU0tRERUSEg6bW06c3MuU1NTIixEQVRFOiJZWVlZLU1NLUREIixUSU1FOiJISDptbSIsVElNRV9TRUNPTkRTOiJISDptbTpzcyIsVElNRV9NUzoiSEg6bW06c3MuU1NTIixXRUVLOiJZWVlZLVtXXVdXIixNT05USDoiWVlZWS1NTSJ9LGN9KTsNCiFmdW5jdGlvbihlLHQpeyJvYmplY3QiPT10eXBlb2YgZXhwb3J0cyYmInVuZGVmaW5lZCIhPXR5cGVvZiBtb2R1bGU/bW9kdWxlLmV4cG9ydHM9dCgpOiJmdW5jdGlvbiI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKHQpOmUuU3dlZXRhbGVydDI9dCgpfSh0aGlzLGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO3ZhciBxPSJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJiJzeW1ib2wiPT10eXBlb2YgU3ltYm9sLml0ZXJhdG9yP2Z1bmN0aW9uKGUpe3JldHVybiB0eXBlb2YgZX06ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJiJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJmUuY29uc3RydWN0b3I9PT1TeW1ib2wmJmUhPT1TeW1ib2wucHJvdG90eXBlPyJzeW1ib2wiOnR5cGVvZiBlfSxzPWZ1bmN0aW9uKGUsdCl7aWYoIShlIGluc3RhbmNlb2YgdCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIil9LG89ZnVuY3Rpb24oKXtmdW5jdGlvbiBvKGUsdCl7Zm9yKHZhciBuPTA7bjx0Lmxlbmd0aDtuKyspe3ZhciBvPXRbbl07by5lbnVtZXJhYmxlPW8uZW51bWVyYWJsZXx8ITEsby5jb25maWd1cmFibGU9ITAsInZhbHVlImluIG8mJihvLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxvLmtleSxvKX19cmV0dXJuIGZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gdCYmbyhlLnByb3RvdHlwZSx0KSxuJiZvKGUsbiksZX19KCkscj1PYmplY3QuYXNzaWdufHxmdW5jdGlvbihlKXtmb3IodmFyIHQ9MTt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKXt2YXIgbj1hcmd1bWVudHNbdF07Zm9yKHZhciBvIGluIG4pT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG4sbykmJihlW29dPW5bb10pfXJldHVybiBlfSxpPWZ1bmN0aW9uIGUodCxuLG8pe251bGw9PT10JiYodD1GdW5jdGlvbi5wcm90b3R5cGUpO3ZhciByPU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodCxuKTtpZih2b2lkIDA9PT1yKXt2YXIgaT1PYmplY3QuZ2V0UHJvdG90eXBlT2YodCk7cmV0dXJuIG51bGw9PT1pP3ZvaWQgMDplKGksbixvKX1pZigidmFsdWUiaW4gcilyZXR1cm4gci52YWx1ZTt2YXIgYT1yLmdldDtyZXR1cm4gdm9pZCAwIT09YT9hLmNhbGwobyk6dm9pZCAwfSxhPWZ1bmN0aW9uKGUsdCl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIHQmJm51bGwhPT10KXRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgIit0eXBlb2YgdCk7ZS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZSh0JiZ0LnByb3RvdHlwZSx7Y29uc3RydWN0b3I6e3ZhbHVlOmUsZW51bWVyYWJsZTohMSx3cml0YWJsZTohMCxjb25maWd1cmFibGU6ITB9fSksdCYmKE9iamVjdC5zZXRQcm90b3R5cGVPZj9PYmplY3Quc2V0UHJvdG90eXBlT2YoZSx0KTplLl9fcHJvdG9fXz10KX0sdT1mdW5jdGlvbihlLHQpe2lmKCFlKXRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7cmV0dXJuIXR8fCJvYmplY3QiIT10eXBlb2YgdCYmImZ1bmN0aW9uIiE9dHlwZW9mIHQ/ZTp0fSxNPWZ1bmN0aW9uKGUsdCl7aWYoQXJyYXkuaXNBcnJheShlKSlyZXR1cm4gZTtpZihTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGUpKXJldHVybiBmdW5jdGlvbihlLHQpe3ZhciBuPVtdLG89ITAscj0hMSxpPXZvaWQgMDt0cnl7Zm9yKHZhciBhLHM9ZVtTeW1ib2wuaXRlcmF0b3JdKCk7IShvPShhPXMubmV4dCgpKS5kb25lKSYmKG4ucHVzaChhLnZhbHVlKSwhdHx8bi5sZW5ndGghPT10KTtvPSEwKTt9Y2F0Y2goZSl7cj0hMCxpPWV9ZmluYWxseXt0cnl7IW8mJnMucmV0dXJuJiZzLnJldHVybigpfWZpbmFsbHl7aWYocil0aHJvdyBpfX1yZXR1cm4gbn0oZSx0KTt0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIil9LHQ9IlN3ZWV0QWxlcnQyOiIsbj1mdW5jdGlvbihlKXtyZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZSl9LHg9ZnVuY3Rpb24oZSl7Y29uc29sZS53YXJuKHQrIiAiK2UpfSxJPWZ1bmN0aW9uKGUpe2NvbnNvbGUuZXJyb3IodCsiICIrZSl9LGM9W10sbD1mdW5jdGlvbihlKXstMT09PWMuaW5kZXhPZihlKSYmKGMucHVzaChlKSx4KGUpKX0sSD1mdW5jdGlvbihlKXtyZXR1cm4iZnVuY3Rpb24iPT10eXBlb2YgZT9lKCk6ZX0sUj1mdW5jdGlvbihlKXtyZXR1cm4ib2JqZWN0Ij09PSh2b2lkIDA9PT1lPyJ1bmRlZmluZWQiOnEoZSkpJiYiZnVuY3Rpb24iPT10eXBlb2YgZS50aGVufSxlPU9iamVjdC5mcmVlemUoe2NhbmNlbDoiY2FuY2VsIixiYWNrZHJvcDoib3ZlcmxheSIsY2xvc2U6ImNsb3NlIixlc2M6ImVzYyIsdGltZXI6InRpbWVyIn0pLGQ9ZnVuY3Rpb24oZSl7dmFyIHQ9e307Zm9yKHZhciBuIGluIGUpdFtlW25dXT0ic3dhbDItIitlW25dO3JldHVybiB0fSxEPWQoWyJjb250YWluZXIiLCJzaG93biIsImhlaWdodC1hdXRvIiwiaW9zZml4IiwicG9wdXAiLCJtb2RhbCIsIm5vLWJhY2tkcm9wIiwidG9hc3QiLCJ0b2FzdC1zaG93biIsInRvYXN0LWNvbHVtbiIsImZhZGUiLCJzaG93IiwiaGlkZSIsIm5vYW5pbWF0aW9uIiwiY2xvc2UiLCJ0aXRsZSIsImhlYWRlciIsImNvbnRlbnQiLCJhY3Rpb25zIiwiY29uZmlybSIsImNhbmNlbCIsImZvb3RlciIsImljb24iLCJpY29uLXRleHQiLCJpbWFnZSIsImlucHV0IiwiZmlsZSIsInJhbmdlIiwic2VsZWN0IiwicmFkaW8iLCJjaGVja2JveCIsImxhYmVsIiwidGV4dGFyZWEiLCJpbnB1dGVycm9yIiwidmFsaWRhdGlvbmVycm9yIiwicHJvZ3Jlc3NzdGVwcyIsImFjdGl2ZXByb2dyZXNzc3RlcCIsInByb2dyZXNzY2lyY2xlIiwicHJvZ3Jlc3NsaW5lIiwibG9hZGluZyIsInN0eWxlZCIsInRvcCIsInRvcC1zdGFydCIsInRvcC1lbmQiLCJ0b3AtbGVmdCIsInRvcC1yaWdodCIsImNlbnRlciIsImNlbnRlci1zdGFydCIsImNlbnRlci1lbmQiLCJjZW50ZXItbGVmdCIsImNlbnRlci1yaWdodCIsImJvdHRvbSIsImJvdHRvbS1zdGFydCIsImJvdHRvbS1lbmQiLCJib3R0b20tbGVmdCIsImJvdHRvbS1yaWdodCIsImdyb3ctcm93IiwiZ3Jvdy1jb2x1bW4iLCJncm93LWZ1bGxzY3JlZW4iXSksQj1kKFsic3VjY2VzcyIsIndhcm5pbmciLCJpbmZvIiwicXVlc3Rpb24iLCJlcnJvciJdKSxwPXtwcmV2aW91c0JvZHlQYWRkaW5nOm51bGx9LGY9ZnVuY3Rpb24oZSx0KXtyZXR1cm4hIWUuY2xhc3NMaXN0JiZlLmNsYXNzTGlzdC5jb250YWlucyh0KX0sTj1mdW5jdGlvbihlKXtpZihlLmZvY3VzKCksImZpbGUiIT09ZS50eXBlKXt2YXIgdD1lLnZhbHVlO2UudmFsdWU9IiIsZS52YWx1ZT10fX0sbT1mdW5jdGlvbihlLHQsbil7ZSYmdCYmKCJzdHJpbmciPT10eXBlb2YgdCYmKHQ9dC5zcGxpdCgvXHMrLykuZmlsdGVyKEJvb2xlYW4pKSx0LmZvckVhY2goZnVuY3Rpb24odCl7ZS5mb3JFYWNoP2UuZm9yRWFjaChmdW5jdGlvbihlKXtuP2UuY2xhc3NMaXN0LmFkZCh0KTplLmNsYXNzTGlzdC5yZW1vdmUodCl9KTpuP2UuY2xhc3NMaXN0LmFkZCh0KTplLmNsYXNzTGlzdC5yZW1vdmUodCl9KSl9LFc9ZnVuY3Rpb24oZSx0KXttKGUsdCwhMCl9LEE9ZnVuY3Rpb24oZSx0KXttKGUsdCwhMSl9LHo9ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49MDtuPGUuY2hpbGROb2Rlcy5sZW5ndGg7bisrKWlmKGYoZS5jaGlsZE5vZGVzW25dLHQpKXJldHVybiBlLmNoaWxkTm9kZXNbbl19LFU9ZnVuY3Rpb24oZSl7ZS5zdHlsZS5vcGFjaXR5PSIiLGUuc3R5bGUuZGlzcGxheT1lLmlkPT09RC5jb250ZW50PyJibG9jayI6ImZsZXgifSxGPWZ1bmN0aW9uKGUpe2Uuc3R5bGUub3BhY2l0eT0iIixlLnN0eWxlLmRpc3BsYXk9Im5vbmUifSxLPWZ1bmN0aW9uKGUpe3JldHVybiBlJiYoZS5vZmZzZXRXaWR0aHx8ZS5vZmZzZXRIZWlnaHR8fGUuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGgpfSxTPWZ1bmN0aW9uKGUsdCl7ZS5zdHlsZS5yZW1vdmVQcm9wZXJ0eT9lLnN0eWxlLnJlbW92ZVByb3BlcnR5KHQpOmUuc3R5bGUucmVtb3ZlQXR0cmlidXRlKHQpfSxQPWZ1bmN0aW9uKCl7cmV0dXJuIGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvcigiLiIrRC5jb250YWluZXIpfSxoPWZ1bmN0aW9uKGUpe3ZhciB0PVAoKTtyZXR1cm4gdD90LnF1ZXJ5U2VsZWN0b3IoIi4iK2UpOm51bGx9LEU9ZnVuY3Rpb24oKXtyZXR1cm4gaChELnBvcHVwKX0sTz1mdW5jdGlvbigpe3ZhciBlPUUoKTtyZXR1cm4gbihlLnF1ZXJ5U2VsZWN0b3JBbGwoIi4iK0QuaWNvbikpfSxMPWZ1bmN0aW9uKCl7cmV0dXJuIGgoRC50aXRsZSl9LFo9ZnVuY3Rpb24oKXtyZXR1cm4gaChELmNvbnRlbnQpfSxRPWZ1bmN0aW9uKCl7cmV0dXJuIGgoRC5pbWFnZSl9LGc9ZnVuY3Rpb24oKXtyZXR1cm4gaChELnByb2dyZXNzc3RlcHMpfSxZPWZ1bmN0aW9uKCl7cmV0dXJuIGgoRC5jb25maXJtKX0sJD1mdW5jdGlvbigpe3JldHVybiBoKEQuY2FuY2VsKX0sSj1mdW5jdGlvbigpe3JldHVybiBoKEQuYWN0aW9ucyl9LFg9ZnVuY3Rpb24oKXtyZXR1cm4gaChELmZvb3Rlcil9LEc9ZnVuY3Rpb24oKXtyZXR1cm4gaChELmNsb3NlKX0sZWU9ZnVuY3Rpb24oKXt2YXIgZT1uKEUoKS5xdWVyeVNlbGVjdG9yQWxsKCdbdGFiaW5kZXhdOm5vdChbdGFiaW5kZXg9Ii0xIl0pOm5vdChbdGFiaW5kZXg9IjAiXSknKSkuc29ydChmdW5jdGlvbihlLHQpe3JldHVybiBlPXBhcnNlSW50KGUuZ2V0QXR0cmlidXRlKCJ0YWJpbmRleCIpKSwodD1wYXJzZUludCh0LmdldEF0dHJpYnV0ZSgidGFiaW5kZXgiKSkpPGU/MTplPHQ/LTE6MH0pLHQ9bihFKCkucXVlcnlTZWxlY3RvckFsbCgnYVtocmVmXSwgYXJlYVtocmVmXSwgaW5wdXQ6bm90KFtkaXNhYmxlZF0pLCBzZWxlY3Q6bm90KFtkaXNhYmxlZF0pLCB0ZXh0YXJlYTpub3QoW2Rpc2FibGVkXSksIGJ1dHRvbjpub3QoW2Rpc2FibGVkXSksIGlmcmFtZSwgb2JqZWN0LCBlbWJlZCwgW3RhYmluZGV4PSIwIl0sIFtjb250ZW50ZWRpdGFibGVdLCBhdWRpb1tjb250cm9sc10sIHZpZGVvW2NvbnRyb2xzXScpKS5maWx0ZXIoZnVuY3Rpb24oZSl7cmV0dXJuIi0xIiE9PWUuZ2V0QXR0cmlidXRlKCJ0YWJpbmRleCIpfSk7cmV0dXJuIGZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1bXSxuPTA7bjxlLmxlbmd0aDtuKyspLTE9PT10LmluZGV4T2YoZVtuXSkmJnQucHVzaChlW25dKTtyZXR1cm4gdH0oZS5jb25jYXQodCkpLmZpbHRlcihmdW5jdGlvbihlKXtyZXR1cm4gSyhlKX0pfSx2PWZ1bmN0aW9uKCl7cmV0dXJuIWRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmNvbnRhaW5zKERbInRvYXN0LXNob3duIl0pfSx5PWZ1bmN0aW9uKCl7cmV0dXJuIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmNvbnRhaW5zKERbInRvYXN0LXNob3duIl0pfSxiPWZ1bmN0aW9uKCl7cmV0dXJuInVuZGVmaW5lZCI9PXR5cGVvZiB3aW5kb3d8fCJ1bmRlZmluZWQiPT10eXBlb2YgZG9jdW1lbnR9LHc9KCdcbiA8ZGl2IGFyaWEtbGFiZWxsZWRieT0iJytELnRpdGxlKyciIGFyaWEtZGVzY3JpYmVkYnk9IicrRC5jb250ZW50KyciIGNsYXNzPSInK0QucG9wdXArJyIgdGFiaW5kZXg9Ii0xIj5cbiAgIDxkaXYgY2xhc3M9IicrRC5oZWFkZXIrJyI+XG4gICAgIDx1bCBjbGFzcz0iJytELnByb2dyZXNzc3RlcHMrJyI+PC91bD5cbiAgICAgPGRpdiBjbGFzcz0iJytELmljb24rIiAiK0IuZXJyb3IrJyI+XG4gICAgICAgPHNwYW4gY2xhc3M9InN3YWwyLXgtbWFyayI+PHNwYW4gY2xhc3M9InN3YWwyLXgtbWFyay1saW5lLWxlZnQiPjwvc3Bhbj48c3BhbiBjbGFzcz0ic3dhbDIteC1tYXJrLWxpbmUtcmlnaHQiPjwvc3Bhbj48L3NwYW4+XG4gICAgIDwvZGl2PlxuICAgICA8ZGl2IGNsYXNzPSInK0QuaWNvbisiICIrQi5xdWVzdGlvbisnIj5cbiAgICAgICA8c3BhbiBjbGFzcz0iJytEWyJpY29uLXRleHQiXSsnIj4/PC9zcGFuPlxuICAgICAgPC9kaXY+XG4gICAgIDxkaXYgY2xhc3M9IicrRC5pY29uKyIgIitCLndhcm5pbmcrJyI+XG4gICAgICAgPHNwYW4gY2xhc3M9IicrRFsiaWNvbi10ZXh0Il0rJyI+ITwvc3Bhbj5cbiAgICAgIDwvZGl2PlxuICAgICA8ZGl2IGNsYXNzPSInK0QuaWNvbisiICIrQi5pbmZvKyciPlxuICAgICAgIDxzcGFuIGNsYXNzPSInK0RbImljb24tdGV4dCJdKyciPmk8L3NwYW4+XG4gICAgICA8L2Rpdj5cbiAgICAgPGRpdiBjbGFzcz0iJytELmljb24rIiAiK0Iuc3VjY2VzcysnIj5cbiAgICAgICA8ZGl2IGNsYXNzPSJzd2FsMi1zdWNjZXNzLWNpcmN1bGFyLWxpbmUtbGVmdCI+PC9kaXY+XG4gICAgICAgPHNwYW4gY2xhc3M9InN3YWwyLXN1Y2Nlc3MtbGluZS10aXAiPjwvc3Bhbj4gPHNwYW4gY2xhc3M9InN3YWwyLXN1Y2Nlc3MtbGluZS1sb25nIj48L3NwYW4+XG4gICAgICAgPGRpdiBjbGFzcz0ic3dhbDItc3VjY2Vzcy1yaW5nIj48L2Rpdj4gPGRpdiBjbGFzcz0ic3dhbDItc3VjY2Vzcy1maXgiPjwvZGl2PlxuICAgICAgIDxkaXYgY2xhc3M9InN3YWwyLXN1Y2Nlc3MtY2lyY3VsYXItbGluZS1yaWdodCI+PC9kaXY+XG4gICAgIDwvZGl2PlxuICAgICA8aW1nIGNsYXNzPSInK0QuaW1hZ2UrJyIgLz5cbiAgICAgPGgyIGNsYXNzPSInK0QudGl0bGUrJyIgaWQ9IicrRC50aXRsZSsnIj48L2gyPlxuICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9IicrRC5jbG9zZSsnIj7DlzwvYnV0dG9uPlxuICAgPC9kaXY+XG4gICA8ZGl2IGNsYXNzPSInK0QuY29udGVudCsnIj5cbiAgICAgPGRpdiBpZD0iJytELmNvbnRlbnQrJyI+PC9kaXY+XG4gICAgIDxpbnB1dCBjbGFzcz0iJytELmlucHV0KyciIC8+XG4gICAgIDxpbnB1dCB0eXBlPSJmaWxlIiBjbGFzcz0iJytELmZpbGUrJyIgLz5cbiAgICAgPGRpdiBjbGFzcz0iJytELnJhbmdlKyciPlxuICAgICAgIDxpbnB1dCB0eXBlPSJyYW5nZSIgLz5cbiAgICAgICA8b3V0cHV0Pjwvb3V0cHV0PlxuICAgICA8L2Rpdj5cbiAgICAgPHNlbGVjdCBjbGFzcz0iJytELnNlbGVjdCsnIj48L3NlbGVjdD5cbiAgICAgPGRpdiBjbGFzcz0iJytELnJhZGlvKyciPjwvZGl2PlxuICAgICA8bGFiZWwgZm9yPSInK0QuY2hlY2tib3grJyIgY2xhc3M9IicrRC5jaGVja2JveCsnIj5cbiAgICAgICA8aW5wdXQgdHlwZT0iY2hlY2tib3giIC8+XG4gICAgIDwvbGFiZWw+XG4gICAgIDx0ZXh0YXJlYSBjbGFzcz0iJytELnRleHRhcmVhKyciPjwvdGV4dGFyZWE+XG4gICAgIDxkaXYgY2xhc3M9IicrRC52YWxpZGF0aW9uZXJyb3IrJyIgaWQ9IicrRC52YWxpZGF0aW9uZXJyb3IrJyI+PC9kaXY+XG4gICA8L2Rpdj5cbiAgIDxkaXYgY2xhc3M9IicrRC5hY3Rpb25zKyciPlxuICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9IicrRC5jb25maXJtKyciPk9LPC9idXR0b24+XG4gICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iJytELmNhbmNlbCsnIj5DYW5jZWw8L2J1dHRvbj5cbiAgIDwvZGl2PlxuICAgPGRpdiBjbGFzcz0iJytELmZvb3RlcisnIj5cbiAgIDwvZGl2PlxuIDwvZGl2PlxuJykucmVwbGFjZSgvKF58XG4pXHMqL2csIiIpLHRlPWZ1bmN0aW9uKGUpe3ZhciB0PVAoKTtpZih0JiYodC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHQpLEEoW2RvY3VtZW50LmRvY3VtZW50RWxlbWVudCxkb2N1bWVudC5ib2R5XSxbRFsibm8tYmFja2Ryb3AiXSxEWyJ0b2FzdC1zaG93biJdLERbImhhcy1jb2x1bW4iXV0pKSwhYigpKXt2YXIgbj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTtuLmNsYXNzTmFtZT1ELmNvbnRhaW5lcixuLmlubmVySFRNTD13LCgic3RyaW5nIj09dHlwZW9mIGUudGFyZ2V0P2RvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZS50YXJnZXQpOmUudGFyZ2V0KS5hcHBlbmRDaGlsZChuKTt2YXIgbz1FKCkscj1aKCksaT16KHIsRC5pbnB1dCksYT16KHIsRC5maWxlKSxzPXIucXVlcnlTZWxlY3RvcigiLiIrRC5yYW5nZSsiIGlucHV0IiksdT1yLnF1ZXJ5U2VsZWN0b3IoIi4iK0QucmFuZ2UrIiBvdXRwdXQiKSxjPXoocixELnNlbGVjdCksbD1yLnF1ZXJ5U2VsZWN0b3IoIi4iK0QuY2hlY2tib3grIiBpbnB1dCIpLGQ9eihyLEQudGV4dGFyZWEpO28uc2V0QXR0cmlidXRlKCJyb2xlIixlLnRvYXN0PyJhbGVydCI6ImRpYWxvZyIpLG8uc2V0QXR0cmlidXRlKCJhcmlhLWxpdmUiLGUudG9hc3Q/InBvbGl0ZSI6ImFzc2VydGl2ZSIpLGUudG9hc3R8fG8uc2V0QXR0cmlidXRlKCJhcmlhLW1vZGFsIiwidHJ1ZSIpO3ZhciBwPXZvaWQgMCxmPWZ1bmN0aW9uKGUpe0FlLmlzVmlzaWJsZSgpJiZwIT09ZS50YXJnZXQudmFsdWUmJkFlLnJlc2V0VmFsaWRhdGlvbkVycm9yKCkscD1lLnRhcmdldC52YWx1ZX07cmV0dXJuIGkub25pbnB1dD1mLGEub25jaGFuZ2U9ZixjLm9uY2hhbmdlPWYsbC5vbmNoYW5nZT1mLGQub25pbnB1dD1mLHMub25pbnB1dD1mdW5jdGlvbihlKXtmKGUpLHUudmFsdWU9cy52YWx1ZX0scy5vbmNoYW5nZT1mdW5jdGlvbihlKXtmKGUpLHMubmV4dFNpYmxpbmcudmFsdWU9cy52YWx1ZX0sb31JKCJTd2VldEFsZXJ0MiByZXF1aXJlcyBkb2N1bWVudCB0byBpbml0aWFsaXplIil9LG5lPWZ1bmN0aW9uKGUsdCl7aWYoIWUpcmV0dXJuIEYodCk7aWYoIm9iamVjdCI9PT0odm9pZCAwPT09ZT8idW5kZWZpbmVkIjpxKGUpKSlpZih0LmlubmVySFRNTD0iIiwwIGluIGUpZm9yKHZhciBuPTA7biBpbiBlO24rKyl0LmFwcGVuZENoaWxkKGVbbl0uY2xvbmVOb2RlKCEwKSk7ZWxzZSB0LmFwcGVuZENoaWxkKGUuY2xvbmVOb2RlKCEwKSk7ZWxzZSBlJiYodC5pbm5lckhUTUw9ZSk7VSh0KX0sQz1mdW5jdGlvbigpe2lmKGIoKSlyZXR1cm4hMTt2YXIgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSx0PXtXZWJraXRBbmltYXRpb246IndlYmtpdEFuaW1hdGlvbkVuZCIsT0FuaW1hdGlvbjoib0FuaW1hdGlvbkVuZCBvYW5pbWF0aW9uZW5kIixhbmltYXRpb246ImFuaW1hdGlvbmVuZCJ9O2Zvcih2YXIgbiBpbiB0KWlmKHQuaGFzT3duUHJvcGVydHkobikmJnZvaWQgMCE9PWUuc3R5bGVbbl0pcmV0dXJuIHRbbl07cmV0dXJuITF9KCksb2U9ZnVuY3Rpb24ocil7dmFyIGk9ZygpLGE9cGFyc2VJbnQobnVsbD09PXIuY3VycmVudFByb2dyZXNzU3RlcD9BZS5nZXRRdWV1ZVN0ZXAoKTpyLmN1cnJlbnRQcm9ncmVzc1N0ZXAsMTApO3IucHJvZ3Jlc3NTdGVwcyYmci5wcm9ncmVzc1N0ZXBzLmxlbmd0aD8oVShpKSxmdW5jdGlvbihlKXtmb3IoO2UuZmlyc3RDaGlsZDspZS5yZW1vdmVDaGlsZChlLmZpcnN0Q2hpbGQpfShpKSxhPj1yLnByb2dyZXNzU3RlcHMubGVuZ3RoJiZ4KCJJbnZhbGlkIGN1cnJlbnRQcm9ncmVzc1N0ZXAgcGFyYW1ldGVyLCBpdCBzaG91bGQgYmUgbGVzcyB0aGFuIHByb2dyZXNzU3RlcHMubGVuZ3RoIChjdXJyZW50UHJvZ3Jlc3NTdGVwIGxpa2UgSlMgYXJyYXlzIHN0YXJ0cyBmcm9tIDApIiksci5wcm9ncmVzc1N0ZXBzLmZvckVhY2goZnVuY3Rpb24oZSx0KXt2YXIgbj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJsaSIpO2lmKFcobixELnByb2dyZXNzY2lyY2xlKSxuLmlubmVySFRNTD1lLHQ9PT1hJiZXKG4sRC5hY3RpdmVwcm9ncmVzc3N0ZXApLGkuYXBwZW5kQ2hpbGQobiksdCE9PXIucHJvZ3Jlc3NTdGVwcy5sZW5ndGgtMSl7dmFyIG89ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgibGkiKTtXKG8sRC5wcm9ncmVzc2xpbmUpLHIucHJvZ3Jlc3NTdGVwc0Rpc3RhbmNlJiYoby5zdHlsZS53aWR0aD1yLnByb2dyZXNzU3RlcHNEaXN0YW5jZSksaS5hcHBlbmRDaGlsZChvKX19KSk6RihpKX0saz1mdW5jdGlvbigpe251bGw9PT1wLnByZXZpb3VzQm9keVBhZGRpbmcmJmRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0PndpbmRvdy5pbm5lckhlaWdodCYmKHAucHJldmlvdXNCb2R5UGFkZGluZz1wYXJzZUludCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKCJwYWRkaW5nLXJpZ2h0IikpLGRvY3VtZW50LmJvZHkuc3R5bGUucGFkZGluZ1JpZ2h0PXAucHJldmlvdXNCb2R5UGFkZGluZytmdW5jdGlvbigpe2lmKCJvbnRvdWNoc3RhcnQiaW4gd2luZG93fHxuYXZpZ2F0b3IubXNNYXhUb3VjaFBvaW50cylyZXR1cm4gMDt2YXIgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTtlLnN0eWxlLndpZHRoPSI1MHB4IixlLnN0eWxlLmhlaWdodD0iNTBweCIsZS5zdHlsZS5vdmVyZmxvdz0ic2Nyb2xsIixkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGUpO3ZhciB0PWUub2Zmc2V0V2lkdGgtZS5jbGllbnRXaWR0aDtyZXR1cm4gZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlKSx0fSgpKyJweCIpfSxyZT17fSxUPWZ1bmN0aW9uKGUsbil7dmFyIG89UCgpLHQ9RSgpO2lmKHQpe251bGwhPT1lJiYiZnVuY3Rpb24iPT10eXBlb2YgZSYmZSh0KSxBKHQsRC5zaG93KSxXKHQsRC5oaWRlKTt2YXIgcj1mdW5jdGlvbigpe3ZhciBlLHQ7eSgpfHwoZT13aW5kb3cuc2Nyb2xsWCx0PXdpbmRvdy5zY3JvbGxZLHJlLnJlc3RvcmVGb2N1c1RpbWVvdXQ9c2V0VGltZW91dChmdW5jdGlvbigpe3JlLnByZXZpb3VzQWN0aXZlRWxlbWVudCYmcmUucHJldmlvdXNBY3RpdmVFbGVtZW50LmZvY3VzJiYocmUucHJldmlvdXNBY3RpdmVFbGVtZW50LmZvY3VzKCkscmUucHJldmlvdXNBY3RpdmVFbGVtZW50PW51bGwpfSwxMDApLHZvaWQgMCE9PWUmJnZvaWQgMCE9PXQmJndpbmRvdy5zY3JvbGxUbyhlLHQpLHJlLmtleWRvd25UYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcigia2V5ZG93biIscmUua2V5ZG93bkhhbmRsZXIse2NhcHR1cmU6cmUua2V5ZG93bkxpc3RlbmVyQ2FwdHVyZX0pLHJlLmtleWRvd25IYW5kbGVyQWRkZWQ9ITEpLG8ucGFyZW50Tm9kZSYmby5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG8pLEEoW2RvY3VtZW50LmRvY3VtZW50RWxlbWVudCxkb2N1bWVudC5ib2R5XSxbRC5zaG93bixEWyJoZWlnaHQtYXV0byJdLERbIm5vLWJhY2tkcm9wIl0sRFsidG9hc3Qtc2hvd24iXSxEWyJ0b2FzdC1jb2x1bW4iXV0pLHYoKSYmKG51bGwhPT1wLnByZXZpb3VzQm9keVBhZGRpbmcmJihkb2N1bWVudC5ib2R5LnN0eWxlLnBhZGRpbmdSaWdodD1wLnByZXZpb3VzQm9keVBhZGRpbmcscC5wcmV2aW91c0JvZHlQYWRkaW5nPW51bGwpLGZ1bmN0aW9uKCl7aWYoZihkb2N1bWVudC5ib2R5LEQuaW9zZml4KSl7dmFyIGU9cGFyc2VJbnQoZG9jdW1lbnQuYm9keS5zdHlsZS50b3AsMTApO0EoZG9jdW1lbnQuYm9keSxELmlvc2ZpeCksZG9jdW1lbnQuYm9keS5zdHlsZS50b3A9IiIsZG9jdW1lbnQuYm9keS5zY3JvbGxUb3A9LTEqZX19KCkpLG51bGwhPT1uJiYiZnVuY3Rpb24iPT10eXBlb2YgbiYmc2V0VGltZW91dChmdW5jdGlvbigpe24oKX0pfTtDJiYhZih0LEQubm9hbmltYXRpb24pP3QuYWRkRXZlbnRMaXN0ZW5lcihDLGZ1bmN0aW9uIGUoKXt0LnJlbW92ZUV2ZW50TGlzdGVuZXIoQyxlKSxmKHQsRC5oaWRlKSYmcigpfSk6cigpfX07ZnVuY3Rpb24gaihlKXt2YXIgdD1mdW5jdGlvbiBlKCl7Zm9yKHZhciB0PWFyZ3VtZW50cy5sZW5ndGgsbj1BcnJheSh0KSxvPTA7bzx0O28rKyluW29dPWFyZ3VtZW50c1tvXTtpZighKHRoaXMgaW5zdGFuY2VvZiBlKSlyZXR1cm4gbmV3KEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmFwcGx5KGUsW251bGxdLmNvbmNhdChuKSkpO09iamVjdC5nZXRQcm90b3R5cGVPZihlKS5hcHBseSh0aGlzLG4pfTtyZXR1cm4gdC5wcm90b3R5cGU9cihPYmplY3QuY3JlYXRlKGUucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6dH0pLCJmdW5jdGlvbiI9PXR5cGVvZiBPYmplY3Quc2V0UHJvdG90eXBlT2Y/T2JqZWN0LnNldFByb3RvdHlwZU9mKHQsZSk6dC5fX3Byb3RvX189ZSx0fXZhciBpZT17dGl0bGU6IiIsdGl0bGVUZXh0OiIiLHRleHQ6IiIsaHRtbDoiIixmb290ZXI6IiIsdHlwZTpudWxsLHRvYXN0OiExLGN1c3RvbUNsYXNzOiIiLHRhcmdldDoiYm9keSIsYmFja2Ryb3A6ITAsYW5pbWF0aW9uOiEwLGhlaWdodEF1dG86ITAsYWxsb3dPdXRzaWRlQ2xpY2s6ITAsYWxsb3dFc2NhcGVLZXk6ITAsYWxsb3dFbnRlcktleTohMCxzdG9wS2V5ZG93blByb3BhZ2F0aW9uOiEwLGtleWRvd25MaXN0ZW5lckNhcHR1cmU6ITEsc2hvd0NvbmZpcm1CdXR0b246ITAsc2hvd0NhbmNlbEJ1dHRvbjohMSxwcmVDb25maXJtOm51bGwsY29uZmlybUJ1dHRvblRleHQ6Ik9LIixjb25maXJtQnV0dG9uQXJpYUxhYmVsOiIiLGNvbmZpcm1CdXR0b25Db2xvcjpudWxsLGNvbmZpcm1CdXR0b25DbGFzczpudWxsLGNhbmNlbEJ1dHRvblRleHQ6IkNhbmNlbCIsY2FuY2VsQnV0dG9uQXJpYUxhYmVsOiIiLGNhbmNlbEJ1dHRvbkNvbG9yOm51bGwsY2FuY2VsQnV0dG9uQ2xhc3M6bnVsbCxidXR0b25zU3R5bGluZzohMCxyZXZlcnNlQnV0dG9uczohMSxmb2N1c0NvbmZpcm06ITAsZm9jdXNDYW5jZWw6ITEsc2hvd0Nsb3NlQnV0dG9uOiExLGNsb3NlQnV0dG9uQXJpYUxhYmVsOiJDbG9zZSB0aGlzIGRpYWxvZyIsc2hvd0xvYWRlck9uQ29uZmlybTohMSxpbWFnZVVybDpudWxsLGltYWdlV2lkdGg6bnVsbCxpbWFnZUhlaWdodDpudWxsLGltYWdlQWx0OiIiLGltYWdlQ2xhc3M6bnVsbCx0aW1lcjpudWxsLHdpZHRoOm51bGwscGFkZGluZzpudWxsLGJhY2tncm91bmQ6bnVsbCxpbnB1dDpudWxsLGlucHV0UGxhY2Vob2xkZXI6IiIsaW5wdXRWYWx1ZToiIixpbnB1dE9wdGlvbnM6e30saW5wdXRBdXRvVHJpbTohMCxpbnB1dENsYXNzOm51bGwsaW5wdXRBdHRyaWJ1dGVzOnt9LGlucHV0VmFsaWRhdG9yOm51bGwsZ3JvdzohMSxwb3NpdGlvbjoiY2VudGVyIixwcm9ncmVzc1N0ZXBzOltdLGN1cnJlbnRQcm9ncmVzc1N0ZXA6bnVsbCxwcm9ncmVzc1N0ZXBzRGlzdGFuY2U6bnVsbCxvbkJlZm9yZU9wZW46bnVsbCxvbkFmdGVyQ2xvc2U6bnVsbCxvbk9wZW46bnVsbCxvbkNsb3NlOm51bGwsdXNlUmVqZWN0aW9uczohMSxleHBlY3RSZWplY3Rpb25zOiExfSxfPVsidXNlUmVqZWN0aW9ucyIsImV4cGVjdFJlamVjdGlvbnMiXSxWPWZ1bmN0aW9uKGUpe3JldHVybiBpZS5oYXNPd25Qcm9wZXJ0eShlKXx8ImV4dHJhUGFyYW1zIj09PWV9LGFlPWZ1bmN0aW9uKGUpe3JldHVybi0xIT09Xy5pbmRleE9mKGUpfSxzZT1mdW5jdGlvbihlKXtmb3IodmFyIHQgaW4gZSlWKHQpfHx4KCdVbmtub3duIHBhcmFtZXRlciAiJyt0KyciJyksYWUodCkmJmwoJ1RoZSBwYXJhbWV0ZXIgIicrdCsnIiBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgaW4gdGhlIG5leHQgbWFqb3IgcmVsZWFzZS4nKX0sdWU9JyJzZXREZWZhdWx0cyIgJiAicmVzZXREZWZhdWx0cyIgbWV0aG9kcyBhcmUgZGVwcmVjYXRlZCBpbiBmYXZvciBvZiAibWl4aW4iIG1ldGhvZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIHRoZSBuZXh0IG1ham9yIHJlbGVhc2UuIEZvciBuZXcgcHJvamVjdHMsIHVzZSAibWl4aW4iLiBGb3IgcGFzdCBwcm9qZWN0cyBhbHJlYWR5IHVzaW5nICJzZXREZWZhdWx0cyIsIHN1cHBvcnQgd2lsbCBiZSBwcm92aWRlZCB0aHJvdWdoIGFuIGFkZGl0aW9uYWwgcGFja2FnZS4nLGNlPXt9O3ZhciBsZT1bXSxkZT1mdW5jdGlvbigpe3ZhciBlPUUoKTtlfHxBZSgiIiksZT1FKCk7dmFyIHQ9SigpLG49WSgpLG89JCgpO1UodCksVShuKSxXKFtlLHRdLEQubG9hZGluZyksbi5kaXNhYmxlZD0hMCxvLmRpc2FibGVkPSEwLGUuc2V0QXR0cmlidXRlKCJkYXRhLWxvYWRpbmciLCEwKSxlLnNldEF0dHJpYnV0ZSgiYXJpYS1idXN5IiwhMCksZS5mb2N1cygpfSxwZT1PYmplY3QuZnJlZXplKHtpc1ZhbGlkUGFyYW1ldGVyOlYsaXNEZXByZWNhdGVkUGFyYW1ldGVyOmFlLGFyZ3NUb1BhcmFtczpmdW5jdGlvbihuKXt2YXIgbz17fTtzd2l0Y2gocShuWzBdKSl7Y2FzZSJzdHJpbmciOlsidGl0bGUiLCJodG1sIiwidHlwZSJdLmZvckVhY2goZnVuY3Rpb24oZSx0KXtzd2l0Y2gocShuW3RdKSl7Y2FzZSJzdHJpbmciOm9bZV09blt0XTticmVhaztjYXNlInVuZGVmaW5lZCI6YnJlYWs7ZGVmYXVsdDpJKCJVbmV4cGVjdGVkIHR5cGUgb2YgIitlKychIEV4cGVjdGVkICJzdHJpbmciLCBnb3QgJytxKG5bdF0pKX19KTticmVhaztjYXNlIm9iamVjdCI6cihvLG5bMF0pO2JyZWFrO2RlZmF1bHQ6cmV0dXJuIEkoJ1VuZXhwZWN0ZWQgdHlwZSBvZiBhcmd1bWVudCEgRXhwZWN0ZWQgInN0cmluZyIgb3IgIm9iamVjdCIsIGdvdCAnK3EoblswXSkpLCExfXJldHVybiBvfSxhZGFwdElucHV0VmFsaWRhdG9yOmZ1bmN0aW9uKG4pe3JldHVybiBmdW5jdGlvbihlLHQpe3JldHVybiBuLmNhbGwodGhpcyxlLHQpLnRoZW4oZnVuY3Rpb24oKXt9LGZ1bmN0aW9uKGUpe3JldHVybiBlfSl9fSxjbG9zZTpULGNsb3NlUG9wdXA6VCxjbG9zZU1vZGFsOlQsY2xvc2VUb2FzdDpULGlzVmlzaWJsZTpmdW5jdGlvbigpe3JldHVybiEhRSgpfSxjbGlja0NvbmZpcm06ZnVuY3Rpb24oKXtyZXR1cm4gWSgpLmNsaWNrKCl9LGNsaWNrQ2FuY2VsOmZ1bmN0aW9uKCl7cmV0dXJuICQoKS5jbGljaygpfSxnZXRQb3B1cDpFLGdldFRpdGxlOkwsZ2V0Q29udGVudDpaLGdldEltYWdlOlEsZ2V0SWNvbnM6TyxnZXRDbG9zZUJ1dHRvbjpHLGdldEJ1dHRvbnNXcmFwcGVyOmZ1bmN0aW9uKCl7cmV0dXJuIGwoInN3YWwuZ2V0QnV0dG9uc1dyYXBwZXIoKSBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgaW4gdGhlIG5leHQgbWFqb3IgcmVsZWFzZSwgdXNlIHN3YWwuZ2V0QWN0aW9ucygpIGluc3RlYWQiKSxoKEQuYWN0aW9ucyl9LGdldEFjdGlvbnM6SixnZXRDb25maXJtQnV0dG9uOlksZ2V0Q2FuY2VsQnV0dG9uOiQsZ2V0Rm9vdGVyOlgsZ2V0Rm9jdXNhYmxlRWxlbWVudHM6ZWUsaXNMb2FkaW5nOmZ1bmN0aW9uKCl7cmV0dXJuIEUoKS5oYXNBdHRyaWJ1dGUoImRhdGEtbG9hZGluZyIpfSxmaXJlOmZ1bmN0aW9uKCl7Zm9yKHZhciBlPWFyZ3VtZW50cy5sZW5ndGgsdD1BcnJheShlKSxuPTA7bjxlO24rKyl0W25dPWFyZ3VtZW50c1tuXTtyZXR1cm4gbmV3KEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmFwcGx5KHRoaXMsW251bGxdLmNvbmNhdCh0KSkpfSxtaXhpbjpmdW5jdGlvbihuKXtyZXR1cm4gaihmdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7cmV0dXJuIHModGhpcyx0KSx1KHRoaXMsKHQuX19wcm90b19ffHxPYmplY3QuZ2V0UHJvdG90eXBlT2YodCkpLmFwcGx5KHRoaXMsYXJndW1lbnRzKSl9cmV0dXJuIGEodCxlKSxvKHQsW3trZXk6Il9tYWluIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gaSh0LnByb3RvdHlwZS5fX3Byb3RvX198fE9iamVjdC5nZXRQcm90b3R5cGVPZih0LnByb3RvdHlwZSksIl9tYWluIix0aGlzKS5jYWxsKHRoaXMscih7fSxuLGUpKX19XSksdH0odGhpcykpfSxxdWV1ZTpmdW5jdGlvbihlKXt2YXIgaT10aGlzO2xlPWU7dmFyIGE9ZnVuY3Rpb24oKXtsZT1bXSxkb2N1bWVudC5ib2R5LnJlbW92ZUF0dHJpYnV0ZSgiZGF0YS1zd2FsMi1xdWV1ZS1zdGVwIil9LHM9W107cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHIpeyFmdW5jdGlvbiB0KG4sbyl7bjxsZS5sZW5ndGg/KGRvY3VtZW50LmJvZHkuc2V0QXR0cmlidXRlKCJkYXRhLXN3YWwyLXF1ZXVlLXN0ZXAiLG4pLGkobGVbbl0pLnRoZW4oZnVuY3Rpb24oZSl7dm9pZCAwIT09ZS52YWx1ZT8ocy5wdXNoKGUudmFsdWUpLHQobisxLG8pKTooYSgpLHIoe2Rpc21pc3M6ZS5kaXNtaXNzfSkpfSkpOihhKCkscih7dmFsdWU6c30pKX0oMCl9KX0sZ2V0UXVldWVTdGVwOmZ1bmN0aW9uKCl7cmV0dXJuIGRvY3VtZW50LmJvZHkuZ2V0QXR0cmlidXRlKCJkYXRhLXN3YWwyLXF1ZXVlLXN0ZXAiKX0saW5zZXJ0UXVldWVTdGVwOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQmJnQ8bGUubGVuZ3RoP2xlLnNwbGljZSh0LDAsZSk6bGUucHVzaChlKX0sZGVsZXRlUXVldWVTdGVwOmZ1bmN0aW9uKGUpe3ZvaWQgMCE9PWxlW2VdJiZsZS5zcGxpY2UoZSwxKX0sc2hvd0xvYWRpbmc6ZGUsZW5hYmxlTG9hZGluZzpkZSxnZXRUaW1lckxlZnQ6ZnVuY3Rpb24oKXtyZXR1cm4gcmUudGltZW91dCYmcmUudGltZW91dC5nZXRUaW1lckxlZnQoKX19KSxmZT0iZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sP1N5bWJvbDpmdW5jdGlvbigpe3ZhciB0PTA7ZnVuY3Rpb24gZShlKXtyZXR1cm4iX18iK2UrIl8iK01hdGguZmxvb3IoMWU5Kk1hdGgucmFuZG9tKCkpKyJfIisgKyt0KyJfXyJ9cmV0dXJuIGUuaXRlcmF0b3I9ZSgiU3ltYm9sLml0ZXJhdG9yIiksZX0oKSxtZT0iZnVuY3Rpb24iPT10eXBlb2YgV2Vha01hcD9XZWFrTWFwOmZ1bmN0aW9uKG4sbyx0KXtmdW5jdGlvbiBlKCl7byh0aGlzLG4se3ZhbHVlOmZlKCJXZWFrTWFwIil9KX1yZXR1cm4gZS5wcm90b3R5cGU9e2RlbGV0ZTpmdW5jdGlvbihlKXtkZWxldGUgZVt0aGlzW25dXX0sZ2V0OmZ1bmN0aW9uKGUpe3JldHVybiBlW3RoaXNbbl1dfSxoYXM6ZnVuY3Rpb24oZSl7cmV0dXJuIHQuY2FsbChlLHRoaXNbbl0pfSxzZXQ6ZnVuY3Rpb24oZSx0KXtvKGUsdGhpc1tuXSx7Y29uZmlndXJhYmxlOiEwLHZhbHVlOnR9KX19LGV9KGZlKCJXZWFrTWFwIiksT2JqZWN0LmRlZmluZVByb3BlcnR5LHt9Lmhhc093blByb3BlcnR5KSxoZT17cHJvbWlzZTpuZXcgbWUsaW5uZXJQYXJhbXM6bmV3IG1lLGRvbUNhY2hlOm5ldyBtZX07ZnVuY3Rpb24gZ2UoKXt2YXIgZT1oZS5pbm5lclBhcmFtcy5nZXQodGhpcyksdD1oZS5kb21DYWNoZS5nZXQodGhpcyk7ZS5zaG93Q29uZmlybUJ1dHRvbnx8KEYodC5jb25maXJtQnV0dG9uKSxlLnNob3dDYW5jZWxCdXR0b258fEYodC5hY3Rpb25zKSksQShbdC5wb3B1cCx0LmFjdGlvbnNdLEQubG9hZGluZyksdC5wb3B1cC5yZW1vdmVBdHRyaWJ1dGUoImFyaWEtYnVzeSIpLHQucG9wdXAucmVtb3ZlQXR0cmlidXRlKCJkYXRhLWxvYWRpbmciKSx0LmNvbmZpcm1CdXR0b24uZGlzYWJsZWQ9ITEsdC5jYW5jZWxCdXR0b24uZGlzYWJsZWQ9ITF9dmFyIHZlPWZ1bmN0aW9uIGUodCxuKXtzKHRoaXMsZSk7dmFyIG89dm9pZCAwLHI9dm9pZCAwLGk9dm9pZCAwLGE9bjt0aGlzLnN0YXJ0PWZ1bmN0aW9uKCl7aT0hMCxyPW5ldyBEYXRlLG89c2V0VGltZW91dCh0LGEpfSx0aGlzLnN0b3A9ZnVuY3Rpb24oKXtpPSExLGNsZWFyVGltZW91dChvKSxhLT1uZXcgRGF0ZS1yfSx0aGlzLmdldFRpbWVyTGVmdD1mdW5jdGlvbigpe3JldHVybiBpJiYodGhpcy5zdG9wKCksdGhpcy5zdGFydCgpKSxhfSx0aGlzLmdldFN0YXRlUnVubmluZz1mdW5jdGlvbigpe3JldHVybiBpfSx0aGlzLnN0YXJ0KCl9LHllPXtlbWFpbDpmdW5jdGlvbihlLHQpe3JldHVybi9eW2EtekEtWjAtOS4rXy1dK0BbYS16QS1aMC05Li1dK1wuW2EtekEtWjAtOS1dezIsMjR9JC8udGVzdChlKT9Qcm9taXNlLnJlc29sdmUoKTpQcm9taXNlLnJlamVjdCh0JiZ0LnZhbGlkYXRpb25NZXNzYWdlP3QudmFsaWRhdGlvbk1lc3NhZ2U6IkludmFsaWQgZW1haWwgYWRkcmVzcyIpfSx1cmw6ZnVuY3Rpb24oZSx0KXtyZXR1cm4vXmh0dHBzPzpcL1wvKHd3d1wuKT9bLWEtekEtWjAtOUA6JS5fK34jPV17MiwyNTZ9XC5bYS16XXsyLDZ9XGIoWy1hLXpBLVowLTlAOiVfKy5+Iz8mLy89XSopJC8udGVzdChlKT9Qcm9taXNlLnJlc29sdmUoKTpQcm9taXNlLnJlamVjdCh0JiZ0LnZhbGlkYXRpb25NZXNzYWdlP3QudmFsaWRhdGlvbk1lc3NhZ2U6IkludmFsaWQgVVJMIil9fTt2YXIgYmU9ZnVuY3Rpb24oZSl7dmFyIHQ9UCgpLG49RSgpO251bGwhPT1lLm9uQmVmb3JlT3BlbiYmImZ1bmN0aW9uIj09dHlwZW9mIGUub25CZWZvcmVPcGVuJiZlLm9uQmVmb3JlT3BlbihuKSxlLmFuaW1hdGlvbj8oVyhuLEQuc2hvdyksVyh0LEQuZmFkZSksQShuLEQuaGlkZSkpOkEobixELmZhZGUpLFUobiksdC5zdHlsZS5vdmVyZmxvd1k9ImhpZGRlbiIsQyYmIWYobixELm5vYW5pbWF0aW9uKT9uLmFkZEV2ZW50TGlzdGVuZXIoQyxmdW5jdGlvbiBlKCl7bi5yZW1vdmVFdmVudExpc3RlbmVyKEMsZSksdC5zdHlsZS5vdmVyZmxvd1k9ImF1dG8ifSk6dC5zdHlsZS5vdmVyZmxvd1k9ImF1dG8iLFcoW2RvY3VtZW50LmRvY3VtZW50RWxlbWVudCxkb2N1bWVudC5ib2R5LHRdLEQuc2hvd24pLGUuaGVpZ2h0QXV0byYmZS5iYWNrZHJvcCYmIWUudG9hc3QmJlcoW2RvY3VtZW50LmRvY3VtZW50RWxlbWVudCxkb2N1bWVudC5ib2R5XSxEWyJoZWlnaHQtYXV0byJdKSx2KCkmJihrKCksZnVuY3Rpb24oKXtpZigvaVBhZHxpUGhvbmV8aVBvZC8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSYmIXdpbmRvdy5NU1N0cmVhbSYmIWYoZG9jdW1lbnQuYm9keSxELmlvc2ZpeCkpe3ZhciBlPWRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wO2RvY3VtZW50LmJvZHkuc3R5bGUudG9wPS0xKmUrInB4IixXKGRvY3VtZW50LmJvZHksRC5pb3NmaXgpfX0oKSkseSgpfHxyZS5wcmV2aW91c0FjdGl2ZUVsZW1lbnR8fChyZS5wcmV2aW91c0FjdGl2ZUVsZW1lbnQ9ZG9jdW1lbnQuYWN0aXZlRWxlbWVudCksbnVsbCE9PWUub25PcGVuJiYiZnVuY3Rpb24iPT10eXBlb2YgZS5vbk9wZW4mJnNldFRpbWVvdXQoZnVuY3Rpb24oKXtlLm9uT3BlbihuKX0pfTt2YXIgd2U9T2JqZWN0LmZyZWV6ZSh7aGlkZUxvYWRpbmc6Z2UsZGlzYWJsZUxvYWRpbmc6Z2UsZ2V0SW5wdXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9aGUuaW5uZXJQYXJhbXMuZ2V0KHRoaXMpLG49aGUuZG9tQ2FjaGUuZ2V0KHRoaXMpO2lmKCEoZT1lfHx0LmlucHV0KSlyZXR1cm4gbnVsbDtzd2l0Y2goZSl7Y2FzZSJzZWxlY3QiOmNhc2UidGV4dGFyZWEiOmNhc2UiZmlsZSI6cmV0dXJuIHoobi5jb250ZW50LERbZV0pO2Nhc2UiY2hlY2tib3giOnJldHVybiBuLnBvcHVwLnF1ZXJ5U2VsZWN0b3IoIi4iK0QuY2hlY2tib3grIiBpbnB1dCIpO2Nhc2UicmFkaW8iOnJldHVybiBuLnBvcHVwLnF1ZXJ5U2VsZWN0b3IoIi4iK0QucmFkaW8rIiBpbnB1dDpjaGVja2VkIil8fG4ucG9wdXAucXVlcnlTZWxlY3RvcigiLiIrRC5yYWRpbysiIGlucHV0OmZpcnN0LWNoaWxkIik7Y2FzZSJyYW5nZSI6cmV0dXJuIG4ucG9wdXAucXVlcnlTZWxlY3RvcigiLiIrRC5yYW5nZSsiIGlucHV0Iik7ZGVmYXVsdDpyZXR1cm4geihuLmNvbnRlbnQsRC5pbnB1dCl9fSxlbmFibGVCdXR0b25zOmZ1bmN0aW9uKCl7dmFyIGU9aGUuZG9tQ2FjaGUuZ2V0KHRoaXMpO2UuY29uZmlybUJ1dHRvbi5kaXNhYmxlZD0hMSxlLmNhbmNlbEJ1dHRvbi5kaXNhYmxlZD0hMX0sZGlzYWJsZUJ1dHRvbnM6ZnVuY3Rpb24oKXt2YXIgZT1oZS5kb21DYWNoZS5nZXQodGhpcyk7ZS5jb25maXJtQnV0dG9uLmRpc2FibGVkPSEwLGUuY2FuY2VsQnV0dG9uLmRpc2FibGVkPSEwfSxlbmFibGVDb25maXJtQnV0dG9uOmZ1bmN0aW9uKCl7aGUuZG9tQ2FjaGUuZ2V0KHRoaXMpLmNvbmZpcm1CdXR0b24uZGlzYWJsZWQ9ITF9LGRpc2FibGVDb25maXJtQnV0dG9uOmZ1bmN0aW9uKCl7aGUuZG9tQ2FjaGUuZ2V0KHRoaXMpLmNvbmZpcm1CdXR0b24uZGlzYWJsZWQ9ITB9LGVuYWJsZUlucHV0OmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5nZXRJbnB1dCgpO2lmKCFlKXJldHVybiExO2lmKCJyYWRpbyI9PT1lLnR5cGUpZm9yKHZhciB0PWUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3JBbGwoImlucHV0Iiksbj0wO248dC5sZW5ndGg7bisrKXRbbl0uZGlzYWJsZWQ9ITE7ZWxzZSBlLmRpc2FibGVkPSExfSxkaXNhYmxlSW5wdXQ6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmdldElucHV0KCk7aWYoIWUpcmV0dXJuITE7aWYoZSYmInJhZGlvIj09PWUudHlwZSlmb3IodmFyIHQ9ZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvckFsbCgiaW5wdXQiKSxuPTA7bjx0Lmxlbmd0aDtuKyspdFtuXS5kaXNhYmxlZD0hMDtlbHNlIGUuZGlzYWJsZWQ9ITB9LHNob3dWYWxpZGF0aW9uRXJyb3I6ZnVuY3Rpb24oZSl7dmFyIHQ9aGUuZG9tQ2FjaGUuZ2V0KHRoaXMpO3QudmFsaWRhdGlvbkVycm9yLmlubmVySFRNTD1lO3ZhciBuPXdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHQucG9wdXApO3QudmFsaWRhdGlvbkVycm9yLnN0eWxlLm1hcmdpbkxlZnQ9Ii0iK24uZ2V0UHJvcGVydHlWYWx1ZSgicGFkZGluZy1sZWZ0IiksdC52YWxpZGF0aW9uRXJyb3Iuc3R5bGUubWFyZ2luUmlnaHQ9Ii0iK24uZ2V0UHJvcGVydHlWYWx1ZSgicGFkZGluZy1yaWdodCIpLFUodC52YWxpZGF0aW9uRXJyb3IpO3ZhciBvPXRoaXMuZ2V0SW5wdXQoKTtvJiYoby5zZXRBdHRyaWJ1dGUoImFyaWEtaW52YWxpZCIsITApLG8uc2V0QXR0cmlidXRlKCJhcmlhLWRlc2NyaWJlZEJ5IixELnZhbGlkYXRpb25lcnJvciksTihvKSxXKG8sRC5pbnB1dGVycm9yKSl9LHJlc2V0VmFsaWRhdGlvbkVycm9yOmZ1bmN0aW9uKCl7dmFyIGU9aGUuZG9tQ2FjaGUuZ2V0KHRoaXMpO2UudmFsaWRhdGlvbkVycm9yJiZGKGUudmFsaWRhdGlvbkVycm9yKTt2YXIgdD10aGlzLmdldElucHV0KCk7dCYmKHQucmVtb3ZlQXR0cmlidXRlKCJhcmlhLWludmFsaWQiKSx0LnJlbW92ZUF0dHJpYnV0ZSgiYXJpYS1kZXNjcmliZWRCeSIpLEEodCxELmlucHV0ZXJyb3IpKX0sZ2V0UHJvZ3Jlc3NTdGVwczpmdW5jdGlvbigpe3JldHVybiBoZS5pbm5lclBhcmFtcy5nZXQodGhpcykucHJvZ3Jlc3NTdGVwc30sc2V0UHJvZ3Jlc3NTdGVwczpmdW5jdGlvbihlKXt2YXIgdD1oZS5pbm5lclBhcmFtcy5nZXQodGhpcyksbj1yKHt9LHQse3Byb2dyZXNzU3RlcHM6ZX0pO2hlLmlubmVyUGFyYW1zLnNldCh0aGlzLG4pLG9lKG4pfSxzaG93UHJvZ3Jlc3NTdGVwczpmdW5jdGlvbigpe3ZhciBlPWhlLmRvbUNhY2hlLmdldCh0aGlzKTtVKGUucHJvZ3Jlc3NTdGVwcyl9LGhpZGVQcm9ncmVzc1N0ZXBzOmZ1bmN0aW9uKCl7dmFyIGU9aGUuZG9tQ2FjaGUuZ2V0KHRoaXMpO0YoZS5wcm9ncmVzc1N0ZXBzKX0sX21haW46ZnVuY3Rpb24oZSl7dmFyIFQ9dGhpcztzZShlKTt2YXIgaj1yKHt9LGllLGUpOyFmdW5jdGlvbih0KXt0LmlucHV0VmFsaWRhdG9yfHxPYmplY3Qua2V5cyh5ZSkuZm9yRWFjaChmdW5jdGlvbihlKXt0LmlucHV0PT09ZSYmKHQuaW5wdXRWYWxpZGF0b3I9dC5leHBlY3RSZWplY3Rpb25zP3llW2VdOkFlLmFkYXB0SW5wdXRWYWxpZGF0b3IoeWVbZV0pKX0pLCghdC50YXJnZXR8fCJzdHJpbmciPT10eXBlb2YgdC50YXJnZXQmJiFkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHQudGFyZ2V0KXx8InN0cmluZyIhPXR5cGVvZiB0LnRhcmdldCYmIXQudGFyZ2V0LmFwcGVuZENoaWxkKSYmKHgoJ1RhcmdldCBwYXJhbWV0ZXIgaXMgbm90IHZhbGlkLCBkZWZhdWx0aW5nIHRvICJib2R5IicpLHQudGFyZ2V0PSJib2R5Iik7dmFyIGU9dm9pZCAwLG49RSgpLG89InN0cmluZyI9PXR5cGVvZiB0LnRhcmdldD9kb2N1bWVudC5xdWVyeVNlbGVjdG9yKHQudGFyZ2V0KTp0LnRhcmdldDtlPW4mJm8mJm4ucGFyZW50Tm9kZSE9PW8ucGFyZW50Tm9kZT90ZSh0KTpufHx0ZSh0KSx0LndpZHRoJiYoZS5zdHlsZS53aWR0aD0ibnVtYmVyIj09dHlwZW9mIHQud2lkdGg/dC53aWR0aCsicHgiOnQud2lkdGgpLHQucGFkZGluZyYmKGUuc3R5bGUucGFkZGluZz0ibnVtYmVyIj09dHlwZW9mIHQucGFkZGluZz90LnBhZGRpbmcrInB4Ijp0LnBhZGRpbmcpLHQuYmFja2dyb3VuZCYmKGUuc3R5bGUuYmFja2dyb3VuZD10LmJhY2tncm91bmQpO2Zvcih2YXIgcj13aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlKS5nZXRQcm9wZXJ0eVZhbHVlKCJiYWNrZ3JvdW5kLWNvbG9yIiksaT1lLnF1ZXJ5U2VsZWN0b3JBbGwoIltjbGFzc149c3dhbDItc3VjY2Vzcy1jaXJjdWxhci1saW5lXSwgLnN3YWwyLXN1Y2Nlc3MtZml4IiksYT0wO2E8aS5sZW5ndGg7YSsrKWlbYV0uc3R5bGUuYmFja2dyb3VuZENvbG9yPXI7dmFyIHM9UCgpLHU9TCgpLGM9WigpLnF1ZXJ5U2VsZWN0b3IoIiMiK0QuY29udGVudCksbD1KKCksZD1ZKCkscD0kKCksZj1HKCksbT1YKCk7aWYodC50aXRsZVRleHQ/dS5pbm5lclRleHQ9dC50aXRsZVRleHQ6dC50aXRsZSYmKCJzdHJpbmciPT10eXBlb2YgdC50aXRsZSYmKHQudGl0bGU9dC50aXRsZS5zcGxpdCgiXG4iKS5qb2luKCI8YnIgLz4iKSksbmUodC50aXRsZSx1KSksInN0cmluZyI9PXR5cGVvZiB0LmJhY2tkcm9wP1AoKS5zdHlsZS5iYWNrZ3JvdW5kPXQuYmFja2Ryb3A6dC5iYWNrZHJvcHx8VyhbZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LGRvY3VtZW50LmJvZHldLERbIm5vLWJhY2tkcm9wIl0pLHQuaHRtbD9uZSh0Lmh0bWwsYyk6dC50ZXh0PyhjLnRleHRDb250ZW50PXQudGV4dCxVKGMpKTpGKGMpLHQucG9zaXRpb24gaW4gRD9XKHMsRFt0LnBvc2l0aW9uXSk6KHgoJ1RoZSAicG9zaXRpb24iIHBhcmFtZXRlciBpcyBub3QgdmFsaWQsIGRlZmF1bHRpbmcgdG8gImNlbnRlciInKSxXKHMsRC5jZW50ZXIpKSx0Lmdyb3cmJiJzdHJpbmciPT10eXBlb2YgdC5ncm93KXt2YXIgaD0iZ3Jvdy0iK3QuZ3JvdztoIGluIEQmJlcocyxEW2hdKX0iZnVuY3Rpb24iPT10eXBlb2YgdC5hbmltYXRpb24mJih0LmFuaW1hdGlvbj10LmFuaW1hdGlvbi5jYWxsKCkpLHQuc2hvd0Nsb3NlQnV0dG9uPyhmLnNldEF0dHJpYnV0ZSgiYXJpYS1sYWJlbCIsdC5jbG9zZUJ1dHRvbkFyaWFMYWJlbCksVShmKSk6RihmKSxlLmNsYXNzTmFtZT1ELnBvcHVwLHQudG9hc3Q/KFcoW2RvY3VtZW50LmRvY3VtZW50RWxlbWVudCxkb2N1bWVudC5ib2R5XSxEWyJ0b2FzdC1zaG93biJdKSxXKGUsRC50b2FzdCkpOlcoZSxELm1vZGFsKSx0LmN1c3RvbUNsYXNzJiZXKGUsdC5jdXN0b21DbGFzcyksb2UodCk7Zm9yKHZhciBnPU8oKSx2PTA7djxnLmxlbmd0aDt2KyspRihnW3ZdKTtpZih0LnR5cGUpe3ZhciB5PSExO2Zvcih2YXIgYiBpbiBCKWlmKHQudHlwZT09PWIpe3k9ITA7YnJlYWt9aWYoIXkpcmV0dXJuIEkoIlVua25vd24gYWxlcnQgdHlwZTogIit0LnR5cGUpO3ZhciB3PWUucXVlcnlTZWxlY3RvcigiLiIrRC5pY29uKyIuIitCW3QudHlwZV0pO1UodyksdC5hbmltYXRpb24mJlcodywic3dhbDItYW5pbWF0ZS0iK3QudHlwZSsiLWljb24iKX12YXIgQz1RKCk7aWYodC5pbWFnZVVybD8oQy5zZXRBdHRyaWJ1dGUoInNyYyIsdC5pbWFnZVVybCksQy5zZXRBdHRyaWJ1dGUoImFsdCIsdC5pbWFnZUFsdCksVShDKSx0LmltYWdlV2lkdGg/Qy5zZXRBdHRyaWJ1dGUoIndpZHRoIix0LmltYWdlV2lkdGgpOkMucmVtb3ZlQXR0cmlidXRlKCJ3aWR0aCIpLHQuaW1hZ2VIZWlnaHQ/Qy5zZXRBdHRyaWJ1dGUoImhlaWdodCIsdC5pbWFnZUhlaWdodCk6Qy5yZW1vdmVBdHRyaWJ1dGUoImhlaWdodCIpLEMuY2xhc3NOYW1lPUQuaW1hZ2UsdC5pbWFnZUNsYXNzJiZXKEMsdC5pbWFnZUNsYXNzKSk6RihDKSx0LnNob3dDYW5jZWxCdXR0b24/cC5zdHlsZS5kaXNwbGF5PSJpbmxpbmUtYmxvY2siOkYocCksdC5zaG93Q29uZmlybUJ1dHRvbj9TKGQsImRpc3BsYXkiKTpGKGQpLHQuc2hvd0NvbmZpcm1CdXR0b258fHQuc2hvd0NhbmNlbEJ1dHRvbj9VKGwpOkYobCksZC5pbm5lckhUTUw9dC5jb25maXJtQnV0dG9uVGV4dCxwLmlubmVySFRNTD10LmNhbmNlbEJ1dHRvblRleHQsZC5zZXRBdHRyaWJ1dGUoImFyaWEtbGFiZWwiLHQuY29uZmlybUJ1dHRvbkFyaWFMYWJlbCkscC5zZXRBdHRyaWJ1dGUoImFyaWEtbGFiZWwiLHQuY2FuY2VsQnV0dG9uQXJpYUxhYmVsKSxkLmNsYXNzTmFtZT1ELmNvbmZpcm0sVyhkLHQuY29uZmlybUJ1dHRvbkNsYXNzKSxwLmNsYXNzTmFtZT1ELmNhbmNlbCxXKHAsdC5jYW5jZWxCdXR0b25DbGFzcyksdC5idXR0b25zU3R5bGluZyl7VyhbZCxwXSxELnN0eWxlZCksdC5jb25maXJtQnV0dG9uQ29sb3ImJihkLnN0eWxlLmJhY2tncm91bmRDb2xvcj10LmNvbmZpcm1CdXR0b25Db2xvciksdC5jYW5jZWxCdXR0b25Db2xvciYmKHAuc3R5bGUuYmFja2dyb3VuZENvbG9yPXQuY2FuY2VsQnV0dG9uQ29sb3IpO3ZhciBrPXdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGQpLmdldFByb3BlcnR5VmFsdWUoImJhY2tncm91bmQtY29sb3IiKTtkLnN0eWxlLmJvcmRlckxlZnRDb2xvcj1rLGQuc3R5bGUuYm9yZGVyUmlnaHRDb2xvcj1rfWVsc2UgQShbZCxwXSxELnN0eWxlZCksZC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I9ZC5zdHlsZS5ib3JkZXJMZWZ0Q29sb3I9ZC5zdHlsZS5ib3JkZXJSaWdodENvbG9yPSIiLHAuc3R5bGUuYmFja2dyb3VuZENvbG9yPXAuc3R5bGUuYm9yZGVyTGVmdENvbG9yPXAuc3R5bGUuYm9yZGVyUmlnaHRDb2xvcj0iIjtuZSh0LmZvb3RlcixtKSwhMD09PXQuYW5pbWF0aW9uP0EoZSxELm5vYW5pbWF0aW9uKTpXKGUsRC5ub2FuaW1hdGlvbiksdC5zaG93TG9hZGVyT25Db25maXJtJiYhdC5wcmVDb25maXJtJiZ4KCJzaG93TG9hZGVyT25Db25maXJtIGlzIHNldCB0byB0cnVlLCBidXQgcHJlQ29uZmlybSBpcyBub3QgZGVmaW5lZC5cbnNob3dMb2FkZXJPbkNvbmZpcm0gc2hvdWxkIGJlIHVzZWQgdG9nZXRoZXIgd2l0aCBwcmVDb25maXJtLCBzZWUgdXNhZ2UgZXhhbXBsZTpcbmh0dHBzOi8vc3dlZXRhbGVydDIuZ2l0aHViLmlvLyNhamF4LXJlcXVlc3QiKX0oaiksT2JqZWN0LmZyZWV6ZShqKSxoZS5pbm5lclBhcmFtcy5zZXQodGhpcyxqKSxyZS50aW1lb3V0JiYocmUudGltZW91dC5zdG9wKCksZGVsZXRlIHJlLnRpbWVvdXQpLGNsZWFyVGltZW91dChyZS5yZXN0b3JlRm9jdXNUaW1lb3V0KTt2YXIgXz17cG9wdXA6RSgpLGNvbnRhaW5lcjpQKCksY29udGVudDpaKCksYWN0aW9uczpKKCksY29uZmlybUJ1dHRvbjpZKCksY2FuY2VsQnV0dG9uOiQoKSxjbG9zZUJ1dHRvbjpHKCksdmFsaWRhdGlvbkVycm9yOmgoRC52YWxpZGF0aW9uZXJyb3IpLHByb2dyZXNzU3RlcHM6ZygpfTtoZS5kb21DYWNoZS5zZXQodGhpcyxfKTt2YXIgVj10aGlzLmNvbnN0cnVjdG9yO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbih0LG4pe3ZhciBvPWZ1bmN0aW9uKGUpe1YuY2xvc2VQb3B1cChqLm9uQ2xvc2Usai5vbkFmdGVyQ2xvc2UpLGoudXNlUmVqZWN0aW9ucz90KGUpOnQoe3ZhbHVlOmV9KX0sYz1mdW5jdGlvbihlKXtWLmNsb3NlUG9wdXAoai5vbkNsb3NlLGoub25BZnRlckNsb3NlKSxqLnVzZVJlamVjdGlvbnM/bihlKTp0KHtkaXNtaXNzOmV9KX0sbD1mdW5jdGlvbihlKXtWLmNsb3NlUG9wdXAoai5vbkNsb3NlLGoub25BZnRlckNsb3NlKSxuKGUpfTtqLnRpbWVyJiYocmUudGltZW91dD1uZXcgdmUoZnVuY3Rpb24oKXtjKCJ0aW1lciIpLGRlbGV0ZSByZS50aW1lb3V0fSxqLnRpbWVyKSksai5pbnB1dCYmc2V0VGltZW91dChmdW5jdGlvbigpe3ZhciBlPVQuZ2V0SW5wdXQoKTtlJiZOKGUpfSwwKTtmb3IodmFyIGQ9ZnVuY3Rpb24odCl7aWYoai5zaG93TG9hZGVyT25Db25maXJtJiZWLnNob3dMb2FkaW5nKCksai5wcmVDb25maXJtKXtULnJlc2V0VmFsaWRhdGlvbkVycm9yKCk7dmFyIGU9UHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbigpe3JldHVybiBqLnByZUNvbmZpcm0odCxqLmV4dHJhUGFyYW1zKX0pO2ouZXhwZWN0UmVqZWN0aW9ucz9lLnRoZW4oZnVuY3Rpb24oZSl7cmV0dXJuIG8oZXx8dCl9LGZ1bmN0aW9uKGUpe1QuaGlkZUxvYWRpbmcoKSxlJiZULnNob3dWYWxpZGF0aW9uRXJyb3IoZSl9KTplLnRoZW4oZnVuY3Rpb24oZSl7SyhfLnZhbGlkYXRpb25FcnJvcil8fCExPT09ZT9ULmhpZGVMb2FkaW5nKCk6byhlfHx0KX0sZnVuY3Rpb24oZSl7cmV0dXJuIGwoZSl9KX1lbHNlIG8odCl9LGU9ZnVuY3Rpb24oZSl7dmFyIHQ9ZXx8d2luZG93LmV2ZW50LG49dC50YXJnZXR8fHQuc3JjRWxlbWVudCxvPV8uY29uZmlybUJ1dHRvbixyPV8uY2FuY2VsQnV0dG9uLGk9byYmKG89PT1ufHxvLmNvbnRhaW5zKG4pKSxhPXImJihyPT09bnx8ci5jb250YWlucyhuKSk7c3dpdGNoKHQudHlwZSl7Y2FzZSJjbGljayI6aWYoaSYmVi5pc1Zpc2libGUoKSlpZihULmRpc2FibGVCdXR0b25zKCksai5pbnB1dCl7dmFyIHM9ZnVuY3Rpb24oKXt2YXIgZT1ULmdldElucHV0KCk7aWYoIWUpcmV0dXJuIG51bGw7c3dpdGNoKGouaW5wdXQpe2Nhc2UiY2hlY2tib3giOnJldHVybiBlLmNoZWNrZWQ/MTowO2Nhc2UicmFkaW8iOnJldHVybiBlLmNoZWNrZWQ/ZS52YWx1ZTpudWxsO2Nhc2UiZmlsZSI6cmV0dXJuIGUuZmlsZXMubGVuZ3RoP2UuZmlsZXNbMF06bnVsbDtkZWZhdWx0OnJldHVybiBqLmlucHV0QXV0b1RyaW0/ZS52YWx1ZS50cmltKCk6ZS52YWx1ZX19KCk7aWYoai5pbnB1dFZhbGlkYXRvcil7VC5kaXNhYmxlSW5wdXQoKTt2YXIgdT1Qcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGouaW5wdXRWYWxpZGF0b3IocyxqLmV4dHJhUGFyYW1zKX0pO2ouZXhwZWN0UmVqZWN0aW9ucz91LnRoZW4oZnVuY3Rpb24oKXtULmVuYWJsZUJ1dHRvbnMoKSxULmVuYWJsZUlucHV0KCksZChzKX0sZnVuY3Rpb24oZSl7VC5lbmFibGVCdXR0b25zKCksVC5lbmFibGVJbnB1dCgpLGUmJlQuc2hvd1ZhbGlkYXRpb25FcnJvcihlKX0pOnUudGhlbihmdW5jdGlvbihlKXtULmVuYWJsZUJ1dHRvbnMoKSxULmVuYWJsZUlucHV0KCksZT9ULnNob3dWYWxpZGF0aW9uRXJyb3IoZSk6ZChzKX0sZnVuY3Rpb24oZSl7cmV0dXJuIGwoZSl9KX1lbHNlIGQocyl9ZWxzZSBkKCEwKTtlbHNlIGEmJlYuaXNWaXNpYmxlKCkmJihULmRpc2FibGVCdXR0b25zKCksYyhWLkRpc21pc3NSZWFzb24uY2FuY2VsKSl9fSxyPV8ucG9wdXAucXVlcnlTZWxlY3RvckFsbCgiYnV0dG9uIiksaT0wO2k8ci5sZW5ndGg7aSsrKXJbaV0ub25jbGljaz1lLHJbaV0ub25tb3VzZW92ZXI9ZSxyW2ldLm9ubW91c2VvdXQ9ZSxyW2ldLm9ubW91c2Vkb3duPWU7aWYoXy5jbG9zZUJ1dHRvbi5vbmNsaWNrPWZ1bmN0aW9uKCl7YyhWLkRpc21pc3NSZWFzb24uY2xvc2UpfSxqLnRvYXN0KV8ucG9wdXAub25jbGljaz1mdW5jdGlvbigpe2ouc2hvd0NvbmZpcm1CdXR0b258fGouc2hvd0NhbmNlbEJ1dHRvbnx8ai5zaG93Q2xvc2VCdXR0b258fGouaW5wdXR8fGMoVi5EaXNtaXNzUmVhc29uLmNsb3NlKX07ZWxzZXt2YXIgYT0hMTtfLnBvcHVwLm9ubW91c2Vkb3duPWZ1bmN0aW9uKCl7Xy5jb250YWluZXIub25tb3VzZXVwPWZ1bmN0aW9uKGUpe18uY29udGFpbmVyLm9ubW91c2V1cD12b2lkIDAsZS50YXJnZXQ9PT1fLmNvbnRhaW5lciYmKGE9ITApfX0sXy5jb250YWluZXIub25tb3VzZWRvd249ZnVuY3Rpb24oKXtfLnBvcHVwLm9ubW91c2V1cD1mdW5jdGlvbihlKXtfLnBvcHVwLm9ubW91c2V1cD12b2lkIDAsKGUudGFyZ2V0PT09Xy5wb3B1cHx8Xy5wb3B1cC5jb250YWlucyhlLnRhcmdldCkpJiYoYT0hMCl9fSxfLmNvbnRhaW5lci5vbmNsaWNrPWZ1bmN0aW9uKGUpe2E/YT0hMTplLnRhcmdldD09PV8uY29udGFpbmVyJiZIKGouYWxsb3dPdXRzaWRlQ2xpY2spJiZjKFYuRGlzbWlzc1JlYXNvbi5iYWNrZHJvcCl9fWoucmV2ZXJzZUJ1dHRvbnM/Xy5jb25maXJtQnV0dG9uLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKF8uY2FuY2VsQnV0dG9uLF8uY29uZmlybUJ1dHRvbik6Xy5jb25maXJtQnV0dG9uLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKF8uY29uZmlybUJ1dHRvbixfLmNhbmNlbEJ1dHRvbik7dmFyIHM9ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49ZWUoai5mb2N1c0NhbmNlbCksbz0wO288bi5sZW5ndGg7bysrKXJldHVybihlKz10KT09PW4ubGVuZ3RoP2U9MDotMT09PWUmJihlPW4ubGVuZ3RoLTEpLG5bZV0uZm9jdXMoKTtfLnBvcHVwLmZvY3VzKCl9O3JlLmtleWRvd25IYW5kbGVyQWRkZWQmJihyZS5rZXlkb3duVGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoImtleWRvd24iLHJlLmtleWRvd25IYW5kbGVyLHtjYXB0dXJlOnJlLmtleWRvd25MaXN0ZW5lckNhcHR1cmV9KSxyZS5rZXlkb3duSGFuZGxlckFkZGVkPSExKSxqLnRvYXN0fHwocmUua2V5ZG93bkhhbmRsZXI9ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKGUsdCl7aWYodC5zdG9wS2V5ZG93blByb3BhZ2F0aW9uJiZlLnN0b3BQcm9wYWdhdGlvbigpLCJFbnRlciIhPT1lLmtleXx8ZS5pc0NvbXBvc2luZylpZigiVGFiIj09PWUua2V5KXtmb3IodmFyIG49ZS50YXJnZXR8fGUuc3JjRWxlbWVudCxvPWVlKHQuZm9jdXNDYW5jZWwpLHI9LTEsaT0wO2k8by5sZW5ndGg7aSsrKWlmKG49PT1vW2ldKXtyPWk7YnJlYWt9ZS5zaGlmdEtleT9zKHIsLTEpOnMociwxKSxlLnN0b3BQcm9wYWdhdGlvbigpLGUucHJldmVudERlZmF1bHQoKX1lbHNlLTEhPT1bIkFycm93TGVmdCIsIkFycm93UmlnaHQiLCJBcnJvd1VwIiwiQXJyb3dEb3duIiwiTGVmdCIsIlJpZ2h0IiwiVXAiLCJEb3duIl0uaW5kZXhPZihlLmtleSk/ZG9jdW1lbnQuYWN0aXZlRWxlbWVudD09PV8uY29uZmlybUJ1dHRvbiYmSyhfLmNhbmNlbEJ1dHRvbik/Xy5jYW5jZWxCdXR0b24uZm9jdXMoKTpkb2N1bWVudC5hY3RpdmVFbGVtZW50PT09Xy5jYW5jZWxCdXR0b24mJksoXy5jb25maXJtQnV0dG9uKSYmXy5jb25maXJtQnV0dG9uLmZvY3VzKCk6IkVzY2FwZSIhPT1lLmtleSYmIkVzYyIhPT1lLmtleXx8ITAhPT1IKHQuYWxsb3dFc2NhcGVLZXkpfHxjKFYuRGlzbWlzc1JlYXNvbi5lc2MpO2Vsc2UgaWYoZS50YXJnZXQmJlQuZ2V0SW5wdXQoKSYmZS50YXJnZXQub3V0ZXJIVE1MPT09VC5nZXRJbnB1dCgpLm91dGVySFRNTCl7aWYoLTEhPT1bInRleHRhcmVhIiwiZmlsZSJdLmluZGV4T2YodC5pbnB1dCkpcmV0dXJuO1YuY2xpY2tDb25maXJtKCksZS5wcmV2ZW50RGVmYXVsdCgpfX0oZSxqKX0scmUua2V5ZG93blRhcmdldD1qLmtleWRvd25MaXN0ZW5lckNhcHR1cmU/d2luZG93Ol8ucG9wdXAscmUua2V5ZG93bkxpc3RlbmVyQ2FwdHVyZT1qLmtleWRvd25MaXN0ZW5lckNhcHR1cmUscmUua2V5ZG93blRhcmdldC5hZGRFdmVudExpc3RlbmVyKCJrZXlkb3duIixyZS5rZXlkb3duSGFuZGxlcix7Y2FwdHVyZTpyZS5rZXlkb3duTGlzdGVuZXJDYXB0dXJlfSkscmUua2V5ZG93bkhhbmRsZXJBZGRlZD0hMCksVC5lbmFibGVCdXR0b25zKCksVC5oaWRlTG9hZGluZygpLFQucmVzZXRWYWxpZGF0aW9uRXJyb3IoKSwoai5pbnB1dHx8ai5mb290ZXJ8fGouc2hvd0Nsb3NlQnV0dG9uKSYmVyhkb2N1bWVudC5ib2R5LERbInRvYXN0LWNvbHVtbiJdKTtmb3IodmFyIHU9WyJpbnB1dCIsImZpbGUiLCJyYW5nZSIsInNlbGVjdCIsInJhZGlvIiwiY2hlY2tib3giLCJ0ZXh0YXJlYSJdLHA9dm9pZCAwLGY9MDtmPHUubGVuZ3RoO2YrKyl7dmFyIG09RFt1W2ZdXSxoPXooXy5jb250ZW50LG0pO2lmKHA9VC5nZXRJbnB1dCh1W2ZdKSl7Zm9yKHZhciBnIGluIHAuYXR0cmlidXRlcylpZihwLmF0dHJpYnV0ZXMuaGFzT3duUHJvcGVydHkoZykpe3ZhciB2PXAuYXR0cmlidXRlc1tnXS5uYW1lOyJ0eXBlIiE9PXYmJiJ2YWx1ZSIhPT12JiZwLnJlbW92ZUF0dHJpYnV0ZSh2KX1mb3IodmFyIHkgaW4gai5pbnB1dEF0dHJpYnV0ZXMpcC5zZXRBdHRyaWJ1dGUoeSxqLmlucHV0QXR0cmlidXRlc1t5XSl9aC5jbGFzc05hbWU9bSxqLmlucHV0Q2xhc3MmJlcoaCxqLmlucHV0Q2xhc3MpLEYoaCl9dmFyIGI9dm9pZCAwO3N3aXRjaChqLmlucHV0KXtjYXNlInRleHQiOmNhc2UiZW1haWwiOmNhc2UicGFzc3dvcmQiOmNhc2UibnVtYmVyIjpjYXNlInRlbCI6Y2FzZSJ1cmwiOihwPXooXy5jb250ZW50LEQuaW5wdXQpKS52YWx1ZT1qLmlucHV0VmFsdWUscC5wbGFjZWhvbGRlcj1qLmlucHV0UGxhY2Vob2xkZXIscC50eXBlPWouaW5wdXQsVShwKTticmVhaztjYXNlImZpbGUiOihwPXooXy5jb250ZW50LEQuZmlsZSkpLnBsYWNlaG9sZGVyPWouaW5wdXRQbGFjZWhvbGRlcixwLnR5cGU9ai5pbnB1dCxVKHApO2JyZWFrO2Nhc2UicmFuZ2UiOnZhciB3PXooXy5jb250ZW50LEQucmFuZ2UpLEM9dy5xdWVyeVNlbGVjdG9yKCJpbnB1dCIpLGs9dy5xdWVyeVNlbGVjdG9yKCJvdXRwdXQiKTtDLnZhbHVlPWouaW5wdXRWYWx1ZSxDLnR5cGU9ai5pbnB1dCxrLnZhbHVlPWouaW5wdXRWYWx1ZSxVKHcpO2JyZWFrO2Nhc2Uic2VsZWN0Ijp2YXIgeD16KF8uY29udGVudCxELnNlbGVjdCk7aWYoeC5pbm5lckhUTUw9IiIsai5pbnB1dFBsYWNlaG9sZGVyKXt2YXIgQj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKTtCLmlubmVySFRNTD1qLmlucHV0UGxhY2Vob2xkZXIsQi52YWx1ZT0iIixCLmRpc2FibGVkPSEwLEIuc2VsZWN0ZWQ9ITAseC5hcHBlbmRDaGlsZChCKX1iPWZ1bmN0aW9uKGUpe2UuZm9yRWFjaChmdW5jdGlvbihlKXt2YXIgdD1NKGUsMiksbj10WzBdLG89dFsxXSxyPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpO3IudmFsdWU9bixyLmlubmVySFRNTD1vLGouaW5wdXRWYWx1ZS50b1N0cmluZygpPT09bi50b1N0cmluZygpJiYoci5zZWxlY3RlZD0hMCkseC5hcHBlbmRDaGlsZChyKX0pLFUoeCkseC5mb2N1cygpfTticmVhaztjYXNlInJhZGlvIjp2YXIgQT16KF8uY29udGVudCxELnJhZGlvKTtBLmlubmVySFRNTD0iIixiPWZ1bmN0aW9uKGUpe2UuZm9yRWFjaChmdW5jdGlvbihlKXt2YXIgdD1NKGUsMiksbj10WzBdLG89dFsxXSxyPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0IiksaT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJsYWJlbCIpO3IudHlwZT0icmFkaW8iLHIubmFtZT1ELnJhZGlvLHIudmFsdWU9bixqLmlucHV0VmFsdWUudG9TdHJpbmcoKT09PW4udG9TdHJpbmcoKSYmKHIuY2hlY2tlZD0hMCk7dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3BhbiIpO2EuaW5uZXJIVE1MPW8sYS5jbGFzc05hbWU9RC5sYWJlbCxpLmFwcGVuZENoaWxkKHIpLGkuYXBwZW5kQ2hpbGQoYSksQS5hcHBlbmRDaGlsZChpKX0pLFUoQSk7dmFyIHQ9QS5xdWVyeVNlbGVjdG9yQWxsKCJpbnB1dCIpO3QubGVuZ3RoJiZ0WzBdLmZvY3VzKCl9O2JyZWFrO2Nhc2UiY2hlY2tib3giOnZhciBTPXooXy5jb250ZW50LEQuY2hlY2tib3gpLFA9VC5nZXRJbnB1dCgiY2hlY2tib3giKTtQLnR5cGU9ImNoZWNrYm94IixQLnZhbHVlPTEsUC5pZD1ELmNoZWNrYm94LFAuY2hlY2tlZD1Cb29sZWFuKGouaW5wdXRWYWx1ZSk7dmFyIEU9Uy5nZXRFbGVtZW50c0J5VGFnTmFtZSgic3BhbiIpO0UubGVuZ3RoJiZTLnJlbW92ZUNoaWxkKEVbMF0pLChFPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNwYW4iKSkuY2xhc3NOYW1lPUQubGFiZWwsRS5pbm5lckhUTUw9ai5pbnB1dFBsYWNlaG9sZGVyLFMuYXBwZW5kQ2hpbGQoRSksVShTKTticmVhaztjYXNlInRleHRhcmVhIjp2YXIgTz16KF8uY29udGVudCxELnRleHRhcmVhKTtPLnZhbHVlPWouaW5wdXRWYWx1ZSxPLnBsYWNlaG9sZGVyPWouaW5wdXRQbGFjZWhvbGRlcixVKE8pO2JyZWFrO2Nhc2UgbnVsbDpicmVhaztkZWZhdWx0OkkoJ1VuZXhwZWN0ZWQgdHlwZSBvZiBpbnB1dCEgRXhwZWN0ZWQgInRleHQiLCAiZW1haWwiLCAicGFzc3dvcmQiLCAibnVtYmVyIiwgInRlbCIsICJzZWxlY3QiLCAicmFkaW8iLCAiY2hlY2tib3giLCAidGV4dGFyZWEiLCAiZmlsZSIgb3IgInVybCIsIGdvdCAiJytqLmlucHV0KyciJyl9aWYoInNlbGVjdCI9PT1qLmlucHV0fHwicmFkaW8iPT09ai5pbnB1dCl7dmFyIEw9ZnVuY3Rpb24oZSl7cmV0dXJuIGIoKHQ9ZSxuPVtdLCJ1bmRlZmluZWQiIT10eXBlb2YgTWFwJiZ0IGluc3RhbmNlb2YgTWFwP3QuZm9yRWFjaChmdW5jdGlvbihlLHQpe24ucHVzaChbdCxlXSl9KTpPYmplY3Qua2V5cyh0KS5mb3JFYWNoKGZ1bmN0aW9uKGUpe24ucHVzaChbZSx0W2VdXSl9KSxuKSk7dmFyIHQsbn07UihqLmlucHV0T3B0aW9ucyk/KFYuc2hvd0xvYWRpbmcoKSxqLmlucHV0T3B0aW9ucy50aGVuKGZ1bmN0aW9uKGUpe1QuaGlkZUxvYWRpbmcoKSxMKGUpfSkpOiJvYmplY3QiPT09cShqLmlucHV0T3B0aW9ucyk/TChqLmlucHV0T3B0aW9ucyk6SSgiVW5leHBlY3RlZCB0eXBlIG9mIGlucHV0T3B0aW9ucyEgRXhwZWN0ZWQgb2JqZWN0LCBNYXAgb3IgUHJvbWlzZSwgZ290ICIrcShqLmlucHV0T3B0aW9ucykpfWVsc2UtMSE9PVsidGV4dCIsImVtYWlsIiwibnVtYmVyIiwidGVsIiwidGV4dGFyZWEiXS5pbmRleE9mKGouaW5wdXQpJiZSKGouaW5wdXRWYWx1ZSkmJihWLnNob3dMb2FkaW5nKCksRihwKSxqLmlucHV0VmFsdWUudGhlbihmdW5jdGlvbihlKXtwLnZhbHVlPSJudW1iZXIiPT09ai5pbnB1dD9wYXJzZUZsb2F0KGUpfHwwOmUrIiIsVShwKSxwLmZvY3VzKCksVC5oaWRlTG9hZGluZygpfSkuY2F0Y2goZnVuY3Rpb24oZSl7SSgiRXJyb3IgaW4gaW5wdXRWYWx1ZSBwcm9taXNlOiAiK2UpLHAudmFsdWU9IiIsVShwKSxwLmZvY3VzKCksVC5oaWRlTG9hZGluZygpfSkpO2JlKGopLGoudG9hc3R8fChIKGouYWxsb3dFbnRlcktleSk/ai5mb2N1c0NhbmNlbCYmSyhfLmNhbmNlbEJ1dHRvbik/Xy5jYW5jZWxCdXR0b24uZm9jdXMoKTpqLmZvY3VzQ29uZmlybSYmSyhfLmNvbmZpcm1CdXR0b24pP18uY29uZmlybUJ1dHRvbi5mb2N1cygpOnMoLTEsMSk6ZG9jdW1lbnQuYWN0aXZlRWxlbWVudCYmZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ibHVyKCkpLF8uY29udGFpbmVyLnNjcm9sbFRvcD0wfSl9fSksQ2U9dm9pZCAwO2Z1bmN0aW9uIGtlKCl7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cpeyJ1bmRlZmluZWQiPT10eXBlb2YgUHJvbWlzZSYmSSgiVGhpcyBwYWNrYWdlIHJlcXVpcmVzIGEgUHJvbWlzZSBsaWJyYXJ5LCBwbGVhc2UgaW5jbHVkZSBhIHNoaW0gdG8gZW5hYmxlIGl0IGluIHRoaXMgYnJvd3NlciAoU2VlOiBodHRwczovL2dpdGh1Yi5jb20vc3dlZXRhbGVydDIvc3dlZXRhbGVydDIvd2lraS9NaWdyYXRpb24tZnJvbS1Td2VldEFsZXJ0LXRvLVN3ZWV0QWxlcnQyIzEtaWUtc3VwcG9ydCkiKTtmb3IodmFyIGU9YXJndW1lbnRzLmxlbmd0aCx0PUFycmF5KGUpLG49MDtuPGU7bisrKXRbbl09YXJndW1lbnRzW25dO2lmKHZvaWQgMD09PXRbMF0pcmV0dXJuIEkoIkF0IGxlYXN0IDEgYXJndW1lbnQgaXMgZXhwZWN0ZWQhIiksITE7Q2U9dGhpczt2YXIgbz1PYmplY3QuZnJlZXplKHRoaXMuY29uc3RydWN0b3IuYXJnc1RvUGFyYW1zKHQpKTtPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0aGlzLHtwYXJhbXM6e3ZhbHVlOm8sd3JpdGFibGU6ITEsZW51bWVyYWJsZTohMH19KTt2YXIgcj10aGlzLl9tYWluKHRoaXMucGFyYW1zKTtoZS5wcm9taXNlLnNldCh0aGlzLHIpfX1rZS5wcm90b3R5cGUudGhlbj1mdW5jdGlvbihlLHQpe3JldHVybiBoZS5wcm9taXNlLmdldCh0aGlzKS50aGVuKGUsdCl9LGtlLnByb3RvdHlwZS5jYXRjaD1mdW5jdGlvbihlKXtyZXR1cm4gaGUucHJvbWlzZS5nZXQodGhpcykuY2F0Y2goZSl9LGtlLnByb3RvdHlwZS5maW5hbGx5PWZ1bmN0aW9uKGUpe3JldHVybiBoZS5wcm9taXNlLmdldCh0aGlzKS5maW5hbGx5KGUpfSxyKGtlLnByb3RvdHlwZSx3ZSkscihrZSxwZSksT2JqZWN0LmtleXMod2UpLmZvckVhY2goZnVuY3Rpb24odCl7a2VbdF09ZnVuY3Rpb24oKXt2YXIgZTtpZihDZSlyZXR1cm4oZT1DZSlbdF0uYXBwbHkoZSxhcmd1bWVudHMpfX0pLGtlLkRpc21pc3NSZWFzb249ZSxrZS5ub29wPWZ1bmN0aW9uKCl7fSxrZS52ZXJzaW9uPSI3LjI2LjAiO3ZhciB4ZSxCZSxBZT1qKCh4ZT1rZSxCZT1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7cmV0dXJuIHModGhpcyx0KSx1KHRoaXMsKHQuX19wcm90b19ffHxPYmplY3QuZ2V0UHJvdG90eXBlT2YodCkpLmFwcGx5KHRoaXMsYXJndW1lbnRzKSl9cmV0dXJuIGEodCx4ZSksbyh0LFt7a2V5OiJfbWFpbiIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGkodC5wcm90b3R5cGUuX19wcm90b19ffHxPYmplY3QuZ2V0UHJvdG90eXBlT2YodC5wcm90b3R5cGUpLCJfbWFpbiIsdGhpcykuY2FsbCh0aGlzLHIoe30sY2UsZSkpfX1dLFt7a2V5OiJzZXREZWZhdWx0cyIsdmFsdWU6ZnVuY3Rpb24odCl7aWYobCh1ZSksIXR8fCJvYmplY3QiIT09KHZvaWQgMD09PXQ/InVuZGVmaW5lZCI6cSh0KSkpdGhyb3cgbmV3IFR5cGVFcnJvcigiU3dlZXRBbGVydDI6IFRoZSBhcmd1bWVudCBmb3Igc2V0RGVmYXVsdHMoKSBpcyByZXF1aXJlZCBhbmQgaGFzIHRvIGJlIGEgb2JqZWN0Iik7c2UodCksT2JqZWN0LmtleXModCkuZm9yRWFjaChmdW5jdGlvbihlKXt4ZS5pc1ZhbGlkUGFyYW1ldGVyKGUpJiYoY2VbZV09dFtlXSl9KX19LHtrZXk6InJlc2V0RGVmYXVsdHMiLHZhbHVlOmZ1bmN0aW9uKCl7bCh1ZSksY2U9e319fV0pLHR9KCksInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cmJiJvYmplY3QiPT09cSh3aW5kb3cuX3N3YWxEZWZhdWx0cykmJkJlLnNldERlZmF1bHRzKHdpbmRvdy5fc3dhbERlZmF1bHRzKSxCZSkpO3JldHVybiBBZS5kZWZhdWx0PUFlfSksInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cmJndpbmRvdy5Td2VldGFsZXJ0MiYmKHdpbmRvdy5zd2FsPXdpbmRvdy5zd2VldEFsZXJ0PXdpbmRvdy5Td2FsPXdpbmRvdy5Td2VldEFsZXJ0PXdpbmRvdy5Td2VldGFsZXJ0Mik7DQovKiENCiAqIEJvb3RzdHJhcC1zZWxlY3QgdjEuMTMuMSAoaHR0cHM6Ly9kZXZlbG9wZXIuc25hcGFwcG9pbnRtZW50cy5jb20vYm9vdHN0cmFwLXNlbGVjdCkNCiAqDQogKiBDb3B5cmlnaHQgMjAxMi0yMDE4IFNuYXBBcHBvaW50bWVudHMsIExMQw0KICogTGljZW5zZWQgdW5kZXIgTUlUIChodHRwczovL2dpdGh1Yi5jb20vc25hcGFwcG9pbnRtZW50cy9ib290c3RyYXAtc2VsZWN0L2Jsb2IvbWFzdGVyL0xJQ0VOU0UpDQogKi8NCg0KKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7CiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkgewogICAgLy8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlIHVubGVzcyBhbWRNb2R1bGVJZCBpcyBzZXQKICAgIGRlZmluZShbImpxdWVyeSJdLCBmdW5jdGlvbiAoYTApIHsKICAgICAgcmV0dXJuIChmYWN0b3J5KGEwKSk7CiAgICB9KTsKICB9IGVsc2UgaWYgKHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzKSB7CiAgICAvLyBOb2RlLiBEb2VzIG5vdCB3b3JrIHdpdGggc3RyaWN0IENvbW1vbkpTLCBidXQKICAgIC8vIG9ubHkgQ29tbW9uSlMtbGlrZSBlbnZpcm9ubWVudHMgdGhhdCBzdXBwb3J0IG1vZHVsZS5leHBvcnRzLAogICAgLy8gbGlrZSBOb2RlLgogICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHJlcXVpcmUoImpxdWVyeSIpKTsKICB9IGVsc2UgewogICAgZmFjdG9yeShyb290WyJqUXVlcnkiXSk7CiAgfQp9KHRoaXMsIGZ1bmN0aW9uIChqUXVlcnkpIHsKCihmdW5jdGlvbiAoJCkgew0KICAndXNlIHN0cmljdCc7DQoNCiAgdmFyIHRlc3RFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnXycpOw0KDQogIHRlc3RFbGVtZW50LmNsYXNzTGlzdC50b2dnbGUoJ2MzJywgZmFsc2UpOw0KDQogIC8vIFBvbHlmaWxsIGZvciBJRSAxMCBhbmQgRmlyZWZveCA8MjQsIHdoZXJlIGNsYXNzTGlzdC50b2dnbGUgZG9lcyBub3QNCiAgLy8gc3VwcG9ydCB0aGUgc2Vjb25kIGFyZ3VtZW50Lg0KICBpZiAodGVzdEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjMycpKSB7DQogICAgdmFyIF90b2dnbGUgPSBET01Ub2tlbkxpc3QucHJvdG90eXBlLnRvZ2dsZTsNCg0KICAgIERPTVRva2VuTGlzdC5wcm90b3R5cGUudG9nZ2xlID0gZnVuY3Rpb24odG9rZW4sIGZvcmNlKSB7DQogICAgICBpZiAoMSBpbiBhcmd1bWVudHMgJiYgIXRoaXMuY29udGFpbnModG9rZW4pID09PSAhZm9yY2UpIHsNCiAgICAgICAgcmV0dXJuIGZvcmNlOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIF90b2dnbGUuY2FsbCh0aGlzLCB0b2tlbik7DQogICAgICB9DQogICAgfTsNCiAgfQ0KDQogIC8vIHNoYWxsb3cgYXJyYXkgY29tcGFyaXNvbg0KICBmdW5jdGlvbiBpc0VxdWFsIChhcnJheTEsIGFycmF5Mikgew0KICAgIHJldHVybiBhcnJheTEubGVuZ3RoID09PSBhcnJheTIubGVuZ3RoICYmIGFycmF5MS5ldmVyeShmdW5jdGlvbihlbGVtZW50LCBpbmRleCkgew0KICAgICAgcmV0dXJuIGVsZW1lbnQgPT09IGFycmF5MltpbmRleF07IA0KICAgIH0pOw0KICB9Ow0KDQogIC8vPGVkaXRvci1mb2xkIGRlc2M9IlNoaW1zIj4NCiAgaWYgKCFTdHJpbmcucHJvdG90eXBlLnN0YXJ0c1dpdGgpIHsNCiAgICAoZnVuY3Rpb24gKCkgew0KICAgICAgJ3VzZSBzdHJpY3QnOyAvLyBuZWVkZWQgdG8gc3VwcG9ydCBgYXBwbHlgL2BjYWxsYCB3aXRoIGB1bmRlZmluZWRgL2BudWxsYA0KICAgICAgdmFyIGRlZmluZVByb3BlcnR5ID0gKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgLy8gSUUgOCBvbmx5IHN1cHBvcnRzIGBPYmplY3QuZGVmaW5lUHJvcGVydHlgIG9uIERPTSBlbGVtZW50cw0KICAgICAgICB0cnkgew0KICAgICAgICAgIHZhciBvYmplY3QgPSB7fTsNCiAgICAgICAgICB2YXIgJGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5Ow0KICAgICAgICAgIHZhciByZXN1bHQgPSAkZGVmaW5lUHJvcGVydHkob2JqZWN0LCBvYmplY3QsIG9iamVjdCkgJiYgJGRlZmluZVByb3BlcnR5Ow0KICAgICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICB9DQogICAgICAgIHJldHVybiByZXN1bHQ7DQogICAgICB9KCkpOw0KICAgICAgdmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7DQogICAgICB2YXIgc3RhcnRzV2l0aCA9IGZ1bmN0aW9uIChzZWFyY2gpIHsNCiAgICAgICAgaWYgKHRoaXMgPT0gbnVsbCkgew0KICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoKTsNCiAgICAgICAgfQ0KICAgICAgICB2YXIgc3RyaW5nID0gU3RyaW5nKHRoaXMpOw0KICAgICAgICBpZiAoc2VhcmNoICYmIHRvU3RyaW5nLmNhbGwoc2VhcmNoKSA9PSAnW29iamVjdCBSZWdFeHBdJykgew0KICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoKTsNCiAgICAgICAgfQ0KICAgICAgICB2YXIgc3RyaW5nTGVuZ3RoID0gc3RyaW5nLmxlbmd0aDsNCiAgICAgICAgdmFyIHNlYXJjaFN0cmluZyA9IFN0cmluZyhzZWFyY2gpOw0KICAgICAgICB2YXIgc2VhcmNoTGVuZ3RoID0gc2VhcmNoU3RyaW5nLmxlbmd0aDsNCiAgICAgICAgdmFyIHBvc2l0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQ7DQogICAgICAgIC8vIGBUb0ludGVnZXJgDQogICAgICAgIHZhciBwb3MgPSBwb3NpdGlvbiA/IE51bWJlcihwb3NpdGlvbikgOiAwOw0KICAgICAgICBpZiAocG9zICE9IHBvcykgeyAvLyBiZXR0ZXIgYGlzTmFOYA0KICAgICAgICAgIHBvcyA9IDA7DQogICAgICAgIH0NCiAgICAgICAgdmFyIHN0YXJ0ID0gTWF0aC5taW4oTWF0aC5tYXgocG9zLCAwKSwgc3RyaW5nTGVuZ3RoKTsNCiAgICAgICAgLy8gQXZvaWQgdGhlIGBpbmRleE9mYCBjYWxsIGlmIG5vIG1hdGNoIGlzIHBvc3NpYmxlDQogICAgICAgIGlmIChzZWFyY2hMZW5ndGggKyBzdGFydCA+IHN0cmluZ0xlbmd0aCkgew0KICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgICB2YXIgaW5kZXggPSAtMTsNCiAgICAgICAgd2hpbGUgKCsraW5kZXggPCBzZWFyY2hMZW5ndGgpIHsNCiAgICAgICAgICBpZiAoc3RyaW5nLmNoYXJDb2RlQXQoc3RhcnQgKyBpbmRleCkgIT0gc2VhcmNoU3RyaW5nLmNoYXJDb2RlQXQoaW5kZXgpKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgfTsNCiAgICAgIGlmIChkZWZpbmVQcm9wZXJ0eSkgew0KICAgICAgICBkZWZpbmVQcm9wZXJ0eShTdHJpbmcucHJvdG90eXBlLCAnc3RhcnRzV2l0aCcsIHsNCiAgICAgICAgICAndmFsdWUnOiBzdGFydHNXaXRoLA0KICAgICAgICAgICdjb25maWd1cmFibGUnOiB0cnVlLA0KICAgICAgICAgICd3cml0YWJsZSc6IHRydWUNCiAgICAgICAgfSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBTdHJpbmcucHJvdG90eXBlLnN0YXJ0c1dpdGggPSBzdGFydHNXaXRoOw0KICAgICAgfQ0KICAgIH0oKSk7DQogIH0NCg0KICBpZiAoIU9iamVjdC5rZXlzKSB7DQogICAgT2JqZWN0LmtleXMgPSBmdW5jdGlvbiAoDQogICAgICBvLCAvLyBvYmplY3QNCiAgICAgIGssIC8vIGtleQ0KICAgICAgciAgLy8gcmVzdWx0IGFycmF5DQogICAgICApew0KICAgICAgLy8gaW5pdGlhbGl6ZSBvYmplY3QgYW5kIHJlc3VsdA0KICAgICAgcj1bXTsNCiAgICAgIC8vIGl0ZXJhdGUgb3ZlciBvYmplY3Qga2V5cw0KICAgICAgZm9yIChrIGluIG8pDQogICAgICAgICAgLy8gZmlsbCByZXN1bHQgYXJyYXkgd2l0aCBub24tcHJvdG90eXBpY2FsIGtleXMNCiAgICAgICAgci5oYXNPd25Qcm9wZXJ0eS5jYWxsKG8sIGspICYmIHIucHVzaChrKTsNCiAgICAgIC8vIHJldHVybiByZXN1bHQNCiAgICAgIHJldHVybiByOw0KICAgIH07DQogIH0NCg0KICAvLyBtdWNoIGZhc3RlciB0aGFuICQudmFsKCkNCiAgZnVuY3Rpb24gZ2V0U2VsZWN0VmFsdWVzKHNlbGVjdCkgew0KICAgIHZhciByZXN1bHQgPSBbXTsNCiAgICB2YXIgb3B0aW9ucyA9IHNlbGVjdCAmJiBzZWxlY3Qub3B0aW9uczsNCiAgICB2YXIgb3B0Ow0KDQogICAgaWYgKHNlbGVjdC5tdWx0aXBsZSkgew0KICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IG9wdGlvbnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsNCiAgICAgICAgb3B0ID0gb3B0aW9uc1tpXTsNCg0KICAgICAgICBpZiAob3B0LnNlbGVjdGVkKSB7DQogICAgICAgICAgcmVzdWx0LnB1c2gob3B0LnZhbHVlIHx8IG9wdC50ZXh0KTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICByZXN1bHQgPSBzZWxlY3QudmFsdWU7DQogICAgfQ0KDQogICAgcmV0dXJuIHJlc3VsdDsNCiAgfQ0KDQogIC8vIHNldCBkYXRhLXNlbGVjdGVkIG9uIHNlbGVjdCBlbGVtZW50IGlmIHRoZSB2YWx1ZSBoYXMgYmVlbiBwcm9ncmFtbWF0aWNhbGx5IHNlbGVjdGVkDQogIC8vIHByaW9yIHRvIGluaXRpYWxpemF0aW9uIG9mIGJvb3RzdHJhcC1zZWxlY3QNCiAgLy8gKiBjb25zaWRlciByZW1vdmluZyBvciByZXBsYWNpbmcgYW4gYWx0ZXJuYXRpdmUgbWV0aG9kICoNCiAgdmFyIHZhbEhvb2tzID0gew0KICAgIHVzZURlZmF1bHQ6IGZhbHNlLA0KICAgIF9zZXQ6ICQudmFsSG9va3Muc2VsZWN0LnNldA0KICB9Ow0KDQogICQudmFsSG9va3Muc2VsZWN0LnNldCA9IGZ1bmN0aW9uIChlbGVtLCB2YWx1ZSkgew0KICAgIGlmICh2YWx1ZSAmJiAhdmFsSG9va3MudXNlRGVmYXVsdCkgJChlbGVtKS5kYXRhKCdzZWxlY3RlZCcsIHRydWUpOw0KDQogICAgcmV0dXJuIHZhbEhvb2tzLl9zZXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsNCiAgfTsNCg0KICB2YXIgY2hhbmdlZF9hcmd1bWVudHMgPSBudWxsOw0KDQogIHZhciBFdmVudElzU3VwcG9ydGVkID0gKGZ1bmN0aW9uICgpIHsNCiAgICB0cnkgew0KICAgICAgbmV3IEV2ZW50KCdjaGFuZ2UnKTsNCiAgICAgIHJldHVybiB0cnVlOw0KICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQogIH0pKCk7DQoNCiAgJC5mbi50cmlnZ2VyTmF0aXZlID0gZnVuY3Rpb24gKGV2ZW50TmFtZSkgew0KICAgIHZhciBlbCA9IHRoaXNbMF0sDQogICAgICAgIGV2ZW50Ow0KDQogICAgaWYgKGVsLmRpc3BhdGNoRXZlbnQpIHsgLy8gZm9yIG1vZGVybiBicm93c2VycyAmIElFOSsNCiAgICAgIGlmIChFdmVudElzU3VwcG9ydGVkKSB7DQogICAgICAgIC8vIEZvciBtb2Rlcm4gYnJvd3NlcnMNCiAgICAgICAgZXZlbnQgPSBuZXcgRXZlbnQoZXZlbnROYW1lLCB7DQogICAgICAgICAgYnViYmxlczogdHJ1ZQ0KICAgICAgICB9KTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIC8vIEZvciBJRSBzaW5jZSBpdCBkb2Vzbid0IHN1cHBvcnQgRXZlbnQgY29uc3RydWN0b3INCiAgICAgICAgZXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnRXZlbnQnKTsNCiAgICAgICAgZXZlbnQuaW5pdEV2ZW50KGV2ZW50TmFtZSwgdHJ1ZSwgZmFsc2UpOw0KICAgICAgfQ0KDQogICAgICBlbC5kaXNwYXRjaEV2ZW50KGV2ZW50KTsNCiAgICB9IGVsc2UgaWYgKGVsLmZpcmVFdmVudCkgeyAvLyBmb3IgSUU4DQogICAgICBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50T2JqZWN0KCk7DQogICAgICBldmVudC5ldmVudFR5cGUgPSBldmVudE5hbWU7DQogICAgICBlbC5maXJlRXZlbnQoJ29uJyArIGV2ZW50TmFtZSwgZXZlbnQpOw0KICAgIH0gZWxzZSB7DQogICAgICAvLyBmYWxsIGJhY2sgdG8galF1ZXJ5LnRyaWdnZXINCiAgICAgIHRoaXMudHJpZ2dlcihldmVudE5hbWUpOw0KICAgIH0NCiAgfTsNCiAgLy88L2VkaXRvci1mb2xkPg0KDQogIGZ1bmN0aW9uIHN0cmluZ1NlYXJjaChsaSwgc2VhcmNoU3RyaW5nLCBtZXRob2QsIG5vcm1hbGl6ZSkgew0KICAgIHZhciBzdHJpbmdUeXBlcyA9IFsNCiAgICAgICAgJ2NvbnRlbnQnLA0KICAgICAgICAnc3VidGV4dCcsDQogICAgICAgICd0b2tlbnMnDQogICAgICBdLA0KICAgICAgc2VhcmNoU3VjY2VzcyA9IGZhbHNlOw0KDQogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHJpbmdUeXBlcy5sZW5ndGg7IGkrKykgew0KICAgICAgdmFyIHN0cmluZ1R5cGUgPSBzdHJpbmdUeXBlc1tpXSwNCiAgICAgICAgICBzdHJpbmcgPSBsaVtzdHJpbmdUeXBlXTsNCg0KICAgICAgaWYgKHN0cmluZykgew0KICAgICAgICBzdHJpbmcgPSBzdHJpbmcudG9TdHJpbmcoKTsNCg0KICAgICAgICAvLyBTdHJpcCBIVE1MIHRhZ3MuIFRoaXMgaXNuJ3QgcGVyZmVjdCwgYnV0IGl0J3MgbXVjaCBmYXN0ZXIgdGhhbiBhbnkgb3RoZXIgbWV0aG9kDQogICAgICAgIGlmIChzdHJpbmdUeXBlID09PSAnY29udGVudCcpIHsNCiAgICAgICAgICBzdHJpbmcgPSBzdHJpbmcucmVwbGFjZSgvPFtePl0rPi9nLCAnJyk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAobm9ybWFsaXplKSBzdHJpbmcgPSBub3JtYWxpemVUb0Jhc2Uoc3RyaW5nKTsNCiAgICAgICAgc3RyaW5nID0gc3RyaW5nLnRvVXBwZXJDYXNlKCk7DQoNCiAgICAgICAgaWYgKG1ldGhvZCA9PT0gJ2NvbnRhaW5zJykgew0KICAgICAgICAgIHNlYXJjaFN1Y2Nlc3MgPSBzdHJpbmcuaW5kZXhPZihzZWFyY2hTdHJpbmcpID49IDA7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgc2VhcmNoU3VjY2VzcyA9IHN0cmluZy5zdGFydHNXaXRoKHNlYXJjaFN0cmluZyk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoc2VhcmNoU3VjY2VzcykgYnJlYWs7DQogICAgICB9DQogICAgfQ0KDQogICAgcmV0dXJuIHNlYXJjaFN1Y2Nlc3M7DQogIH0NCg0KICBmdW5jdGlvbiB0b0ludGVnZXIodmFsdWUpIHsNCiAgICByZXR1cm4gcGFyc2VJbnQodmFsdWUsIDEwKSB8fCAwOw0KICB9DQoNCiAgLyoqDQogICAqIFJlbW92ZSBhbGwgZGlhdHJpY3MgZnJvbSB0aGUgZ2l2ZW4gdGV4dC4NCiAgICogQGFjY2VzcyBwcml2YXRlDQogICAqIEBwYXJhbSB7U3RyaW5nfSB0ZXh0DQogICAqIEByZXR1cm5zIHtTdHJpbmd9DQogICAqLw0KICBmdW5jdGlvbiBub3JtYWxpemVUb0Jhc2UodGV4dCkgew0KICAgIHZhciByRXhwcyA9IFsNCiAgICAgIHtyZTogL1tceEMwLVx4QzZdL2csIGNoOiAiQSJ9LA0KICAgICAge3JlOiAvW1x4RTAtXHhFNl0vZywgY2g6ICJhIn0sDQogICAgICB7cmU6IC9bXHhDOC1ceENCXS9nLCBjaDogIkUifSwNCiAgICAgIHtyZTogL1tceEU4LVx4RUJdL2csIGNoOiAiZSJ9LA0KICAgICAge3JlOiAvW1x4Q0MtXHhDRl0vZywgY2g6ICJJIn0sDQogICAgICB7cmU6IC9bXHhFQy1ceEVGXS9nLCBjaDogImkifSwNCiAgICAgIHtyZTogL1tceEQyLVx4RDZdL2csIGNoOiAiTyJ9LA0KICAgICAge3JlOiAvW1x4RjItXHhGNl0vZywgY2g6ICJvIn0sDQogICAgICB7cmU6IC9bXHhEOS1ceERDXS9nLCBjaDogIlUifSwNCiAgICAgIHtyZTogL1tceEY5LVx4RkNdL2csIGNoOiAidSJ9LA0KICAgICAge3JlOiAvW1x4QzctXHhFN10vZywgY2g6ICJjIn0sDQogICAgICB7cmU6IC9bXHhEMV0vZywgY2g6ICJOIn0sDQogICAgICB7cmU6IC9bXHhGMV0vZywgY2g6ICJuIn0NCiAgICBdOw0KICAgICQuZWFjaChyRXhwcywgZnVuY3Rpb24gKCkgew0KICAgICAgdGV4dCA9IHRleHQgPyB0ZXh0LnJlcGxhY2UodGhpcy5yZSwgdGhpcy5jaCkgOiAnJzsNCiAgICB9KTsNCiAgICByZXR1cm4gdGV4dDsNCiAgfQ0KDQoNCiAgLy8gTGlzdCBvZiBIVE1MIGVudGl0aWVzIGZvciBlc2NhcGluZy4NCiAgdmFyIGVzY2FwZU1hcCA9IHsNCiAgICAnJic6ICcmYW1wOycsDQogICAgJzwnOiAnJmx0OycsDQogICAgJz4nOiAnJmd0OycsDQogICAgJyInOiAnJnF1b3Q7JywNCiAgICAiJyI6ICcmI3gyNzsnLA0KICAgICdgJzogJyYjeDYwOycNCiAgfTsNCiAgDQogIHZhciB1bmVzY2FwZU1hcCA9IHsNCiAgICAnJmFtcDsnOiAnJicsDQogICAgJyZsdDsnOiAnPCcsDQogICAgJyZndDsnOiAnPicsDQogICAgJyZxdW90Oyc6ICciJywNCiAgICAnJiN4Mjc7JzogIiciLA0KICAgICcmI3g2MDsnOiAnYCcNCiAgfTsNCg0KICAvLyBGdW5jdGlvbnMgZm9yIGVzY2FwaW5nIGFuZCB1bmVzY2FwaW5nIHN0cmluZ3MgdG8vZnJvbSBIVE1MIGludGVycG9sYXRpb24uDQogIHZhciBjcmVhdGVFc2NhcGVyID0gZnVuY3Rpb24gKG1hcCkgew0KICAgIHZhciBlc2NhcGVyID0gZnVuY3Rpb24gKG1hdGNoKSB7DQogICAgICByZXR1cm4gbWFwW21hdGNoXTsNCiAgICB9Ow0KICAgIC8vIFJlZ2V4ZXMgZm9yIGlkZW50aWZ5aW5nIGEga2V5IHRoYXQgbmVlZHMgdG8gYmUgZXNjYXBlZC4NCiAgICB2YXIgc291cmNlID0gJyg/OicgKyBPYmplY3Qua2V5cyhtYXApLmpvaW4oJ3wnKSArICcpJzsNCiAgICB2YXIgdGVzdFJlZ2V4cCA9IFJlZ0V4cChzb3VyY2UpOw0KICAgIHZhciByZXBsYWNlUmVnZXhwID0gUmVnRXhwKHNvdXJjZSwgJ2cnKTsNCiAgICByZXR1cm4gZnVuY3Rpb24gKHN0cmluZykgew0KICAgICAgc3RyaW5nID0gc3RyaW5nID09IG51bGwgPyAnJyA6ICcnICsgc3RyaW5nOw0KICAgICAgcmV0dXJuIHRlc3RSZWdleHAudGVzdChzdHJpbmcpID8gc3RyaW5nLnJlcGxhY2UocmVwbGFjZVJlZ2V4cCwgZXNjYXBlcikgOiBzdHJpbmc7DQogICAgfTsNCiAgfTsNCg0KICB2YXIgaHRtbEVzY2FwZSA9IGNyZWF0ZUVzY2FwZXIoZXNjYXBlTWFwKTsNCiAgdmFyIGh0bWxVbmVzY2FwZSA9IGNyZWF0ZUVzY2FwZXIodW5lc2NhcGVNYXApOw0KDQogIC8qKg0KICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICogQ29uc3RhbnRzDQogICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgKi8NCg0KICB2YXIga2V5Q29kZU1hcCA9IHsNCiAgICAzMjogJyAnLA0KICAgIDQ4OiAnMCcsDQogICAgNDk6ICcxJywNCiAgICA1MDogJzInLA0KICAgIDUxOiAnMycsDQogICAgNTI6ICc0JywNCiAgICA1MzogJzUnLA0KICAgIDU0OiAnNicsDQogICAgNTU6ICc3JywNCiAgICA1NjogJzgnLA0KICAgIDU3OiAnOScsDQogICAgNTk6ICc7JywNCiAgICA2NTogJ0EnLA0KICAgIDY2OiAnQicsDQogICAgNjc6ICdDJywNCiAgICA2ODogJ0QnLA0KICAgIDY5OiAnRScsDQogICAgNzA6ICdGJywNCiAgICA3MTogJ0cnLA0KICAgIDcyOiAnSCcsDQogICAgNzM6ICdJJywNCiAgICA3NDogJ0onLA0KICAgIDc1OiAnSycsDQogICAgNzY6ICdMJywNCiAgICA3NzogJ00nLA0KICAgIDc4OiAnTicsDQogICAgNzk6ICdPJywNCiAgICA4MDogJ1AnLA0KICAgIDgxOiAnUScsDQogICAgODI6ICdSJywNCiAgICA4MzogJ1MnLA0KICAgIDg0OiAnVCcsDQogICAgODU6ICdVJywNCiAgICA4NjogJ1YnLA0KICAgIDg3OiAnVycsDQogICAgODg6ICdYJywNCiAgICA4OTogJ1knLA0KICAgIDkwOiAnWicsDQogICAgOTY6ICcwJywNCiAgICA5NzogJzEnLA0KICAgIDk4OiAnMicsDQogICAgOTk6ICczJywNCiAgICAxMDA6ICc0JywNCiAgICAxMDE6ICc1JywNCiAgICAxMDI6ICc2JywNCiAgICAxMDM6ICc3JywNCiAgICAxMDQ6ICc4JywNCiAgICAxMDU6ICc5Jw0KICB9Ow0KDQogIHZhciBrZXlDb2RlcyA9IHsNCiAgICBFU0NBUEU6IDI3LCAvLyBLZXlib2FyZEV2ZW50LndoaWNoIHZhbHVlIGZvciBFc2NhcGUgKEVzYykga2V5DQogICAgRU5URVI6IDEzLCAvLyBLZXlib2FyZEV2ZW50LndoaWNoIHZhbHVlIGZvciBFbnRlciBrZXkNCiAgICBTUEFDRTogMzIsIC8vIEtleWJvYXJkRXZlbnQud2hpY2ggdmFsdWUgZm9yIHNwYWNlIGtleQ0KICAgIFRBQjogOSwgLy8gS2V5Ym9hcmRFdmVudC53aGljaCB2YWx1ZSBmb3IgdGFiIGtleQ0KICAgIEFSUk9XX1VQOiAzOCwgLy8gS2V5Ym9hcmRFdmVudC53aGljaCB2YWx1ZSBmb3IgdXAgYXJyb3cga2V5DQogICAgQVJST1dfRE9XTjogNDAgLy8gS2V5Ym9hcmRFdmVudC53aGljaCB2YWx1ZSBmb3IgZG93biBhcnJvdyBrZXkNCiAgfQ0KDQogIHZhciB2ZXJzaW9uID0ge307DQoNCiAgdHJ5IHsNCiAgICB2ZXJzaW9uLmZ1bGwgPSAoJC5mbi5kcm9wZG93bi5Db25zdHJ1Y3Rvci5WRVJTSU9OIHx8ICcnKS5zcGxpdCgnICcpWzBdLnNwbGl0KCcuJyk7DQogICAgdmVyc2lvbi5tYWpvciA9IHZlcnNpb24uZnVsbFswXTsNCiAgfQ0KICBjYXRjaChlcnIpIHsNCiAgICBjb25zb2xlLmVycm9yKCdUaGVyZSB3YXMgYW4gaXNzdWUgcmV0cmlldmluZyBCb290c3RyYXBcJ3MgdmVyc2lvbi4gRW5zdXJlIEJvb3RzdHJhcCBpcyBiZWluZyBsb2FkZWQgYmVmb3JlIGJvb3RzdHJhcC1zZWxlY3QgYW5kIHRoZXJlIGlzIG5vIG5hbWVzcGFjZSBjb2xsaXNpb24uJywgZXJyKTsNCiAgICB2ZXJzaW9uLm1ham9yID0gJzMnOw0KICB9DQoNCiAgdmFyIGNsYXNzTmFtZXMgPSB7DQogICAgRElTQUJMRUQ6ICdkaXNhYmxlZCcsDQogICAgRElWSURFUjogdmVyc2lvbi5tYWpvciA9PT0gJzQnID8gJ2Ryb3Bkb3duLWRpdmlkZXInIDogJ2RpdmlkZXInLA0KICAgIFNIT1c6IHZlcnNpb24ubWFqb3IgPT09ICc0JyA/ICdzaG93JyA6ICdvcGVuJywNCiAgICBEUk9QVVA6ICdkcm9wdXAnLA0KICAgIE1FTlVSSUdIVDogJ2Ryb3Bkb3duLW1lbnUtcmlnaHQnLA0KICAgIE1FTlVMRUZUOiAnZHJvcGRvd24tbWVudS1sZWZ0JywNCiAgICAvLyB0by1kbzogcmVwbGFjZSB3aXRoIG1vcmUgYWR2YW5jZWQgdGVtcGxhdGUvY3VzdG9taXphdGlvbiBvcHRpb25zDQogICAgQlVUVE9OQ0xBU1M6IHZlcnNpb24ubWFqb3IgPT09ICc0JyA/ICdidG4tbGlnaHQnIDogJ2J0bi1kZWZhdWx0JywNCiAgICBQT1BPVkVSSEVBREVSOiB2ZXJzaW9uLm1ham9yID09PSAnNCcgPyAncG9wb3Zlci1oZWFkZXInIDogJ3BvcG92ZXItdGl0bGUnDQogIH0NCg0KICB2YXIgUkVHRVhQX0FSUk9XID0gbmV3IFJlZ0V4cChrZXlDb2Rlcy5BUlJPV19VUCArICd8JyArIGtleUNvZGVzLkFSUk9XX0RPV04pOw0KICB2YXIgUkVHRVhQX1RBQl9PUl9FU0NBUEUgPSBuZXcgUmVnRXhwKCdeJyArIGtleUNvZGVzLlRBQiArICckfCcgKyBrZXlDb2Rlcy5FU0NBUEUpOw0KICB2YXIgUkVHRVhQX0VOVEVSX09SX1NQQUNFID0gbmV3IFJlZ0V4cChrZXlDb2Rlcy5FTlRFUiArICd8JyArIGtleUNvZGVzLlNQQUNFKTsNCg0KICB2YXIgU2VsZWN0cGlja2VyID0gZnVuY3Rpb24gKGVsZW1lbnQsIG9wdGlvbnMpIHsNCiAgICB2YXIgdGhhdCA9IHRoaXM7DQoNCiAgICAvLyBib290c3RyYXAtc2VsZWN0IGhhcyBiZWVuIGluaXRpYWxpemVkIC0gcmV2ZXJ0IHZhbEhvb2tzLnNlbGVjdC5zZXQgYmFjayB0byBpdHMgb3JpZ2luYWwgZnVuY3Rpb24NCiAgICBpZiAoIXZhbEhvb2tzLnVzZURlZmF1bHQpIHsNCiAgICAgICQudmFsSG9va3Muc2VsZWN0LnNldCA9IHZhbEhvb2tzLl9zZXQ7DQogICAgICB2YWxIb29rcy51c2VEZWZhdWx0ID0gdHJ1ZTsNCiAgICB9DQoNCiAgICB0aGlzLiRlbGVtZW50ID0gJChlbGVtZW50KTsNCiAgICB0aGlzLiRuZXdFbGVtZW50ID0gbnVsbDsNCiAgICB0aGlzLiRidXR0b24gPSBudWxsOw0KICAgIHRoaXMuJG1lbnUgPSBudWxsOw0KICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7DQogICAgdGhpcy5zZWxlY3RwaWNrZXIgPSB7DQogICAgICBtYWluOiB7DQogICAgICAgIC8vIHN0b3JlIG9yaWdpbmFsSW5kZXggKGtleSkgYW5kIG5ld0luZGV4ICh2YWx1ZSkgaW4gdGhpcy5zZWxlY3RwaWNrZXIubWFpbi5tYXAubmV3SW5kZXggZm9yIGZhc3QgYWNjZXNzaWJpbGl0eQ0KICAgICAgICAvLyBhbGxvd3MgdXMgdG8gZG8gdGhpcy5tYWluLmVsZW1lbnRzW3RoaXMuc2VsZWN0cGlja2VyLm1haW4ubWFwLm5ld0luZGV4W2luZGV4XV0gdG8gc2VsZWN0IGFuIGVsZW1lbnQgYmFzZWQgb24gdGhlIG9yaWdpbmFsSW5kZXgNCiAgICAgICAgbWFwOiB7DQogICAgICAgICAgbmV3SW5kZXg6IHt9LA0KICAgICAgICAgIG9yaWdpbmFsSW5kZXg6IHt9DQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICBjdXJyZW50OiB7DQogICAgICAgIG1hcDoge30NCiAgICAgIH0sIC8vIGN1cnJlbnQgY2hhbmdlcyBpZiBhIHNlYXJjaCBpcyBpbiBwcm9ncmVzcw0KICAgICAgc2VhcmNoOiB7DQogICAgICAgIG1hcDoge30NCiAgICAgIH0sDQogICAgICB2aWV3OiB7fSwNCiAgICAgIGtleWRvd246IHsNCiAgICAgICAga2V5SGlzdG9yeTogJycsDQogICAgICAgIHJlc2V0S2V5SGlzdG9yeTogew0KICAgICAgICAgIHN0YXJ0OiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgIHRoYXQuc2VsZWN0cGlja2VyLmtleWRvd24ua2V5SGlzdG9yeSA9ICcnOw0KICAgICAgICAgICAgfSwgODAwKTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9Ow0KICAgIC8vIElmIHdlIGhhdmUgbm8gdGl0bGUgeWV0LCB0cnkgdG8gcHVsbCBpdCBmcm9tIHRoZSBodG1sIHRpdGxlIGF0dHJpYnV0ZSAoalF1ZXJ5IGRvZXNudCcgcGljayBpdCB1cCBhcyBpdCdzIG5vdCBhDQogICAgLy8gZGF0YS1hdHRyaWJ1dGUpDQogICAgaWYgKHRoaXMub3B0aW9ucy50aXRsZSA9PT0gbnVsbCkgew0KICAgICAgdGhpcy5vcHRpb25zLnRpdGxlID0gdGhpcy4kZWxlbWVudC5hdHRyKCd0aXRsZScpOw0KICAgIH0NCg0KICAgIC8vIEZvcm1hdCB3aW5kb3cgcGFkZGluZw0KICAgIHZhciB3aW5QYWQgPSB0aGlzLm9wdGlvbnMud2luZG93UGFkZGluZzsNCiAgICBpZiAodHlwZW9mIHdpblBhZCA9PT0gJ251bWJlcicpIHsNCiAgICAgIHRoaXMub3B0aW9ucy53aW5kb3dQYWRkaW5nID0gW3dpblBhZCwgd2luUGFkLCB3aW5QYWQsIHdpblBhZF07DQogICAgfQ0KDQogICAgLy9FeHBvc2UgcHVibGljIG1ldGhvZHMNCiAgICB0aGlzLnZhbCA9IFNlbGVjdHBpY2tlci5wcm90b3R5cGUudmFsOw0KICAgIHRoaXMucmVuZGVyID0gU2VsZWN0cGlja2VyLnByb3RvdHlwZS5yZW5kZXI7DQogICAgdGhpcy5yZWZyZXNoID0gU2VsZWN0cGlja2VyLnByb3RvdHlwZS5yZWZyZXNoOw0KICAgIHRoaXMuc2V0U3R5bGUgPSBTZWxlY3RwaWNrZXIucHJvdG90eXBlLnNldFN0eWxlOw0KICAgIHRoaXMuc2VsZWN0QWxsID0gU2VsZWN0cGlja2VyLnByb3RvdHlwZS5zZWxlY3RBbGw7DQogICAgdGhpcy5kZXNlbGVjdEFsbCA9IFNlbGVjdHBpY2tlci5wcm90b3R5cGUuZGVzZWxlY3RBbGw7DQogICAgdGhpcy5kZXN0cm95ID0gU2VsZWN0cGlja2VyLnByb3RvdHlwZS5kZXN0cm95Ow0KICAgIHRoaXMucmVtb3ZlID0gU2VsZWN0cGlja2VyLnByb3RvdHlwZS5yZW1vdmU7DQogICAgdGhpcy5zaG93ID0gU2VsZWN0cGlja2VyLnByb3RvdHlwZS5zaG93Ow0KICAgIHRoaXMuaGlkZSA9IFNlbGVjdHBpY2tlci5wcm90b3R5cGUuaGlkZTsNCg0KICAgIHRoaXMuaW5pdCgpOw0KICB9Ow0KDQogIFNlbGVjdHBpY2tlci5WRVJTSU9OID0gJzEuMTMuMSc7DQoNCiAgLy8gcGFydCBvZiB0aGlzIGlzIGR1cGxpY2F0ZWQgaW4gaTE4bi9kZWZhdWx0cy1lbl9VUy5qcy4gTWFrZSBzdXJlIHRvIHVwZGF0ZSBib3RoLg0KICBTZWxlY3RwaWNrZXIuREVGQVVMVFMgPSB7DQogICAgbm9uZVNlbGVjdGVkVGV4dDogJ05vdGhpbmcgc2VsZWN0ZWQnLA0KICAgIG5vbmVSZXN1bHRzVGV4dDogJ05vIHJlc3VsdHMgbWF0Y2hlZCB7MH0nLA0KICAgIGNvdW50U2VsZWN0ZWRUZXh0OiBmdW5jdGlvbiAobnVtU2VsZWN0ZWQsIG51bVRvdGFsKSB7DQogICAgICByZXR1cm4gKG51bVNlbGVjdGVkID09IDEpID8gInswfSBpdGVtIHNlbGVjdGVkIiA6ICJ7MH0gaXRlbXMgc2VsZWN0ZWQiOw0KICAgIH0sDQogICAgbWF4T3B0aW9uc1RleHQ6IGZ1bmN0aW9uIChudW1BbGwsIG51bUdyb3VwKSB7DQogICAgICByZXR1cm4gWw0KICAgICAgICAobnVtQWxsID09IDEpID8gJ0xpbWl0IHJlYWNoZWQgKHtufSBpdGVtIG1heCknIDogJ0xpbWl0IHJlYWNoZWQgKHtufSBpdGVtcyBtYXgpJywNCiAgICAgICAgKG51bUdyb3VwID09IDEpID8gJ0dyb3VwIGxpbWl0IHJlYWNoZWQgKHtufSBpdGVtIG1heCknIDogJ0dyb3VwIGxpbWl0IHJlYWNoZWQgKHtufSBpdGVtcyBtYXgpJw0KICAgICAgXTsNCiAgICB9LA0KICAgIHNlbGVjdEFsbFRleHQ6ICdTZWxlY3QgQWxsJywNCiAgICBkZXNlbGVjdEFsbFRleHQ6ICdEZXNlbGVjdCBBbGwnLA0KICAgIGRvbmVCdXR0b246IGZhbHNlLA0KICAgIGRvbmVCdXR0b25UZXh0OiAnQ2xvc2UnLA0KICAgIG11bHRpcGxlU2VwYXJhdG9yOiAnLCAnLA0KICAgIHN0eWxlQmFzZTogJ2J0bicsDQogICAgc3R5bGU6ICdidG4tZGVmYXVsdCcsDQogICAgc2l6ZTogJ2F1dG8nLA0KICAgIHRpdGxlOiBudWxsLA0KICAgIHNlbGVjdGVkVGV4dEZvcm1hdDogJ3ZhbHVlcycsDQogICAgd2lkdGg6IGZhbHNlLA0KICAgIGNvbnRhaW5lcjogZmFsc2UsDQogICAgaGlkZURpc2FibGVkOiBmYWxzZSwNCiAgICBzaG93U3VidGV4dDogZmFsc2UsDQogICAgc2hvd0ljb246IHRydWUsDQogICAgc2hvd0NvbnRlbnQ6IHRydWUsDQogICAgZHJvcHVwQXV0bzogdHJ1ZSwNCiAgICBoZWFkZXI6IGZhbHNlLA0KICAgIGxpdmVTZWFyY2g6IGZhbHNlLA0KICAgIGxpdmVTZWFyY2hQbGFjZWhvbGRlcjogbnVsbCwNCiAgICBsaXZlU2VhcmNoTm9ybWFsaXplOiBmYWxzZSwNCiAgICBsaXZlU2VhcmNoU3R5bGU6ICdjb250YWlucycsDQogICAgYWN0aW9uc0JveDogZmFsc2UsDQogICAgaWNvbkJhc2U6ICdnbHlwaGljb24nLA0KICAgIHRpY2tJY29uOiAnZ2x5cGhpY29uLW9rJywNCiAgICBzaG93VGljazogZmFsc2UsDQogICAgdGVtcGxhdGU6IHsNCiAgICAgIGNhcmV0OiAnPHNwYW4gY2xhc3M9ImNhcmV0Ij48L3NwYW4+Jw0KICAgIH0sDQogICAgbWF4T3B0aW9uczogZmFsc2UsDQogICAgbW9iaWxlOiBmYWxzZSwNCiAgICBzZWxlY3RPblRhYjogZmFsc2UsDQogICAgZHJvcGRvd25BbGlnblJpZ2h0OiBmYWxzZSwNCiAgICB3aW5kb3dQYWRkaW5nOiAwLA0KICAgIHZpcnR1YWxTY3JvbGw6IDYwMA0KICB9Ow0KDQogIGlmICh2ZXJzaW9uLm1ham9yID09PSAnNCcpIHsNCiAgICBTZWxlY3RwaWNrZXIuREVGQVVMVFMuc3R5bGUgPSAnYnRuLWxpZ2h0JzsNCiAgICBTZWxlY3RwaWNrZXIuREVGQVVMVFMuaWNvbkJhc2UgPSAnJzsNCiAgICBTZWxlY3RwaWNrZXIuREVGQVVMVFMudGlja0ljb24gPSAnYnMtb2stZGVmYXVsdCc7DQogIH0NCg0KICBTZWxlY3RwaWNrZXIucHJvdG90eXBlID0gew0KDQogICAgY29uc3RydWN0b3I6IFNlbGVjdHBpY2tlciwNCg0KICAgIGluaXQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHZhciB0aGF0ID0gdGhpcywNCiAgICAgICAgICBpZCA9IHRoaXMuJGVsZW1lbnQuYXR0cignaWQnKTsNCg0KICAgICAgdGhpcy4kZWxlbWVudC5hZGRDbGFzcygnYnMtc2VsZWN0LWhpZGRlbicpOw0KDQogICAgICB0aGlzLm11bHRpcGxlID0gdGhpcy4kZWxlbWVudC5wcm9wKCdtdWx0aXBsZScpOw0KICAgICAgdGhpcy5hdXRvZm9jdXMgPSB0aGlzLiRlbGVtZW50LnByb3AoJ2F1dG9mb2N1cycpOw0KICAgICAgdGhpcy4kbmV3RWxlbWVudCA9IHRoaXMuY3JlYXRlRHJvcGRvd24oKTsNCiAgICAgIHRoaXMuY3JlYXRlTGkoKTsNCiAgICAgIHRoaXMuJGVsZW1lbnQNCiAgICAgICAgLmFmdGVyKHRoaXMuJG5ld0VsZW1lbnQpDQogICAgICAgIC5wcmVwZW5kVG8odGhpcy4kbmV3RWxlbWVudCk7DQogICAgICB0aGlzLiRidXR0b24gPSB0aGlzLiRuZXdFbGVtZW50LmNoaWxkcmVuKCdidXR0b24nKTsNCiAgICAgIHRoaXMuJG1lbnUgPSB0aGlzLiRuZXdFbGVtZW50LmNoaWxkcmVuKCcuZHJvcGRvd24tbWVudScpOw0KICAgICAgdGhpcy4kbWVudUlubmVyID0gdGhpcy4kbWVudS5jaGlsZHJlbignLmlubmVyJyk7DQogICAgICB0aGlzLiRzZWFyY2hib3ggPSB0aGlzLiRtZW51LmZpbmQoJ2lucHV0Jyk7DQoNCiAgICAgIHRoaXMuJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ2JzLXNlbGVjdC1oaWRkZW4nKTsNCg0KICAgICAgaWYgKHRoaXMub3B0aW9ucy5kcm9wZG93bkFsaWduUmlnaHQgPT09IHRydWUpIHRoaXMuJG1lbnUuYWRkQ2xhc3MoY2xhc3NOYW1lcy5NRU5VUklHSFQpOw0KDQogICAgICBpZiAodHlwZW9mIGlkICE9PSAndW5kZWZpbmVkJykgew0KICAgICAgICB0aGlzLiRidXR0b24uYXR0cignZGF0YS1pZCcsIGlkKTsNCiAgICAgIH0NCg0KICAgICAgdGhpcy5jaGVja0Rpc2FibGVkKCk7DQogICAgICB0aGlzLmNsaWNrTGlzdGVuZXIoKTsNCiAgICAgIGlmICh0aGlzLm9wdGlvbnMubGl2ZVNlYXJjaCkgdGhpcy5saXZlU2VhcmNoTGlzdGVuZXIoKTsNCiAgICAgIHRoaXMucmVuZGVyKCk7DQogICAgICB0aGlzLnNldFN0eWxlKCk7DQogICAgICB0aGlzLnNldFdpZHRoKCk7DQogICAgICBpZiAodGhpcy5vcHRpb25zLmNvbnRhaW5lcikgew0KICAgICAgICB0aGlzLnNlbGVjdFBvc2l0aW9uKCk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLiRlbGVtZW50Lm9uKCdoaWRlLmJzLnNlbGVjdCcsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICBpZiAodGhhdC5pc1ZpcnR1YWwoKSkgew0KICAgICAgICAgICAgLy8gZW1wdHkgbWVudSBvbiBjbG9zZQ0KICAgICAgICAgICAgdmFyIG1lbnVJbm5lciA9IHRoYXQuJG1lbnVJbm5lclswXSwNCiAgICAgICAgICAgICAgICBlbXB0eU1lbnUgPSBtZW51SW5uZXIuZmlyc3RDaGlsZC5jbG9uZU5vZGUoZmFsc2UpOw0KDQogICAgICAgICAgICAvLyByZXBsYWNlIHRoZSBleGlzdGluZyBVTCB3aXRoIGFuIGVtcHR5IG9uZSAtIHRoaXMgaXMgZmFzdGVyIHRoYW4gJC5lbXB0eSgpIG9yIGlubmVySFRNTCA9ICcnDQogICAgICAgICAgICBtZW51SW5uZXIucmVwbGFjZUNoaWxkKGVtcHR5TWVudSwgbWVudUlubmVyLmZpcnN0Q2hpbGQpOw0KICAgICAgICAgICAgbWVudUlubmVyLnNjcm9sbFRvcCA9IDA7DQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgIH0NCiAgICAgIHRoaXMuJG1lbnUuZGF0YSgndGhpcycsIHRoaXMpOw0KICAgICAgdGhpcy4kbmV3RWxlbWVudC5kYXRhKCd0aGlzJywgdGhpcyk7DQogICAgICBpZiAodGhpcy5vcHRpb25zLm1vYmlsZSkgdGhpcy5tb2JpbGUoKTsNCg0KICAgICAgdGhpcy4kbmV3RWxlbWVudC5vbih7DQogICAgICAgICdoaWRlLmJzLmRyb3Bkb3duJzogZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgICB0aGF0LiRtZW51SW5uZXIuYXR0cignYXJpYS1leHBhbmRlZCcsIGZhbHNlKTsNCiAgICAgICAgICB0aGF0LiRlbGVtZW50LnRyaWdnZXIoJ2hpZGUuYnMuc2VsZWN0JywgZSk7DQogICAgICAgIH0sDQogICAgICAgICdoaWRkZW4uYnMuZHJvcGRvd24nOiBmdW5jdGlvbiAoZSkgew0KICAgICAgICAgIHRoYXQuJGVsZW1lbnQudHJpZ2dlcignaGlkZGVuLmJzLnNlbGVjdCcsIGUpOw0KICAgICAgICB9LA0KICAgICAgICAnc2hvdy5icy5kcm9wZG93bic6IGZ1bmN0aW9uIChlKSB7DQogICAgICAgICAgdGhhdC4kbWVudUlubmVyLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCB0cnVlKTsNCiAgICAgICAgICB0aGF0LiRlbGVtZW50LnRyaWdnZXIoJ3Nob3cuYnMuc2VsZWN0JywgZSk7DQogICAgICAgIH0sDQogICAgICAgICdzaG93bi5icy5kcm9wZG93bic6IGZ1bmN0aW9uIChlKSB7DQogICAgICAgICAgdGhhdC4kZWxlbWVudC50cmlnZ2VyKCdzaG93bi5icy5zZWxlY3QnLCBlKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQoNCiAgICAgIGlmICh0aGF0LiRlbGVtZW50WzBdLmhhc0F0dHJpYnV0ZSgncmVxdWlyZWQnKSkgew0KICAgICAgICB0aGlzLiRlbGVtZW50Lm9uKCdpbnZhbGlkJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgIHRoYXQuJGJ1dHRvbi5hZGRDbGFzcygnYnMtaW52YWxpZCcpOw0KDQogICAgICAgICAgdGhhdC4kZWxlbWVudC5vbih7DQogICAgICAgICAgICAnc2hvd24uYnMuc2VsZWN0JzogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICB0aGF0LiRlbGVtZW50DQogICAgICAgICAgICAgICAgLnZhbCh0aGF0LiRlbGVtZW50LnZhbCgpKSAvLyBzZXQgdGhlIHZhbHVlIHRvIGhpZGUgdGhlIHZhbGlkYXRpb24gbWVzc2FnZSBpbiBDaHJvbWUgd2hlbiBtZW51IGlzIG9wZW5lZA0KICAgICAgICAgICAgICAgIC5vZmYoJ3Nob3duLmJzLnNlbGVjdCcpOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICdyZW5kZXJlZC5icy5zZWxlY3QnOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgIC8vIGlmIHNlbGVjdCBpcyBubyBsb25nZXIgaW52YWxpZCwgcmVtb3ZlIHRoZSBicy1pbnZhbGlkIGNsYXNzDQogICAgICAgICAgICAgIGlmICh0aGlzLnZhbGlkaXR5LnZhbGlkKSB0aGF0LiRidXR0b24ucmVtb3ZlQ2xhc3MoJ2JzLWludmFsaWQnKTsNCiAgICAgICAgICAgICAgdGhhdC4kZWxlbWVudC5vZmYoJ3JlbmRlcmVkLmJzLnNlbGVjdCcpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pOw0KDQogICAgICAgICAgdGhhdC4kYnV0dG9uLm9uKCdibHVyLmJzLnNlbGVjdCcsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHRoYXQuJGVsZW1lbnQuZm9jdXMoKS5ibHVyKCk7DQogICAgICAgICAgICB0aGF0LiRidXR0b24ub2ZmKCdibHVyLmJzLnNlbGVjdCcpOw0KICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICAgIH0NCg0KICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgIHRoYXQuJGVsZW1lbnQudHJpZ2dlcignbG9hZGVkLmJzLnNlbGVjdCcpOw0KICAgICAgfSk7DQogICAgfSwNCg0KICAgIGNyZWF0ZURyb3Bkb3duOiBmdW5jdGlvbiAoKSB7DQogICAgICAvLyBPcHRpb25zDQogICAgICAvLyBJZiB3ZSBhcmUgbXVsdGlwbGUgb3Igc2hvd1RpY2sgb3B0aW9uIGlzIHNldCwgdGhlbiBhZGQgdGhlIHNob3ctdGljayBjbGFzcw0KICAgICAgdmFyIHNob3dUaWNrID0gKHRoaXMubXVsdGlwbGUgfHwgdGhpcy5vcHRpb25zLnNob3dUaWNrKSA/ICcgc2hvdy10aWNrJyA6ICcnLA0KICAgICAgICAgIGF1dG9mb2N1cyA9IHRoaXMuYXV0b2ZvY3VzID8gJyBhdXRvZm9jdXMnIDogJyc7DQogICAgICAvLyBFbGVtZW50cw0KICAgICAgdmFyIGhlYWRlciA9IHRoaXMub3B0aW9ucy5oZWFkZXIgPyAnPGRpdiBjbGFzcz0iJyArIGNsYXNzTmFtZXMuUE9QT1ZFUkhFQURFUiArICciPjxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iY2xvc2UiIGFyaWEtaGlkZGVuPSJ0cnVlIj4mdGltZXM7PC9idXR0b24+JyArIHRoaXMub3B0aW9ucy5oZWFkZXIgKyAnPC9kaXY+JyA6ICcnOw0KICAgICAgdmFyIHNlYXJjaGJveCA9IHRoaXMub3B0aW9ucy5saXZlU2VhcmNoID8NCiAgICAgICc8ZGl2IGNsYXNzPSJicy1zZWFyY2hib3giPicgKw0KICAgICAgJzxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0iZm9ybS1jb250cm9sIiBhdXRvY29tcGxldGU9Im9mZiInICsNCiAgICAgIChudWxsID09PSB0aGlzLm9wdGlvbnMubGl2ZVNlYXJjaFBsYWNlaG9sZGVyID8gJycgOiAnIHBsYWNlaG9sZGVyPSInICsgaHRtbEVzY2FwZSh0aGlzLm9wdGlvbnMubGl2ZVNlYXJjaFBsYWNlaG9sZGVyKSArICciJykgKyAnIHJvbGU9InRleHRib3giIGFyaWEtbGFiZWw9IlNlYXJjaCI+JyArDQogICAgICAnPC9kaXY+Jw0KICAgICAgICAgIDogJyc7DQogICAgICB2YXIgYWN0aW9uc2JveCA9IHRoaXMubXVsdGlwbGUgJiYgdGhpcy5vcHRpb25zLmFjdGlvbnNCb3ggPw0KICAgICAgJzxkaXYgY2xhc3M9ImJzLWFjdGlvbnNib3giPicgKw0KICAgICAgJzxkaXYgY2xhc3M9ImJ0bi1ncm91cCBidG4tZ3JvdXAtc20gYnRuLWJsb2NrIj4nICsNCiAgICAgICc8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImFjdGlvbnMtYnRuIGJzLXNlbGVjdC1hbGwgYnRuICcgKyBjbGFzc05hbWVzLkJVVFRPTkNMQVNTICsgJyI+JyArDQogICAgICB0aGlzLm9wdGlvbnMuc2VsZWN0QWxsVGV4dCArDQogICAgICAnPC9idXR0b24+JyArDQogICAgICAnPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJhY3Rpb25zLWJ0biBicy1kZXNlbGVjdC1hbGwgYnRuICcgKyBjbGFzc05hbWVzLkJVVFRPTkNMQVNTICsgJyI+JyArDQogICAgICB0aGlzLm9wdGlvbnMuZGVzZWxlY3RBbGxUZXh0ICsNCiAgICAgICc8L2J1dHRvbj4nICsNCiAgICAgICc8L2Rpdj4nICsNCiAgICAgICc8L2Rpdj4nDQogICAgICAgICAgOiAnJzsNCiAgICAgIHZhciBkb25lYnV0dG9uID0gdGhpcy5tdWx0aXBsZSAmJiB0aGlzLm9wdGlvbnMuZG9uZUJ1dHRvbiA/DQogICAgICAnPGRpdiBjbGFzcz0iYnMtZG9uZWJ1dHRvbiI+JyArDQogICAgICAnPGRpdiBjbGFzcz0iYnRuLWdyb3VwIGJ0bi1ibG9jayI+JyArDQogICAgICAnPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gYnRuLXNtICcgKyBjbGFzc05hbWVzLkJVVFRPTkNMQVNTICsgJyI+JyArDQogICAgICB0aGlzLm9wdGlvbnMuZG9uZUJ1dHRvblRleHQgKw0KICAgICAgJzwvYnV0dG9uPicgKw0KICAgICAgJzwvZGl2PicgKw0KICAgICAgJzwvZGl2PicNCiAgICAgICAgICA6ICcnOw0KICAgICAgdmFyIGRyb3AgPQ0KICAgICAgICAgICc8ZGl2IGNsYXNzPSJkcm9wZG93biBib290c3RyYXAtc2VsZWN0JyArIHNob3dUaWNrICsgJyI+JyArDQogICAgICAgICAgJzxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iJyArIHRoaXMub3B0aW9ucy5zdHlsZUJhc2UgKyAnIGRyb3Bkb3duLXRvZ2dsZSIgZGF0YS10b2dnbGU9ImRyb3Bkb3duIicgKyBhdXRvZm9jdXMgKyAnIHJvbGU9ImJ1dHRvbiI+JyArDQogICAgICAgICAgJzxkaXYgY2xhc3M9ImZpbHRlci1vcHRpb24iPicgKw0KICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImZpbHRlci1vcHRpb24taW5uZXIiPicgKw0KICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0iZmlsdGVyLW9wdGlvbi1pbm5lci1pbm5lciI+PC9kaXY+JyArDQogICAgICAgICAgICAnPC9kaXY+ICcgKw0KICAgICAgICAgICc8L2Rpdj4nICsNCiAgICAgICAgICAodmVyc2lvbi5tYWpvciA9PT0gJzQnID8NCiAgICAgICAgICAgICcnIDoNCiAgICAgICAgICAnPHNwYW4gY2xhc3M9ImJzLWNhcmV0Ij4nICsNCiAgICAgICAgICB0aGlzLm9wdGlvbnMudGVtcGxhdGUuY2FyZXQgKw0KICAgICAgICAgICc8L3NwYW4+Jw0KICAgICAgICAgICkgKw0KICAgICAgICAgICc8L2J1dHRvbj4nICsNCiAgICAgICAgICAnPGRpdiBjbGFzcz0iZHJvcGRvd24tbWVudSAnICsgKHZlcnNpb24ubWFqb3IgPT09ICc0JyA/ICcnIDogY2xhc3NOYW1lcy5TSE9XKSArICciIHJvbGU9ImNvbWJvYm94Ij4nICsNCiAgICAgICAgICBoZWFkZXIgKw0KICAgICAgICAgIHNlYXJjaGJveCArDQogICAgICAgICAgYWN0aW9uc2JveCArDQogICAgICAgICAgJzxkaXYgY2xhc3M9ImlubmVyICcgKyBjbGFzc05hbWVzLlNIT1cgKyAnIiByb2xlPSJsaXN0Ym94IiBhcmlhLWV4cGFuZGVkPSJmYWxzZSIgdGFiaW5kZXg9Ii0xIj4nICsNCiAgICAgICAgICAgICAgJzx1bCBjbGFzcz0iZHJvcGRvd24tbWVudSBpbm5lciAnICsgKHZlcnNpb24ubWFqb3IgPT09ICc0JyA/IGNsYXNzTmFtZXMuU0hPVyA6ICcnKSArICciPicgKw0KICAgICAgICAgICAgICAnPC91bD4nICsNCiAgICAgICAgICAnPC9kaXY+JyArDQogICAgICAgICAgZG9uZWJ1dHRvbiArDQogICAgICAgICAgJzwvZGl2PicgKw0KICAgICAgICAgICc8L2Rpdj4nOw0KDQogICAgICByZXR1cm4gJChkcm9wKTsNCiAgICB9LA0KDQogICAgc2V0UG9zaXRpb25EYXRhOiBmdW5jdGlvbiAoKSB7DQogICAgICB0aGlzLnNlbGVjdHBpY2tlci52aWV3LmNhbkhpZ2hsaWdodCA9IFtdOw0KDQogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuc2VsZWN0cGlja2VyLmN1cnJlbnQuZGF0YS5sZW5ndGg7IGkrKykgew0KICAgICAgICB2YXIgbGkgPSB0aGlzLnNlbGVjdHBpY2tlci5jdXJyZW50LmRhdGFbaV0sDQogICAgICAgICAgICBjYW5IaWdobGlnaHQgPSB0cnVlOw0KDQogICAgICAgIGlmIChsaS50eXBlID09PSAnZGl2aWRlcicpIHsNCiAgICAgICAgICBjYW5IaWdobGlnaHQgPSBmYWxzZTsNCiAgICAgICAgICBsaS5oZWlnaHQgPSB0aGlzLnNpemVJbmZvLmRpdmlkZXJIZWlnaHQ7DQogICAgICAgIH0gZWxzZSBpZiAobGkudHlwZSA9PT0gJ29wdGdyb3VwLWxhYmVsJykgew0KICAgICAgICAgIGNhbkhpZ2hsaWdodCA9IGZhbHNlOw0KICAgICAgICAgIGxpLmhlaWdodCA9IHRoaXMuc2l6ZUluZm8uZHJvcGRvd25IZWFkZXJIZWlnaHQ7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgbGkuaGVpZ2h0ID0gdGhpcy5zaXplSW5mby5saUhlaWdodDsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChsaS5kaXNhYmxlZCkgY2FuSGlnaGxpZ2h0ID0gZmFsc2U7DQoNCiAgICAgICAgdGhpcy5zZWxlY3RwaWNrZXIudmlldy5jYW5IaWdobGlnaHQucHVzaChjYW5IaWdobGlnaHQpOw0KDQogICAgICAgIGxpLnBvc2l0aW9uID0gKGkgPT09IDAgPyAwIDogdGhpcy5zZWxlY3RwaWNrZXIuY3VycmVudC5kYXRhW2kgLSAxXS5wb3NpdGlvbikgKyBsaS5oZWlnaHQ7DQogICAgICB9DQogICAgfSwNCg0KICAgIGlzVmlydHVhbDogZnVuY3Rpb24gKCkgew0KICAgICAgcmV0dXJuICh0aGlzLm9wdGlvbnMudmlydHVhbFNjcm9sbCAhPT0gZmFsc2UpICYmIHRoaXMuc2VsZWN0cGlja2VyLm1haW4uZWxlbWVudHMubGVuZ3RoID49IHRoaXMub3B0aW9ucy52aXJ0dWFsU2Nyb2xsIHx8IHRoaXMub3B0aW9ucy52aXJ0dWFsU2Nyb2xsID09PSB0cnVlOw0KICAgIH0sDQoNCiAgICBjcmVhdGVWaWV3OiBmdW5jdGlvbiAoaXNTZWFyY2hpbmcsIHNjcm9sbFRvcCkgew0KICAgICAgc2Nyb2xsVG9wID0gc2Nyb2xsVG9wIHx8IDA7DQoNCiAgICAgIHZhciB0aGF0ID0gdGhpczsNCg0KICAgICAgdGhpcy5zZWxlY3RwaWNrZXIuY3VycmVudCA9IGlzU2VhcmNoaW5nID8gdGhpcy5zZWxlY3RwaWNrZXIuc2VhcmNoIDogdGhpcy5zZWxlY3RwaWNrZXIubWFpbjsNCg0KICAgICAgdmFyICRsaXM7DQogICAgICB2YXIgYWN0aXZlID0gW107DQogICAgICB2YXIgc2VsZWN0ZWQ7DQogICAgICB2YXIgcHJldkFjdGl2ZTsNCiAgICAgIHZhciBhY3RpdmVJbmRleDsNCiAgICAgIHZhciBwcmV2QWN0aXZlSW5kZXg7DQoNCiAgICAgIHRoaXMuc2V0UG9zaXRpb25EYXRhKCk7DQoNCiAgICAgIHNjcm9sbChzY3JvbGxUb3AsIHRydWUpOw0KDQogICAgICB0aGlzLiRtZW51SW5uZXIub2ZmKCdzY3JvbGwuY3JlYXRlVmlldycpLm9uKCdzY3JvbGwuY3JlYXRlVmlldycsIGZ1bmN0aW9uIChlLCB1cGRhdGVWYWx1ZSkgew0KICAgICAgICBpZiAoIXRoYXQubm9TY3JvbGwpIHNjcm9sbCh0aGlzLnNjcm9sbFRvcCwgdXBkYXRlVmFsdWUpOw0KICAgICAgICB0aGF0Lm5vU2Nyb2xsID0gZmFsc2U7DQogICAgICB9KTsNCg0KICAgICAgZnVuY3Rpb24gc2Nyb2xsKHNjcm9sbFRvcCwgaW5pdCkgew0KICAgICAgICB2YXIgc2l6ZSA9IHRoYXQuc2VsZWN0cGlja2VyLmN1cnJlbnQuZWxlbWVudHMubGVuZ3RoLA0KICAgICAgICAgICAgY2h1bmtzID0gW10sDQogICAgICAgICAgICBjaHVua1NpemUsDQogICAgICAgICAgICBjaHVua0NvdW50LA0KICAgICAgICAgICAgZmlyc3RDaHVuaywNCiAgICAgICAgICAgIGxhc3RDaHVuaywNCiAgICAgICAgICAgIGN1cnJlbnRDaHVuayA9IHVuZGVmaW5lZCwNCiAgICAgICAgICAgIHByZXZQb3NpdGlvbnMsDQogICAgICAgICAgICBwb3NpdGlvbklzRGlmZmVyZW50LA0KICAgICAgICAgICAgcHJldmlvdXNFbGVtZW50cywNCiAgICAgICAgICAgIG1lbnVJc0RpZmZlcmVudCA9IHRydWUsDQogICAgICAgICAgICBpc1ZpcnR1YWwgPSB0aGF0LmlzVmlydHVhbCgpOw0KDQogICAgICAgIHRoYXQuc2VsZWN0cGlja2VyLnZpZXcuc2Nyb2xsVG9wID0gc2Nyb2xsVG9wOw0KDQogICAgICAgIGlmIChpc1ZpcnR1YWwgPT09IHRydWUpIHsNCiAgICAgICAgICAvLyBpZiBhbiBvcHRpb24gdGhhdCBpcyBlbmNvdW50ZXJlZCB0aGF0IGlzIHdpZGVyIHRoYW4gdGhlIGN1cnJlbnQgbWVudSB3aWR0aCwgdXBkYXRlIHRoZSBtZW51IHdpZHRoIGFjY29yZGluZ2x5DQogICAgICAgICAgaWYgKHRoYXQuc2l6ZUluZm8uaGFzU2Nyb2xsQmFyICYmIHRoYXQuJG1lbnVbMF0ub2Zmc2V0V2lkdGggPiB0aGF0LnNpemVJbmZvLnRvdGFsTWVudVdpZHRoKSB7DQogICAgICAgICAgICB0aGF0LnNpemVJbmZvLm1lbnVXaWR0aCA9IHRoYXQuJG1lbnVbMF0ub2Zmc2V0V2lkdGg7DQogICAgICAgICAgICB0aGF0LnNpemVJbmZvLnRvdGFsTWVudVdpZHRoID0gdGhhdC5zaXplSW5mby5tZW51V2lkdGggKyB0aGF0LnNpemVJbmZvLnNjcm9sbEJhcldpZHRoOw0KICAgICAgICAgICAgdGhhdC4kbWVudS5jc3MoJ21pbi13aWR0aCcsIHRoYXQuc2l6ZUluZm8ubWVudVdpZHRoKTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBjaHVua1NpemUgPSBNYXRoLmNlaWwodGhhdC5zaXplSW5mby5tZW51SW5uZXJIZWlnaHQgLyB0aGF0LnNpemVJbmZvLmxpSGVpZ2h0ICogMS41KTsgLy8gbnVtYmVyIG9mIG9wdGlvbnMgaW4gYSBjaHVuaw0KICAgICAgICBjaHVua0NvdW50ID0gTWF0aC5yb3VuZChzaXplIC8gY2h1bmtTaXplKSB8fCAxOyAvLyBudW1iZXIgb2YgY2h1bmtzDQoNCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaHVua0NvdW50OyBpKyspIHsNCiAgICAgICAgICB2YXIgZW5kX29mX2NodW5rID0gKGkgKyAxKSAqIGNodW5rU2l6ZTsNCg0KICAgICAgICAgIGlmIChpID09PSBjaHVua0NvdW50IC0gMSkgew0KICAgICAgICAgICAgZW5kX29mX2NodW5rID0gc2l6ZTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICBjaHVua3NbaV0gPSBbDQogICAgICAgICAgICAoaSkgKiBjaHVua1NpemUgKyAoIWkgPyAwIDogMSksDQogICAgICAgICAgICBlbmRfb2ZfY2h1bmsNCiAgICAgICAgICBdOw0KDQogICAgICAgICAgaWYgKCFzaXplKSBicmVhazsNCg0KICAgICAgICAgIGlmIChjdXJyZW50Q2h1bmsgPT09IHVuZGVmaW5lZCAmJiBzY3JvbGxUb3AgPD0gdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5kYXRhW2VuZF9vZl9jaHVuayAtIDFdLnBvc2l0aW9uIC0gdGhhdC5zaXplSW5mby5tZW51SW5uZXJIZWlnaHQpIHsNCiAgICAgICAgICAgIGN1cnJlbnRDaHVuayA9IGk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGN1cnJlbnRDaHVuayA9PT0gdW5kZWZpbmVkKSBjdXJyZW50Q2h1bmsgPSAwOw0KDQogICAgICAgIHByZXZQb3NpdGlvbnMgPSBbdGhhdC5zZWxlY3RwaWNrZXIudmlldy5wb3NpdGlvbjAsIHRoYXQuc2VsZWN0cGlja2VyLnZpZXcucG9zaXRpb24xXTsNCg0KICAgICAgICAvLyBhbHdheXMgZGlzcGxheSBwcmV2aW91cywgY3VycmVudCwgYW5kIG5leHQgY2h1bmtzDQogICAgICAgIGZpcnN0Q2h1bmsgPSBNYXRoLm1heCgwLCBjdXJyZW50Q2h1bmsgLSAxKTsNCiAgICAgICAgbGFzdENodW5rID0gTWF0aC5taW4oY2h1bmtDb3VudCAtIDEsIGN1cnJlbnRDaHVuayArIDEpOw0KDQogICAgICAgIHRoYXQuc2VsZWN0cGlja2VyLnZpZXcucG9zaXRpb24wID0gTWF0aC5tYXgoMCwgY2h1bmtzW2ZpcnN0Q2h1bmtdWzBdKSB8fCAwOw0KICAgICAgICB0aGF0LnNlbGVjdHBpY2tlci52aWV3LnBvc2l0aW9uMSA9IE1hdGgubWluKHNpemUsIGNodW5rc1tsYXN0Q2h1bmtdWzFdKSB8fCAwOw0KDQogICAgICAgIHBvc2l0aW9uSXNEaWZmZXJlbnQgPSBwcmV2UG9zaXRpb25zWzBdICE9PSB0aGF0LnNlbGVjdHBpY2tlci52aWV3LnBvc2l0aW9uMCB8fCBwcmV2UG9zaXRpb25zWzFdICE9PSB0aGF0LnNlbGVjdHBpY2tlci52aWV3LnBvc2l0aW9uMTsNCg0KICAgICAgICBpZiAodGhhdC5hY3RpdmVJbmRleCAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgcHJldkFjdGl2ZSA9IHRoYXQuc2VsZWN0cGlja2VyLmN1cnJlbnQuZWxlbWVudHNbdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5tYXAubmV3SW5kZXhbdGhhdC5wcmV2QWN0aXZlSW5kZXhdXTsNCiAgICAgICAgICBhY3RpdmUgPSB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50LmVsZW1lbnRzW3RoYXQuc2VsZWN0cGlja2VyLmN1cnJlbnQubWFwLm5ld0luZGV4W3RoYXQuYWN0aXZlSW5kZXhdXTsNCiAgICAgICAgICBzZWxlY3RlZCA9IHRoYXQuc2VsZWN0cGlja2VyLmN1cnJlbnQuZWxlbWVudHNbdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5tYXAubmV3SW5kZXhbdGhhdC5zZWxlY3RlZEluZGV4XV07DQoNCiAgICAgICAgICBpZiAoaW5pdCkgew0KICAgICAgICAgICAgaWYgKHRoYXQuYWN0aXZlSW5kZXggIT09IHRoYXQuc2VsZWN0ZWRJbmRleCkgew0KICAgICAgICAgICAgICBhY3RpdmUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7DQogICAgICAgICAgICAgIGlmIChhY3RpdmUuZmlyc3RDaGlsZCkgYWN0aXZlLmZpcnN0Q2hpbGQuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGF0LmFjdGl2ZUluZGV4ID0gdW5kZWZpbmVkOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIGlmICh0aGF0LmFjdGl2ZUluZGV4ICYmIHRoYXQuYWN0aXZlSW5kZXggIT09IHRoYXQuc2VsZWN0ZWRJbmRleCAmJiBzZWxlY3RlZCAmJiBzZWxlY3RlZC5sZW5ndGgpIHsNCiAgICAgICAgICAgIHNlbGVjdGVkLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOw0KICAgICAgICAgICAgaWYgKHNlbGVjdGVkLmZpcnN0Q2hpbGQpIHNlbGVjdGVkLmZpcnN0Q2hpbGQuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKHRoYXQucHJldkFjdGl2ZUluZGV4ICE9PSB1bmRlZmluZWQgJiYgdGhhdC5wcmV2QWN0aXZlSW5kZXggIT09IHRoYXQuYWN0aXZlSW5kZXggJiYgdGhhdC5wcmV2QWN0aXZlSW5kZXggIT09IHRoYXQuc2VsZWN0ZWRJbmRleCAmJiBwcmV2QWN0aXZlICYmIHByZXZBY3RpdmUubGVuZ3RoKSB7DQogICAgICAgICAgcHJldkFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsNCiAgICAgICAgICBpZiAocHJldkFjdGl2ZS5maXJzdENoaWxkKSBwcmV2QWN0aXZlLmZpcnN0Q2hpbGQuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoaW5pdCB8fCBwb3NpdGlvbklzRGlmZmVyZW50KSB7DQogICAgICAgICAgcHJldmlvdXNFbGVtZW50cyA9IHRoYXQuc2VsZWN0cGlja2VyLnZpZXcudmlzaWJsZUVsZW1lbnRzID8gdGhhdC5zZWxlY3RwaWNrZXIudmlldy52aXNpYmxlRWxlbWVudHMuc2xpY2UoKSA6IFtdOw0KDQogICAgICAgICAgdGhhdC5zZWxlY3RwaWNrZXIudmlldy52aXNpYmxlRWxlbWVudHMgPSB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50LmVsZW1lbnRzLnNsaWNlKHRoYXQuc2VsZWN0cGlja2VyLnZpZXcucG9zaXRpb24wLCB0aGF0LnNlbGVjdHBpY2tlci52aWV3LnBvc2l0aW9uMSk7DQoNCiAgICAgICAgICB0aGF0LnNldE9wdGlvblN0YXR1cygpOw0KDQogICAgICAgICAgLy8gaWYgc2VhcmNoaW5nLCBjaGVjayB0byBtYWtlIHN1cmUgdGhlIGxpc3QgaGFzIGFjdHVhbGx5IGJlZW4gdXBkYXRlZCBiZWZvcmUgdXBkYXRpbmcgRE9NDQogICAgICAgICAgLy8gdGhpcyBwcmV2ZW50cyB1bm5lY2Vzc2FyeSByZXBhaW50cw0KICAgICAgICAgIGlmICggaXNTZWFyY2hpbmcgfHwgKGlzVmlydHVhbCA9PT0gZmFsc2UgJiYgaW5pdCkgKSBtZW51SXNEaWZmZXJlbnQgPSAhaXNFcXVhbChwcmV2aW91c0VsZW1lbnRzLCB0aGF0LnNlbGVjdHBpY2tlci52aWV3LnZpc2libGVFbGVtZW50cyk7DQoNCiAgICAgICAgICAvLyBpZiB2aXJ0dWFsIHNjcm9sbCBpcyBkaXNhYmxlZCBhbmQgbm90IHNlYXJjaGluZywNCiAgICAgICAgICAvLyBtZW51IHNob3VsZCBuZXZlciBuZWVkIHRvIGJlIHVwZGF0ZWQgbW9yZSB0aGFuIG9uY2UNCiAgICAgICAgICBpZiAoIChpbml0IHx8IGlzVmlydHVhbCA9PT0gdHJ1ZSkgJiYgbWVudUlzRGlmZmVyZW50ICkgew0KICAgICAgICAgICAgdmFyIG1lbnVJbm5lciA9IHRoYXQuJG1lbnVJbm5lclswXSwNCiAgICAgICAgICAgICAgICBtZW51RnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksDQogICAgICAgICAgICAgICAgZW1wdHlNZW51ID0gbWVudUlubmVyLmZpcnN0Q2hpbGQuY2xvbmVOb2RlKGZhbHNlKSwNCiAgICAgICAgICAgICAgICBtYXJnaW5Ub3AsDQogICAgICAgICAgICAgICAgbWFyZ2luQm90dG9tLA0KICAgICAgICAgICAgICAgIGVsZW1lbnRzID0gaXNWaXJ0dWFsID09PSB0cnVlID8gdGhhdC5zZWxlY3RwaWNrZXIudmlldy52aXNpYmxlRWxlbWVudHMgOiB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50LmVsZW1lbnRzOw0KDQogICAgICAgICAgICAvLyByZXBsYWNlIHRoZSBleGlzdGluZyBVTCB3aXRoIGFuIGVtcHR5IG9uZSAtIHRoaXMgaXMgZmFzdGVyIHRoYW4gJC5lbXB0eSgpDQogICAgICAgICAgICBtZW51SW5uZXIucmVwbGFjZUNoaWxkKGVtcHR5TWVudSwgbWVudUlubmVyLmZpcnN0Q2hpbGQpOw0KDQogICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgdmlzaWJsZUVsZW1lbnRzTGVuID0gZWxlbWVudHMubGVuZ3RoOyBpIDwgdmlzaWJsZUVsZW1lbnRzTGVuOyBpKyspIHsNCiAgICAgICAgICAgICAgbWVudUZyYWdtZW50LmFwcGVuZENoaWxkKGVsZW1lbnRzW2ldKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKGlzVmlydHVhbCA9PT0gdHJ1ZSkgew0KICAgICAgICAgICAgICBtYXJnaW5Ub3AgPSAodGhhdC5zZWxlY3RwaWNrZXIudmlldy5wb3NpdGlvbjAgPT09IDAgPyAwIDogdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5kYXRhW3RoYXQuc2VsZWN0cGlja2VyLnZpZXcucG9zaXRpb24wIC0gMV0ucG9zaXRpb24pLA0KICAgICAgICAgICAgICBtYXJnaW5Cb3R0b20gPSAodGhhdC5zZWxlY3RwaWNrZXIudmlldy5wb3NpdGlvbjEgPiBzaXplIC0gMSA/IDAgOiB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50LmRhdGFbc2l6ZSAtIDFdLnBvc2l0aW9uIC0gdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5kYXRhW3RoYXQuc2VsZWN0cGlja2VyLnZpZXcucG9zaXRpb24xIC0gMV0ucG9zaXRpb24pOw0KDQogICAgICAgICAgICAgIG1lbnVJbm5lci5maXJzdENoaWxkLnN0eWxlLm1hcmdpblRvcCA9IG1hcmdpblRvcCArICdweCc7DQogICAgICAgICAgICAgIG1lbnVJbm5lci5maXJzdENoaWxkLnN0eWxlLm1hcmdpbkJvdHRvbSA9IG1hcmdpbkJvdHRvbSArICdweCc7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIG1lbnVJbm5lci5maXJzdENoaWxkLmFwcGVuZENoaWxkKG1lbnVGcmFnbWVudCk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgdGhhdC5wcmV2QWN0aXZlSW5kZXggPSB0aGF0LmFjdGl2ZUluZGV4Ow0KDQogICAgICAgIGlmICghdGhhdC5vcHRpb25zLmxpdmVTZWFyY2gpIHsNCiAgICAgICAgICB0aGF0LiRtZW51SW5uZXIuZm9jdXMoKTsNCiAgICAgICAgfSBlbHNlIGlmIChpc1NlYXJjaGluZyAmJiBpbml0KSB7DQogICAgICAgICAgdmFyIGluZGV4ID0gMCwNCiAgICAgICAgICAgICAgbmV3QWN0aXZlOw0KDQogICAgICAgICAgaWYgKCF0aGF0LnNlbGVjdHBpY2tlci52aWV3LmNhbkhpZ2hsaWdodFtpbmRleF0pIHsNCiAgICAgICAgICAgIGluZGV4ID0gMSArIHRoYXQuc2VsZWN0cGlja2VyLnZpZXcuY2FuSGlnaGxpZ2h0LnNsaWNlKDEpLmluZGV4T2YodHJ1ZSk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgbmV3QWN0aXZlID0gdGhhdC5zZWxlY3RwaWNrZXIudmlldy52aXNpYmxlRWxlbWVudHNbaW5kZXhdOw0KDQogICAgICAgICAgaWYgKHRoYXQuc2VsZWN0cGlja2VyLnZpZXcuY3VycmVudEFjdGl2ZSkgew0KICAgICAgICAgICAgdGhhdC5zZWxlY3RwaWNrZXIudmlldy5jdXJyZW50QWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOw0KICAgICAgICAgICAgaWYgKHRoYXQuc2VsZWN0cGlja2VyLnZpZXcuY3VycmVudEFjdGl2ZS5maXJzdENoaWxkKSB0aGF0LnNlbGVjdHBpY2tlci52aWV3LmN1cnJlbnRBY3RpdmUuZmlyc3RDaGlsZC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICBpZiAobmV3QWN0aXZlKSB7DQogICAgICAgICAgICBuZXdBY3RpdmUuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7DQogICAgICAgICAgICBpZiAobmV3QWN0aXZlLmZpcnN0Q2hpbGQpIG5ld0FjdGl2ZS5maXJzdENoaWxkLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIHRoYXQuYWN0aXZlSW5kZXggPSB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50Lm1hcC5vcmlnaW5hbEluZGV4W2luZGV4XTsNCiAgICAgICAgfQ0KICAgICAgfQ0KDQogICAgICAkKHdpbmRvdykub2ZmKCdyZXNpemUuY3JlYXRlVmlldycpLm9uKCdyZXNpemUuY3JlYXRlVmlldycsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgc2Nyb2xsKHRoYXQuJG1lbnVJbm5lclswXS5zY3JvbGxUb3ApOw0KICAgICAgfSk7DQogICAgfSwNCg0KICAgIGNyZWF0ZUxpOiBmdW5jdGlvbiAoKSB7DQogICAgICB2YXIgdGhhdCA9IHRoaXMsDQogICAgICAgICAgbWFpbkVsZW1lbnRzID0gW10sDQogICAgICAgICAgd2lkZXN0T3B0aW9uLA0KICAgICAgICAgIGF2YWlsYWJsZU9wdGlvbnNDb3VudCA9IDAsDQogICAgICAgICAgd2lkZXN0T3B0aW9uTGVuZ3RoID0gMCwNCiAgICAgICAgICBtYWluRGF0YSA9IFtdLA0KICAgICAgICAgIG9wdElEID0gMCwNCiAgICAgICAgICBoZWFkZXJJbmRleCA9IDAsDQogICAgICAgICAgbGlJbmRleCA9IC0xOyAvLyBpbmNyZW1lbnQgbGlJbmRleCB3aGVuZXZlciBhIG5ldyA8bGk+IGVsZW1lbnQgaXMgY3JlYXRlZCB0byBlbnN1cmUgbmV3SW5kZXggaXMgY29ycmVjdA0KDQogICAgICBpZiAoIXRoaXMuc2VsZWN0cGlja2VyLnZpZXcudGl0bGVPcHRpb24pIHRoaXMuc2VsZWN0cGlja2VyLnZpZXcudGl0bGVPcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTsNCg0KICAgICAgdmFyIGVsZW1lbnRUZW1wbGF0ZXMgPSB7DQogICAgICAgICAgc3BhbjogZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpLA0KICAgICAgICAgIHN1YnRleHQ6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NtYWxsJyksDQogICAgICAgICAgYTogZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpLA0KICAgICAgICAgIGxpOiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpLA0KICAgICAgICAgIHdoaXRlc3BhY2U6IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCJcdTAwQTAiKQ0KICAgICAgICB9LA0KICAgICAgICBjaGVja01hcmsgPSBlbGVtZW50VGVtcGxhdGVzLnNwYW4uY2xvbmVOb2RlKGZhbHNlKSwNCiAgICAgICAgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7DQoNCiAgICAgIGNoZWNrTWFyay5jbGFzc05hbWUgPSB0aGF0Lm9wdGlvbnMuaWNvbkJhc2UgKyAnICcgKyB0aGF0Lm9wdGlvbnMudGlja0ljb24gKyAnIGNoZWNrLW1hcmsnOw0KICAgICAgZWxlbWVudFRlbXBsYXRlcy5hLmFwcGVuZENoaWxkKGNoZWNrTWFyayk7DQogICAgICBlbGVtZW50VGVtcGxhdGVzLmEuc2V0QXR0cmlidXRlKCdyb2xlJywgJ29wdGlvbicpOw0KDQogICAgICBlbGVtZW50VGVtcGxhdGVzLnN1YnRleHQuY2xhc3NOYW1lID0gJ3RleHQtbXV0ZWQnOw0KDQogICAgICBlbGVtZW50VGVtcGxhdGVzLnRleHQgPSBlbGVtZW50VGVtcGxhdGVzLnNwYW4uY2xvbmVOb2RlKGZhbHNlKTsNCiAgICAgIGVsZW1lbnRUZW1wbGF0ZXMudGV4dC5jbGFzc05hbWUgPSAndGV4dCc7DQoNCiAgICAgIC8vIEhlbHBlciBmdW5jdGlvbnMNCiAgICAgIC8qKg0KICAgICAgICogQHBhcmFtIGNvbnRlbnQNCiAgICAgICAqIEBwYXJhbSBbaW5kZXhdDQogICAgICAgKiBAcGFyYW0gW2NsYXNzZXNdDQogICAgICAgKiBAcGFyYW0gW29wdGdyb3VwXQ0KICAgICAgICogQHJldHVybnMge0hUTUxFbGVtZW50fQ0KICAgICAgICovDQogICAgICB2YXIgZ2VuZXJhdGVMSSA9IGZ1bmN0aW9uIChjb250ZW50LCBpbmRleCwgY2xhc3Nlcywgb3B0Z3JvdXApIHsNCiAgICAgICAgdmFyIGxpID0gZWxlbWVudFRlbXBsYXRlcy5saS5jbG9uZU5vZGUoZmFsc2UpOw0KDQogICAgICAgIGlmIChjb250ZW50KSB7DQogICAgICAgICAgaWYgKGNvbnRlbnQubm9kZVR5cGUgPT09IDEgfHwgY29udGVudC5ub2RlVHlwZSA9PT0gMTEpIHsNCiAgICAgICAgICAgIGxpLmFwcGVuZENoaWxkKGNvbnRlbnQpOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBsaS5pbm5lckhUTUwgPSBjb250ZW50Ow0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmICh0eXBlb2YgY2xhc3NlcyAhPT0gJ3VuZGVmaW5lZCcgJiYgJycgIT09IGNsYXNzZXMpIGxpLmNsYXNzTmFtZSA9IGNsYXNzZXM7DQogICAgICAgIGlmICh0eXBlb2Ygb3B0Z3JvdXAgIT09ICd1bmRlZmluZWQnICYmIG51bGwgIT09IG9wdGdyb3VwKSBsaS5jbGFzc0xpc3QuYWRkKCdvcHRncm91cC0nICsgb3B0Z3JvdXApOw0KDQogICAgICAgIHJldHVybiBsaTsNCiAgICAgIH07DQoNCiAgICAgIC8qKg0KICAgICAgICogQHBhcmFtIHRleHQNCiAgICAgICAqIEBwYXJhbSBbY2xhc3Nlc10NCiAgICAgICAqIEBwYXJhbSBbaW5saW5lXQ0KICAgICAgICogQHJldHVybnMge3N0cmluZ30NCiAgICAgICAqLw0KICAgICAgdmFyIGdlbmVyYXRlQSA9IGZ1bmN0aW9uICh0ZXh0LCBjbGFzc2VzLCBpbmxpbmUpIHsNCiAgICAgICAgdmFyIGEgPSBlbGVtZW50VGVtcGxhdGVzLmEuY2xvbmVOb2RlKHRydWUpOw0KDQogICAgICAgIGlmICh0ZXh0KSB7DQogICAgICAgICAgaWYgKHRleHQubm9kZVR5cGUgPT09IDExKSB7DQogICAgICAgICAgICBhLmFwcGVuZENoaWxkKHRleHQpOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBhLmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgdGV4dCk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKHR5cGVvZiBjbGFzc2VzICE9PSAndW5kZWZpbmVkJyAmICcnICE9PSBjbGFzc2VzKSBhLmNsYXNzTmFtZSA9IGNsYXNzZXM7DQogICAgICAgIGlmICh2ZXJzaW9uLm1ham9yID09PSAnNCcpIGEuY2xhc3NMaXN0LmFkZCgnZHJvcGRvd24taXRlbScpOw0KICAgICAgICBpZiAoaW5saW5lKSBhLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBpbmxpbmUpOw0KDQogICAgICAgIHJldHVybiBhOw0KICAgICAgfTsNCg0KICAgICAgdmFyIGdlbmVyYXRlVGV4dCA9IGZ1bmN0aW9uIChvcHRpb25zKSB7DQogICAgICAgIHZhciB0ZXh0RWxlbWVudCA9IGVsZW1lbnRUZW1wbGF0ZXMudGV4dC5jbG9uZU5vZGUoZmFsc2UpLA0KICAgICAgICAgICAgb3B0aW9uU3VidGV4dEVsZW1lbnQsDQogICAgICAgICAgICBvcHRpb25JY29uRWxlbWVudDsNCg0KICAgICAgICBpZiAob3B0aW9ucy5vcHRpb25Db250ZW50KSB7DQogICAgICAgICAgdGV4dEVsZW1lbnQuaW5uZXJIVE1MID0gb3B0aW9ucy5vcHRpb25Db250ZW50Ow0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRleHRFbGVtZW50LnRleHRDb250ZW50ID0gb3B0aW9ucy50ZXh0Ow0KDQogICAgICAgICAgaWYgKG9wdGlvbnMub3B0aW9uSWNvbikgew0KICAgICAgICAgICAgdmFyIHdoaXRlc3BhY2UgPSBlbGVtZW50VGVtcGxhdGVzLndoaXRlc3BhY2UuY2xvbmVOb2RlKGZhbHNlKTsNCg0KICAgICAgICAgICAgb3B0aW9uSWNvbkVsZW1lbnQgPSBlbGVtZW50VGVtcGxhdGVzLnNwYW4uY2xvbmVOb2RlKGZhbHNlKTsNCiAgICAgICAgICAgIG9wdGlvbkljb25FbGVtZW50LmNsYXNzTmFtZSA9IHRoYXQub3B0aW9ucy5pY29uQmFzZSArICcgJyArIG9wdGlvbnMub3B0aW9uSWNvbjsNCg0KICAgICAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQob3B0aW9uSWNvbkVsZW1lbnQpOw0KICAgICAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQod2hpdGVzcGFjZSk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgaWYgKG9wdGlvbnMub3B0aW9uU3VidGV4dCkgew0KICAgICAgICAgICAgb3B0aW9uU3VidGV4dEVsZW1lbnQgPSBlbGVtZW50VGVtcGxhdGVzLnN1YnRleHQuY2xvbmVOb2RlKGZhbHNlKTsNCiAgICAgICAgICAgIG9wdGlvblN1YnRleHRFbGVtZW50LmlubmVySFRNTCA9IG9wdGlvbnMub3B0aW9uU3VidGV4dDsNCiAgICAgICAgICAgIHRleHRFbGVtZW50LmFwcGVuZENoaWxkKG9wdGlvblN1YnRleHRFbGVtZW50KTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZCh0ZXh0RWxlbWVudCk7DQoNCiAgICAgICAgcmV0dXJuIGZyYWdtZW50Ow0KICAgICAgfTsNCg0KICAgICAgdmFyIGdlbmVyYXRlTGFiZWwgPSBmdW5jdGlvbiAob3B0aW9ucykgew0KICAgICAgICB2YXIgbGFiZWxUZXh0RWxlbWVudCA9IGVsZW1lbnRUZW1wbGF0ZXMudGV4dC5jbG9uZU5vZGUoZmFsc2UpLA0KICAgICAgICAgICAgbGFiZWxTdWJ0ZXh0RWxlbWVudCwNCiAgICAgICAgICAgIGxhYmVsSWNvbkVsZW1lbnQ7DQoNCiAgICAgICAgbGFiZWxUZXh0RWxlbWVudC50ZXh0Q29udGVudCA9IG9wdGlvbnMubGFiZWxFc2NhcGVkOw0KDQogICAgICAgIGlmIChvcHRpb25zLmxhYmVsSWNvbikgew0KICAgICAgICAgIHZhciB3aGl0ZXNwYWNlID0gZWxlbWVudFRlbXBsYXRlcy53aGl0ZXNwYWNlLmNsb25lTm9kZShmYWxzZSk7DQoNCiAgICAgICAgICBsYWJlbEljb25FbGVtZW50ID0gZWxlbWVudFRlbXBsYXRlcy5zcGFuLmNsb25lTm9kZShmYWxzZSk7DQogICAgICAgICAgbGFiZWxJY29uRWxlbWVudC5jbGFzc05hbWUgPSB0aGF0Lm9wdGlvbnMuaWNvbkJhc2UgKyAnICcgKyBvcHRpb25zLmxhYmVsSWNvbjsNCg0KICAgICAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKGxhYmVsSWNvbkVsZW1lbnQpOw0KICAgICAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKHdoaXRlc3BhY2UpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKG9wdGlvbnMubGFiZWxTdWJ0ZXh0KSB7DQogICAgICAgICAgbGFiZWxTdWJ0ZXh0RWxlbWVudCA9IGVsZW1lbnRUZW1wbGF0ZXMuc3VidGV4dC5jbG9uZU5vZGUoZmFsc2UpOw0KICAgICAgICAgIGxhYmVsU3VidGV4dEVsZW1lbnQudGV4dENvbnRlbnQgPSBvcHRpb25zLmxhYmVsU3VidGV4dDsNCiAgICAgICAgICBsYWJlbFRleHRFbGVtZW50LmFwcGVuZENoaWxkKGxhYmVsU3VidGV4dEVsZW1lbnQpOw0KICAgICAgICB9DQoNCiAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQobGFiZWxUZXh0RWxlbWVudCk7DQoNCiAgICAgICAgcmV0dXJuIGZyYWdtZW50Ow0KICAgICAgfQ0KDQogICAgICBpZiAodGhpcy5vcHRpb25zLnRpdGxlICYmICF0aGlzLm11bHRpcGxlKSB7DQogICAgICAgIC8vIHRoaXMgb3B0aW9uIGRvZXNuJ3QgY3JlYXRlIGEgbmV3IDxsaT4gZWxlbWVudCwgYnV0IGRvZXMgYWRkIGEgbmV3IG9wdGlvbiwgc28gbGlJbmRleCBpcyBkZWNyZWFzZWQNCiAgICAgICAgLy8gc2luY2UgbmV3SW5kZXggaXMgcmVjYWxjdWxhdGVkIG9uIGV2ZXJ5IHJlZnJlc2gsIGxpSW5kZXggbmVlZHMgdG8gYmUgZGVjcmVhc2VkIGV2ZW4gaWYgdGhlIHRpdGxlT3B0aW9uIGlzIGFscmVhZHkgYXBwZW5kZWQNCiAgICAgICAgbGlJbmRleC0tOw0KDQogICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy4kZWxlbWVudFswXSwNCiAgICAgICAgICAgIGlzU2VsZWN0ZWQgPSBmYWxzZSwNCiAgICAgICAgICAgIHRpdGxlTm90QXBwZW5kZWQgPSAhdGhpcy5zZWxlY3RwaWNrZXIudmlldy50aXRsZU9wdGlvbi5wYXJlbnROb2RlOw0KDQogICAgICAgIGlmICh0aXRsZU5vdEFwcGVuZGVkKSB7DQogICAgICAgICAgLy8gVXNlIG5hdGl2ZSBKUyB0byBwcmVwZW5kIG9wdGlvbiAoZmFzdGVyKQ0KICAgICAgICAgIHRoaXMuc2VsZWN0cGlja2VyLnZpZXcudGl0bGVPcHRpb24uY2xhc3NOYW1lID0gJ2JzLXRpdGxlLW9wdGlvbic7DQogICAgICAgICAgdGhpcy5zZWxlY3RwaWNrZXIudmlldy50aXRsZU9wdGlvbi52YWx1ZSA9ICcnOw0KDQogICAgICAgICAgLy8gQ2hlY2sgaWYgc2VsZWN0ZWQgb3IgZGF0YS1zZWxlY3RlZCBhdHRyaWJ1dGUgaXMgYWxyZWFkeSBzZXQgb24gYW4gb3B0aW9uLiBJZiBub3QsIHNlbGVjdCB0aGUgdGl0bGVPcHRpb24gb3B0aW9uLg0KICAgICAgICAgIC8vIHRoZSBzZWxlY3RlZCBpdGVtIG1heSBoYXZlIGJlZW4gY2hhbmdlZCBieSB1c2VyIG9yIHByb2dyYW1tYXRpY2FsbHkgYmVmb3JlIHRoZSBib290c3RyYXAgc2VsZWN0IHBsdWdpbiBydW5zLA0KICAgICAgICAgIC8vIGlmIHNvLCB0aGUgc2VsZWN0IHdpbGwgaGF2ZSB0aGUgZGF0YS1zZWxlY3RlZCBhdHRyaWJ1dGUNCiAgICAgICAgICB2YXIgJG9wdCA9ICQoZWxlbWVudC5vcHRpb25zW2VsZW1lbnQuc2VsZWN0ZWRJbmRleF0pOw0KICAgICAgICAgIGlzU2VsZWN0ZWQgPSAkb3B0LmF0dHIoJ3NlbGVjdGVkJykgPT09IHVuZGVmaW5lZCAmJiB0aGlzLiRlbGVtZW50LmRhdGEoJ3NlbGVjdGVkJykgPT09IHVuZGVmaW5lZDsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICh0aXRsZU5vdEFwcGVuZGVkIHx8IHRoaXMuc2VsZWN0cGlja2VyLnZpZXcudGl0bGVPcHRpb24uaW5kZXggIT09IDApIHsNCiAgICAgICAgICBlbGVtZW50Lmluc2VydEJlZm9yZSh0aGlzLnNlbGVjdHBpY2tlci52aWV3LnRpdGxlT3B0aW9uLCBlbGVtZW50LmZpcnN0Q2hpbGQpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gU2V0IHNlbGVjdGVkICphZnRlciogYXBwZW5kaW5nIHRvIHNlbGVjdCwNCiAgICAgICAgLy8gb3RoZXJ3aXNlIHRoZSBvcHRpb24gZG9lc24ndCBnZXQgc2VsZWN0ZWQgaW4gSUUNCiAgICAgICAgLy8gc2V0IHVzaW5nIHNlbGVjdGVkSW5kZXgsIGFzIHNldHRpbmcgdGhlIHNlbGVjdGVkIGF0dHIgdG8gdHJ1ZSBoZXJlIGRvZXNuJ3Qgd29yayBpbiBJRTExDQogICAgICAgIGlmIChpc1NlbGVjdGVkKSBlbGVtZW50LnNlbGVjdGVkSW5kZXggPSAwOw0KICAgICAgfQ0KDQogICAgICB2YXIgJHNlbGVjdE9wdGlvbnMgPSB0aGlzLiRlbGVtZW50LmZpbmQoJ29wdGlvbicpOw0KDQogICAgICAkc2VsZWN0T3B0aW9ucy5lYWNoKGZ1bmN0aW9uIChpbmRleCkgew0KICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpOw0KDQogICAgICAgIGxpSW5kZXgrKzsNCg0KICAgICAgICBpZiAoJHRoaXMuaGFzQ2xhc3MoJ2JzLXRpdGxlLW9wdGlvbicpKSByZXR1cm47DQoNCiAgICAgICAgdmFyIHRoaXNEYXRhID0gJHRoaXMuZGF0YSgpOw0KDQogICAgICAgIC8vIEdldCB0aGUgY2xhc3MgYW5kIHRleHQgZm9yIHRoZSBvcHRpb24NCiAgICAgICAgdmFyIG9wdGlvbkNsYXNzID0gdGhpcy5jbGFzc05hbWUgfHwgJycsDQogICAgICAgICAgICBpbmxpbmUgPSBodG1sRXNjYXBlKHRoaXMuc3R5bGUuY3NzVGV4dCksDQogICAgICAgICAgICBvcHRpb25Db250ZW50ID0gdGhpc0RhdGEuY29udGVudCwNCiAgICAgICAgICAgIHRleHQgPSB0aGlzLnRleHRDb250ZW50LA0KICAgICAgICAgICAgdG9rZW5zID0gdGhpc0RhdGEudG9rZW5zLA0KICAgICAgICAgICAgc3VidGV4dCA9IHRoaXNEYXRhLnN1YnRleHQsDQogICAgICAgICAgICBpY29uID0gdGhpc0RhdGEuaWNvbiwNCiAgICAgICAgICAgICRwYXJlbnQgPSAkdGhpcy5wYXJlbnQoKSwNCiAgICAgICAgICAgIHBhcmVudCA9ICRwYXJlbnRbMF0sDQogICAgICAgICAgICBpc09wdGdyb3VwID0gcGFyZW50LnRhZ05hbWUgPT09ICdPUFRHUk9VUCcsDQogICAgICAgICAgICBpc09wdGdyb3VwRGlzYWJsZWQgPSBpc09wdGdyb3VwICYmIHBhcmVudC5kaXNhYmxlZCwNCiAgICAgICAgICAgIGlzRGlzYWJsZWQgPSB0aGlzLmRpc2FibGVkIHx8IGlzT3B0Z3JvdXBEaXNhYmxlZCwNCiAgICAgICAgICAgIHByZXZIaWRkZW5JbmRleCwNCiAgICAgICAgICAgIHNob3dEaXZpZGVyID0gdGhpcy5wcmV2aW91c0VsZW1lbnRTaWJsaW5nICYmIHRoaXMucHJldmlvdXNFbGVtZW50U2libGluZy50YWdOYW1lID09PSAnT1BUR1JPVVAnLA0KICAgICAgICAgICAgdGV4dEVsZW1lbnQ7DQoNCiAgICAgICAgdmFyIHBhcmVudERhdGEgPSAkcGFyZW50LmRhdGEoKTsNCg0KICAgICAgICBpZiAodGhpc0RhdGEuaGlkZGVuID09PSB0cnVlIHx8IHRoYXQub3B0aW9ucy5oaWRlRGlzYWJsZWQgJiYgKGlzRGlzYWJsZWQgJiYgIWlzT3B0Z3JvdXAgfHwgaXNPcHRncm91cERpc2FibGVkKSkgew0KICAgICAgICAgIC8vIHNldCBwcmV2SGlkZGVuSW5kZXggLSB0aGUgaW5kZXggb2YgdGhlIGZpcnN0IGhpZGRlbiBvcHRpb24gaW4gYSBncm91cCBvZiBoaWRkZW4gb3B0aW9ucw0KICAgICAgICAgIC8vIHVzZWQgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgb3Igbm90IGEgZGl2aWRlciBzaG91bGQgYmUgcGxhY2VkIGFmdGVyIGFuIG9wdGdyb3VwIGlmIHRoZXJlIGFyZQ0KICAgICAgICAgIC8vIGhpZGRlbiBvcHRpb25zIGJldHdlZW4gdGhlIG9wdGdyb3VwIGFuZCB0aGUgZmlyc3QgdmlzaWJsZSBvcHRpb24NCiAgICAgICAgICBwcmV2SGlkZGVuSW5kZXggPSB0aGlzRGF0YS5wcmV2SGlkZGVuSW5kZXg7DQogICAgICAgICAgJHRoaXMubmV4dCgpLmRhdGEoJ3ByZXZIaWRkZW5JbmRleCcsIChwcmV2SGlkZGVuSW5kZXggIT09IHVuZGVmaW5lZCA/IHByZXZIaWRkZW5JbmRleCA6IGluZGV4KSk7DQoNCiAgICAgICAgICBsaUluZGV4LS07DQoNCiAgICAgICAgICAvLyBpZiBwcmV2aW91cyBlbGVtZW50IGlzIG5vdCBhbiBvcHRncm91cA0KICAgICAgICAgIGlmICghc2hvd0RpdmlkZXIpIHsNCiAgICAgICAgICAgIGlmIChwcmV2SGlkZGVuSW5kZXggIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAvLyBzZWxlY3QgdGhlIGVsZW1lbnQgKipiZWZvcmUqKiB0aGUgZmlyc3QgaGlkZGVuIGVsZW1lbnQgaW4gdGhlIGdyb3VwDQogICAgICAgICAgICAgIHZhciBwcmV2SGlkZGVuID0gJHNlbGVjdE9wdGlvbnNbcHJldkhpZGRlbkluZGV4XS5wcmV2aW91c0VsZW1lbnRTaWJsaW5nOw0KICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgaWYgKHByZXZIaWRkZW4gJiYgcHJldkhpZGRlbi50YWdOYW1lID09PSAnT1BUR1JPVVAnICYmICFwcmV2SGlkZGVuLmRpc2FibGVkKSB7DQogICAgICAgICAgICAgICAgc2hvd0RpdmlkZXIgPSB0cnVlOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KDQogICAgICAgICAgaWYgKHNob3dEaXZpZGVyICYmIG1haW5EYXRhW21haW5EYXRhLmxlbmd0aCAtIDFdLnR5cGUgIT09ICdkaXZpZGVyJykgew0KICAgICAgICAgICAgbGlJbmRleCsrOw0KICAgICAgICAgICAgbWFpbkVsZW1lbnRzLnB1c2goDQogICAgICAgICAgICAgIGdlbmVyYXRlTEkoDQogICAgICAgICAgICAgICAgZmFsc2UsDQogICAgICAgICAgICAgICAgbnVsbCwNCiAgICAgICAgICAgICAgICBjbGFzc05hbWVzLkRJVklERVIsDQogICAgICAgICAgICAgICAgb3B0SUQgKyAnZGl2Jw0KICAgICAgICAgICAgICApDQogICAgICAgICAgICApOw0KICAgICAgICAgICAgbWFpbkRhdGEucHVzaCh7DQogICAgICAgICAgICAgIHR5cGU6ICdkaXZpZGVyJywNCiAgICAgICAgICAgICAgb3B0SUQ6IG9wdElELA0KICAgICAgICAgICAgICBvcmlnaW5hbEluZGV4OiBpbmRleA0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGlzT3B0Z3JvdXAgJiYgdGhpc0RhdGEuZGl2aWRlciAhPT0gdHJ1ZSkgew0KICAgICAgICAgIGlmICh0aGF0Lm9wdGlvbnMuaGlkZURpc2FibGVkICYmIGlzRGlzYWJsZWQpIHsNCiAgICAgICAgICAgIGlmIChwYXJlbnREYXRhLmFsbE9wdGlvbnNEaXNhYmxlZCA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgIHZhciAkb3B0aW9ucyA9ICRwYXJlbnQuY2hpbGRyZW4oKTsNCiAgICAgICAgICAgICAgJHBhcmVudC5kYXRhKCdhbGxPcHRpb25zRGlzYWJsZWQnLCAkb3B0aW9ucy5maWx0ZXIoJzpkaXNhYmxlZCcpLmxlbmd0aCA9PT0gJG9wdGlvbnMubGVuZ3RoKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCRwYXJlbnQuZGF0YSgnYWxsT3B0aW9uc0Rpc2FibGVkJykpIHsNCiAgICAgICAgICAgICAgbGlJbmRleC0tOw0KICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KDQogICAgICAgICAgdmFyIG9wdEdyb3VwQ2xhc3MgPSAnICcgKyBwYXJlbnQuY2xhc3NOYW1lIHx8ICcnOw0KDQogICAgICAgICAgaWYgKCF0aGlzLnByZXZpb3VzRWxlbWVudFNpYmxpbmcpIHsgLy8gSXMgaXQgdGhlIGZpcnN0IG9wdGlvbiBvZiB0aGUgb3B0Z3JvdXA/DQogICAgICAgICAgICBvcHRJRCArPSAxOw0KDQogICAgICAgICAgICAvLyBHZXQgdGhlIG9wdCBncm91cCBsYWJlbA0KICAgICAgICAgICAgdmFyIGxhYmVsID0gcGFyZW50LmxhYmVsLA0KICAgICAgICAgICAgICAgIGxhYmVsRXNjYXBlZCA9IGh0bWxFc2NhcGUobGFiZWwpLA0KICAgICAgICAgICAgICAgIGxhYmVsU3VidGV4dCA9IHBhcmVudERhdGEuc3VidGV4dCwNCiAgICAgICAgICAgICAgICBsYWJlbEljb24gPSBwYXJlbnREYXRhLmljb247DQoNCiAgICAgICAgICAgIGlmIChpbmRleCAhPT0gMCAmJiBtYWluRWxlbWVudHMubGVuZ3RoID4gMCkgeyAvLyBJcyBpdCBOT1QgdGhlIGZpcnN0IG9wdGlvbiBvZiB0aGUgc2VsZWN0ICYmIGFyZSB0aGVyZSBlbGVtZW50cyBpbiB0aGUgZHJvcGRvd24/DQogICAgICAgICAgICAgIGxpSW5kZXgrKzsNCiAgICAgICAgICAgICAgbWFpbkVsZW1lbnRzLnB1c2goDQogICAgICAgICAgICAgICAgZ2VuZXJhdGVMSSgNCiAgICAgICAgICAgICAgICAgIGZhbHNlLA0KICAgICAgICAgICAgICAgICAgbnVsbCwNCiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZXMuRElWSURFUiwNCiAgICAgICAgICAgICAgICAgIG9wdElEICsgJ2RpdicNCiAgICAgICAgICAgICAgICApDQogICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgIG1haW5EYXRhLnB1c2goew0KICAgICAgICAgICAgICAgIHR5cGU6ICdkaXZpZGVyJywNCiAgICAgICAgICAgICAgICBvcHRJRDogb3B0SUQsDQogICAgICAgICAgICAgICAgb3JpZ2luYWxJbmRleDogaW5kZXgNCiAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBsaUluZGV4Kys7DQoNCiAgICAgICAgICAgIHZhciBsYWJlbEVsZW1lbnQgPSBnZW5lcmF0ZUxhYmVsKHsNCiAgICAgICAgICAgICAgICAgIGxhYmVsRXNjYXBlZDogbGFiZWxFc2NhcGVkLA0KICAgICAgICAgICAgICAgICAgbGFiZWxTdWJ0ZXh0OiBsYWJlbFN1YnRleHQsDQogICAgICAgICAgICAgICAgICBsYWJlbEljb246IGxhYmVsSWNvbg0KICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBtYWluRWxlbWVudHMucHVzaChnZW5lcmF0ZUxJKGxhYmVsRWxlbWVudCwgbnVsbCwgJ2Ryb3Bkb3duLWhlYWRlcicgKyBvcHRHcm91cENsYXNzLCBvcHRJRCkpOw0KICAgICAgICAgICAgbWFpbkRhdGEucHVzaCh7DQogICAgICAgICAgICAgIGNvbnRlbnQ6IGxhYmVsRXNjYXBlZCwNCiAgICAgICAgICAgICAgc3VidGV4dDogbGFiZWxTdWJ0ZXh0LA0KICAgICAgICAgICAgICB0eXBlOiAnb3B0Z3JvdXAtbGFiZWwnLA0KICAgICAgICAgICAgICBvcHRJRDogb3B0SUQsDQogICAgICAgICAgICAgIG9yaWdpbmFsSW5kZXg6IGluZGV4DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaGVhZGVySW5kZXggPSBsaUluZGV4IC0gMTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmhpZGVEaXNhYmxlZCAmJiBpc0Rpc2FibGVkIHx8IHRoaXNEYXRhLmhpZGRlbiA9PT0gdHJ1ZSkgew0KICAgICAgICAgICAgbGlJbmRleC0tOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIHRleHRFbGVtZW50ID0gZ2VuZXJhdGVUZXh0KHsNCiAgICAgICAgICAgIHRleHQ6IHRleHQsDQogICAgICAgICAgICBvcHRpb25Db250ZW50OiBvcHRpb25Db250ZW50LA0KICAgICAgICAgICAgb3B0aW9uU3VidGV4dDogc3VidGV4dCwNCiAgICAgICAgICAgIG9wdGlvbkljb246IGljb24NCiAgICAgICAgICB9KTsNCg0KICAgICAgICAgIG1haW5FbGVtZW50cy5wdXNoKGdlbmVyYXRlTEkoZ2VuZXJhdGVBKHRleHRFbGVtZW50LCAnb3B0ICcgKyBvcHRpb25DbGFzcyArIG9wdEdyb3VwQ2xhc3MsIGlubGluZSksIGluZGV4LCAnJywgb3B0SUQpKTsNCiAgICAgICAgICBtYWluRGF0YS5wdXNoKHsNCiAgICAgICAgICAgIGNvbnRlbnQ6IG9wdGlvbkNvbnRlbnQgfHwgdGV4dCwNCiAgICAgICAgICAgIHN1YnRleHQ6IHN1YnRleHQsDQogICAgICAgICAgICB0b2tlbnM6IHRva2VucywNCiAgICAgICAgICAgIHR5cGU6ICdvcHRpb24nLA0KICAgICAgICAgICAgb3B0SUQ6IG9wdElELA0KICAgICAgICAgICAgaGVhZGVySW5kZXg6IGhlYWRlckluZGV4LA0KICAgICAgICAgICAgbGFzdEluZGV4OiBoZWFkZXJJbmRleCArIHBhcmVudC5jaGlsZEVsZW1lbnRDb3VudCwNCiAgICAgICAgICAgIG9yaWdpbmFsSW5kZXg6IGluZGV4LA0KICAgICAgICAgICAgZGF0YTogdGhpc0RhdGENCiAgICAgICAgICB9KTsNCg0KICAgICAgICAgIGF2YWlsYWJsZU9wdGlvbnNDb3VudCsrOw0KICAgICAgICB9IGVsc2UgaWYgKHRoaXNEYXRhLmRpdmlkZXIgPT09IHRydWUpIHsNCiAgICAgICAgICBtYWluRWxlbWVudHMucHVzaChnZW5lcmF0ZUxJKGZhbHNlLCBpbmRleCwgJ2RpdmlkZXInKSk7DQogICAgICAgICAgbWFpbkRhdGEucHVzaCh7DQogICAgICAgICAgICB0eXBlOiAnZGl2aWRlcicsDQogICAgICAgICAgICBvcmlnaW5hbEluZGV4OiBpbmRleA0KICAgICAgICAgIH0pOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIC8vIGlmIHByZXZpb3VzIGVsZW1lbnQgaXMgbm90IGFuIG9wdGdyb3VwIGFuZCBoaWRlRGlzYWJsZWQgaXMgdHJ1ZQ0KICAgICAgICAgIGlmICghc2hvd0RpdmlkZXIgJiYgdGhhdC5vcHRpb25zLmhpZGVEaXNhYmxlZCkgew0KICAgICAgICAgICAgcHJldkhpZGRlbkluZGV4ID0gdGhpc0RhdGEucHJldkhpZGRlbkluZGV4Ow0KDQogICAgICAgICAgICBpZiAocHJldkhpZGRlbkluZGV4ICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgLy8gc2VsZWN0IHRoZSBlbGVtZW50ICoqYmVmb3JlKiogdGhlIGZpcnN0IGhpZGRlbiBlbGVtZW50IGluIHRoZSBncm91cA0KICAgICAgICAgICAgICB2YXIgcHJldkhpZGRlbiA9ICRzZWxlY3RPcHRpb25zW3ByZXZIaWRkZW5JbmRleF0ucHJldmlvdXNFbGVtZW50U2libGluZzsNCiAgICAgICAgICAgICAgDQogICAgICAgICAgICAgIGlmIChwcmV2SGlkZGVuICYmIHByZXZIaWRkZW4udGFnTmFtZSA9PT0gJ09QVEdST1VQJyAmJiAhcHJldkhpZGRlbi5kaXNhYmxlZCkgew0KICAgICAgICAgICAgICAgIHNob3dEaXZpZGVyID0gdHJ1ZTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KICAgICAgICAgIGlmIChzaG93RGl2aWRlciAmJiBtYWluRGF0YVttYWluRGF0YS5sZW5ndGggLSAxXS50eXBlICE9PSAnZGl2aWRlcicpIHsNCiAgICAgICAgICAgIGxpSW5kZXgrKzsNCiAgICAgICAgICAgIG1haW5FbGVtZW50cy5wdXNoKA0KICAgICAgICAgICAgICBnZW5lcmF0ZUxJKA0KICAgICAgICAgICAgICAgIGZhbHNlLA0KICAgICAgICAgICAgICAgIG51bGwsDQogICAgICAgICAgICAgICAgY2xhc3NOYW1lcy5ESVZJREVSLA0KICAgICAgICAgICAgICAgIG9wdElEICsgJ2RpdicNCiAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgKTsNCiAgICAgICAgICAgIG1haW5EYXRhLnB1c2goew0KICAgICAgICAgICAgICB0eXBlOiAnZGl2aWRlcicsDQogICAgICAgICAgICAgIG9wdElEOiBvcHRJRCwNCiAgICAgICAgICAgICAgb3JpZ2luYWxJbmRleDogaW5kZXgNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIHRleHRFbGVtZW50ID0gZ2VuZXJhdGVUZXh0KHsNCiAgICAgICAgICAgIHRleHQ6IHRleHQsDQogICAgICAgICAgICBvcHRpb25Db250ZW50OiBvcHRpb25Db250ZW50LA0KICAgICAgICAgICAgb3B0aW9uU3VidGV4dDogc3VidGV4dCwNCiAgICAgICAgICAgIG9wdGlvbkljb246IGljb24NCiAgICAgICAgICB9KTsNCg0KICAgICAgICAgIG1haW5FbGVtZW50cy5wdXNoKGdlbmVyYXRlTEkoZ2VuZXJhdGVBKHRleHRFbGVtZW50LCBvcHRpb25DbGFzcywgaW5saW5lKSwgaW5kZXgpKTsNCiAgICAgICAgICBtYWluRGF0YS5wdXNoKHsNCiAgICAgICAgICAgIGNvbnRlbnQ6IG9wdGlvbkNvbnRlbnQgfHwgdGV4dCwNCiAgICAgICAgICAgIHN1YnRleHQ6IHN1YnRleHQsDQogICAgICAgICAgICB0b2tlbnM6IHRva2VucywNCiAgICAgICAgICAgIHR5cGU6ICdvcHRpb24nLA0KICAgICAgICAgICAgb3JpZ2luYWxJbmRleDogaW5kZXgsDQogICAgICAgICAgICBkYXRhOiB0aGlzRGF0YQ0KICAgICAgICAgIH0pOw0KDQogICAgICAgICAgYXZhaWxhYmxlT3B0aW9uc0NvdW50Kys7DQogICAgICAgIH0NCg0KICAgICAgICB0aGF0LnNlbGVjdHBpY2tlci5tYWluLm1hcC5uZXdJbmRleFtpbmRleF0gPSBsaUluZGV4Ow0KICAgICAgICB0aGF0LnNlbGVjdHBpY2tlci5tYWluLm1hcC5vcmlnaW5hbEluZGV4W2xpSW5kZXhdID0gaW5kZXg7DQoNCiAgICAgICAgLy8gZ2V0IHRoZSBtb3N0IHJlY2VudCBvcHRpb24gaW5mbyBhZGRlZCB0byBtYWluRGF0YQ0KICAgICAgICB2YXIgX21haW5EYXRhTGFzdCA9IG1haW5EYXRhW21haW5EYXRhLmxlbmd0aCAtIDFdOw0KDQogICAgICAgIF9tYWluRGF0YUxhc3QuZGlzYWJsZWQgPSBpc0Rpc2FibGVkOw0KDQogICAgICAgIHZhciBjb21iaW5lZExlbmd0aCA9IDA7DQoNCiAgICAgICAgLy8gY291bnQgdGhlIG51bWJlciBvZiBjaGFyYWN0ZXJzIGluIHRoZSBvcHRpb24gLSBub3QgcGVyZmVjdCwgYnV0IHNob3VsZCB3b3JrIGluIG1vc3QgY2FzZXMNCiAgICAgICAgaWYgKF9tYWluRGF0YUxhc3QuY29udGVudCkgY29tYmluZWRMZW5ndGggKz0gX21haW5EYXRhTGFzdC5jb250ZW50Lmxlbmd0aDsNCiAgICAgICAgaWYgKF9tYWluRGF0YUxhc3Quc3VidGV4dCkgY29tYmluZWRMZW5ndGggKz0gX21haW5EYXRhTGFzdC5zdWJ0ZXh0Lmxlbmd0aDsNCiAgICAgICAgLy8gaWYgdGhlcmUgaXMgYW4gaWNvbiwgZW5zdXJlIHRoaXMgb3B0aW9uJ3Mgd2lkdGggaXMgY2hlY2tlZA0KICAgICAgICBpZiAoaWNvbikgY29tYmluZWRMZW5ndGggKz0gMTsNCg0KICAgICAgICBpZiAoY29tYmluZWRMZW5ndGggPiB3aWRlc3RPcHRpb25MZW5ndGgpIHsNCiAgICAgICAgICB3aWRlc3RPcHRpb25MZW5ndGggPSBjb21iaW5lZExlbmd0aDsNCg0KICAgICAgICAgIC8vIGd1ZXNzIHdoaWNoIG9wdGlvbiBpcyB0aGUgd2lkZXN0DQogICAgICAgICAgLy8gdXNlIHRoaXMgd2hlbiBjYWxjdWxhdGluZyBtZW51IHdpZHRoDQogICAgICAgICAgLy8gbm90IHBlcmZlY3QsIGJ1dCBpdCdzIGZhc3QsIGFuZCB0aGUgd2lkdGggd2lsbCBiZSB1cGRhdGluZyBhY2NvcmRpbmdseSB3aGVuIHNjcm9sbGluZw0KICAgICAgICAgIHdpZGVzdE9wdGlvbiA9IG1haW5FbGVtZW50c1ttYWluRWxlbWVudHMubGVuZ3RoIC0gMV07DQogICAgICAgIH0NCiAgICAgIH0pOw0KDQogICAgICB0aGlzLnNlbGVjdHBpY2tlci5tYWluLmVsZW1lbnRzID0gbWFpbkVsZW1lbnRzOw0KICAgICAgdGhpcy5zZWxlY3RwaWNrZXIubWFpbi5kYXRhID0gbWFpbkRhdGE7DQoNCiAgICAgIHRoaXMuc2VsZWN0cGlja2VyLmN1cnJlbnQgPSB0aGlzLnNlbGVjdHBpY2tlci5tYWluOw0KDQogICAgICB0aGlzLnNlbGVjdHBpY2tlci52aWV3LndpZGVzdE9wdGlvbiA9IHdpZGVzdE9wdGlvbjsNCiAgICAgIHRoaXMuc2VsZWN0cGlja2VyLnZpZXcuYXZhaWxhYmxlT3B0aW9uc0NvdW50ID0gYXZhaWxhYmxlT3B0aW9uc0NvdW50OyAvLyBmYXN0ZXIgd2F5IHRvIGdldCAjIG9mIGF2YWlsYWJsZSBvcHRpb25zIHdpdGhvdXQgZmlsdGVyDQogICAgfSwNCg0KICAgIGZpbmRMaXM6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHJldHVybiB0aGlzLiRtZW51SW5uZXIuZmluZCgnLmlubmVyID4gbGknKTsNCiAgICB9LA0KDQogICAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7DQogICAgICB2YXIgdGhhdCA9IHRoaXMsDQogICAgICAgICAgJHNlbGVjdE9wdGlvbnMgPSB0aGlzLiRlbGVtZW50LmZpbmQoJ29wdGlvbicpLA0KICAgICAgICAgIHNlbGVjdGVkSXRlbXMgPSBbXSwNCiAgICAgICAgICBzZWxlY3RlZEl0ZW1zSW5UaXRsZSA9IFtdOw0KDQogICAgICB0aGlzLnRvZ2dsZVBsYWNlaG9sZGVyKCk7DQoNCiAgICAgIHRoaXMudGFiSW5kZXgoKTsNCg0KICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHRoaXMuc2VsZWN0cGlja2VyLm1haW4uZWxlbWVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsNCiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5zZWxlY3RwaWNrZXIubWFpbi5tYXAub3JpZ2luYWxJbmRleFtpXSwNCiAgICAgICAgICAgIG9wdGlvbiA9ICRzZWxlY3RPcHRpb25zW2luZGV4XTsNCg0KICAgICAgICBpZiAob3B0aW9uICYmIG9wdGlvbi5zZWxlY3RlZCkgew0KICAgICAgICAgIHNlbGVjdGVkSXRlbXMucHVzaChvcHRpb24pOw0KDQogICAgICAgICAgaWYgKHNlbGVjdGVkSXRlbXNJblRpdGxlLmxlbmd0aCA8IDEwMCAmJiB0aGF0Lm9wdGlvbnMuc2VsZWN0ZWRUZXh0Rm9ybWF0ICE9PSAnY291bnQnIHx8IHNlbGVjdGVkSXRlbXMubGVuZ3RoID09PSAxKSB7DQogICAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmhpZGVEaXNhYmxlZCAmJiAob3B0aW9uLmRpc2FibGVkIHx8IG9wdGlvbi5wYXJlbnROb2RlLnRhZ05hbWUgPT09ICdPUFRHUk9VUCcgJiYgb3B0aW9uLnBhcmVudE5vZGUuZGlzYWJsZWQpKSByZXR1cm47DQoNCiAgICAgICAgICAgIHZhciB0aGlzRGF0YSA9IHRoaXMuc2VsZWN0cGlja2VyLm1haW4uZGF0YVtpXS5kYXRhLA0KICAgICAgICAgICAgICAgIGljb24gPSB0aGlzRGF0YS5pY29uICYmIHRoYXQub3B0aW9ucy5zaG93SWNvbiA/ICc8aSBjbGFzcz0iJyArIHRoYXQub3B0aW9ucy5pY29uQmFzZSArICcgJyArIHRoaXNEYXRhLmljb24gKyAnIj48L2k+ICcgOiAnJywNCiAgICAgICAgICAgICAgICBzdWJ0ZXh0LA0KICAgICAgICAgICAgICAgIHRpdGxlSXRlbTsNCg0KICAgICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5zaG93U3VidGV4dCAmJiB0aGlzRGF0YS5zdWJ0ZXh0ICYmICF0aGF0Lm11bHRpcGxlKSB7DQogICAgICAgICAgICAgIHN1YnRleHQgPSAnIDxzbWFsbCBjbGFzcz0idGV4dC1tdXRlZCI+JyArIHRoaXNEYXRhLnN1YnRleHQgKyAnPC9zbWFsbD4nOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgc3VidGV4dCA9ICcnOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAob3B0aW9uLnRpdGxlKSB7DQogICAgICAgICAgICAgIHRpdGxlSXRlbSA9IG9wdGlvbi50aXRsZTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpc0RhdGEuY29udGVudCAmJiB0aGF0Lm9wdGlvbnMuc2hvd0NvbnRlbnQpIHsNCiAgICAgICAgICAgICAgdGl0bGVJdGVtID0gdGhpc0RhdGEuY29udGVudC50b1N0cmluZygpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgdGl0bGVJdGVtID0gaWNvbiArIG9wdGlvbi5pbm5lckhUTUwudHJpbSgpICsgc3VidGV4dDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgc2VsZWN0ZWRJdGVtc0luVGl0bGUucHVzaCh0aXRsZUl0ZW0pOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfQ0KDQogICAgICAvL0ZpeGVzIGlzc3VlIGluIElFMTAgb2NjdXJyaW5nIHdoZW4gbm8gZGVmYXVsdCBvcHRpb24gaXMgc2VsZWN0ZWQgYW5kIGF0IGxlYXN0IG9uZSBvcHRpb24gaXMgZGlzYWJsZWQNCiAgICAgIC8vQ29udmVydCBhbGwgdGhlIHZhbHVlcyBpbnRvIGEgY29tbWEgZGVsaW1pdGVkIHN0cmluZw0KICAgICAgdmFyIHRpdGxlID0gIXRoaXMubXVsdGlwbGUgPyBzZWxlY3RlZEl0ZW1zSW5UaXRsZVswXSA6IHNlbGVjdGVkSXRlbXNJblRpdGxlLmpvaW4odGhpcy5vcHRpb25zLm11bHRpcGxlU2VwYXJhdG9yKTsNCg0KICAgICAgLy8gYWRkIGVsbGlwc2lzDQogICAgICBpZiAoc2VsZWN0ZWRJdGVtcy5sZW5ndGggPiA1MCkgdGl0bGUgKz0gJy4uLic7DQoNCiAgICAgIC8vIElmIHRoaXMgaXMgYSBtdWx0aXNlbGVjdCwgYW5kIHNlbGVjdGVkVGV4dEZvcm1hdCBpcyBjb3VudCwgdGhlbiBzaG93IDEgb2YgMiBzZWxlY3RlZCBldGMuLg0KICAgICAgaWYgKHRoaXMubXVsdGlwbGUgJiYgdGhpcy5vcHRpb25zLnNlbGVjdGVkVGV4dEZvcm1hdC5pbmRleE9mKCdjb3VudCcpICE9PSAtMSkgew0KICAgICAgICB2YXIgbWF4ID0gdGhpcy5vcHRpb25zLnNlbGVjdGVkVGV4dEZvcm1hdC5zcGxpdCgnPicpOw0KDQogICAgICAgIGlmICgobWF4Lmxlbmd0aCA+IDEgJiYgc2VsZWN0ZWRJdGVtcy5sZW5ndGggPiBtYXhbMV0pIHx8IChtYXgubGVuZ3RoID09PSAxICYmIHNlbGVjdGVkSXRlbXMubGVuZ3RoID49IDIpKSB7DQogICAgICAgICAgdmFyIHRvdGFsQ291bnQgPSB0aGlzLnNlbGVjdHBpY2tlci52aWV3LmF2YWlsYWJsZU9wdGlvbnNDb3VudCwNCiAgICAgICAgICAgICAgdHI4blRleHQgPSAodHlwZW9mIHRoaXMub3B0aW9ucy5jb3VudFNlbGVjdGVkVGV4dCA9PT0gJ2Z1bmN0aW9uJykgPyB0aGlzLm9wdGlvbnMuY291bnRTZWxlY3RlZFRleHQoc2VsZWN0ZWRJdGVtcy5sZW5ndGgsIHRvdGFsQ291bnQpIDogdGhpcy5vcHRpb25zLmNvdW50U2VsZWN0ZWRUZXh0Ow0KDQogICAgICAgICAgdGl0bGUgPSB0cjhuVGV4dC5yZXBsYWNlKCd7MH0nLCBzZWxlY3RlZEl0ZW1zLmxlbmd0aC50b1N0cmluZygpKS5yZXBsYWNlKCd7MX0nLCB0b3RhbENvdW50LnRvU3RyaW5nKCkpOw0KICAgICAgICB9DQogICAgICB9DQoNCiAgICAgIGlmICh0aGlzLm9wdGlvbnMudGl0bGUgPT0gdW5kZWZpbmVkKSB7DQogICAgICAgIC8vIHVzZSAuYXR0ciB0byBlbnN1cmUgdW5kZWZpbmVkIGlzIHJldHVybmVkIGlmIHRpdGxlIGF0dHJpYnV0ZSBpcyBub3Qgc2V0DQogICAgICAgIHRoaXMub3B0aW9ucy50aXRsZSA9IHRoaXMuJGVsZW1lbnQuYXR0cigndGl0bGUnKTsNCiAgICAgIH0NCg0KICAgICAgaWYgKHRoaXMub3B0aW9ucy5zZWxlY3RlZFRleHRGb3JtYXQgPT0gJ3N0YXRpYycpIHsNCiAgICAgICAgdGl0bGUgPSB0aGlzLm9wdGlvbnMudGl0bGU7DQogICAgICB9DQoNCiAgICAgIC8vSWYgd2UgZG9udCBoYXZlIGEgdGl0bGUsIHRoZW4gdXNlIHRoZSBkZWZhdWx0LCBvciBpZiBub3RoaW5nIGlzIHNldCBhdCBhbGwsIHVzZSB0aGUgbm90IHNlbGVjdGVkIHRleHQNCiAgICAgIGlmICghdGl0bGUpIHsNCiAgICAgICAgdGl0bGUgPSB0eXBlb2YgdGhpcy5vcHRpb25zLnRpdGxlICE9PSAndW5kZWZpbmVkJyA/IHRoaXMub3B0aW9ucy50aXRsZSA6IHRoaXMub3B0aW9ucy5ub25lU2VsZWN0ZWRUZXh0Ow0KICAgICAgfQ0KDQogICAgICAvL3N0cmlwIGFsbCBIVE1MIHRhZ3MgYW5kIHRyaW0gdGhlIHJlc3VsdCwgdGhlbiB1bmVzY2FwZSBhbnkgZXNjYXBlZCB0YWdzDQogICAgICB0aGlzLiRidXR0b25bMF0udGl0bGUgPSBodG1sVW5lc2NhcGUodGl0bGUucmVwbGFjZSgvPFtePl0qPj8vZywgJycpLnRyaW0oKSk7DQogICAgICB0aGlzLiRidXR0b24uZmluZCgnLmZpbHRlci1vcHRpb24taW5uZXItaW5uZXInKVswXS5pbm5lckhUTUwgPSB0aXRsZTsNCg0KICAgICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKCdyZW5kZXJlZC5icy5zZWxlY3QnKTsNCiAgICB9LA0KDQogICAgLyoqDQogICAgICogQHBhcmFtIFtzdHlsZV0NCiAgICAgKiBAcGFyYW0gW3N0YXR1c10NCiAgICAgKi8NCiAgICBzZXRTdHlsZTogZnVuY3Rpb24gKHN0eWxlLCBzdGF0dXMpIHsNCiAgICAgIGlmICh0aGlzLiRlbGVtZW50LmF0dHIoJ2NsYXNzJykpIHsNCiAgICAgICAgdGhpcy4kbmV3RWxlbWVudC5hZGRDbGFzcyh0aGlzLiRlbGVtZW50LmF0dHIoJ2NsYXNzJykucmVwbGFjZSgvc2VsZWN0cGlja2VyfG1vYmlsZS1kZXZpY2V8YnMtc2VsZWN0LWhpZGRlbnx2YWxpZGF0ZVxbLipcXS9naSwgJycpKTsNCiAgICAgIH0NCg0KICAgICAgdmFyIGJ1dHRvbkNsYXNzID0gc3R5bGUgPyBzdHlsZSA6IHRoaXMub3B0aW9ucy5zdHlsZTsNCg0KICAgICAgaWYgKHN0YXR1cyA9PSAnYWRkJykgew0KICAgICAgICB0aGlzLiRidXR0b24uYWRkQ2xhc3MoYnV0dG9uQ2xhc3MpOw0KICAgICAgfSBlbHNlIGlmIChzdGF0dXMgPT0gJ3JlbW92ZScpIHsNCiAgICAgICAgdGhpcy4kYnV0dG9uLnJlbW92ZUNsYXNzKGJ1dHRvbkNsYXNzKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuJGJ1dHRvbi5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMuc3R5bGUpOw0KICAgICAgICB0aGlzLiRidXR0b24uYWRkQ2xhc3MoYnV0dG9uQ2xhc3MpOw0KICAgICAgfQ0KICAgIH0sDQoNCiAgICBsaUhlaWdodDogZnVuY3Rpb24gKHJlZnJlc2gpIHsNCiAgICAgIGlmICghcmVmcmVzaCAmJiAodGhpcy5vcHRpb25zLnNpemUgPT09IGZhbHNlIHx8IHRoaXMuc2l6ZUluZm8pKSByZXR1cm47DQoNCiAgICAgIGlmICghdGhpcy5zaXplSW5mbykgdGhpcy5zaXplSW5mbyA9IHt9Ow0KDQogICAgICB2YXIgbmV3RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLA0KICAgICAgICAgIG1lbnUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSwNCiAgICAgICAgICBtZW51SW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSwNCiAgICAgICAgICBtZW51SW5uZXJJbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyksDQogICAgICAgICAgZGl2aWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyksDQogICAgICAgICAgZHJvcGRvd25IZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpLA0KICAgICAgICAgIGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKSwNCiAgICAgICAgICBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpLA0KICAgICAgICAgIHRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyksDQogICAgICAgICAgaGVhZGVyID0gdGhpcy5vcHRpb25zLmhlYWRlciAmJiB0aGlzLiRtZW51LmZpbmQoJy4nICsgY2xhc3NOYW1lcy5QT1BPVkVSSEVBREVSKS5sZW5ndGggPiAwID8gdGhpcy4kbWVudS5maW5kKCcuJyArIGNsYXNzTmFtZXMuUE9QT1ZFUkhFQURFUilbMF0uY2xvbmVOb2RlKHRydWUpIDogbnVsbCwNCiAgICAgICAgICBzZWFyY2ggPSB0aGlzLm9wdGlvbnMubGl2ZVNlYXJjaCA/IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpIDogbnVsbCwNCiAgICAgICAgICBhY3Rpb25zID0gdGhpcy5vcHRpb25zLmFjdGlvbnNCb3ggJiYgdGhpcy5tdWx0aXBsZSAmJiB0aGlzLiRtZW51LmZpbmQoJy5icy1hY3Rpb25zYm94JykubGVuZ3RoID4gMCA/IHRoaXMuJG1lbnUuZmluZCgnLmJzLWFjdGlvbnNib3gnKVswXS5jbG9uZU5vZGUodHJ1ZSkgOiBudWxsLA0KICAgICAgICAgIGRvbmVCdXR0b24gPSB0aGlzLm9wdGlvbnMuZG9uZUJ1dHRvbiAmJiB0aGlzLm11bHRpcGxlICYmIHRoaXMuJG1lbnUuZmluZCgnLmJzLWRvbmVidXR0b24nKS5sZW5ndGggPiAwID8gdGhpcy4kbWVudS5maW5kKCcuYnMtZG9uZWJ1dHRvbicpWzBdLmNsb25lTm9kZSh0cnVlKSA6IG51bGw7DQoNCiAgICAgIHRoaXMuc2l6ZUluZm8uc2VsZWN0V2lkdGggPSB0aGlzLiRuZXdFbGVtZW50WzBdLm9mZnNldFdpZHRoOw0KDQogICAgICB0ZXh0LmNsYXNzTmFtZSA9ICd0ZXh0JzsNCiAgICAgIGEuY2xhc3NOYW1lID0gJ2Ryb3Bkb3duLWl0ZW0nOw0KICAgICAgbmV3RWxlbWVudC5jbGFzc05hbWUgPSB0aGlzLiRtZW51WzBdLnBhcmVudE5vZGUuY2xhc3NOYW1lICsgJyAnICsgY2xhc3NOYW1lcy5TSE9XOw0KICAgICAgbmV3RWxlbWVudC5zdHlsZS53aWR0aCA9IHRoaXMuc2l6ZUluZm8uc2VsZWN0V2lkdGggKyAncHgnOw0KICAgICAgbWVudS5jbGFzc05hbWUgPSAnZHJvcGRvd24tbWVudSAnICsgY2xhc3NOYW1lcy5TSE9XOw0KICAgICAgbWVudUlubmVyLmNsYXNzTmFtZSA9ICdpbm5lciAnICsgY2xhc3NOYW1lcy5TSE9XOw0KICAgICAgbWVudUlubmVySW5uZXIuY2xhc3NOYW1lID0gJ2Ryb3Bkb3duLW1lbnUgaW5uZXIgJyArICh2ZXJzaW9uLm1ham9yID09PSAnNCcgPyBjbGFzc05hbWVzLlNIT1cgOiAnJyk7DQogICAgICBkaXZpZGVyLmNsYXNzTmFtZSA9IGNsYXNzTmFtZXMuRElWSURFUjsNCiAgICAgIGRyb3Bkb3duSGVhZGVyLmNsYXNzTmFtZSA9ICdkcm9wZG93bi1oZWFkZXInOw0KDQogICAgICB0ZXh0LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCdJbm5lciB0ZXh0JykpOw0KICAgICAgYS5hcHBlbmRDaGlsZCh0ZXh0KTsNCiAgICAgIGxpLmFwcGVuZENoaWxkKGEpOw0KICAgICAgZHJvcGRvd25IZWFkZXIuYXBwZW5kQ2hpbGQodGV4dC5jbG9uZU5vZGUodHJ1ZSkpOw0KDQogICAgICBpZiAodGhpcy5zZWxlY3RwaWNrZXIudmlldy53aWRlc3RPcHRpb24pIHsNCiAgICAgICAgbWVudUlubmVySW5uZXIuYXBwZW5kQ2hpbGQodGhpcy5zZWxlY3RwaWNrZXIudmlldy53aWRlc3RPcHRpb24uY2xvbmVOb2RlKHRydWUpKTsNCiAgICAgIH0NCg0KICAgICAgbWVudUlubmVySW5uZXIuYXBwZW5kQ2hpbGQobGkpOw0KICAgICAgbWVudUlubmVySW5uZXIuYXBwZW5kQ2hpbGQoZGl2aWRlcik7DQogICAgICBtZW51SW5uZXJJbm5lci5hcHBlbmRDaGlsZChkcm9wZG93bkhlYWRlcik7DQogICAgICBpZiAoaGVhZGVyKSBtZW51LmFwcGVuZENoaWxkKGhlYWRlcik7DQogICAgICBpZiAoc2VhcmNoKSB7DQogICAgICAgIHZhciBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7DQogICAgICAgIHNlYXJjaC5jbGFzc05hbWUgPSAnYnMtc2VhcmNoYm94JzsNCiAgICAgICAgaW5wdXQuY2xhc3NOYW1lID0gJ2Zvcm0tY29udHJvbCc7DQogICAgICAgIHNlYXJjaC5hcHBlbmRDaGlsZChpbnB1dCk7DQogICAgICAgIG1lbnUuYXBwZW5kQ2hpbGQoc2VhcmNoKTsNCiAgICAgIH0NCiAgICAgIGlmIChhY3Rpb25zKSBtZW51LmFwcGVuZENoaWxkKGFjdGlvbnMpOw0KICAgICAgbWVudUlubmVyLmFwcGVuZENoaWxkKG1lbnVJbm5lcklubmVyKTsNCiAgICAgIG1lbnUuYXBwZW5kQ2hpbGQobWVudUlubmVyKTsNCiAgICAgIGlmIChkb25lQnV0dG9uKSBtZW51LmFwcGVuZENoaWxkKGRvbmVCdXR0b24pOw0KICAgICAgbmV3RWxlbWVudC5hcHBlbmRDaGlsZChtZW51KTsNCg0KICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChuZXdFbGVtZW50KTsNCg0KICAgICAgdmFyIGxpSGVpZ2h0ID0gYS5vZmZzZXRIZWlnaHQsDQogICAgICAgICAgZHJvcGRvd25IZWFkZXJIZWlnaHQgPSBkcm9wZG93bkhlYWRlciA/IGRyb3Bkb3duSGVhZGVyLm9mZnNldEhlaWdodCA6IDAsDQogICAgICAgICAgaGVhZGVySGVpZ2h0ID0gaGVhZGVyID8gaGVhZGVyLm9mZnNldEhlaWdodCA6IDAsDQogICAgICAgICAgc2VhcmNoSGVpZ2h0ID0gc2VhcmNoID8gc2VhcmNoLm9mZnNldEhlaWdodCA6IDAsDQogICAgICAgICAgYWN0aW9uc0hlaWdodCA9IGFjdGlvbnMgPyBhY3Rpb25zLm9mZnNldEhlaWdodCA6IDAsDQogICAgICAgICAgZG9uZUJ1dHRvbkhlaWdodCA9IGRvbmVCdXR0b24gPyBkb25lQnV0dG9uLm9mZnNldEhlaWdodCA6IDAsDQogICAgICAgICAgZGl2aWRlckhlaWdodCA9ICQoZGl2aWRlcikub3V0ZXJIZWlnaHQodHJ1ZSksDQogICAgICAgICAgLy8gZmFsbCBiYWNrIHRvIGpRdWVyeSBpZiBnZXRDb21wdXRlZFN0eWxlIGlzIG5vdCBzdXBwb3J0ZWQNCiAgICAgICAgICBtZW51U3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSA/IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKG1lbnUpIDogZmFsc2UsDQogICAgICAgICAgbWVudVdpZHRoID0gbWVudS5vZmZzZXRXaWR0aCwNCiAgICAgICAgICAkbWVudSA9IG1lbnVTdHlsZSA/IG51bGwgOiAkKG1lbnUpLA0KICAgICAgICAgIG1lbnVQYWRkaW5nID0gew0KICAgICAgICAgICAgdmVydDogdG9JbnRlZ2VyKG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5wYWRkaW5nVG9wIDogJG1lbnUuY3NzKCdwYWRkaW5nVG9wJykpICsNCiAgICAgICAgICAgICAgICAgIHRvSW50ZWdlcihtZW51U3R5bGUgPyBtZW51U3R5bGUucGFkZGluZ0JvdHRvbSA6ICRtZW51LmNzcygncGFkZGluZ0JvdHRvbScpKSArDQogICAgICAgICAgICAgICAgICB0b0ludGVnZXIobWVudVN0eWxlID8gbWVudVN0eWxlLmJvcmRlclRvcFdpZHRoIDogJG1lbnUuY3NzKCdib3JkZXJUb3BXaWR0aCcpKSArDQogICAgICAgICAgICAgICAgICB0b0ludGVnZXIobWVudVN0eWxlID8gbWVudVN0eWxlLmJvcmRlckJvdHRvbVdpZHRoIDogJG1lbnUuY3NzKCdib3JkZXJCb3R0b21XaWR0aCcpKSwNCiAgICAgICAgICAgIGhvcml6OiB0b0ludGVnZXIobWVudVN0eWxlID8gbWVudVN0eWxlLnBhZGRpbmdMZWZ0IDogJG1lbnUuY3NzKCdwYWRkaW5nTGVmdCcpKSArDQogICAgICAgICAgICAgICAgICB0b0ludGVnZXIobWVudVN0eWxlID8gbWVudVN0eWxlLnBhZGRpbmdSaWdodCA6ICRtZW51LmNzcygncGFkZGluZ1JpZ2h0JykpICsNCiAgICAgICAgICAgICAgICAgIHRvSW50ZWdlcihtZW51U3R5bGUgPyBtZW51U3R5bGUuYm9yZGVyTGVmdFdpZHRoIDogJG1lbnUuY3NzKCdib3JkZXJMZWZ0V2lkdGgnKSkgKw0KICAgICAgICAgICAgICAgICAgdG9JbnRlZ2VyKG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5ib3JkZXJSaWdodFdpZHRoIDogJG1lbnUuY3NzKCdib3JkZXJSaWdodFdpZHRoJykpDQogICAgICAgICAgfSwNCiAgICAgICAgICBtZW51RXh0cmFzID0gIHsNCiAgICAgICAgICAgIHZlcnQ6IG1lbnVQYWRkaW5nLnZlcnQgKw0KICAgICAgICAgICAgICAgICAgdG9JbnRlZ2VyKG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5tYXJnaW5Ub3AgOiAkbWVudS5jc3MoJ21hcmdpblRvcCcpKSArDQogICAgICAgICAgICAgICAgICB0b0ludGVnZXIobWVudVN0eWxlID8gbWVudVN0eWxlLm1hcmdpbkJvdHRvbSA6ICRtZW51LmNzcygnbWFyZ2luQm90dG9tJykpICsgMiwNCiAgICAgICAgICAgIGhvcml6OiBtZW51UGFkZGluZy5ob3JpeiArDQogICAgICAgICAgICAgICAgICB0b0ludGVnZXIobWVudVN0eWxlID8gbWVudVN0eWxlLm1hcmdpbkxlZnQgOiAkbWVudS5jc3MoJ21hcmdpbkxlZnQnKSkgKw0KICAgICAgICAgICAgICAgICAgdG9JbnRlZ2VyKG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5tYXJnaW5SaWdodCA6ICRtZW51LmNzcygnbWFyZ2luUmlnaHQnKSkgKyAyDQogICAgICAgICAgfSwNCiAgICAgICAgICBzY3JvbGxCYXJXaWR0aDsNCg0KICAgICAgbWVudUlubmVyLnN0eWxlLm92ZXJmbG93WSA9ICdzY3JvbGwnOw0KDQogICAgICBzY3JvbGxCYXJXaWR0aCA9IG1lbnUub2Zmc2V0V2lkdGggLSBtZW51V2lkdGg7DQoNCiAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobmV3RWxlbWVudCk7DQoNCiAgICAgIHRoaXMuc2l6ZUluZm8ubGlIZWlnaHQgPSBsaUhlaWdodDsNCiAgICAgIHRoaXMuc2l6ZUluZm8uZHJvcGRvd25IZWFkZXJIZWlnaHQgPSBkcm9wZG93bkhlYWRlckhlaWdodDsNCiAgICAgIHRoaXMuc2l6ZUluZm8uaGVhZGVySGVpZ2h0ID0gaGVhZGVySGVpZ2h0Ow0KICAgICAgdGhpcy5zaXplSW5mby5zZWFyY2hIZWlnaHQgPSBzZWFyY2hIZWlnaHQ7DQogICAgICB0aGlzLnNpemVJbmZvLmFjdGlvbnNIZWlnaHQgPSBhY3Rpb25zSGVpZ2h0Ow0KICAgICAgdGhpcy5zaXplSW5mby5kb25lQnV0dG9uSGVpZ2h0ID0gZG9uZUJ1dHRvbkhlaWdodDsNCiAgICAgIHRoaXMuc2l6ZUluZm8uZGl2aWRlckhlaWdodCA9IGRpdmlkZXJIZWlnaHQ7DQogICAgICB0aGlzLnNpemVJbmZvLm1lbnVQYWRkaW5nID0gbWVudVBhZGRpbmc7DQogICAgICB0aGlzLnNpemVJbmZvLm1lbnVFeHRyYXMgPSBtZW51RXh0cmFzOw0KICAgICAgdGhpcy5zaXplSW5mby5tZW51V2lkdGggPSBtZW51V2lkdGg7DQogICAgICB0aGlzLnNpemVJbmZvLnRvdGFsTWVudVdpZHRoID0gdGhpcy5zaXplSW5mby5tZW51V2lkdGg7DQogICAgICB0aGlzLnNpemVJbmZvLnNjcm9sbEJhcldpZHRoID0gc2Nyb2xsQmFyV2lkdGg7DQogICAgICB0aGlzLnNpemVJbmZvLnNlbGVjdEhlaWdodCA9IHRoaXMuJG5ld0VsZW1lbnRbMF0ub2Zmc2V0SGVpZ2h0Ow0KDQogICAgICB0aGlzLnNldFBvc2l0aW9uRGF0YSgpOw0KICAgIH0sDQoNCiAgICBnZXRTZWxlY3RQb3NpdGlvbjogZnVuY3Rpb24gKCkgew0KICAgICAgdmFyIHRoYXQgPSB0aGlzLA0KICAgICAgICAgICR3aW5kb3cgPSAkKHdpbmRvdyksDQogICAgICAgICAgcG9zID0gdGhhdC4kbmV3RWxlbWVudC5vZmZzZXQoKSwNCiAgICAgICAgICAkY29udGFpbmVyID0gJCh0aGF0Lm9wdGlvbnMuY29udGFpbmVyKSwNCiAgICAgICAgICBjb250YWluZXJQb3M7DQoNCiAgICAgIGlmICh0aGF0Lm9wdGlvbnMuY29udGFpbmVyICYmICEkY29udGFpbmVyLmlzKCdib2R5JykpIHsNCiAgICAgICAgY29udGFpbmVyUG9zID0gJGNvbnRhaW5lci5vZmZzZXQoKTsNCiAgICAgICAgY29udGFpbmVyUG9zLnRvcCArPSBwYXJzZUludCgkY29udGFpbmVyLmNzcygnYm9yZGVyVG9wV2lkdGgnKSk7DQogICAgICAgIGNvbnRhaW5lclBvcy5sZWZ0ICs9IHBhcnNlSW50KCRjb250YWluZXIuY3NzKCdib3JkZXJMZWZ0V2lkdGgnKSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBjb250YWluZXJQb3MgPSB7IHRvcDogMCwgbGVmdDogMCB9Ow0KICAgICAgfQ0KDQogICAgICB2YXIgd2luUGFkID0gdGhhdC5vcHRpb25zLndpbmRvd1BhZGRpbmc7DQoNCiAgICAgIHRoaXMuc2l6ZUluZm8uc2VsZWN0T2Zmc2V0VG9wID0gcG9zLnRvcCAtIGNvbnRhaW5lclBvcy50b3AgLSAkd2luZG93LnNjcm9sbFRvcCgpOw0KICAgICAgdGhpcy5zaXplSW5mby5zZWxlY3RPZmZzZXRCb3QgPSAkd2luZG93LmhlaWdodCgpIC0gdGhpcy5zaXplSW5mby5zZWxlY3RPZmZzZXRUb3AgLSB0aGlzLnNpemVJbmZvWydzZWxlY3RIZWlnaHQnXSAtIGNvbnRhaW5lclBvcy50b3AgLSB3aW5QYWRbMl07DQogICAgICB0aGlzLnNpemVJbmZvLnNlbGVjdE9mZnNldExlZnQgPSBwb3MubGVmdCAtIGNvbnRhaW5lclBvcy5sZWZ0IC0gJHdpbmRvdy5zY3JvbGxMZWZ0KCk7DQogICAgICB0aGlzLnNpemVJbmZvLnNlbGVjdE9mZnNldFJpZ2h0ID0gJHdpbmRvdy53aWR0aCgpIC0gdGhpcy5zaXplSW5mby5zZWxlY3RPZmZzZXRMZWZ0IC0gdGhpcy5zaXplSW5mb1snc2VsZWN0V2lkdGgnXSAtIGNvbnRhaW5lclBvcy5sZWZ0IC0gd2luUGFkWzFdOw0KICAgICAgdGhpcy5zaXplSW5mby5zZWxlY3RPZmZzZXRUb3AgLT0gd2luUGFkWzBdOw0KICAgICAgdGhpcy5zaXplSW5mby5zZWxlY3RPZmZzZXRMZWZ0IC09IHdpblBhZFszXTsNCiAgICB9LA0KDQogICAgc2V0TWVudVNpemU6IGZ1bmN0aW9uIChpc0F1dG8pIHsNCiAgICAgIHRoaXMuZ2V0U2VsZWN0UG9zaXRpb24oKTsNCg0KICAgICAgdmFyIHNlbGVjdFdpZHRoID0gdGhpcy5zaXplSW5mb1snc2VsZWN0V2lkdGgnXSwNCiAgICAgICAgICBsaUhlaWdodCA9IHRoaXMuc2l6ZUluZm9bJ2xpSGVpZ2h0J10sDQogICAgICAgICAgaGVhZGVySGVpZ2h0ID0gdGhpcy5zaXplSW5mb1snaGVhZGVySGVpZ2h0J10sDQogICAgICAgICAgc2VhcmNoSGVpZ2h0ID0gdGhpcy5zaXplSW5mb1snc2VhcmNoSGVpZ2h0J10sDQogICAgICAgICAgYWN0aW9uc0hlaWdodCA9IHRoaXMuc2l6ZUluZm9bJ2FjdGlvbnNIZWlnaHQnXSwNCiAgICAgICAgICBkb25lQnV0dG9uSGVpZ2h0ID0gdGhpcy5zaXplSW5mb1snZG9uZUJ1dHRvbkhlaWdodCddLA0KICAgICAgICAgIGRpdkhlaWdodCA9IHRoaXMuc2l6ZUluZm9bJ2RpdmlkZXJIZWlnaHQnXSwNCiAgICAgICAgICBtZW51UGFkZGluZyA9IHRoaXMuc2l6ZUluZm9bJ21lbnVQYWRkaW5nJ10sDQogICAgICAgICAgbWVudUlubmVySGVpZ2h0LA0KICAgICAgICAgIG1lbnVIZWlnaHQsDQogICAgICAgICAgZGl2TGVuZ3RoID0gMCwNCiAgICAgICAgICBtaW5IZWlnaHQsDQogICAgICAgICAgX21pbkhlaWdodCwNCiAgICAgICAgICBtYXhIZWlnaHQsDQogICAgICAgICAgbWVudUlubmVyTWluSGVpZ2h0LA0KICAgICAgICAgIGVzdGltYXRlOw0KDQogICAgICBpZiAodGhpcy5vcHRpb25zLmRyb3B1cEF1dG8pIHsNCiAgICAgICAgLy8gR2V0IHRoZSBlc3RpbWF0ZWQgaGVpZ2h0IG9mIHRoZSBtZW51IHdpdGhvdXQgc2Nyb2xsYmFycy4NCiAgICAgICAgLy8gVGhpcyBpcyB1c2VmdWwgZm9yIHNtYWxsZXIgbWVudXMsIHdoZXJlIHRoZXJlIG1pZ2h0IGJlIHBsZW50eSBvZiByb29tDQogICAgICAgIC8vIGJlbG93IHRoZSBidXR0b24gd2l0aG91dCBzZXR0aW5nIGRyb3B1cCwgYnV0IHdlIGNhbid0IGtub3cNCiAgICAgICAgLy8gdGhlIGV4YWN0IGhlaWdodCBvZiB0aGUgbWVudSB1bnRpbCBjcmVhdGVWaWV3IGlzIGNhbGxlZCBsYXRlcg0KICAgICAgICBlc3RpbWF0ZSA9IGxpSGVpZ2h0ICogdGhpcy5zZWxlY3RwaWNrZXIuY3VycmVudC5lbGVtZW50cy5sZW5ndGggKyBtZW51UGFkZGluZy52ZXJ0Ow0KICAgICAgICB0aGlzLiRuZXdFbGVtZW50LnRvZ2dsZUNsYXNzKGNsYXNzTmFtZXMuRFJPUFVQLCB0aGlzLnNpemVJbmZvLnNlbGVjdE9mZnNldFRvcCAtIHRoaXMuc2l6ZUluZm8uc2VsZWN0T2Zmc2V0Qm90ID4gdGhpcy5zaXplSW5mby5tZW51RXh0cmFzLnZlcnQgJiYgZXN0aW1hdGUgKyB0aGlzLnNpemVJbmZvLm1lbnVFeHRyYXMudmVydCArIDUwID4gdGhpcy5zaXplSW5mby5zZWxlY3RPZmZzZXRCb3QpOw0KICAgICAgfQ0KDQogICAgICBpZiAodGhpcy5vcHRpb25zLnNpemUgPT09ICdhdXRvJykgew0KICAgICAgICBfbWluSGVpZ2h0ID0gdGhpcy5zZWxlY3RwaWNrZXIuY3VycmVudC5lbGVtZW50cy5sZW5ndGggPiAzID8gdGhpcy5zaXplSW5mby5saUhlaWdodCAqIDMgKyB0aGlzLnNpemVJbmZvLm1lbnVFeHRyYXMudmVydCAtIDIgOiAwOw0KICAgICAgICBtZW51SGVpZ2h0ID0gdGhpcy5zaXplSW5mby5zZWxlY3RPZmZzZXRCb3QgLSB0aGlzLnNpemVJbmZvLm1lbnVFeHRyYXMudmVydDsNCiAgICAgICAgbWluSGVpZ2h0ID0gX21pbkhlaWdodCArIGhlYWRlckhlaWdodCArIHNlYXJjaEhlaWdodCArIGFjdGlvbnNIZWlnaHQgKyBkb25lQnV0dG9uSGVpZ2h0Ow0KICAgICAgICBtZW51SW5uZXJNaW5IZWlnaHQgPSBNYXRoLm1heChfbWluSGVpZ2h0IC0gbWVudVBhZGRpbmcudmVydCwgMCk7DQoNCiAgICAgICAgaWYgKHRoaXMuJG5ld0VsZW1lbnQuaGFzQ2xhc3MoY2xhc3NOYW1lcy5EUk9QVVApKSB7DQogICAgICAgICAgbWVudUhlaWdodCA9IHRoaXMuc2l6ZUluZm8uc2VsZWN0T2Zmc2V0VG9wIC0gdGhpcy5zaXplSW5mby5tZW51RXh0cmFzLnZlcnQ7DQogICAgICAgIH0NCg0KICAgICAgICBtYXhIZWlnaHQgPSBtZW51SGVpZ2h0Ow0KICAgICAgICBtZW51SW5uZXJIZWlnaHQgPSBtZW51SGVpZ2h0IC0gaGVhZGVySGVpZ2h0IC0gc2VhcmNoSGVpZ2h0IC0gYWN0aW9uc0hlaWdodCAtIGRvbmVCdXR0b25IZWlnaHQgLSBtZW51UGFkZGluZy52ZXJ0Ow0KICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbnMuc2l6ZSAmJiB0aGlzLm9wdGlvbnMuc2l6ZSAhPSAnYXV0bycgJiYgdGhpcy5zZWxlY3RwaWNrZXIuY3VycmVudC5lbGVtZW50cy5sZW5ndGggPiB0aGlzLm9wdGlvbnMuc2l6ZSkgew0KICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMub3B0aW9ucy5zaXplOyBpKyspIHsNCiAgICAgICAgICBpZiAodGhpcy5zZWxlY3RwaWNrZXIuY3VycmVudC5kYXRhW2ldLnR5cGUgPT09ICdkaXZpZGVyJykgZGl2TGVuZ3RoKys7DQogICAgICAgIH0NCg0KICAgICAgICBtZW51SGVpZ2h0ID0gbGlIZWlnaHQgKiB0aGlzLm9wdGlvbnMuc2l6ZSArIGRpdkxlbmd0aCAqIGRpdkhlaWdodCArIG1lbnVQYWRkaW5nLnZlcnQ7DQogICAgICAgIG1lbnVJbm5lckhlaWdodCA9IG1lbnVIZWlnaHQgLSBtZW51UGFkZGluZy52ZXJ0Ow0KICAgICAgICBtYXhIZWlnaHQgPSBtZW51SGVpZ2h0ICsgaGVhZGVySGVpZ2h0ICsgc2VhcmNoSGVpZ2h0ICsgYWN0aW9uc0hlaWdodCArIGRvbmVCdXR0b25IZWlnaHQ7DQogICAgICAgIG1pbkhlaWdodCA9IG1lbnVJbm5lck1pbkhlaWdodCA9ICcnOw0KICAgICAgfQ0KDQogICAgICBpZiAodGhpcy5vcHRpb25zLmRyb3Bkb3duQWxpZ25SaWdodCA9PT0gJ2F1dG8nKSB7DQogICAgICAgIHRoaXMuJG1lbnUudG9nZ2xlQ2xhc3MoY2xhc3NOYW1lcy5NRU5VUklHSFQsIHRoaXMuc2l6ZUluZm8uc2VsZWN0T2Zmc2V0TGVmdCA+IHRoaXMuc2l6ZUluZm8uc2VsZWN0T2Zmc2V0UmlnaHQgJiYgdGhpcy5zaXplSW5mby5zZWxlY3RPZmZzZXRSaWdodCA8ICh0aGlzLiRtZW51WzBdLm9mZnNldFdpZHRoIC0gc2VsZWN0V2lkdGgpKTsNCiAgICAgIH0NCg0KICAgICAgdGhpcy4kbWVudS5jc3Moew0KICAgICAgICAnbWF4LWhlaWdodCc6IG1heEhlaWdodCArICdweCcsDQogICAgICAgICdvdmVyZmxvdyc6ICdoaWRkZW4nLA0KICAgICAgICAnbWluLWhlaWdodCc6IG1pbkhlaWdodCArICdweCcNCiAgICAgIH0pOw0KDQogICAgICB0aGlzLiRtZW51SW5uZXIuY3NzKHsNCiAgICAgICAgJ21heC1oZWlnaHQnOiBtZW51SW5uZXJIZWlnaHQgKyAncHgnLA0KICAgICAgICAnb3ZlcmZsb3cteSc6ICdhdXRvJywNCiAgICAgICAgJ21pbi1oZWlnaHQnOiBtZW51SW5uZXJNaW5IZWlnaHQgKyAncHgnDQogICAgICB9KTsNCg0KICAgICAgdGhpcy5zaXplSW5mb1snbWVudUlubmVySGVpZ2h0J10gPSBtZW51SW5uZXJIZWlnaHQ7DQoNCiAgICAgIGlmICh0aGlzLnNlbGVjdHBpY2tlci5jdXJyZW50LmRhdGEubGVuZ3RoICYmIHRoaXMuc2VsZWN0cGlja2VyLmN1cnJlbnQuZGF0YVt0aGlzLnNlbGVjdHBpY2tlci5jdXJyZW50LmRhdGEubGVuZ3RoIC0gMV0ucG9zaXRpb24gPiB0aGlzLnNpemVJbmZvLm1lbnVJbm5lckhlaWdodCkgew0KICAgICAgICB0aGlzLnNpemVJbmZvLmhhc1Njcm9sbEJhciA9IHRydWU7DQogICAgICAgIHRoaXMuc2l6ZUluZm8udG90YWxNZW51V2lkdGggPSB0aGlzLnNpemVJbmZvLm1lbnVXaWR0aCArIHRoaXMuc2l6ZUluZm8uc2Nyb2xsQmFyV2lkdGg7DQoNCiAgICAgICAgdGhpcy4kbWVudS5jc3MoJ21pbi13aWR0aCcsIHRoaXMuc2l6ZUluZm8udG90YWxNZW51V2lkdGgpOw0KICAgICAgfQ0KDQogICAgICBpZiAodGhpcy5kcm9wZG93biAmJiB0aGlzLmRyb3Bkb3duLl9wb3BwZXIpIHRoaXMuZHJvcGRvd24uX3BvcHBlci51cGRhdGUoKTsNCiAgICB9LA0KDQogICAgc2V0U2l6ZTogZnVuY3Rpb24gKHJlZnJlc2gpIHsNCiAgICAgIHRoaXMubGlIZWlnaHQocmVmcmVzaCk7DQoNCiAgICAgIGlmICh0aGlzLm9wdGlvbnMuaGVhZGVyKSB0aGlzLiRtZW51LmNzcygncGFkZGluZy10b3AnLCAwKTsNCiAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2l6ZSA9PT0gZmFsc2UpIHJldHVybjsNCg0KICAgICAgdmFyIHRoYXQgPSB0aGlzLA0KICAgICAgICAgICR3aW5kb3cgPSAkKHdpbmRvdyksDQogICAgICAgICAgc2VsZWN0ZWRJbmRleCwNCiAgICAgICAgICBvZmZzZXQgPSAwOw0KDQogICAgICB0aGlzLnNldE1lbnVTaXplKCk7DQoNCiAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2l6ZSA9PT0gJ2F1dG8nKSB7DQogICAgICAgIHRoaXMuJHNlYXJjaGJveC5vZmYoJ2lucHV0LnNldE1lbnVTaXplIHByb3BlcnR5Y2hhbmdlLnNldE1lbnVTaXplJykub24oJ2lucHV0LnNldE1lbnVTaXplIHByb3BlcnR5Y2hhbmdlLnNldE1lbnVTaXplJywgZnVuY3Rpb24oKSB7DQogICAgICAgICAgcmV0dXJuIHRoYXQuc2V0TWVudVNpemUoKTsNCiAgICAgICAgfSk7DQogICAgICAgICR3aW5kb3cub2ZmKCdyZXNpemUuc2V0TWVudVNpemUgc2Nyb2xsLnNldE1lbnVTaXplJykub24oJ3Jlc2l6ZS5zZXRNZW51U2l6ZSBzY3JvbGwuc2V0TWVudVNpemUnLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICByZXR1cm4gdGhhdC5zZXRNZW51U2l6ZSgpOw0KICAgICAgICB9KTsNCiAgICAgIH0gZWxzZSBpZiAodGhpcy5vcHRpb25zLnNpemUgJiYgdGhpcy5vcHRpb25zLnNpemUgIT0gJ2F1dG8nICYmIHRoaXMuc2VsZWN0cGlja2VyLmN1cnJlbnQuZWxlbWVudHMubGVuZ3RoID4gdGhpcy5vcHRpb25zLnNpemUpIHsNCiAgICAgICAgdGhpcy4kc2VhcmNoYm94Lm9mZignaW5wdXQuc2V0TWVudVNpemUgcHJvcGVydHljaGFuZ2Uuc2V0TWVudVNpemUnKTsNCiAgICAgICAgJHdpbmRvdy5vZmYoJ3Jlc2l6ZS5zZXRNZW51U2l6ZSBzY3JvbGwuc2V0TWVudVNpemUnKTsNCiAgICAgIH0NCg0KICAgICAgaWYgKHJlZnJlc2gpIHsNCiAgICAgICAgb2Zmc2V0ID0gdGhpcy4kbWVudUlubmVyWzBdLnNjcm9sbFRvcDsNCiAgICAgIH0gZWxzZSBpZiAoIXRoYXQubXVsdGlwbGUpIHsNCiAgICAgICAgc2VsZWN0ZWRJbmRleCA9IHRoYXQuc2VsZWN0cGlja2VyLm1haW4ubWFwLm5ld0luZGV4W3RoYXQuJGVsZW1lbnRbMF0uc2VsZWN0ZWRJbmRleF07DQoNCiAgICAgICAgaWYgKHR5cGVvZiBzZWxlY3RlZEluZGV4ID09PSAnbnVtYmVyJyAmJiB0aGF0Lm9wdGlvbnMuc2l6ZSAhPT0gZmFsc2UpIHsNCiAgICAgICAgICBvZmZzZXQgPSB0aGF0LnNpemVJbmZvLmxpSGVpZ2h0ICogc2VsZWN0ZWRJbmRleDsNCiAgICAgICAgICBvZmZzZXQgPSBvZmZzZXQgLSAodGhhdC5zaXplSW5mby5tZW51SW5uZXJIZWlnaHQgLyAyKSArICh0aGF0LnNpemVJbmZvLmxpSGVpZ2h0IC8gMik7DQogICAgICAgIH0NCiAgICAgIH0NCg0KICAgICAgdGhhdC5jcmVhdGVWaWV3KGZhbHNlLCBvZmZzZXQpOw0KICAgIH0sDQoNCiAgICBzZXRXaWR0aDogZnVuY3Rpb24gKCkgew0KICAgICAgdmFyIHRoYXQgPSB0aGlzOw0KDQogICAgICBpZiAodGhpcy5vcHRpb25zLndpZHRoID09PSAnYXV0bycpIHsNCiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkgew0KICAgICAgICAgIHRoYXQuJG1lbnUuY3NzKCdtaW4td2lkdGgnLCAnMCcpOw0KICAgICAgICAgIHRoYXQubGlIZWlnaHQoKTsNCiAgICAgICAgICB0aGF0LnNldE1lbnVTaXplKCk7DQoNCiAgICAgICAgICAvLyBHZXQgY29ycmVjdCB3aWR0aCBpZiBlbGVtZW50IGlzIGhpZGRlbg0KICAgICAgICAgIHZhciAkc2VsZWN0Q2xvbmUgPSB0aGF0LiRuZXdFbGVtZW50LmNsb25lKCkuYXBwZW5kVG8oJ2JvZHknKSwNCiAgICAgICAgICAgICAgYnRuV2lkdGggPSAkc2VsZWN0Q2xvbmUuY3NzKCd3aWR0aCcsICdhdXRvJykuY2hpbGRyZW4oJ2J1dHRvbicpLm91dGVyV2lkdGgoKTsNCg0KICAgICAgICAgICRzZWxlY3RDbG9uZS5yZW1vdmUoKTsNCg0KICAgICAgICAgIC8vIFNldCB3aWR0aCB0byB3aGF0ZXZlcidzIGxhcmdlciwgYnV0dG9uIHRpdGxlIG9yIGxvbmdlc3Qgb3B0aW9uDQogICAgICAgICAgdGhhdC5zaXplSW5mby5zZWxlY3RXaWR0aCA9IE1hdGgubWF4KHRoYXQuc2l6ZUluZm8udG90YWxNZW51V2lkdGgsIGJ0bldpZHRoKTsNCiAgICAgICAgICB0aGF0LiRuZXdFbGVtZW50LmNzcygnd2lkdGgnLCB0aGF0LnNpemVJbmZvLnNlbGVjdFdpZHRoICsgJ3B4Jyk7DQogICAgICAgIH0pOw0KICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbnMud2lkdGggPT09ICdmaXQnKSB7DQogICAgICAgIC8vIFJlbW92ZSBpbmxpbmUgbWluLXdpZHRoIHNvIHdpZHRoIGNhbiBiZSBjaGFuZ2VkIGZyb20gJ2F1dG8nDQogICAgICAgIHRoaXMuJG1lbnUuY3NzKCdtaW4td2lkdGgnLCAnJyk7DQogICAgICAgIHRoaXMuJG5ld0VsZW1lbnQuY3NzKCd3aWR0aCcsICcnKS5hZGRDbGFzcygnZml0LXdpZHRoJyk7DQogICAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy53aWR0aCkgew0KICAgICAgICAvLyBSZW1vdmUgaW5saW5lIG1pbi13aWR0aCBzbyB3aWR0aCBjYW4gYmUgY2hhbmdlZCBmcm9tICdhdXRvJw0KICAgICAgICB0aGlzLiRtZW51LmNzcygnbWluLXdpZHRoJywgJycpOw0KICAgICAgICB0aGlzLiRuZXdFbGVtZW50LmNzcygnd2lkdGgnLCB0aGlzLm9wdGlvbnMud2lkdGgpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgLy8gUmVtb3ZlIGlubGluZSBtaW4td2lkdGgvd2lkdGggc28gd2lkdGggY2FuIGJlIGNoYW5nZWQNCiAgICAgICAgdGhpcy4kbWVudS5jc3MoJ21pbi13aWR0aCcsICcnKTsNCiAgICAgICAgdGhpcy4kbmV3RWxlbWVudC5jc3MoJ3dpZHRoJywgJycpOw0KICAgICAgfQ0KICAgICAgLy8gUmVtb3ZlIGZpdC13aWR0aCBjbGFzcyBpZiB3aWR0aCBpcyBjaGFuZ2VkIHByb2dyYW1tYXRpY2FsbHkNCiAgICAgIGlmICh0aGlzLiRuZXdFbGVtZW50Lmhhc0NsYXNzKCdmaXQtd2lkdGgnKSAmJiB0aGlzLm9wdGlvbnMud2lkdGggIT09ICdmaXQnKSB7DQogICAgICAgIHRoaXMuJG5ld0VsZW1lbnQucmVtb3ZlQ2xhc3MoJ2ZpdC13aWR0aCcpOw0KICAgICAgfQ0KICAgIH0sDQoNCiAgICBzZWxlY3RQb3NpdGlvbjogZnVuY3Rpb24gKCkgew0KICAgICAgdGhpcy4kYnNDb250YWluZXIgPSAkKCc8ZGl2IGNsYXNzPSJicy1jb250YWluZXIiIC8+Jyk7DQoNCiAgICAgIHZhciB0aGF0ID0gdGhpcywNCiAgICAgICAgICAkY29udGFpbmVyID0gJCh0aGlzLm9wdGlvbnMuY29udGFpbmVyKSwNCiAgICAgICAgICBwb3MsDQogICAgICAgICAgY29udGFpbmVyUG9zLA0KICAgICAgICAgIGFjdHVhbEhlaWdodCwNCiAgICAgICAgICBnZXRQbGFjZW1lbnQgPSBmdW5jdGlvbiAoJGVsZW1lbnQpIHsNCiAgICAgICAgICAgIHZhciBjb250YWluZXJQb3NpdGlvbiA9IHt9Ow0KDQogICAgICAgICAgICB0aGF0LiRic0NvbnRhaW5lci5hZGRDbGFzcygkZWxlbWVudC5hdHRyKCdjbGFzcycpLnJlcGxhY2UoL2Zvcm0tY29udHJvbHxmaXQtd2lkdGgvZ2ksICcnKSkudG9nZ2xlQ2xhc3MoY2xhc3NOYW1lcy5EUk9QVVAsICRlbGVtZW50Lmhhc0NsYXNzKGNsYXNzTmFtZXMuRFJPUFVQKSk7DQogICAgICAgICAgICBwb3MgPSAkZWxlbWVudC5vZmZzZXQoKTsNCg0KICAgICAgICAgICAgaWYgKCEkY29udGFpbmVyLmlzKCdib2R5JykpIHsNCiAgICAgICAgICAgICAgY29udGFpbmVyUG9zID0gJGNvbnRhaW5lci5vZmZzZXQoKTsNCiAgICAgICAgICAgICAgY29udGFpbmVyUG9zLnRvcCArPSBwYXJzZUludCgkY29udGFpbmVyLmNzcygnYm9yZGVyVG9wV2lkdGgnKSkgLSAkY29udGFpbmVyLnNjcm9sbFRvcCgpOw0KICAgICAgICAgICAgICBjb250YWluZXJQb3MubGVmdCArPSBwYXJzZUludCgkY29udGFpbmVyLmNzcygnYm9yZGVyTGVmdFdpZHRoJykpIC0gJGNvbnRhaW5lci5zY3JvbGxMZWZ0KCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICBjb250YWluZXJQb3MgPSB7IHRvcDogMCwgbGVmdDogMCB9Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBhY3R1YWxIZWlnaHQgPSAkZWxlbWVudC5oYXNDbGFzcyhjbGFzc05hbWVzLkRST1BVUCkgPyAwIDogJGVsZW1lbnRbMF0ub2Zmc2V0SGVpZ2h0Ow0KDQogICAgICAgICAgICAvLyBCb290c3RyYXAgNCsgdXNlcyBQb3BwZXIgZm9yIG1lbnUgcG9zaXRpb25pbmcNCiAgICAgICAgICAgIGlmICh2ZXJzaW9uLm1ham9yIDwgNCkgew0KICAgICAgICAgICAgICBjb250YWluZXJQb3NpdGlvblsndG9wJ10gPSBwb3MudG9wIC0gY29udGFpbmVyUG9zLnRvcCArIGFjdHVhbEhlaWdodDsNCiAgICAgICAgICAgICAgY29udGFpbmVyUG9zaXRpb25bJ2xlZnQnXSA9IHBvcy5sZWZ0IC0gY29udGFpbmVyUG9zLmxlZnQ7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGNvbnRhaW5lclBvc2l0aW9uWyd3aWR0aCddID0gJGVsZW1lbnRbMF0ub2Zmc2V0V2lkdGg7DQoNCiAgICAgICAgICAgIHRoYXQuJGJzQ29udGFpbmVyLmNzcyhjb250YWluZXJQb3NpdGlvbik7DQogICAgICAgICAgfTsNCg0KICAgICAgdGhpcy4kYnV0dG9uLm9uKCdjbGljay5icy5kcm9wZG93bi5kYXRhLWFwaScsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgaWYgKHRoYXQuaXNEaXNhYmxlZCgpKSB7DQogICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgZ2V0UGxhY2VtZW50KHRoYXQuJG5ld0VsZW1lbnQpOw0KDQogICAgICAgIHRoYXQuJGJzQ29udGFpbmVyDQogICAgICAgICAgLmFwcGVuZFRvKHRoYXQub3B0aW9ucy5jb250YWluZXIpDQogICAgICAgICAgLnRvZ2dsZUNsYXNzKGNsYXNzTmFtZXMuU0hPVywgIXRoYXQuJGJ1dHRvbi5oYXNDbGFzcyhjbGFzc05hbWVzLlNIT1cpKQ0KICAgICAgICAgIC5hcHBlbmQodGhhdC4kbWVudSk7DQogICAgICB9KTsNCg0KICAgICAgJCh3aW5kb3cpLm9uKCdyZXNpemUgc2Nyb2xsJywgZnVuY3Rpb24gKCkgew0KICAgICAgICBnZXRQbGFjZW1lbnQodGhhdC4kbmV3RWxlbWVudCk7DQogICAgICB9KTsNCg0KICAgICAgdGhpcy4kZWxlbWVudC5vbignaGlkZS5icy5zZWxlY3QnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgIHRoYXQuJG1lbnUuZGF0YSgnaGVpZ2h0JywgdGhhdC4kbWVudS5oZWlnaHQoKSk7DQogICAgICAgIHRoYXQuJGJzQ29udGFpbmVyLmRldGFjaCgpOw0KICAgICAgfSk7DQogICAgfSwNCg0KICAgIHNldE9wdGlvblN0YXR1czogZnVuY3Rpb24gKCkgew0KICAgICAgdmFyIHRoYXQgPSB0aGlzLA0KICAgICAgICAgICRzZWxlY3RPcHRpb25zID0gdGhpcy4kZWxlbWVudC5maW5kKCdvcHRpb24nKTsNCg0KICAgICAgdGhhdC5ub1Njcm9sbCA9IGZhbHNlOw0KDQogICAgICBpZiAodGhhdC5zZWxlY3RwaWNrZXIudmlldy52aXNpYmxlRWxlbWVudHMgJiYgdGhhdC5zZWxlY3RwaWNrZXIudmlldy52aXNpYmxlRWxlbWVudHMubGVuZ3RoKSB7DQogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhhdC5zZWxlY3RwaWNrZXIudmlldy52aXNpYmxlRWxlbWVudHMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICB2YXIgaW5kZXggPSB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50Lm1hcC5vcmlnaW5hbEluZGV4W2kgKyB0aGF0LnNlbGVjdHBpY2tlci52aWV3LnBvc2l0aW9uMF0sIC8vIGZhc3RlciB0aGFuICQobGkpLmRhdGEoJ29yaWdpbmFsSW5kZXgnKQ0KICAgICAgICAgICAgICBvcHRpb24gPSAkc2VsZWN0T3B0aW9uc1tpbmRleF07DQoNCiAgICAgICAgICBpZiAob3B0aW9uKSB7DQogICAgICAgICAgICB2YXIgbGlJbmRleCA9IHRoaXMuc2VsZWN0cGlja2VyLm1haW4ubWFwLm5ld0luZGV4W2luZGV4XSwNCiAgICAgICAgICAgICAgICBsaSA9IHRoaXMuc2VsZWN0cGlja2VyLm1haW4uZWxlbWVudHNbbGlJbmRleF07DQoNCiAgICAgICAgICAgIHRoYXQuc2V0RGlzYWJsZWQoDQogICAgICAgICAgICAgIGluZGV4LA0KICAgICAgICAgICAgICBvcHRpb24uZGlzYWJsZWQgfHwgb3B0aW9uLnBhcmVudE5vZGUudGFnTmFtZSA9PT0gJ09QVEdST1VQJyAmJiBvcHRpb24ucGFyZW50Tm9kZS5kaXNhYmxlZCwNCiAgICAgICAgICAgICAgbGlJbmRleCwNCiAgICAgICAgICAgICAgbGkNCiAgICAgICAgICAgICk7DQoNCiAgICAgICAgICAgIHRoYXQuc2V0U2VsZWN0ZWQoDQogICAgICAgICAgICAgIGluZGV4LA0KICAgICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQsDQogICAgICAgICAgICAgIGxpSW5kZXgsDQogICAgICAgICAgICAgIGxpDQogICAgICAgICAgICApOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXggLSB0aGUgaW5kZXggb2YgdGhlIG9wdGlvbiB0aGF0IGlzIGJlaW5nIGNoYW5nZWQNCiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IHNlbGVjdGVkIC0gdHJ1ZSBpZiB0aGUgb3B0aW9uIGlzIGJlaW5nIHNlbGVjdGVkLCBmYWxzZSBpZiBiZWluZyBkZXNlbGVjdGVkDQogICAgICovDQogICAgc2V0U2VsZWN0ZWQ6IGZ1bmN0aW9uIChpbmRleCwgc2VsZWN0ZWQsIGxpSW5kZXgsIGxpKSB7DQogICAgICB2YXIgYWN0aXZlSW5kZXhJc1NldCA9IHRoaXMuYWN0aXZlSW5kZXggIT09IHVuZGVmaW5lZCwNCiAgICAgICAgICB0aGlzSXNBY3RpdmUgPSB0aGlzLmFjdGl2ZUluZGV4ID09PSBpbmRleCwNCiAgICAgICAgICBwcmV2QWN0aXZlSW5kZXgsDQogICAgICAgICAgcHJldkFjdGl2ZSwNCiAgICAgICAgICBhLA0KICAgICAgICAgIC8vIGlmIGN1cnJlbnQgb3B0aW9uIGlzIGFscmVhZHkgYWN0aXZlDQogICAgICAgICAgLy8gT1INCiAgICAgICAgICAvLyBpZiB0aGUgY3VycmVudCBvcHRpb24gaXMgYmVpbmcgc2VsZWN0ZWQsIGl0J3MgTk9UIG11bHRpcGxlLCBhbmQNCiAgICAgICAgICAvLyBhY3RpdmVJbmRleCBpcyB1bmRlZmluZWQ6DQogICAgICAgICAgLy8gIC0gd2hlbiB0aGUgbWVudSBpcyBmaXJzdCBiZWluZyBvcGVuZWQsIE9SDQogICAgICAgICAgLy8gIC0gYWZ0ZXIgYSBzZWFyY2ggaGFzIGJlZW4gcGVyZm9ybWVkLCBPUg0KICAgICAgICAgIC8vICAtIHdoZW4gcmV0YWluQWN0aXZlIGlzIGZhbHNlIHdoZW4gc2VsZWN0aW5nIGEgbmV3IG9wdGlvbiAoaS5lLiBpbmRleCBvZiB0aGUgbmV3bHkgc2VsZWN0ZWQgb3B0aW9uIGlzIG5vdCB0aGUgc2FtZSBhcyB0aGUgY3VycmVudCBhY3RpdmVJbmRleCkNCiAgICAgICAgICBrZWVwQWN0aXZlID0gdGhpc0lzQWN0aXZlIHx8IHNlbGVjdGVkICYmICF0aGlzLm11bHRpcGxlICYmICFhY3RpdmVJbmRleElzU2V0Ow0KDQogICAgICBpZiAoIWxpSW5kZXgpIGxpSW5kZXggPSB0aGlzLnNlbGVjdHBpY2tlci5tYWluLm1hcC5uZXdJbmRleFtpbmRleF07DQogICAgICBpZiAoIWxpKSBsaSA9IHRoaXMuc2VsZWN0cGlja2VyLm1haW4uZWxlbWVudHNbbGlJbmRleF07DQoNCiAgICAgIGEgPSBsaS5maXJzdENoaWxkOw0KDQogICAgICBpZiAoc2VsZWN0ZWQpIHsNCiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gaW5kZXg7DQogICAgICB9DQoNCiAgICAgIGxpLmNsYXNzTGlzdC50b2dnbGUoJ3NlbGVjdGVkJywgc2VsZWN0ZWQpOw0KICAgICAgbGkuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJywga2VlcEFjdGl2ZSk7DQoNCiAgICAgIGlmIChrZWVwQWN0aXZlKSB7DQogICAgICAgIHRoaXMuc2VsZWN0cGlja2VyLnZpZXcuY3VycmVudEFjdGl2ZSA9IGxpOw0KICAgICAgICB0aGlzLmFjdGl2ZUluZGV4ID0gaW5kZXg7DQogICAgICB9DQoNCiAgICAgIGlmIChhKSB7DQogICAgICAgIGEuY2xhc3NMaXN0LnRvZ2dsZSgnc2VsZWN0ZWQnLCBzZWxlY3RlZCk7DQogICAgICAgIGEuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJywga2VlcEFjdGl2ZSk7DQogICAgICAgIGEuc2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgc2VsZWN0ZWQpOw0KICAgICAgfQ0KDQogICAgICBpZiAoIWtlZXBBY3RpdmUpIHsNCiAgICAgICAgaWYgKCFhY3RpdmVJbmRleElzU2V0ICYmIHNlbGVjdGVkICYmIHRoaXMucHJldkFjdGl2ZUluZGV4ICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICBwcmV2QWN0aXZlSW5kZXggPSB0aGlzLnNlbGVjdHBpY2tlci5tYWluLm1hcC5uZXdJbmRleFt0aGlzLnByZXZBY3RpdmVJbmRleF07DQogICAgICAgICAgcHJldkFjdGl2ZSA9IHRoaXMuc2VsZWN0cGlja2VyLm1haW4uZWxlbWVudHNbcHJldkFjdGl2ZUluZGV4XTsNCg0KICAgICAgICAgIHByZXZBY3RpdmUuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTsNCiAgICAgICAgICBwcmV2QWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOw0KICAgICAgICAgIGlmIChwcmV2QWN0aXZlLmZpcnN0Q2hpbGQpIHsNCiAgICAgICAgICAgIHByZXZBY3RpdmUuZmlyc3RDaGlsZC5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpOw0KICAgICAgICAgICAgcHJldkFjdGl2ZS5maXJzdENoaWxkLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0sDQoNCiAgICAvKioNCiAgICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXggLSB0aGUgaW5kZXggb2YgdGhlIG9wdGlvbiB0aGF0IGlzIGJlaW5nIGRpc2FibGVkDQogICAgICogQHBhcmFtIHtib29sZWFufSBkaXNhYmxlZCAtIHRydWUgaWYgdGhlIG9wdGlvbiBpcyBiZWluZyBkaXNhYmxlZCwgZmFsc2UgaWYgYmVpbmcgZW5hYmxlZA0KICAgICAqLw0KICAgIHNldERpc2FibGVkOiBmdW5jdGlvbiAoaW5kZXgsIGRpc2FibGVkLCBsaUluZGV4LCBsaSkgew0KICAgICAgdmFyIGE7DQoNCiAgICAgIGlmICghbGlJbmRleCkgbGlJbmRleCA9IHRoaXMuc2VsZWN0cGlja2VyLm1haW4ubWFwLm5ld0luZGV4W2luZGV4XTsNCiAgICAgIGlmICghbGkpIGxpID0gdGhpcy5zZWxlY3RwaWNrZXIubWFpbi5lbGVtZW50c1tsaUluZGV4XTsNCg0KICAgICAgYSA9IGxpLmZpcnN0Q2hpbGQ7DQoNCiAgICAgIGxpLmNsYXNzTGlzdC50b2dnbGUoY2xhc3NOYW1lcy5ESVNBQkxFRCwgZGlzYWJsZWQpOw0KDQogICAgICBpZiAoYSkgew0KICAgICAgICBpZiAodmVyc2lvbi5tYWpvciA9PT0gJzQnKSBhLmNsYXNzTGlzdC50b2dnbGUoY2xhc3NOYW1lcy5ESVNBQkxFRCwgZGlzYWJsZWQpOw0KDQogICAgICAgIGEuc2V0QXR0cmlidXRlKCdhcmlhLWRpc2FibGVkJywgZGlzYWJsZWQpOw0KDQogICAgICAgIGlmIChkaXNhYmxlZCkgew0KICAgICAgICAgIGEuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIC0xKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBhLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAwKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0sDQoNCiAgICBpc0Rpc2FibGVkOiBmdW5jdGlvbiAoKSB7DQogICAgICByZXR1cm4gdGhpcy4kZWxlbWVudFswXS5kaXNhYmxlZDsNCiAgICB9LA0KDQogICAgY2hlY2tEaXNhYmxlZDogZnVuY3Rpb24gKCkgew0KICAgICAgdmFyIHRoYXQgPSB0aGlzOw0KDQogICAgICBpZiAodGhpcy5pc0Rpc2FibGVkKCkpIHsNCiAgICAgICAgdGhpcy4kbmV3RWxlbWVudC5hZGRDbGFzcyhjbGFzc05hbWVzLkRJU0FCTEVEKTsNCiAgICAgICAgdGhpcy4kYnV0dG9uLmFkZENsYXNzKGNsYXNzTmFtZXMuRElTQUJMRUQpLmF0dHIoJ3RhYmluZGV4JywgLTEpLmF0dHIoJ2FyaWEtZGlzYWJsZWQnLCB0cnVlKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGlmICh0aGlzLiRidXR0b24uaGFzQ2xhc3MoY2xhc3NOYW1lcy5ESVNBQkxFRCkpIHsNCiAgICAgICAgICB0aGlzLiRuZXdFbGVtZW50LnJlbW92ZUNsYXNzKGNsYXNzTmFtZXMuRElTQUJMRUQpOw0KICAgICAgICAgIHRoaXMuJGJ1dHRvbi5yZW1vdmVDbGFzcyhjbGFzc05hbWVzLkRJU0FCTEVEKS5hdHRyKCdhcmlhLWRpc2FibGVkJywgZmFsc2UpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKHRoaXMuJGJ1dHRvbi5hdHRyKCd0YWJpbmRleCcpID09IC0xICYmICF0aGlzLiRlbGVtZW50LmRhdGEoJ3RhYmluZGV4JykpIHsNCiAgICAgICAgICB0aGlzLiRidXR0b24ucmVtb3ZlQXR0cigndGFiaW5kZXgnKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KDQogICAgICB0aGlzLiRidXR0b24uY2xpY2soZnVuY3Rpb24gKCkgew0KICAgICAgICByZXR1cm4gIXRoYXQuaXNEaXNhYmxlZCgpOw0KICAgICAgfSk7DQogICAgfSwNCg0KICAgIHRvZ2dsZVBsYWNlaG9sZGVyOiBmdW5jdGlvbiAoKSB7DQogICAgICAvLyBtdWNoIGZhc3RlciB0aGFuIGNhbGxpbmcgJC52YWwoKQ0KICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLiRlbGVtZW50WzBdLA0KICAgICAgICAgIHNlbGVjdGVkSW5kZXggPSBlbGVtZW50LnNlbGVjdGVkSW5kZXgsDQogICAgICAgICAgbm90aGluZ1NlbGVjdGVkID0gc2VsZWN0ZWRJbmRleCA9PT0gLTE7DQoNCiAgICAgIGlmICghbm90aGluZ1NlbGVjdGVkICYmICFlbGVtZW50Lm9wdGlvbnNbc2VsZWN0ZWRJbmRleF0udmFsdWUpIG5vdGhpbmdTZWxlY3RlZCA9IHRydWU7DQoNCiAgICAgIHRoaXMuJGJ1dHRvbi50b2dnbGVDbGFzcygnYnMtcGxhY2Vob2xkZXInLCBub3RoaW5nU2VsZWN0ZWQpOw0KICAgIH0sDQoNCiAgICB0YWJJbmRleDogZnVuY3Rpb24gKCkgew0KICAgICAgaWYgKHRoaXMuJGVsZW1lbnQuZGF0YSgndGFiaW5kZXgnKSAhPT0gdGhpcy4kZWxlbWVudC5hdHRyKCd0YWJpbmRleCcpICYmIA0KICAgICAgICAodGhpcy4kZWxlbWVudC5hdHRyKCd0YWJpbmRleCcpICE9PSAtOTggJiYgdGhpcy4kZWxlbWVudC5hdHRyKCd0YWJpbmRleCcpICE9PSAnLTk4JykpIHsNCiAgICAgICAgdGhpcy4kZWxlbWVudC5kYXRhKCd0YWJpbmRleCcsIHRoaXMuJGVsZW1lbnQuYXR0cigndGFiaW5kZXgnKSk7DQogICAgICAgIHRoaXMuJGJ1dHRvbi5hdHRyKCd0YWJpbmRleCcsIHRoaXMuJGVsZW1lbnQuZGF0YSgndGFiaW5kZXgnKSk7DQogICAgICB9DQoNCiAgICAgIHRoaXMuJGVsZW1lbnQuYXR0cigndGFiaW5kZXgnLCAtOTgpOw0KICAgIH0sDQoNCiAgICBjbGlja0xpc3RlbmVyOiBmdW5jdGlvbiAoKSB7DQogICAgICB2YXIgdGhhdCA9IHRoaXMsDQogICAgICAgICAgJGRvY3VtZW50ID0gJChkb2N1bWVudCk7DQoNCiAgICAgICRkb2N1bWVudC5kYXRhKCdzcGFjZVNlbGVjdCcsIGZhbHNlKTsNCg0KICAgICAgdGhpcy4kYnV0dG9uLm9uKCdrZXl1cCcsIGZ1bmN0aW9uIChlKSB7DQogICAgICAgIGlmICgvKDMyKS8udGVzdChlLmtleUNvZGUudG9TdHJpbmcoMTApKSAmJiAkZG9jdW1lbnQuZGF0YSgnc3BhY2VTZWxlY3QnKSkgew0KICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgJGRvY3VtZW50LmRhdGEoJ3NwYWNlU2VsZWN0JywgZmFsc2UpOw0KICAgICAgICB9DQogICAgICB9KTsNCg0KICAgICAgdGhpcy4kbmV3RWxlbWVudC5vbignc2hvdy5icy5kcm9wZG93bicsIGZ1bmN0aW9uKCkgew0KICAgICAgICBpZiAodmVyc2lvbi5tYWpvciA+IDMgJiYgIXRoYXQuZHJvcGRvd24pIHsNCiAgICAgICAgICB0aGF0LmRyb3Bkb3duID0gdGhhdC4kYnV0dG9uLmRhdGEoJ2JzLmRyb3Bkb3duJyk7DQogICAgICAgICAgdGhhdC5kcm9wZG93bi5fbWVudSA9IHRoYXQuJG1lbnVbMF07DQogICAgICAgIH0NCiAgICAgIH0pOw0KDQogICAgICB0aGlzLiRidXR0b24ub24oJ2NsaWNrLmJzLmRyb3Bkb3duLmRhdGEtYXBpJywgZnVuY3Rpb24gKCkgew0KICAgICAgICBpZiAoIXRoYXQuJG5ld0VsZW1lbnQuaGFzQ2xhc3MoY2xhc3NOYW1lcy5TSE9XKSkgew0KICAgICAgICAgIHRoYXQuc2V0U2l6ZSgpOw0KICAgICAgICB9DQogICAgICB9KTsNCg0KICAgICAgdGhpcy4kZWxlbWVudC5vbignc2hvd24uYnMuc2VsZWN0JywgZnVuY3Rpb24gKCkgew0KICAgICAgICBpZiAodGhhdC4kbWVudUlubmVyWzBdLnNjcm9sbFRvcCAhPT0gdGhhdC5zZWxlY3RwaWNrZXIudmlldy5zY3JvbGxUb3ApIHsNCiAgICAgICAgICB0aGF0LiRtZW51SW5uZXJbMF0uc2Nyb2xsVG9wID0gdGhhdC5zZWxlY3RwaWNrZXIudmlldy5zY3JvbGxUb3A7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAodGhhdC5vcHRpb25zLmxpdmVTZWFyY2gpIHsNCiAgICAgICAgICB0aGF0LiRzZWFyY2hib3guZm9jdXMoKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGF0LiRtZW51SW5uZXIuZm9jdXMoKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQoNCiAgICAgIHRoaXMuJG1lbnVJbm5lci5vbignY2xpY2snLCAnbGkgYScsIGZ1bmN0aW9uIChlLCByZXRhaW5BY3RpdmUpIHsNCiAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKSwNCiAgICAgICAgICAgIHBvc2l0aW9uMCA9IHRoYXQuaXNWaXJ0dWFsKCkgPyB0aGF0LnNlbGVjdHBpY2tlci52aWV3LnBvc2l0aW9uMCA6IDAsDQogICAgICAgICAgICBjbGlja2VkSW5kZXggPSB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50Lm1hcC5vcmlnaW5hbEluZGV4WyR0aGlzLnBhcmVudCgpLmluZGV4KCkgKyBwb3NpdGlvbjBdLA0KICAgICAgICAgICAgcHJldlZhbHVlID0gZ2V0U2VsZWN0VmFsdWVzKHRoYXQuJGVsZW1lbnRbMF0pLA0KICAgICAgICAgICAgcHJldkluZGV4ID0gdGhhdC4kZWxlbWVudC5wcm9wKCdzZWxlY3RlZEluZGV4JyksDQogICAgICAgICAgICB0cmlnZ2VyQ2hhbmdlID0gdHJ1ZTsNCg0KICAgICAgICAvLyBEb24ndCBjbG9zZSBvbiBtdWx0aSBjaG9pY2UgbWVudQ0KICAgICAgICBpZiAodGhhdC5tdWx0aXBsZSAmJiB0aGF0Lm9wdGlvbnMubWF4T3B0aW9ucyAhPT0gMSkgew0KICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgIH0NCg0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQoNCiAgICAgICAgLy9Eb24ndCBydW4gaWYgd2UgaGF2ZSBiZWVuIGRpc2FibGVkDQogICAgICAgIGlmICghdGhhdC5pc0Rpc2FibGVkKCkgJiYgISR0aGlzLnBhcmVudCgpLmhhc0NsYXNzKGNsYXNzTmFtZXMuRElTQUJMRUQpKSB7DQogICAgICAgICAgdmFyICRvcHRpb25zID0gdGhhdC4kZWxlbWVudC5maW5kKCdvcHRpb24nKSwNCiAgICAgICAgICAgICAgJG9wdGlvbiA9ICRvcHRpb25zLmVxKGNsaWNrZWRJbmRleCksDQogICAgICAgICAgICAgIHN0YXRlID0gJG9wdGlvbi5wcm9wKCdzZWxlY3RlZCcpLA0KICAgICAgICAgICAgICAkb3B0Z3JvdXAgPSAkb3B0aW9uLnBhcmVudCgnb3B0Z3JvdXAnKSwNCiAgICAgICAgICAgICAgbWF4T3B0aW9ucyA9IHRoYXQub3B0aW9ucy5tYXhPcHRpb25zLA0KICAgICAgICAgICAgICBtYXhPcHRpb25zR3JwID0gJG9wdGdyb3VwLmRhdGEoJ21heE9wdGlvbnMnKSB8fCBmYWxzZTsNCiAgICAgICAgICAgICAgDQogICAgICAgICAgaWYgKGNsaWNrZWRJbmRleCA9PT0gdGhhdC5hY3RpdmVJbmRleCkgcmV0YWluQWN0aXZlID0gdHJ1ZTsNCg0KICAgICAgICAgIGlmICghcmV0YWluQWN0aXZlKSB7DQogICAgICAgICAgICB0aGF0LnByZXZBY3RpdmVJbmRleCA9IHRoYXQuYWN0aXZlSW5kZXg7DQogICAgICAgICAgICB0aGF0LmFjdGl2ZUluZGV4ID0gdW5kZWZpbmVkOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIGlmICghdGhhdC5tdWx0aXBsZSkgeyAvLyBEZXNlbGVjdCBhbGwgb3RoZXJzIGlmIG5vdCBtdWx0aSBzZWxlY3QgYm94DQogICAgICAgICAgICAkb3B0aW9ucy5wcm9wKCdzZWxlY3RlZCcsIGZhbHNlKTsNCiAgICAgICAgICAgICRvcHRpb24ucHJvcCgnc2VsZWN0ZWQnLCB0cnVlKTsNCiAgICAgICAgICAgIHRoYXQuc2V0U2VsZWN0ZWQoY2xpY2tlZEluZGV4LCB0cnVlKTsNCiAgICAgICAgICB9IGVsc2UgeyAvLyBUb2dnbGUgdGhlIG9uZSB3ZSBoYXZlIGNob3NlbiBpZiB3ZSBhcmUgbXVsdGkgc2VsZWN0Lg0KICAgICAgICAgICAgJG9wdGlvbi5wcm9wKCdzZWxlY3RlZCcsICFzdGF0ZSk7DQoNCiAgICAgICAgICAgIHRoYXQuc2V0U2VsZWN0ZWQoY2xpY2tlZEluZGV4LCAhc3RhdGUpOw0KICAgICAgICAgICAgJHRoaXMuYmx1cigpOw0KDQogICAgICAgICAgICBpZiAobWF4T3B0aW9ucyAhPT0gZmFsc2UgfHwgbWF4T3B0aW9uc0dycCAhPT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgdmFyIG1heFJlYWNoZWQgPSBtYXhPcHRpb25zIDwgJG9wdGlvbnMuZmlsdGVyKCc6c2VsZWN0ZWQnKS5sZW5ndGgsDQogICAgICAgICAgICAgICAgICBtYXhSZWFjaGVkR3JwID0gbWF4T3B0aW9uc0dycCA8ICRvcHRncm91cC5maW5kKCdvcHRpb246c2VsZWN0ZWQnKS5sZW5ndGg7DQoNCiAgICAgICAgICAgICAgaWYgKChtYXhPcHRpb25zICYmIG1heFJlYWNoZWQpIHx8IChtYXhPcHRpb25zR3JwICYmIG1heFJlYWNoZWRHcnApKSB7DQogICAgICAgICAgICAgICAgaWYgKG1heE9wdGlvbnMgJiYgbWF4T3B0aW9ucyA9PSAxKSB7DQogICAgICAgICAgICAgICAgICAkb3B0aW9ucy5wcm9wKCdzZWxlY3RlZCcsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICRvcHRpb24ucHJvcCgnc2VsZWN0ZWQnLCB0cnVlKTsNCiAgICAgICAgICAgICAgICAgIHRoYXQuJG1lbnVJbm5lci5maW5kKCcuc2VsZWN0ZWQnKS5yZW1vdmVDbGFzcygnc2VsZWN0ZWQnKTsNCiAgICAgICAgICAgICAgICAgIHRoYXQuc2V0U2VsZWN0ZWQoY2xpY2tlZEluZGV4LCB0cnVlKTsNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1heE9wdGlvbnNHcnAgJiYgbWF4T3B0aW9uc0dycCA9PSAxKSB7DQogICAgICAgICAgICAgICAgICAkb3B0Z3JvdXAuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykucHJvcCgnc2VsZWN0ZWQnLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAkb3B0aW9uLnByb3AoJ3NlbGVjdGVkJywgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICB2YXIgb3B0Z3JvdXBJRCA9IHRoYXQuc2VsZWN0cGlja2VyLmN1cnJlbnQuZGF0YVskdGhpcy5wYXJlbnQoKS5pbmRleCgpICsgdGhhdC5zZWxlY3RwaWNrZXIudmlldy5wb3NpdGlvbjBdLm9wdElEOw0KICAgICAgICAgICAgICAgICAgdGhhdC4kbWVudUlubmVyLmZpbmQoJy5vcHRncm91cC0nICsgb3B0Z3JvdXBJRCkucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7DQogICAgICAgICAgICAgICAgICB0aGF0LnNldFNlbGVjdGVkKGNsaWNrZWRJbmRleCwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgIHZhciBtYXhPcHRpb25zVGV4dCA9IHR5cGVvZiB0aGF0Lm9wdGlvbnMubWF4T3B0aW9uc1RleHQgPT09ICdzdHJpbmcnID8gW3RoYXQub3B0aW9ucy5tYXhPcHRpb25zVGV4dCwgdGhhdC5vcHRpb25zLm1heE9wdGlvbnNUZXh0XSA6IHRoYXQub3B0aW9ucy5tYXhPcHRpb25zVGV4dCwNCiAgICAgICAgICAgICAgICAgICAgICBtYXhPcHRpb25zQXJyID0gdHlwZW9mIG1heE9wdGlvbnNUZXh0ID09PSAnZnVuY3Rpb24nID8gbWF4T3B0aW9uc1RleHQobWF4T3B0aW9ucywgbWF4T3B0aW9uc0dycCkgOiBtYXhPcHRpb25zVGV4dCwNCiAgICAgICAgICAgICAgICAgICAgICBtYXhUeHQgPSBtYXhPcHRpb25zQXJyWzBdLnJlcGxhY2UoJ3tufScsIG1heE9wdGlvbnMpLA0KICAgICAgICAgICAgICAgICAgICAgIG1heFR4dEdycCA9IG1heE9wdGlvbnNBcnJbMV0ucmVwbGFjZSgne259JywgbWF4T3B0aW9uc0dycCksDQogICAgICAgICAgICAgICAgICAgICAgJG5vdGlmeSA9ICQoJzxkaXYgY2xhc3M9Im5vdGlmeSI+PC9kaXY+Jyk7DQogICAgICAgICAgICAgICAgICAvLyBJZiB7dmFyfSBpcyBzZXQgaW4gYXJyYXksIHJlcGxhY2UgaXQNCiAgICAgICAgICAgICAgICAgIC8qKiBAZGVwcmVjYXRlZCAqLw0KICAgICAgICAgICAgICAgICAgaWYgKG1heE9wdGlvbnNBcnJbMl0pIHsNCiAgICAgICAgICAgICAgICAgICAgbWF4VHh0ID0gbWF4VHh0LnJlcGxhY2UoJ3t2YXJ9JywgbWF4T3B0aW9uc0FyclsyXVttYXhPcHRpb25zID4gMSA/IDAgOiAxXSk7DQogICAgICAgICAgICAgICAgICAgIG1heFR4dEdycCA9IG1heFR4dEdycC5yZXBsYWNlKCd7dmFyfScsIG1heE9wdGlvbnNBcnJbMl1bbWF4T3B0aW9uc0dycCA+IDEgPyAwIDogMV0pOw0KICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAkb3B0aW9uLnByb3AoJ3NlbGVjdGVkJywgZmFsc2UpOw0KDQogICAgICAgICAgICAgICAgICB0aGF0LiRtZW51LmFwcGVuZCgkbm90aWZ5KTsNCg0KICAgICAgICAgICAgICAgICAgaWYgKG1heE9wdGlvbnMgJiYgbWF4UmVhY2hlZCkgew0KICAgICAgICAgICAgICAgICAgICAkbm90aWZ5LmFwcGVuZCgkKCc8ZGl2PicgKyBtYXhUeHQgKyAnPC9kaXY+JykpOw0KICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyQ2hhbmdlID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuJGVsZW1lbnQudHJpZ2dlcignbWF4UmVhY2hlZC5icy5zZWxlY3QnKTsNCiAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgaWYgKG1heE9wdGlvbnNHcnAgJiYgbWF4UmVhY2hlZEdycCkgew0KICAgICAgICAgICAgICAgICAgICAkbm90aWZ5LmFwcGVuZCgkKCc8ZGl2PicgKyBtYXhUeHRHcnAgKyAnPC9kaXY+JykpOw0KICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyQ2hhbmdlID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuJGVsZW1lbnQudHJpZ2dlcignbWF4UmVhY2hlZEdycC5icy5zZWxlY3QnKTsNCiAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0U2VsZWN0ZWQoY2xpY2tlZEluZGV4LCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICB9LCAxMCk7DQoNCiAgICAgICAgICAgICAgICAgICRub3RpZnkuZGVsYXkoNzUwKS5mYWRlT3V0KDMwMCwgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZSgpOw0KICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KDQogICAgICAgICAgaWYgKCF0aGF0Lm11bHRpcGxlIHx8ICh0aGF0Lm11bHRpcGxlICYmIHRoYXQub3B0aW9ucy5tYXhPcHRpb25zID09PSAxKSkgew0KICAgICAgICAgICAgdGhhdC4kYnV0dG9uLmZvY3VzKCk7DQogICAgICAgICAgfSBlbHNlIGlmICh0aGF0Lm9wdGlvbnMubGl2ZVNlYXJjaCkgew0KICAgICAgICAgICAgdGhhdC4kc2VhcmNoYm94LmZvY3VzKCk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLy8gVHJpZ2dlciBzZWxlY3QgJ2NoYW5nZScNCiAgICAgICAgICBpZiAodHJpZ2dlckNoYW5nZSkgew0KICAgICAgICAgICAgaWYgKChwcmV2VmFsdWUgIT0gZ2V0U2VsZWN0VmFsdWVzKHRoYXQuJGVsZW1lbnRbMF0pICYmIHRoYXQubXVsdGlwbGUpIHx8IChwcmV2SW5kZXggIT0gdGhhdC4kZWxlbWVudC5wcm9wKCdzZWxlY3RlZEluZGV4JykgJiYgIXRoYXQubXVsdGlwbGUpKSB7DQogICAgICAgICAgICAgIC8vICRvcHRpb24ucHJvcCgnc2VsZWN0ZWQnKSBpcyBjdXJyZW50IG9wdGlvbiBzdGF0ZSAoc2VsZWN0ZWQvdW5zZWxlY3RlZCkuIHByZXZWYWx1ZSBpcyB0aGUgdmFsdWUgb2YgdGhlIHNlbGVjdCBwcmlvciB0byBiZWluZyBjaGFuZ2VkLg0KICAgICAgICAgICAgICBjaGFuZ2VkX2FyZ3VtZW50cyA9IFtjbGlja2VkSW5kZXgsICRvcHRpb24ucHJvcCgnc2VsZWN0ZWQnKSwgcHJldlZhbHVlXTsNCiAgICAgICAgICAgICAgdGhhdC4kZWxlbWVudA0KICAgICAgICAgICAgICAgIC50cmlnZ2VyTmF0aXZlKCdjaGFuZ2UnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0pOw0KDQogICAgICB0aGlzLiRtZW51Lm9uKCdjbGljaycsICdsaS4nICsgY2xhc3NOYW1lcy5ESVNBQkxFRCArICcgYSwgLicgKyBjbGFzc05hbWVzLlBPUE9WRVJIRUFERVIgKyAnLCAuJyArIGNsYXNzTmFtZXMuUE9QT1ZFUkhFQURFUiArICcgOm5vdCguY2xvc2UpJywgZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgaWYgKGUuY3VycmVudFRhcmdldCA9PSB0aGlzKSB7DQogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5saXZlU2VhcmNoICYmICEkKGUudGFyZ2V0KS5oYXNDbGFzcygnY2xvc2UnKSkgew0KICAgICAgICAgICAgdGhhdC4kc2VhcmNoYm94LmZvY3VzKCk7DQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoYXQuJGJ1dHRvbi5mb2N1cygpOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfSk7DQoNCiAgICAgIHRoaXMuJG1lbnVJbm5lci5vbignY2xpY2snLCAnLmRpdmlkZXIsIC5kcm9wZG93bi1oZWFkZXInLCBmdW5jdGlvbiAoZSkgew0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgIGlmICh0aGF0Lm9wdGlvbnMubGl2ZVNlYXJjaCkgew0KICAgICAgICAgIHRoYXQuJHNlYXJjaGJveC5mb2N1cygpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRoYXQuJGJ1dHRvbi5mb2N1cygpOw0KICAgICAgICB9DQogICAgICB9KTsNCg0KICAgICAgdGhpcy4kbWVudS5vbignY2xpY2snLCAnLicgKyBjbGFzc05hbWVzLlBPUE9WRVJIRUFERVIgKyAnIC5jbG9zZScsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgdGhhdC4kYnV0dG9uLmNsaWNrKCk7DQogICAgICB9KTsNCg0KICAgICAgdGhpcy4kc2VhcmNoYm94Lm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7DQogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICB9KTsNCg0KICAgICAgdGhpcy4kbWVudS5vbignY2xpY2snLCAnLmFjdGlvbnMtYnRuJywgZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5saXZlU2VhcmNoKSB7DQogICAgICAgICAgdGhhdC4kc2VhcmNoYm94LmZvY3VzKCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdGhhdC4kYnV0dG9uLmZvY3VzKCk7DQogICAgICAgIH0NCg0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQoNCiAgICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoJ2JzLXNlbGVjdC1hbGwnKSkgew0KICAgICAgICAgIHRoYXQuc2VsZWN0QWxsKCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdGhhdC5kZXNlbGVjdEFsbCgpOw0KICAgICAgICB9DQogICAgICB9KTsNCg0KICAgICAgdGhpcy4kZWxlbWVudC5vbih7DQogICAgICAgICdjaGFuZ2UnOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgdGhhdC5yZW5kZXIoKTsNCiAgICAgICAgICB0aGF0LiRlbGVtZW50LnRyaWdnZXIoJ2NoYW5nZWQuYnMuc2VsZWN0JywgY2hhbmdlZF9hcmd1bWVudHMpOw0KICAgICAgICAgIGNoYW5nZWRfYXJndW1lbnRzID0gbnVsbDsNCiAgICAgICAgfSwNCiAgICAgICAgJ2ZvY3VzJzogZnVuY3Rpb24gKCkgew0KICAgICAgICAgIHRoYXQuJGJ1dHRvbi5mb2N1cygpOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9LA0KDQogICAgbGl2ZVNlYXJjaExpc3RlbmVyOiBmdW5jdGlvbiAoKSB7DQogICAgICB2YXIgdGhhdCA9IHRoaXMsDQogICAgICAgICAgbm9fcmVzdWx0cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7DQoNCiAgICAgIHRoaXMuJGJ1dHRvbi5vbignY2xpY2suYnMuZHJvcGRvd24uZGF0YS1hcGknLCBmdW5jdGlvbiAoKSB7DQogICAgICAgIGlmICghIXRoYXQuJHNlYXJjaGJveC52YWwoKSkgew0KICAgICAgICAgIHRoYXQuJHNlYXJjaGJveC52YWwoJycpOw0KICAgICAgICB9DQogICAgICB9KTsNCg0KICAgICAgdGhpcy4kc2VhcmNoYm94Lm9uKCdjbGljay5icy5kcm9wZG93bi5kYXRhLWFwaSBmb2N1cy5icy5kcm9wZG93bi5kYXRhLWFwaSB0b3VjaGVuZC5icy5kcm9wZG93bi5kYXRhLWFwaScsIGZ1bmN0aW9uIChlKSB7DQogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICB9KTsNCg0KICAgICAgdGhpcy4kc2VhcmNoYm94Lm9uKCdpbnB1dCBwcm9wZXJ0eWNoYW5nZScsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgdmFyIHNlYXJjaFZhbHVlID0gdGhhdC4kc2VhcmNoYm94LnZhbCgpOw0KICAgICAgICANCiAgICAgICAgdGhhdC5zZWxlY3RwaWNrZXIuc2VhcmNoLm1hcC5uZXdJbmRleCA9IHt9Ow0KICAgICAgICB0aGF0LnNlbGVjdHBpY2tlci5zZWFyY2gubWFwLm9yaWdpbmFsSW5kZXggPSB7fTsNCiAgICAgICAgdGhhdC5zZWxlY3RwaWNrZXIuc2VhcmNoLmVsZW1lbnRzID0gW107DQogICAgICAgIHRoYXQuc2VsZWN0cGlja2VyLnNlYXJjaC5kYXRhID0gW107DQoNCiAgICAgICAgaWYgKHNlYXJjaFZhbHVlKSB7DQogICAgICAgICAgdmFyIGksDQogICAgICAgICAgICAgIHNlYXJjaE1hdGNoID0gW10sDQogICAgICAgICAgICAgIHEgPSBzZWFyY2hWYWx1ZS50b1VwcGVyQ2FzZSgpLA0KICAgICAgICAgICAgICBjYWNoZSA9IHt9LA0KICAgICAgICAgICAgICBjYWNoZUFyciA9IFtdLA0KICAgICAgICAgICAgICBzZWFyY2hTdHlsZSA9IHRoYXQuX3NlYXJjaFN0eWxlKCksDQogICAgICAgICAgICAgIG5vcm1hbGl6ZVNlYXJjaCA9IHRoYXQub3B0aW9ucy5saXZlU2VhcmNoTm9ybWFsaXplOw0KDQogICAgICAgICAgdGhhdC5fJGxpc1NlbGVjdGVkID0gdGhhdC4kbWVudUlubmVyLmZpbmQoJy5zZWxlY3RlZCcpOw0KDQogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGF0LnNlbGVjdHBpY2tlci5tYWluLmRhdGEubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIHZhciBsaSA9IHRoYXQuc2VsZWN0cGlja2VyLm1haW4uZGF0YVtpXTsNCg0KICAgICAgICAgICAgaWYgKCFjYWNoZVtpXSkgew0KICAgICAgICAgICAgICBjYWNoZVtpXSA9IHN0cmluZ1NlYXJjaChsaSwgcSwgc2VhcmNoU3R5bGUsIG5vcm1hbGl6ZVNlYXJjaCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChjYWNoZVtpXSAmJiBsaS5oZWFkZXJJbmRleCAhPT0gdW5kZWZpbmVkICYmIGNhY2hlQXJyLmluZGV4T2YobGkuaGVhZGVySW5kZXgpID09PSAtMSkgew0KICAgICAgICAgICAgICBpZiAobGkuaGVhZGVySW5kZXggPiAwKSB7DQogICAgICAgICAgICAgICAgY2FjaGVbbGkuaGVhZGVySW5kZXggLSAxXSA9IHRydWU7DQogICAgICAgICAgICAgICAgY2FjaGVBcnIucHVzaChsaS5oZWFkZXJJbmRleCAtIDEpOw0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgY2FjaGVbbGkuaGVhZGVySW5kZXhdID0gdHJ1ZTsNCiAgICAgICAgICAgICAgY2FjaGVBcnIucHVzaChsaS5oZWFkZXJJbmRleCk7DQogICAgICAgICAgICAgIA0KICAgICAgICAgICAgICBjYWNoZVtsaS5sYXN0SW5kZXggKyAxXSA9IHRydWU7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChjYWNoZVtpXSAmJiBsaS50eXBlICE9PSAnb3B0Z3JvdXAtbGFiZWwnKSBjYWNoZUFyci5wdXNoKGkpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjYWNoZUxlbiA9IGNhY2hlQXJyLmxlbmd0aDsgaSA8IGNhY2hlTGVuOyBpKyspIHsNCiAgICAgICAgICAgIHZhciBpbmRleCA9IGNhY2hlQXJyW2ldLA0KICAgICAgICAgICAgICAgIHByZXZJbmRleCA9IGNhY2hlQXJyW2kgLSAxXSwNCiAgICAgICAgICAgICAgICBsaSA9IHRoYXQuc2VsZWN0cGlja2VyLm1haW4uZGF0YVtpbmRleF0sDQogICAgICAgICAgICAgICAgbGlQcmV2ID0gdGhhdC5zZWxlY3RwaWNrZXIubWFpbi5kYXRhW3ByZXZJbmRleF07DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoIGxpLnR5cGUgIT09ICdkaXZpZGVyJyB8fCAoIGxpLnR5cGUgPT09ICdkaXZpZGVyJyAmJiBsaVByZXYgJiYgbGlQcmV2LnR5cGUgIT09ICdkaXZpZGVyJyAmJiBjYWNoZUxlbiAtIDEgIT09IGkgKSApIHsNCiAgICAgICAgICAgICAgdGhhdC5zZWxlY3RwaWNrZXIuc2VhcmNoLmRhdGEucHVzaChsaSk7DQogICAgICAgICAgICAgIHNlYXJjaE1hdGNoLnB1c2godGhhdC5zZWxlY3RwaWNrZXIubWFpbi5lbGVtZW50c1tpbmRleF0pOw0KICAgICAgICAgICAgICB0aGF0LnNlbGVjdHBpY2tlci5zZWFyY2gubWFwLm5ld0luZGV4W2xpLm9yaWdpbmFsSW5kZXhdID0gc2VhcmNoTWF0Y2gubGVuZ3RoIC0gMTsNCiAgICAgICAgICAgICAgdGhhdC5zZWxlY3RwaWNrZXIuc2VhcmNoLm1hcC5vcmlnaW5hbEluZGV4W3NlYXJjaE1hdGNoLmxlbmd0aCAtIDFdID0gbGkub3JpZ2luYWxJbmRleDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQoNCiAgICAgICAgICB0aGF0LmFjdGl2ZUluZGV4ID0gdW5kZWZpbmVkOw0KICAgICAgICAgIHRoYXQubm9TY3JvbGwgPSB0cnVlOw0KICAgICAgICAgIHRoYXQuJG1lbnVJbm5lci5zY3JvbGxUb3AoMCk7DQogICAgICAgICAgdGhhdC5zZWxlY3RwaWNrZXIuc2VhcmNoLmVsZW1lbnRzID0gc2VhcmNoTWF0Y2g7DQogICAgICAgICAgdGhhdC5jcmVhdGVWaWV3KHRydWUpOw0KDQogICAgICAgICAgaWYgKCFzZWFyY2hNYXRjaC5sZW5ndGgpIHsNCiAgICAgICAgICAgIG5vX3Jlc3VsdHMuY2xhc3NOYW1lID0gJ25vLXJlc3VsdHMnOw0KICAgICAgICAgICAgbm9fcmVzdWx0cy5pbm5lckhUTUwgPSB0aGF0Lm9wdGlvbnMubm9uZVJlc3VsdHNUZXh0LnJlcGxhY2UoJ3swfScsICciJyArIGh0bWxFc2NhcGUoc2VhcmNoVmFsdWUpICsgJyInKTsNCiAgICAgICAgICAgIHRoYXQuJG1lbnVJbm5lclswXS5maXJzdENoaWxkLmFwcGVuZENoaWxkKG5vX3Jlc3VsdHMpOw0KICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGF0LiRtZW51SW5uZXIuc2Nyb2xsVG9wKDApOw0KICAgICAgICAgIHRoYXQuY3JlYXRlVmlldyhmYWxzZSk7DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH0sDQoNCiAgICBfc2VhcmNoU3R5bGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMubGl2ZVNlYXJjaFN0eWxlIHx8ICdjb250YWlucyc7DQogICAgfSwNCg0KICAgIHZhbDogZnVuY3Rpb24gKHZhbHVlKSB7DQogICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAndW5kZWZpbmVkJykgew0KICAgICAgICB0aGlzLiRlbGVtZW50DQogICAgICAgICAgLnZhbCh2YWx1ZSkNCiAgICAgICAgICAudHJpZ2dlck5hdGl2ZSgnY2hhbmdlJyk7DQoNCiAgICAgICAgcmV0dXJuIHRoaXMuJGVsZW1lbnQ7DQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gdGhpcy4kZWxlbWVudC52YWwoKTsNCiAgICAgIH0NCiAgICB9LA0KDQogICAgY2hhbmdlQWxsOiBmdW5jdGlvbiAoc3RhdHVzKSB7DQogICAgICBpZiAoIXRoaXMubXVsdGlwbGUpIHJldHVybjsNCiAgICAgIGlmICh0eXBlb2Ygc3RhdHVzID09PSAndW5kZWZpbmVkJykgc3RhdHVzID0gdHJ1ZTsNCg0KICAgICAgdmFyICRzZWxlY3RPcHRpb25zID0gdGhpcy4kZWxlbWVudC5maW5kKCdvcHRpb24nKSwNCiAgICAgICAgICBwcmV2aW91c1NlbGVjdGVkID0gMCwNCiAgICAgICAgICBjdXJyZW50U2VsZWN0ZWQgPSAwLA0KICAgICAgICAgIHByZXZWYWx1ZSA9IGdldFNlbGVjdFZhbHVlcyh0aGlzLiRlbGVtZW50WzBdKTsNCg0KICAgICAgdGhpcy4kZWxlbWVudC5hZGRDbGFzcygnYnMtc2VsZWN0LWhpZGRlbicpOw0KDQogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuc2VsZWN0cGlja2VyLmN1cnJlbnQuZWxlbWVudHMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5zZWxlY3RwaWNrZXIuY3VycmVudC5tYXAub3JpZ2luYWxJbmRleFtpXSwgLy8gZmFzdGVyIHRoYW4gJChsaSkuZGF0YSgnb3JpZ2luYWxJbmRleCcpDQogICAgICAgICAgICBvcHRpb24gPSAkc2VsZWN0T3B0aW9uc1tpbmRleF07DQoNCiAgICAgICAgaWYgKG9wdGlvbikgew0KICAgICAgICAgIGlmIChvcHRpb24uc2VsZWN0ZWQpIHByZXZpb3VzU2VsZWN0ZWQrKzsNCiAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBzdGF0dXM7DQogICAgICAgICAgaWYgKG9wdGlvbi5zZWxlY3RlZCkgY3VycmVudFNlbGVjdGVkKys7DQogICAgICAgIH0NCiAgICAgIH0NCg0KICAgICAgdGhpcy4kZWxlbWVudC5yZW1vdmVDbGFzcygnYnMtc2VsZWN0LWhpZGRlbicpOw0KDQogICAgICBpZiAocHJldmlvdXNTZWxlY3RlZCA9PT0gY3VycmVudFNlbGVjdGVkKSByZXR1cm47DQoNCiAgICAgIHRoaXMuc2V0T3B0aW9uU3RhdHVzKCk7DQoNCiAgICAgIHRoaXMudG9nZ2xlUGxhY2Vob2xkZXIoKTsNCg0KICAgICAgY2hhbmdlZF9hcmd1bWVudHMgPSBbbnVsbCwgbnVsbCwgcHJldlZhbHVlXTsNCg0KICAgICAgdGhpcy4kZWxlbWVudA0KICAgICAgICAudHJpZ2dlck5hdGl2ZSgnY2hhbmdlJyk7DQogICAgfSwNCg0KICAgIHNlbGVjdEFsbDogZnVuY3Rpb24gKCkgew0KICAgICAgcmV0dXJuIHRoaXMuY2hhbmdlQWxsKHRydWUpOw0KICAgIH0sDQoNCiAgICBkZXNlbGVjdEFsbDogZnVuY3Rpb24gKCkgew0KICAgICAgcmV0dXJuIHRoaXMuY2hhbmdlQWxsKGZhbHNlKTsNCiAgICB9LA0KDQogICAgdG9nZ2xlOiBmdW5jdGlvbiAoZSkgew0KICAgICAgZSA9IGUgfHwgd2luZG93LmV2ZW50Ow0KDQogICAgICBpZiAoZSkgZS5zdG9wUHJvcGFnYXRpb24oKTsNCg0KICAgICAgdGhpcy4kYnV0dG9uLnRyaWdnZXIoJ2NsaWNrLmJzLmRyb3Bkb3duLmRhdGEtYXBpJyk7DQogICAgfSwNCg0KICAgIGtleWRvd246IGZ1bmN0aW9uIChlKSB7DQogICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpLA0KICAgICAgICAgICRwYXJlbnQgPSAkdGhpcy5pcygnaW5wdXQnKSA/ICR0aGlzLnBhcmVudCgpLnBhcmVudCgpIDogJHRoaXMucGFyZW50KCksDQogICAgICAgICAgdGhhdCA9ICRwYXJlbnQuZGF0YSgndGhpcycpLA0KICAgICAgICAgICRpdGVtcyA9IHRoYXQuZmluZExpcygpLA0KICAgICAgICAgIGluZGV4LA0KICAgICAgICAgIGlzQWN0aXZlLA0KICAgICAgICAgIGxpQWN0aXZlLA0KICAgICAgICAgIGFjdGl2ZUxpLA0KICAgICAgICAgIG9mZnNldCwNCiAgICAgICAgICB1cGRhdGVTY3JvbGwgPSBmYWxzZSwNCiAgICAgICAgICBkb3duT25UYWIgPSBlLndoaWNoID09PSBrZXlDb2Rlcy5UQUIgJiYgISR0aGlzLmhhc0NsYXNzKCdkcm9wZG93bi10b2dnbGUnKSAmJiAhdGhhdC5vcHRpb25zLnNlbGVjdE9uVGFiLA0KICAgICAgICAgIGlzQXJyb3dLZXkgPSBSRUdFWFBfQVJST1cudGVzdChlLndoaWNoKSB8fCBkb3duT25UYWIsDQogICAgICAgICAgc2Nyb2xsVG9wID0gdGhhdC4kbWVudUlubmVyWzBdLnNjcm9sbFRvcCwNCiAgICAgICAgICBpc1ZpcnR1YWwgPSB0aGF0LmlzVmlydHVhbCgpLA0KICAgICAgICAgIHBvc2l0aW9uMCA9IGlzVmlydHVhbCA9PT0gdHJ1ZSA/IHRoYXQuc2VsZWN0cGlja2VyLnZpZXcucG9zaXRpb24wIDogMDsNCg0KICAgICAgaXNBY3RpdmUgPSB0aGF0LiRuZXdFbGVtZW50Lmhhc0NsYXNzKGNsYXNzTmFtZXMuU0hPVyk7DQoNCiAgICAgIGlmICgNCiAgICAgICAgIWlzQWN0aXZlICYmDQogICAgICAgICgNCiAgICAgICAgICBpc0Fycm93S2V5IHx8DQogICAgICAgICAgZS53aGljaCA+PSA0OCAmJiBlLndoaWNoIDw9IDU3IHx8DQogICAgICAgICAgZS53aGljaCA+PSA5NiAmJiBlLndoaWNoIDw9IDEwNSB8fA0KICAgICAgICAgIGUud2hpY2ggPj0gNjUgJiYgZS53aGljaCA8PSA5MA0KICAgICAgICApDQogICAgICApIHsNCiAgICAgICAgdGhhdC4kYnV0dG9uLnRyaWdnZXIoJ2NsaWNrLmJzLmRyb3Bkb3duLmRhdGEtYXBpJyk7DQogICAgICB9DQoNCiAgICAgIGlmIChlLndoaWNoID09PSBrZXlDb2Rlcy5FU0NBUEUgJiYgaXNBY3RpdmUpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICB0aGF0LiRidXR0b24udHJpZ2dlcignY2xpY2suYnMuZHJvcGRvd24uZGF0YS1hcGknKS5mb2N1cygpOw0KICAgICAgfQ0KDQogICAgICBpZiAoaXNBcnJvd0tleSkgeyAvLyBpZiB1cCBvciBkb3duDQogICAgICAgIGlmICghJGl0ZW1zLmxlbmd0aCkgcmV0dXJuOw0KDQogICAgICAgIC8vICRpdGVtcy5pbmRleC8uZmlsdGVyIGlzIHRvbyBzbG93IHdpdGggYSBsYXJnZSBsaXN0IGFuZCBubyB2aXJ0dWFsIHNjcm9sbA0KICAgICAgICBpbmRleCA9IGlzVmlydHVhbCA9PT0gdHJ1ZSA/ICRpdGVtcy5pbmRleCgkaXRlbXMuZmlsdGVyKCcuYWN0aXZlJykpIDogdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5tYXAubmV3SW5kZXhbdGhhdC5hY3RpdmVJbmRleF07DQoNCiAgICAgICAgaWYgKGluZGV4ID09PSB1bmRlZmluZWQpIGluZGV4ID0gLTE7DQoNCiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkgew0KICAgICAgICAgIGxpQWN0aXZlID0gdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5lbGVtZW50c1tpbmRleCArIHBvc2l0aW9uMF07DQogICAgICAgICAgbGlBY3RpdmUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7DQogICAgICAgICAgaWYgKGxpQWN0aXZlLmZpcnN0Q2hpbGQpIGxpQWN0aXZlLmZpcnN0Q2hpbGQuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoZS53aGljaCA9PT0ga2V5Q29kZXMuQVJST1dfVVApIHsgLy8gdXANCiAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKSBpbmRleC0tOw0KICAgICAgICAgIGlmIChpbmRleCArIHBvc2l0aW9uMCA8IDApIGluZGV4ICs9ICRpdGVtcy5sZW5ndGg7DQoNCiAgICAgICAgICBpZiAoIXRoYXQuc2VsZWN0cGlja2VyLnZpZXcuY2FuSGlnaGxpZ2h0W2luZGV4ICsgcG9zaXRpb24wXSkgew0KICAgICAgICAgICAgaW5kZXggPSB0aGF0LnNlbGVjdHBpY2tlci52aWV3LmNhbkhpZ2hsaWdodC5zbGljZSgwLCBpbmRleCArIHBvc2l0aW9uMCkubGFzdEluZGV4T2YodHJ1ZSkgLSBwb3NpdGlvbjA7DQogICAgICAgICAgICBpZiAoaW5kZXggPT09IC0xKSBpbmRleCA9ICRpdGVtcy5sZW5ndGggLSAxOw0KICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIGlmIChlLndoaWNoID09PSBrZXlDb2Rlcy5BUlJPV19ET1dOIHx8IGRvd25PblRhYikgeyAvLyBkb3duDQogICAgICAgICAgaW5kZXgrKzsNCiAgICAgICAgICBpZiAoaW5kZXggKyBwb3NpdGlvbjAgPj0gdGhhdC5zZWxlY3RwaWNrZXIudmlldy5jYW5IaWdobGlnaHQubGVuZ3RoKSBpbmRleCA9IDA7DQoNCiAgICAgICAgICBpZiAoIXRoYXQuc2VsZWN0cGlja2VyLnZpZXcuY2FuSGlnaGxpZ2h0W2luZGV4ICsgcG9zaXRpb24wXSkgew0KICAgICAgICAgICAgaW5kZXggPSBpbmRleCArIDEgKyB0aGF0LnNlbGVjdHBpY2tlci52aWV3LmNhbkhpZ2hsaWdodC5zbGljZShpbmRleCArIHBvc2l0aW9uMCArIDEpLmluZGV4T2YodHJ1ZSk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KDQogICAgICAgIHZhciBsaUFjdGl2ZUluZGV4ID0gcG9zaXRpb24wICsgaW5kZXg7DQoNCiAgICAgICAgaWYgKGUud2hpY2ggPT09IGtleUNvZGVzLkFSUk9XX1VQKSB7IC8vIHVwDQogICAgICAgICAgLy8gc2Nyb2xsIHRvIGJvdHRvbSBhbmQgaGlnaGxpZ2h0IGxhc3Qgb3B0aW9uDQogICAgICAgICAgaWYgKHBvc2l0aW9uMCA9PT0gMCAmJiBpbmRleCA9PT0gJGl0ZW1zLmxlbmd0aCAtIDEpIHsNCiAgICAgICAgICAgIHRoYXQuJG1lbnVJbm5lclswXS5zY3JvbGxUb3AgPSB0aGF0LiRtZW51SW5uZXJbMF0uc2Nyb2xsSGVpZ2h0Ow0KDQogICAgICAgICAgICBsaUFjdGl2ZUluZGV4ID0gdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5lbGVtZW50cy5sZW5ndGggLSAxOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBhY3RpdmVMaSA9IHRoYXQuc2VsZWN0cGlja2VyLmN1cnJlbnQuZGF0YVtsaUFjdGl2ZUluZGV4XTsNCiAgICAgICAgICAgIG9mZnNldCA9IGFjdGl2ZUxpLnBvc2l0aW9uIC0gYWN0aXZlTGkuaGVpZ2h0Ow0KDQogICAgICAgICAgICB1cGRhdGVTY3JvbGwgPSBvZmZzZXQgPCBzY3JvbGxUb3A7DQogICAgICAgICAgfQ0KICAgICAgICB9IGVsc2UgaWYgKGUud2hpY2ggPT09IGtleUNvZGVzLkFSUk9XX0RPV04gfHwgZG93bk9uVGFiKSB7IC8vIGRvd24NCiAgICAgICAgICAvLyBzY3JvbGwgdG8gdG9wIGFuZCBoaWdobGlnaHQgZmlyc3Qgb3B0aW9uDQogICAgICAgICAgaWYgKHBvc2l0aW9uMCAhPT0gMCAmJiBpbmRleCA9PT0gMCkgew0KICAgICAgICAgICAgdGhhdC4kbWVudUlubmVyWzBdLnNjcm9sbFRvcCA9IDA7DQoNCiAgICAgICAgICAgIGxpQWN0aXZlSW5kZXggPSAwOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBhY3RpdmVMaSA9IHRoYXQuc2VsZWN0cGlja2VyLmN1cnJlbnQuZGF0YVtsaUFjdGl2ZUluZGV4XTsNCiAgICAgICAgICAgIG9mZnNldCA9IGFjdGl2ZUxpLnBvc2l0aW9uIC0gdGhhdC5zaXplSW5mby5tZW51SW5uZXJIZWlnaHQ7DQoNCiAgICAgICAgICAgIHVwZGF0ZVNjcm9sbCA9IG9mZnNldCA+IHNjcm9sbFRvcDsNCiAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBsaUFjdGl2ZSA9IHRoYXQuc2VsZWN0cGlja2VyLmN1cnJlbnQuZWxlbWVudHNbbGlBY3RpdmVJbmRleF07DQogICAgICAgIGxpQWN0aXZlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOw0KICAgICAgICBpZiAobGlBY3RpdmUuZmlyc3RDaGlsZCkgbGlBY3RpdmUuZmlyc3RDaGlsZC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsNCiAgICAgICAgdGhhdC5hY3RpdmVJbmRleCA9IHRoYXQuc2VsZWN0cGlja2VyLmN1cnJlbnQubWFwLm9yaWdpbmFsSW5kZXhbbGlBY3RpdmVJbmRleF07DQoNCiAgICAgICAgdGhhdC5zZWxlY3RwaWNrZXIudmlldy5jdXJyZW50QWN0aXZlID0gbGlBY3RpdmU7DQoNCiAgICAgICAgaWYgKHVwZGF0ZVNjcm9sbCkgdGhhdC4kbWVudUlubmVyWzBdLnNjcm9sbFRvcCA9IG9mZnNldDsNCg0KICAgICAgICBpZiAodGhhdC5vcHRpb25zLmxpdmVTZWFyY2gpIHsNCiAgICAgICAgICB0aGF0LiRzZWFyY2hib3guZm9jdXMoKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAkdGhpcy5mb2N1cygpOw0KICAgICAgICB9DQogICAgICB9IGVsc2UgaWYgKA0KICAgICAgICAhJHRoaXMuaXMoJ2lucHV0JykgJiYNCiAgICAgICAgIVJFR0VYUF9UQUJfT1JfRVNDQVBFLnRlc3QoZS53aGljaCkgfHwNCiAgICAgICAgKGUud2hpY2ggPT09IGtleUNvZGVzLlNQQUNFICYmIHRoYXQuc2VsZWN0cGlja2VyLmtleWRvd24ua2V5SGlzdG9yeSkNCiAgICAgICkgew0KICAgICAgICB2YXIgc2VhcmNoTWF0Y2gsDQogICAgICAgICAgICBtYXRjaGVzID0gW10sDQogICAgICAgICAgICBrZXlIaXN0b3J5Ow0KDQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCg0KICAgICAgICB0aGF0LnNlbGVjdHBpY2tlci5rZXlkb3duLmtleUhpc3RvcnkgKz0ga2V5Q29kZU1hcFtlLndoaWNoXTsNCg0KICAgICAgICBpZiAodGhhdC5zZWxlY3RwaWNrZXIua2V5ZG93bi5yZXNldEtleUhpc3RvcnkuY2FuY2VsKSBjbGVhclRpbWVvdXQodGhhdC5zZWxlY3RwaWNrZXIua2V5ZG93bi5yZXNldEtleUhpc3RvcnkuY2FuY2VsKTsNCiAgICAgICAgdGhhdC5zZWxlY3RwaWNrZXIua2V5ZG93bi5yZXNldEtleUhpc3RvcnkuY2FuY2VsID0gdGhhdC5zZWxlY3RwaWNrZXIua2V5ZG93bi5yZXNldEtleUhpc3Rvcnkuc3RhcnQoKTsNCg0KICAgICAgICBrZXlIaXN0b3J5ID0gdGhhdC5zZWxlY3RwaWNrZXIua2V5ZG93bi5rZXlIaXN0b3J5Ow0KDQogICAgICAgIC8vIGlmIGFsbCBsZXR0ZXJzIGFyZSB0aGUgc2FtZSwgc2V0IGtleUhpc3RvcnkgdG8ganVzdCB0aGUgZmlyc3QgY2hhcmFjdGVyIHdoZW4gc2VhcmNoaW5nDQogICAgICAgIGlmICgvXiguKVwxKyQvLnRlc3Qoa2V5SGlzdG9yeSkpIHsNCiAgICAgICAgICBrZXlIaXN0b3J5ID0ga2V5SGlzdG9yeS5jaGFyQXQoMCk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBmaW5kIG1hdGNoZXMNCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50LmRhdGEubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICB2YXIgbGkgPSB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50LmRhdGFbaV0sDQogICAgICAgICAgICAgIGhhc01hdGNoOw0KDQogICAgICAgICAgaGFzTWF0Y2ggPSBzdHJpbmdTZWFyY2gobGksIGtleUhpc3RvcnksICdzdGFydHNXaXRoJywgdHJ1ZSk7DQoNCiAgICAgICAgICBpZiAoaGFzTWF0Y2ggJiYgdGhhdC5zZWxlY3RwaWNrZXIudmlldy5jYW5IaWdobGlnaHRbaV0pIHsNCiAgICAgICAgICAgIGxpLmluZGV4ID0gaTsNCiAgICAgICAgICAgIG1hdGNoZXMucHVzaChsaS5vcmlnaW5hbEluZGV4KTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBpZiAobWF0Y2hlcy5sZW5ndGgpIHsNCiAgICAgICAgICB2YXIgbWF0Y2hJbmRleCA9IDA7DQoNCiAgICAgICAgICAkaXRlbXMucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpLmZpbmQoJ2EnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7DQoNCiAgICAgICAgICAvLyBlaXRoZXIgb25seSBvbmUga2V5IGhhcyBiZWVuIHByZXNzZWQgb3IgdGhleSBhcmUgYWxsIHRoZSBzYW1lIGtleQ0KICAgICAgICAgIGlmIChrZXlIaXN0b3J5Lmxlbmd0aCA9PT0gMSkgew0KICAgICAgICAgICAgbWF0Y2hJbmRleCA9IG1hdGNoZXMuaW5kZXhPZih0aGF0LmFjdGl2ZUluZGV4KTsNCg0KICAgICAgICAgICAgaWYgKG1hdGNoSW5kZXggPT09IC0xIHx8IG1hdGNoSW5kZXggPT09IG1hdGNoZXMubGVuZ3RoIC0gMSkgew0KICAgICAgICAgICAgICBtYXRjaEluZGV4ID0gMDsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgIG1hdGNoSW5kZXgrKzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQoNCiAgICAgICAgICBzZWFyY2hNYXRjaCA9IHRoYXQuc2VsZWN0cGlja2VyLmN1cnJlbnQubWFwLm5ld0luZGV4W21hdGNoZXNbbWF0Y2hJbmRleF1dOw0KDQogICAgICAgICAgYWN0aXZlTGkgPSB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50LmRhdGFbc2VhcmNoTWF0Y2hdOw0KDQogICAgICAgICAgaWYgKHNjcm9sbFRvcCAtIGFjdGl2ZUxpLnBvc2l0aW9uID4gMCkgew0KICAgICAgICAgICAgb2Zmc2V0ID0gYWN0aXZlTGkucG9zaXRpb24gLSBhY3RpdmVMaS5oZWlnaHQ7DQogICAgICAgICAgICB1cGRhdGVTY3JvbGwgPSB0cnVlOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBvZmZzZXQgPSBhY3RpdmVMaS5wb3NpdGlvbiAtIHRoYXQuc2l6ZUluZm8ubWVudUlubmVySGVpZ2h0Ow0KICAgICAgICAgICAgLy8gaWYgdGhlIG9wdGlvbiBpcyBhbHJlYWR5IHZpc2libGUgYXQgdGhlIGN1cnJlbnQgc2Nyb2xsIHBvc2l0aW9uLCBqdXN0IGtlZXAgaXQgdGhlIHNhbWUNCiAgICAgICAgICAgIHVwZGF0ZVNjcm9sbCA9IGFjdGl2ZUxpLnBvc2l0aW9uID4gc2Nyb2xsVG9wICsgdGhhdC5zaXplSW5mby5tZW51SW5uZXJIZWlnaHQ7ICAgICAgICAgDQogICAgICAgICAgfQ0KDQogICAgICAgICAgbGlBY3RpdmUgPSB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50LmVsZW1lbnRzW3NlYXJjaE1hdGNoXTsNCiAgICAgICAgICBsaUFjdGl2ZS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsNCiAgICAgICAgICBpZiAobGlBY3RpdmUuZmlyc3RDaGlsZCkgbGlBY3RpdmUuZmlyc3RDaGlsZC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsNCiAgICAgICAgICB0aGF0LmFjdGl2ZUluZGV4ID0gbWF0Y2hlc1ttYXRjaEluZGV4XTsNCg0KICAgICAgICAgIGxpQWN0aXZlLmZpcnN0Q2hpbGQuZm9jdXMoKTsNCg0KICAgICAgICAgIGlmICh1cGRhdGVTY3JvbGwpIHRoYXQuJG1lbnVJbm5lclswXS5zY3JvbGxUb3AgPSBvZmZzZXQ7DQoNCiAgICAgICAgICAkdGhpcy5mb2N1cygpOw0KICAgICAgICB9DQogICAgICB9DQoNCiAgICAgIC8vIFNlbGVjdCBmb2N1c2VkIG9wdGlvbiBpZiAiRW50ZXIiLCAiU3BhY2ViYXIiIG9yICJUYWIiICh3aGVuIHNlbGVjdE9uVGFiIGlzIHRydWUpIGFyZSBwcmVzc2VkIGluc2lkZSB0aGUgbWVudS4NCiAgICAgIGlmICgNCiAgICAgICAgaXNBY3RpdmUgJiYNCiAgICAgICAgKA0KICAgICAgICAgIChlLndoaWNoID09PSBrZXlDb2Rlcy5TUEFDRSAmJiAhdGhhdC5zZWxlY3RwaWNrZXIua2V5ZG93bi5rZXlIaXN0b3J5KSB8fA0KICAgICAgICAgIGUud2hpY2ggPT09IGtleUNvZGVzLkVOVEVSIHx8DQogICAgICAgICAgKGUud2hpY2ggPT09IGtleUNvZGVzLlRBQiAmJiB0aGF0Lm9wdGlvbnMuc2VsZWN0T25UYWIpDQogICAgICAgICkNCiAgICAgICkgew0KICAgICAgICBpZiAoZS53aGljaCAhPT0ga2V5Q29kZXMuU1BBQ0UpIGUucHJldmVudERlZmF1bHQoKTsNCg0KICAgICAgICBpZiAoIXRoYXQub3B0aW9ucy5saXZlU2VhcmNoIHx8IGUud2hpY2ggIT09IGtleUNvZGVzLlNQQUNFKSB7DQogICAgICAgICAgdGhhdC4kbWVudUlubmVyLmZpbmQoJy5hY3RpdmUgYScpLnRyaWdnZXIoJ2NsaWNrJywgdHJ1ZSk7IC8vIHJldGFpbiBhY3RpdmUgY2xhc3MNCiAgICAgICAgICAkdGhpcy5mb2N1cygpOw0KDQogICAgICAgICAgaWYgKCF0aGF0Lm9wdGlvbnMubGl2ZVNlYXJjaCkgew0KICAgICAgICAgICAgLy8gUHJldmVudCBzY3JlZW4gZnJvbSBzY3JvbGxpbmcgaWYgdGhlIHVzZXIgaGl0cyB0aGUgc3BhY2ViYXINCiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgIC8vIEZpeGVzIHNwYWNlYmFyIHNlbGVjdGlvbiBvZiBkcm9wZG93biBpdGVtcyBpbiBGRiAmIElFDQogICAgICAgICAgICAkKGRvY3VtZW50KS5kYXRhKCdzcGFjZVNlbGVjdCcsIHRydWUpOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0sDQoNCiAgICBtb2JpbGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHRoaXMuJGVsZW1lbnQuYWRkQ2xhc3MoJ21vYmlsZS1kZXZpY2UnKTsNCiAgICB9LA0KDQogICAgcmVmcmVzaDogZnVuY3Rpb24gKCkgew0KICAgICAgLy8gdXBkYXRlIG9wdGlvbnMgaWYgZGF0YSBhdHRyaWJ1dGVzIGhhdmUgYmVlbiBjaGFuZ2VkDQogICAgICB2YXIgY29uZmlnID0gJC5leHRlbmQoe30sIHRoaXMub3B0aW9ucywgdGhpcy4kZWxlbWVudC5kYXRhKCkpOw0KICAgICAgdGhpcy5vcHRpb25zID0gY29uZmlnOw0KDQogICAgICB0aGlzLnNlbGVjdHBpY2tlci5tYWluLm1hcC5uZXdJbmRleCA9IHt9Ow0KICAgICAgdGhpcy5zZWxlY3RwaWNrZXIubWFpbi5tYXAub3JpZ2luYWxJbmRleCA9IHt9Ow0KICAgICAgdGhpcy5jcmVhdGVMaSgpOw0KICAgICAgdGhpcy5jaGVja0Rpc2FibGVkKCk7DQogICAgICB0aGlzLnJlbmRlcigpOw0KICAgICAgdGhpcy5zZXRTdHlsZSgpOw0KICAgICAgdGhpcy5zZXRXaWR0aCgpOw0KDQogICAgICB0aGlzLnNldFNpemUodHJ1ZSk7DQoNCiAgICAgIHRoaXMuJGVsZW1lbnQudHJpZ2dlcigncmVmcmVzaGVkLmJzLnNlbGVjdCcpOw0KICAgIH0sDQoNCiAgICBoaWRlOiBmdW5jdGlvbiAoKSB7DQogICAgICB0aGlzLiRuZXdFbGVtZW50LmhpZGUoKTsNCiAgICB9LA0KDQogICAgc2hvdzogZnVuY3Rpb24gKCkgew0KICAgICAgdGhpcy4kbmV3RWxlbWVudC5zaG93KCk7DQogICAgfSwNCg0KICAgIHJlbW92ZTogZnVuY3Rpb24gKCkgew0KICAgICAgdGhpcy4kbmV3RWxlbWVudC5yZW1vdmUoKTsNCiAgICAgIHRoaXMuJGVsZW1lbnQucmVtb3ZlKCk7DQogICAgfSwNCg0KICAgIGRlc3Ryb3k6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHRoaXMuJG5ld0VsZW1lbnQuYmVmb3JlKHRoaXMuJGVsZW1lbnQpLnJlbW92ZSgpOw0KDQogICAgICBpZiAodGhpcy4kYnNDb250YWluZXIpIHsNCiAgICAgICAgdGhpcy4kYnNDb250YWluZXIucmVtb3ZlKCk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLiRtZW51LnJlbW92ZSgpOw0KICAgICAgfQ0KDQogICAgICB0aGlzLiRlbGVtZW50DQogICAgICAgIC5vZmYoJy5icy5zZWxlY3QnKQ0KICAgICAgICAucmVtb3ZlRGF0YSgnc2VsZWN0cGlja2VyJykNCiAgICAgICAgLnJlbW92ZUNsYXNzKCdicy1zZWxlY3QtaGlkZGVuIHNlbGVjdHBpY2tlcicpOw0KICAgIH0NCiAgfTsNCg0KICAvLyBTRUxFQ1RQSUNLRVIgUExVR0lOIERFRklOSVRJT04NCiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQogIGZ1bmN0aW9uIFBsdWdpbihvcHRpb24pIHsNCiAgICAvLyBnZXQgdGhlIGFyZ3Mgb2YgdGhlIG91dGVyIGZ1bmN0aW9uLi4NCiAgICB2YXIgYXJncyA9IGFyZ3VtZW50czsNCiAgICAvLyBUaGUgYXJndW1lbnRzIG9mIHRoZSBmdW5jdGlvbiBhcmUgZXhwbGljaXRseSByZS1kZWZpbmVkIGZyb20gdGhlIGFyZ3VtZW50IGxpc3QsIGJlY2F1c2UgdGhlIHNoaWZ0IGNhdXNlcyB0aGVtDQogICAgLy8gdG8gZ2V0IGxvc3QvY29ycnVwdGVkIGluIGFuZHJvaWQgMi4zIGFuZCBJRTkgIzcxNSAjNzc1DQogICAgdmFyIF9vcHRpb24gPSBvcHRpb247DQoNCiAgICBbXS5zaGlmdC5hcHBseShhcmdzKTsNCg0KICAgIHZhciB2YWx1ZTsNCiAgICB2YXIgY2hhaW4gPSB0aGlzLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgdmFyICR0aGlzID0gJCh0aGlzKTsNCiAgICAgIGlmICgkdGhpcy5pcygnc2VsZWN0JykpIHsNCiAgICAgICAgdmFyIGRhdGEgPSAkdGhpcy5kYXRhKCdzZWxlY3RwaWNrZXInKSwNCiAgICAgICAgICAgIG9wdGlvbnMgPSB0eXBlb2YgX29wdGlvbiA9PSAnb2JqZWN0JyAmJiBfb3B0aW9uOw0KDQogICAgICAgIGlmICghZGF0YSkgew0KICAgICAgICAgIHZhciBjb25maWcgPSAkLmV4dGVuZCh7fSwgU2VsZWN0cGlja2VyLkRFRkFVTFRTLCAkLmZuLnNlbGVjdHBpY2tlci5kZWZhdWx0cyB8fCB7fSwgJHRoaXMuZGF0YSgpLCBvcHRpb25zKTsNCiAgICAgICAgICBjb25maWcudGVtcGxhdGUgPSAkLmV4dGVuZCh7fSwgU2VsZWN0cGlja2VyLkRFRkFVTFRTLnRlbXBsYXRlLCAoJC5mbi5zZWxlY3RwaWNrZXIuZGVmYXVsdHMgPyAkLmZuLnNlbGVjdHBpY2tlci5kZWZhdWx0cy50ZW1wbGF0ZSA6IHt9KSwgJHRoaXMuZGF0YSgpLnRlbXBsYXRlLCBvcHRpb25zLnRlbXBsYXRlKTsNCiAgICAgICAgICAkdGhpcy5kYXRhKCdzZWxlY3RwaWNrZXInLCAoZGF0YSA9IG5ldyBTZWxlY3RwaWNrZXIodGhpcywgY29uZmlnKSkpOw0KICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMpIHsNCiAgICAgICAgICBmb3IgKHZhciBpIGluIG9wdGlvbnMpIHsNCiAgICAgICAgICAgIGlmIChvcHRpb25zLmhhc093blByb3BlcnR5KGkpKSB7DQogICAgICAgICAgICAgIGRhdGEub3B0aW9uc1tpXSA9IG9wdGlvbnNbaV07DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKHR5cGVvZiBfb3B0aW9uID09ICdzdHJpbmcnKSB7DQogICAgICAgICAgaWYgKGRhdGFbX29wdGlvbl0gaW5zdGFuY2VvZiBGdW5jdGlvbikgew0KICAgICAgICAgICAgdmFsdWUgPSBkYXRhW19vcHRpb25dLmFwcGx5KGRhdGEsIGFyZ3MpOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB2YWx1ZSA9IGRhdGEub3B0aW9uc1tfb3B0aW9uXTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9KTsNCg0KICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICd1bmRlZmluZWQnKSB7DQogICAgICAvL25vaW5zcGVjdGlvbiBKU1VudXNlZEFzc2lnbm1lbnQNCiAgICAgIHJldHVybiB2YWx1ZTsNCiAgICB9IGVsc2Ugew0KICAgICAgcmV0dXJuIGNoYWluOw0KICAgIH0NCiAgfQ0KDQogIHZhciBvbGQgPSAkLmZuLnNlbGVjdHBpY2tlcjsNCiAgJC5mbi5zZWxlY3RwaWNrZXIgPSBQbHVnaW47DQogICQuZm4uc2VsZWN0cGlja2VyLkNvbnN0cnVjdG9yID0gU2VsZWN0cGlja2VyOw0KDQogIC8vIFNFTEVDVFBJQ0tFUiBOTyBDT05GTElDVA0KICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT0NCiAgJC5mbi5zZWxlY3RwaWNrZXIubm9Db25mbGljdCA9IGZ1bmN0aW9uICgpIHsNCiAgICAkLmZuLnNlbGVjdHBpY2tlciA9IG9sZDsNCiAgICByZXR1cm4gdGhpczsNCiAgfTsNCg0KICAkKGRvY3VtZW50KQ0KICAgICAgLm9mZigna2V5ZG93bi5icy5kcm9wZG93bi5kYXRhLWFwaScpDQogICAgICAub24oJ2tleWRvd24uYnMuc2VsZWN0JywgJy5ib290c3RyYXAtc2VsZWN0IFtkYXRhLXRvZ2dsZT0iZHJvcGRvd24iXSwgLmJvb3RzdHJhcC1zZWxlY3QgW3JvbGU9Imxpc3Rib3giXSwgLmJzLXNlYXJjaGJveCBpbnB1dCcsIFNlbGVjdHBpY2tlci5wcm90b3R5cGUua2V5ZG93bikNCiAgICAgIC5vbignZm9jdXNpbi5tb2RhbCcsICcuYm9vdHN0cmFwLXNlbGVjdCBbZGF0YS10b2dnbGU9ImRyb3Bkb3duIl0sIC5ib290c3RyYXAtc2VsZWN0IFtyb2xlPSJsaXN0Ym94Il0sIC5icy1zZWFyY2hib3ggaW5wdXQnLCBmdW5jdGlvbiAoZSkgew0KICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgfSk7DQoNCiAgLy8gU0VMRUNUUElDS0VSIERBVEEtQVBJDQogIC8vID09PT09PT09PT09PT09PT09PT09PQ0KICAkKHdpbmRvdykub24oJ2xvYWQuYnMuc2VsZWN0LmRhdGEtYXBpJywgZnVuY3Rpb24gKCkgew0KICAgICQoJy5zZWxlY3RwaWNrZXInKS5lYWNoKGZ1bmN0aW9uICgpIHsNCiAgICAgIHZhciAkc2VsZWN0cGlja2VyID0gJCh0aGlzKTsNCiAgICAgIFBsdWdpbi5jYWxsKCRzZWxlY3RwaWNrZXIsICRzZWxlY3RwaWNrZXIuZGF0YSgpKTsNCiAgICB9KQ0KICB9KTsNCn0pKGpRdWVyeSk7DQoKCn0pKTsKDQovKgogKiBib290c3RyYXAtZmlsZXN0eWxlCiAqIGRvYzogaHR0cDovL21hcmt1c3NsaW1hLmdpdGh1Yi5pby9ib290c3RyYXAtZmlsZXN0eWxlLwogKiBnaXRodWI6IGh0dHBzOi8vZ2l0aHViLmNvbS9tYXJrdXNzbGltYS9ib290c3RyYXAtZmlsZXN0eWxlCiAqCiAqIENvcHlyaWdodCAoYykgMjAxNyBNYXJrdXMgVmluaWNpdXMgZGEgU2lsdmEgTGltYQogKiBWZXJzaW9uIDIuMS4wCiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4KICovCiFmdW5jdGlvbihlKXsidXNlIHN0cmljdCI7dmFyIHQ9MCxpPWZ1bmN0aW9uKHQsaSl7dGhpcy5vcHRpb25zPWksdGhpcy4kZWxlbWVudEZpbGVzdHlsZT1bXSx0aGlzLiRlbGVtZW50PWUodCl9O2kucHJvdG90eXBlPXtjbGVhcjpmdW5jdGlvbigpe3RoaXMuJGVsZW1lbnQudmFsKCIiKSx0aGlzLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoIjp0ZXh0IikudmFsKCIiKSx0aGlzLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoIi5iYWRnZSIpLnJlbW92ZSgpfSxkZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy4kZWxlbWVudC5yZW1vdmVBdHRyKCJzdHlsZSIpLnJlbW92ZURhdGEoImZpbGVzdHlsZSIpLHRoaXMuJGVsZW1lbnRGaWxlc3R5bGUucmVtb3ZlKCl9LGRpc2FibGVkOmZ1bmN0aW9uKGUpe3JldHVybiBlIT09ITAmJmUhPT0hMT90aGlzLm9wdGlvbnMuZGlzYWJsZWQ6KHRoaXMub3B0aW9ucy5kaXNhYmxlZD1lLHRoaXMuJGVsZW1lbnQucHJvcCgiZGlzYWJsZWQiLHRoaXMub3B0aW9ucy5kaXNhYmxlZCksdGhpcy4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCJsYWJlbCIpLnByb3AoImRpc2FibGVkIix0aGlzLm9wdGlvbnMuZGlzYWJsZWQpLHRoaXMub3B0aW9ucy5kaXNhYmxlZD90aGlzLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoImxhYmVsIikuY3NzKCJvcGFjaXR5IiwiMC42NSIpOnRoaXMuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgibGFiZWwiKS5jc3MoIm9wYWNpdHkiLCIxIiksdm9pZCAwKX0sZHJhZ2Ryb3A6ZnVuY3Rpb24oZSl7cmV0dXJuIGUhPT0hMCYmZSE9PSExP3RoaXMub3B0aW9ucy5kcmFnZHJvcDp2b2lkKHRoaXMub3B0aW9ucy5kcmFnZHJvcD1lKX0sYnV0dG9uQmVmb3JlOmZ1bmN0aW9uKGUpe2lmKGU9PT0hMCl0aGlzLm9wdGlvbnMuYnV0dG9uQmVmb3JlfHwodGhpcy5vcHRpb25zLmJ1dHRvbkJlZm9yZT1lLHRoaXMub3B0aW9ucy5pbnB1dCYmKHRoaXMuJGVsZW1lbnRGaWxlc3R5bGUucmVtb3ZlKCksdGhpcy5jb25zdHJ1Y3RvcigpLHRoaXMucHVzaE5hbWVGaWxlcygpKSk7ZWxzZXtpZihlIT09ITEpcmV0dXJuIHRoaXMub3B0aW9ucy5idXR0b25CZWZvcmU7dGhpcy5vcHRpb25zLmJ1dHRvbkJlZm9yZSYmKHRoaXMub3B0aW9ucy5idXR0b25CZWZvcmU9ZSx0aGlzLm9wdGlvbnMuaW5wdXQmJih0aGlzLiRlbGVtZW50RmlsZXN0eWxlLnJlbW92ZSgpLHRoaXMuY29uc3RydWN0b3IoKSx0aGlzLnB1c2hOYW1lRmlsZXMoKSkpfX0saW5wdXQ6ZnVuY3Rpb24oZSl7aWYoZT09PSEwKXRoaXMub3B0aW9ucy5pbnB1dHx8KHRoaXMub3B0aW9ucy5pbnB1dD1lLHRoaXMub3B0aW9ucy5idXR0b25CZWZvcmU/dGhpcy4kZWxlbWVudEZpbGVzdHlsZS5hcHBlbmQodGhpcy5odG1sSW5wdXQoKSk6dGhpcy4kZWxlbWVudEZpbGVzdHlsZS5wcmVwZW5kKHRoaXMuaHRtbElucHV0KCkpLHRoaXMucHVzaE5hbWVGaWxlcygpLHRoaXMuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgiLmdyb3VwLXNwYW4tZmlsZXN0eWxlIikuYWRkQ2xhc3MoImlucHV0LWdyb3VwLWJ0biIpKTtlbHNle2lmKGUhPT0hMSlyZXR1cm4gdGhpcy5vcHRpb25zLmlucHV0O3RoaXMub3B0aW9ucy5pbnB1dCYmKHRoaXMub3B0aW9ucy5pbnB1dD1lLHRoaXMuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgiOnRleHQiKS5yZW1vdmUoKSx0aGlzLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoIi5ncm91cC1zcGFuLWZpbGVzdHlsZSIpLnJlbW92ZUNsYXNzKCJpbnB1dC1ncm91cC1idG4iKSl9fSxzaXplOmZ1bmN0aW9uKGUpe2lmKHZvaWQgMD09PWUpcmV0dXJuIHRoaXMub3B0aW9ucy5zaXplO3RoaXMub3B0aW9ucy5zaXplPWU7dmFyIHQ9dGhpcy4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCJsYWJlbCIpLGk9dGhpcy4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCJpbnB1dCIpO3QucmVtb3ZlQ2xhc3MoImJ0bi1sZyBidG4tc20iKSxpLnJlbW92ZUNsYXNzKCJmb3JtLWNvbnRyb2wtbGcgZm9ybS1jb250cm9sLXNtIiksIm5yIiE9dGhpcy5vcHRpb25zLnNpemUmJih0LmFkZENsYXNzKCJidG4tIit0aGlzLm9wdGlvbnMuc2l6ZSksaS5hZGRDbGFzcygiZm9ybS1jb250cm9sLSIrdGhpcy5vcHRpb25zLnNpemUpKX0scGxhY2Vob2xkZXI6ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMD09PWU/dGhpcy5vcHRpb25zLnBsYWNlaG9sZGVyOih0aGlzLm9wdGlvbnMucGxhY2Vob2xkZXI9ZSx2b2lkIHRoaXMuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgiaW5wdXQiKS5hdHRyKCJwbGFjZWhvbGRlciIsZSkpfSx0ZXh0OmZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lP3RoaXMub3B0aW9ucy50ZXh0Oih0aGlzLm9wdGlvbnMudGV4dD1lLHZvaWQgdGhpcy4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCJsYWJlbCAudGV4dCIpLmh0bWwodGhpcy5vcHRpb25zLnRleHQpKX0sYnRuQ2xhc3M6ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMD09PWU/dGhpcy5vcHRpb25zLmJ0bkNsYXNzOih0aGlzLm9wdGlvbnMuYnRuQ2xhc3M9ZSx2b2lkIHRoaXMuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgibGFiZWwiKS5hdHRyKHsiY2xhc3MiOiJidG4gIit0aGlzLm9wdGlvbnMuYnRuQ2xhc3MrIiBidG4tIit0aGlzLm9wdGlvbnMuc2l6ZX0pKX0sYmFkZ2U6ZnVuY3Rpb24oZSl7aWYoZT09PSEwKXt0aGlzLm9wdGlvbnMuYmFkZ2U9ZTt2YXIgdD10aGlzLnB1c2hOYW1lRmlsZXMoKTt0aGlzLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoImxhYmVsIikuYXBwZW5kKCcgPHNwYW4gY2xhc3M9ImJhZGdlICcrdGhpcy5vcHRpb25zLmJhZGdlTmFtZSsnIj4nK3QubGVuZ3RoKyI8L3NwYW4+Iil9ZWxzZXtpZihlIT09ITEpcmV0dXJuIHRoaXMub3B0aW9ucy5iYWRnZTt0aGlzLm9wdGlvbnMuYmFkZ2U9ZSx0aGlzLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoIi5iYWRnZSIpLnJlbW92ZSgpfX0sYmFkZ2VOYW1lOmZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lP3RoaXMub3B0aW9ucy5iYWRnZU5hbWU6KHRoaXMub3B0aW9ucy5iYWRnZU5hbWU9ZSx2b2lkIHRoaXMuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgiLmJhZGdlIikuYXR0cih7ImNsYXNzIjoiYmFkZ2UgIit0aGlzLm9wdGlvbnMuYmFkZ2VOYW1lfSkpfSxodG1sSWNvbjpmdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwIT09ZSYmKHRoaXMub3B0aW9ucy5odG1sSWNvbj1lKSx0aGlzLm9wdGlvbnMuaHRtbEljb259LGh0bWxJbnB1dDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMuaW5wdXQ/JzxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0iZm9ybS1jb250cm9sICcrKCJuciI9PXRoaXMub3B0aW9ucy5zaXplPyIiOiJmb3JtLWNvbnRyb2wtIit0aGlzLm9wdGlvbnMuc2l6ZSkrJyIgcGxhY2Vob2xkZXI9IicrdGhpcy5vcHRpb25zLnBsYWNlaG9sZGVyKyciIGRpc2FibGVkPiAnOiIifSxwdXNoTmFtZUZpbGVzOmZ1bmN0aW9uKCl7dmFyIGU9IiIsdD1bXTt2b2lkIDA9PT10aGlzLiRlbGVtZW50WzBdLmZpbGVzP3RbMF09e25hbWU6dGhpcy4kZWxlbWVudFswXSYmdGhpcy4kZWxlbWVudFswXS52YWx1ZX06dD10aGlzLiRlbGVtZW50WzBdLmZpbGVzO2Zvcih2YXIgaT0wO2k8dC5sZW5ndGg7aSsrKWUrPXRbaV0ubmFtZS5zcGxpdCgiXFwiKS5wb3AoKSsiLCAiO3JldHVybiIiIT09ZT90aGlzLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoIjp0ZXh0IikudmFsKGUucmVwbGFjZSgvXCwgJC9nLCIiKSk6dGhpcy4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCI6dGV4dCIpLnZhbCgiIiksdH0sY29uc3RydWN0b3I6ZnVuY3Rpb24oKXt2YXIgaT10aGlzLG49IiIscz1pLiRlbGVtZW50LmF0dHIoImlkIiksbD0iIjsiIiE9PXMmJnN8fChzPSJmaWxlc3R5bGUtIit0LGkuJGVsZW1lbnQuYXR0cih7aWQ6c30pLHQrKyksbD0nPHNwYW4gY2xhc3M9Imdyb3VwLXNwYW4tZmlsZXN0eWxlICcrKGkub3B0aW9ucy5pbnB1dD8iaW5wdXQtZ3JvdXAtYnRuIjoiIikrJyI+PGxhYmVsIGZvcj0iJytzKyciIHN0eWxlPSJtYXJnaW4tYm90dG9tOiAwOyIgY2xhc3M9ImJ0biAnK2kub3B0aW9ucy5idG5DbGFzcysiICIrKCJuciI9PWkub3B0aW9ucy5zaXplPyIiOiJidG4tIitpLm9wdGlvbnMuc2l6ZSkrJyIgJysoaS5vcHRpb25zLmRpc2FibGVkfHxpLiRlbGVtZW50LmF0dHIoImRpc2FibGVkIik/JyBkaXNhYmxlZD0idHJ1ZSInOiIiKSsiPiIraS5odG1sSWNvbigpKyc8c3BhbiBjbGFzcz0iYnV0dG9uVGV4dCI+JytpLm9wdGlvbnMudGV4dCsiPC9zcGFuPjwvbGFiZWw+PC9zcGFuPiIsbj1pLm9wdGlvbnMuYnV0dG9uQmVmb3JlP2wraS5odG1sSW5wdXQoKTppLmh0bWxJbnB1dCgpK2wsaS4kZWxlbWVudEZpbGVzdHlsZT1lKCc8ZGl2IGNsYXNzPSJib290c3RyYXAtZmlsZXN0eWxlIGlucHV0LWdyb3VwIj48ZGl2IG5hbWU9ImZpbGVkcmFnIj48L2Rpdj4nK24rIjwvZGl2PiIpLGkuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgiLmdyb3VwLXNwYW4tZmlsZXN0eWxlIikuYXR0cigidGFiaW5kZXgiLCIwIikua2V5cHJlc3MoZnVuY3Rpb24oZSl7cmV0dXJuIDEzPT09ZS5rZXlDb2RlfHwzMj09PWUuY2hhckNvZGU/KGkuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgibGFiZWwiKS5jbGljaygpLCExKTp2b2lkIDB9KSxpLiRlbGVtZW50LmNzcyh7cG9zaXRpb246ImFic29sdXRlIixjbGlwOiJyZWN0KDBweCAwcHggMHB4IDBweCkifSkuYXR0cigidGFiaW5kZXgiLCItMSIpLmFmdGVyKGkuJGVsZW1lbnRGaWxlc3R5bGUpLGkuJGVsZW1lbnRGaWxlc3R5bGUuZmluZChpLm9wdGlvbnMuYnV0dG9uQmVmb3JlPyJsYWJlbCI6IjppbnB1dCIpLmNzcyh7ImJvcmRlci10b3AtbGVmdC1yYWRpdXMiOiIuMjVyZW0iLCJib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzIjoiLjI1cmVtIn0pLGkuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgnW25hbWU9ImZpbGVkcmFnIl0nKS5jc3Moe3Bvc2l0aW9uOiJhYnNvbHV0ZSIsd2lkdGg6IjEwMCUiLGhlaWdodDppLiRlbGVtZW50RmlsZXN0eWxlLmhlaWdodCgpKyJweCIsInotaW5kZXgiOi0xfSksKGkub3B0aW9ucy5kaXNhYmxlZHx8aS4kZWxlbWVudC5hdHRyKCJkaXNhYmxlZCIpKSYmKGkuJGVsZW1lbnQuYXR0cigiZGlzYWJsZWQiLCJ0cnVlIiksaS5vcHRpb25zLmRpc2FibGVkP2kuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgibGFiZWwiKS5jc3MoIm9wYWNpdHkiLCIwLjY1Iik6aS4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCJsYWJlbCIpLmNzcygib3BhY2l0eSIsIjEiKSksaS4kZWxlbWVudC5jaGFuZ2UoZnVuY3Rpb24oKXt2YXIgZT1pLnB1c2hOYW1lRmlsZXMoKTtpLm9wdGlvbnMuYmFkZ2U/MD09aS4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCIuYmFkZ2UiKS5sZW5ndGg/aS4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCJsYWJlbCIpLmFwcGVuZCgnIDxzcGFuIGNsYXNzPSJiYWRnZSAnK2kub3B0aW9ucy5iYWRnZU5hbWUrJyI+JytlLmxlbmd0aCsiPC9zcGFuPiIpOjA9PWUubGVuZ3RoP2kuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgiLmJhZGdlIikucmVtb3ZlKCk6aS4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCIuYmFkZ2UiKS5odG1sKGUubGVuZ3RoKTppLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoIi5iYWRnZSIpLnJlbW92ZSgpLGkub3B0aW9ucy5vbkNoYW5nZShlKX0pLHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LnNlYXJjaCgvZmlyZWZveC9pKT4tMSYmaS4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCJsYWJlbCIpLmNsaWNrKGZ1bmN0aW9uKCl7cmV0dXJuIGkuJGVsZW1lbnQuY2xpY2soKSwhMX0pLGUoZG9jdW1lbnQpLm9uKCJkcmFnb3ZlciIsZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHQuc3RvcFByb3BhZ2F0aW9uKCksaS5vcHRpb25zLmRyYWdkcm9wJiZlKCdbbmFtZT0iZmlsZWRyYWciXScpLmNzcygiei1pbmRleCIsIjkiKX0pLm9uKCJkcm9wIixmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdC5zdG9wUHJvcGFnYXRpb24oKSxpLm9wdGlvbnMuZHJhZ2Ryb3AmJmUoJ1tuYW1lPSJmaWxlZHJhZyJdJykuY3NzKCJ6LWluZGV4IiwiLTEiKX0pLGkuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgnW25hbWU9ImZpbGVkcmFnIl0nKS5vbigiZHJhZ292ZXIiLGZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKSxlLnN0b3BQcm9wYWdhdGlvbigpfSkub24oImRyYWdlbnRlciIsZnVuY3Rpb24oZSl7ZS5wcmV2ZW50RGVmYXVsdCgpLGUuc3RvcFByb3BhZ2F0aW9uKCl9KS5vbigiZHJvcCIsZnVuY3Rpb24odCl7aWYodC5vcmlnaW5hbEV2ZW50LmRhdGFUcmFuc2ZlciYmIWkub3B0aW9ucy5kaXNhYmxlZCYmaS5vcHRpb25zLmRyYWdkcm9wJiZ0Lm9yaWdpbmFsRXZlbnQuZGF0YVRyYW5zZmVyLmZpbGVzLmxlbmd0aCl7dC5wcmV2ZW50RGVmYXVsdCgpLHQuc3RvcFByb3BhZ2F0aW9uKCksaS4kZWxlbWVudFswXS5maWxlcz10Lm9yaWdpbmFsRXZlbnQuZGF0YVRyYW5zZmVyLmZpbGVzO3ZhciBuPWkucHVzaE5hbWVGaWxlcygpO2kub3B0aW9ucy5iYWRnZT8wPT1pLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoIi5iYWRnZSIpLmxlbmd0aD9pLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoImxhYmVsIikuYXBwZW5kKCcgPHNwYW4gY2xhc3M9ImJhZGdlICcraS5vcHRpb25zLmJhZGdlTmFtZSsnIj4nK24ubGVuZ3RoKyI8L3NwYW4+Iik6MD09bi5sZW5ndGg/aS4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCIuYmFkZ2UiKS5yZW1vdmUoKTppLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoIi5iYWRnZSIpLmh0bWwobi5sZW5ndGgpOmkuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgiLmJhZGdlIikucmVtb3ZlKCksZSgnW25hbWU9ImZpbGVkcmFnIl0nKS5jc3MoInotaW5kZXgiLCItMSIpfX0pfX07dmFyIG49ZS5mbi5maWxlc3R5bGU7ZS5mbi5maWxlc3R5bGU9ZnVuY3Rpb24odCxuKXt2YXIgcz0iIixsPXRoaXMuZWFjaChmdW5jdGlvbigpe2lmKCJmaWxlIj09PWUodGhpcykuYXR0cigidHlwZSIpKXt2YXIgbD1lKHRoaXMpLG89bC5kYXRhKCJmaWxlc3R5bGUiKSxhPWUuZXh0ZW5kKHt9LGUuZm4uZmlsZXN0eWxlLmRlZmF1bHRzLHQsIm9iamVjdCI9PXR5cGVvZiB0JiZ0KTtvfHwobC5kYXRhKCJmaWxlc3R5bGUiLG89bmV3IGkodGhpcyxhKSksby5jb25zdHJ1Y3RvcigpKSwic3RyaW5nIj09dHlwZW9mIHQmJihzPW9bdF0obikpfX0pO3JldHVybiB2b2lkIDAhPT10eXBlb2Ygcz9zOmx9LGUuZm4uZmlsZXN0eWxlLmRlZmF1bHRzPXt0ZXh0OiLoq4vpgbjmk4ciLGh0bWxJY29uOiIiLGJ0bkNsYXNzOiJidG4taW5mbyIsc2l6ZToibnIiLGlucHV0OiEwLGJhZGdlOiExLGJhZGdlTmFtZToiYmFkZ2UtbGlnaHQiLGJ1dHRvbkJlZm9yZTohMSxkcmFnZHJvcDohMCxkaXNhYmxlZDohMSxwbGFjZWhvbGRlcjoiIixvbkNoYW5nZTpmdW5jdGlvbigpe319LGUuZm4uZmlsZXN0eWxlLm5vQ29uZmxpY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gZS5mbi5maWxlc3R5bGU9bix0aGlzfSxlKGZ1bmN0aW9uKCl7ZSgiLmZpbGVzdHlsZSIpLmVhY2goZnVuY3Rpb24oKXt2YXIgdD1lKHRoaXMpLGk9e2lucHV0OiJmYWxzZSIhPT10LmF0dHIoImRhdGEtaW5wdXQiKSxodG1sSWNvbjp0LmF0dHIoImRhdGEtaWNvbiIpLGJ1dHRvbkJlZm9yZToidHJ1ZSI9PT10LmF0dHIoImRhdGEtYnV0dG9uQmVmb3JlIiksZGlzYWJsZWQ6InRydWUiPT09dC5hdHRyKCJkYXRhLWRpc2FibGVkIiksc2l6ZTp0LmF0dHIoImRhdGEtc2l6ZSIpLHRleHQ6dC5hdHRyKCJkYXRhLXRleHQiKSxidG5DbGFzczp0LmF0dHIoImRhdGEtYnRuQ2xhc3MiKSxiYWRnZToidHJ1ZSI9PT10LmF0dHIoImRhdGEtYmFkZ2UiKSxkcmFnZHJvcDoiZmFsc2UiIT09dC5hdHRyKCJkYXRhLWRyYWdkcm9wIiksYmFkZ2VOYW1lOnQuYXR0cigiZGF0YS1iYWRnZU5hbWUiKSxwbGFjZWhvbGRlcjp0LmF0dHIoImRhdGEtcGxhY2Vob2xkZXIiKX07dC5maWxlc3R5bGUoaSl9KX0pfSh3aW5kb3cualF1ZXJ5KTsNCiEgZnVuY3Rpb24odCkgew0KICAgIGZ1bmN0aW9uIGUocikgew0KICAgICAgICBpZiAobltyXSkgcmV0dXJuIG5bcl0uZXhwb3J0czsNCiAgICAgICAgdmFyIHMgPSBuW3JdID0gew0KICAgICAgICAgICAgaTogciwNCiAgICAgICAgICAgIGw6ICExLA0KICAgICAgICAgICAgZXhwb3J0czoge30NCiAgICAgICAgfTsNCiAgICAgICAgcmV0dXJuIHRbcl0uY2FsbChzLmV4cG9ydHMsIHMsIHMuZXhwb3J0cywgZSksIHMubCA9ICEwLCBzLmV4cG9ydHMNCiAgICB9DQogICAgdmFyIG4gPSB7fTsNCiAgICBlLm0gPSB0LCBlLmMgPSBuLCBlLmkgPSBmdW5jdGlvbih0KSB7DQogICAgICAgIHJldHVybiB0DQogICAgfSwgZS5kID0gZnVuY3Rpb24odCwgbiwgcikgew0KICAgICAgICBlLm8odCwgbikgfHwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIG4sIHsNCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogITEsDQogICAgICAgICAgICBlbnVtZXJhYmxlOiAhMCwNCiAgICAgICAgICAgIGdldDogcg0KICAgICAgICB9KQ0KICAgIH0sIGUubiA9IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgdmFyIG4gPSB0ICYmIHQuX19lc01vZHVsZSA/IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgcmV0dXJuIHQuZGVmYXVsdA0KICAgICAgICB9IDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICByZXR1cm4gdA0KICAgICAgICB9Ow0KICAgICAgICByZXR1cm4gZS5kKG4sICJhIiwgbiksIG4NCiAgICB9LCBlLm8gPSBmdW5jdGlvbih0LCBlKSB7DQogICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCwgZSkNCiAgICB9LCBlLnAgPSAiLi8iLCBlKGUucyA9IDgxKQ0KfShbLCBmdW5jdGlvbih0LCBlKSB7DQogICAgdC5leHBvcnRzID0gZnVuY3Rpb24oKSB7DQogICAgICAgIHZhciB0ID0gW107DQogICAgICAgIHJldHVybiB0LnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBmb3IgKHZhciB0ID0gW10sIGUgPSAwOyBlIDwgdGhpcy5sZW5ndGg7IGUrKykgew0KICAgICAgICAgICAgICAgIHZhciBuID0gdGhpc1tlXTsNCiAgICAgICAgICAgICAgICBuWzJdID8gdC5wdXNoKCJAbWVkaWEgIiArIG5bMl0gKyAieyIgKyBuWzFdICsgIn0iKSA6IHQucHVzaChuWzFdKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIHQuam9pbigiIikNCiAgICAgICAgfSwgdC5pID0gZnVuY3Rpb24oZSwgbikgew0KICAgICAgICAgICAgInN0cmluZyIgPT0gdHlwZW9mIGUgJiYgKGUgPSBbDQogICAgICAgICAgICAgICAgW251bGwsIGUsICIiXQ0KICAgICAgICAgICAgXSk7DQogICAgICAgICAgICBmb3IgKHZhciByID0ge30sIHMgPSAwOyBzIDwgdGhpcy5sZW5ndGg7IHMrKykgew0KICAgICAgICAgICAgICAgIHZhciBpID0gdGhpc1tzXVswXTsNCiAgICAgICAgICAgICAgICAibnVtYmVyIiA9PSB0eXBlb2YgaSAmJiAocltpXSA9ICEwKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZm9yIChzID0gMDsgcyA8IGUubGVuZ3RoOyBzKyspIHsNCiAgICAgICAgICAgICAgICB2YXIgYSA9IGVbc107DQogICAgICAgICAgICAgICAgIm51bWJlciIgPT0gdHlwZW9mIGFbMF0gJiYgclthWzBdXSB8fCAobiAmJiAhYVsyXSA/IGFbMl0gPSBuIDogbiAmJiAoYVsyXSA9ICIoIiArIGFbMl0gKyAiKSBhbmQgKCIgKyBuICsgIikiKSwgdC5wdXNoKGEpKQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LCB0DQogICAgfQ0KfSwgZnVuY3Rpb24odCwgZSkgew0KICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uKHQsIGUsIG4sIHIpIHsNCiAgICAgICAgdmFyIHMsIGkgPSB0ID0gdCB8fCB7fSwNCiAgICAgICAgICAgIGEgPSB0eXBlb2YgdC5kZWZhdWx0Ow0KICAgICAgICAib2JqZWN0IiAhPT0gYSAmJiAiZnVuY3Rpb24iICE9PSBhIHx8IChzID0gdCwgaSA9IHQuZGVmYXVsdCk7DQogICAgICAgIHZhciBvID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgaSA/IGkub3B0aW9ucyA6IGk7DQogICAgICAgIGlmIChlICYmIChvLnJlbmRlciA9IGUucmVuZGVyLCBvLnN0YXRpY1JlbmRlckZucyA9IGUuc3RhdGljUmVuZGVyRm5zKSwgbiAmJiAoby5fc2NvcGVJZCA9IG4pLCByKSB7DQogICAgICAgICAgICB2YXIgbCA9IG8uY29tcHV0ZWQgfHwgKG8uY29tcHV0ZWQgPSB7fSk7DQogICAgICAgICAgICBPYmplY3Qua2V5cyhyKS5mb3JFYWNoKGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICB2YXIgZSA9IHJbdF07DQogICAgICAgICAgICAgICAgbFt0XSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGVzTW9kdWxlOiBzLA0KICAgICAgICAgICAgZXhwb3J0czogaSwNCiAgICAgICAgICAgIG9wdGlvbnM6IG8NCiAgICAgICAgfQ0KICAgIH0NCn0sIGZ1bmN0aW9uKHQsIGUsIG4pIHsNCiAgICBmdW5jdGlvbiByKHQpIHsNCiAgICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCB0Lmxlbmd0aDsgZSsrKSB7DQogICAgICAgICAgICB2YXIgbiA9IHRbZV0sDQogICAgICAgICAgICAgICAgciA9IGNbbi5pZF07DQogICAgICAgICAgICBpZiAocikgew0KICAgICAgICAgICAgICAgIHIucmVmcysrOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIHMgPSAwOyBzIDwgci5wYXJ0cy5sZW5ndGg7IHMrKykgci5wYXJ0c1tzXShuLnBhcnRzW3NdKTsNCiAgICAgICAgICAgICAgICBmb3IgKDsgcyA8IG4ucGFydHMubGVuZ3RoOyBzKyspIHIucGFydHMucHVzaChpKG4ucGFydHNbc10pKTsNCiAgICAgICAgICAgICAgICByLnBhcnRzLmxlbmd0aCA+IG4ucGFydHMubGVuZ3RoICYmIChyLnBhcnRzLmxlbmd0aCA9IG4ucGFydHMubGVuZ3RoKQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBhID0gW10sIHMgPSAwOyBzIDwgbi5wYXJ0cy5sZW5ndGg7IHMrKykgYS5wdXNoKGkobi5wYXJ0c1tzXSkpOw0KICAgICAgICAgICAgICAgIGNbbi5pZF0gPSB7DQogICAgICAgICAgICAgICAgICAgIGlkOiBuLmlkLA0KICAgICAgICAgICAgICAgICAgICByZWZzOiAxLA0KICAgICAgICAgICAgICAgICAgICBwYXJ0czogYQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIHMoKSB7DQogICAgICAgIHZhciB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3R5bGUiKTsNCiAgICAgICAgcmV0dXJuIHQudHlwZSA9ICJ0ZXh0L2NzcyIsIGYuYXBwZW5kQ2hpbGQodCksIHQNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBpKHQpIHsNCiAgICAgICAgdmFyIGUsIG4sIHIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdzdHlsZVtkYXRhLXZ1ZS1zc3ItaWR+PSInICsgdC5pZCArICciXScpOw0KICAgICAgICBpZiAocikgew0KICAgICAgICAgICAgaWYgKGQpIHJldHVybiBnOw0KICAgICAgICAgICAgci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHIpDQogICAgICAgIH0NCiAgICAgICAgaWYgKGIpIHsNCiAgICAgICAgICAgIHZhciBpID0gaCsrOw0KICAgICAgICAgICAgciA9IHAgfHwgKHAgPSBzKCkpLCBlID0gYS5iaW5kKG51bGwsIHIsIGksICExKSwgbiA9IGEuYmluZChudWxsLCByLCBpLCAhMCkNCiAgICAgICAgfSBlbHNlIHIgPSBzKCksIGUgPSBvLmJpbmQobnVsbCwgciksIG4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChyKQ0KICAgICAgICB9Ow0KICAgICAgICByZXR1cm4gZSh0KSwNCiAgICAgICAgICAgIGZ1bmN0aW9uKHIpIHsNCiAgICAgICAgICAgICAgICBpZiAocikgew0KICAgICAgICAgICAgICAgICAgICBpZiAoci5jc3MgPT09IHQuY3NzICYmIHIubWVkaWEgPT09IHQubWVkaWEgJiYgci5zb3VyY2VNYXAgPT09IHQuc291cmNlTWFwKSByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIGUodCA9IHIpDQogICAgICAgICAgICAgICAgfSBlbHNlIG4oKQ0KICAgICAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGEodCwgZSwgbiwgcikgew0KICAgICAgICB2YXIgcyA9IG4gPyAiIiA6IHIuY3NzOw0KICAgICAgICBpZiAodC5zdHlsZVNoZWV0KSB0LnN0eWxlU2hlZXQuY3NzVGV4dCA9IHkoZSwgcyk7DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgdmFyIGkgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShzKSwNCiAgICAgICAgICAgICAgICBhID0gdC5jaGlsZE5vZGVzOw0KICAgICAgICAgICAgYVtlXSAmJiB0LnJlbW92ZUNoaWxkKGFbZV0pLCBhLmxlbmd0aCA/IHQuaW5zZXJ0QmVmb3JlKGksIGFbZV0pIDogdC5hcHBlbmRDaGlsZChpKQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gbyh0LCBlKSB7DQogICAgICAgIHZhciBuID0gZS5jc3MsDQogICAgICAgICAgICByID0gZS5tZWRpYSwNCiAgICAgICAgICAgIHMgPSBlLnNvdXJjZU1hcDsNCiAgICAgICAgaWYgKHIgJiYgdC5zZXRBdHRyaWJ1dGUoIm1lZGlhIiwgciksIHMgJiYgKG4gKz0gIlxuLyojIHNvdXJjZVVSTD0iICsgcy5zb3VyY2VzWzBdICsgIiAqLyIsIG4gKz0gIlxuLyojIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCwiICsgYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkocykpKSkgKyAiICovIiksIHQuc3R5bGVTaGVldCkgdC5zdHlsZVNoZWV0LmNzc1RleHQgPSBuOw0KICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgIGZvciAoOyB0LmZpcnN0Q2hpbGQ7KSB0LnJlbW92ZUNoaWxkKHQuZmlyc3RDaGlsZCk7DQogICAgICAgICAgICB0LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKG4pKQ0KICAgICAgICB9DQogICAgfQ0KICAgIHZhciBsID0gInVuZGVmaW5lZCIgIT0gdHlwZW9mIGRvY3VtZW50Ow0KICAgIGlmICgidW5kZWZpbmVkIiAhPSB0eXBlb2YgREVCVUcgJiYgREVCVUcgJiYgIWwpIHRocm93IG5ldyBFcnJvcigidnVlLXN0eWxlLWxvYWRlciBjYW5ub3QgYmUgdXNlZCBpbiBhIG5vbi1icm93c2VyIGVudmlyb25tZW50LiBVc2UgeyB0YXJnZXQ6ICdub2RlJyB9IGluIHlvdXIgV2VicGFjayBjb25maWcgdG8gaW5kaWNhdGUgYSBzZXJ2ZXItcmVuZGVyaW5nIGVudmlyb25tZW50LiIpOw0KICAgIHZhciB1ID0gbigzNyksDQogICAgICAgIGMgPSB7fSwNCiAgICAgICAgZiA9IGwgJiYgKGRvY3VtZW50LmhlYWQgfHwgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImhlYWQiKVswXSksDQogICAgICAgIHAgPSBudWxsLA0KICAgICAgICBoID0gMCwNCiAgICAgICAgZCA9ICExLA0KICAgICAgICBnID0gZnVuY3Rpb24oKSB7fSwNCiAgICAgICAgYiA9ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBuYXZpZ2F0b3IgJiYgL21zaWUgWzYtOV1cYi8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkpOw0KICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uKHQsIGUsIG4pIHsNCiAgICAgICAgZCA9IG47DQogICAgICAgIHZhciBzID0gdSh0LCBlKTsNCiAgICAgICAgcmV0dXJuIHIocyksDQogICAgICAgICAgICBmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgbiA9IFtdLCBpID0gMDsgaSA8IHMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBzW2ldLA0KICAgICAgICAgICAgICAgICAgICAgICAgbyA9IGNbYS5pZF07DQogICAgICAgICAgICAgICAgICAgIG8ucmVmcy0tLCBuLnB1c2gobykNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZSA/IChzID0gdSh0LCBlKSwgcihzKSkgOiBzID0gW107DQogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBvID0gbltpXTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT09IG8ucmVmcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbCA9IDA7IGwgPCBvLnBhcnRzLmxlbmd0aDsgbCsrKSBvLnBhcnRzW2xdKCk7DQogICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgY1tvLmlkXQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgIH07DQogICAgdmFyIHkgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgdmFyIHQgPSBbXTsNCiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUsIG4pIHsNCiAgICAgICAgICAgIHJldHVybiB0W2VdID0gbiwgdC5maWx0ZXIoQm9vbGVhbikuam9pbigiXG4iKQ0KICAgICAgICB9DQogICAgfSgpDQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgInVzZSBzdHJpY3QiOw0KDQogICAgZnVuY3Rpb24gcih0LCBlKSB7DQogICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiBlKSkgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIikNCiAgICB9DQogICAgdmFyIHMgPSBuKDYpLA0KICAgICAgICBpID0gbi5uKHMpLA0KICAgICAgICBhID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPyBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICByZXR1cm4gdHlwZW9mIHQNCiAgICAgICAgfSA6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgIHJldHVybiB0ICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiB0LmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgdCAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIHQNCiAgICAgICAgfSwNCiAgICAgICAgbyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgZnVuY3Rpb24gdCh0LCBlKSB7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBlLmxlbmd0aDsgbisrKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciByID0gZVtuXTsNCiAgICAgICAgICAgICAgICAgICAgci5lbnVtZXJhYmxlID0gci5lbnVtZXJhYmxlIHx8ICExLCByLmNvbmZpZ3VyYWJsZSA9ICEwLCAidmFsdWUiIGluIHIgJiYgKHIud3JpdGFibGUgPSAhMCksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCByLmtleSwgcikNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSwgbiwgcikgew0KICAgICAgICAgICAgICAgIHJldHVybiBuICYmIHQoZS5wcm90b3R5cGUsIG4pLCByICYmIHQoZSwgciksIGUNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSgpLA0KICAgICAgICBsID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBmdW5jdGlvbiB0KCkgew0KICAgICAgICAgICAgICAgIHIodGhpcywgdCksIHRoaXMucHJvcGVydGllcyA9IHsNCiAgICAgICAgICAgICAgICAgICAgdGFibGU6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiAidGFibGUgdGFibGUtaG92ZXIgdGFibGUtc3RyaXBlZCIsDQogICAgICAgICAgICAgICAgICAgICAgICByb3c6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiBbIiJdDQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgc29ydGluZzogew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzZXM6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FuU29ydDogWyJzb3J0Il0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvcnROb25lOiBbImZhIiwgImZhLXNvcnQiXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ydEFzYzogWyJmYSIsICJmYS1zb3J0LWFzYyJdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3J0RGVzYzogWyJmYSIsICJmYS1zb3J0LWRlc2MiXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgcGFnZXI6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzZXM6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlcjogInBhZ2luYXRpb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpOiAicGFnZS1pdGVtIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOiAicGFnZS1saW5rIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogImFjdGl2ZSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6ICJkaXNhYmxlZCINCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICBpY29uczogew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzOiAiJmx0OyIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dDogIiZndDsiDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gbyh0LCBbew0KICAgICAgICAgICAgICAgIGtleTogImdldCIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGkuYS5nZXQodGhpcy5wcm9wZXJ0aWVzLCB0KQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBrZXk6ICJzZXQiLA0KICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbih0LCBlKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBpLmEuc2V0KHRoaXMucHJvcGVydGllcywgdCwgZSksIHRoaXMNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAga2V5OiAibWVyZ2UiLA0KICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMgPSB0aGlzLl9tZXJnZU9iamVjdHModGhpcy5wcm9wZXJ0aWVzLCB0KSwgdGhpcw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBrZXk6ICJfbWVyZ2VPYmplY3RzIiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCwgZSkgew0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBuIGluIGUpIG51bGwgIT09IGVbbl0gPyAib2JqZWN0IiAhPT0gYShlW25dKSA/IHRbbl0gPSBlW25dIDogdFtuXSA9IHRoaXMuX21lcmdlT2JqZWN0cyh0W25dLCBlW25dKSA6IHRbbl0gPSBlW25dOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH1dKSwgdA0KICAgICAgICB9KCk7DQogICAgZS5hID0gbA0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgICJ1c2Ugc3RyaWN0IjsNCg0KICAgIGZ1bmN0aW9uIHIodCwgZSkgew0KICAgICAgICBpZiAoISh0IGluc3RhbmNlb2YgZSkpIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpDQogICAgfQ0KICAgIHZhciBzID0gbig2KSwNCiAgICAgICAgaSA9IG4ubihzKSwNCiAgICAgICAgYSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgZnVuY3Rpb24gdCh0LCBlKSB7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBlLmxlbmd0aDsgbisrKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciByID0gZVtuXTsNCiAgICAgICAgICAgICAgICAgICAgci5lbnVtZXJhYmxlID0gci5lbnVtZXJhYmxlIHx8ICExLCByLmNvbmZpZ3VyYWJsZSA9ICEwLCAidmFsdWUiIGluIHIgJiYgKHIud3JpdGFibGUgPSAhMCksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCByLmtleSwgcikNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSwgbiwgcikgew0KICAgICAgICAgICAgICAgIHJldHVybiBuICYmIHQoZS5wcm90b3R5cGUsIG4pLCByICYmIHQoZSwgciksIGUNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSgpLA0KICAgICAgICBvID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBmdW5jdGlvbiB0KGUpIHsNCiAgICAgICAgICAgICAgICByKHRoaXMsIHQpLCB0aGlzLnNldEFsaWdubWVudChlLmFsaWduKSwgdGhpcy5sYWJlbCA9IGUubGFiZWwgfHwgIiIsIHRoaXMuZmllbGQgPSBlLmZpZWxkIHx8IG51bGwsIHRoaXMucmVwcmVzZW50ZWRBcyA9IGUucmVwcmVzZW50ZWRBcyB8fCBudWxsLCB0aGlzLmNvbXBvbmVudCA9IGUuY29tcG9uZW50IHx8IG51bGwsIHRoaXMuaW50ZXJwb2xhdGUgPSBlLmludGVycG9sYXRlIHx8ICExLCB0aGlzLnNvcnRhYmxlID0gdGhpcy5pc1NvcnRhYmxlKGUpLCB0aGlzLmZpbHRlcmFibGUgPSB0aGlzLmlzRmlsdGVyYWJsZShlKSwgdGhpcy5kaXNwbGF5ID0gZS5kaXNwbGF5IHx8IG51bGwNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBhKHQsIFt7DQogICAgICAgICAgICAgICAga2V5OiAic2V0QWxpZ25tZW50IiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdCAmJiAic3RyaW5nIiA9PSB0eXBlb2YgdCA/ICJjZW50ZXIiID09PSB0LnRvTG93ZXJDYXNlKCkgPyAodGhpcy5hbGlnbiA9ICJjZW50ZXIiLCB0aGlzKSA6ICJyaWdodCIgPT09IHQudG9Mb3dlckNhc2UoKSA/ICh0aGlzLmFsaWduID0gInJpZ2h0IiwgdGhpcykgOiAodGhpcy5hbGlnbiA9ICJsZWZ0IiwgdGhpcykgOiAodGhpcy5hbGlnbiA9ICJsZWZ0IiwgdGhpcykNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAga2V5OiAiaXNGaWx0ZXJhYmxlIiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gITEgIT09IHQuZmlsdGVyYWJsZSAmJiAoISghdC5maWVsZCAmJiAhdC5yZXByZXNlbnRlZEFzKSAmJiAhKHRoaXMuY29tcG9uZW50ICYmICF0aGlzLnJlcHJlc2VudGVkQXMgJiYgIXRoaXMuZmllbGQpKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBrZXk6ICJpc1NvcnRhYmxlIiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gITEgIT09IHQuc29ydGFibGUgJiYgKCEoIXQuZmllbGQgJiYgIXQucmVwcmVzZW50ZWRBcykgJiYgISh0aGlzLmNvbXBvbmVudCAmJiAhdGhpcy5yZXByZXNlbnRlZEFzICYmICF0aGlzLmZpZWxkKSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAga2V5OiAiZ2V0UmVwcmVzZW50YXRpb24iLA0KICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlcHJlc2VudGVkQXMgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgdGhpcy5yZXByZXNlbnRlZEFzID8gdGhpcy5yZXByZXNlbnRlZEFzKHQpIDogdGhpcy5jb21wb25lbnQgJiYgdGhpcy5maWx0ZXJhYmxlID8gdGhpcy5wbGFpbl90ZXh0X2Z1bmN0aW9uKHQsIHRoaXMpIDogaS5hLmdldCh0LCB0aGlzLmZpZWxkKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBrZXk6ICJnZXRWYWx1ZSIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UmVwcmVzZW50YXRpb24odCkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAga2V5OiAibWF0Y2hlcyIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQsIGUpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xICE9PSAoIiIgKyB0aGlzLmdldFJlcHJlc2VudGF0aW9uKHQpKS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoZS50b0xvd2VyQ2FzZSgpKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH1dKSwgdA0KICAgICAgICB9KCk7DQogICAgZS5hID0gbw0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgIHZhciByLCBzLCBpOw0KICAgICEgZnVuY3Rpb24obiwgYSkgew0KICAgICAgICAidXNlIHN0cmljdCI7DQogICAgICAgICJvYmplY3QiID09IHR5cGVvZiB0ICYmICJvYmplY3QiID09IHR5cGVvZiB0LmV4cG9ydHMgPyB0LmV4cG9ydHMgPSBhKCkgOiAocyA9IFtdLCByID0gYSwgdm9pZCAwICE9PSAoaSA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIHIgPyByLmFwcGx5KGUsIHMpIDogcikgJiYgKHQuZXhwb3J0cyA9IGkpKQ0KICAgIH0oMCwgZnVuY3Rpb24oKSB7DQogICAgICAgICJ1c2Ugc3RyaWN0IjsNCg0KICAgICAgICBmdW5jdGlvbiB0KHQsIGUpIHsNCiAgICAgICAgICAgIHJldHVybiBudWxsICE9IHQgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsIGUpDQogICAgICAgIH0NCg0KICAgICAgICBmdW5jdGlvbiBlKGUpIHsNCiAgICAgICAgICAgIGlmICghZSkgcmV0dXJuICEwOw0KICAgICAgICAgICAgaWYgKGwoZSkgJiYgMCA9PT0gZS5sZW5ndGgpIHJldHVybiAhMDsNCiAgICAgICAgICAgIGlmICgic3RyaW5nIiAhPSB0eXBlb2YgZSkgew0KICAgICAgICAgICAgICAgIGZvciAodmFyIG4gaW4gZSkNCiAgICAgICAgICAgICAgICAgICAgaWYgKHQoZSwgbikpIHJldHVybiAhMTsNCiAgICAgICAgICAgICAgICByZXR1cm4gITANCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiAhMQ0KICAgICAgICB9DQoNCiAgICAgICAgZnVuY3Rpb24gbih0KSB7DQogICAgICAgICAgICByZXR1cm4gby5jYWxsKHQpDQogICAgICAgIH0NCg0KICAgICAgICBmdW5jdGlvbiByKHQpIHsNCiAgICAgICAgICAgIHJldHVybiAib2JqZWN0IiA9PSB0eXBlb2YgdCAmJiAiW29iamVjdCBPYmplY3RdIiA9PT0gbih0KQ0KICAgICAgICB9DQoNCiAgICAgICAgZnVuY3Rpb24gcyh0KSB7DQogICAgICAgICAgICByZXR1cm4gImJvb2xlYW4iID09IHR5cGVvZiB0IHx8ICJbb2JqZWN0IEJvb2xlYW5dIiA9PT0gbih0KQ0KICAgICAgICB9DQoNCiAgICAgICAgZnVuY3Rpb24gaSh0KSB7DQogICAgICAgICAgICB2YXIgZSA9IHBhcnNlSW50KHQpOw0KICAgICAgICAgICAgcmV0dXJuIGUudG9TdHJpbmcoKSA9PT0gdCA/IGUgOiB0DQogICAgICAgIH0NCg0KICAgICAgICBmdW5jdGlvbiBhKG4pIHsNCiAgICAgICAgICAgIGZ1bmN0aW9uIGEoZSwgcikgew0KICAgICAgICAgICAgICAgIHJldHVybiBuLmluY2x1ZGVJbmhlcml0ZWRQcm9wcyB8fCAibnVtYmVyIiA9PSB0eXBlb2YgciAmJiBBcnJheS5pc0FycmF5KGUpIHx8IHQoZSwgcikNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgZnVuY3Rpb24gbyh0LCBlKSB7DQogICAgICAgICAgICAgICAgaWYgKGEodCwgZSkpIHJldHVybiB0W2VdDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGZ1bmN0aW9uIHUodCwgZSwgbiwgcikgew0KICAgICAgICAgICAgICAgIGlmICgibnVtYmVyIiA9PSB0eXBlb2YgZSAmJiAoZSA9IFtlXSksICFlIHx8IDAgPT09IGUubGVuZ3RoKSByZXR1cm4gdDsNCiAgICAgICAgICAgICAgICBpZiAoInN0cmluZyIgPT0gdHlwZW9mIGUpIHJldHVybiB1KHQsIGUuc3BsaXQoIi4iKS5tYXAoaSksIG4sIHIpOw0KICAgICAgICAgICAgICAgIHZhciBzID0gZVswXSwNCiAgICAgICAgICAgICAgICAgICAgYSA9IG8odCwgcyk7DQogICAgICAgICAgICAgICAgcmV0dXJuIDEgPT09IGUubGVuZ3RoID8gKHZvaWQgMCAhPT0gYSAmJiByIHx8ICh0W3NdID0gbiksIGEpIDogKHZvaWQgMCA9PT0gYSAmJiAoIm51bWJlciIgPT0gdHlwZW9mIGVbMV0gPyB0W3NdID0gW10gOiB0W3NdID0ge30pLCB1KHRbc10sIGUuc2xpY2UoMSksIG4sIHIpKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgbiA9IG4gfHwge307DQogICAgICAgICAgICB2YXIgYyA9IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoYykucmVkdWNlKGZ1bmN0aW9uKGUsIG4pIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJjcmVhdGUiID09PSBuID8gZSA6ICgiZnVuY3Rpb24iID09IHR5cGVvZiBjW25dICYmIChlW25dID0gY1tuXS5iaW5kKGMsIHQpKSwgZSkNCiAgICAgICAgICAgICAgICB9LCB7fSkNCiAgICAgICAgICAgIH07DQogICAgICAgICAgICByZXR1cm4gYy5oYXMgPSBmdW5jdGlvbihlLCByKSB7DQogICAgICAgICAgICAgICAgaWYgKCJudW1iZXIiID09IHR5cGVvZiByID8gciA9IFtyXSA6ICJzdHJpbmciID09IHR5cGVvZiByICYmIChyID0gci5zcGxpdCgiLiIpKSwgIXIgfHwgMCA9PT0gci5sZW5ndGgpIHJldHVybiAhIWU7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgcyA9IDA7IHMgPCByLmxlbmd0aDsgcysrKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhID0gaShyW3NdKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCEoIm51bWJlciIgPT0gdHlwZW9mIGEgJiYgbChlKSAmJiBhIDwgZS5sZW5ndGggfHwgKG4uaW5jbHVkZUluaGVyaXRlZFByb3BzID8gYSBpbiBPYmplY3QoZSkgOiB0KGUsIGEpKSkpIHJldHVybiAhMTsNCiAgICAgICAgICAgICAgICAgICAgZSA9IGVbYV0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuICEwDQogICAgICAgICAgICB9LCBjLmVuc3VyZUV4aXN0cyA9IGZ1bmN0aW9uKHQsIGUsIG4pIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdSh0LCBlLCBuLCAhMCkNCiAgICAgICAgICAgIH0sIGMuc2V0ID0gZnVuY3Rpb24odCwgZSwgbiwgcikgew0KICAgICAgICAgICAgICAgIHJldHVybiB1KHQsIGUsIG4sIHIpDQogICAgICAgICAgICB9LCBjLmluc2VydCA9IGZ1bmN0aW9uKHQsIGUsIG4sIHIpIHsNCiAgICAgICAgICAgICAgICB2YXIgcyA9IGMuZ2V0KHQsIGUpOw0KICAgICAgICAgICAgICAgIHIgPSB+fnIsIGwocykgfHwgKHMgPSBbXSwgYy5zZXQodCwgZSwgcykpLCBzLnNwbGljZShyLCAwLCBuKQ0KICAgICAgICAgICAgfSwgYy5lbXB0eSA9IGZ1bmN0aW9uKHQsIG4pIHsNCiAgICAgICAgICAgICAgICBpZiAoIWUobikgJiYgbnVsbCAhPSB0KSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBpLCBvOw0KICAgICAgICAgICAgICAgICAgICBpZiAoaSA9IGMuZ2V0KHQsIG4pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoInN0cmluZyIgPT0gdHlwZW9mIGkpIHJldHVybiBjLnNldCh0LCBuLCAiIik7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocyhpKSkgcmV0dXJuIGMuc2V0KHQsIG4sICExKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgibnVtYmVyIiA9PSB0eXBlb2YgaSkgcmV0dXJuIGMuc2V0KHQsIG4sIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGwoaSkpIGkubGVuZ3RoID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcihpKSkgcmV0dXJuIGMuc2V0KHQsIG4sIG51bGwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobyBpbiBpKSBhKGksIG8pICYmIGRlbGV0ZSBpW29dDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCBjLnB1c2ggPSBmdW5jdGlvbih0LCBlKSB7DQogICAgICAgICAgICAgICAgdmFyIG4gPSBjLmdldCh0LCBlKTsNCiAgICAgICAgICAgICAgICBsKG4pIHx8IChuID0gW10sIGMuc2V0KHQsIGUsIG4pKSwgbi5wdXNoLmFwcGx5KG4sIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMikpDQogICAgICAgICAgICB9LCBjLmNvYWxlc2NlID0gZnVuY3Rpb24odCwgZSwgbikgew0KICAgICAgICAgICAgICAgIGZvciAodmFyIHIsIHMgPSAwLCBpID0gZS5sZW5ndGg7IHMgPCBpOyBzKyspDQogICAgICAgICAgICAgICAgICAgIGlmICh2b2lkIDAgIT09IChyID0gYy5nZXQodCwgZVtzXSkpKSByZXR1cm4gcjsNCiAgICAgICAgICAgICAgICByZXR1cm4gbg0KICAgICAgICAgICAgfSwgYy5nZXQgPSBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgICAgICAgICAgICAgaWYgKCJudW1iZXIiID09IHR5cGVvZiBlICYmIChlID0gW2VdKSwgIWUgfHwgMCA9PT0gZS5sZW5ndGgpIHJldHVybiB0Ow0KICAgICAgICAgICAgICAgIGlmIChudWxsID09IHQpIHJldHVybiBuOw0KICAgICAgICAgICAgICAgIGlmICgic3RyaW5nIiA9PSB0eXBlb2YgZSkgcmV0dXJuIGMuZ2V0KHQsIGUuc3BsaXQoIi4iKSwgbik7DQogICAgICAgICAgICAgICAgdmFyIHIgPSBpKGVbMF0pLA0KICAgICAgICAgICAgICAgICAgICBzID0gbyh0LCByKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gdm9pZCAwID09PSBzID8gbiA6IDEgPT09IGUubGVuZ3RoID8gcyA6IGMuZ2V0KHRbcl0sIGUuc2xpY2UoMSksIG4pDQogICAgICAgICAgICB9LCBjLmRlbCA9IGZ1bmN0aW9uKHQsIG4pIHsNCiAgICAgICAgICAgICAgICBpZiAoIm51bWJlciIgPT0gdHlwZW9mIG4gJiYgKG4gPSBbbl0pLCBudWxsID09IHQpIHJldHVybiB0Ow0KICAgICAgICAgICAgICAgIGlmIChlKG4pKSByZXR1cm4gdDsNCiAgICAgICAgICAgICAgICBpZiAoInN0cmluZyIgPT0gdHlwZW9mIG4pIHJldHVybiBjLmRlbCh0LCBuLnNwbGl0KCIuIikpOw0KICAgICAgICAgICAgICAgIHZhciByID0gaShuWzBdKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gYSh0LCByKSA/IDEgIT09IG4ubGVuZ3RoID8gYy5kZWwodFtyXSwgbi5zbGljZSgxKSkgOiAobCh0KSA/IHQuc3BsaWNlKHIsIDEpIDogZGVsZXRlIHRbcl0sIHQpIDogdA0KICAgICAgICAgICAgfSwgYw0KICAgICAgICB9DQogICAgICAgIHZhciBvID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZywNCiAgICAgICAgICAgIGwgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gIltvYmplY3QgQXJyYXldIiA9PT0gby5jYWxsKHQpDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgdSA9IGEoKTsNCiAgICAgICAgcmV0dXJuIHUuY3JlYXRlID0gYSwgdS53aXRoSW5oZXJpdGVkUHJvcHMgPSBhKHsNCiAgICAgICAgICAgIGluY2x1ZGVJbmhlcml0ZWRQcm9wczogITANCiAgICAgICAgfSksIHUNCiAgICB9KQ0KfSwgLCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgInVzZSBzdHJpY3QiOw0KDQogICAgZnVuY3Rpb24gcih0LCBlKSB7DQogICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiBlKSkgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIikNCiAgICB9DQogICAgdmFyIHMgPSBuKDExKSwNCiAgICAgICAgaSA9IG4ubihzKSwNCiAgICAgICAgYSA9IG4oMTIpLA0KICAgICAgICBvID0gbi5uKGEpLA0KICAgICAgICBsID0gbigxMyksDQogICAgICAgIHUgPSBuLm4obCksDQogICAgICAgIGMgPSBuKDEwKSwNCiAgICAgICAgZiA9IG4oNCksDQogICAgICAgIHAgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIGZ1bmN0aW9uIHQodCwgZSkgew0KICAgICAgICAgICAgICAgIGZvciAodmFyIG4gPSAwOyBuIDwgZS5sZW5ndGg7IG4rKykgew0KICAgICAgICAgICAgICAgICAgICB2YXIgciA9IGVbbl07DQogICAgICAgICAgICAgICAgICAgIHIuZW51bWVyYWJsZSA9IHIuZW51bWVyYWJsZSB8fCAhMSwgci5jb25maWd1cmFibGUgPSAhMCwgInZhbHVlIiBpbiByICYmIChyLndyaXRhYmxlID0gITApLCBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgci5rZXksIHIpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUsIG4sIHIpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbiAmJiB0KGUucHJvdG90eXBlLCBuKSwgciAmJiB0KGUsIHIpLCBlDQogICAgICAgICAgICB9DQogICAgICAgIH0oKSwNCiAgICAgICAgaCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgZnVuY3Rpb24gdCgpIHsNCiAgICAgICAgICAgICAgICByKHRoaXMsIHQpLCB0aGlzLnRhYmxlX3R5cGVzID0gW10sIHRoaXMudXNlX2RlZmF1bHRfdHlwZSA9ICEwLCB0aGlzLmRlZmF1bHRfdGFibGVfc2V0dGluZ3MgPSBuZXcgZi5hDQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gcCh0LCBbew0KICAgICAgICAgICAgICAgIGtleTogInVzZURlZmF1bHRUeXBlIiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy51c2VfZGVmYXVsdF90eXBlID0gISF0LCB0aGlzDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgIGtleTogInJlZ2lzdGVyVGFibGVUeXBlIiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCwgZSkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IG5ldyBjLmEodCk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRhYmxlX3R5cGVzLnB1c2gobiksIGUgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgZSAmJiBlKG4pLCB0aGlzDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgIGtleTogImluc3RhbGwiLA0KICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgICAgIHQuJGRhdGF0YWJsZXMgPSB7fSwgdC5jb21wb25lbnQoImRhdGF0YWJsZS1jZWxsIiwgaS5hKSwgdC5jb21wb25lbnQoImRhdGF0YWJsZS1oZWFkZXIiLCBvLmEpLCB0LmNvbXBvbmVudCgiZGF0YXRhYmxlLWJ1dHRvbiIsIHUuYSksIHRoaXMudXNlX2RlZmF1bHRfdHlwZSAmJiB0aGlzLnJlZ2lzdGVyVGFibGVUeXBlKCJkYXRhdGFibGUiLCBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0Lm1lcmdlU2V0dGluZ3ModGhpcy5kZWZhdWx0X3RhYmxlX3NldHRpbmdzLnByb3BlcnRpZXMpDQogICAgICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7DQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGUgaW4gdGhpcy50YWJsZV90eXBlcykgdGhpcy5pbnN0YWxsVGFibGVUeXBlKHRoaXMudGFibGVfdHlwZXNbZV0uZ2V0SWQoKSwgdGhpcy50YWJsZV90eXBlc1tlXSwgdCkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAga2V5OiAiaW5zdGFsbFRhYmxlVHlwZSIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQsIGUsIG4pIHsNCiAgICAgICAgICAgICAgICAgICAgbi5jb21wb25lbnQodCwgZS5nZXRUYWJsZURlZmluaXRpb24oKSksIG4uY29tcG9uZW50KHQgKyAiLXBhZ2VyIiwgZS5nZXRQYWdlckRlZmluaXRpb24oKSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9XSksIHQNCiAgICAgICAgfSgpOw0KICAgIGUuYSA9IGgNCn0sIGZ1bmN0aW9uKHQsIGUsIG4pIHsNCiAgICAidXNlIHN0cmljdCI7DQoNCiAgICBmdW5jdGlvbiByKHQsIGUpIHsNCiAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIGUpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKQ0KICAgIH0NCiAgICB2YXIgcyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgZnVuY3Rpb24gdCh0LCBlKSB7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBlLmxlbmd0aDsgbisrKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciByID0gZVtuXTsNCiAgICAgICAgICAgICAgICAgICAgci5lbnVtZXJhYmxlID0gci5lbnVtZXJhYmxlIHx8ICExLCByLmNvbmZpZ3VyYWJsZSA9ICEwLCAidmFsdWUiIGluIHIgJiYgKHIud3JpdGFibGUgPSAhMCksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCByLmtleSwgcikNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSwgbiwgcikgew0KICAgICAgICAgICAgICAgIHJldHVybiBuICYmIHQoZS5wcm90b3R5cGUsIG4pLCByICYmIHQoZSwgciksIGUNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSgpLA0KICAgICAgICBpID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBmdW5jdGlvbiB0KCkgew0KICAgICAgICAgICAgICAgIHIodGhpcywgdCksIHRoaXMuZmlsdGVySGFuZGxlciA9IHRoaXMuaGFuZGxlRmlsdGVyLCB0aGlzLnNvcnRIYW5kbGVyID0gdGhpcy5oYW5kbGVTb3J0LCB0aGlzLnBhZ2luYXRlSGFuZGxlciA9IHRoaXMuaGFuZGxlUGFnaW5hdGUsIHRoaXMuZGlzcGxheUhhbmRsZXIgPSB0aGlzLmhhbmRsZURpc3BsYXkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBzKHQsIFt7DQogICAgICAgICAgICAgICAga2V5OiAiaGFuZGxlRmlsdGVyIiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCwgZSwgbikgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIWUpIHJldHVybiB0Ow0KICAgICAgICAgICAgICAgICAgICB2YXIgciA9IGUuc3BsaXQoL1xzLyk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmZpbHRlcihmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBlIGluIHIpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnJvd01hdGNoZXModCwgcltlXSwgbikpIHJldHVybiAhMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhMA0KICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgIGtleTogInJvd01hdGNoZXMiLA0KICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHIgaW4gbikNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuW3JdLm1hdGNoZXModCwgZSkpIHJldHVybiAhMDsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICExDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgIGtleTogImhhbmRsZVNvcnQiLA0KICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBlICYmIG51bGwgIT09IG4gPyB0LnNvcnQoZnVuY3Rpb24odCwgcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHMgPSBlLmdldFJlcHJlc2VudGF0aW9uKHQpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBlLmdldFJlcHJlc2VudGF0aW9uKHIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHMgPT0gaSkgcmV0dXJuIDA7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IHMgPiBpID8gMSA6IC0xOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJkZXNjIiA9PT0gbiAmJiAoYSAqPSAtMSksIGENCiAgICAgICAgICAgICAgICAgICAgfSkgOiB0DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgIGtleTogImhhbmRsZVBhZ2luYXRlIiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCwgZSwgbikgew0KICAgICAgICAgICAgICAgICAgICBpZiAoIWUpIHJldHVybiB0Ow0KICAgICAgICAgICAgICAgICAgICBuIDwgMSAmJiAobiA9IDEpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgciA9IChuIC0gMSkgKiBlLA0KICAgICAgICAgICAgICAgICAgICAgICAgcyA9IG4gKiBlOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5zbGljZShyLCBzKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBrZXk6ICJoYW5kbGVEaXNwbGF5IiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCwgZSwgbiwgcikgew0KICAgICAgICAgICAgICAgICAgICBuKHQpLCByKGUuZmlsdGVyZWRfZGF0YS5sZW5ndGgpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfV0pLCB0DQogICAgICAgIH0oKTsNCiAgICBlLmEgPSBpDQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgInVzZSBzdHJpY3QiOw0KDQogICAgZnVuY3Rpb24gcih0LCBlKSB7DQogICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiBlKSkgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIikNCiAgICB9DQogICAgdmFyIHMgPSBuKDE0KSwNCiAgICAgICAgaSA9IG4ubihzKSwNCiAgICAgICAgYSA9IG4oMjYpLA0KICAgICAgICBvID0gbi5uKGEpLA0KICAgICAgICBsID0gbig5KSwNCiAgICAgICAgdSA9IG4oNCksDQogICAgICAgIGMgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA/IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgdA0KICAgICAgICB9IDogZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgcmV0dXJuIHQgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIHQuY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiB0ICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiB0eXBlb2YgdA0KICAgICAgICB9LA0KICAgICAgICBmID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBmdW5jdGlvbiB0KHQsIGUpIHsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBuID0gMDsgbiA8IGUubGVuZ3RoOyBuKyspIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBlW25dOw0KICAgICAgICAgICAgICAgICAgICByLmVudW1lcmFibGUgPSByLmVudW1lcmFibGUgfHwgITEsIHIuY29uZmlndXJhYmxlID0gITAsICJ2YWx1ZSIgaW4gciAmJiAoci53cml0YWJsZSA9ICEwKSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIHIua2V5LCByKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihlLCBuLCByKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIG4gJiYgdChlLnByb3RvdHlwZSwgbiksIHIgJiYgdChlLCByKSwgZQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9KCksDQogICAgICAgIHAgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIGZ1bmN0aW9uIHQoZSkgew0KICAgICAgICAgICAgICAgIHIodGhpcywgdCksIHRoaXMuaWQgPSBlLCB0aGlzLmhhbmRsZXIgPSBuZXcgbC5hLCB0aGlzLnNldHRpbmdzID0gbmV3IHUuYQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGYodCwgW3sNCiAgICAgICAgICAgICAgICBrZXk6ICJnZXRJZCIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pZA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBrZXk6ICJzZXRGaWx0ZXJIYW5kbGVyIiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVyLmZpbHRlckhhbmRsZXIgPSB0LCB0aGlzDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgIGtleTogInNldFNvcnRIYW5kbGVyIiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVyLnNvcnRIYW5kbGVyID0gdCwgdGhpcw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBrZXk6ICJzZXRQYWdpbmF0ZUhhbmRsZXIiLA0KICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmhhbmRsZXIucGFnaW5hdGVIYW5kbGVyID0gdCwgdGhpcw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBrZXk6ICJzZXREaXNwbGF5SGFuZGxlciIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlci5kaXNwbGF5SGFuZGxlciA9IHQsIHRoaXMNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAga2V5OiAic2V0dGluZyIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQsIGUpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZvaWQgMCA9PT0gZSA/IHRoaXMuc2V0dGluZ3MuZ2V0KHQpIDogKHRoaXMuc2V0dGluZ3Muc2V0KHQsIGUpLCB0aGlzKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBrZXk6ICJtZXJnZVNldHRpbmdzIiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5tZXJnZSh0KSwgdGhpcw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBrZXk6ICJnZXRUYWJsZURlZmluaXRpb24iLA0KICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSB0aGlzLmNsb25lKGkuYSk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmhhbmRsZXIgPSB0aGlzLmhhbmRsZXIsIHQuc2V0dGluZ3MgPSB0aGlzLnNldHRpbmdzLCB0Lm5hbWUgPSB0aGlzLmlkLCB0DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgIGtleTogImdldFBhZ2VyRGVmaW5pdGlvbiIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgdCA9IHRoaXMuY2xvbmUoby5hKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuc2V0dGluZ3MgPSB0aGlzLnNldHRpbmdzLCB0Lm5hbWUgPSB0aGlzLmlkLCB0DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgIGtleTogImNsb25lIiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgZTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgPT09IHQgfHwgIm9iamVjdCIgIT09ICh2b2lkIDAgPT09IHQgPyAidW5kZWZpbmVkIiA6IGModCkpKSByZXR1cm4gdDsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBBcnJheSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZSA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCB0Lmxlbmd0aDsgbisrKSBlW25dID0gdGhpcy5jbG9uZSh0W25dKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBPYmplY3QpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGUgPSB7fTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHIgaW4gdCkgdC5oYXNPd25Qcm9wZXJ0eShyKSAmJiAoZVtyXSA9IHRoaXMuY2xvbmUodFtyXSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlVuYWJsZSB0byBjb3B5IG9iaiEgSXRzIHR5cGUgaXNuJ3Qgc3VwcG9ydGVkLiIpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfV0pLCB0DQogICAgICAgIH0oKTsNCiAgICBlLmEgPSBwDQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgbigzNik7DQogICAgdmFyIHIgPSBuKDIpKG4oMTYpLCBuKDMxKSwgbnVsbCwgbnVsbCk7DQogICAgdC5leHBvcnRzID0gci5leHBvcnRzDQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgbigzNCk7DQogICAgdmFyIHIgPSBuKDIpKG4oMTcpLCBuKDI5KSwgbnVsbCwgbnVsbCk7DQogICAgdC5leHBvcnRzID0gci5leHBvcnRzDQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgbigzNSk7DQogICAgdmFyIHIgPSBuKDIpKG4oMTgpLCBuKDMwKSwgbnVsbCwgbnVsbCk7DQogICAgdC5leHBvcnRzID0gci5leHBvcnRzDQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgbigzMyk7DQogICAgdmFyIHIgPSBuKDIpKG4oMjApLCBuKDI4KSwgbnVsbCwgbnVsbCk7DQogICAgdC5leHBvcnRzID0gci5leHBvcnRzDQp9LCAsIGZ1bmN0aW9uKHQsIGUsIG4pIHsNCiAgICAidXNlIHN0cmljdCI7DQogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsICJfX2VzTW9kdWxlIiwgew0KICAgICAgICB2YWx1ZTogITANCiAgICB9KSwgZS5kZWZhdWx0ID0gew0KICAgICAgICBwcm9wczogew0KICAgICAgICAgICAgY29sdW1uOiBbT2JqZWN0LCBBcnJheV0sDQogICAgICAgICAgICByb3c6IFtPYmplY3QsIEFycmF5XQ0KICAgICAgICB9LA0KICAgICAgICBjb21wdXRlZDogew0KICAgICAgICAgICAgY29udGVudDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29sdW1uLmdldFJlcHJlc2VudGF0aW9uKHRoaXMucm93KQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgICJ1c2Ugc3RyaWN0IjsNCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgIl9fZXNNb2R1bGUiLCB7DQogICAgICAgIHZhbHVlOiAhMA0KICAgIH0pLCBlLmRlZmF1bHQgPSB7DQogICAgICAgIHByb3BzOiB7DQogICAgICAgICAgICBtb2RlbDogew0KICAgICAgICAgICAgICAgIHByb3A6ICJkaXJlY3Rpb24iLA0KICAgICAgICAgICAgICAgIGV2ZW50OiAiY2hhbmdlIg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGNvbHVtbjogW09iamVjdCwgQXJyYXldLA0KICAgICAgICAgICAgc2V0dGluZ3M6IE9iamVjdCwNCiAgICAgICAgICAgIGRpcmVjdGlvbjogew0KICAgICAgICAgICAgICAgIHR5cGU6IFN0cmluZywNCiAgICAgICAgICAgICAgICBkZWZhdWx0OiAiYXNjIg0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBjb21wdXRlZDogew0KICAgICAgICAgICAgY2FuU29ydDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29sdW1uLnNvcnRhYmxlDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgaXNfc29ydGVkX2FzY2VuZGluZzogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICJhc2MiID09PSB0aGlzLmRpcmVjdGlvbg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGlzX3NvcnRlZF9kZXNjZW5kaW5nOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gImRlc2MiID09PSB0aGlzLmRpcmVjdGlvbg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGlzX3NvcnRlZDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXNfc29ydGVkX2Rlc2NlbmRpbmcgfHwgdGhpcy5pc19zb3J0ZWRfYXNjZW5kaW5nDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgY2xhc3NlczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdmFyIHQgPSB0aGlzLnNldHRpbmdzLmdldCgidGFibGUuc29ydGluZy5jbGFzc2VzIiksDQogICAgICAgICAgICAgICAgICAgIGUgPSB0LmNhblNvcnQ7DQogICAgICAgICAgICAgICAgLy9yZXR1cm4gdGhpcy5jYW5Tb3J0ID8gdGhpcy5pc19zb3J0ZWRfZGVzY2VuZGluZyA/IChlID0gZS5jb25jYXQodC5zb3J0RGVzYyksIHRoaXMuam9pbkNsYXNzZXMoZSkpIDogKGUgPSBlLmNvbmNhdCh0LnNvcnRBc2MpLCB0aGlzLmpvaW5DbGFzc2VzKGUpKSA6ICIiDQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FuU29ydCA/IHRoaXMuaXNfc29ydGVkID8gKHRoaXMuaXNfc29ydGVkX2FzY2VuZGluZyAmJiAoZSA9IGUuY29uY2F0KHQuc29ydEFzYykpLCB0aGlzLmlzX3NvcnRlZF9kZXNjZW5kaW5nICYmIChlID0gZS5jb25jYXQodC5zb3J0RGVzYykpLCB0aGlzLmpvaW5DbGFzc2VzKGUpKSA6IChlID0gZS5jb25jYXQodC5zb3J0Tm9uZSksIHRoaXMuam9pbkNsYXNzZXMoZSkpIDogIiINCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgbWV0aG9kczogew0KICAgICAgICAgICAgam9pbkNsYXNzZXM6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy51bmlxdWUodCkuam9pbigiICIpDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgdG9nZ2xlU29ydDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgLy90aGlzLmRpcmVjdGlvbiAmJiBudWxsICE9PSB0aGlzLmRpcmVjdGlvbiAmJiAiYXNjIiA9PT0gdGhpcy5kaXJlY3Rpb24gPyB0aGlzLiRlbWl0KCJjaGFuZ2UiLCAiZGVzYyIsIHRoaXMuY29sdW1uKSA6IHRoaXMuJGVtaXQoImNoYW5nZSIsICJkZXNjIiwgdGhpcy5jb2x1bW4pDQogICAgICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb24gJiYgbnVsbCAhPT0gdGhpcy5kaXJlY3Rpb24gPyAiYXNjIiA9PT0gdGhpcy5kaXJlY3Rpb24gPyB0aGlzLiRlbWl0KCJjaGFuZ2UiLCAiZGVzYyIsIHRoaXMuY29sdW1uKSA6IHRoaXMuJGVtaXQoImNoYW5nZSIsIG51bGwsIHRoaXMuY29sdW1uKSA6IHRoaXMuJGVtaXQoImNoYW5nZSIsICJhc2MiLCB0aGlzLmNvbHVtbikNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB1bmlxdWU6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICB2YXIgZSA9IHt9Ow0KICAgICAgICAgICAgICAgIHJldHVybiB0LmZpbHRlcihmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAhZS5oYXNPd25Qcm9wZXJ0eSh0KSAmJiAoZVt0XSA9ICEwKQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgInVzZSBzdHJpY3QiOw0KICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCAiX19lc01vZHVsZSIsIHsNCiAgICAgICAgdmFsdWU6ICEwDQogICAgfSk7DQogICAgbig0KTsNCiAgICBlLmRlZmF1bHQgPSB7DQogICAgICAgIHByb3BzOiB7DQogICAgICAgICAgICBkaXNhYmxlZDogew0KICAgICAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sDQogICAgICAgICAgICAgICAgZGVmYXVsdDogITENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBzZWxlY3RlZDogew0KICAgICAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sDQogICAgICAgICAgICAgICAgZGVmYXVsdDogITENCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB2YWx1ZTogew0KICAgICAgICAgICAgICAgIHR5cGU6IE51bWJlciwNCiAgICAgICAgICAgICAgICBkZWZhdWx0OiBudWxsDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGNvbXB1dGVkOiB7DQogICAgICAgICAgICBsaV9jbGFzc2VzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB2YXIgdCA9IFtdOw0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLmdldCgicGFnZXIuY2xhc3Nlcy5saSIpICYmIHQucHVzaCh0aGlzLnNldHRpbmdzLmdldCgicGFnZXIuY2xhc3Nlcy5saSIpKSwgdGhpcy5kaXNhYmxlZCAmJiB0LnB1c2godGhpcy5zZXR0aW5ncy5nZXQoInBhZ2VyLmNsYXNzZXMuZGlzYWJsZWQiKSksIHRoaXMuc2VsZWN0ZWQgJiYgdC5wdXNoKHRoaXMuc2V0dGluZ3MuZ2V0KCJwYWdlci5jbGFzc2VzLnNlbGVjdGVkIikpLCB0LmpvaW4oIiAiKQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGFfY2xhc3NlczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdmFyIHQgPSBbXTsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5nZXQoInBhZ2VyLmNsYXNzZXMuYSIpICYmIHQucHVzaCh0aGlzLnNldHRpbmdzLmdldCgicGFnZXIuY2xhc3Nlcy5hIikpLCB0LmpvaW4oIiAiKQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHNldHRpbmdzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kcGFyZW50LnNldHRpbmdzDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIG1ldGhvZHM6IHsNCiAgICAgICAgICAgIHNlbmRDbGljazogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlZCB8fCB0aGlzLiRlbWl0KCJjbGljayIsIHRoaXMudmFsdWUpDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgInVzZSBzdHJpY3QiOw0KICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCAiX19lc01vZHVsZSIsIHsNCiAgICAgICAgdmFsdWU6ICEwDQogICAgfSksIGUuZGVmYXVsdCA9IHsNCiAgICAgICAgbW9kZWw6IHsNCiAgICAgICAgICAgIHByb3A6ICJwYWdlIiwNCiAgICAgICAgICAgIGV2ZW50OiAiY2hhbmdlIg0KICAgICAgICB9LA0KICAgICAgICBwcm9wczogew0KICAgICAgICAgICAgdGFibGU6IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBTdHJpbmcsDQogICAgICAgICAgICAgICAgZGVmYXVsdDogImRlZmF1bHQiDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgdHlwZTogew0KICAgICAgICAgICAgICAgIHR5cGU6IFN0cmluZywNCiAgICAgICAgICAgICAgICBkZWZhdWx0OiAibG9uZyINCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBwZXJQYWdlOiB7DQogICAgICAgICAgICAgICAgdHlwZTogTnVtYmVyLA0KICAgICAgICAgICAgICAgIGRlZmF1bHQ6IDEwDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgcGFnZTogew0KICAgICAgICAgICAgICAgIHR5cGU6IE51bWJlciwNCiAgICAgICAgICAgICAgICBkZWZhdWx0OiAxDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGRhdGE6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICB0YWJsZV9pbnN0YW5jZTogbnVsbA0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBjb21wdXRlZDogew0KICAgICAgICAgICAgc2hvdzogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGFibGVfaW5zdGFuY2UgJiYgdGhpcy50b3RhbF9yb3dzID4gMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHRvdGFsX3Jvd3M6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRhYmxlX2luc3RhbmNlID8gdGhpcy50YWJsZV9pbnN0YW5jZS50b3RhbF9yb3dzIDogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHBhZ2luYXRpb25fY2xhc3M6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLmdldCgicGFnZXIuY2xhc3Nlcy5wYWdlciIpDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgZGlzYWJsZWRfY2xhc3M6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLmdldCgicGFnZXIuY2xhc3Nlcy5kaXNhYmxlZCIpDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgcHJldmlvdXNfbGlua19jbGFzc2VzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYWdlIC0gMSA8IDEgPyB0aGlzLnNldHRpbmdzLmdldCgicGFnZXIuY2xhc3Nlcy5kaXNhYmxlZCIpIDogIiINCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBuZXh0X2xpbmtfY2xhc3NlczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFnZSArIDEgPiB0aGlzLnRvdGFsX3BhZ2VzID8gdGhpcy5zZXR0aW5ncy5nZXQoInBhZ2VyLmNsYXNzZXMuZGlzYWJsZWQiKSA6ICIiDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgdG90YWxfcGFnZXM6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRvdGFsX3Jvd3MgPiAwID8gTWF0aC5jZWlsKHRoaXMudG90YWxfcm93cyAvIHRoaXMucGVyUGFnZSkgOiAxDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgcHJldmlvdXNfaWNvbjogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3MuZ2V0KCJwYWdlci5pY29ucy5wcmV2aW91cyIpDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgbmV4dF9pY29uOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5nZXQoInBhZ2VyLmljb25zLm5leHQiKQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHNldHRpbmdzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kb3B0aW9ucy5zZXR0aW5ncw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBtZXRob2RzOiB7DQogICAgICAgICAgICBzZXRQYWdlTnVtOiBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgdGhpcy50YWJsZV9pbnN0YW5jZS5wYWdlID0gdCwgdGhpcy50YWJsZV9pbnN0YW5jZS5wZXJfcGFnZSA9IHRoaXMucGVyUGFnZSwgdGhpcy4kZW1pdCgiY2hhbmdlIiwgdCkNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBnZXRDbGFzc0ZvclBhZ2U6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYWdlID09IHQgPyB0aGlzLnNldHRpbmdzLmdldCgicGFnZXIuY2xhc3Nlcy5zZWxlY3RlZCIpIDogIiINCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgd2F0Y2g6IHsNCiAgICAgICAgICAgIHRvdGFsX3Jvd3M6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHRoaXMucGFnZSA+IHRoaXMudG90YWxfcGFnZXMgJiYgdGhpcy5zZXRQYWdlTnVtKHRoaXMudG90YWxfcGFnZXMpDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgcGVyUGFnZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdmFyIHQgPSB0aGlzLnBhZ2U7DQogICAgICAgICAgICAgICAgdCA+IHRoaXMudG90YWxfcGFnZXMgJiYgKHQgPSB0aGlzLnRvdGFsX3BhZ2VzKSwgdGhpcy5zZXRQYWdlTnVtKHQpDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGNyZWF0ZWQ6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgaWYgKFZ1ZS4kZGF0YXRhYmxlc1t0aGlzLnRhYmxlXSkgcmV0dXJuIHRoaXMudGFibGVfaW5zdGFuY2UgPSBWdWUuJGRhdGF0YWJsZXNbdGhpcy50YWJsZV0sIHZvaWQodGhpcy50YWJsZV9pbnN0YW5jZS5wZXJfcGFnZSA9IHRoaXMucGVyUGFnZSk7DQogICAgICAgICAgICB0aGlzLiRyb290LiRvbigidGFibGUucmVhZHkiLCBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgdCA9PT0gdGhpcy50YWJsZSAmJiAodGhpcy50YWJsZV9pbnN0YW5jZSA9IFZ1ZS4kZGF0YXRhYmxlc1t0aGlzLnRhYmxlXSwgdGhpcy50YWJsZV9pbnN0YW5jZS5wZXJfcGFnZSA9IHRoaXMucGVyUGFnZSkNCiAgICAgICAgICAgIH0uYmluZCh0aGlzKSkNCiAgICAgICAgfSwNCiAgICAgICAgc2V0dGluZ3M6IG51bGwNCiAgICB9DQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgInVzZSBzdHJpY3QiOw0KICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCAiX19lc01vZHVsZSIsIHsNCiAgICAgICAgdmFsdWU6ICEwDQogICAgfSk7DQogICAgdmFyIHIgPSBuKDUpOw0KICAgIGUuZGVmYXVsdCA9IHsNCiAgICAgICAgcHJvcHM6IHsNCiAgICAgICAgICAgIG5hbWU6IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBTdHJpbmcsDQogICAgICAgICAgICAgICAgZGVmYXVsdDogImRlZmF1bHQiDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgY29sdW1uczogW09iamVjdCwgQXJyYXldLA0KICAgICAgICAgICAgZGF0YTogW09iamVjdCwgQXJyYXksIFN0cmluZywgRnVuY3Rpb25dLA0KICAgICAgICAgICAgZmlsdGVyQnk6IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBTdHJpbmcsDQogICAgICAgICAgICAgICAgZGVmYXVsdDogbnVsbA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHJvd0NsYXNzZXM6IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBbU3RyaW5nLCBBcnJheSwgT2JqZWN0LCBGdW5jdGlvbl0sDQogICAgICAgICAgICAgICAgZGVmYXVsdDogbnVsbA0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBkYXRhOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgc29ydF9ieTogbnVsbCwNCiAgICAgICAgICAgICAgICBzb3J0X2RpcjogbnVsbCwNCiAgICAgICAgICAgICAgICB0b3RhbF9yb3dzOiAwLA0KICAgICAgICAgICAgICAgIHBhZ2U6IDEsDQogICAgICAgICAgICAgICAgcGVyX3BhZ2U6IG51bGwsDQogICAgICAgICAgICAgICAgcHJvY2Vzc2VkX3Jvd3M6IFtdDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGNvbXB1dGVkOiB7DQogICAgICAgICAgICByb3dzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kYXRhLnNsaWNlKDApDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgc2V0dGluZ3M6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRvcHRpb25zLnNldHRpbmdzDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgaGFuZGxlcjogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJG9wdGlvbnMuaGFuZGxlcg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIG5vcm1hbGl6ZWRfY29sdW1uczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29sdW1ucy5tYXAoZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHIuYSh0KQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgdGFibGVfY2xhc3M6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLmdldCgidGFibGUuY2xhc3MiKQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBtZXRob2RzOiB7DQogICAgICAgICAgICBnZXRTb3J0RGlyZWN0aW9uRm9yQ29sdW1uOiBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc29ydF9ieSAhPT0gdCA/IG51bGwgOiB0aGlzLnNvcnRfZGlyDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgc2V0U29ydERpcmVjdGlvbkZvckNvbHVtbjogZnVuY3Rpb24odCwgZSkgew0KICAgICAgICAgICAgICAgIHRoaXMuc29ydF9ieSA9IGUsIHRoaXMuc29ydF9kaXIgPSB0DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgcHJvY2Vzc1Jvd3M6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIGlmICgiZnVuY3Rpb24iICE9IHR5cGVvZiB0aGlzLmRhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSB0aGlzLmhhbmRsZXIuZmlsdGVySGFuZGxlcih0aGlzLnJvd3MsIHRoaXMuZmlsdGVyQnksIHRoaXMubm9ybWFsaXplZF9jb2x1bW5zKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGUgPSB0aGlzLmhhbmRsZXIuc29ydEhhbmRsZXIodCwgdGhpcy5zb3J0X2J5LCB0aGlzLnNvcnRfZGlyKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIG4gPSB0aGlzLmhhbmRsZXIucGFnaW5hdGVIYW5kbGVyKGUsIHRoaXMucGVyX3BhZ2UsIHRoaXMucGFnZSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlci5kaXNwbGF5SGFuZGxlcihuLCB7DQogICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZF9kYXRhOiB0LA0KICAgICAgICAgICAgICAgICAgICAgICAgc29ydGVkX2RhdGE6IGUsDQogICAgICAgICAgICAgICAgICAgICAgICBwYWdlZF9kYXRhOiBuDQogICAgICAgICAgICAgICAgICAgIH0sIHRoaXMuc2V0Um93cywgdGhpcy5zZXRUb3RhbFJvd0NvdW50KQ0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHZhciByID0gew0KICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyOiB0aGlzLmZpbHRlckJ5LA0KICAgICAgICAgICAgICAgICAgICAgICAgc29ydF9ieTogdGhpcy5zb3J0X2J5ID8gdGhpcy5zb3J0X2J5LmZpZWxkIDogbnVsbCwNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRfZGlyOiB0aGlzLnNvcnRfZGlyLA0KICAgICAgICAgICAgICAgICAgICAgICAgcGFnZV9sZW5ndGg6IHRoaXMucGVyX3BhZ2UsDQogICAgICAgICAgICAgICAgICAgICAgICBwYWdlX251bWJlcjogdGhpcy5wYWdlDQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YShyLCBmdW5jdGlvbih0LCBlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFJvd3ModCksIHRoaXMuc2V0VG90YWxSb3dDb3VudChlKQ0KICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHNldFJvd3M6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NlZF9yb3dzID0gdA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHNldFRvdGFsUm93Q291bnQ6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICB0aGlzLnRvdGFsX3Jvd3MgPSB0DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgZ2V0Um93Q2xhc3NlczogZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgIHZhciBlID0gdGhpcy5yb3dDbGFzc2VzOw0KICAgICAgICAgICAgICAgIHJldHVybiBudWxsID09PSBlICYmIChlID0gdGhpcy5zZXR0aW5ncy5nZXQoInRhYmxlLnJvdy5jbGFzc2VzIikpLCAiZnVuY3Rpb24iID09IHR5cGVvZiBlID8gZSh0KSA6IGUNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgY3JlYXRlZDogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBWdWUuJGRhdGF0YWJsZXNbdGhpcy5uYW1lXSA9IHRoaXMsIHRoaXMuJHJvb3QuJGVtaXQoInRhYmxlLnJlYWR5IiwgdGhpcy5uYW1lKSwgdGhpcy4kd2F0Y2goZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0YQ0KICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCB0aGlzLnByb2Nlc3NSb3dzLCB7DQogICAgICAgICAgICAgICAgZGVlcDogITANCiAgICAgICAgICAgIH0pLCB0aGlzLiR3YXRjaCgiY29sdW1ucyIsIHRoaXMucHJvY2Vzc1Jvd3MpLCB0aGlzLiR3YXRjaChmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5maWx0ZXJCeSArIHRoaXMucGVyX3BhZ2UgKyB0aGlzLnBhZ2UgKyB0aGlzLnNvcnRfYnkgKyB0aGlzLnNvcnRfZGlyDQogICAgICAgICAgICB9LmJpbmQodGhpcyksIHRoaXMucHJvY2Vzc1Jvd3MpLCB0aGlzLnByb2Nlc3NSb3dzKCkNCiAgICAgICAgfSwNCiAgICAgICAgaGFuZGxlcjogbnVsbCwNCiAgICAgICAgc2V0dGluZ3M6IG51bGwNCiAgICB9DQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgZSA9IHQuZXhwb3J0cyA9IG4oMSkoKSwgZS5wdXNoKFt0LmksICIiLCAiIl0pDQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgZSA9IHQuZXhwb3J0cyA9IG4oMSkoKSwgZS5wdXNoKFt0LmksICIiLCAiIl0pDQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgZSA9IHQuZXhwb3J0cyA9IG4oMSkoKSwgZS5wdXNoKFt0LmksICIiLCAiIl0pDQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgZSA9IHQuZXhwb3J0cyA9IG4oMSkoKSwgZS5wdXNoKFt0LmksICIiLCAiIl0pDQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgZSA9IHQuZXhwb3J0cyA9IG4oMSkoKSwgZS5wdXNoKFt0LmksICIiLCAiIl0pDQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgbigzMik7DQogICAgdmFyIHIgPSBuKDIpKG4oMTkpLCBuKDI3KSwgbnVsbCwgbnVsbCk7DQogICAgdC5leHBvcnRzID0gci5leHBvcnRzDQp9LCBmdW5jdGlvbih0LCBlKSB7DQogICAgdC5leHBvcnRzID0gew0KICAgICAgICByZW5kZXI6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIHQgPSB0aGlzLA0KICAgICAgICAgICAgICAgIGUgPSB0LiRjcmVhdGVFbGVtZW50LA0KICAgICAgICAgICAgICAgIG4gPSB0Ll9zZWxmLl9jIHx8IGU7DQogICAgICAgICAgICByZXR1cm4gdC5zaG93ID8gbigibmF2Iiwge2NsYXNzOiAidGV4dC1jZW50ZXIifSwgWyJhYmJyZXZpYXRlZCIgPT09IHQudHlwZSA/IG4oInVsIiwgew0KICAgICAgICAgICAgICAgIGNsYXNzOiB0LnBhZ2luYXRpb25fY2xhc3MNCiAgICAgICAgICAgIH0sIFt0LnBhZ2UgLSAzID49IDEgPyBuKCJkYXRhdGFibGUtYnV0dG9uIiwgew0KICAgICAgICAgICAgICAgIGF0dHJzOiB7DQogICAgICAgICAgICAgICAgICAgIHZhbHVlOiAxDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBvbjogew0KICAgICAgICAgICAgICAgICAgICBjbGljazogdC5zZXRQYWdlTnVtDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSkgOiB0Ll9lKCksIHQuX3YoIiAiKSwgdC5wYWdlIC0gNCA+PSAxID8gbigiZGF0YXRhYmxlLWJ1dHRvbiIsIHsNCiAgICAgICAgICAgICAgICBhdHRyczogew0KICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogIiINCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCBbdC5fdigiLi4uIildKSA6IHQuX2UoKSwgdC5fdigiICIpLCB0LnBhZ2UgLSAyID49IDEgPyBuKCJkYXRhdGFibGUtYnV0dG9uIiwgew0KICAgICAgICAgICAgICAgIGF0dHJzOiB7DQogICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0LnBhZ2UgLSAyDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBvbjogew0KICAgICAgICAgICAgICAgICAgICBjbGljazogdC5zZXRQYWdlTnVtDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSkgOiB0Ll9lKCksIHQuX3YoIiAiKSwgdC5wYWdlIC0gMSA+PSAxID8gbigiZGF0YXRhYmxlLWJ1dHRvbiIsIHsNCiAgICAgICAgICAgICAgICBhdHRyczogew0KICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdC5wYWdlIC0gMQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgb246IHsNCiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IHQuc2V0UGFnZU51bQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pIDogdC5fZSgpLCB0Ll92KCIgIiksIG4oImRhdGF0YWJsZS1idXR0b24iLCB7DQogICAgICAgICAgICAgICAgYXR0cnM6IHsNCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHQucGFnZSwNCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6ICIiDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSksIHQuX3YoIiAiKSwgdC5wYWdlICsgMSA8PSB0LnRvdGFsX3BhZ2VzID8gbigiZGF0YXRhYmxlLWJ1dHRvbiIsIHsNCiAgICAgICAgICAgICAgICBhdHRyczogew0KICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdC5wYWdlICsgMQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgb246IHsNCiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IHQuc2V0UGFnZU51bQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pIDogdC5fZSgpLCB0Ll92KCIgIiksIHQucGFnZSArIDIgPD0gdC50b3RhbF9wYWdlcyA/IG4oImRhdGF0YWJsZS1idXR0b24iLCB7DQogICAgICAgICAgICAgICAgYXR0cnM6IHsNCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHQucGFnZSArIDINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIG9uOiB7DQogICAgICAgICAgICAgICAgICAgIGNsaWNrOiB0LnNldFBhZ2VOdW0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KSA6IHQuX2UoKSwgdC5fdigiICIpLCB0LnBhZ2UgKyA0IDw9IHQudG90YWxfcGFnZXMgPyBuKCJkYXRhdGFibGUtYnV0dG9uIiwgew0KICAgICAgICAgICAgICAgIGF0dHJzOiB7DQogICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiAiIg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIFt0Ll92KCIuLi4iKV0pIDogdC5fZSgpLCB0Ll92KCIgIiksIHQucGFnZSArIDMgPD0gdC50b3RhbF9wYWdlcyA/IG4oImRhdGF0YWJsZS1idXR0b24iLCB7DQogICAgICAgICAgICAgICAgYXR0cnM6IHsNCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHQudG90YWxfcGFnZXMNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIG9uOiB7DQogICAgICAgICAgICAgICAgICAgIGNsaWNrOiB0LnNldFBhZ2VOdW0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KSA6IHQuX2UoKV0sIDEpIDogImxvbmciID09PSB0LnR5cGUgPyBuKCJ1bCIsIHsNCiAgICAgICAgICAgICAgICBjbGFzczogdC5wYWdpbmF0aW9uX2NsYXNzDQogICAgICAgICAgICB9LCB0Ll9sKHQudG90YWxfcGFnZXMsIGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbigiZGF0YXRhYmxlLWJ1dHRvbiIsIHsNCiAgICAgICAgICAgICAgICAgICAga2V5OiBlLA0KICAgICAgICAgICAgICAgICAgICBhdHRyczogew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGUsDQogICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogZSA9PT0gdC5wYWdlDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIG9uOiB7DQogICAgICAgICAgICAgICAgICAgICAgICBjbGljazogdC5zZXRQYWdlTnVtDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfSkpIDogInNob3J0IiA9PT0gdC50eXBlID8gbigidWwiLCB7DQogICAgICAgICAgICAgICAgY2xhc3M6IHQucGFnaW5hdGlvbl9jbGFzcw0KICAgICAgICAgICAgfSwgW24oImRhdGF0YWJsZS1idXR0b24iLCB7DQogICAgICAgICAgICAgICAgYXR0cnM6IHsNCiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6IHQucGFnZSAtIDEgPCAxLA0KICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdC5wYWdlIC0gMQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgb246IHsNCiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IHQuc2V0UGFnZU51bQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIFtuKCJzcGFuIiwgew0KICAgICAgICAgICAgICAgIGRvbVByb3BzOiB7DQogICAgICAgICAgICAgICAgICAgIGlubmVySFRNTDogdC5fcyh0LnByZXZpb3VzX2ljb24pDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSldKSwgdC5fdigiICIpLCBuKCJkYXRhdGFibGUtYnV0dG9uIiwgew0KICAgICAgICAgICAgICAgIGF0dHJzOiB7DQogICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0LnBhZ2UsDQogICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiAiIg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pLCB0Ll92KCIgIiksIG4oImRhdGF0YWJsZS1idXR0b24iLCB7DQogICAgICAgICAgICAgICAgYXR0cnM6IHsNCiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6IHQucGFnZSArIDEgPiB0LnRvdGFsX3BhZ2VzLA0KICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdC5wYWdlICsgMQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgb246IHsNCiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IHQuc2V0UGFnZU51bQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIFtuKCJzcGFuIiwgew0KICAgICAgICAgICAgICAgIGRvbVByb3BzOiB7DQogICAgICAgICAgICAgICAgICAgIGlubmVySFRNTDogdC5fcyh0Lm5leHRfaWNvbikNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KV0pXSwgMSkgOiB0Ll9lKCldKSA6IHQuX2UoKQ0KICAgICAgICB9LA0KICAgICAgICBzdGF0aWNSZW5kZXJGbnM6IFtdDQogICAgfQ0KfSwgZnVuY3Rpb24odCwgZSkgew0KICAgIHQuZXhwb3J0cyA9IHsNCiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciB0ID0gdGhpcywNCiAgICAgICAgICAgICAgICBlID0gdC4kY3JlYXRlRWxlbWVudCwNCiAgICAgICAgICAgICAgICBuID0gdC5fc2VsZi5fYyB8fCBlOw0KICAgICAgICAgICAgcmV0dXJuIG4oInRhYmxlIiwgew0KICAgICAgICAgICAgICAgIGNsYXNzOiB0LnRhYmxlX2NsYXNzDQogICAgICAgICAgICB9LCBbbigidGhlYWQiLCBbbigidHIiLCB0Ll9sKHQubm9ybWFsaXplZF9jb2x1bW5zLCBmdW5jdGlvbihlLCByKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIG4oImRhdGF0YWJsZS1oZWFkZXIiLCB7DQogICAgICAgICAgICAgICAgICAgIGtleTogciwNCiAgICAgICAgICAgICAgICAgICAgYXR0cnM6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbjogZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmdzOiB0LnNldHRpbmdzLA0KICAgICAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uOiB0LmdldFNvcnREaXJlY3Rpb25Gb3JDb2x1bW4oZSkNCiAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgb246IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZTogdC5zZXRTb3J0RGlyZWN0aW9uRm9yQ29sdW1uDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfSkpXSksIHQuX3YoIiAiKSwgbigidGJvZHkiLCBbdC5fbCh0LnByb2Nlc3NlZF9yb3dzLCBmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHQuX3QoImRlZmF1bHQiLCBbbigidHIiLCB7DQogICAgICAgICAgICAgICAgICAgIGNsYXNzOiB0LmdldFJvd0NsYXNzZXMoZSkNCiAgICAgICAgICAgICAgICB9LCB0Ll9sKHQubm9ybWFsaXplZF9jb2x1bW5zLCBmdW5jdGlvbih0LCByKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBuKCJkYXRhdGFibGUtY2VsbCIsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGtleTogciwNCiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uOiB0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdzogZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgIH0pKV0sIHsNCiAgICAgICAgICAgICAgICAgICAgcm93OiBlDQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIH0pLCB0Ll92KCIgIiksIDAgPT0gdC5wcm9jZXNzZWRfcm93cy5sZW5ndGggPyBuKCJ0ciIsIFtuKCJ0ZCIsIHsNCiAgICAgICAgICAgICAgICBhdHRyczogew0KICAgICAgICAgICAgICAgICAgICBjb2xzcGFuOiB0Lm5vcm1hbGl6ZWRfY29sdW1ucy5sZW5ndGgNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCBbdC5fdCgibm8tcmVzdWx0cyIpXSwgMildKSA6IHQuX2UoKV0sIDIpXSkNCiAgICAgICAgfSwNCiAgICAgICAgc3RhdGljUmVuZGVyRm5zOiBbXQ0KICAgIH0NCn0sIGZ1bmN0aW9uKHQsIGUpIHsNCiAgICB0LmV4cG9ydHMgPSB7DQogICAgICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgdCA9IHRoaXMsDQogICAgICAgICAgICAgICAgZSA9IHQuJGNyZWF0ZUVsZW1lbnQsDQogICAgICAgICAgICAgICAgbiA9IHQuX3NlbGYuX2MgfHwgZTsNCiAgICAgICAgICAgIHJldHVybiBuKCJ0aCIsIHsNCiAgICAgICAgICAgICAgICBzdHlsZTogew0KICAgICAgICAgICAgICAgICAgICAidGV4dC1hbGlnbiI6ICJjZW50ZXIiLCAgLy90LmNvbHVtbi5hbGlnbg0KICAgICAgICAgICAgICAgICAgICAiZGlzcGxheSI6IHQuY29sdW1uLmRpc3BsYXkNCiAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICB9LCBbdC5fdigiXG5cdCIgKyB0Ll9zKHQuY29sdW1uLmxhYmVsKSArICJcblx0IiksIHQuY29sdW1uLnNvcnRhYmxlID8gbigic3BhbiIsIHsNCiAgICAgICAgICAgICAgICBjbGFzczogdC5jbGFzc2VzLA0KICAgICAgICAgICAgICAgIG9uOiB7DQogICAgICAgICAgICAgICAgICAgIGNsaWNrOiB0LnRvZ2dsZVNvcnQNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KSA6IHQuX2UoKV0pDQogICAgICAgIH0sDQogICAgICAgIHN0YXRpY1JlbmRlckZuczogW10NCiAgICB9DQp9LCBmdW5jdGlvbih0LCBlKSB7DQogICAgdC5leHBvcnRzID0gew0KICAgICAgICByZW5kZXI6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIHQgPSB0aGlzLA0KICAgICAgICAgICAgICAgIGUgPSB0LiRjcmVhdGVFbGVtZW50LA0KICAgICAgICAgICAgICAgIG4gPSB0Ll9zZWxmLl9jIHx8IGU7DQogICAgICAgICAgICByZXR1cm4gbigibGkiLCB7DQogICAgICAgICAgICAgICAgY2xhc3M6IHQubGlfY2xhc3Nlcw0KICAgICAgICAgICAgfSwgW24oImEiLCB7DQogICAgICAgICAgICAgICAgY2xhc3M6IHQuYV9jbGFzc2VzLA0KICAgICAgICAgICAgICAgIGF0dHJzOiB7DQogICAgICAgICAgICAgICAgICAgIGhyZWY6ICJqYXZhc2NyaXB0OiB2b2lkKDApOyINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIG9uOiB7DQogICAgICAgICAgICAgICAgICAgIGNsaWNrOiB0LnNlbmRDbGljaw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIFt0Ll90KCJkZWZhdWx0IiwgW3QuX3YodC5fcyh0LnZhbHVlKSldKV0sIDIpXSkNCiAgICAgICAgfSwNCiAgICAgICAgc3RhdGljUmVuZGVyRm5zOiBbXQ0KICAgIH0NCn0sIGZ1bmN0aW9uKHQsIGUpIHsNCiAgICB0LmV4cG9ydHMgPSB7DQogICAgICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgdCA9IHRoaXMsDQogICAgICAgICAgICAgICAgZSA9IHQuJGNyZWF0ZUVsZW1lbnQsDQogICAgICAgICAgICAgICAgbiA9IHQuX3NlbGYuX2MgfHwgZTsNCiAgICAgICAgICAgIHJldHVybiBuKCJ0ZCIsIHsNCiAgICAgICAgICAgICAgICBzdHlsZTogew0KICAgICAgICAgICAgICAgICAgICAidGV4dC1hbGlnbiI6IHQuY29sdW1uLmFsaWduLA0KICAgICAgICAgICAgICAgICAgICAiZGlzcGxheSI6IHQuY29sdW1uLmRpc3BsYXkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCBbdC5jb2x1bW4uY29tcG9uZW50ID8gbih0LmNvbHVtbi5jb21wb25lbnQsIHsNCiAgICAgICAgICAgICAgICB0YWc6ICJjb21wb25lbnQiLA0KICAgICAgICAgICAgICAgIGF0dHJzOiB7DQogICAgICAgICAgICAgICAgICAgIHJvdzogdC5yb3csDQogICAgICAgICAgICAgICAgICAgIGNvbHVtbjogdC5jb2x1bW4NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KSA6IHQuY29sdW1uLmludGVycG9sYXRlID8gbigic3BhbiIsIHsNCiAgICAgICAgICAgICAgICBkb21Qcm9wczogew0KICAgICAgICAgICAgICAgICAgICBpbm5lckhUTUw6IHQuX3ModC5jb250ZW50KQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pIDogbigic3BhbiIsIFt0Ll92KHQuX3ModC5jb250ZW50KSldKV0sIDEpDQogICAgICAgIH0sDQogICAgICAgIHN0YXRpY1JlbmRlckZuczogW10NCiAgICB9DQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgdmFyIHIgPSBuKDIxKTsNCiAgICAic3RyaW5nIiA9PSB0eXBlb2YgciAmJiAociA9IFsNCiAgICAgICAgW3QuaSwgciwgIiJdDQogICAgXSksIHIubG9jYWxzICYmICh0LmV4cG9ydHMgPSByLmxvY2Fscyk7DQogICAgbigzKSgiMjIwZDQxMTYiLCByLCAhMCkNCn0sIGZ1bmN0aW9uKHQsIGUsIG4pIHsNCiAgICB2YXIgciA9IG4oMjIpOw0KICAgICJzdHJpbmciID09IHR5cGVvZiByICYmIChyID0gWw0KICAgICAgICBbdC5pLCByLCAiIl0NCiAgICBdKSwgci5sb2NhbHMgJiYgKHQuZXhwb3J0cyA9IHIubG9jYWxzKTsNCiAgICBuKDMpKCI2MzRlMjYwYyIsIHIsICEwKQ0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgIHZhciByID0gbigyMyk7DQogICAgInN0cmluZyIgPT0gdHlwZW9mIHIgJiYgKHIgPSBbDQogICAgICAgIFt0LmksIHIsICIiXQ0KICAgIF0pLCByLmxvY2FscyAmJiAodC5leHBvcnRzID0gci5sb2NhbHMpOw0KICAgIG4oMykoIjc2MjE5ODE4IiwgciwgITApDQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgdmFyIHIgPSBuKDI0KTsNCiAgICAic3RyaW5nIiA9PSB0eXBlb2YgciAmJiAociA9IFsNCiAgICAgICAgW3QuaSwgciwgIiJdDQogICAgXSksIHIubG9jYWxzICYmICh0LmV4cG9ydHMgPSByLmxvY2Fscyk7DQogICAgbigzKSgiM2ZhY2JhNzQiLCByLCAhMCkNCn0sIGZ1bmN0aW9uKHQsIGUsIG4pIHsNCiAgICB2YXIgciA9IG4oMjUpOw0KICAgICJzdHJpbmciID09IHR5cGVvZiByICYmIChyID0gWw0KICAgICAgICBbdC5pLCByLCAiIl0NCiAgICBdKSwgci5sb2NhbHMgJiYgKHQuZXhwb3J0cyA9IHIubG9jYWxzKTsNCiAgICBuKDMpKCI1ZjljOWVmOCIsIHIsICEwKQ0KfSwgZnVuY3Rpb24odCwgZSkgew0KICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uKHQsIGUpIHsNCiAgICAgICAgZm9yICh2YXIgbiA9IFtdLCByID0ge30sIHMgPSAwOyBzIDwgZS5sZW5ndGg7IHMrKykgew0KICAgICAgICAgICAgdmFyIGkgPSBlW3NdLA0KICAgICAgICAgICAgICAgIGEgPSBpWzBdLA0KICAgICAgICAgICAgICAgIG8gPSBpWzFdLA0KICAgICAgICAgICAgICAgIGwgPSBpWzJdLA0KICAgICAgICAgICAgICAgIHUgPSBpWzNdLA0KICAgICAgICAgICAgICAgIGMgPSB7DQogICAgICAgICAgICAgICAgICAgIGlkOiB0ICsgIjoiICsgcywNCiAgICAgICAgICAgICAgICAgICAgY3NzOiBvLA0KICAgICAgICAgICAgICAgICAgICBtZWRpYTogbCwNCiAgICAgICAgICAgICAgICAgICAgc291cmNlTWFwOiB1DQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIHJbYV0gPyByW2FdLnBhcnRzLnB1c2goYykgOiBuLnB1c2goclthXSA9IHsNCiAgICAgICAgICAgICAgICBpZDogYSwNCiAgICAgICAgICAgICAgICBwYXJ0czogW2NdDQogICAgICAgICAgICB9KQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiBuDQogICAgfQ0KfSwgLCAsICwgLCAsIGZ1bmN0aW9uKHQsIGUsIG4pIHsNCiAgICAidXNlIHN0cmljdCI7DQogICAgdmFyIHIgPSBuKDgpOw0KICAgIGUuYSA9IG5ldyByLmENCn0sICwgLCAsICwgLCAsICwgLCAsICwgLCAsICwgLCAsICwgLCAsICwgLCAsICwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgICJ1c2Ugc3RyaWN0IjsNCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgIl9fZXNNb2R1bGUiLCB7DQogICAgICAgIHZhbHVlOiAhMA0KICAgIH0pOw0KICAgIHZhciByID0gbig0Myk7DQogICAgd2luZG93LlZ1ZS51c2Uoci5hKQ0KfSwgLCAsICwgLCAsICwgLCAsICwgLCAsICwgLCAsIGZ1bmN0aW9uKHQsIGUsIG4pIHsNCiAgICB0LmV4cG9ydHMgPSBuKDY2KQ0KfV0pOw0KDQovLyBzZWxlY3Qg5o+S5Lu2DQovLyBsaXZlc2VhcmNoOiDmkJzlsIvkuIvmi4npgbjllq4gKHRydWUpDQovLyBtdWx0aXBsZTog5aSa6YG4IChtdWx0aXBsZSksIOWkmumBuOaZguacg+aciSAi5YWo6YG4IiwgIuWFqOS4jemBuCIg5YWp5YCL6YG46aCFDQovLyBibGFuazog6aCQ6Kit6KuL6YG45pOHICh0cnVlKQ0KVnVlLmNvbXBvbmVudCgndi1zZWxlY3QnLCB7DQogICAgcHJvcHM6IFsnb3B0aW9ucycsICd2YWx1ZScsICdsaXZlc2VhcmNoJywgJ211bHRpcGxlJywgJ2JsYW5rJ10sDQogICAgdGVtcGxhdGU6IFsiPHNlbGVjdCA6bXVsdGlwbGU9J211bHRpcGxlJyA6ZGF0YS1saXZlLXNlYXJjaD0nbGl2ZXNlYXJjaCcgY2xhc3M9J2Zvcm0tY29udHJvbCc+ICIsDQogICAgICAgICAgICAgICAgICAgIjxvcHRpb24gOnZhbHVlPSdvcHRpb24uQ29kZScgdi1mb3I9J29wdGlvbiBpbiBvcHRpb25zJyA6c2VsZWN0ZWQ9J29wdGlvbi5Db2RlPT09dmFsdWUnPnt7IG9wdGlvbi5EZXNjcmlwdGlvbiB9fTwvb3B0aW9uPiAiLA0KICAgICAgICAgICAgICAgICI8L3NlbGVjdCJdLmpvaW4oIiIpLA0KICAgIG1vdW50ZWQ6IGZ1bmN0aW9uICgpIHsNCg0KICAgICAgICB2YXIgdm0gPSB0aGlzOw0KICAgICAgICAvL2FsZXJ0KHZtLmxpdmVzZWFyY2gpOw0KICAgICAgICAvL2FsZXJ0KHZtLm11bHRpcGxlKTsNCiAgICAgICAgLy9hbGVydCh0aGlzLnZhbHVlKTsNCiAgICAgICAgLy8kKHRoaXMuJGVsKS52YWwodGhpcy52YWx1ZSAhPSBudWxsID8gdGhpcy52YWx1ZSA6IG51bGwpOw0KICAgICAgICAvL2FsZXJ0KEpTT04uc3RyaW5naWZ5KHRoaXMub3B0aW9ucykpOw0KICAgICAgICANCiAgICAgICAgLy9hbGVydCgkKHZtLiRlbCkucHJvcCgnb3V0ZXJIVE1MJykpOw0KICAgICAgICAvLyDoq4vpgbjmk4fpgbjpoIUNCiAgICAgICAgaWYgKHZtLmJsYW5rKSB7DQogICAgICAgICAgICAkKHRoaXMuJGVsKS5wcmVwZW5kKCc8b3B0aW9uIHN0eWxlPSJjb2xvcjogZ3JheSIgdmFsdWU9IiI+6KuL6YG45pOHPC9vcHRpb24+Jyk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyDpoa/npLrmloflrZco5Lit5paH57eo56K8KQ0KICAgICAgICAkKHRoaXMuJGVsKS5zZWxlY3RwaWNrZXIoew0KICAgICAgICAgICAgbm9uZVNlbGVjdGVkVGV4dDogJ+aykuaciemBuOWPluS7u+S9lemgheebricsDQogICAgICAgICAgICBub25lUmVzdWx0c1RleHQ6ICfmspLmnInmib7liLDnrKblkIjnmoTntZDmnpwnLA0KICAgICAgICAgICAgY291bnRTZWxlY3RlZFRleHQ6ICflt7LntpPpgbjlj5Z7MH3lgIvpoIXnm64nLA0KICAgICAgICAgICAgbWF4T3B0aW9uc1RleHQ6IFsn6LaF6YGO6ZmQ5Yi2ICjmnIDlpJrpgbjmk4d7bn3poIUpJywgJ+i2hemBjumZkOWItijmnIDlpJrpgbjmk4d7bn3ntYQpJ10sDQogICAgICAgICAgICBzZWxlY3RBbGxUZXh0OiAn5YWo6YG4JywNCiAgICAgICAgICAgIGRlc2VsZWN0QWxsVGV4dDogJ+WFqOWPlua2iCcsDQogICAgICAgICAgICBtdWx0aXBsZVNlcGFyYXRvcjogJywgJywNCiAgICAgICAgICAgIHNpemU6IDEwLA0KICAgICAgICAgICAgdGl0bGU6ICctLeiri+mBuOaThy0tJywNCiAgICAgICAgICAgIGNsYXNzOiAnc2VsZWN0cGlja2VyJywNCiAgICAgICAgICAgIGFjdGlvbnNCb3g6IHRydWUgLy8g6aGv56S65YWo6YG4LCDlhajlj5bmtogNCiAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICAkKHRoaXMuJGVsKS5zZWxlY3RwaWNrZXIoJ3ZhbCcsIHRoaXMudmFsdWUgIT0gbnVsbCA/IHRoaXMudmFsdWUgOiBudWxsKTsNCiAgICAgICAgJCh0aGlzLiRlbCkudmFsKHRoaXMudmFsdWUpLnNlbGVjdHBpY2tlcigpLm9uKCdjaGFuZ2VkLmJzLnNlbGVjdCcsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZtLiRlbWl0KCdpbnB1dCcsICQodGhpcykuc2VsZWN0cGlja2VyKCJ2YWwiKSk7DQogICAgICAgIH0pOw0KDQogICAgICAgIC8vYWxlcnQoSlNPTi5zdHJpbmdpZnkodm0ub3B0aW9ucykpOw0KICAgICAgICAvKg0KICAgICAgICBpZiAodm0ub3B0aW9ucykgew0KICAgICAgICAgICAgJCh0aGlzLiRlbCkuZGF0YSgnc2VsZWN0cGlja2VyJykuJGxpcy5lYWNoKGZ1bmN0aW9uIChpKSB7DQogICAgICAgICAgICAgICAgaWYgKHZtLm9wdGlvbnNbaV0pIHsNCiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5hdHRyKCd0aXRsZScsIHZtLm9wdGlvbnNbaV0uVG9vbFRpcCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgKi8NCiAgICB9LA0KICAgIHVwZGF0ZWQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgJCh0aGlzLiRlbCkuc2VsZWN0cGlja2VyKCdyZWZyZXNoJyk7DQogICAgICAgICQodGhpcy4kZWwpLnNlbGVjdHBpY2tlcigidmFsIiwgdGhpcy52YWx1ZSk7DQogICAgICAgIC8qDQogICAgICAgIHZhciB2bSA9IHRoaXM7DQogICAgICAgIGlmICh2bS5vcHRpb25zKSB7DQogICAgICAgICAgICAkKHRoaXMuJGVsKS5kYXRhKCdzZWxlY3RwaWNrZXInKS4kbGlzLmVhY2goZnVuY3Rpb24gKGkpIHsNCiAgICAgICAgICAgICAgICBpZiAodm0ub3B0aW9uc1tpXSkgew0KICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmF0dHIoJ3RpdGxlJywgdm0ub3B0aW9uc1tpXS5Ub29sVGlwKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICAqLw0KICAgIH0sDQogICAgZGVzdHJveWVkOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICQodGhpcy4kZWwpLm9mZigpLnNlbGVjdHBpY2tlcignZGVzdHJveScpOw0KICAgIH0NCn0pOw0KDQo=","CacheKey":"tFrypJw7gEzZLuyeeMsDTENIMzw"}