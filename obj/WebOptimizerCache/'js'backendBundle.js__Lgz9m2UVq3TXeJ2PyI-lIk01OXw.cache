{"Headers":{"Last-Modified":"Tue, 21 Aug 2018 08:45:41 GMT","X-Content-Type-Options":"nosniff"},"Body":"LyogaW5wdXQoMTE4MiwxMS0xMik6IHJ1bi10aW1lIGVycm9yIEpTMTAxMDogRXhwZWN0ZWQgaWRlbnRpZmllcjogLg0KaW5wdXQoMTE4MiwxMS0xMik6IHJ1bi10aW1lIGVycm9yIEpTMTE5NTogRXhwZWN0ZWQgZXhwcmVzc2lvbjogLiAqLw0KLyohIGpRdWVyeSB2My4zLjEgfCAoYykgSlMgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzIHwganF1ZXJ5Lm9yZy9saWNlbnNlICovDQohZnVuY3Rpb24oZSx0KXsidXNlIHN0cmljdCI7Im9iamVjdCI9PXR5cGVvZiBtb2R1bGUmJiJvYmplY3QiPT10eXBlb2YgbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9ZS5kb2N1bWVudD90KGUsITApOmZ1bmN0aW9uKGUpe2lmKCFlLmRvY3VtZW50KXRocm93IG5ldyBFcnJvcigialF1ZXJ5IHJlcXVpcmVzIGEgd2luZG93IHdpdGggYSBkb2N1bWVudCIpO3JldHVybiB0KGUpfTp0KGUpfSgidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6dGhpcyxmdW5jdGlvbihlLHQpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1bXSxyPWUuZG9jdW1lbnQsaT1PYmplY3QuZ2V0UHJvdG90eXBlT2Ysbz1uLnNsaWNlLGE9bi5jb25jYXQscz1uLnB1c2gsdT1uLmluZGV4T2YsbD17fSxjPWwudG9TdHJpbmcsZj1sLmhhc093blByb3BlcnR5LHA9Zi50b1N0cmluZyxkPXAuY2FsbChPYmplY3QpLGg9e30sZz1mdW5jdGlvbiBlKHQpe3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiB0JiYibnVtYmVyIiE9dHlwZW9mIHQubm9kZVR5cGV9LHk9ZnVuY3Rpb24gZSh0KXtyZXR1cm4gbnVsbCE9dCYmdD09PXQud2luZG93fSx2PXt0eXBlOiEwLHNyYzohMCxub01vZHVsZTohMH07ZnVuY3Rpb24gbShlLHQsbil7dmFyIGksbz0odD10fHxyKS5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTtpZihvLnRleHQ9ZSxuKWZvcihpIGluIHYpbltpXSYmKG9baV09bltpXSk7dC5oZWFkLmFwcGVuZENoaWxkKG8pLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobyl9ZnVuY3Rpb24geChlKXtyZXR1cm4gbnVsbD09ZT9lKyIiOiJvYmplY3QiPT10eXBlb2YgZXx8ImZ1bmN0aW9uIj09dHlwZW9mIGU/bFtjLmNhbGwoZSldfHwib2JqZWN0Ijp0eXBlb2YgZX12YXIgYj0iMy4zLjEiLHc9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gbmV3IHcuZm4uaW5pdChlLHQpfSxUPS9eW1xzXHVGRUZGXHhBMF0rfFtcc1x1RkVGRlx4QTBdKyQvZzt3LmZuPXcucHJvdG90eXBlPXtqcXVlcnk6IjMuMy4xIixjb25zdHJ1Y3Rvcjp3LGxlbmd0aDowLHRvQXJyYXk6ZnVuY3Rpb24oKXtyZXR1cm4gby5jYWxsKHRoaXMpfSxnZXQ6ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PWU/by5jYWxsKHRoaXMpOmU8MD90aGlzW2UrdGhpcy5sZW5ndGhdOnRoaXNbZV19LHB1c2hTdGFjazpmdW5jdGlvbihlKXt2YXIgdD13Lm1lcmdlKHRoaXMuY29uc3RydWN0b3IoKSxlKTtyZXR1cm4gdC5wcmV2T2JqZWN0PXRoaXMsdH0sZWFjaDpmdW5jdGlvbihlKXtyZXR1cm4gdy5lYWNoKHRoaXMsZSl9LG1hcDpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2sody5tYXAodGhpcyxmdW5jdGlvbih0LG4pe3JldHVybiBlLmNhbGwodCxuLHQpfSkpfSxzbGljZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnB1c2hTdGFjayhvLmFwcGx5KHRoaXMsYXJndW1lbnRzKSl9LGZpcnN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXEoMCl9LGxhc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lcSgtMSl9LGVxOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMubGVuZ3RoLG49K2UrKGU8MD90OjApO3JldHVybiB0aGlzLnB1c2hTdGFjayhuPj0wJiZuPHQ/W3RoaXNbbl1dOltdKX0sZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJldk9iamVjdHx8dGhpcy5jb25zdHJ1Y3RvcigpfSxwdXNoOnMsc29ydDpuLnNvcnQsc3BsaWNlOm4uc3BsaWNlfSx3LmV4dGVuZD13LmZuLmV4dGVuZD1mdW5jdGlvbigpe3ZhciBlLHQsbixyLGksbyxhPWFyZ3VtZW50c1swXXx8e30scz0xLHU9YXJndW1lbnRzLmxlbmd0aCxsPSExO2ZvcigiYm9vbGVhbiI9PXR5cGVvZiBhJiYobD1hLGE9YXJndW1lbnRzW3NdfHx7fSxzKyspLCJvYmplY3QiPT10eXBlb2YgYXx8ZyhhKXx8KGE9e30pLHM9PT11JiYoYT10aGlzLHMtLSk7czx1O3MrKylpZihudWxsIT0oZT1hcmd1bWVudHNbc10pKWZvcih0IGluIGUpbj1hW3RdLGEhPT0ocj1lW3RdKSYmKGwmJnImJih3LmlzUGxhaW5PYmplY3Qocil8fChpPUFycmF5LmlzQXJyYXkocikpKT8oaT8oaT0hMSxvPW4mJkFycmF5LmlzQXJyYXkobik/bjpbXSk6bz1uJiZ3LmlzUGxhaW5PYmplY3Qobik/bjp7fSxhW3RdPXcuZXh0ZW5kKGwsbyxyKSk6dm9pZCAwIT09ciYmKGFbdF09cikpO3JldHVybiBhfSx3LmV4dGVuZCh7ZXhwYW5kbzoialF1ZXJ5IisoIjMuMy4xIitNYXRoLnJhbmRvbSgpKS5yZXBsYWNlKC9cRC9nLCIiKSxpc1JlYWR5OiEwLGVycm9yOmZ1bmN0aW9uKGUpe3Rocm93IG5ldyBFcnJvcihlKX0sbm9vcDpmdW5jdGlvbigpe30saXNQbGFpbk9iamVjdDpmdW5jdGlvbihlKXt2YXIgdCxuO3JldHVybiEoIWV8fCJbb2JqZWN0IE9iamVjdF0iIT09Yy5jYWxsKGUpKSYmKCEodD1pKGUpKXx8ImZ1bmN0aW9uIj09dHlwZW9mKG49Zi5jYWxsKHQsImNvbnN0cnVjdG9yIikmJnQuY29uc3RydWN0b3IpJiZwLmNhbGwobik9PT1kKX0saXNFbXB0eU9iamVjdDpmdW5jdGlvbihlKXt2YXIgdDtmb3IodCBpbiBlKXJldHVybiExO3JldHVybiEwfSxnbG9iYWxFdmFsOmZ1bmN0aW9uKGUpe20oZSl9LGVhY2g6ZnVuY3Rpb24oZSx0KXt2YXIgbixyPTA7aWYoQyhlKSl7Zm9yKG49ZS5sZW5ndGg7cjxuO3IrKylpZighMT09PXQuY2FsbChlW3JdLHIsZVtyXSkpYnJlYWt9ZWxzZSBmb3IociBpbiBlKWlmKCExPT09dC5jYWxsKGVbcl0scixlW3JdKSlicmVhaztyZXR1cm4gZX0sdHJpbTpmdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09ZT8iIjooZSsiIikucmVwbGFjZShULCIiKX0sbWFrZUFycmF5OmZ1bmN0aW9uKGUsdCl7dmFyIG49dHx8W107cmV0dXJuIG51bGwhPWUmJihDKE9iamVjdChlKSk/dy5tZXJnZShuLCJzdHJpbmciPT10eXBlb2YgZT9bZV06ZSk6cy5jYWxsKG4sZSkpLG59LGluQXJyYXk6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBudWxsPT10Py0xOnUuY2FsbCh0LGUsbil9LG1lcmdlOmZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPSt0Lmxlbmd0aCxyPTAsaT1lLmxlbmd0aDtyPG47cisrKWVbaSsrXT10W3JdO3JldHVybiBlLmxlbmd0aD1pLGV9LGdyZXA6ZnVuY3Rpb24oZSx0LG4pe2Zvcih2YXIgcixpPVtdLG89MCxhPWUubGVuZ3RoLHM9IW47bzxhO28rKykocj0hdChlW29dLG8pKSE9PXMmJmkucHVzaChlW29dKTtyZXR1cm4gaX0sbWFwOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG89MCxzPVtdO2lmKEMoZSkpZm9yKHI9ZS5sZW5ndGg7bzxyO28rKyludWxsIT0oaT10KGVbb10sbyxuKSkmJnMucHVzaChpKTtlbHNlIGZvcihvIGluIGUpbnVsbCE9KGk9dChlW29dLG8sbikpJiZzLnB1c2goaSk7cmV0dXJuIGEuYXBwbHkoW10scyl9LGd1aWQ6MSxzdXBwb3J0Omh9KSwiZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiYody5mbltTeW1ib2wuaXRlcmF0b3JdPW5bU3ltYm9sLml0ZXJhdG9yXSksdy5lYWNoKCJCb29sZWFuIE51bWJlciBTdHJpbmcgRnVuY3Rpb24gQXJyYXkgRGF0ZSBSZWdFeHAgT2JqZWN0IEVycm9yIFN5bWJvbCIuc3BsaXQoIiAiKSxmdW5jdGlvbihlLHQpe2xbIltvYmplY3QgIit0KyJdIl09dC50b0xvd2VyQ2FzZSgpfSk7ZnVuY3Rpb24gQyhlKXt2YXIgdD0hIWUmJiJsZW5ndGgiaW4gZSYmZS5sZW5ndGgsbj14KGUpO3JldHVybiFnKGUpJiYheShlKSYmKCJhcnJheSI9PT1ufHwwPT09dHx8Im51bWJlciI9PXR5cGVvZiB0JiZ0PjAmJnQtMSBpbiBlKX12YXIgRT1mdW5jdGlvbihlKXt2YXIgdCxuLHIsaSxvLGEscyx1LGwsYyxmLHAsZCxoLGcseSx2LG0seCxiPSJzaXp6bGUiKzEqbmV3IERhdGUsdz1lLmRvY3VtZW50LFQ9MCxDPTAsRT1hZSgpLGs9YWUoKSxTPWFlKCksRD1mdW5jdGlvbihlLHQpe3JldHVybiBlPT09dCYmKGY9ITApLDB9LE49e30uaGFzT3duUHJvcGVydHksQT1bXSxqPUEucG9wLHE9QS5wdXNoLEw9QS5wdXNoLEg9QS5zbGljZSxPPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPTAscj1lLmxlbmd0aDtuPHI7bisrKWlmKGVbbl09PT10KXJldHVybiBuO3JldHVybi0xfSxQPSJjaGVja2VkfHNlbGVjdGVkfGFzeW5jfGF1dG9mb2N1c3xhdXRvcGxheXxjb250cm9sc3xkZWZlcnxkaXNhYmxlZHxoaWRkZW58aXNtYXB8bG9vcHxtdWx0aXBsZXxvcGVufHJlYWRvbmx5fHJlcXVpcmVkfHNjb3BlZCIsTT0iW1xceDIwXFx0XFxyXFxuXFxmXSIsUj0iKD86XFxcXC58W1xcdy1dfFteXDAtXFx4YTBdKSsiLEk9IlxcWyIrTSsiKigiK1IrIikoPzoiK00rIiooWypeJHwhfl0/PSkiK00rIiooPzonKCg/OlxcXFwufFteXFxcXCddKSopJ3xcIigoPzpcXFxcLnxbXlxcXFxcIl0pKilcInwoIitSKyIpKXwpIitNKyIqXFxdIixXPSI6KCIrUisiKSg/OlxcKCgoJygoPzpcXFxcLnxbXlxcXFwnXSkqKSd8XCIoKD86XFxcXC58W15cXFxcXCJdKSopXCIpfCgoPzpcXFxcLnxbXlxcXFwoKVtcXF1dfCIrSSsiKSopfC4qKVxcKXwpIiwkPW5ldyBSZWdFeHAoTSsiKyIsImciKSxCPW5ldyBSZWdFeHAoIl4iK00rIit8KCg/Ol58W15cXFxcXSkoPzpcXFxcLikqKSIrTSsiKyQiLCJnIiksRj1uZXcgUmVnRXhwKCJeIitNKyIqLCIrTSsiKiIpLF89bmV3IFJlZ0V4cCgiXiIrTSsiKihbPit+XXwiK00rIikiK00rIioiKSx6PW5ldyBSZWdFeHAoIj0iK00rIiooW15cXF0nXCJdKj8pIitNKyIqXFxdIiwiZyIpLFg9bmV3IFJlZ0V4cChXKSxVPW5ldyBSZWdFeHAoIl4iK1IrIiQiKSxWPXtJRDpuZXcgUmVnRXhwKCJeIygiK1IrIikiKSxDTEFTUzpuZXcgUmVnRXhwKCJeXFwuKCIrUisiKSIpLFRBRzpuZXcgUmVnRXhwKCJeKCIrUisifFsqXSkiKSxBVFRSOm5ldyBSZWdFeHAoIl4iK0kpLFBTRVVETzpuZXcgUmVnRXhwKCJeIitXKSxDSElMRDpuZXcgUmVnRXhwKCJeOihvbmx5fGZpcnN0fGxhc3R8bnRofG50aC1sYXN0KS0oY2hpbGR8b2YtdHlwZSkoPzpcXCgiK00rIiooZXZlbnxvZGR8KChbKy1dfCkoXFxkKilufCkiK00rIiooPzooWystXXwpIitNKyIqKFxcZCspfCkpIitNKyIqXFwpfCkiLCJpIiksYm9vbDpuZXcgUmVnRXhwKCJeKD86IitQKyIpJCIsImkiKSxuZWVkc0NvbnRleHQ6bmV3IFJlZ0V4cCgiXiIrTSsiKls+K35dfDooZXZlbnxvZGR8ZXF8Z3R8bHR8bnRofGZpcnN0fGxhc3QpKD86XFwoIitNKyIqKCg/Oi1cXGQpP1xcZCopIitNKyIqXFwpfCkoPz1bXi1dfCQpIiwiaSIpfSxHPS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2ksWT0vXmhcZCQvaSxRPS9eW157XStce1xzKlxbbmF0aXZlIFx3LyxKPS9eKD86IyhbXHctXSspfChcdyspfFwuKFtcdy1dKykpJC8sSz0vWyt+XS8sWj1uZXcgUmVnRXhwKCJcXFxcKFtcXGRhLWZdezEsNn0iK00rIj98KCIrTSsiKXwuKSIsImlnIiksZWU9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPSIweCIrdC02NTUzNjtyZXR1cm4gciE9PXJ8fG4/dDpyPDA/U3RyaW5nLmZyb21DaGFyQ29kZShyKzY1NTM2KTpTdHJpbmcuZnJvbUNoYXJDb2RlKHI+PjEwfDU1Mjk2LDEwMjMmcnw1NjMyMCl9LHRlPS8oW1wwLVx4MWZceDdmXXxeLT9cZCl8Xi0kfFteXDAtXHgxZlx4N2YtXHVGRkZGXHctXS9nLG5lPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQ/IlwwIj09PWU/Ilx1ZmZmZCI6ZS5zbGljZSgwLC0xKSsiXFwiK2UuY2hhckNvZGVBdChlLmxlbmd0aC0xKS50b1N0cmluZygxNikrIiAiOiJcXCIrZX0scmU9ZnVuY3Rpb24oKXtwKCl9LGllPW1lKGZ1bmN0aW9uKGUpe3JldHVybiEwPT09ZS5kaXNhYmxlZCYmKCJmb3JtImluIGV8fCJsYWJlbCJpbiBlKX0se2RpcjoicGFyZW50Tm9kZSIsbmV4dDoibGVnZW5kIn0pO3RyeXtMLmFwcGx5KEE9SC5jYWxsKHcuY2hpbGROb2Rlcyksdy5jaGlsZE5vZGVzKSxBW3cuY2hpbGROb2Rlcy5sZW5ndGhdLm5vZGVUeXBlfWNhdGNoKGUpe0w9e2FwcGx5OkEubGVuZ3RoP2Z1bmN0aW9uKGUsdCl7cS5hcHBseShlLEguY2FsbCh0KSl9OmZ1bmN0aW9uKGUsdCl7dmFyIG49ZS5sZW5ndGgscj0wO3doaWxlKGVbbisrXT10W3IrK10pO2UubGVuZ3RoPW4tMX19fWZ1bmN0aW9uIG9lKGUsdCxyLGkpe3ZhciBvLHMsbCxjLGYsaCx2LG09dCYmdC5vd25lckRvY3VtZW50LFQ9dD90Lm5vZGVUeXBlOjk7aWYocj1yfHxbXSwic3RyaW5nIiE9dHlwZW9mIGV8fCFlfHwxIT09VCYmOSE9PVQmJjExIT09VClyZXR1cm4gcjtpZighaSYmKCh0P3Qub3duZXJEb2N1bWVudHx8dDp3KSE9PWQmJnAodCksdD10fHxkLGcpKXtpZigxMSE9PVQmJihmPUouZXhlYyhlKSkpaWYobz1mWzFdKXtpZig5PT09VCl7aWYoIShsPXQuZ2V0RWxlbWVudEJ5SWQobykpKXJldHVybiByO2lmKGwuaWQ9PT1vKXJldHVybiByLnB1c2gobCkscn1lbHNlIGlmKG0mJihsPW0uZ2V0RWxlbWVudEJ5SWQobykpJiZ4KHQsbCkmJmwuaWQ9PT1vKXJldHVybiByLnB1c2gobCkscn1lbHNle2lmKGZbMl0pcmV0dXJuIEwuYXBwbHkocix0LmdldEVsZW1lbnRzQnlUYWdOYW1lKGUpKSxyO2lmKChvPWZbM10pJiZuLmdldEVsZW1lbnRzQnlDbGFzc05hbWUmJnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSlyZXR1cm4gTC5hcHBseShyLHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShvKSkscn1pZihuLnFzYSYmIVNbZSsiICJdJiYoIXl8fCF5LnRlc3QoZSkpKXtpZigxIT09VCltPXQsdj1lO2Vsc2UgaWYoIm9iamVjdCIhPT10Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpeyhjPXQuZ2V0QXR0cmlidXRlKCJpZCIpKT9jPWMucmVwbGFjZSh0ZSxuZSk6dC5zZXRBdHRyaWJ1dGUoImlkIixjPWIpLHM9KGg9YShlKSkubGVuZ3RoO3doaWxlKHMtLSloW3NdPSIjIitjKyIgIit2ZShoW3NdKTt2PWguam9pbigiLCIpLG09Sy50ZXN0KGUpJiZnZSh0LnBhcmVudE5vZGUpfHx0fWlmKHYpdHJ5e3JldHVybiBMLmFwcGx5KHIsbS5xdWVyeVNlbGVjdG9yQWxsKHYpKSxyfWNhdGNoKGUpe31maW5hbGx5e2M9PT1iJiZ0LnJlbW92ZUF0dHJpYnV0ZSgiaWQiKX19fXJldHVybiB1KGUucmVwbGFjZShCLCIkMSIpLHQscixpKX1mdW5jdGlvbiBhZSgpe3ZhciBlPVtdO2Z1bmN0aW9uIHQobixpKXtyZXR1cm4gZS5wdXNoKG4rIiAiKT5yLmNhY2hlTGVuZ3RoJiZkZWxldGUgdFtlLnNoaWZ0KCldLHRbbisiICJdPWl9cmV0dXJuIHR9ZnVuY3Rpb24gc2UoZSl7cmV0dXJuIGVbYl09ITAsZX1mdW5jdGlvbiB1ZShlKXt2YXIgdD1kLmNyZWF0ZUVsZW1lbnQoImZpZWxkc2V0Iik7dHJ5e3JldHVybiEhZSh0KX1jYXRjaChlKXtyZXR1cm4hMX1maW5hbGx5e3QucGFyZW50Tm9kZSYmdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHQpLHQ9bnVsbH19ZnVuY3Rpb24gbGUoZSx0KXt2YXIgbj1lLnNwbGl0KCJ8IiksaT1uLmxlbmd0aDt3aGlsZShpLS0pci5hdHRySGFuZGxlW25baV1dPXR9ZnVuY3Rpb24gY2UoZSx0KXt2YXIgbj10JiZlLHI9biYmMT09PWUubm9kZVR5cGUmJjE9PT10Lm5vZGVUeXBlJiZlLnNvdXJjZUluZGV4LXQuc291cmNlSW5kZXg7aWYocilyZXR1cm4gcjtpZihuKXdoaWxlKG49bi5uZXh0U2libGluZylpZihuPT09dClyZXR1cm4tMTtyZXR1cm4gZT8xOi0xfWZ1bmN0aW9uIGZlKGUpe3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4iaW5wdXQiPT09dC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpJiZ0LnR5cGU9PT1lfX1mdW5jdGlvbiBwZShlKXtyZXR1cm4gZnVuY3Rpb24odCl7dmFyIG49dC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO3JldHVybigiaW5wdXQiPT09bnx8ImJ1dHRvbiI9PT1uKSYmdC50eXBlPT09ZX19ZnVuY3Rpb24gZGUoZSl7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybiJmb3JtImluIHQ/dC5wYXJlbnROb2RlJiYhMT09PXQuZGlzYWJsZWQ/ImxhYmVsImluIHQ/ImxhYmVsImluIHQucGFyZW50Tm9kZT90LnBhcmVudE5vZGUuZGlzYWJsZWQ9PT1lOnQuZGlzYWJsZWQ9PT1lOnQuaXNEaXNhYmxlZD09PWV8fHQuaXNEaXNhYmxlZCE9PSFlJiZpZSh0KT09PWU6dC5kaXNhYmxlZD09PWU6ImxhYmVsImluIHQmJnQuZGlzYWJsZWQ9PT1lfX1mdW5jdGlvbiBoZShlKXtyZXR1cm4gc2UoZnVuY3Rpb24odCl7cmV0dXJuIHQ9K3Qsc2UoZnVuY3Rpb24obixyKXt2YXIgaSxvPWUoW10sbi5sZW5ndGgsdCksYT1vLmxlbmd0aDt3aGlsZShhLS0pbltpPW9bYV1dJiYobltpXT0hKHJbaV09bltpXSkpfSl9KX1mdW5jdGlvbiBnZShlKXtyZXR1cm4gZSYmInVuZGVmaW5lZCIhPXR5cGVvZiBlLmdldEVsZW1lbnRzQnlUYWdOYW1lJiZlfW49b2Uuc3VwcG9ydD17fSxvPW9lLmlzWE1MPWZ1bmN0aW9uKGUpe3ZhciB0PWUmJihlLm93bmVyRG9jdW1lbnR8fGUpLmRvY3VtZW50RWxlbWVudDtyZXR1cm4hIXQmJiJIVE1MIiE9PXQubm9kZU5hbWV9LHA9b2Uuc2V0RG9jdW1lbnQ9ZnVuY3Rpb24oZSl7dmFyIHQsaSxhPWU/ZS5vd25lckRvY3VtZW50fHxlOnc7cmV0dXJuIGEhPT1kJiY5PT09YS5ub2RlVHlwZSYmYS5kb2N1bWVudEVsZW1lbnQ/KGQ9YSxoPWQuZG9jdW1lbnRFbGVtZW50LGc9IW8oZCksdyE9PWQmJihpPWQuZGVmYXVsdFZpZXcpJiZpLnRvcCE9PWkmJihpLmFkZEV2ZW50TGlzdGVuZXI/aS5hZGRFdmVudExpc3RlbmVyKCJ1bmxvYWQiLHJlLCExKTppLmF0dGFjaEV2ZW50JiZpLmF0dGFjaEV2ZW50KCJvbnVubG9hZCIscmUpKSxuLmF0dHJpYnV0ZXM9dWUoZnVuY3Rpb24oZSl7cmV0dXJuIGUuY2xhc3NOYW1lPSJpIiwhZS5nZXRBdHRyaWJ1dGUoImNsYXNzTmFtZSIpfSksbi5nZXRFbGVtZW50c0J5VGFnTmFtZT11ZShmdW5jdGlvbihlKXtyZXR1cm4gZS5hcHBlbmRDaGlsZChkLmNyZWF0ZUNvbW1lbnQoIiIpKSwhZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpLmxlbmd0aH0pLG4uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZT1RLnRlc3QoZC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKSxuLmdldEJ5SWQ9dWUoZnVuY3Rpb24oZSl7cmV0dXJuIGguYXBwZW5kQ2hpbGQoZSkuaWQ9YiwhZC5nZXRFbGVtZW50c0J5TmFtZXx8IWQuZ2V0RWxlbWVudHNCeU5hbWUoYikubGVuZ3RofSksbi5nZXRCeUlkPyhyLmZpbHRlci5JRD1mdW5jdGlvbihlKXt2YXIgdD1lLnJlcGxhY2UoWixlZSk7cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiBlLmdldEF0dHJpYnV0ZSgiaWQiKT09PXR9fSxyLmZpbmQuSUQ9ZnVuY3Rpb24oZSx0KXtpZigidW5kZWZpbmVkIiE9dHlwZW9mIHQuZ2V0RWxlbWVudEJ5SWQmJmcpe3ZhciBuPXQuZ2V0RWxlbWVudEJ5SWQoZSk7cmV0dXJuIG4/W25dOltdfX0pOihyLmZpbHRlci5JRD1mdW5jdGlvbihlKXt2YXIgdD1lLnJlcGxhY2UoWixlZSk7cmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciBuPSJ1bmRlZmluZWQiIT10eXBlb2YgZS5nZXRBdHRyaWJ1dGVOb2RlJiZlLmdldEF0dHJpYnV0ZU5vZGUoImlkIik7cmV0dXJuIG4mJm4udmFsdWU9PT10fX0sci5maW5kLklEPWZ1bmN0aW9uKGUsdCl7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiB0LmdldEVsZW1lbnRCeUlkJiZnKXt2YXIgbixyLGksbz10LmdldEVsZW1lbnRCeUlkKGUpO2lmKG8pe2lmKChuPW8uZ2V0QXR0cmlidXRlTm9kZSgiaWQiKSkmJm4udmFsdWU9PT1lKXJldHVybltvXTtpPXQuZ2V0RWxlbWVudHNCeU5hbWUoZSkscj0wO3doaWxlKG89aVtyKytdKWlmKChuPW8uZ2V0QXR0cmlidXRlTm9kZSgiaWQiKSkmJm4udmFsdWU9PT1lKXJldHVybltvXX1yZXR1cm5bXX19KSxyLmZpbmQuVEFHPW4uZ2V0RWxlbWVudHNCeVRhZ05hbWU/ZnVuY3Rpb24oZSx0KXtyZXR1cm4idW5kZWZpbmVkIiE9dHlwZW9mIHQuZ2V0RWxlbWVudHNCeVRhZ05hbWU/dC5nZXRFbGVtZW50c0J5VGFnTmFtZShlKTpuLnFzYT90LnF1ZXJ5U2VsZWN0b3JBbGwoZSk6dm9pZCAwfTpmdW5jdGlvbihlLHQpe3ZhciBuLHI9W10saT0wLG89dC5nZXRFbGVtZW50c0J5VGFnTmFtZShlKTtpZigiKiI9PT1lKXt3aGlsZShuPW9baSsrXSkxPT09bi5ub2RlVHlwZSYmci5wdXNoKG4pO3JldHVybiByfXJldHVybiBvfSxyLmZpbmQuQ0xBU1M9bi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lJiZmdW5jdGlvbihlLHQpe2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgdC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lJiZnKXJldHVybiB0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoZSl9LHY9W10seT1bXSwobi5xc2E9US50ZXN0KGQucXVlcnlTZWxlY3RvckFsbCkpJiYodWUoZnVuY3Rpb24oZSl7aC5hcHBlbmRDaGlsZChlKS5pbm5lckhUTUw9IjxhIGlkPSciK2IrIic+PC9hPjxzZWxlY3QgaWQ9JyIrYisiLVxyXFwnIG1zYWxsb3djYXB0dXJlPScnPjxvcHRpb24gc2VsZWN0ZWQ9Jyc+PC9vcHRpb24+PC9zZWxlY3Q+IixlLnF1ZXJ5U2VsZWN0b3JBbGwoIlttc2FsbG93Y2FwdHVyZV49JyddIikubGVuZ3RoJiZ5LnB1c2goIlsqXiRdPSIrTSsiKig/OicnfFwiXCIpIiksZS5xdWVyeVNlbGVjdG9yQWxsKCJbc2VsZWN0ZWRdIikubGVuZ3RofHx5LnB1c2goIlxcWyIrTSsiKig/OnZhbHVlfCIrUCsiKSIpLGUucXVlcnlTZWxlY3RvckFsbCgiW2lkfj0iK2IrIi1dIikubGVuZ3RofHx5LnB1c2goIn49IiksZS5xdWVyeVNlbGVjdG9yQWxsKCI6Y2hlY2tlZCIpLmxlbmd0aHx8eS5wdXNoKCI6Y2hlY2tlZCIpLGUucXVlcnlTZWxlY3RvckFsbCgiYSMiK2IrIisqIikubGVuZ3RofHx5LnB1c2goIi4jLitbK35dIil9KSx1ZShmdW5jdGlvbihlKXtlLmlubmVySFRNTD0iPGEgaHJlZj0nJyBkaXNhYmxlZD0nZGlzYWJsZWQnPjwvYT48c2VsZWN0IGRpc2FibGVkPSdkaXNhYmxlZCc+PG9wdGlvbi8+PC9zZWxlY3Q+Ijt2YXIgdD1kLmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7dC5zZXRBdHRyaWJ1dGUoInR5cGUiLCJoaWRkZW4iKSxlLmFwcGVuZENoaWxkKHQpLnNldEF0dHJpYnV0ZSgibmFtZSIsIkQiKSxlLnF1ZXJ5U2VsZWN0b3JBbGwoIltuYW1lPWRdIikubGVuZ3RoJiZ5LnB1c2goIm5hbWUiK00rIipbKl4kfCF+XT89IiksMiE9PWUucXVlcnlTZWxlY3RvckFsbCgiOmVuYWJsZWQiKS5sZW5ndGgmJnkucHVzaCgiOmVuYWJsZWQiLCI6ZGlzYWJsZWQiKSxoLmFwcGVuZENoaWxkKGUpLmRpc2FibGVkPSEwLDIhPT1lLnF1ZXJ5U2VsZWN0b3JBbGwoIjpkaXNhYmxlZCIpLmxlbmd0aCYmeS5wdXNoKCI6ZW5hYmxlZCIsIjpkaXNhYmxlZCIpLGUucXVlcnlTZWxlY3RvckFsbCgiKiw6eCIpLHkucHVzaCgiLC4qOiIpfSkpLChuLm1hdGNoZXNTZWxlY3Rvcj1RLnRlc3QobT1oLm1hdGNoZXN8fGgud2Via2l0TWF0Y2hlc1NlbGVjdG9yfHxoLm1vek1hdGNoZXNTZWxlY3Rvcnx8aC5vTWF0Y2hlc1NlbGVjdG9yfHxoLm1zTWF0Y2hlc1NlbGVjdG9yKSkmJnVlKGZ1bmN0aW9uKGUpe24uZGlzY29ubmVjdGVkTWF0Y2g9bS5jYWxsKGUsIioiKSxtLmNhbGwoZSwiW3MhPScnXTp4Iiksdi5wdXNoKCIhPSIsVyl9KSx5PXkubGVuZ3RoJiZuZXcgUmVnRXhwKHkuam9pbigifCIpKSx2PXYubGVuZ3RoJiZuZXcgUmVnRXhwKHYuam9pbigifCIpKSx0PVEudGVzdChoLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKSx4PXR8fFEudGVzdChoLmNvbnRhaW5zKT9mdW5jdGlvbihlLHQpe3ZhciBuPTk9PT1lLm5vZGVUeXBlP2UuZG9jdW1lbnRFbGVtZW50OmUscj10JiZ0LnBhcmVudE5vZGU7cmV0dXJuIGU9PT1yfHwhKCFyfHwxIT09ci5ub2RlVHlwZXx8IShuLmNvbnRhaW5zP24uY29udGFpbnMocik6ZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiYmMTYmZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihyKSkpfTpmdW5jdGlvbihlLHQpe2lmKHQpd2hpbGUodD10LnBhcmVudE5vZGUpaWYodD09PWUpcmV0dXJuITA7cmV0dXJuITF9LEQ9dD9mdW5jdGlvbihlLHQpe2lmKGU9PT10KXJldHVybiBmPSEwLDA7dmFyIHI9IWUuY29tcGFyZURvY3VtZW50UG9zaXRpb24tIXQuY29tcGFyZURvY3VtZW50UG9zaXRpb247cmV0dXJuIHJ8fCgxJihyPShlLm93bmVyRG9jdW1lbnR8fGUpPT09KHQub3duZXJEb2N1bWVudHx8dCk/ZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbih0KToxKXx8IW4uc29ydERldGFjaGVkJiZ0LmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGUpPT09cj9lPT09ZHx8ZS5vd25lckRvY3VtZW50PT09dyYmeCh3LGUpPy0xOnQ9PT1kfHx0Lm93bmVyRG9jdW1lbnQ9PT13JiZ4KHcsdCk/MTpjP08oYyxlKS1PKGMsdCk6MDo0JnI/LTE6MSl9OmZ1bmN0aW9uKGUsdCl7aWYoZT09PXQpcmV0dXJuIGY9ITAsMDt2YXIgbixyPTAsaT1lLnBhcmVudE5vZGUsbz10LnBhcmVudE5vZGUsYT1bZV0scz1bdF07aWYoIWl8fCFvKXJldHVybiBlPT09ZD8tMTp0PT09ZD8xOmk/LTE6bz8xOmM/TyhjLGUpLU8oYyx0KTowO2lmKGk9PT1vKXJldHVybiBjZShlLHQpO249ZTt3aGlsZShuPW4ucGFyZW50Tm9kZSlhLnVuc2hpZnQobik7bj10O3doaWxlKG49bi5wYXJlbnROb2RlKXMudW5zaGlmdChuKTt3aGlsZShhW3JdPT09c1tyXSlyKys7cmV0dXJuIHI/Y2UoYVtyXSxzW3JdKTphW3JdPT09dz8tMTpzW3JdPT09dz8xOjB9LGQpOmR9LG9lLm1hdGNoZXM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gb2UoZSxudWxsLG51bGwsdCl9LG9lLm1hdGNoZXNTZWxlY3Rvcj1mdW5jdGlvbihlLHQpe2lmKChlLm93bmVyRG9jdW1lbnR8fGUpIT09ZCYmcChlKSx0PXQucmVwbGFjZSh6LCI9JyQxJ10iKSxuLm1hdGNoZXNTZWxlY3RvciYmZyYmIVNbdCsiICJdJiYoIXZ8fCF2LnRlc3QodCkpJiYoIXl8fCF5LnRlc3QodCkpKXRyeXt2YXIgcj1tLmNhbGwoZSx0KTtpZihyfHxuLmRpc2Nvbm5lY3RlZE1hdGNofHxlLmRvY3VtZW50JiYxMSE9PWUuZG9jdW1lbnQubm9kZVR5cGUpcmV0dXJuIHJ9Y2F0Y2goZSl7fXJldHVybiBvZSh0LGQsbnVsbCxbZV0pLmxlbmd0aD4wfSxvZS5jb250YWlucz1mdW5jdGlvbihlLHQpe3JldHVybihlLm93bmVyRG9jdW1lbnR8fGUpIT09ZCYmcChlKSx4KGUsdCl9LG9lLmF0dHI9ZnVuY3Rpb24oZSx0KXsoZS5vd25lckRvY3VtZW50fHxlKSE9PWQmJnAoZSk7dmFyIGk9ci5hdHRySGFuZGxlW3QudG9Mb3dlckNhc2UoKV0sbz1pJiZOLmNhbGwoci5hdHRySGFuZGxlLHQudG9Mb3dlckNhc2UoKSk/aShlLHQsIWcpOnZvaWQgMDtyZXR1cm4gdm9pZCAwIT09bz9vOm4uYXR0cmlidXRlc3x8IWc/ZS5nZXRBdHRyaWJ1dGUodCk6KG89ZS5nZXRBdHRyaWJ1dGVOb2RlKHQpKSYmby5zcGVjaWZpZWQ/by52YWx1ZTpudWxsfSxvZS5lc2NhcGU9ZnVuY3Rpb24oZSl7cmV0dXJuKGUrIiIpLnJlcGxhY2UodGUsbmUpfSxvZS5lcnJvcj1mdW5jdGlvbihlKXt0aHJvdyBuZXcgRXJyb3IoIlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246ICIrZSl9LG9lLnVuaXF1ZVNvcnQ9ZnVuY3Rpb24oZSl7dmFyIHQscj1bXSxpPTAsbz0wO2lmKGY9IW4uZGV0ZWN0RHVwbGljYXRlcyxjPSFuLnNvcnRTdGFibGUmJmUuc2xpY2UoMCksZS5zb3J0KEQpLGYpe3doaWxlKHQ9ZVtvKytdKXQ9PT1lW29dJiYoaT1yLnB1c2gobykpO3doaWxlKGktLSllLnNwbGljZShyW2ldLDEpfXJldHVybiBjPW51bGwsZX0saT1vZS5nZXRUZXh0PWZ1bmN0aW9uKGUpe3ZhciB0LG49IiIscj0wLG89ZS5ub2RlVHlwZTtpZihvKXtpZigxPT09b3x8OT09PW98fDExPT09byl7aWYoInN0cmluZyI9PXR5cGVvZiBlLnRleHRDb250ZW50KXJldHVybiBlLnRleHRDb250ZW50O2ZvcihlPWUuZmlyc3RDaGlsZDtlO2U9ZS5uZXh0U2libGluZyluKz1pKGUpfWVsc2UgaWYoMz09PW98fDQ9PT1vKXJldHVybiBlLm5vZGVWYWx1ZX1lbHNlIHdoaWxlKHQ9ZVtyKytdKW4rPWkodCk7cmV0dXJuIG59LChyPW9lLnNlbGVjdG9ycz17Y2FjaGVMZW5ndGg6NTAsY3JlYXRlUHNldWRvOnNlLG1hdGNoOlYsYXR0ckhhbmRsZTp7fSxmaW5kOnt9LHJlbGF0aXZlOnsiPiI6e2RpcjoicGFyZW50Tm9kZSIsZmlyc3Q6ITB9LCIgIjp7ZGlyOiJwYXJlbnROb2RlIn0sIisiOntkaXI6InByZXZpb3VzU2libGluZyIsZmlyc3Q6ITB9LCJ+Ijp7ZGlyOiJwcmV2aW91c1NpYmxpbmcifX0scHJlRmlsdGVyOntBVFRSOmZ1bmN0aW9uKGUpe3JldHVybiBlWzFdPWVbMV0ucmVwbGFjZShaLGVlKSxlWzNdPShlWzNdfHxlWzRdfHxlWzVdfHwiIikucmVwbGFjZShaLGVlKSwifj0iPT09ZVsyXSYmKGVbM109IiAiK2VbM10rIiAiKSxlLnNsaWNlKDAsNCl9LENISUxEOmZ1bmN0aW9uKGUpe3JldHVybiBlWzFdPWVbMV0udG9Mb3dlckNhc2UoKSwibnRoIj09PWVbMV0uc2xpY2UoMCwzKT8oZVszXXx8b2UuZXJyb3IoZVswXSksZVs0XT0rKGVbNF0/ZVs1XSsoZVs2XXx8MSk6MiooImV2ZW4iPT09ZVszXXx8Im9kZCI9PT1lWzNdKSksZVs1XT0rKGVbN10rZVs4XXx8Im9kZCI9PT1lWzNdKSk6ZVszXSYmb2UuZXJyb3IoZVswXSksZX0sUFNFVURPOmZ1bmN0aW9uKGUpe3ZhciB0LG49IWVbNl0mJmVbMl07cmV0dXJuIFYuQ0hJTEQudGVzdChlWzBdKT9udWxsOihlWzNdP2VbMl09ZVs0XXx8ZVs1XXx8IiI6biYmWC50ZXN0KG4pJiYodD1hKG4sITApKSYmKHQ9bi5pbmRleE9mKCIpIixuLmxlbmd0aC10KS1uLmxlbmd0aCkmJihlWzBdPWVbMF0uc2xpY2UoMCx0KSxlWzJdPW4uc2xpY2UoMCx0KSksZS5zbGljZSgwLDMpKX19LGZpbHRlcjp7VEFHOmZ1bmN0aW9uKGUpe3ZhciB0PWUucmVwbGFjZShaLGVlKS50b0xvd2VyQ2FzZSgpO3JldHVybiIqIj09PWU/ZnVuY3Rpb24oKXtyZXR1cm4hMH06ZnVuY3Rpb24oZSl7cmV0dXJuIGUubm9kZU5hbWUmJmUubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PXR9fSxDTEFTUzpmdW5jdGlvbihlKXt2YXIgdD1FW2UrIiAiXTtyZXR1cm4gdHx8KHQ9bmV3IFJlZ0V4cCgiKF58IitNKyIpIitlKyIoIitNKyJ8JCkiKSkmJkUoZSxmdW5jdGlvbihlKXtyZXR1cm4gdC50ZXN0KCJzdHJpbmciPT10eXBlb2YgZS5jbGFzc05hbWUmJmUuY2xhc3NOYW1lfHwidW5kZWZpbmVkIiE9dHlwZW9mIGUuZ2V0QXR0cmlidXRlJiZlLmdldEF0dHJpYnV0ZSgiY2xhc3MiKXx8IiIpfSl9LEFUVFI6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBmdW5jdGlvbihyKXt2YXIgaT1vZS5hdHRyKHIsZSk7cmV0dXJuIG51bGw9PWk/IiE9Ij09PXQ6IXR8fChpKz0iIiwiPSI9PT10P2k9PT1uOiIhPSI9PT10P2khPT1uOiJePSI9PT10P24mJjA9PT1pLmluZGV4T2Yobik6Iio9Ij09PXQ/biYmaS5pbmRleE9mKG4pPi0xOiIkPSI9PT10P24mJmkuc2xpY2UoLW4ubGVuZ3RoKT09PW46In49Ij09PXQ/KCIgIitpLnJlcGxhY2UoJCwiICIpKyIgIikuaW5kZXhPZihuKT4tMToifD0iPT09dCYmKGk9PT1ufHxpLnNsaWNlKDAsbi5sZW5ndGgrMSk9PT1uKyItIikpfX0sQ0hJTEQ6ZnVuY3Rpb24oZSx0LG4scixpKXt2YXIgbz0ibnRoIiE9PWUuc2xpY2UoMCwzKSxhPSJsYXN0IiE9PWUuc2xpY2UoLTQpLHM9Im9mLXR5cGUiPT09dDtyZXR1cm4gMT09PXImJjA9PT1pP2Z1bmN0aW9uKGUpe3JldHVybiEhZS5wYXJlbnROb2RlfTpmdW5jdGlvbih0LG4sdSl7dmFyIGwsYyxmLHAsZCxoLGc9byE9PWE/Im5leHRTaWJsaW5nIjoicHJldmlvdXNTaWJsaW5nIix5PXQucGFyZW50Tm9kZSx2PXMmJnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxtPSF1JiYhcyx4PSExO2lmKHkpe2lmKG8pe3doaWxlKGcpe3A9dDt3aGlsZShwPXBbZ10paWYocz9wLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT12OjE9PT1wLm5vZGVUeXBlKXJldHVybiExO2g9Zz0ib25seSI9PT1lJiYhaCYmIm5leHRTaWJsaW5nIn1yZXR1cm4hMH1pZihoPVthP3kuZmlyc3RDaGlsZDp5Lmxhc3RDaGlsZF0sYSYmbSl7eD0oZD0obD0oYz0oZj0ocD15KVtiXXx8KHBbYl09e30pKVtwLnVuaXF1ZUlEXXx8KGZbcC51bmlxdWVJRF09e30pKVtlXXx8W10pWzBdPT09VCYmbFsxXSkmJmxbMl0scD1kJiZ5LmNoaWxkTm9kZXNbZF07d2hpbGUocD0rK2QmJnAmJnBbZ118fCh4PWQ9MCl8fGgucG9wKCkpaWYoMT09PXAubm9kZVR5cGUmJisreCYmcD09PXQpe2NbZV09W1QsZCx4XTticmVha319ZWxzZSBpZihtJiYoeD1kPShsPShjPShmPShwPXQpW2JdfHwocFtiXT17fSkpW3AudW5pcXVlSURdfHwoZltwLnVuaXF1ZUlEXT17fSkpW2VdfHxbXSlbMF09PT1UJiZsWzFdKSwhMT09PXgpd2hpbGUocD0rK2QmJnAmJnBbZ118fCh4PWQ9MCl8fGgucG9wKCkpaWYoKHM/cC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09djoxPT09cC5ub2RlVHlwZSkmJisreCYmKG0mJigoYz0oZj1wW2JdfHwocFtiXT17fSkpW3AudW5pcXVlSURdfHwoZltwLnVuaXF1ZUlEXT17fSkpW2VdPVtULHhdKSxwPT09dCkpYnJlYWs7cmV0dXJuKHgtPWkpPT09cnx8eCVyPT0wJiZ4L3I+PTB9fX0sUFNFVURPOmZ1bmN0aW9uKGUsdCl7dmFyIG4saT1yLnBzZXVkb3NbZV18fHIuc2V0RmlsdGVyc1tlLnRvTG93ZXJDYXNlKCldfHxvZS5lcnJvcigidW5zdXBwb3J0ZWQgcHNldWRvOiAiK2UpO3JldHVybiBpW2JdP2kodCk6aS5sZW5ndGg+MT8obj1bZSxlLCIiLHRdLHIuc2V0RmlsdGVycy5oYXNPd25Qcm9wZXJ0eShlLnRvTG93ZXJDYXNlKCkpP3NlKGZ1bmN0aW9uKGUsbil7dmFyIHIsbz1pKGUsdCksYT1vLmxlbmd0aDt3aGlsZShhLS0pZVtyPU8oZSxvW2FdKV09IShuW3JdPW9bYV0pfSk6ZnVuY3Rpb24oZSl7cmV0dXJuIGkoZSwwLG4pfSk6aX19LHBzZXVkb3M6e25vdDpzZShmdW5jdGlvbihlKXt2YXIgdD1bXSxuPVtdLHI9cyhlLnJlcGxhY2UoQiwiJDEiKSk7cmV0dXJuIHJbYl0/c2UoZnVuY3Rpb24oZSx0LG4saSl7dmFyIG8sYT1yKGUsbnVsbCxpLFtdKSxzPWUubGVuZ3RoO3doaWxlKHMtLSkobz1hW3NdKSYmKGVbc109ISh0W3NdPW8pKX0pOmZ1bmN0aW9uKGUsaSxvKXtyZXR1cm4gdFswXT1lLHIodCxudWxsLG8sbiksdFswXT1udWxsLCFuLnBvcCgpfX0pLGhhczpzZShmdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24odCl7cmV0dXJuIG9lKGUsdCkubGVuZ3RoPjB9fSksY29udGFpbnM6c2UoZnVuY3Rpb24oZSl7cmV0dXJuIGU9ZS5yZXBsYWNlKFosZWUpLGZ1bmN0aW9uKHQpe3JldHVybih0LnRleHRDb250ZW50fHx0LmlubmVyVGV4dHx8aSh0KSkuaW5kZXhPZihlKT4tMX19KSxsYW5nOnNlKGZ1bmN0aW9uKGUpe3JldHVybiBVLnRlc3QoZXx8IiIpfHxvZS5lcnJvcigidW5zdXBwb3J0ZWQgbGFuZzogIitlKSxlPWUucmVwbGFjZShaLGVlKS50b0xvd2VyQ2FzZSgpLGZ1bmN0aW9uKHQpe3ZhciBuO2Rve2lmKG49Zz90Lmxhbmc6dC5nZXRBdHRyaWJ1dGUoInhtbDpsYW5nIil8fHQuZ2V0QXR0cmlidXRlKCJsYW5nIikpcmV0dXJuKG49bi50b0xvd2VyQ2FzZSgpKT09PWV8fDA9PT1uLmluZGV4T2YoZSsiLSIpfXdoaWxlKCh0PXQucGFyZW50Tm9kZSkmJjE9PT10Lm5vZGVUeXBlKTtyZXR1cm4hMX19KSx0YXJnZXQ6ZnVuY3Rpb24odCl7dmFyIG49ZS5sb2NhdGlvbiYmZS5sb2NhdGlvbi5oYXNoO3JldHVybiBuJiZuLnNsaWNlKDEpPT09dC5pZH0scm9vdDpmdW5jdGlvbihlKXtyZXR1cm4gZT09PWh9LGZvY3VzOmZ1bmN0aW9uKGUpe3JldHVybiBlPT09ZC5hY3RpdmVFbGVtZW50JiYoIWQuaGFzRm9jdXN8fGQuaGFzRm9jdXMoKSkmJiEhKGUudHlwZXx8ZS5ocmVmfHx+ZS50YWJJbmRleCl9LGVuYWJsZWQ6ZGUoITEpLGRpc2FibGVkOmRlKCEwKSxjaGVja2VkOmZ1bmN0aW9uKGUpe3ZhciB0PWUubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4iaW5wdXQiPT09dCYmISFlLmNoZWNrZWR8fCJvcHRpb24iPT09dCYmISFlLnNlbGVjdGVkfSxzZWxlY3RlZDpmdW5jdGlvbihlKXtyZXR1cm4gZS5wYXJlbnROb2RlJiZlLnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCwhMD09PWUuc2VsZWN0ZWR9LGVtcHR5OmZ1bmN0aW9uKGUpe2ZvcihlPWUuZmlyc3RDaGlsZDtlO2U9ZS5uZXh0U2libGluZylpZihlLm5vZGVUeXBlPDYpcmV0dXJuITE7cmV0dXJuITB9LHBhcmVudDpmdW5jdGlvbihlKXtyZXR1cm4hci5wc2V1ZG9zLmVtcHR5KGUpfSxoZWFkZXI6ZnVuY3Rpb24oZSl7cmV0dXJuIFkudGVzdChlLm5vZGVOYW1lKX0saW5wdXQ6ZnVuY3Rpb24oZSl7cmV0dXJuIEcudGVzdChlLm5vZGVOYW1lKX0sYnV0dG9uOmZ1bmN0aW9uKGUpe3ZhciB0PWUubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4iaW5wdXQiPT09dCYmImJ1dHRvbiI9PT1lLnR5cGV8fCJidXR0b24iPT09dH0sdGV4dDpmdW5jdGlvbihlKXt2YXIgdDtyZXR1cm4iaW5wdXQiPT09ZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpJiYidGV4dCI9PT1lLnR5cGUmJihudWxsPT0odD1lLmdldEF0dHJpYnV0ZSgidHlwZSIpKXx8InRleHQiPT09dC50b0xvd2VyQ2FzZSgpKX0sZmlyc3Q6aGUoZnVuY3Rpb24oKXtyZXR1cm5bMF19KSxsYXN0OmhlKGZ1bmN0aW9uKGUsdCl7cmV0dXJuW3QtMV19KSxlcTpoZShmdW5jdGlvbihlLHQsbil7cmV0dXJuW248MD9uK3Q6bl19KSxldmVuOmhlKGZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPTA7bjx0O24rPTIpZS5wdXNoKG4pO3JldHVybiBlfSksb2RkOmhlKGZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPTE7bjx0O24rPTIpZS5wdXNoKG4pO3JldHVybiBlfSksbHQ6aGUoZnVuY3Rpb24oZSx0LG4pe2Zvcih2YXIgcj1uPDA/bit0Om47LS1yPj0wOyllLnB1c2gocik7cmV0dXJuIGV9KSxndDpoZShmdW5jdGlvbihlLHQsbil7Zm9yKHZhciByPW48MD9uK3Q6bjsrK3I8dDspZS5wdXNoKHIpO3JldHVybiBlfSl9fSkucHNldWRvcy5udGg9ci5wc2V1ZG9zLmVxO2Zvcih0IGlue3JhZGlvOiEwLGNoZWNrYm94OiEwLGZpbGU6ITAscGFzc3dvcmQ6ITAsaW1hZ2U6ITB9KXIucHNldWRvc1t0XT1mZSh0KTtmb3IodCBpbntzdWJtaXQ6ITAscmVzZXQ6ITB9KXIucHNldWRvc1t0XT1wZSh0KTtmdW5jdGlvbiB5ZSgpe315ZS5wcm90b3R5cGU9ci5maWx0ZXJzPXIucHNldWRvcyxyLnNldEZpbHRlcnM9bmV3IHllLGE9b2UudG9rZW5pemU9ZnVuY3Rpb24oZSx0KXt2YXIgbixpLG8sYSxzLHUsbCxjPWtbZSsiICJdO2lmKGMpcmV0dXJuIHQ/MDpjLnNsaWNlKDApO3M9ZSx1PVtdLGw9ci5wcmVGaWx0ZXI7d2hpbGUocyl7biYmIShpPUYuZXhlYyhzKSl8fChpJiYocz1zLnNsaWNlKGlbMF0ubGVuZ3RoKXx8cyksdS5wdXNoKG89W10pKSxuPSExLChpPV8uZXhlYyhzKSkmJihuPWkuc2hpZnQoKSxvLnB1c2goe3ZhbHVlOm4sdHlwZTppWzBdLnJlcGxhY2UoQiwiICIpfSkscz1zLnNsaWNlKG4ubGVuZ3RoKSk7Zm9yKGEgaW4gci5maWx0ZXIpIShpPVZbYV0uZXhlYyhzKSl8fGxbYV0mJiEoaT1sW2FdKGkpKXx8KG49aS5zaGlmdCgpLG8ucHVzaCh7dmFsdWU6bix0eXBlOmEsbWF0Y2hlczppfSkscz1zLnNsaWNlKG4ubGVuZ3RoKSk7aWYoIW4pYnJlYWt9cmV0dXJuIHQ/cy5sZW5ndGg6cz9vZS5lcnJvcihlKTprKGUsdSkuc2xpY2UoMCl9O2Z1bmN0aW9uIHZlKGUpe2Zvcih2YXIgdD0wLG49ZS5sZW5ndGgscj0iIjt0PG47dCsrKXIrPWVbdF0udmFsdWU7cmV0dXJuIHJ9ZnVuY3Rpb24gbWUoZSx0LG4pe3ZhciByPXQuZGlyLGk9dC5uZXh0LG89aXx8cixhPW4mJiJwYXJlbnROb2RlIj09PW8scz1DKys7cmV0dXJuIHQuZmlyc3Q/ZnVuY3Rpb24odCxuLGkpe3doaWxlKHQ9dFtyXSlpZigxPT09dC5ub2RlVHlwZXx8YSlyZXR1cm4gZSh0LG4saSk7cmV0dXJuITF9OmZ1bmN0aW9uKHQsbix1KXt2YXIgbCxjLGYscD1bVCxzXTtpZih1KXt3aGlsZSh0PXRbcl0paWYoKDE9PT10Lm5vZGVUeXBlfHxhKSYmZSh0LG4sdSkpcmV0dXJuITB9ZWxzZSB3aGlsZSh0PXRbcl0paWYoMT09PXQubm9kZVR5cGV8fGEpaWYoZj10W2JdfHwodFtiXT17fSksYz1mW3QudW5pcXVlSURdfHwoZlt0LnVuaXF1ZUlEXT17fSksaSYmaT09PXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSl0PXRbcl18fHQ7ZWxzZXtpZigobD1jW29dKSYmbFswXT09PVQmJmxbMV09PT1zKXJldHVybiBwWzJdPWxbMl07aWYoY1tvXT1wLHBbMl09ZSh0LG4sdSkpcmV0dXJuITB9cmV0dXJuITF9fWZ1bmN0aW9uIHhlKGUpe3JldHVybiBlLmxlbmd0aD4xP2Z1bmN0aW9uKHQsbixyKXt2YXIgaT1lLmxlbmd0aDt3aGlsZShpLS0paWYoIWVbaV0odCxuLHIpKXJldHVybiExO3JldHVybiEwfTplWzBdfWZ1bmN0aW9uIGJlKGUsdCxuKXtmb3IodmFyIHI9MCxpPXQubGVuZ3RoO3I8aTtyKyspb2UoZSx0W3JdLG4pO3JldHVybiBufWZ1bmN0aW9uIHdlKGUsdCxuLHIsaSl7Zm9yKHZhciBvLGE9W10scz0wLHU9ZS5sZW5ndGgsbD1udWxsIT10O3M8dTtzKyspKG89ZVtzXSkmJihuJiYhbihvLHIsaSl8fChhLnB1c2gobyksbCYmdC5wdXNoKHMpKSk7cmV0dXJuIGF9ZnVuY3Rpb24gVGUoZSx0LG4scixpLG8pe3JldHVybiByJiYhcltiXSYmKHI9VGUocikpLGkmJiFpW2JdJiYoaT1UZShpLG8pKSxzZShmdW5jdGlvbihvLGEscyx1KXt2YXIgbCxjLGYscD1bXSxkPVtdLGg9YS5sZW5ndGgsZz1vfHxiZSh0fHwiKiIscy5ub2RlVHlwZT9bc106cyxbXSkseT0hZXx8IW8mJnQ/Zzp3ZShnLHAsZSxzLHUpLHY9bj9pfHwobz9lOmh8fHIpP1tdOmE6eTtpZihuJiZuKHksdixzLHUpLHIpe2w9d2UodixkKSxyKGwsW10scyx1KSxjPWwubGVuZ3RoO3doaWxlKGMtLSkoZj1sW2NdKSYmKHZbZFtjXV09ISh5W2RbY11dPWYpKX1pZihvKXtpZihpfHxlKXtpZihpKXtsPVtdLGM9di5sZW5ndGg7d2hpbGUoYy0tKShmPXZbY10pJiZsLnB1c2goeVtjXT1mKTtpKG51bGwsdj1bXSxsLHUpfWM9di5sZW5ndGg7d2hpbGUoYy0tKShmPXZbY10pJiYobD1pP08obyxmKTpwW2NdKT4tMSYmKG9bbF09IShhW2xdPWYpKX19ZWxzZSB2PXdlKHY9PT1hP3Yuc3BsaWNlKGgsdi5sZW5ndGgpOnYpLGk/aShudWxsLGEsdix1KTpMLmFwcGx5KGEsdil9KX1mdW5jdGlvbiBDZShlKXtmb3IodmFyIHQsbixpLG89ZS5sZW5ndGgsYT1yLnJlbGF0aXZlW2VbMF0udHlwZV0scz1hfHxyLnJlbGF0aXZlWyIgIl0sdT1hPzE6MCxjPW1lKGZ1bmN0aW9uKGUpe3JldHVybiBlPT09dH0scywhMCksZj1tZShmdW5jdGlvbihlKXtyZXR1cm4gTyh0LGUpPi0xfSxzLCEwKSxwPVtmdW5jdGlvbihlLG4scil7dmFyIGk9IWEmJihyfHxuIT09bCl8fCgodD1uKS5ub2RlVHlwZT9jKGUsbixyKTpmKGUsbixyKSk7cmV0dXJuIHQ9bnVsbCxpfV07dTxvO3UrKylpZihuPXIucmVsYXRpdmVbZVt1XS50eXBlXSlwPVttZSh4ZShwKSxuKV07ZWxzZXtpZigobj1yLmZpbHRlcltlW3VdLnR5cGVdLmFwcGx5KG51bGwsZVt1XS5tYXRjaGVzKSlbYl0pe2ZvcihpPSsrdTtpPG87aSsrKWlmKHIucmVsYXRpdmVbZVtpXS50eXBlXSlicmVhaztyZXR1cm4gVGUodT4xJiZ4ZShwKSx1PjEmJnZlKGUuc2xpY2UoMCx1LTEpLmNvbmNhdCh7dmFsdWU6IiAiPT09ZVt1LTJdLnR5cGU/IioiOiIifSkpLnJlcGxhY2UoQiwiJDEiKSxuLHU8aSYmQ2UoZS5zbGljZSh1LGkpKSxpPG8mJkNlKGU9ZS5zbGljZShpKSksaTxvJiZ2ZShlKSl9cC5wdXNoKG4pfXJldHVybiB4ZShwKX1mdW5jdGlvbiBFZShlLHQpe3ZhciBuPXQubGVuZ3RoPjAsaT1lLmxlbmd0aD4wLG89ZnVuY3Rpb24obyxhLHMsdSxjKXt2YXIgZixoLHksdj0wLG09IjAiLHg9byYmW10sYj1bXSx3PWwsQz1vfHxpJiZyLmZpbmQuVEFHKCIqIixjKSxFPVQrPW51bGw9PXc/MTpNYXRoLnJhbmRvbSgpfHwuMSxrPUMubGVuZ3RoO2ZvcihjJiYobD1hPT09ZHx8YXx8Yyk7bSE9PWsmJm51bGwhPShmPUNbbV0pO20rKyl7aWYoaSYmZil7aD0wLGF8fGYub3duZXJEb2N1bWVudD09PWR8fChwKGYpLHM9IWcpO3doaWxlKHk9ZVtoKytdKWlmKHkoZixhfHxkLHMpKXt1LnB1c2goZik7YnJlYWt9YyYmKFQ9RSl9biYmKChmPSF5JiZmKSYmdi0tLG8mJngucHVzaChmKSl9aWYodis9bSxuJiZtIT09dil7aD0wO3doaWxlKHk9dFtoKytdKXkoeCxiLGEscyk7aWYobyl7aWYodj4wKXdoaWxlKG0tLSl4W21dfHxiW21dfHwoYlttXT1qLmNhbGwodSkpO2I9d2UoYil9TC5hcHBseSh1LGIpLGMmJiFvJiZiLmxlbmd0aD4wJiZ2K3QubGVuZ3RoPjEmJm9lLnVuaXF1ZVNvcnQodSl9cmV0dXJuIGMmJihUPUUsbD13KSx4fTtyZXR1cm4gbj9zZShvKTpvfXJldHVybiBzPW9lLmNvbXBpbGU9ZnVuY3Rpb24oZSx0KXt2YXIgbixyPVtdLGk9W10sbz1TW2UrIiAiXTtpZighbyl7dHx8KHQ9YShlKSksbj10Lmxlbmd0aDt3aGlsZShuLS0pKG89Q2UodFtuXSkpW2JdP3IucHVzaChvKTppLnB1c2gobyk7KG89UyhlLEVlKGkscikpKS5zZWxlY3Rvcj1lfXJldHVybiBvfSx1PW9lLnNlbGVjdD1mdW5jdGlvbihlLHQsbixpKXt2YXIgbyx1LGwsYyxmLHA9ImZ1bmN0aW9uIj09dHlwZW9mIGUmJmUsZD0haSYmYShlPXAuc2VsZWN0b3J8fGUpO2lmKG49bnx8W10sMT09PWQubGVuZ3RoKXtpZigodT1kWzBdPWRbMF0uc2xpY2UoMCkpLmxlbmd0aD4yJiYiSUQiPT09KGw9dVswXSkudHlwZSYmOT09PXQubm9kZVR5cGUmJmcmJnIucmVsYXRpdmVbdVsxXS50eXBlXSl7aWYoISh0PShyLmZpbmQuSUQobC5tYXRjaGVzWzBdLnJlcGxhY2UoWixlZSksdCl8fFtdKVswXSkpcmV0dXJuIG47cCYmKHQ9dC5wYXJlbnROb2RlKSxlPWUuc2xpY2UodS5zaGlmdCgpLnZhbHVlLmxlbmd0aCl9bz1WLm5lZWRzQ29udGV4dC50ZXN0KGUpPzA6dS5sZW5ndGg7d2hpbGUoby0tKXtpZihsPXVbb10sci5yZWxhdGl2ZVtjPWwudHlwZV0pYnJlYWs7aWYoKGY9ci5maW5kW2NdKSYmKGk9ZihsLm1hdGNoZXNbMF0ucmVwbGFjZShaLGVlKSxLLnRlc3QodVswXS50eXBlKSYmZ2UodC5wYXJlbnROb2RlKXx8dCkpKXtpZih1LnNwbGljZShvLDEpLCEoZT1pLmxlbmd0aCYmdmUodSkpKXJldHVybiBMLmFwcGx5KG4saSksbjticmVha319fXJldHVybihwfHxzKGUsZCkpKGksdCwhZyxuLCF0fHxLLnRlc3QoZSkmJmdlKHQucGFyZW50Tm9kZSl8fHQpLG59LG4uc29ydFN0YWJsZT1iLnNwbGl0KCIiKS5zb3J0KEQpLmpvaW4oIiIpPT09YixuLmRldGVjdER1cGxpY2F0ZXM9ISFmLHAoKSxuLnNvcnREZXRhY2hlZD11ZShmdW5jdGlvbihlKXtyZXR1cm4gMSZlLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGQuY3JlYXRlRWxlbWVudCgiZmllbGRzZXQiKSl9KSx1ZShmdW5jdGlvbihlKXtyZXR1cm4gZS5pbm5lckhUTUw9IjxhIGhyZWY9JyMnPjwvYT4iLCIjIj09PWUuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoImhyZWYiKX0pfHxsZSgidHlwZXxocmVmfGhlaWdodHx3aWR0aCIsZnVuY3Rpb24oZSx0LG4pe2lmKCFuKXJldHVybiBlLmdldEF0dHJpYnV0ZSh0LCJ0eXBlIj09PXQudG9Mb3dlckNhc2UoKT8xOjIpfSksbi5hdHRyaWJ1dGVzJiZ1ZShmdW5jdGlvbihlKXtyZXR1cm4gZS5pbm5lckhUTUw9IjxpbnB1dC8+IixlLmZpcnN0Q2hpbGQuc2V0QXR0cmlidXRlKCJ2YWx1ZSIsIiIpLCIiPT09ZS5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSgidmFsdWUiKX0pfHxsZSgidmFsdWUiLGZ1bmN0aW9uKGUsdCxuKXtpZighbiYmImlucHV0Ij09PWUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSlyZXR1cm4gZS5kZWZhdWx0VmFsdWV9KSx1ZShmdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09ZS5nZXRBdHRyaWJ1dGUoImRpc2FibGVkIil9KXx8bGUoUCxmdW5jdGlvbihlLHQsbil7dmFyIHI7aWYoIW4pcmV0dXJuITA9PT1lW3RdP3QudG9Mb3dlckNhc2UoKToocj1lLmdldEF0dHJpYnV0ZU5vZGUodCkpJiZyLnNwZWNpZmllZD9yLnZhbHVlOm51bGx9KSxvZX0oZSk7dy5maW5kPUUsdy5leHByPUUuc2VsZWN0b3JzLHcuZXhwclsiOiJdPXcuZXhwci5wc2V1ZG9zLHcudW5pcXVlU29ydD13LnVuaXF1ZT1FLnVuaXF1ZVNvcnQsdy50ZXh0PUUuZ2V0VGV4dCx3LmlzWE1MRG9jPUUuaXNYTUwsdy5jb250YWlucz1FLmNvbnRhaW5zLHcuZXNjYXBlU2VsZWN0b3I9RS5lc2NhcGU7dmFyIGs9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPVtdLGk9dm9pZCAwIT09bjt3aGlsZSgoZT1lW3RdKSYmOSE9PWUubm9kZVR5cGUpaWYoMT09PWUubm9kZVR5cGUpe2lmKGkmJncoZSkuaXMobikpYnJlYWs7ci5wdXNoKGUpfXJldHVybiByfSxTPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPVtdO2U7ZT1lLm5leHRTaWJsaW5nKTE9PT1lLm5vZGVUeXBlJiZlIT09dCYmbi5wdXNoKGUpO3JldHVybiBufSxEPXcuZXhwci5tYXRjaC5uZWVkc0NvbnRleHQ7ZnVuY3Rpb24gTihlLHQpe3JldHVybiBlLm5vZGVOYW1lJiZlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT10LnRvTG93ZXJDYXNlKCl9dmFyIEE9L148KFthLXpdW15cL1wwPjpceDIwXHRcclxuXGZdKilbXHgyMFx0XHJcblxmXSpcLz8+KD86PFwvXDE+fCkkL2k7ZnVuY3Rpb24gaihlLHQsbil7cmV0dXJuIGcodCk/dy5ncmVwKGUsZnVuY3Rpb24oZSxyKXtyZXR1cm4hIXQuY2FsbChlLHIsZSkhPT1ufSk6dC5ub2RlVHlwZT93LmdyZXAoZSxmdW5jdGlvbihlKXtyZXR1cm4gZT09PXQhPT1ufSk6InN0cmluZyIhPXR5cGVvZiB0P3cuZ3JlcChlLGZ1bmN0aW9uKGUpe3JldHVybiB1LmNhbGwodCxlKT4tMSE9PW59KTp3LmZpbHRlcih0LGUsbil9dy5maWx0ZXI9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPXRbMF07cmV0dXJuIG4mJihlPSI6bm90KCIrZSsiKSIpLDE9PT10Lmxlbmd0aCYmMT09PXIubm9kZVR5cGU/dy5maW5kLm1hdGNoZXNTZWxlY3RvcihyLGUpP1tyXTpbXTp3LmZpbmQubWF0Y2hlcyhlLHcuZ3JlcCh0LGZ1bmN0aW9uKGUpe3JldHVybiAxPT09ZS5ub2RlVHlwZX0pKX0sdy5mbi5leHRlbmQoe2ZpbmQ6ZnVuY3Rpb24oZSl7dmFyIHQsbixyPXRoaXMubGVuZ3RoLGk9dGhpcztpZigic3RyaW5nIiE9dHlwZW9mIGUpcmV0dXJuIHRoaXMucHVzaFN0YWNrKHcoZSkuZmlsdGVyKGZ1bmN0aW9uKCl7Zm9yKHQ9MDt0PHI7dCsrKWlmKHcuY29udGFpbnMoaVt0XSx0aGlzKSlyZXR1cm4hMH0pKTtmb3Iobj10aGlzLnB1c2hTdGFjayhbXSksdD0wO3Q8cjt0Kyspdy5maW5kKGUsaVt0XSxuKTtyZXR1cm4gcj4xP3cudW5pcXVlU29ydChuKTpufSxmaWx0ZXI6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGoodGhpcyxlfHxbXSwhMSkpfSxub3Q6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGoodGhpcyxlfHxbXSwhMCkpfSxpczpmdW5jdGlvbihlKXtyZXR1cm4hIWoodGhpcywic3RyaW5nIj09dHlwZW9mIGUmJkQudGVzdChlKT93KGUpOmV8fFtdLCExKS5sZW5ndGh9fSk7dmFyIHEsTD0vXig/OlxzKig8W1x3XFddKz4pW14+XSp8IyhbXHctXSspKSQvOyh3LmZuLmluaXQ9ZnVuY3Rpb24oZSx0LG4pe3ZhciBpLG87aWYoIWUpcmV0dXJuIHRoaXM7aWYobj1ufHxxLCJzdHJpbmciPT10eXBlb2YgZSl7aWYoIShpPSI8Ij09PWVbMF0mJiI+Ij09PWVbZS5sZW5ndGgtMV0mJmUubGVuZ3RoPj0zP1tudWxsLGUsbnVsbF06TC5leGVjKGUpKXx8IWlbMV0mJnQpcmV0dXJuIXR8fHQuanF1ZXJ5Pyh0fHxuKS5maW5kKGUpOnRoaXMuY29uc3RydWN0b3IodCkuZmluZChlKTtpZihpWzFdKXtpZih0PXQgaW5zdGFuY2VvZiB3P3RbMF06dCx3Lm1lcmdlKHRoaXMsdy5wYXJzZUhUTUwoaVsxXSx0JiZ0Lm5vZGVUeXBlP3Qub3duZXJEb2N1bWVudHx8dDpyLCEwKSksQS50ZXN0KGlbMV0pJiZ3LmlzUGxhaW5PYmplY3QodCkpZm9yKGkgaW4gdClnKHRoaXNbaV0pP3RoaXNbaV0odFtpXSk6dGhpcy5hdHRyKGksdFtpXSk7cmV0dXJuIHRoaXN9cmV0dXJuKG89ci5nZXRFbGVtZW50QnlJZChpWzJdKSkmJih0aGlzWzBdPW8sdGhpcy5sZW5ndGg9MSksdGhpc31yZXR1cm4gZS5ub2RlVHlwZT8odGhpc1swXT1lLHRoaXMubGVuZ3RoPTEsdGhpcyk6ZyhlKT92b2lkIDAhPT1uLnJlYWR5P24ucmVhZHkoZSk6ZSh3KTp3Lm1ha2VBcnJheShlLHRoaXMpfSkucHJvdG90eXBlPXcuZm4scT13KHIpO3ZhciBIPS9eKD86cGFyZW50c3xwcmV2KD86VW50aWx8QWxsKSkvLE89e2NoaWxkcmVuOiEwLGNvbnRlbnRzOiEwLG5leHQ6ITAscHJldjohMH07dy5mbi5leHRlbmQoe2hhczpmdW5jdGlvbihlKXt2YXIgdD13KGUsdGhpcyksbj10Lmxlbmd0aDtyZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24oKXtmb3IodmFyIGU9MDtlPG47ZSsrKWlmKHcuY29udGFpbnModGhpcyx0W2VdKSlyZXR1cm4hMH0pfSxjbG9zZXN0OmZ1bmN0aW9uKGUsdCl7dmFyIG4scj0wLGk9dGhpcy5sZW5ndGgsbz1bXSxhPSJzdHJpbmciIT10eXBlb2YgZSYmdyhlKTtpZighRC50ZXN0KGUpKWZvcig7cjxpO3IrKylmb3Iobj10aGlzW3JdO24mJm4hPT10O249bi5wYXJlbnROb2RlKWlmKG4ubm9kZVR5cGU8MTEmJihhP2EuaW5kZXgobik+LTE6MT09PW4ubm9kZVR5cGUmJncuZmluZC5tYXRjaGVzU2VsZWN0b3IobixlKSkpe28ucHVzaChuKTticmVha31yZXR1cm4gdGhpcy5wdXNoU3RhY2soby5sZW5ndGg+MT93LnVuaXF1ZVNvcnQobyk6byl9LGluZGV4OmZ1bmN0aW9uKGUpe3JldHVybiBlPyJzdHJpbmciPT10eXBlb2YgZT91LmNhbGwodyhlKSx0aGlzWzBdKTp1LmNhbGwodGhpcyxlLmpxdWVyeT9lWzBdOmUpOnRoaXNbMF0mJnRoaXNbMF0ucGFyZW50Tm9kZT90aGlzLmZpcnN0KCkucHJldkFsbCgpLmxlbmd0aDotMX0sYWRkOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKHcudW5pcXVlU29ydCh3Lm1lcmdlKHRoaXMuZ2V0KCksdyhlLHQpKSkpfSxhZGRCYWNrOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmFkZChudWxsPT1lP3RoaXMucHJldk9iamVjdDp0aGlzLnByZXZPYmplY3QuZmlsdGVyKGUpKX19KTtmdW5jdGlvbiBQKGUsdCl7d2hpbGUoKGU9ZVt0XSkmJjEhPT1lLm5vZGVUeXBlKTtyZXR1cm4gZX13LmVhY2goe3BhcmVudDpmdW5jdGlvbihlKXt2YXIgdD1lLnBhcmVudE5vZGU7cmV0dXJuIHQmJjExIT09dC5ub2RlVHlwZT90Om51bGx9LHBhcmVudHM6ZnVuY3Rpb24oZSl7cmV0dXJuIGsoZSwicGFyZW50Tm9kZSIpfSxwYXJlbnRzVW50aWw6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBrKGUsInBhcmVudE5vZGUiLG4pfSxuZXh0OmZ1bmN0aW9uKGUpe3JldHVybiBQKGUsIm5leHRTaWJsaW5nIil9LHByZXY6ZnVuY3Rpb24oZSl7cmV0dXJuIFAoZSwicHJldmlvdXNTaWJsaW5nIil9LG5leHRBbGw6ZnVuY3Rpb24oZSl7cmV0dXJuIGsoZSwibmV4dFNpYmxpbmciKX0scHJldkFsbDpmdW5jdGlvbihlKXtyZXR1cm4gayhlLCJwcmV2aW91c1NpYmxpbmciKX0sbmV4dFVudGlsOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gayhlLCJuZXh0U2libGluZyIsbil9LHByZXZVbnRpbDpmdW5jdGlvbihlLHQsbil7cmV0dXJuIGsoZSwicHJldmlvdXNTaWJsaW5nIixuKX0sc2libGluZ3M6ZnVuY3Rpb24oZSl7cmV0dXJuIFMoKGUucGFyZW50Tm9kZXx8e30pLmZpcnN0Q2hpbGQsZSl9LGNoaWxkcmVuOmZ1bmN0aW9uKGUpe3JldHVybiBTKGUuZmlyc3RDaGlsZCl9LGNvbnRlbnRzOmZ1bmN0aW9uKGUpe3JldHVybiBOKGUsImlmcmFtZSIpP2UuY29udGVudERvY3VtZW50OihOKGUsInRlbXBsYXRlIikmJihlPWUuY29udGVudHx8ZSksdy5tZXJnZShbXSxlLmNoaWxkTm9kZXMpKX19LGZ1bmN0aW9uKGUsdCl7dy5mbltlXT1mdW5jdGlvbihuLHIpe3ZhciBpPXcubWFwKHRoaXMsdCxuKTtyZXR1cm4iVW50aWwiIT09ZS5zbGljZSgtNSkmJihyPW4pLHImJiJzdHJpbmciPT10eXBlb2YgciYmKGk9dy5maWx0ZXIocixpKSksdGhpcy5sZW5ndGg+MSYmKE9bZV18fHcudW5pcXVlU29ydChpKSxILnRlc3QoZSkmJmkucmV2ZXJzZSgpKSx0aGlzLnB1c2hTdGFjayhpKX19KTt2YXIgTT0vW15ceDIwXHRcclxuXGZdKy9nO2Z1bmN0aW9uIFIoZSl7dmFyIHQ9e307cmV0dXJuIHcuZWFjaChlLm1hdGNoKE0pfHxbXSxmdW5jdGlvbihlLG4pe3Rbbl09ITB9KSx0fXcuQ2FsbGJhY2tzPWZ1bmN0aW9uKGUpe2U9InN0cmluZyI9PXR5cGVvZiBlP1IoZSk6dy5leHRlbmQoe30sZSk7dmFyIHQsbixyLGksbz1bXSxhPVtdLHM9LTEsdT1mdW5jdGlvbigpe2ZvcihpPWl8fGUub25jZSxyPXQ9ITA7YS5sZW5ndGg7cz0tMSl7bj1hLnNoaWZ0KCk7d2hpbGUoKytzPG8ubGVuZ3RoKSExPT09b1tzXS5hcHBseShuWzBdLG5bMV0pJiZlLnN0b3BPbkZhbHNlJiYocz1vLmxlbmd0aCxuPSExKX1lLm1lbW9yeXx8KG49ITEpLHQ9ITEsaSYmKG89bj9bXToiIil9LGw9e2FkZDpmdW5jdGlvbigpe3JldHVybiBvJiYobiYmIXQmJihzPW8ubGVuZ3RoLTEsYS5wdXNoKG4pKSxmdW5jdGlvbiB0KG4pe3cuZWFjaChuLGZ1bmN0aW9uKG4scil7ZyhyKT9lLnVuaXF1ZSYmbC5oYXMocil8fG8ucHVzaChyKTpyJiZyLmxlbmd0aCYmInN0cmluZyIhPT14KHIpJiZ0KHIpfSl9KGFyZ3VtZW50cyksbiYmIXQmJnUoKSksdGhpc30scmVtb3ZlOmZ1bmN0aW9uKCl7cmV0dXJuIHcuZWFjaChhcmd1bWVudHMsZnVuY3Rpb24oZSx0KXt2YXIgbjt3aGlsZSgobj13LmluQXJyYXkodCxvLG4pKT4tMSlvLnNwbGljZShuLDEpLG48PXMmJnMtLX0pLHRoaXN9LGhhczpmdW5jdGlvbihlKXtyZXR1cm4gZT93LmluQXJyYXkoZSxvKT4tMTpvLmxlbmd0aD4wfSxlbXB0eTpmdW5jdGlvbigpe3JldHVybiBvJiYobz1bXSksdGhpc30sZGlzYWJsZTpmdW5jdGlvbigpe3JldHVybiBpPWE9W10sbz1uPSIiLHRoaXN9LGRpc2FibGVkOmZ1bmN0aW9uKCl7cmV0dXJuIW99LGxvY2s6ZnVuY3Rpb24oKXtyZXR1cm4gaT1hPVtdLG58fHR8fChvPW49IiIpLHRoaXN9LGxvY2tlZDpmdW5jdGlvbigpe3JldHVybiEhaX0sZmlyZVdpdGg6ZnVuY3Rpb24oZSxuKXtyZXR1cm4gaXx8KG49W2UsKG49bnx8W10pLnNsaWNlP24uc2xpY2UoKTpuXSxhLnB1c2gobiksdHx8dSgpKSx0aGlzfSxmaXJlOmZ1bmN0aW9uKCl7cmV0dXJuIGwuZmlyZVdpdGgodGhpcyxhcmd1bWVudHMpLHRoaXN9LGZpcmVkOmZ1bmN0aW9uKCl7cmV0dXJuISFyfX07cmV0dXJuIGx9O2Z1bmN0aW9uIEkoZSl7cmV0dXJuIGV9ZnVuY3Rpb24gVyhlKXt0aHJvdyBlfWZ1bmN0aW9uICQoZSx0LG4scil7dmFyIGk7dHJ5e2UmJmcoaT1lLnByb21pc2UpP2kuY2FsbChlKS5kb25lKHQpLmZhaWwobik6ZSYmZyhpPWUudGhlbik/aS5jYWxsKGUsdCxuKTp0LmFwcGx5KHZvaWQgMCxbZV0uc2xpY2UocikpfWNhdGNoKGUpe24uYXBwbHkodm9pZCAwLFtlXSl9fXcuZXh0ZW5kKHtEZWZlcnJlZDpmdW5jdGlvbih0KXt2YXIgbj1bWyJub3RpZnkiLCJwcm9ncmVzcyIsdy5DYWxsYmFja3MoIm1lbW9yeSIpLHcuQ2FsbGJhY2tzKCJtZW1vcnkiKSwyXSxbInJlc29sdmUiLCJkb25lIix3LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSx3LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwwLCJyZXNvbHZlZCJdLFsicmVqZWN0IiwiZmFpbCIsdy5DYWxsYmFja3MoIm9uY2UgbWVtb3J5Iiksdy5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IiksMSwicmVqZWN0ZWQiXV0scj0icGVuZGluZyIsaT17c3RhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gcn0sYWx3YXlzOmZ1bmN0aW9uKCl7cmV0dXJuIG8uZG9uZShhcmd1bWVudHMpLmZhaWwoYXJndW1lbnRzKSx0aGlzfSwiY2F0Y2giOmZ1bmN0aW9uKGUpe3JldHVybiBpLnRoZW4obnVsbCxlKX0scGlwZTpmdW5jdGlvbigpe3ZhciBlPWFyZ3VtZW50cztyZXR1cm4gdy5EZWZlcnJlZChmdW5jdGlvbih0KXt3LmVhY2gobixmdW5jdGlvbihuLHIpe3ZhciBpPWcoZVtyWzRdXSkmJmVbcls0XV07b1tyWzFdXShmdW5jdGlvbigpe3ZhciBlPWkmJmkuYXBwbHkodGhpcyxhcmd1bWVudHMpO2UmJmcoZS5wcm9taXNlKT9lLnByb21pc2UoKS5wcm9ncmVzcyh0Lm5vdGlmeSkuZG9uZSh0LnJlc29sdmUpLmZhaWwodC5yZWplY3QpOnRbclswXSsiV2l0aCJdKHRoaXMsaT9bZV06YXJndW1lbnRzKX0pfSksZT1udWxsfSkucHJvbWlzZSgpfSx0aGVuOmZ1bmN0aW9uKHQscixpKXt2YXIgbz0wO2Z1bmN0aW9uIGEodCxuLHIsaSl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIHM9dGhpcyx1PWFyZ3VtZW50cyxsPWZ1bmN0aW9uKCl7dmFyIGUsbDtpZighKHQ8bykpe2lmKChlPXIuYXBwbHkocyx1KSk9PT1uLnByb21pc2UoKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJUaGVuYWJsZSBzZWxmLXJlc29sdXRpb24iKTtsPWUmJigib2JqZWN0Ij09dHlwZW9mIGV8fCJmdW5jdGlvbiI9PXR5cGVvZiBlKSYmZS50aGVuLGcobCk/aT9sLmNhbGwoZSxhKG8sbixJLGkpLGEobyxuLFcsaSkpOihvKyssbC5jYWxsKGUsYShvLG4sSSxpKSxhKG8sbixXLGkpLGEobyxuLEksbi5ub3RpZnlXaXRoKSkpOihyIT09SSYmKHM9dm9pZCAwLHU9W2VdKSwoaXx8bi5yZXNvbHZlV2l0aCkocyx1KSl9fSxjPWk/bDpmdW5jdGlvbigpe3RyeXtsKCl9Y2F0Y2goZSl7dy5EZWZlcnJlZC5leGNlcHRpb25Ib29rJiZ3LkRlZmVycmVkLmV4Y2VwdGlvbkhvb2soZSxjLnN0YWNrVHJhY2UpLHQrMT49byYmKHIhPT1XJiYocz12b2lkIDAsdT1bZV0pLG4ucmVqZWN0V2l0aChzLHUpKX19O3Q/YygpOih3LkRlZmVycmVkLmdldFN0YWNrSG9vayYmKGMuc3RhY2tUcmFjZT13LkRlZmVycmVkLmdldFN0YWNrSG9vaygpKSxlLnNldFRpbWVvdXQoYykpfX1yZXR1cm4gdy5EZWZlcnJlZChmdW5jdGlvbihlKXtuWzBdWzNdLmFkZChhKDAsZSxnKGkpP2k6SSxlLm5vdGlmeVdpdGgpKSxuWzFdWzNdLmFkZChhKDAsZSxnKHQpP3Q6SSkpLG5bMl1bM10uYWRkKGEoMCxlLGcocik/cjpXKSl9KS5wcm9taXNlKCl9LHByb21pc2U6ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPWU/dy5leHRlbmQoZSxpKTppfX0sbz17fTtyZXR1cm4gdy5lYWNoKG4sZnVuY3Rpb24oZSx0KXt2YXIgYT10WzJdLHM9dFs1XTtpW3RbMV1dPWEuYWRkLHMmJmEuYWRkKGZ1bmN0aW9uKCl7cj1zfSxuWzMtZV1bMl0uZGlzYWJsZSxuWzMtZV1bM10uZGlzYWJsZSxuWzBdWzJdLmxvY2ssblswXVszXS5sb2NrKSxhLmFkZCh0WzNdLmZpcmUpLG9bdFswXV09ZnVuY3Rpb24oKXtyZXR1cm4gb1t0WzBdKyJXaXRoIl0odGhpcz09PW8/dm9pZCAwOnRoaXMsYXJndW1lbnRzKSx0aGlzfSxvW3RbMF0rIldpdGgiXT1hLmZpcmVXaXRofSksaS5wcm9taXNlKG8pLHQmJnQuY2FsbChvLG8pLG99LHdoZW46ZnVuY3Rpb24oZSl7dmFyIHQ9YXJndW1lbnRzLmxlbmd0aCxuPXQscj1BcnJheShuKSxpPW8uY2FsbChhcmd1bWVudHMpLGE9dy5EZWZlcnJlZCgpLHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKG4pe3JbZV09dGhpcyxpW2VdPWFyZ3VtZW50cy5sZW5ndGg+MT9vLmNhbGwoYXJndW1lbnRzKTpuLC0tdHx8YS5yZXNvbHZlV2l0aChyLGkpfX07aWYodDw9MSYmKCQoZSxhLmRvbmUocyhuKSkucmVzb2x2ZSxhLnJlamVjdCwhdCksInBlbmRpbmciPT09YS5zdGF0ZSgpfHxnKGlbbl0mJmlbbl0udGhlbikpKXJldHVybiBhLnRoZW4oKTt3aGlsZShuLS0pJChpW25dLHMobiksYS5yZWplY3QpO3JldHVybiBhLnByb21pc2UoKX19KTt2YXIgQj0vXihFdmFsfEludGVybmFsfFJhbmdlfFJlZmVyZW5jZXxTeW50YXh8VHlwZXxVUkkpRXJyb3IkLzt3LkRlZmVycmVkLmV4Y2VwdGlvbkhvb2s9ZnVuY3Rpb24odCxuKXtlLmNvbnNvbGUmJmUuY29uc29sZS53YXJuJiZ0JiZCLnRlc3QodC5uYW1lKSYmZS5jb25zb2xlLndhcm4oImpRdWVyeS5EZWZlcnJlZCBleGNlcHRpb246ICIrdC5tZXNzYWdlLHQuc3RhY2ssbil9LHcucmVhZHlFeGNlcHRpb249ZnVuY3Rpb24odCl7ZS5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dGhyb3cgdH0pfTt2YXIgRj13LkRlZmVycmVkKCk7dy5mbi5yZWFkeT1mdW5jdGlvbihlKXtyZXR1cm4gRi50aGVuKGUpWyJjYXRjaCJdKGZ1bmN0aW9uKGUpe3cucmVhZHlFeGNlcHRpb24oZSl9KSx0aGlzfSx3LmV4dGVuZCh7aXNSZWFkeTohMSxyZWFkeVdhaXQ6MSxyZWFkeTpmdW5jdGlvbihlKXsoITA9PT1lPy0tdy5yZWFkeVdhaXQ6dy5pc1JlYWR5KXx8KHcuaXNSZWFkeT0hMCwhMCE9PWUmJi0tdy5yZWFkeVdhaXQ+MHx8Ri5yZXNvbHZlV2l0aChyLFt3XSkpfX0pLHcucmVhZHkudGhlbj1GLnRoZW47ZnVuY3Rpb24gXygpe3IucmVtb3ZlRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsXyksZS5yZW1vdmVFdmVudExpc3RlbmVyKCJsb2FkIixfKSx3LnJlYWR5KCl9ImNvbXBsZXRlIj09PXIucmVhZHlTdGF0ZXx8ImxvYWRpbmciIT09ci5yZWFkeVN0YXRlJiYhci5kb2N1bWVudEVsZW1lbnQuZG9TY3JvbGw/ZS5zZXRUaW1lb3V0KHcucmVhZHkpOihyLmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLF8pLGUuYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsXykpO3ZhciB6PWZ1bmN0aW9uKGUsdCxuLHIsaSxvLGEpe3ZhciBzPTAsdT1lLmxlbmd0aCxsPW51bGw9PW47aWYoIm9iamVjdCI9PT14KG4pKXtpPSEwO2ZvcihzIGluIG4peihlLHQscyxuW3NdLCEwLG8sYSl9ZWxzZSBpZih2b2lkIDAhPT1yJiYoaT0hMCxnKHIpfHwoYT0hMCksbCYmKGE/KHQuY2FsbChlLHIpLHQ9bnVsbCk6KGw9dCx0PWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gbC5jYWxsKHcoZSksbil9KSksdCkpZm9yKDtzPHU7cysrKXQoZVtzXSxuLGE/cjpyLmNhbGwoZVtzXSxzLHQoZVtzXSxuKSkpO3JldHVybiBpP2U6bD90LmNhbGwoZSk6dT90KGVbMF0sbik6b30sWD0vXi1tcy0vLFU9Ly0oW2Etel0pL2c7ZnVuY3Rpb24gVihlLHQpe3JldHVybiB0LnRvVXBwZXJDYXNlKCl9ZnVuY3Rpb24gRyhlKXtyZXR1cm4gZS5yZXBsYWNlKFgsIm1zLSIpLnJlcGxhY2UoVSxWKX12YXIgWT1mdW5jdGlvbihlKXtyZXR1cm4gMT09PWUubm9kZVR5cGV8fDk9PT1lLm5vZGVUeXBlfHwhK2Uubm9kZVR5cGV9O2Z1bmN0aW9uIFEoKXt0aGlzLmV4cGFuZG89dy5leHBhbmRvK1EudWlkKyt9US51aWQ9MSxRLnByb3RvdHlwZT17Y2FjaGU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZVt0aGlzLmV4cGFuZG9dO3JldHVybiB0fHwodD17fSxZKGUpJiYoZS5ub2RlVHlwZT9lW3RoaXMuZXhwYW5kb109dDpPYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0aGlzLmV4cGFuZG8se3ZhbHVlOnQsY29uZmlndXJhYmxlOiEwfSkpKSx0fSxzZXQ6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGk9dGhpcy5jYWNoZShlKTtpZigic3RyaW5nIj09dHlwZW9mIHQpaVtHKHQpXT1uO2Vsc2UgZm9yKHIgaW4gdClpW0cocildPXRbcl07cmV0dXJuIGl9LGdldDpmdW5jdGlvbihlLHQpe3JldHVybiB2b2lkIDA9PT10P3RoaXMuY2FjaGUoZSk6ZVt0aGlzLmV4cGFuZG9dJiZlW3RoaXMuZXhwYW5kb11bRyh0KV19LGFjY2VzczpmdW5jdGlvbihlLHQsbil7cmV0dXJuIHZvaWQgMD09PXR8fHQmJiJzdHJpbmciPT10eXBlb2YgdCYmdm9pZCAwPT09bj90aGlzLmdldChlLHQpOih0aGlzLnNldChlLHQsbiksdm9pZCAwIT09bj9uOnQpfSxyZW1vdmU6ZnVuY3Rpb24oZSx0KXt2YXIgbixyPWVbdGhpcy5leHBhbmRvXTtpZih2b2lkIDAhPT1yKXtpZih2b2lkIDAhPT10KXtuPSh0PUFycmF5LmlzQXJyYXkodCk/dC5tYXAoRyk6KHQ9Ryh0KSlpbiByP1t0XTp0Lm1hdGNoKE0pfHxbXSkubGVuZ3RoO3doaWxlKG4tLSlkZWxldGUgclt0W25dXX0odm9pZCAwPT09dHx8dy5pc0VtcHR5T2JqZWN0KHIpKSYmKGUubm9kZVR5cGU/ZVt0aGlzLmV4cGFuZG9dPXZvaWQgMDpkZWxldGUgZVt0aGlzLmV4cGFuZG9dKX19LGhhc0RhdGE6ZnVuY3Rpb24oZSl7dmFyIHQ9ZVt0aGlzLmV4cGFuZG9dO3JldHVybiB2b2lkIDAhPT10JiYhdy5pc0VtcHR5T2JqZWN0KHQpfX07dmFyIEo9bmV3IFEsSz1uZXcgUSxaPS9eKD86XHtbXHdcV10qXH18XFtbXHdcV10qXF0pJC8sZWU9L1tBLVpdL2c7ZnVuY3Rpb24gdGUoZSl7cmV0dXJuInRydWUiPT09ZXx8ImZhbHNlIiE9PWUmJigibnVsbCI9PT1lP251bGw6ZT09PStlKyIiPytlOloudGVzdChlKT9KU09OLnBhcnNlKGUpOmUpfWZ1bmN0aW9uIG5lKGUsdCxuKXt2YXIgcjtpZih2b2lkIDA9PT1uJiYxPT09ZS5ub2RlVHlwZSlpZihyPSJkYXRhLSIrdC5yZXBsYWNlKGVlLCItJCYiKS50b0xvd2VyQ2FzZSgpLCJzdHJpbmciPT10eXBlb2Yobj1lLmdldEF0dHJpYnV0ZShyKSkpe3RyeXtuPXRlKG4pfWNhdGNoKGUpe31LLnNldChlLHQsbil9ZWxzZSBuPXZvaWQgMDtyZXR1cm4gbn13LmV4dGVuZCh7aGFzRGF0YTpmdW5jdGlvbihlKXtyZXR1cm4gSy5oYXNEYXRhKGUpfHxKLmhhc0RhdGEoZSl9LGRhdGE6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBLLmFjY2VzcyhlLHQsbil9LHJlbW92ZURhdGE6ZnVuY3Rpb24oZSx0KXtLLnJlbW92ZShlLHQpfSxfZGF0YTpmdW5jdGlvbihlLHQsbil7cmV0dXJuIEouYWNjZXNzKGUsdCxuKX0sX3JlbW92ZURhdGE6ZnVuY3Rpb24oZSx0KXtKLnJlbW92ZShlLHQpfX0pLHcuZm4uZXh0ZW5kKHtkYXRhOmZ1bmN0aW9uKGUsdCl7dmFyIG4scixpLG89dGhpc1swXSxhPW8mJm8uYXR0cmlidXRlcztpZih2b2lkIDA9PT1lKXtpZih0aGlzLmxlbmd0aCYmKGk9Sy5nZXQobyksMT09PW8ubm9kZVR5cGUmJiFKLmdldChvLCJoYXNEYXRhQXR0cnMiKSkpe249YS5sZW5ndGg7d2hpbGUobi0tKWFbbl0mJjA9PT0ocj1hW25dLm5hbWUpLmluZGV4T2YoImRhdGEtIikmJihyPUcoci5zbGljZSg1KSksbmUobyxyLGlbcl0pKTtKLnNldChvLCJoYXNEYXRhQXR0cnMiLCEwKX1yZXR1cm4gaX1yZXR1cm4ib2JqZWN0Ij09dHlwZW9mIGU/dGhpcy5lYWNoKGZ1bmN0aW9uKCl7Sy5zZXQodGhpcyxlKX0pOnoodGhpcyxmdW5jdGlvbih0KXt2YXIgbjtpZihvJiZ2b2lkIDA9PT10KXtpZih2b2lkIDAhPT0obj1LLmdldChvLGUpKSlyZXR1cm4gbjtpZih2b2lkIDAhPT0obj1uZShvLGUpKSlyZXR1cm4gbn1lbHNlIHRoaXMuZWFjaChmdW5jdGlvbigpe0suc2V0KHRoaXMsZSx0KX0pfSxudWxsLHQsYXJndW1lbnRzLmxlbmd0aD4xLG51bGwsITApfSxyZW1vdmVEYXRhOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtLLnJlbW92ZSh0aGlzLGUpfSl9fSksdy5leHRlbmQoe3F1ZXVlOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcjtpZihlKXJldHVybiB0PSh0fHwiZngiKSsicXVldWUiLHI9Si5nZXQoZSx0KSxuJiYoIXJ8fEFycmF5LmlzQXJyYXkobik/cj1KLmFjY2VzcyhlLHQsdy5tYWtlQXJyYXkobikpOnIucHVzaChuKSkscnx8W119LGRlcXVldWU6ZnVuY3Rpb24oZSx0KXt0PXR8fCJmeCI7dmFyIG49dy5xdWV1ZShlLHQpLHI9bi5sZW5ndGgsaT1uLnNoaWZ0KCksbz13Ll9xdWV1ZUhvb2tzKGUsdCksYT1mdW5jdGlvbigpe3cuZGVxdWV1ZShlLHQpfTsiaW5wcm9ncmVzcyI9PT1pJiYoaT1uLnNoaWZ0KCksci0tKSxpJiYoImZ4Ij09PXQmJm4udW5zaGlmdCgiaW5wcm9ncmVzcyIpLGRlbGV0ZSBvLnN0b3AsaS5jYWxsKGUsYSxvKSksIXImJm8mJm8uZW1wdHkuZmlyZSgpfSxfcXVldWVIb29rczpmdW5jdGlvbihlLHQpe3ZhciBuPXQrInF1ZXVlSG9va3MiO3JldHVybiBKLmdldChlLG4pfHxKLmFjY2VzcyhlLG4se2VtcHR5OncuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLmFkZChmdW5jdGlvbigpe0oucmVtb3ZlKGUsW3QrInF1ZXVlIixuXSl9KX0pfX0pLHcuZm4uZXh0ZW5kKHtxdWV1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPTI7cmV0dXJuInN0cmluZyIhPXR5cGVvZiBlJiYodD1lLGU9ImZ4IixuLS0pLGFyZ3VtZW50cy5sZW5ndGg8bj93LnF1ZXVlKHRoaXNbMF0sZSk6dm9pZCAwPT09dD90aGlzOnRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBuPXcucXVldWUodGhpcyxlLHQpO3cuX3F1ZXVlSG9va3ModGhpcyxlKSwiZngiPT09ZSYmImlucHJvZ3Jlc3MiIT09blswXSYmdy5kZXF1ZXVlKHRoaXMsZSl9KX0sZGVxdWV1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dy5kZXF1ZXVlKHRoaXMsZSl9KX0sY2xlYXJRdWV1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5xdWV1ZShlfHwiZngiLFtdKX0scHJvbWlzZTpmdW5jdGlvbihlLHQpe3ZhciBuLHI9MSxpPXcuRGVmZXJyZWQoKSxvPXRoaXMsYT10aGlzLmxlbmd0aCxzPWZ1bmN0aW9uKCl7LS1yfHxpLnJlc29sdmVXaXRoKG8sW29dKX07InN0cmluZyIhPXR5cGVvZiBlJiYodD1lLGU9dm9pZCAwKSxlPWV8fCJmeCI7d2hpbGUoYS0tKShuPUouZ2V0KG9bYV0sZSsicXVldWVIb29rcyIpKSYmbi5lbXB0eSYmKHIrKyxuLmVtcHR5LmFkZChzKSk7cmV0dXJuIHMoKSxpLnByb21pc2UodCl9fSk7dmFyIHJlPS9bKy1dPyg/OlxkKlwufClcZCsoPzpbZUVdWystXT9cZCt8KS8uc291cmNlLGllPW5ldyBSZWdFeHAoIl4oPzooWystXSk9fCkoIityZSsiKShbYS16JV0qKSQiLCJpIiksb2U9WyJUb3AiLCJSaWdodCIsIkJvdHRvbSIsIkxlZnQiXSxhZT1mdW5jdGlvbihlLHQpe3JldHVybiJub25lIj09PShlPXR8fGUpLnN0eWxlLmRpc3BsYXl8fCIiPT09ZS5zdHlsZS5kaXNwbGF5JiZ3LmNvbnRhaW5zKGUub3duZXJEb2N1bWVudCxlKSYmIm5vbmUiPT09dy5jc3MoZSwiZGlzcGxheSIpfSxzZT1mdW5jdGlvbihlLHQsbixyKXt2YXIgaSxvLGE9e307Zm9yKG8gaW4gdClhW29dPWUuc3R5bGVbb10sZS5zdHlsZVtvXT10W29dO2k9bi5hcHBseShlLHJ8fFtdKTtmb3IobyBpbiB0KWUuc3R5bGVbb109YVtvXTtyZXR1cm4gaX07ZnVuY3Rpb24gdWUoZSx0LG4scil7dmFyIGksbyxhPTIwLHM9cj9mdW5jdGlvbigpe3JldHVybiByLmN1cigpfTpmdW5jdGlvbigpe3JldHVybiB3LmNzcyhlLHQsIiIpfSx1PXMoKSxsPW4mJm5bM118fCh3LmNzc051bWJlclt0XT8iIjoicHgiKSxjPSh3LmNzc051bWJlclt0XXx8InB4IiE9PWwmJit1KSYmaWUuZXhlYyh3LmNzcyhlLHQpKTtpZihjJiZjWzNdIT09bCl7dS89MixsPWx8fGNbM10sYz0rdXx8MTt3aGlsZShhLS0pdy5zdHlsZShlLHQsYytsKSwoMS1vKSooMS0obz1zKCkvdXx8LjUpKTw9MCYmKGE9MCksYy89bztjKj0yLHcuc3R5bGUoZSx0LGMrbCksbj1ufHxbXX1yZXR1cm4gbiYmKGM9K2N8fCt1fHwwLGk9blsxXT9jKyhuWzFdKzEpKm5bMl06K25bMl0sciYmKHIudW5pdD1sLHIuc3RhcnQ9YyxyLmVuZD1pKSksaX12YXIgbGU9e307ZnVuY3Rpb24gY2UoZSl7dmFyIHQsbj1lLm93bmVyRG9jdW1lbnQscj1lLm5vZGVOYW1lLGk9bGVbcl07cmV0dXJuIGl8fCh0PW4uYm9keS5hcHBlbmRDaGlsZChuLmNyZWF0ZUVsZW1lbnQocikpLGk9dy5jc3ModCwiZGlzcGxheSIpLHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0KSwibm9uZSI9PT1pJiYoaT0iYmxvY2siKSxsZVtyXT1pLGkpfWZ1bmN0aW9uIGZlKGUsdCl7Zm9yKHZhciBuLHIsaT1bXSxvPTAsYT1lLmxlbmd0aDtvPGE7bysrKShyPWVbb10pLnN0eWxlJiYobj1yLnN0eWxlLmRpc3BsYXksdD8oIm5vbmUiPT09biYmKGlbb109Si5nZXQociwiZGlzcGxheSIpfHxudWxsLGlbb118fChyLnN0eWxlLmRpc3BsYXk9IiIpKSwiIj09PXIuc3R5bGUuZGlzcGxheSYmYWUocikmJihpW29dPWNlKHIpKSk6Im5vbmUiIT09biYmKGlbb109Im5vbmUiLEouc2V0KHIsImRpc3BsYXkiLG4pKSk7Zm9yKG89MDtvPGE7bysrKW51bGwhPWlbb10mJihlW29dLnN0eWxlLmRpc3BsYXk9aVtvXSk7cmV0dXJuIGV9dy5mbi5leHRlbmQoe3Nob3c6ZnVuY3Rpb24oKXtyZXR1cm4gZmUodGhpcywhMCl9LGhpZGU6ZnVuY3Rpb24oKXtyZXR1cm4gZmUodGhpcyl9LHRvZ2dsZTpmdW5jdGlvbihlKXtyZXR1cm4iYm9vbGVhbiI9PXR5cGVvZiBlP2U/dGhpcy5zaG93KCk6dGhpcy5oaWRlKCk6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7YWUodGhpcyk/dyh0aGlzKS5zaG93KCk6dyh0aGlzKS5oaWRlKCl9KX19KTt2YXIgcGU9L14oPzpjaGVja2JveHxyYWRpbykkL2ksZGU9LzwoW2Etel1bXlwvXDA+XHgyMFx0XHJcblxmXSspL2ksaGU9L14kfF5tb2R1bGUkfFwvKD86amF2YXxlY21hKXNjcmlwdC9pLGdlPXtvcHRpb246WzEsIjxzZWxlY3QgbXVsdGlwbGU9J211bHRpcGxlJz4iLCI8L3NlbGVjdD4iXSx0aGVhZDpbMSwiPHRhYmxlPiIsIjwvdGFibGU+Il0sY29sOlsyLCI8dGFibGU+PGNvbGdyb3VwPiIsIjwvY29sZ3JvdXA+PC90YWJsZT4iXSx0cjpbMiwiPHRhYmxlPjx0Ym9keT4iLCI8L3Rib2R5PjwvdGFibGU+Il0sdGQ6WzMsIjx0YWJsZT48dGJvZHk+PHRyPiIsIjwvdHI+PC90Ym9keT48L3RhYmxlPiJdLF9kZWZhdWx0OlswLCIiLCIiXX07Z2Uub3B0Z3JvdXA9Z2Uub3B0aW9uLGdlLnRib2R5PWdlLnRmb290PWdlLmNvbGdyb3VwPWdlLmNhcHRpb249Z2UudGhlYWQsZ2UudGg9Z2UudGQ7ZnVuY3Rpb24geWUoZSx0KXt2YXIgbjtyZXR1cm4gbj0idW5kZWZpbmVkIiE9dHlwZW9mIGUuZ2V0RWxlbWVudHNCeVRhZ05hbWU/ZS5nZXRFbGVtZW50c0J5VGFnTmFtZSh0fHwiKiIpOiJ1bmRlZmluZWQiIT10eXBlb2YgZS5xdWVyeVNlbGVjdG9yQWxsP2UucXVlcnlTZWxlY3RvckFsbCh0fHwiKiIpOltdLHZvaWQgMD09PXR8fHQmJk4oZSx0KT93Lm1lcmdlKFtlXSxuKTpufWZ1bmN0aW9uIHZlKGUsdCl7Zm9yKHZhciBuPTAscj1lLmxlbmd0aDtuPHI7bisrKUouc2V0KGVbbl0sImdsb2JhbEV2YWwiLCF0fHxKLmdldCh0W25dLCJnbG9iYWxFdmFsIikpfXZhciBtZT0vPHwmIz9cdys7LztmdW5jdGlvbiB4ZShlLHQsbixyLGkpe2Zvcih2YXIgbyxhLHMsdSxsLGMsZj10LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxwPVtdLGQ9MCxoPWUubGVuZ3RoO2Q8aDtkKyspaWYoKG89ZVtkXSl8fDA9PT1vKWlmKCJvYmplY3QiPT09eChvKSl3Lm1lcmdlKHAsby5ub2RlVHlwZT9bb106byk7ZWxzZSBpZihtZS50ZXN0KG8pKXthPWF8fGYuYXBwZW5kQ2hpbGQodC5jcmVhdGVFbGVtZW50KCJkaXYiKSkscz0oZGUuZXhlYyhvKXx8WyIiLCIiXSlbMV0udG9Mb3dlckNhc2UoKSx1PWdlW3NdfHxnZS5fZGVmYXVsdCxhLmlubmVySFRNTD11WzFdK3cuaHRtbFByZWZpbHRlcihvKSt1WzJdLGM9dVswXTt3aGlsZShjLS0pYT1hLmxhc3RDaGlsZDt3Lm1lcmdlKHAsYS5jaGlsZE5vZGVzKSwoYT1mLmZpcnN0Q2hpbGQpLnRleHRDb250ZW50PSIifWVsc2UgcC5wdXNoKHQuY3JlYXRlVGV4dE5vZGUobykpO2YudGV4dENvbnRlbnQ9IiIsZD0wO3doaWxlKG89cFtkKytdKWlmKHImJncuaW5BcnJheShvLHIpPi0xKWkmJmkucHVzaChvKTtlbHNlIGlmKGw9dy5jb250YWlucyhvLm93bmVyRG9jdW1lbnQsbyksYT15ZShmLmFwcGVuZENoaWxkKG8pLCJzY3JpcHQiKSxsJiZ2ZShhKSxuKXtjPTA7d2hpbGUobz1hW2MrK10paGUudGVzdChvLnR5cGV8fCIiKSYmbi5wdXNoKG8pfXJldHVybiBmfSFmdW5jdGlvbigpe3ZhciBlPXIuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLmFwcGVuZENoaWxkKHIuY3JlYXRlRWxlbWVudCgiZGl2IikpLHQ9ci5jcmVhdGVFbGVtZW50KCJpbnB1dCIpO3Quc2V0QXR0cmlidXRlKCJ0eXBlIiwicmFkaW8iKSx0LnNldEF0dHJpYnV0ZSgiY2hlY2tlZCIsImNoZWNrZWQiKSx0LnNldEF0dHJpYnV0ZSgibmFtZSIsInQiKSxlLmFwcGVuZENoaWxkKHQpLGguY2hlY2tDbG9uZT1lLmNsb25lTm9kZSghMCkuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuY2hlY2tlZCxlLmlubmVySFRNTD0iPHRleHRhcmVhPng8L3RleHRhcmVhPiIsaC5ub0Nsb25lQ2hlY2tlZD0hIWUuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuZGVmYXVsdFZhbHVlfSgpO3ZhciBiZT1yLmRvY3VtZW50RWxlbWVudCx3ZT0vXmtleS8sVGU9L14oPzptb3VzZXxwb2ludGVyfGNvbnRleHRtZW51fGRyYWd8ZHJvcCl8Y2xpY2svLENlPS9eKFteLl0qKSg/OlwuKC4rKXwpLztmdW5jdGlvbiBFZSgpe3JldHVybiEwfWZ1bmN0aW9uIGtlKCl7cmV0dXJuITF9ZnVuY3Rpb24gU2UoKXt0cnl7cmV0dXJuIHIuYWN0aXZlRWxlbWVudH1jYXRjaChlKXt9fWZ1bmN0aW9uIERlKGUsdCxuLHIsaSxvKXt2YXIgYSxzO2lmKCJvYmplY3QiPT10eXBlb2YgdCl7InN0cmluZyIhPXR5cGVvZiBuJiYocj1yfHxuLG49dm9pZCAwKTtmb3IocyBpbiB0KURlKGUscyxuLHIsdFtzXSxvKTtyZXR1cm4gZX1pZihudWxsPT1yJiZudWxsPT1pPyhpPW4scj1uPXZvaWQgMCk6bnVsbD09aSYmKCJzdHJpbmciPT10eXBlb2Ygbj8oaT1yLHI9dm9pZCAwKTooaT1yLHI9bixuPXZvaWQgMCkpLCExPT09aSlpPWtlO2Vsc2UgaWYoIWkpcmV0dXJuIGU7cmV0dXJuIDE9PT1vJiYoYT1pLChpPWZ1bmN0aW9uKGUpe3JldHVybiB3KCkub2ZmKGUpLGEuYXBwbHkodGhpcyxhcmd1bWVudHMpfSkuZ3VpZD1hLmd1aWR8fChhLmd1aWQ9dy5ndWlkKyspKSxlLmVhY2goZnVuY3Rpb24oKXt3LmV2ZW50LmFkZCh0aGlzLHQsaSxyLG4pfSl9dy5ldmVudD17Z2xvYmFsOnt9LGFkZDpmdW5jdGlvbihlLHQsbixyLGkpe3ZhciBvLGEscyx1LGwsYyxmLHAsZCxoLGcseT1KLmdldChlKTtpZih5KXtuLmhhbmRsZXImJihuPShvPW4pLmhhbmRsZXIsaT1vLnNlbGVjdG9yKSxpJiZ3LmZpbmQubWF0Y2hlc1NlbGVjdG9yKGJlLGkpLG4uZ3VpZHx8KG4uZ3VpZD13Lmd1aWQrKyksKHU9eS5ldmVudHMpfHwodT15LmV2ZW50cz17fSksKGE9eS5oYW5kbGUpfHwoYT15LmhhbmRsZT1mdW5jdGlvbih0KXtyZXR1cm4idW5kZWZpbmVkIiE9dHlwZW9mIHcmJncuZXZlbnQudHJpZ2dlcmVkIT09dC50eXBlP3cuZXZlbnQuZGlzcGF0Y2guYXBwbHkoZSxhcmd1bWVudHMpOnZvaWQgMH0pLGw9KHQ9KHR8fCIiKS5tYXRjaChNKXx8WyIiXSkubGVuZ3RoO3doaWxlKGwtLSlkPWc9KHM9Q2UuZXhlYyh0W2xdKXx8W10pWzFdLGg9KHNbMl18fCIiKS5zcGxpdCgiLiIpLnNvcnQoKSxkJiYoZj13LmV2ZW50LnNwZWNpYWxbZF18fHt9LGQ9KGk/Zi5kZWxlZ2F0ZVR5cGU6Zi5iaW5kVHlwZSl8fGQsZj13LmV2ZW50LnNwZWNpYWxbZF18fHt9LGM9dy5leHRlbmQoe3R5cGU6ZCxvcmlnVHlwZTpnLGRhdGE6cixoYW5kbGVyOm4sZ3VpZDpuLmd1aWQsc2VsZWN0b3I6aSxuZWVkc0NvbnRleHQ6aSYmdy5leHByLm1hdGNoLm5lZWRzQ29udGV4dC50ZXN0KGkpLG5hbWVzcGFjZTpoLmpvaW4oIi4iKX0sbyksKHA9dVtkXSl8fCgocD11W2RdPVtdKS5kZWxlZ2F0ZUNvdW50PTAsZi5zZXR1cCYmITEhPT1mLnNldHVwLmNhbGwoZSxyLGgsYSl8fGUuYWRkRXZlbnRMaXN0ZW5lciYmZS5hZGRFdmVudExpc3RlbmVyKGQsYSkpLGYuYWRkJiYoZi5hZGQuY2FsbChlLGMpLGMuaGFuZGxlci5ndWlkfHwoYy5oYW5kbGVyLmd1aWQ9bi5ndWlkKSksaT9wLnNwbGljZShwLmRlbGVnYXRlQ291bnQrKywwLGMpOnAucHVzaChjKSx3LmV2ZW50Lmdsb2JhbFtkXT0hMCl9fSxyZW1vdmU6ZnVuY3Rpb24oZSx0LG4scixpKXt2YXIgbyxhLHMsdSxsLGMsZixwLGQsaCxnLHk9Si5oYXNEYXRhKGUpJiZKLmdldChlKTtpZih5JiYodT15LmV2ZW50cykpe2w9KHQ9KHR8fCIiKS5tYXRjaChNKXx8WyIiXSkubGVuZ3RoO3doaWxlKGwtLSlpZihzPUNlLmV4ZWModFtsXSl8fFtdLGQ9Zz1zWzFdLGg9KHNbMl18fCIiKS5zcGxpdCgiLiIpLnNvcnQoKSxkKXtmPXcuZXZlbnQuc3BlY2lhbFtkXXx8e30scD11W2Q9KHI/Zi5kZWxlZ2F0ZVR5cGU6Zi5iaW5kVHlwZSl8fGRdfHxbXSxzPXNbMl0mJm5ldyBSZWdFeHAoIihefFxcLikiK2guam9pbigiXFwuKD86LipcXC58KSIpKyIoXFwufCQpIiksYT1vPXAubGVuZ3RoO3doaWxlKG8tLSljPXBbb10sIWkmJmchPT1jLm9yaWdUeXBlfHxuJiZuLmd1aWQhPT1jLmd1aWR8fHMmJiFzLnRlc3QoYy5uYW1lc3BhY2UpfHxyJiZyIT09Yy5zZWxlY3RvciYmKCIqKiIhPT1yfHwhYy5zZWxlY3Rvcil8fChwLnNwbGljZShvLDEpLGMuc2VsZWN0b3ImJnAuZGVsZWdhdGVDb3VudC0tLGYucmVtb3ZlJiZmLnJlbW92ZS5jYWxsKGUsYykpO2EmJiFwLmxlbmd0aCYmKGYudGVhcmRvd24mJiExIT09Zi50ZWFyZG93bi5jYWxsKGUsaCx5LmhhbmRsZSl8fHcucmVtb3ZlRXZlbnQoZSxkLHkuaGFuZGxlKSxkZWxldGUgdVtkXSl9ZWxzZSBmb3IoZCBpbiB1KXcuZXZlbnQucmVtb3ZlKGUsZCt0W2xdLG4sciwhMCk7dy5pc0VtcHR5T2JqZWN0KHUpJiZKLnJlbW92ZShlLCJoYW5kbGUgZXZlbnRzIil9fSxkaXNwYXRjaDpmdW5jdGlvbihlKXt2YXIgdD13LmV2ZW50LmZpeChlKSxuLHIsaSxvLGEscyx1PW5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoKSxsPShKLmdldCh0aGlzLCJldmVudHMiKXx8e30pW3QudHlwZV18fFtdLGM9dy5ldmVudC5zcGVjaWFsW3QudHlwZV18fHt9O2Zvcih1WzBdPXQsbj0xO248YXJndW1lbnRzLmxlbmd0aDtuKyspdVtuXT1hcmd1bWVudHNbbl07aWYodC5kZWxlZ2F0ZVRhcmdldD10aGlzLCFjLnByZURpc3BhdGNofHwhMSE9PWMucHJlRGlzcGF0Y2guY2FsbCh0aGlzLHQpKXtzPXcuZXZlbnQuaGFuZGxlcnMuY2FsbCh0aGlzLHQsbCksbj0wO3doaWxlKChvPXNbbisrXSkmJiF0LmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpe3QuY3VycmVudFRhcmdldD1vLmVsZW0scj0wO3doaWxlKChhPW8uaGFuZGxlcnNbcisrXSkmJiF0LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCkpdC5ybmFtZXNwYWNlJiYhdC5ybmFtZXNwYWNlLnRlc3QoYS5uYW1lc3BhY2UpfHwodC5oYW5kbGVPYmo9YSx0LmRhdGE9YS5kYXRhLHZvaWQgMCE9PShpPSgody5ldmVudC5zcGVjaWFsW2Eub3JpZ1R5cGVdfHx7fSkuaGFuZGxlfHxhLmhhbmRsZXIpLmFwcGx5KG8uZWxlbSx1KSkmJiExPT09KHQucmVzdWx0PWkpJiYodC5wcmV2ZW50RGVmYXVsdCgpLHQuc3RvcFByb3BhZ2F0aW9uKCkpKX1yZXR1cm4gYy5wb3N0RGlzcGF0Y2gmJmMucG9zdERpc3BhdGNoLmNhbGwodGhpcyx0KSx0LnJlc3VsdH19LGhhbmRsZXJzOmZ1bmN0aW9uKGUsdCl7dmFyIG4scixpLG8sYSxzPVtdLHU9dC5kZWxlZ2F0ZUNvdW50LGw9ZS50YXJnZXQ7aWYodSYmbC5ub2RlVHlwZSYmISgiY2xpY2siPT09ZS50eXBlJiZlLmJ1dHRvbj49MSkpZm9yKDtsIT09dGhpcztsPWwucGFyZW50Tm9kZXx8dGhpcylpZigxPT09bC5ub2RlVHlwZSYmKCJjbGljayIhPT1lLnR5cGV8fCEwIT09bC5kaXNhYmxlZCkpe2ZvcihvPVtdLGE9e30sbj0wO248dTtuKyspdm9pZCAwPT09YVtpPShyPXRbbl0pLnNlbGVjdG9yKyIgIl0mJihhW2ldPXIubmVlZHNDb250ZXh0P3coaSx0aGlzKS5pbmRleChsKT4tMTp3LmZpbmQoaSx0aGlzLG51bGwsW2xdKS5sZW5ndGgpLGFbaV0mJm8ucHVzaChyKTtvLmxlbmd0aCYmcy5wdXNoKHtlbGVtOmwsaGFuZGxlcnM6b30pfXJldHVybiBsPXRoaXMsdTx0Lmxlbmd0aCYmcy5wdXNoKHtlbGVtOmwsaGFuZGxlcnM6dC5zbGljZSh1KX0pLHN9LGFkZFByb3A6ZnVuY3Rpb24oZSx0KXtPYmplY3QuZGVmaW5lUHJvcGVydHkody5FdmVudC5wcm90b3R5cGUsZSx7ZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsZ2V0OmcodCk/ZnVuY3Rpb24oKXtpZih0aGlzLm9yaWdpbmFsRXZlbnQpcmV0dXJuIHQodGhpcy5vcmlnaW5hbEV2ZW50KX06ZnVuY3Rpb24oKXtpZih0aGlzLm9yaWdpbmFsRXZlbnQpcmV0dXJuIHRoaXMub3JpZ2luYWxFdmVudFtlXX0sc2V0OmZ1bmN0aW9uKHQpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLGUse2VudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwLHZhbHVlOnR9KX19KX0sZml4OmZ1bmN0aW9uKGUpe3JldHVybiBlW3cuZXhwYW5kb10/ZTpuZXcgdy5FdmVudChlKX0sc3BlY2lhbDp7bG9hZDp7bm9CdWJibGU6ITB9LGZvY3VzOnt0cmlnZ2VyOmZ1bmN0aW9uKCl7aWYodGhpcyE9PVNlKCkmJnRoaXMuZm9jdXMpcmV0dXJuIHRoaXMuZm9jdXMoKSwhMX0sZGVsZWdhdGVUeXBlOiJmb2N1c2luIn0sYmx1cjp7dHJpZ2dlcjpmdW5jdGlvbigpe2lmKHRoaXM9PT1TZSgpJiZ0aGlzLmJsdXIpcmV0dXJuIHRoaXMuYmx1cigpLCExfSxkZWxlZ2F0ZVR5cGU6ImZvY3Vzb3V0In0sY2xpY2s6e3RyaWdnZXI6ZnVuY3Rpb24oKXtpZigiY2hlY2tib3giPT09dGhpcy50eXBlJiZ0aGlzLmNsaWNrJiZOKHRoaXMsImlucHV0IikpcmV0dXJuIHRoaXMuY2xpY2soKSwhMX0sX2RlZmF1bHQ6ZnVuY3Rpb24oZSl7cmV0dXJuIE4oZS50YXJnZXQsImEiKX19LGJlZm9yZXVubG9hZDp7cG9zdERpc3BhdGNoOmZ1bmN0aW9uKGUpe3ZvaWQgMCE9PWUucmVzdWx0JiZlLm9yaWdpbmFsRXZlbnQmJihlLm9yaWdpbmFsRXZlbnQucmV0dXJuVmFsdWU9ZS5yZXN1bHQpfX19fSx3LnJlbW92ZUV2ZW50PWZ1bmN0aW9uKGUsdCxuKXtlLnJlbW92ZUV2ZW50TGlzdGVuZXImJmUucmVtb3ZlRXZlbnRMaXN0ZW5lcih0LG4pfSx3LkV2ZW50PWZ1bmN0aW9uKGUsdCl7aWYoISh0aGlzIGluc3RhbmNlb2Ygdy5FdmVudCkpcmV0dXJuIG5ldyB3LkV2ZW50KGUsdCk7ZSYmZS50eXBlPyh0aGlzLm9yaWdpbmFsRXZlbnQ9ZSx0aGlzLnR5cGU9ZS50eXBlLHRoaXMuaXNEZWZhdWx0UHJldmVudGVkPWUuZGVmYXVsdFByZXZlbnRlZHx8dm9pZCAwPT09ZS5kZWZhdWx0UHJldmVudGVkJiYhMT09PWUucmV0dXJuVmFsdWU/RWU6a2UsdGhpcy50YXJnZXQ9ZS50YXJnZXQmJjM9PT1lLnRhcmdldC5ub2RlVHlwZT9lLnRhcmdldC5wYXJlbnROb2RlOmUudGFyZ2V0LHRoaXMuY3VycmVudFRhcmdldD1lLmN1cnJlbnRUYXJnZXQsdGhpcy5yZWxhdGVkVGFyZ2V0PWUucmVsYXRlZFRhcmdldCk6dGhpcy50eXBlPWUsdCYmdy5leHRlbmQodGhpcyx0KSx0aGlzLnRpbWVTdGFtcD1lJiZlLnRpbWVTdGFtcHx8RGF0ZS5ub3coKSx0aGlzW3cuZXhwYW5kb109ITB9LHcuRXZlbnQucHJvdG90eXBlPXtjb25zdHJ1Y3Rvcjp3LkV2ZW50LGlzRGVmYXVsdFByZXZlbnRlZDprZSxpc1Byb3BhZ2F0aW9uU3RvcHBlZDprZSxpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZDprZSxpc1NpbXVsYXRlZDohMSxwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbigpe3ZhciBlPXRoaXMub3JpZ2luYWxFdmVudDt0aGlzLmlzRGVmYXVsdFByZXZlbnRlZD1FZSxlJiYhdGhpcy5pc1NpbXVsYXRlZCYmZS5wcmV2ZW50RGVmYXVsdCgpfSxzdG9wUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9yaWdpbmFsRXZlbnQ7dGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZD1FZSxlJiYhdGhpcy5pc1NpbXVsYXRlZCYmZS5zdG9wUHJvcGFnYXRpb24oKX0sc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ9RWUsZSYmIXRoaXMuaXNTaW11bGF0ZWQmJmUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksdGhpcy5zdG9wUHJvcGFnYXRpb24oKX19LHcuZWFjaCh7YWx0S2V5OiEwLGJ1YmJsZXM6ITAsY2FuY2VsYWJsZTohMCxjaGFuZ2VkVG91Y2hlczohMCxjdHJsS2V5OiEwLGRldGFpbDohMCxldmVudFBoYXNlOiEwLG1ldGFLZXk6ITAscGFnZVg6ITAscGFnZVk6ITAsc2hpZnRLZXk6ITAsdmlldzohMCwiY2hhciI6ITAsY2hhckNvZGU6ITAsa2V5OiEwLGtleUNvZGU6ITAsYnV0dG9uOiEwLGJ1dHRvbnM6ITAsY2xpZW50WDohMCxjbGllbnRZOiEwLG9mZnNldFg6ITAsb2Zmc2V0WTohMCxwb2ludGVySWQ6ITAscG9pbnRlclR5cGU6ITAsc2NyZWVuWDohMCxzY3JlZW5ZOiEwLHRhcmdldFRvdWNoZXM6ITAsdG9FbGVtZW50OiEwLHRvdWNoZXM6ITAsd2hpY2g6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5idXR0b247cmV0dXJuIG51bGw9PWUud2hpY2gmJndlLnRlc3QoZS50eXBlKT9udWxsIT1lLmNoYXJDb2RlP2UuY2hhckNvZGU6ZS5rZXlDb2RlOiFlLndoaWNoJiZ2b2lkIDAhPT10JiZUZS50ZXN0KGUudHlwZSk/MSZ0PzE6MiZ0PzM6NCZ0PzI6MDplLndoaWNofX0sdy5ldmVudC5hZGRQcm9wKSx3LmVhY2goe21vdXNlZW50ZXI6Im1vdXNlb3ZlciIsbW91c2VsZWF2ZToibW91c2VvdXQiLHBvaW50ZXJlbnRlcjoicG9pbnRlcm92ZXIiLHBvaW50ZXJsZWF2ZToicG9pbnRlcm91dCJ9LGZ1bmN0aW9uKGUsdCl7dy5ldmVudC5zcGVjaWFsW2VdPXtkZWxlZ2F0ZVR5cGU6dCxiaW5kVHlwZTp0LGhhbmRsZTpmdW5jdGlvbihlKXt2YXIgbixyPXRoaXMsaT1lLnJlbGF0ZWRUYXJnZXQsbz1lLmhhbmRsZU9iajtyZXR1cm4gaSYmKGk9PT1yfHx3LmNvbnRhaW5zKHIsaSkpfHwoZS50eXBlPW8ub3JpZ1R5cGUsbj1vLmhhbmRsZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLGUudHlwZT10KSxufX19KSx3LmZuLmV4dGVuZCh7b246ZnVuY3Rpb24oZSx0LG4scil7cmV0dXJuIERlKHRoaXMsZSx0LG4scil9LG9uZTpmdW5jdGlvbihlLHQsbixyKXtyZXR1cm4gRGUodGhpcyxlLHQsbixyLDEpfSxvZmY6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGk7aWYoZSYmZS5wcmV2ZW50RGVmYXVsdCYmZS5oYW5kbGVPYmopcmV0dXJuIHI9ZS5oYW5kbGVPYmosdyhlLmRlbGVnYXRlVGFyZ2V0KS5vZmYoci5uYW1lc3BhY2U/ci5vcmlnVHlwZSsiLiIrci5uYW1lc3BhY2U6ci5vcmlnVHlwZSxyLnNlbGVjdG9yLHIuaGFuZGxlciksdGhpcztpZigib2JqZWN0Ij09dHlwZW9mIGUpe2ZvcihpIGluIGUpdGhpcy5vZmYoaSx0LGVbaV0pO3JldHVybiB0aGlzfXJldHVybiExIT09dCYmImZ1bmN0aW9uIiE9dHlwZW9mIHR8fChuPXQsdD12b2lkIDApLCExPT09biYmKG49a2UpLHRoaXMuZWFjaChmdW5jdGlvbigpe3cuZXZlbnQucmVtb3ZlKHRoaXMsZSxuLHQpfSl9fSk7dmFyIE5lPS88KD8hYXJlYXxicnxjb2x8ZW1iZWR8aHJ8aW1nfGlucHV0fGxpbmt8bWV0YXxwYXJhbSkoKFthLXpdW15cL1wwPlx4MjBcdFxyXG5cZl0qKVtePl0qKVwvPi9naSxBZT0vPHNjcmlwdHw8c3R5bGV8PGxpbmsvaSxqZT0vY2hlY2tlZFxzKig/OltePV18PVxzKi5jaGVja2VkLikvaSxxZT0vXlxzKjwhKD86XFtDREFUQVxbfC0tKXwoPzpcXVxdfC0tKT5ccyokL2c7ZnVuY3Rpb24gTGUoZSx0KXtyZXR1cm4gTihlLCJ0YWJsZSIpJiZOKDExIT09dC5ub2RlVHlwZT90OnQuZmlyc3RDaGlsZCwidHIiKT93KGUpLmNoaWxkcmVuKCJ0Ym9keSIpWzBdfHxlOmV9ZnVuY3Rpb24gSGUoZSl7cmV0dXJuIGUudHlwZT0obnVsbCE9PWUuZ2V0QXR0cmlidXRlKCJ0eXBlIikpKyIvIitlLnR5cGUsZX1mdW5jdGlvbiBPZShlKXtyZXR1cm4idHJ1ZS8iPT09KGUudHlwZXx8IiIpLnNsaWNlKDAsNSk/ZS50eXBlPWUudHlwZS5zbGljZSg1KTplLnJlbW92ZUF0dHJpYnV0ZSgidHlwZSIpLGV9ZnVuY3Rpb24gUGUoZSx0KXt2YXIgbixyLGksbyxhLHMsdSxsO2lmKDE9PT10Lm5vZGVUeXBlKXtpZihKLmhhc0RhdGEoZSkmJihvPUouYWNjZXNzKGUpLGE9Si5zZXQodCxvKSxsPW8uZXZlbnRzKSl7ZGVsZXRlIGEuaGFuZGxlLGEuZXZlbnRzPXt9O2ZvcihpIGluIGwpZm9yKG49MCxyPWxbaV0ubGVuZ3RoO248cjtuKyspdy5ldmVudC5hZGQodCxpLGxbaV1bbl0pfUsuaGFzRGF0YShlKSYmKHM9Sy5hY2Nlc3MoZSksdT13LmV4dGVuZCh7fSxzKSxLLnNldCh0LHUpKX19ZnVuY3Rpb24gTWUoZSx0KXt2YXIgbj10Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7ImlucHV0Ij09PW4mJnBlLnRlc3QoZS50eXBlKT90LmNoZWNrZWQ9ZS5jaGVja2VkOiJpbnB1dCIhPT1uJiYidGV4dGFyZWEiIT09bnx8KHQuZGVmYXVsdFZhbHVlPWUuZGVmYXVsdFZhbHVlKX1mdW5jdGlvbiBSZShlLHQsbixyKXt0PWEuYXBwbHkoW10sdCk7dmFyIGksbyxzLHUsbCxjLGY9MCxwPWUubGVuZ3RoLGQ9cC0xLHk9dFswXSx2PWcoeSk7aWYodnx8cD4xJiYic3RyaW5nIj09dHlwZW9mIHkmJiFoLmNoZWNrQ2xvbmUmJmplLnRlc3QoeSkpcmV0dXJuIGUuZWFjaChmdW5jdGlvbihpKXt2YXIgbz1lLmVxKGkpO3YmJih0WzBdPXkuY2FsbCh0aGlzLGksby5odG1sKCkpKSxSZShvLHQsbixyKX0pO2lmKHAmJihpPXhlKHQsZVswXS5vd25lckRvY3VtZW50LCExLGUsciksbz1pLmZpcnN0Q2hpbGQsMT09PWkuY2hpbGROb2Rlcy5sZW5ndGgmJihpPW8pLG98fHIpKXtmb3IodT0ocz13Lm1hcCh5ZShpLCJzY3JpcHQiKSxIZSkpLmxlbmd0aDtmPHA7ZisrKWw9aSxmIT09ZCYmKGw9dy5jbG9uZShsLCEwLCEwKSx1JiZ3Lm1lcmdlKHMseWUobCwic2NyaXB0IikpKSxuLmNhbGwoZVtmXSxsLGYpO2lmKHUpZm9yKGM9c1tzLmxlbmd0aC0xXS5vd25lckRvY3VtZW50LHcubWFwKHMsT2UpLGY9MDtmPHU7ZisrKWw9c1tmXSxoZS50ZXN0KGwudHlwZXx8IiIpJiYhSi5hY2Nlc3MobCwiZ2xvYmFsRXZhbCIpJiZ3LmNvbnRhaW5zKGMsbCkmJihsLnNyYyYmIm1vZHVsZSIhPT0obC50eXBlfHwiIikudG9Mb3dlckNhc2UoKT93Ll9ldmFsVXJsJiZ3Ll9ldmFsVXJsKGwuc3JjKTptKGwudGV4dENvbnRlbnQucmVwbGFjZShxZSwiIiksYyxsKSl9cmV0dXJuIGV9ZnVuY3Rpb24gSWUoZSx0LG4pe2Zvcih2YXIgcixpPXQ/dy5maWx0ZXIodCxlKTplLG89MDtudWxsIT0ocj1pW29dKTtvKyspbnx8MSE9PXIubm9kZVR5cGV8fHcuY2xlYW5EYXRhKHllKHIpKSxyLnBhcmVudE5vZGUmJihuJiZ3LmNvbnRhaW5zKHIub3duZXJEb2N1bWVudCxyKSYmdmUoeWUociwic2NyaXB0IikpLHIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChyKSk7cmV0dXJuIGV9dy5leHRlbmQoe2h0bWxQcmVmaWx0ZXI6ZnVuY3Rpb24oZSl7cmV0dXJuIGUucmVwbGFjZShOZSwiPCQxPjwvJDI+Iil9LGNsb25lOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG8sYSxzPWUuY2xvbmVOb2RlKCEwKSx1PXcuY29udGFpbnMoZS5vd25lckRvY3VtZW50LGUpO2lmKCEoaC5ub0Nsb25lQ2hlY2tlZHx8MSE9PWUubm9kZVR5cGUmJjExIT09ZS5ub2RlVHlwZXx8dy5pc1hNTERvYyhlKSkpZm9yKGE9eWUocykscj0wLGk9KG89eWUoZSkpLmxlbmd0aDtyPGk7cisrKU1lKG9bcl0sYVtyXSk7aWYodClpZihuKWZvcihvPW98fHllKGUpLGE9YXx8eWUocykscj0wLGk9by5sZW5ndGg7cjxpO3IrKylQZShvW3JdLGFbcl0pO2Vsc2UgUGUoZSxzKTtyZXR1cm4oYT15ZShzLCJzY3JpcHQiKSkubGVuZ3RoPjAmJnZlKGEsIXUmJnllKGUsInNjcmlwdCIpKSxzfSxjbGVhbkRhdGE6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LG4scixpPXcuZXZlbnQuc3BlY2lhbCxvPTA7dm9pZCAwIT09KG49ZVtvXSk7bysrKWlmKFkobikpe2lmKHQ9bltKLmV4cGFuZG9dKXtpZih0LmV2ZW50cylmb3IociBpbiB0LmV2ZW50cylpW3JdP3cuZXZlbnQucmVtb3ZlKG4scik6dy5yZW1vdmVFdmVudChuLHIsdC5oYW5kbGUpO25bSi5leHBhbmRvXT12b2lkIDB9bltLLmV4cGFuZG9dJiYobltLLmV4cGFuZG9dPXZvaWQgMCl9fX0pLHcuZm4uZXh0ZW5kKHtkZXRhY2g6ZnVuY3Rpb24oZSl7cmV0dXJuIEllKHRoaXMsZSwhMCl9LHJlbW92ZTpmdW5jdGlvbihlKXtyZXR1cm4gSWUodGhpcyxlKX0sdGV4dDpmdW5jdGlvbihlKXtyZXR1cm4geih0aGlzLGZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lP3cudGV4dCh0aGlzKTp0aGlzLmVtcHR5KCkuZWFjaChmdW5jdGlvbigpezEhPT10aGlzLm5vZGVUeXBlJiYxMSE9PXRoaXMubm9kZVR5cGUmJjkhPT10aGlzLm5vZGVUeXBlfHwodGhpcy50ZXh0Q29udGVudD1lKX0pfSxudWxsLGUsYXJndW1lbnRzLmxlbmd0aCl9LGFwcGVuZDpmdW5jdGlvbigpe3JldHVybiBSZSh0aGlzLGFyZ3VtZW50cyxmdW5jdGlvbihlKXsxIT09dGhpcy5ub2RlVHlwZSYmMTEhPT10aGlzLm5vZGVUeXBlJiY5IT09dGhpcy5ub2RlVHlwZXx8TGUodGhpcyxlKS5hcHBlbmRDaGlsZChlKX0pfSxwcmVwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIFJlKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGUpe2lmKDE9PT10aGlzLm5vZGVUeXBlfHwxMT09PXRoaXMubm9kZVR5cGV8fDk9PT10aGlzLm5vZGVUeXBlKXt2YXIgdD1MZSh0aGlzLGUpO3QuaW5zZXJ0QmVmb3JlKGUsdC5maXJzdENoaWxkKX19KX0sYmVmb3JlOmZ1bmN0aW9uKCl7cmV0dXJuIFJlKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGUpe3RoaXMucGFyZW50Tm9kZSYmdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlLHRoaXMpfSl9LGFmdGVyOmZ1bmN0aW9uKCl7cmV0dXJuIFJlKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGUpe3RoaXMucGFyZW50Tm9kZSYmdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlLHRoaXMubmV4dFNpYmxpbmcpfSl9LGVtcHR5OmZ1bmN0aW9uKCl7Zm9yKHZhciBlLHQ9MDtudWxsIT0oZT10aGlzW3RdKTt0KyspMT09PWUubm9kZVR5cGUmJih3LmNsZWFuRGF0YSh5ZShlLCExKSksZS50ZXh0Q29udGVudD0iIik7cmV0dXJuIHRoaXN9LGNsb25lOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIGU9bnVsbCE9ZSYmZSx0PW51bGw9PXQ/ZTp0LHRoaXMubWFwKGZ1bmN0aW9uKCl7cmV0dXJuIHcuY2xvbmUodGhpcyxlLHQpfSl9LGh0bWw6ZnVuY3Rpb24oZSl7cmV0dXJuIHoodGhpcyxmdW5jdGlvbihlKXt2YXIgdD10aGlzWzBdfHx7fSxuPTAscj10aGlzLmxlbmd0aDtpZih2b2lkIDA9PT1lJiYxPT09dC5ub2RlVHlwZSlyZXR1cm4gdC5pbm5lckhUTUw7aWYoInN0cmluZyI9PXR5cGVvZiBlJiYhQWUudGVzdChlKSYmIWdlWyhkZS5leGVjKGUpfHxbIiIsIiJdKVsxXS50b0xvd2VyQ2FzZSgpXSl7ZT13Lmh0bWxQcmVmaWx0ZXIoZSk7dHJ5e2Zvcig7bjxyO24rKykxPT09KHQ9dGhpc1tuXXx8e30pLm5vZGVUeXBlJiYody5jbGVhbkRhdGEoeWUodCwhMSkpLHQuaW5uZXJIVE1MPWUpO3Q9MH1jYXRjaChlKXt9fXQmJnRoaXMuZW1wdHkoKS5hcHBlbmQoZSl9LG51bGwsZSxhcmd1bWVudHMubGVuZ3RoKX0scmVwbGFjZVdpdGg6ZnVuY3Rpb24oKXt2YXIgZT1bXTtyZXR1cm4gUmUodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24odCl7dmFyIG49dGhpcy5wYXJlbnROb2RlO3cuaW5BcnJheSh0aGlzLGUpPDAmJih3LmNsZWFuRGF0YSh5ZSh0aGlzKSksbiYmbi5yZXBsYWNlQ2hpbGQodCx0aGlzKSl9LGUpfX0pLHcuZWFjaCh7YXBwZW5kVG86ImFwcGVuZCIscHJlcGVuZFRvOiJwcmVwZW5kIixpbnNlcnRCZWZvcmU6ImJlZm9yZSIsaW5zZXJ0QWZ0ZXI6ImFmdGVyIixyZXBsYWNlQWxsOiJyZXBsYWNlV2l0aCJ9LGZ1bmN0aW9uKGUsdCl7dy5mbltlXT1mdW5jdGlvbihlKXtmb3IodmFyIG4scj1bXSxpPXcoZSksbz1pLmxlbmd0aC0xLGE9MDthPD1vO2ErKyluPWE9PT1vP3RoaXM6dGhpcy5jbG9uZSghMCksdyhpW2FdKVt0XShuKSxzLmFwcGx5KHIsbi5nZXQoKSk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKHIpfX0pO3ZhciBXZT1uZXcgUmVnRXhwKCJeKCIrcmUrIikoPyFweClbYS16JV0rJCIsImkiKSwkZT1mdW5jdGlvbih0KXt2YXIgbj10Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXc7cmV0dXJuIG4mJm4ub3BlbmVyfHwobj1lKSxuLmdldENvbXB1dGVkU3R5bGUodCl9LEJlPW5ldyBSZWdFeHAob2Uuam9pbigifCIpLCJpIik7IWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe2lmKGMpe2wuc3R5bGUuY3NzVGV4dD0icG9zaXRpb246YWJzb2x1dGU7bGVmdDotMTExMTFweDt3aWR0aDo2MHB4O21hcmdpbi10b3A6MXB4O3BhZGRpbmc6MDtib3JkZXI6MCIsYy5zdHlsZS5jc3NUZXh0PSJwb3NpdGlvbjpyZWxhdGl2ZTtkaXNwbGF5OmJsb2NrO2JveC1zaXppbmc6Ym9yZGVyLWJveDtvdmVyZmxvdzpzY3JvbGw7bWFyZ2luOmF1dG87Ym9yZGVyOjFweDtwYWRkaW5nOjFweDt3aWR0aDo2MCU7dG9wOjElIixiZS5hcHBlbmRDaGlsZChsKS5hcHBlbmRDaGlsZChjKTt2YXIgdD1lLmdldENvbXB1dGVkU3R5bGUoYyk7aT0iMSUiIT09dC50b3AsdT0xMj09PW4odC5tYXJnaW5MZWZ0KSxjLnN0eWxlLnJpZ2h0PSI2MCUiLHM9MzY9PT1uKHQucmlnaHQpLG89MzY9PT1uKHQud2lkdGgpLGMuc3R5bGUucG9zaXRpb249ImFic29sdXRlIixhPTM2PT09Yy5vZmZzZXRXaWR0aHx8ImFic29sdXRlIixiZS5yZW1vdmVDaGlsZChsKSxjPW51bGx9fWZ1bmN0aW9uIG4oZSl7cmV0dXJuIE1hdGgucm91bmQocGFyc2VGbG9hdChlKSl9dmFyIGksbyxhLHMsdSxsPXIuY3JlYXRlRWxlbWVudCgiZGl2IiksYz1yLmNyZWF0ZUVsZW1lbnQoImRpdiIpO2Muc3R5bGUmJihjLnN0eWxlLmJhY2tncm91bmRDbGlwPSJjb250ZW50LWJveCIsYy5jbG9uZU5vZGUoITApLnN0eWxlLmJhY2tncm91bmRDbGlwPSIiLGguY2xlYXJDbG9uZVN0eWxlPSJjb250ZW50LWJveCI9PT1jLnN0eWxlLmJhY2tncm91bmRDbGlwLHcuZXh0ZW5kKGgse2JveFNpemluZ1JlbGlhYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIHQoKSxvfSxwaXhlbEJveFN0eWxlczpmdW5jdGlvbigpe3JldHVybiB0KCksc30scGl4ZWxQb3NpdGlvbjpmdW5jdGlvbigpe3JldHVybiB0KCksaX0scmVsaWFibGVNYXJnaW5MZWZ0OmZ1bmN0aW9uKCl7cmV0dXJuIHQoKSx1fSxzY3JvbGxib3hTaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHQoKSxhfX0pKX0oKTtmdW5jdGlvbiBGZShlLHQsbil7dmFyIHIsaSxvLGEscz1lLnN0eWxlO3JldHVybihuPW58fCRlKGUpKSYmKCIiIT09KGE9bi5nZXRQcm9wZXJ0eVZhbHVlKHQpfHxuW3RdKXx8dy5jb250YWlucyhlLm93bmVyRG9jdW1lbnQsZSl8fChhPXcuc3R5bGUoZSx0KSksIWgucGl4ZWxCb3hTdHlsZXMoKSYmV2UudGVzdChhKSYmQmUudGVzdCh0KSYmKHI9cy53aWR0aCxpPXMubWluV2lkdGgsbz1zLm1heFdpZHRoLHMubWluV2lkdGg9cy5tYXhXaWR0aD1zLndpZHRoPWEsYT1uLndpZHRoLHMud2lkdGg9cixzLm1pbldpZHRoPWkscy5tYXhXaWR0aD1vKSksdm9pZCAwIT09YT9hKyIiOmF9ZnVuY3Rpb24gX2UoZSx0KXtyZXR1cm57Z2V0OmZ1bmN0aW9uKCl7aWYoIWUoKSlyZXR1cm4odGhpcy5nZXQ9dCkuYXBwbHkodGhpcyxhcmd1bWVudHMpO2RlbGV0ZSB0aGlzLmdldH19fXZhciB6ZT0vXihub25lfHRhYmxlKD8hLWNbZWFdKS4rKS8sWGU9L14tLS8sVWU9e3Bvc2l0aW9uOiJhYnNvbHV0ZSIsdmlzaWJpbGl0eToiaGlkZGVuIixkaXNwbGF5OiJibG9jayJ9LFZlPXtsZXR0ZXJTcGFjaW5nOiIwIixmb250V2VpZ2h0OiI0MDAifSxHZT1bIldlYmtpdCIsIk1veiIsIm1zIl0sWWU9ci5jcmVhdGVFbGVtZW50KCJkaXYiKS5zdHlsZTtmdW5jdGlvbiBRZShlKXtpZihlIGluIFllKXJldHVybiBlO3ZhciB0PWVbMF0udG9VcHBlckNhc2UoKStlLnNsaWNlKDEpLG49R2UubGVuZ3RoO3doaWxlKG4tLSlpZigoZT1HZVtuXSt0KWluIFllKXJldHVybiBlfWZ1bmN0aW9uIEplKGUpe3ZhciB0PXcuY3NzUHJvcHNbZV07cmV0dXJuIHR8fCh0PXcuY3NzUHJvcHNbZV09UWUoZSl8fGUpLHR9ZnVuY3Rpb24gS2UoZSx0LG4pe3ZhciByPWllLmV4ZWModCk7cmV0dXJuIHI/TWF0aC5tYXgoMCxyWzJdLShufHwwKSkrKHJbM118fCJweCIpOnR9ZnVuY3Rpb24gWmUoZSx0LG4scixpLG8pe3ZhciBhPSJ3aWR0aCI9PT10PzE6MCxzPTAsdT0wO2lmKG49PT0ocj8iYm9yZGVyIjoiY29udGVudCIpKXJldHVybiAwO2Zvcig7YTw0O2ErPTIpIm1hcmdpbiI9PT1uJiYodSs9dy5jc3MoZSxuK29lW2FdLCEwLGkpKSxyPygiY29udGVudCI9PT1uJiYodS09dy5jc3MoZSwicGFkZGluZyIrb2VbYV0sITAsaSkpLCJtYXJnaW4iIT09biYmKHUtPXcuY3NzKGUsImJvcmRlciIrb2VbYV0rIldpZHRoIiwhMCxpKSkpOih1Kz13LmNzcyhlLCJwYWRkaW5nIitvZVthXSwhMCxpKSwicGFkZGluZyIhPT1uP3UrPXcuY3NzKGUsImJvcmRlciIrb2VbYV0rIldpZHRoIiwhMCxpKTpzKz13LmNzcyhlLCJib3JkZXIiK29lW2FdKyJXaWR0aCIsITAsaSkpO3JldHVybiFyJiZvPj0wJiYodSs9TWF0aC5tYXgoMCxNYXRoLmNlaWwoZVsib2Zmc2V0Iit0WzBdLnRvVXBwZXJDYXNlKCkrdC5zbGljZSgxKV0tby11LXMtLjUpKSksdX1mdW5jdGlvbiBldChlLHQsbil7dmFyIHI9JGUoZSksaT1GZShlLHQsciksbz0iYm9yZGVyLWJveCI9PT13LmNzcyhlLCJib3hTaXppbmciLCExLHIpLGE9bztpZihXZS50ZXN0KGkpKXtpZighbilyZXR1cm4gaTtpPSJhdXRvIn1yZXR1cm4gYT1hJiYoaC5ib3hTaXppbmdSZWxpYWJsZSgpfHxpPT09ZS5zdHlsZVt0XSksKCJhdXRvIj09PWl8fCFwYXJzZUZsb2F0KGkpJiYiaW5saW5lIj09PXcuY3NzKGUsImRpc3BsYXkiLCExLHIpKSYmKGk9ZVsib2Zmc2V0Iit0WzBdLnRvVXBwZXJDYXNlKCkrdC5zbGljZSgxKV0sYT0hMCksKGk9cGFyc2VGbG9hdChpKXx8MCkrWmUoZSx0LG58fChvPyJib3JkZXIiOiJjb250ZW50IiksYSxyLGkpKyJweCJ9dy5leHRlbmQoe2Nzc0hvb2tzOntvcGFjaXR5OntnZXQ6ZnVuY3Rpb24oZSx0KXtpZih0KXt2YXIgbj1GZShlLCJvcGFjaXR5Iik7cmV0dXJuIiI9PT1uPyIxIjpufX19fSxjc3NOdW1iZXI6e2FuaW1hdGlvbkl0ZXJhdGlvbkNvdW50OiEwLGNvbHVtbkNvdW50OiEwLGZpbGxPcGFjaXR5OiEwLGZsZXhHcm93OiEwLGZsZXhTaHJpbms6ITAsZm9udFdlaWdodDohMCxsaW5lSGVpZ2h0OiEwLG9wYWNpdHk6ITAsb3JkZXI6ITAsb3JwaGFuczohMCx3aWRvd3M6ITAsekluZGV4OiEwLHpvb206ITB9LGNzc1Byb3BzOnt9LHN0eWxlOmZ1bmN0aW9uKGUsdCxuLHIpe2lmKGUmJjMhPT1lLm5vZGVUeXBlJiY4IT09ZS5ub2RlVHlwZSYmZS5zdHlsZSl7dmFyIGksbyxhLHM9Ryh0KSx1PVhlLnRlc3QodCksbD1lLnN0eWxlO2lmKHV8fCh0PUplKHMpKSxhPXcuY3NzSG9va3NbdF18fHcuY3NzSG9va3Nbc10sdm9pZCAwPT09bilyZXR1cm4gYSYmImdldCJpbiBhJiZ2b2lkIDAhPT0oaT1hLmdldChlLCExLHIpKT9pOmxbdF07InN0cmluZyI9PShvPXR5cGVvZiBuKSYmKGk9aWUuZXhlYyhuKSkmJmlbMV0mJihuPXVlKGUsdCxpKSxvPSJudW1iZXIiKSxudWxsIT1uJiZuPT09biYmKCJudW1iZXIiPT09byYmKG4rPWkmJmlbM118fCh3LmNzc051bWJlcltzXT8iIjoicHgiKSksaC5jbGVhckNsb25lU3R5bGV8fCIiIT09bnx8MCE9PXQuaW5kZXhPZigiYmFja2dyb3VuZCIpfHwobFt0XT0iaW5oZXJpdCIpLGEmJiJzZXQiaW4gYSYmdm9pZCAwPT09KG49YS5zZXQoZSxuLHIpKXx8KHU/bC5zZXRQcm9wZXJ0eSh0LG4pOmxbdF09bikpfX0sY3NzOmZ1bmN0aW9uKGUsdCxuLHIpe3ZhciBpLG8sYSxzPUcodCk7cmV0dXJuIFhlLnRlc3QodCl8fCh0PUplKHMpKSwoYT13LmNzc0hvb2tzW3RdfHx3LmNzc0hvb2tzW3NdKSYmImdldCJpbiBhJiYoaT1hLmdldChlLCEwLG4pKSx2b2lkIDA9PT1pJiYoaT1GZShlLHQscikpLCJub3JtYWwiPT09aSYmdCBpbiBWZSYmKGk9VmVbdF0pLCIiPT09bnx8bj8obz1wYXJzZUZsb2F0KGkpLCEwPT09bnx8aXNGaW5pdGUobyk/b3x8MDppKTppfX0pLHcuZWFjaChbImhlaWdodCIsIndpZHRoIl0sZnVuY3Rpb24oZSx0KXt3LmNzc0hvb2tzW3RdPXtnZXQ6ZnVuY3Rpb24oZSxuLHIpe2lmKG4pcmV0dXJuIXplLnRlc3Qody5jc3MoZSwiZGlzcGxheSIpKXx8ZS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCYmZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aD9ldChlLHQscik6c2UoZSxVZSxmdW5jdGlvbigpe3JldHVybiBldChlLHQscil9KX0sc2V0OmZ1bmN0aW9uKGUsbixyKXt2YXIgaSxvPSRlKGUpLGE9ImJvcmRlci1ib3giPT09dy5jc3MoZSwiYm94U2l6aW5nIiwhMSxvKSxzPXImJlplKGUsdCxyLGEsbyk7cmV0dXJuIGEmJmguc2Nyb2xsYm94U2l6ZSgpPT09by5wb3NpdGlvbiYmKHMtPU1hdGguY2VpbChlWyJvZmZzZXQiK3RbMF0udG9VcHBlckNhc2UoKSt0LnNsaWNlKDEpXS1wYXJzZUZsb2F0KG9bdF0pLVplKGUsdCwiYm9yZGVyIiwhMSxvKS0uNSkpLHMmJihpPWllLmV4ZWMobikpJiYicHgiIT09KGlbM118fCJweCIpJiYoZS5zdHlsZVt0XT1uLG49dy5jc3MoZSx0KSksS2UoZSxuLHMpfX19KSx3LmNzc0hvb2tzLm1hcmdpbkxlZnQ9X2UoaC5yZWxpYWJsZU1hcmdpbkxlZnQsZnVuY3Rpb24oZSx0KXtpZih0KXJldHVybihwYXJzZUZsb2F0KEZlKGUsIm1hcmdpbkxlZnQiKSl8fGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdC1zZShlLHttYXJnaW5MZWZ0OjB9LGZ1bmN0aW9uKCl7cmV0dXJuIGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdH0pKSsicHgifSksdy5lYWNoKHttYXJnaW46IiIscGFkZGluZzoiIixib3JkZXI6IldpZHRoIn0sZnVuY3Rpb24oZSx0KXt3LmNzc0hvb2tzW2UrdF09e2V4cGFuZDpmdW5jdGlvbihuKXtmb3IodmFyIHI9MCxpPXt9LG89InN0cmluZyI9PXR5cGVvZiBuP24uc3BsaXQoIiAiKTpbbl07cjw0O3IrKylpW2Urb2Vbcl0rdF09b1tyXXx8b1tyLTJdfHxvWzBdO3JldHVybiBpfX0sIm1hcmdpbiIhPT1lJiYody5jc3NIb29rc1tlK3RdLnNldD1LZSl9KSx3LmZuLmV4dGVuZCh7Y3NzOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHoodGhpcyxmdW5jdGlvbihlLHQsbil7dmFyIHIsaSxvPXt9LGE9MDtpZihBcnJheS5pc0FycmF5KHQpKXtmb3Iocj0kZShlKSxpPXQubGVuZ3RoO2E8aTthKyspb1t0W2FdXT13LmNzcyhlLHRbYV0sITEscik7cmV0dXJuIG99cmV0dXJuIHZvaWQgMCE9PW4/dy5zdHlsZShlLHQsbik6dy5jc3MoZSx0KX0sZSx0LGFyZ3VtZW50cy5sZW5ndGg+MSl9fSk7ZnVuY3Rpb24gdHQoZSx0LG4scixpKXtyZXR1cm4gbmV3IHR0LnByb3RvdHlwZS5pbml0KGUsdCxuLHIsaSl9dy5Ud2Vlbj10dCx0dC5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOnR0LGluaXQ6ZnVuY3Rpb24oZSx0LG4scixpLG8pe3RoaXMuZWxlbT1lLHRoaXMucHJvcD1uLHRoaXMuZWFzaW5nPWl8fHcuZWFzaW5nLl9kZWZhdWx0LHRoaXMub3B0aW9ucz10LHRoaXMuc3RhcnQ9dGhpcy5ub3c9dGhpcy5jdXIoKSx0aGlzLmVuZD1yLHRoaXMudW5pdD1vfHwody5jc3NOdW1iZXJbbl0/IiI6InB4Iil9LGN1cjpmdW5jdGlvbigpe3ZhciBlPXR0LnByb3BIb29rc1t0aGlzLnByb3BdO3JldHVybiBlJiZlLmdldD9lLmdldCh0aGlzKTp0dC5wcm9wSG9va3MuX2RlZmF1bHQuZ2V0KHRoaXMpfSxydW46ZnVuY3Rpb24oZSl7dmFyIHQsbj10dC5wcm9wSG9va3NbdGhpcy5wcm9wXTtyZXR1cm4gdGhpcy5vcHRpb25zLmR1cmF0aW9uP3RoaXMucG9zPXQ9dy5lYXNpbmdbdGhpcy5lYXNpbmddKGUsdGhpcy5vcHRpb25zLmR1cmF0aW9uKmUsMCwxLHRoaXMub3B0aW9ucy5kdXJhdGlvbik6dGhpcy5wb3M9dD1lLHRoaXMubm93PSh0aGlzLmVuZC10aGlzLnN0YXJ0KSp0K3RoaXMuc3RhcnQsdGhpcy5vcHRpb25zLnN0ZXAmJnRoaXMub3B0aW9ucy5zdGVwLmNhbGwodGhpcy5lbGVtLHRoaXMubm93LHRoaXMpLG4mJm4uc2V0P24uc2V0KHRoaXMpOnR0LnByb3BIb29rcy5fZGVmYXVsdC5zZXQodGhpcyksdGhpc319LHR0LnByb3RvdHlwZS5pbml0LnByb3RvdHlwZT10dC5wcm90b3R5cGUsdHQucHJvcEhvb2tzPXtfZGVmYXVsdDp7Z2V0OmZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiAxIT09ZS5lbGVtLm5vZGVUeXBlfHxudWxsIT1lLmVsZW1bZS5wcm9wXSYmbnVsbD09ZS5lbGVtLnN0eWxlW2UucHJvcF0/ZS5lbGVtW2UucHJvcF06KHQ9dy5jc3MoZS5lbGVtLGUucHJvcCwiIikpJiYiYXV0byIhPT10P3Q6MH0sc2V0OmZ1bmN0aW9uKGUpe3cuZnguc3RlcFtlLnByb3BdP3cuZnguc3RlcFtlLnByb3BdKGUpOjEhPT1lLmVsZW0ubm9kZVR5cGV8fG51bGw9PWUuZWxlbS5zdHlsZVt3LmNzc1Byb3BzW2UucHJvcF1dJiYhdy5jc3NIb29rc1tlLnByb3BdP2UuZWxlbVtlLnByb3BdPWUubm93Oncuc3R5bGUoZS5lbGVtLGUucHJvcCxlLm5vdytlLnVuaXQpfX19LHR0LnByb3BIb29rcy5zY3JvbGxUb3A9dHQucHJvcEhvb2tzLnNjcm9sbExlZnQ9e3NldDpmdW5jdGlvbihlKXtlLmVsZW0ubm9kZVR5cGUmJmUuZWxlbS5wYXJlbnROb2RlJiYoZS5lbGVtW2UucHJvcF09ZS5ub3cpfX0sdy5lYXNpbmc9e2xpbmVhcjpmdW5jdGlvbihlKXtyZXR1cm4gZX0sc3dpbmc6ZnVuY3Rpb24oZSl7cmV0dXJuLjUtTWF0aC5jb3MoZSpNYXRoLlBJKS8yfSxfZGVmYXVsdDoic3dpbmcifSx3LmZ4PXR0LnByb3RvdHlwZS5pbml0LHcuZnguc3RlcD17fTt2YXIgbnQscnQsaXQ9L14oPzp0b2dnbGV8c2hvd3xoaWRlKSQvLG90PS9xdWV1ZUhvb2tzJC87ZnVuY3Rpb24gYXQoKXtydCYmKCExPT09ci5oaWRkZW4mJmUucmVxdWVzdEFuaW1hdGlvbkZyYW1lP2UucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGF0KTplLnNldFRpbWVvdXQoYXQsdy5meC5pbnRlcnZhbCksdy5meC50aWNrKCkpfWZ1bmN0aW9uIHN0KCl7cmV0dXJuIGUuc2V0VGltZW91dChmdW5jdGlvbigpe250PXZvaWQgMH0pLG50PURhdGUubm93KCl9ZnVuY3Rpb24gdXQoZSx0KXt2YXIgbixyPTAsaT17aGVpZ2h0OmV9O2Zvcih0PXQ/MTowO3I8NDtyKz0yLXQpaVsibWFyZ2luIisobj1vZVtyXSldPWlbInBhZGRpbmciK25dPWU7cmV0dXJuIHQmJihpLm9wYWNpdHk9aS53aWR0aD1lKSxpfWZ1bmN0aW9uIGx0KGUsdCxuKXtmb3IodmFyIHIsaT0ocHQudHdlZW5lcnNbdF18fFtdKS5jb25jYXQocHQudHdlZW5lcnNbIioiXSksbz0wLGE9aS5sZW5ndGg7bzxhO28rKylpZihyPWlbb10uY2FsbChuLHQsZSkpcmV0dXJuIHJ9ZnVuY3Rpb24gY3QoZSx0LG4pe3ZhciByLGksbyxhLHMsdSxsLGMsZj0id2lkdGgiaW4gdHx8ImhlaWdodCJpbiB0LHA9dGhpcyxkPXt9LGg9ZS5zdHlsZSxnPWUubm9kZVR5cGUmJmFlKGUpLHk9Si5nZXQoZSwiZnhzaG93Iik7bi5xdWV1ZXx8KG51bGw9PShhPXcuX3F1ZXVlSG9va3MoZSwiZngiKSkudW5xdWV1ZWQmJihhLnVucXVldWVkPTAscz1hLmVtcHR5LmZpcmUsYS5lbXB0eS5maXJlPWZ1bmN0aW9uKCl7YS51bnF1ZXVlZHx8cygpfSksYS51bnF1ZXVlZCsrLHAuYWx3YXlzKGZ1bmN0aW9uKCl7cC5hbHdheXMoZnVuY3Rpb24oKXthLnVucXVldWVkLS0sdy5xdWV1ZShlLCJmeCIpLmxlbmd0aHx8YS5lbXB0eS5maXJlKCl9KX0pKTtmb3IociBpbiB0KWlmKGk9dFtyXSxpdC50ZXN0KGkpKXtpZihkZWxldGUgdFtyXSxvPW98fCJ0b2dnbGUiPT09aSxpPT09KGc/ImhpZGUiOiJzaG93Iikpe2lmKCJzaG93IiE9PWl8fCF5fHx2b2lkIDA9PT15W3JdKWNvbnRpbnVlO2c9ITB9ZFtyXT15JiZ5W3JdfHx3LnN0eWxlKGUscil9aWYoKHU9IXcuaXNFbXB0eU9iamVjdCh0KSl8fCF3LmlzRW1wdHlPYmplY3QoZCkpe2YmJjE9PT1lLm5vZGVUeXBlJiYobi5vdmVyZmxvdz1baC5vdmVyZmxvdyxoLm92ZXJmbG93WCxoLm92ZXJmbG93WV0sbnVsbD09KGw9eSYmeS5kaXNwbGF5KSYmKGw9Si5nZXQoZSwiZGlzcGxheSIpKSwibm9uZSI9PT0oYz13LmNzcyhlLCJkaXNwbGF5IikpJiYobD9jPWw6KGZlKFtlXSwhMCksbD1lLnN0eWxlLmRpc3BsYXl8fGwsYz13LmNzcyhlLCJkaXNwbGF5IiksZmUoW2VdKSkpLCgiaW5saW5lIj09PWN8fCJpbmxpbmUtYmxvY2siPT09YyYmbnVsbCE9bCkmJiJub25lIj09PXcuY3NzKGUsImZsb2F0IikmJih1fHwocC5kb25lKGZ1bmN0aW9uKCl7aC5kaXNwbGF5PWx9KSxudWxsPT1sJiYoYz1oLmRpc3BsYXksbD0ibm9uZSI9PT1jPyIiOmMpKSxoLmRpc3BsYXk9ImlubGluZS1ibG9jayIpKSxuLm92ZXJmbG93JiYoaC5vdmVyZmxvdz0iaGlkZGVuIixwLmFsd2F5cyhmdW5jdGlvbigpe2gub3ZlcmZsb3c9bi5vdmVyZmxvd1swXSxoLm92ZXJmbG93WD1uLm92ZXJmbG93WzFdLGgub3ZlcmZsb3dZPW4ub3ZlcmZsb3dbMl19KSksdT0hMTtmb3IociBpbiBkKXV8fCh5PyJoaWRkZW4iaW4geSYmKGc9eS5oaWRkZW4pOnk9Si5hY2Nlc3MoZSwiZnhzaG93Iix7ZGlzcGxheTpsfSksbyYmKHkuaGlkZGVuPSFnKSxnJiZmZShbZV0sITApLHAuZG9uZShmdW5jdGlvbigpe2d8fGZlKFtlXSksSi5yZW1vdmUoZSwiZnhzaG93Iik7Zm9yKHIgaW4gZCl3LnN0eWxlKGUscixkW3JdKX0pKSx1PWx0KGc/eVtyXTowLHIscCksciBpbiB5fHwoeVtyXT11LnN0YXJ0LGcmJih1LmVuZD11LnN0YXJ0LHUuc3RhcnQ9MCkpfX1mdW5jdGlvbiBmdChlLHQpe3ZhciBuLHIsaSxvLGE7Zm9yKG4gaW4gZSlpZihyPUcobiksaT10W3JdLG89ZVtuXSxBcnJheS5pc0FycmF5KG8pJiYoaT1vWzFdLG89ZVtuXT1vWzBdKSxuIT09ciYmKGVbcl09byxkZWxldGUgZVtuXSksKGE9dy5jc3NIb29rc1tyXSkmJiJleHBhbmQiaW4gYSl7bz1hLmV4cGFuZChvKSxkZWxldGUgZVtyXTtmb3IobiBpbiBvKW4gaW4gZXx8KGVbbl09b1tuXSx0W25dPWkpfWVsc2UgdFtyXT1pfWZ1bmN0aW9uIHB0KGUsdCxuKXt2YXIgcixpLG89MCxhPXB0LnByZWZpbHRlcnMubGVuZ3RoLHM9dy5EZWZlcnJlZCgpLmFsd2F5cyhmdW5jdGlvbigpe2RlbGV0ZSB1LmVsZW19KSx1PWZ1bmN0aW9uKCl7aWYoaSlyZXR1cm4hMTtmb3IodmFyIHQ9bnR8fHN0KCksbj1NYXRoLm1heCgwLGwuc3RhcnRUaW1lK2wuZHVyYXRpb24tdCkscj0xLShuL2wuZHVyYXRpb258fDApLG89MCxhPWwudHdlZW5zLmxlbmd0aDtvPGE7bysrKWwudHdlZW5zW29dLnJ1bihyKTtyZXR1cm4gcy5ub3RpZnlXaXRoKGUsW2wscixuXSkscjwxJiZhP246KGF8fHMubm90aWZ5V2l0aChlLFtsLDEsMF0pLHMucmVzb2x2ZVdpdGgoZSxbbF0pLCExKX0sbD1zLnByb21pc2Uoe2VsZW06ZSxwcm9wczp3LmV4dGVuZCh7fSx0KSxvcHRzOncuZXh0ZW5kKCEwLHtzcGVjaWFsRWFzaW5nOnt9LGVhc2luZzp3LmVhc2luZy5fZGVmYXVsdH0sbiksb3JpZ2luYWxQcm9wZXJ0aWVzOnQsb3JpZ2luYWxPcHRpb25zOm4sc3RhcnRUaW1lOm50fHxzdCgpLGR1cmF0aW9uOm4uZHVyYXRpb24sdHdlZW5zOltdLGNyZWF0ZVR3ZWVuOmZ1bmN0aW9uKHQsbil7dmFyIHI9dy5Ud2VlbihlLGwub3B0cyx0LG4sbC5vcHRzLnNwZWNpYWxFYXNpbmdbdF18fGwub3B0cy5lYXNpbmcpO3JldHVybiBsLnR3ZWVucy5wdXNoKHIpLHJ9LHN0b3A6ZnVuY3Rpb24odCl7dmFyIG49MCxyPXQ/bC50d2VlbnMubGVuZ3RoOjA7aWYoaSlyZXR1cm4gdGhpcztmb3IoaT0hMDtuPHI7bisrKWwudHdlZW5zW25dLnJ1bigxKTtyZXR1cm4gdD8ocy5ub3RpZnlXaXRoKGUsW2wsMSwwXSkscy5yZXNvbHZlV2l0aChlLFtsLHRdKSk6cy5yZWplY3RXaXRoKGUsW2wsdF0pLHRoaXN9fSksYz1sLnByb3BzO2ZvcihmdChjLGwub3B0cy5zcGVjaWFsRWFzaW5nKTtvPGE7bysrKWlmKHI9cHQucHJlZmlsdGVyc1tvXS5jYWxsKGwsZSxjLGwub3B0cykpcmV0dXJuIGcoci5zdG9wKSYmKHcuX3F1ZXVlSG9va3MobC5lbGVtLGwub3B0cy5xdWV1ZSkuc3RvcD1yLnN0b3AuYmluZChyKSkscjtyZXR1cm4gdy5tYXAoYyxsdCxsKSxnKGwub3B0cy5zdGFydCkmJmwub3B0cy5zdGFydC5jYWxsKGUsbCksbC5wcm9ncmVzcyhsLm9wdHMucHJvZ3Jlc3MpLmRvbmUobC5vcHRzLmRvbmUsbC5vcHRzLmNvbXBsZXRlKS5mYWlsKGwub3B0cy5mYWlsKS5hbHdheXMobC5vcHRzLmFsd2F5cyksdy5meC50aW1lcih3LmV4dGVuZCh1LHtlbGVtOmUsYW5pbTpsLHF1ZXVlOmwub3B0cy5xdWV1ZX0pKSxsfXcuQW5pbWF0aW9uPXcuZXh0ZW5kKHB0LHt0d2VlbmVyczp7IioiOltmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMuY3JlYXRlVHdlZW4oZSx0KTtyZXR1cm4gdWUobi5lbGVtLGUsaWUuZXhlYyh0KSxuKSxufV19LHR3ZWVuZXI6ZnVuY3Rpb24oZSx0KXtnKGUpPyh0PWUsZT1bIioiXSk6ZT1lLm1hdGNoKE0pO2Zvcih2YXIgbixyPTAsaT1lLmxlbmd0aDtyPGk7cisrKW49ZVtyXSxwdC50d2VlbmVyc1tuXT1wdC50d2VlbmVyc1tuXXx8W10scHQudHdlZW5lcnNbbl0udW5zaGlmdCh0KX0scHJlZmlsdGVyczpbY3RdLHByZWZpbHRlcjpmdW5jdGlvbihlLHQpe3Q/cHQucHJlZmlsdGVycy51bnNoaWZ0KGUpOnB0LnByZWZpbHRlcnMucHVzaChlKX19KSx3LnNwZWVkPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1lJiYib2JqZWN0Ij09dHlwZW9mIGU/dy5leHRlbmQoe30sZSk6e2NvbXBsZXRlOm58fCFuJiZ0fHxnKGUpJiZlLGR1cmF0aW9uOmUsZWFzaW5nOm4mJnR8fHQmJiFnKHQpJiZ0fTtyZXR1cm4gdy5meC5vZmY/ci5kdXJhdGlvbj0wOiJudW1iZXIiIT10eXBlb2Ygci5kdXJhdGlvbiYmKHIuZHVyYXRpb24gaW4gdy5meC5zcGVlZHM/ci5kdXJhdGlvbj13LmZ4LnNwZWVkc1tyLmR1cmF0aW9uXTpyLmR1cmF0aW9uPXcuZnguc3BlZWRzLl9kZWZhdWx0KSxudWxsIT1yLnF1ZXVlJiYhMCE9PXIucXVldWV8fChyLnF1ZXVlPSJmeCIpLHIub2xkPXIuY29tcGxldGUsci5jb21wbGV0ZT1mdW5jdGlvbigpe2coci5vbGQpJiZyLm9sZC5jYWxsKHRoaXMpLHIucXVldWUmJncuZGVxdWV1ZSh0aGlzLHIucXVldWUpfSxyfSx3LmZuLmV4dGVuZCh7ZmFkZVRvOmZ1bmN0aW9uKGUsdCxuLHIpe3JldHVybiB0aGlzLmZpbHRlcihhZSkuY3NzKCJvcGFjaXR5IiwwKS5zaG93KCkuZW5kKCkuYW5pbWF0ZSh7b3BhY2l0eTp0fSxlLG4scil9LGFuaW1hdGU6ZnVuY3Rpb24oZSx0LG4scil7dmFyIGk9dy5pc0VtcHR5T2JqZWN0KGUpLG89dy5zcGVlZCh0LG4sciksYT1mdW5jdGlvbigpe3ZhciB0PXB0KHRoaXMsdy5leHRlbmQoe30sZSksbyk7KGl8fEouZ2V0KHRoaXMsImZpbmlzaCIpKSYmdC5zdG9wKCEwKX07cmV0dXJuIGEuZmluaXNoPWEsaXx8ITE9PT1vLnF1ZXVlP3RoaXMuZWFjaChhKTp0aGlzLnF1ZXVlKG8ucXVldWUsYSl9LHN0b3A6ZnVuY3Rpb24oZSx0LG4pe3ZhciByPWZ1bmN0aW9uKGUpe3ZhciB0PWUuc3RvcDtkZWxldGUgZS5zdG9wLHQobil9O3JldHVybiJzdHJpbmciIT10eXBlb2YgZSYmKG49dCx0PWUsZT12b2lkIDApLHQmJiExIT09ZSYmdGhpcy5xdWV1ZShlfHwiZngiLFtdKSx0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdD0hMCxpPW51bGwhPWUmJmUrInF1ZXVlSG9va3MiLG89dy50aW1lcnMsYT1KLmdldCh0aGlzKTtpZihpKWFbaV0mJmFbaV0uc3RvcCYmcihhW2ldKTtlbHNlIGZvcihpIGluIGEpYVtpXSYmYVtpXS5zdG9wJiZvdC50ZXN0KGkpJiZyKGFbaV0pO2ZvcihpPW8ubGVuZ3RoO2ktLTspb1tpXS5lbGVtIT09dGhpc3x8bnVsbCE9ZSYmb1tpXS5xdWV1ZSE9PWV8fChvW2ldLmFuaW0uc3RvcChuKSx0PSExLG8uc3BsaWNlKGksMSkpOyF0JiZufHx3LmRlcXVldWUodGhpcyxlKX0pfSxmaW5pc2g6ZnVuY3Rpb24oZSl7cmV0dXJuITEhPT1lJiYoZT1lfHwiZngiKSx0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdCxuPUouZ2V0KHRoaXMpLHI9bltlKyJxdWV1ZSJdLGk9bltlKyJxdWV1ZUhvb2tzIl0sbz13LnRpbWVycyxhPXI/ci5sZW5ndGg6MDtmb3Iobi5maW5pc2g9ITAsdy5xdWV1ZSh0aGlzLGUsW10pLGkmJmkuc3RvcCYmaS5zdG9wLmNhbGwodGhpcywhMCksdD1vLmxlbmd0aDt0LS07KW9bdF0uZWxlbT09PXRoaXMmJm9bdF0ucXVldWU9PT1lJiYob1t0XS5hbmltLnN0b3AoITApLG8uc3BsaWNlKHQsMSkpO2Zvcih0PTA7dDxhO3QrKylyW3RdJiZyW3RdLmZpbmlzaCYmclt0XS5maW5pc2guY2FsbCh0aGlzKTtkZWxldGUgbi5maW5pc2h9KX19KSx3LmVhY2goWyJ0b2dnbGUiLCJzaG93IiwiaGlkZSJdLGZ1bmN0aW9uKGUsdCl7dmFyIG49dy5mblt0XTt3LmZuW3RdPWZ1bmN0aW9uKGUscixpKXtyZXR1cm4gbnVsbD09ZXx8ImJvb2xlYW4iPT10eXBlb2YgZT9uLmFwcGx5KHRoaXMsYXJndW1lbnRzKTp0aGlzLmFuaW1hdGUodXQodCwhMCksZSxyLGkpfX0pLHcuZWFjaCh7c2xpZGVEb3duOnV0KCJzaG93Iiksc2xpZGVVcDp1dCgiaGlkZSIpLHNsaWRlVG9nZ2xlOnV0KCJ0b2dnbGUiKSxmYWRlSW46e29wYWNpdHk6InNob3cifSxmYWRlT3V0OntvcGFjaXR5OiJoaWRlIn0sZmFkZVRvZ2dsZTp7b3BhY2l0eToidG9nZ2xlIn19LGZ1bmN0aW9uKGUsdCl7dy5mbltlXT1mdW5jdGlvbihlLG4scil7cmV0dXJuIHRoaXMuYW5pbWF0ZSh0LGUsbixyKX19KSx3LnRpbWVycz1bXSx3LmZ4LnRpY2s9ZnVuY3Rpb24oKXt2YXIgZSx0PTAsbj13LnRpbWVycztmb3IobnQ9RGF0ZS5ub3coKTt0PG4ubGVuZ3RoO3QrKykoZT1uW3RdKSgpfHxuW3RdIT09ZXx8bi5zcGxpY2UodC0tLDEpO24ubGVuZ3RofHx3LmZ4LnN0b3AoKSxudD12b2lkIDB9LHcuZngudGltZXI9ZnVuY3Rpb24oZSl7dy50aW1lcnMucHVzaChlKSx3LmZ4LnN0YXJ0KCl9LHcuZnguaW50ZXJ2YWw9MTMsdy5meC5zdGFydD1mdW5jdGlvbigpe3J0fHwocnQ9ITAsYXQoKSl9LHcuZnguc3RvcD1mdW5jdGlvbigpe3J0PW51bGx9LHcuZnguc3BlZWRzPXtzbG93OjYwMCxmYXN0OjIwMCxfZGVmYXVsdDo0MDB9LHcuZm4uZGVsYXk9ZnVuY3Rpb24odCxuKXtyZXR1cm4gdD13LmZ4P3cuZnguc3BlZWRzW3RdfHx0OnQsbj1ufHwiZngiLHRoaXMucXVldWUobixmdW5jdGlvbihuLHIpe3ZhciBpPWUuc2V0VGltZW91dChuLHQpO3Iuc3RvcD1mdW5jdGlvbigpe2UuY2xlYXJUaW1lb3V0KGkpfX0pfSxmdW5jdGlvbigpe3ZhciBlPXIuY3JlYXRlRWxlbWVudCgiaW5wdXQiKSx0PXIuY3JlYXRlRWxlbWVudCgic2VsZWN0IikuYXBwZW5kQ2hpbGQoci5jcmVhdGVFbGVtZW50KCJvcHRpb24iKSk7ZS50eXBlPSJjaGVja2JveCIsaC5jaGVja09uPSIiIT09ZS52YWx1ZSxoLm9wdFNlbGVjdGVkPXQuc2VsZWN0ZWQsKGU9ci5jcmVhdGVFbGVtZW50KCJpbnB1dCIpKS52YWx1ZT0idCIsZS50eXBlPSJyYWRpbyIsaC5yYWRpb1ZhbHVlPSJ0Ij09PWUudmFsdWV9KCk7dmFyIGR0LGh0PXcuZXhwci5hdHRySGFuZGxlO3cuZm4uZXh0ZW5kKHthdHRyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHoodGhpcyx3LmF0dHIsZSx0LGFyZ3VtZW50cy5sZW5ndGg+MSl9LHJlbW92ZUF0dHI6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3cucmVtb3ZlQXR0cih0aGlzLGUpfSl9fSksdy5leHRlbmQoe2F0dHI6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbz1lLm5vZGVUeXBlO2lmKDMhPT1vJiY4IT09byYmMiE9PW8pcmV0dXJuInVuZGVmaW5lZCI9PXR5cGVvZiBlLmdldEF0dHJpYnV0ZT93LnByb3AoZSx0LG4pOigxPT09byYmdy5pc1hNTERvYyhlKXx8KGk9dy5hdHRySG9va3NbdC50b0xvd2VyQ2FzZSgpXXx8KHcuZXhwci5tYXRjaC5ib29sLnRlc3QodCk/ZHQ6dm9pZCAwKSksdm9pZCAwIT09bj9udWxsPT09bj92b2lkIHcucmVtb3ZlQXR0cihlLHQpOmkmJiJzZXQiaW4gaSYmdm9pZCAwIT09KHI9aS5zZXQoZSxuLHQpKT9yOihlLnNldEF0dHJpYnV0ZSh0LG4rIiIpLG4pOmkmJiJnZXQiaW4gaSYmbnVsbCE9PShyPWkuZ2V0KGUsdCkpP3I6bnVsbD09KHI9dy5maW5kLmF0dHIoZSx0KSk/dm9pZCAwOnIpfSxhdHRySG9va3M6e3R5cGU6e3NldDpmdW5jdGlvbihlLHQpe2lmKCFoLnJhZGlvVmFsdWUmJiJyYWRpbyI9PT10JiZOKGUsImlucHV0Iikpe3ZhciBuPWUudmFsdWU7cmV0dXJuIGUuc2V0QXR0cmlidXRlKCJ0eXBlIix0KSxuJiYoZS52YWx1ZT1uKSx0fX19fSxyZW1vdmVBdHRyOmZ1bmN0aW9uKGUsdCl7dmFyIG4scj0wLGk9dCYmdC5tYXRjaChNKTtpZihpJiYxPT09ZS5ub2RlVHlwZSl3aGlsZShuPWlbcisrXSllLnJlbW92ZUF0dHJpYnV0ZShuKX19KSxkdD17c2V0OmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4hMT09PXQ/dy5yZW1vdmVBdHRyKGUsbik6ZS5zZXRBdHRyaWJ1dGUobixuKSxufX0sdy5lYWNoKHcuZXhwci5tYXRjaC5ib29sLnNvdXJjZS5tYXRjaCgvXHcrL2cpLGZ1bmN0aW9uKGUsdCl7dmFyIG49aHRbdF18fHcuZmluZC5hdHRyO2h0W3RdPWZ1bmN0aW9uKGUsdCxyKXt2YXIgaSxvLGE9dC50b0xvd2VyQ2FzZSgpO3JldHVybiByfHwobz1odFthXSxodFthXT1pLGk9bnVsbCE9bihlLHQscik/YTpudWxsLGh0W2FdPW8pLGl9fSk7dmFyIGd0PS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2kseXQ9L14oPzphfGFyZWEpJC9pO3cuZm4uZXh0ZW5kKHtwcm9wOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHoodGhpcyx3LnByb3AsZSx0LGFyZ3VtZW50cy5sZW5ndGg+MSl9LHJlbW92ZVByb3A6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2RlbGV0ZSB0aGlzW3cucHJvcEZpeFtlXXx8ZV19KX19KSx3LmV4dGVuZCh7cHJvcDpmdW5jdGlvbihlLHQsbil7dmFyIHIsaSxvPWUubm9kZVR5cGU7aWYoMyE9PW8mJjghPT1vJiYyIT09bylyZXR1cm4gMT09PW8mJncuaXNYTUxEb2MoZSl8fCh0PXcucHJvcEZpeFt0XXx8dCxpPXcucHJvcEhvb2tzW3RdKSx2b2lkIDAhPT1uP2kmJiJzZXQiaW4gaSYmdm9pZCAwIT09KHI9aS5zZXQoZSxuLHQpKT9yOmVbdF09bjppJiYiZ2V0ImluIGkmJm51bGwhPT0ocj1pLmdldChlLHQpKT9yOmVbdF19LHByb3BIb29rczp7dGFiSW5kZXg6e2dldDpmdW5jdGlvbihlKXt2YXIgdD13LmZpbmQuYXR0cihlLCJ0YWJpbmRleCIpO3JldHVybiB0P3BhcnNlSW50KHQsMTApOmd0LnRlc3QoZS5ub2RlTmFtZSl8fHl0LnRlc3QoZS5ub2RlTmFtZSkmJmUuaHJlZj8wOi0xfX19LHByb3BGaXg6eyJmb3IiOiJodG1sRm9yIiwiY2xhc3MiOiJjbGFzc05hbWUifX0pLGgub3B0U2VsZWN0ZWR8fCh3LnByb3BIb29rcy5zZWxlY3RlZD17Z2V0OmZ1bmN0aW9uKGUpe3ZhciB0PWUucGFyZW50Tm9kZTtyZXR1cm4gdCYmdC5wYXJlbnROb2RlJiZ0LnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCxudWxsfSxzZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXJlbnROb2RlO3QmJih0LnNlbGVjdGVkSW5kZXgsdC5wYXJlbnROb2RlJiZ0LnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCl9fSksdy5lYWNoKFsidGFiSW5kZXgiLCJyZWFkT25seSIsIm1heExlbmd0aCIsImNlbGxTcGFjaW5nIiwiY2VsbFBhZGRpbmciLCJyb3dTcGFuIiwiY29sU3BhbiIsInVzZU1hcCIsImZyYW1lQm9yZGVyIiwiY29udGVudEVkaXRhYmxlIl0sZnVuY3Rpb24oKXt3LnByb3BGaXhbdGhpcy50b0xvd2VyQ2FzZSgpXT10aGlzfSk7ZnVuY3Rpb24gdnQoZSl7cmV0dXJuKGUubWF0Y2goTSl8fFtdKS5qb2luKCIgIil9ZnVuY3Rpb24gbXQoZSl7cmV0dXJuIGUuZ2V0QXR0cmlidXRlJiZlLmdldEF0dHJpYnV0ZSgiY2xhc3MiKXx8IiJ9ZnVuY3Rpb24geHQoZSl7cmV0dXJuIEFycmF5LmlzQXJyYXkoZSk/ZToic3RyaW5nIj09dHlwZW9mIGU/ZS5tYXRjaChNKXx8W106W119dy5mbi5leHRlbmQoe2FkZENsYXNzOmZ1bmN0aW9uKGUpe3ZhciB0LG4scixpLG8sYSxzLHU9MDtpZihnKGUpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24odCl7dyh0aGlzKS5hZGRDbGFzcyhlLmNhbGwodGhpcyx0LG10KHRoaXMpKSl9KTtpZigodD14dChlKSkubGVuZ3RoKXdoaWxlKG49dGhpc1t1KytdKWlmKGk9bXQobikscj0xPT09bi5ub2RlVHlwZSYmIiAiK3Z0KGkpKyIgIil7YT0wO3doaWxlKG89dFthKytdKXIuaW5kZXhPZigiICIrbysiICIpPDAmJihyKz1vKyIgIik7aSE9PShzPXZ0KHIpKSYmbi5zZXRBdHRyaWJ1dGUoImNsYXNzIixzKX1yZXR1cm4gdGhpc30scmVtb3ZlQ2xhc3M6ZnVuY3Rpb24oZSl7dmFyIHQsbixyLGksbyxhLHMsdT0wO2lmKGcoZSkpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbih0KXt3KHRoaXMpLnJlbW92ZUNsYXNzKGUuY2FsbCh0aGlzLHQsbXQodGhpcykpKX0pO2lmKCFhcmd1bWVudHMubGVuZ3RoKXJldHVybiB0aGlzLmF0dHIoImNsYXNzIiwiIik7aWYoKHQ9eHQoZSkpLmxlbmd0aCl3aGlsZShuPXRoaXNbdSsrXSlpZihpPW10KG4pLHI9MT09PW4ubm9kZVR5cGUmJiIgIit2dChpKSsiICIpe2E9MDt3aGlsZShvPXRbYSsrXSl3aGlsZShyLmluZGV4T2YoIiAiK28rIiAiKT4tMSlyPXIucmVwbGFjZSgiICIrbysiICIsIiAiKTtpIT09KHM9dnQocikpJiZuLnNldEF0dHJpYnV0ZSgiY2xhc3MiLHMpfXJldHVybiB0aGlzfSx0b2dnbGVDbGFzczpmdW5jdGlvbihlLHQpe3ZhciBuPXR5cGVvZiBlLHI9InN0cmluZyI9PT1ufHxBcnJheS5pc0FycmF5KGUpO3JldHVybiJib29sZWFuIj09dHlwZW9mIHQmJnI/dD90aGlzLmFkZENsYXNzKGUpOnRoaXMucmVtb3ZlQ2xhc3MoZSk6ZyhlKT90aGlzLmVhY2goZnVuY3Rpb24obil7dyh0aGlzKS50b2dnbGVDbGFzcyhlLmNhbGwodGhpcyxuLG10KHRoaXMpLHQpLHQpfSk6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIHQsaSxvLGE7aWYocil7aT0wLG89dyh0aGlzKSxhPXh0KGUpO3doaWxlKHQ9YVtpKytdKW8uaGFzQ2xhc3ModCk/by5yZW1vdmVDbGFzcyh0KTpvLmFkZENsYXNzKHQpfWVsc2Ugdm9pZCAwIT09ZSYmImJvb2xlYW4iIT09bnx8KCh0PW10KHRoaXMpKSYmSi5zZXQodGhpcywiX19jbGFzc05hbWVfXyIsdCksdGhpcy5zZXRBdHRyaWJ1dGUmJnRoaXMuc2V0QXR0cmlidXRlKCJjbGFzcyIsdHx8ITE9PT1lPyIiOkouZ2V0KHRoaXMsIl9fY2xhc3NOYW1lX18iKXx8IiIpKX0pfSxoYXNDbGFzczpmdW5jdGlvbihlKXt2YXIgdCxuLHI9MDt0PSIgIitlKyIgIjt3aGlsZShuPXRoaXNbcisrXSlpZigxPT09bi5ub2RlVHlwZSYmKCIgIit2dChtdChuKSkrIiAiKS5pbmRleE9mKHQpPi0xKXJldHVybiEwO3JldHVybiExfX0pO3ZhciBidD0vXHIvZzt3LmZuLmV4dGVuZCh7dmFsOmZ1bmN0aW9uKGUpe3ZhciB0LG4scixpPXRoaXNbMF07e2lmKGFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHI9ZyhlKSx0aGlzLmVhY2goZnVuY3Rpb24obil7dmFyIGk7MT09PXRoaXMubm9kZVR5cGUmJihudWxsPT0oaT1yP2UuY2FsbCh0aGlzLG4sdyh0aGlzKS52YWwoKSk6ZSk/aT0iIjoibnVtYmVyIj09dHlwZW9mIGk/aSs9IiI6QXJyYXkuaXNBcnJheShpKSYmKGk9dy5tYXAoaSxmdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09ZT8iIjplKyIifSkpLCh0PXcudmFsSG9va3NbdGhpcy50eXBlXXx8dy52YWxIb29rc1t0aGlzLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldKSYmInNldCJpbiB0JiZ2b2lkIDAhPT10LnNldCh0aGlzLGksInZhbHVlIil8fCh0aGlzLnZhbHVlPWkpKX0pO2lmKGkpcmV0dXJuKHQ9dy52YWxIb29rc1tpLnR5cGVdfHx3LnZhbEhvb2tzW2kubm9kZU5hbWUudG9Mb3dlckNhc2UoKV0pJiYiZ2V0ImluIHQmJnZvaWQgMCE9PShuPXQuZ2V0KGksInZhbHVlIikpP246InN0cmluZyI9PXR5cGVvZihuPWkudmFsdWUpP24ucmVwbGFjZShidCwiIik6bnVsbD09bj8iIjpufX19KSx3LmV4dGVuZCh7dmFsSG9va3M6e29wdGlvbjp7Z2V0OmZ1bmN0aW9uKGUpe3ZhciB0PXcuZmluZC5hdHRyKGUsInZhbHVlIik7cmV0dXJuIG51bGwhPXQ/dDp2dCh3LnRleHQoZSkpfX0sc2VsZWN0OntnZXQ6ZnVuY3Rpb24oZSl7dmFyIHQsbixyLGk9ZS5vcHRpb25zLG89ZS5zZWxlY3RlZEluZGV4LGE9InNlbGVjdC1vbmUiPT09ZS50eXBlLHM9YT9udWxsOltdLHU9YT9vKzE6aS5sZW5ndGg7Zm9yKHI9bzwwP3U6YT9vOjA7cjx1O3IrKylpZigoKG49aVtyXSkuc2VsZWN0ZWR8fHI9PT1vKSYmIW4uZGlzYWJsZWQmJighbi5wYXJlbnROb2RlLmRpc2FibGVkfHwhTihuLnBhcmVudE5vZGUsIm9wdGdyb3VwIikpKXtpZih0PXcobikudmFsKCksYSlyZXR1cm4gdDtzLnB1c2godCl9cmV0dXJuIHN9LHNldDpmdW5jdGlvbihlLHQpe3ZhciBuLHIsaT1lLm9wdGlvbnMsbz13Lm1ha2VBcnJheSh0KSxhPWkubGVuZ3RoO3doaWxlKGEtLSkoKHI9aVthXSkuc2VsZWN0ZWQ9dy5pbkFycmF5KHcudmFsSG9va3Mub3B0aW9uLmdldChyKSxvKT4tMSkmJihuPSEwKTtyZXR1cm4gbnx8KGUuc2VsZWN0ZWRJbmRleD0tMSksb319fX0pLHcuZWFjaChbInJhZGlvIiwiY2hlY2tib3giXSxmdW5jdGlvbigpe3cudmFsSG9va3NbdGhpc109e3NldDpmdW5jdGlvbihlLHQpe2lmKEFycmF5LmlzQXJyYXkodCkpcmV0dXJuIGUuY2hlY2tlZD13LmluQXJyYXkodyhlKS52YWwoKSx0KT4tMX19LGguY2hlY2tPbnx8KHcudmFsSG9va3NbdGhpc10uZ2V0PWZ1bmN0aW9uKGUpe3JldHVybiBudWxsPT09ZS5nZXRBdHRyaWJ1dGUoInZhbHVlIik/Im9uIjplLnZhbHVlfSl9KSxoLmZvY3VzaW49Im9uZm9jdXNpbiJpbiBlO3ZhciB3dD0vXig/OmZvY3VzaW5mb2N1c3xmb2N1c291dGJsdXIpJC8sVHQ9ZnVuY3Rpb24oZSl7ZS5zdG9wUHJvcGFnYXRpb24oKX07dy5leHRlbmQody5ldmVudCx7dHJpZ2dlcjpmdW5jdGlvbih0LG4saSxvKXt2YXIgYSxzLHUsbCxjLHAsZCxoLHY9W2l8fHJdLG09Zi5jYWxsKHQsInR5cGUiKT90LnR5cGU6dCx4PWYuY2FsbCh0LCJuYW1lc3BhY2UiKT90Lm5hbWVzcGFjZS5zcGxpdCgiLiIpOltdO2lmKHM9aD11PWk9aXx8ciwzIT09aS5ub2RlVHlwZSYmOCE9PWkubm9kZVR5cGUmJiF3dC50ZXN0KG0rdy5ldmVudC50cmlnZ2VyZWQpJiYobS5pbmRleE9mKCIuIik+LTEmJihtPSh4PW0uc3BsaXQoIi4iKSkuc2hpZnQoKSx4LnNvcnQoKSksYz1tLmluZGV4T2YoIjoiKTwwJiYib24iK20sdD10W3cuZXhwYW5kb10/dDpuZXcgdy5FdmVudChtLCJvYmplY3QiPT10eXBlb2YgdCYmdCksdC5pc1RyaWdnZXI9bz8yOjMsdC5uYW1lc3BhY2U9eC5qb2luKCIuIiksdC5ybmFtZXNwYWNlPXQubmFtZXNwYWNlP25ldyBSZWdFeHAoIihefFxcLikiK3guam9pbigiXFwuKD86LipcXC58KSIpKyIoXFwufCQpIik6bnVsbCx0LnJlc3VsdD12b2lkIDAsdC50YXJnZXR8fCh0LnRhcmdldD1pKSxuPW51bGw9PW4/W3RdOncubWFrZUFycmF5KG4sW3RdKSxkPXcuZXZlbnQuc3BlY2lhbFttXXx8e30sb3x8IWQudHJpZ2dlcnx8ITEhPT1kLnRyaWdnZXIuYXBwbHkoaSxuKSkpe2lmKCFvJiYhZC5ub0J1YmJsZSYmIXkoaSkpe2ZvcihsPWQuZGVsZWdhdGVUeXBlfHxtLHd0LnRlc3QobCttKXx8KHM9cy5wYXJlbnROb2RlKTtzO3M9cy5wYXJlbnROb2RlKXYucHVzaChzKSx1PXM7dT09PShpLm93bmVyRG9jdW1lbnR8fHIpJiZ2LnB1c2godS5kZWZhdWx0Vmlld3x8dS5wYXJlbnRXaW5kb3d8fGUpfWE9MDt3aGlsZSgocz12W2ErK10pJiYhdC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpKWg9cyx0LnR5cGU9YT4xP2w6ZC5iaW5kVHlwZXx8bSwocD0oSi5nZXQocywiZXZlbnRzIil8fHt9KVt0LnR5cGVdJiZKLmdldChzLCJoYW5kbGUiKSkmJnAuYXBwbHkocyxuKSwocD1jJiZzW2NdKSYmcC5hcHBseSYmWShzKSYmKHQucmVzdWx0PXAuYXBwbHkocyxuKSwhMT09PXQucmVzdWx0JiZ0LnByZXZlbnREZWZhdWx0KCkpO3JldHVybiB0LnR5cGU9bSxvfHx0LmlzRGVmYXVsdFByZXZlbnRlZCgpfHxkLl9kZWZhdWx0JiYhMSE9PWQuX2RlZmF1bHQuYXBwbHkodi5wb3AoKSxuKXx8IVkoaSl8fGMmJmcoaVttXSkmJiF5KGkpJiYoKHU9aVtjXSkmJihpW2NdPW51bGwpLHcuZXZlbnQudHJpZ2dlcmVkPW0sdC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpJiZoLmFkZEV2ZW50TGlzdGVuZXIobSxUdCksaVttXSgpLHQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSYmaC5yZW1vdmVFdmVudExpc3RlbmVyKG0sVHQpLHcuZXZlbnQudHJpZ2dlcmVkPXZvaWQgMCx1JiYoaVtjXT11KSksdC5yZXN1bHR9fSxzaW11bGF0ZTpmdW5jdGlvbihlLHQsbil7dmFyIHI9dy5leHRlbmQobmV3IHcuRXZlbnQsbix7dHlwZTplLGlzU2ltdWxhdGVkOiEwfSk7dy5ldmVudC50cmlnZ2VyKHIsbnVsbCx0KX19KSx3LmZuLmV4dGVuZCh7dHJpZ2dlcjpmdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt3LmV2ZW50LnRyaWdnZXIoZSx0LHRoaXMpfSl9LHRyaWdnZXJIYW5kbGVyOmZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpc1swXTtpZihuKXJldHVybiB3LmV2ZW50LnRyaWdnZXIoZSx0LG4sITApfX0pLGguZm9jdXNpbnx8dy5lYWNoKHtmb2N1czoiZm9jdXNpbiIsYmx1cjoiZm9jdXNvdXQifSxmdW5jdGlvbihlLHQpe3ZhciBuPWZ1bmN0aW9uKGUpe3cuZXZlbnQuc2ltdWxhdGUodCxlLnRhcmdldCx3LmV2ZW50LmZpeChlKSl9O3cuZXZlbnQuc3BlY2lhbFt0XT17c2V0dXA6ZnVuY3Rpb24oKXt2YXIgcj10aGlzLm93bmVyRG9jdW1lbnR8fHRoaXMsaT1KLmFjY2VzcyhyLHQpO2l8fHIuYWRkRXZlbnRMaXN0ZW5lcihlLG4sITApLEouYWNjZXNzKHIsdCwoaXx8MCkrMSl9LHRlYXJkb3duOmZ1bmN0aW9uKCl7dmFyIHI9dGhpcy5vd25lckRvY3VtZW50fHx0aGlzLGk9Si5hY2Nlc3Mocix0KS0xO2k/Si5hY2Nlc3Mocix0LGkpOihyLnJlbW92ZUV2ZW50TGlzdGVuZXIoZSxuLCEwKSxKLnJlbW92ZShyLHQpKX19fSk7dmFyIEN0PWUubG9jYXRpb24sRXQ9RGF0ZS5ub3coKSxrdD0vXD8vO3cucGFyc2VYTUw9ZnVuY3Rpb24odCl7dmFyIG47aWYoIXR8fCJzdHJpbmciIT10eXBlb2YgdClyZXR1cm4gbnVsbDt0cnl7bj0obmV3IGUuRE9NUGFyc2VyKS5wYXJzZUZyb21TdHJpbmcodCwidGV4dC94bWwiKX1jYXRjaChlKXtuPXZvaWQgMH1yZXR1cm4gbiYmIW4uZ2V0RWxlbWVudHNCeVRhZ05hbWUoInBhcnNlcmVycm9yIikubGVuZ3RofHx3LmVycm9yKCJJbnZhbGlkIFhNTDogIit0KSxufTt2YXIgU3Q9L1xbXF0kLyxEdD0vXHI/XG4vZyxOdD0vXig/OnN1Ym1pdHxidXR0b258aW1hZ2V8cmVzZXR8ZmlsZSkkL2ksQXQ9L14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8a2V5Z2VuKS9pO2Z1bmN0aW9uIGp0KGUsdCxuLHIpe3ZhciBpO2lmKEFycmF5LmlzQXJyYXkodCkpdy5lYWNoKHQsZnVuY3Rpb24odCxpKXtufHxTdC50ZXN0KGUpP3IoZSxpKTpqdChlKyJbIisoIm9iamVjdCI9PXR5cGVvZiBpJiZudWxsIT1pP3Q6IiIpKyJdIixpLG4scil9KTtlbHNlIGlmKG58fCJvYmplY3QiIT09eCh0KSlyKGUsdCk7ZWxzZSBmb3IoaSBpbiB0KWp0KGUrIlsiK2krIl0iLHRbaV0sbixyKX13LnBhcmFtPWZ1bmN0aW9uKGUsdCl7dmFyIG4scj1bXSxpPWZ1bmN0aW9uKGUsdCl7dmFyIG49Zyh0KT90KCk6dDtyW3IubGVuZ3RoXT1lbmNvZGVVUklDb21wb25lbnQoZSkrIj0iK2VuY29kZVVSSUNvbXBvbmVudChudWxsPT1uPyIiOm4pfTtpZihBcnJheS5pc0FycmF5KGUpfHxlLmpxdWVyeSYmIXcuaXNQbGFpbk9iamVjdChlKSl3LmVhY2goZSxmdW5jdGlvbigpe2kodGhpcy5uYW1lLHRoaXMudmFsdWUpfSk7ZWxzZSBmb3IobiBpbiBlKWp0KG4sZVtuXSx0LGkpO3JldHVybiByLmpvaW4oIiYiKX0sdy5mbi5leHRlbmQoe3NlcmlhbGl6ZTpmdW5jdGlvbigpe3JldHVybiB3LnBhcmFtKHRoaXMuc2VyaWFsaXplQXJyYXkoKSl9LHNlcmlhbGl6ZUFycmF5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKCl7dmFyIGU9dy5wcm9wKHRoaXMsImVsZW1lbnRzIik7cmV0dXJuIGU/dy5tYWtlQXJyYXkoZSk6dGhpc30pLmZpbHRlcihmdW5jdGlvbigpe3ZhciBlPXRoaXMudHlwZTtyZXR1cm4gdGhpcy5uYW1lJiYhdyh0aGlzKS5pcygiOmRpc2FibGVkIikmJkF0LnRlc3QodGhpcy5ub2RlTmFtZSkmJiFOdC50ZXN0KGUpJiYodGhpcy5jaGVja2VkfHwhcGUudGVzdChlKSl9KS5tYXAoZnVuY3Rpb24oZSx0KXt2YXIgbj13KHRoaXMpLnZhbCgpO3JldHVybiBudWxsPT1uP251bGw6QXJyYXkuaXNBcnJheShuKT93Lm1hcChuLGZ1bmN0aW9uKGUpe3JldHVybntuYW1lOnQubmFtZSx2YWx1ZTplLnJlcGxhY2UoRHQsIlxyXG4iKX19KTp7bmFtZTp0Lm5hbWUsdmFsdWU6bi5yZXBsYWNlKER0LCJcclxuIil9fSkuZ2V0KCl9fSk7dmFyIHF0PS8lMjAvZyxMdD0vIy4qJC8sSHQ9LyhbPyZdKV89W14mXSovLE90PS9eKC4qPyk6WyBcdF0qKFteXHJcbl0qKSQvZ20sUHQ9L14oPzphYm91dHxhcHB8YXBwLXN0b3JhZ2V8ListZXh0ZW5zaW9ufGZpbGV8cmVzfHdpZGdldCk6JC8sTXQ9L14oPzpHRVR8SEVBRCkkLyxSdD0vXlwvXC8vLEl0PXt9LFd0PXt9LCR0PSIqLyIuY29uY2F0KCIqIiksQnQ9ci5jcmVhdGVFbGVtZW50KCJhIik7QnQuaHJlZj1DdC5ocmVmO2Z1bmN0aW9uIEZ0KGUpe3JldHVybiBmdW5jdGlvbih0LG4peyJzdHJpbmciIT10eXBlb2YgdCYmKG49dCx0PSIqIik7dmFyIHIsaT0wLG89dC50b0xvd2VyQ2FzZSgpLm1hdGNoKE0pfHxbXTtpZihnKG4pKXdoaWxlKHI9b1tpKytdKSIrIj09PXJbMF0/KHI9ci5zbGljZSgxKXx8IioiLChlW3JdPWVbcl18fFtdKS51bnNoaWZ0KG4pKTooZVtyXT1lW3JdfHxbXSkucHVzaChuKX19ZnVuY3Rpb24gX3QoZSx0LG4scil7dmFyIGk9e30sbz1lPT09V3Q7ZnVuY3Rpb24gYShzKXt2YXIgdTtyZXR1cm4gaVtzXT0hMCx3LmVhY2goZVtzXXx8W10sZnVuY3Rpb24oZSxzKXt2YXIgbD1zKHQsbixyKTtyZXR1cm4ic3RyaW5nIiE9dHlwZW9mIGx8fG98fGlbbF0/bz8hKHU9bCk6dm9pZCAwOih0LmRhdGFUeXBlcy51bnNoaWZ0KGwpLGEobCksITEpfSksdX1yZXR1cm4gYSh0LmRhdGFUeXBlc1swXSl8fCFpWyIqIl0mJmEoIioiKX1mdW5jdGlvbiB6dChlLHQpe3ZhciBuLHIsaT13LmFqYXhTZXR0aW5ncy5mbGF0T3B0aW9uc3x8e307Zm9yKG4gaW4gdCl2b2lkIDAhPT10W25dJiYoKGlbbl0/ZTpyfHwocj17fSkpW25dPXRbbl0pO3JldHVybiByJiZ3LmV4dGVuZCghMCxlLHIpLGV9ZnVuY3Rpb24gWHQoZSx0LG4pe3ZhciByLGksbyxhLHM9ZS5jb250ZW50cyx1PWUuZGF0YVR5cGVzO3doaWxlKCIqIj09PXVbMF0pdS5zaGlmdCgpLHZvaWQgMD09PXImJihyPWUubWltZVR5cGV8fHQuZ2V0UmVzcG9uc2VIZWFkZXIoIkNvbnRlbnQtVHlwZSIpKTtpZihyKWZvcihpIGluIHMpaWYoc1tpXSYmc1tpXS50ZXN0KHIpKXt1LnVuc2hpZnQoaSk7YnJlYWt9aWYodVswXWluIG4pbz11WzBdO2Vsc2V7Zm9yKGkgaW4gbil7aWYoIXVbMF18fGUuY29udmVydGVyc1tpKyIgIit1WzBdXSl7bz1pO2JyZWFrfWF8fChhPWkpfW89b3x8YX1pZihvKXJldHVybiBvIT09dVswXSYmdS51bnNoaWZ0KG8pLG5bb119ZnVuY3Rpb24gVXQoZSx0LG4scil7dmFyIGksbyxhLHMsdSxsPXt9LGM9ZS5kYXRhVHlwZXMuc2xpY2UoKTtpZihjWzFdKWZvcihhIGluIGUuY29udmVydGVycylsW2EudG9Mb3dlckNhc2UoKV09ZS5jb252ZXJ0ZXJzW2FdO289Yy5zaGlmdCgpO3doaWxlKG8paWYoZS5yZXNwb25zZUZpZWxkc1tvXSYmKG5bZS5yZXNwb25zZUZpZWxkc1tvXV09dCksIXUmJnImJmUuZGF0YUZpbHRlciYmKHQ9ZS5kYXRhRmlsdGVyKHQsZS5kYXRhVHlwZSkpLHU9byxvPWMuc2hpZnQoKSlpZigiKiI9PT1vKW89dTtlbHNlIGlmKCIqIiE9PXUmJnUhPT1vKXtpZighKGE9bFt1KyIgIitvXXx8bFsiKiAiK29dKSlmb3IoaSBpbiBsKWlmKChzPWkuc3BsaXQoIiAiKSlbMV09PT1vJiYoYT1sW3UrIiAiK3NbMF1dfHxsWyIqICIrc1swXV0pKXshMD09PWE/YT1sW2ldOiEwIT09bFtpXSYmKG89c1swXSxjLnVuc2hpZnQoc1sxXSkpO2JyZWFrfWlmKCEwIT09YSlpZihhJiZlWyJ0aHJvd3MiXSl0PWEodCk7ZWxzZSB0cnl7dD1hKHQpfWNhdGNoKGUpe3JldHVybntzdGF0ZToicGFyc2VyZXJyb3IiLGVycm9yOmE/ZToiTm8gY29udmVyc2lvbiBmcm9tICIrdSsiIHRvICIrb319fXJldHVybntzdGF0ZToic3VjY2VzcyIsZGF0YTp0fX13LmV4dGVuZCh7YWN0aXZlOjAsbGFzdE1vZGlmaWVkOnt9LGV0YWc6e30sYWpheFNldHRpbmdzOnt1cmw6Q3QuaHJlZix0eXBlOiJHRVQiLGlzTG9jYWw6UHQudGVzdChDdC5wcm90b2NvbCksZ2xvYmFsOiEwLHByb2Nlc3NEYXRhOiEwLGFzeW5jOiEwLGNvbnRlbnRUeXBlOiJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgiLGFjY2VwdHM6eyIqIjokdCx0ZXh0OiJ0ZXh0L3BsYWluIixodG1sOiJ0ZXh0L2h0bWwiLHhtbDoiYXBwbGljYXRpb24veG1sLCB0ZXh0L3htbCIsanNvbjoiYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0In0sY29udGVudHM6e3htbDovXGJ4bWxcYi8saHRtbDovXGJodG1sLyxqc29uOi9cYmpzb25cYi99LHJlc3BvbnNlRmllbGRzOnt4bWw6InJlc3BvbnNlWE1MIix0ZXh0OiJyZXNwb25zZVRleHQiLGpzb246InJlc3BvbnNlSlNPTiJ9LGNvbnZlcnRlcnM6eyIqIHRleHQiOlN0cmluZywidGV4dCBodG1sIjohMCwidGV4dCBqc29uIjpKU09OLnBhcnNlLCJ0ZXh0IHhtbCI6dy5wYXJzZVhNTH0sZmxhdE9wdGlvbnM6e3VybDohMCxjb250ZXh0OiEwfX0sYWpheFNldHVwOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQ/enQoenQoZSx3LmFqYXhTZXR0aW5ncyksdCk6enQody5hamF4U2V0dGluZ3MsZSl9LGFqYXhQcmVmaWx0ZXI6RnQoSXQpLGFqYXhUcmFuc3BvcnQ6RnQoV3QpLGFqYXg6ZnVuY3Rpb24odCxuKXsib2JqZWN0Ij09dHlwZW9mIHQmJihuPXQsdD12b2lkIDApLG49bnx8e307dmFyIGksbyxhLHMsdSxsLGMsZixwLGQsaD13LmFqYXhTZXR1cCh7fSxuKSxnPWguY29udGV4dHx8aCx5PWguY29udGV4dCYmKGcubm9kZVR5cGV8fGcuanF1ZXJ5KT93KGcpOncuZXZlbnQsdj13LkRlZmVycmVkKCksbT13LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSx4PWguc3RhdHVzQ29kZXx8e30sYj17fSxUPXt9LEM9ImNhbmNlbGVkIixFPXtyZWFkeVN0YXRlOjAsZ2V0UmVzcG9uc2VIZWFkZXI6ZnVuY3Rpb24oZSl7dmFyIHQ7aWYoYyl7aWYoIXMpe3M9e307d2hpbGUodD1PdC5leGVjKGEpKXNbdFsxXS50b0xvd2VyQ2FzZSgpXT10WzJdfXQ9c1tlLnRvTG93ZXJDYXNlKCldfXJldHVybiBudWxsPT10P251bGw6dH0sZ2V0QWxsUmVzcG9uc2VIZWFkZXJzOmZ1bmN0aW9uKCl7cmV0dXJuIGM/YTpudWxsfSxzZXRSZXF1ZXN0SGVhZGVyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIG51bGw9PWMmJihlPVRbZS50b0xvd2VyQ2FzZSgpXT1UW2UudG9Mb3dlckNhc2UoKV18fGUsYltlXT10KSx0aGlzfSxvdmVycmlkZU1pbWVUeXBlOmZ1bmN0aW9uKGUpe3JldHVybiBudWxsPT1jJiYoaC5taW1lVHlwZT1lKSx0aGlzfSxzdGF0dXNDb2RlOmZ1bmN0aW9uKGUpe3ZhciB0O2lmKGUpaWYoYylFLmFsd2F5cyhlW0Uuc3RhdHVzXSk7ZWxzZSBmb3IodCBpbiBlKXhbdF09W3hbdF0sZVt0XV07cmV0dXJuIHRoaXN9LGFib3J0OmZ1bmN0aW9uKGUpe3ZhciB0PWV8fEM7cmV0dXJuIGkmJmkuYWJvcnQodCksaygwLHQpLHRoaXN9fTtpZih2LnByb21pc2UoRSksaC51cmw9KCh0fHxoLnVybHx8Q3QuaHJlZikrIiIpLnJlcGxhY2UoUnQsQ3QucHJvdG9jb2wrIi8vIiksaC50eXBlPW4ubWV0aG9kfHxuLnR5cGV8fGgubWV0aG9kfHxoLnR5cGUsaC5kYXRhVHlwZXM9KGguZGF0YVR5cGV8fCIqIikudG9Mb3dlckNhc2UoKS5tYXRjaChNKXx8WyIiXSxudWxsPT1oLmNyb3NzRG9tYWluKXtsPXIuY3JlYXRlRWxlbWVudCgiYSIpO3RyeXtsLmhyZWY9aC51cmwsbC5ocmVmPWwuaHJlZixoLmNyb3NzRG9tYWluPUJ0LnByb3RvY29sKyIvLyIrQnQuaG9zdCE9bC5wcm90b2NvbCsiLy8iK2wuaG9zdH1jYXRjaChlKXtoLmNyb3NzRG9tYWluPSEwfX1pZihoLmRhdGEmJmgucHJvY2Vzc0RhdGEmJiJzdHJpbmciIT10eXBlb2YgaC5kYXRhJiYoaC5kYXRhPXcucGFyYW0oaC5kYXRhLGgudHJhZGl0aW9uYWwpKSxfdChJdCxoLG4sRSksYylyZXR1cm4gRTsoZj13LmV2ZW50JiZoLmdsb2JhbCkmJjA9PXcuYWN0aXZlKysmJncuZXZlbnQudHJpZ2dlcigiYWpheFN0YXJ0IiksaC50eXBlPWgudHlwZS50b1VwcGVyQ2FzZSgpLGguaGFzQ29udGVudD0hTXQudGVzdChoLnR5cGUpLG89aC51cmwucmVwbGFjZShMdCwiIiksaC5oYXNDb250ZW50P2guZGF0YSYmaC5wcm9jZXNzRGF0YSYmMD09PShoLmNvbnRlbnRUeXBlfHwiIikuaW5kZXhPZigiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIikmJihoLmRhdGE9aC5kYXRhLnJlcGxhY2UocXQsIisiKSk6KGQ9aC51cmwuc2xpY2Uoby5sZW5ndGgpLGguZGF0YSYmKGgucHJvY2Vzc0RhdGF8fCJzdHJpbmciPT10eXBlb2YgaC5kYXRhKSYmKG8rPShrdC50ZXN0KG8pPyImIjoiPyIpK2guZGF0YSxkZWxldGUgaC5kYXRhKSwhMT09PWguY2FjaGUmJihvPW8ucmVwbGFjZShIdCwiJDEiKSxkPShrdC50ZXN0KG8pPyImIjoiPyIpKyJfPSIrRXQrKytkKSxoLnVybD1vK2QpLGguaWZNb2RpZmllZCYmKHcubGFzdE1vZGlmaWVkW29dJiZFLnNldFJlcXVlc3RIZWFkZXIoIklmLU1vZGlmaWVkLVNpbmNlIix3Lmxhc3RNb2RpZmllZFtvXSksdy5ldGFnW29dJiZFLnNldFJlcXVlc3RIZWFkZXIoIklmLU5vbmUtTWF0Y2giLHcuZXRhZ1tvXSkpLChoLmRhdGEmJmguaGFzQ29udGVudCYmITEhPT1oLmNvbnRlbnRUeXBlfHxuLmNvbnRlbnRUeXBlKSYmRS5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLGguY29udGVudFR5cGUpLEUuc2V0UmVxdWVzdEhlYWRlcigiQWNjZXB0IixoLmRhdGFUeXBlc1swXSYmaC5hY2NlcHRzW2guZGF0YVR5cGVzWzBdXT9oLmFjY2VwdHNbaC5kYXRhVHlwZXNbMF1dKygiKiIhPT1oLmRhdGFUeXBlc1swXT8iLCAiKyR0KyI7IHE9MC4wMSI6IiIpOmguYWNjZXB0c1siKiJdKTtmb3IocCBpbiBoLmhlYWRlcnMpRS5zZXRSZXF1ZXN0SGVhZGVyKHAsaC5oZWFkZXJzW3BdKTtpZihoLmJlZm9yZVNlbmQmJighMT09PWguYmVmb3JlU2VuZC5jYWxsKGcsRSxoKXx8YykpcmV0dXJuIEUuYWJvcnQoKTtpZihDPSJhYm9ydCIsbS5hZGQoaC5jb21wbGV0ZSksRS5kb25lKGguc3VjY2VzcyksRS5mYWlsKGguZXJyb3IpLGk9X3QoV3QsaCxuLEUpKXtpZihFLnJlYWR5U3RhdGU9MSxmJiZ5LnRyaWdnZXIoImFqYXhTZW5kIixbRSxoXSksYylyZXR1cm4gRTtoLmFzeW5jJiZoLnRpbWVvdXQ+MCYmKHU9ZS5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7RS5hYm9ydCgidGltZW91dCIpfSxoLnRpbWVvdXQpKTt0cnl7Yz0hMSxpLnNlbmQoYixrKX1jYXRjaChlKXtpZihjKXRocm93IGU7aygtMSxlKX19ZWxzZSBrKC0xLCJObyBUcmFuc3BvcnQiKTtmdW5jdGlvbiBrKHQsbixyLHMpe3ZhciBsLHAsZCxiLFQsQz1uO2N8fChjPSEwLHUmJmUuY2xlYXJUaW1lb3V0KHUpLGk9dm9pZCAwLGE9c3x8IiIsRS5yZWFkeVN0YXRlPXQ+MD80OjAsbD10Pj0yMDAmJnQ8MzAwfHwzMDQ9PT10LHImJihiPVh0KGgsRSxyKSksYj1VdChoLGIsRSxsKSxsPyhoLmlmTW9kaWZpZWQmJigoVD1FLmdldFJlc3BvbnNlSGVhZGVyKCJMYXN0LU1vZGlmaWVkIikpJiYody5sYXN0TW9kaWZpZWRbb109VCksKFQ9RS5nZXRSZXNwb25zZUhlYWRlcigiZXRhZyIpKSYmKHcuZXRhZ1tvXT1UKSksMjA0PT09dHx8IkhFQUQiPT09aC50eXBlP0M9Im5vY29udGVudCI6MzA0PT09dD9DPSJub3Rtb2RpZmllZCI6KEM9Yi5zdGF0ZSxwPWIuZGF0YSxsPSEoZD1iLmVycm9yKSkpOihkPUMsIXQmJkN8fChDPSJlcnJvciIsdDwwJiYodD0wKSkpLEUuc3RhdHVzPXQsRS5zdGF0dXNUZXh0PShufHxDKSsiIixsP3YucmVzb2x2ZVdpdGgoZyxbcCxDLEVdKTp2LnJlamVjdFdpdGgoZyxbRSxDLGRdKSxFLnN0YXR1c0NvZGUoeCkseD12b2lkIDAsZiYmeS50cmlnZ2VyKGw/ImFqYXhTdWNjZXNzIjoiYWpheEVycm9yIixbRSxoLGw/cDpkXSksbS5maXJlV2l0aChnLFtFLENdKSxmJiYoeS50cmlnZ2VyKCJhamF4Q29tcGxldGUiLFtFLGhdKSwtLXcuYWN0aXZlfHx3LmV2ZW50LnRyaWdnZXIoImFqYXhTdG9wIikpKX1yZXR1cm4gRX0sZ2V0SlNPTjpmdW5jdGlvbihlLHQsbil7cmV0dXJuIHcuZ2V0KGUsdCxuLCJqc29uIil9LGdldFNjcmlwdDpmdW5jdGlvbihlLHQpe3JldHVybiB3LmdldChlLHZvaWQgMCx0LCJzY3JpcHQiKX19KSx3LmVhY2goWyJnZXQiLCJwb3N0Il0sZnVuY3Rpb24oZSx0KXt3W3RdPWZ1bmN0aW9uKGUsbixyLGkpe3JldHVybiBnKG4pJiYoaT1pfHxyLHI9bixuPXZvaWQgMCksdy5hamF4KHcuZXh0ZW5kKHt1cmw6ZSx0eXBlOnQsZGF0YVR5cGU6aSxkYXRhOm4sc3VjY2VzczpyfSx3LmlzUGxhaW5PYmplY3QoZSkmJmUpKX19KSx3Ll9ldmFsVXJsPWZ1bmN0aW9uKGUpe3JldHVybiB3LmFqYXgoe3VybDplLHR5cGU6IkdFVCIsZGF0YVR5cGU6InNjcmlwdCIsY2FjaGU6ITAsYXN5bmM6ITEsZ2xvYmFsOiExLCJ0aHJvd3MiOiEwfSl9LHcuZm4uZXh0ZW5kKHt3cmFwQWxsOmZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiB0aGlzWzBdJiYoZyhlKSYmKGU9ZS5jYWxsKHRoaXNbMF0pKSx0PXcoZSx0aGlzWzBdLm93bmVyRG9jdW1lbnQpLmVxKDApLmNsb25lKCEwKSx0aGlzWzBdLnBhcmVudE5vZGUmJnQuaW5zZXJ0QmVmb3JlKHRoaXNbMF0pLHQubWFwKGZ1bmN0aW9uKCl7dmFyIGU9dGhpczt3aGlsZShlLmZpcnN0RWxlbWVudENoaWxkKWU9ZS5maXJzdEVsZW1lbnRDaGlsZDtyZXR1cm4gZX0pLmFwcGVuZCh0aGlzKSksdGhpc30sd3JhcElubmVyOmZ1bmN0aW9uKGUpe3JldHVybiBnKGUpP3RoaXMuZWFjaChmdW5jdGlvbih0KXt3KHRoaXMpLndyYXBJbm5lcihlLmNhbGwodGhpcyx0KSl9KTp0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdD13KHRoaXMpLG49dC5jb250ZW50cygpO24ubGVuZ3RoP24ud3JhcEFsbChlKTp0LmFwcGVuZChlKX0pfSx3cmFwOmZ1bmN0aW9uKGUpe3ZhciB0PWcoZSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihuKXt3KHRoaXMpLndyYXBBbGwodD9lLmNhbGwodGhpcyxuKTplKX0pfSx1bndyYXA6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucGFyZW50KGUpLm5vdCgiYm9keSIpLmVhY2goZnVuY3Rpb24oKXt3KHRoaXMpLnJlcGxhY2VXaXRoKHRoaXMuY2hpbGROb2Rlcyl9KSx0aGlzfX0pLHcuZXhwci5wc2V1ZG9zLmhpZGRlbj1mdW5jdGlvbihlKXtyZXR1cm4hdy5leHByLnBzZXVkb3MudmlzaWJsZShlKX0sdy5leHByLnBzZXVkb3MudmlzaWJsZT1mdW5jdGlvbihlKXtyZXR1cm4hIShlLm9mZnNldFdpZHRofHxlLm9mZnNldEhlaWdodHx8ZS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCl9LHcuYWpheFNldHRpbmdzLnhocj1mdW5jdGlvbigpe3RyeXtyZXR1cm4gbmV3IGUuWE1MSHR0cFJlcXVlc3R9Y2F0Y2goZSl7fX07dmFyIFZ0PXswOjIwMCwxMjIzOjIwNH0sR3Q9dy5hamF4U2V0dGluZ3MueGhyKCk7aC5jb3JzPSEhR3QmJiJ3aXRoQ3JlZGVudGlhbHMiaW4gR3QsaC5hamF4PUd0PSEhR3Qsdy5hamF4VHJhbnNwb3J0KGZ1bmN0aW9uKHQpe3ZhciBuLHI7aWYoaC5jb3JzfHxHdCYmIXQuY3Jvc3NEb21haW4pcmV0dXJue3NlbmQ6ZnVuY3Rpb24oaSxvKXt2YXIgYSxzPXQueGhyKCk7aWYocy5vcGVuKHQudHlwZSx0LnVybCx0LmFzeW5jLHQudXNlcm5hbWUsdC5wYXNzd29yZCksdC54aHJGaWVsZHMpZm9yKGEgaW4gdC54aHJGaWVsZHMpc1thXT10LnhockZpZWxkc1thXTt0Lm1pbWVUeXBlJiZzLm92ZXJyaWRlTWltZVR5cGUmJnMub3ZlcnJpZGVNaW1lVHlwZSh0Lm1pbWVUeXBlKSx0LmNyb3NzRG9tYWlufHxpWyJYLVJlcXVlc3RlZC1XaXRoIl18fChpWyJYLVJlcXVlc3RlZC1XaXRoIl09IlhNTEh0dHBSZXF1ZXN0Iik7Zm9yKGEgaW4gaSlzLnNldFJlcXVlc3RIZWFkZXIoYSxpW2FdKTtuPWZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbigpe24mJihuPXI9cy5vbmxvYWQ9cy5vbmVycm9yPXMub25hYm9ydD1zLm9udGltZW91dD1zLm9ucmVhZHlzdGF0ZWNoYW5nZT1udWxsLCJhYm9ydCI9PT1lP3MuYWJvcnQoKToiZXJyb3IiPT09ZT8ibnVtYmVyIiE9dHlwZW9mIHMuc3RhdHVzP28oMCwiZXJyb3IiKTpvKHMuc3RhdHVzLHMuc3RhdHVzVGV4dCk6byhWdFtzLnN0YXR1c118fHMuc3RhdHVzLHMuc3RhdHVzVGV4dCwidGV4dCIhPT0ocy5yZXNwb25zZVR5cGV8fCJ0ZXh0Iil8fCJzdHJpbmciIT10eXBlb2Ygcy5yZXNwb25zZVRleHQ/e2JpbmFyeTpzLnJlc3BvbnNlfTp7dGV4dDpzLnJlc3BvbnNlVGV4dH0scy5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSkpfX0scy5vbmxvYWQ9bigpLHI9cy5vbmVycm9yPXMub250aW1lb3V0PW4oImVycm9yIiksdm9pZCAwIT09cy5vbmFib3J0P3Mub25hYm9ydD1yOnMub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7ND09PXMucmVhZHlTdGF0ZSYmZS5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7biYmcigpfSl9LG49bigiYWJvcnQiKTt0cnl7cy5zZW5kKHQuaGFzQ29udGVudCYmdC5kYXRhfHxudWxsKX1jYXRjaChlKXtpZihuKXRocm93IGV9fSxhYm9ydDpmdW5jdGlvbigpe24mJm4oKX19fSksdy5hamF4UHJlZmlsdGVyKGZ1bmN0aW9uKGUpe2UuY3Jvc3NEb21haW4mJihlLmNvbnRlbnRzLnNjcmlwdD0hMSl9KSx3LmFqYXhTZXR1cCh7YWNjZXB0czp7c2NyaXB0OiJ0ZXh0L2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2VjbWFzY3JpcHQsIGFwcGxpY2F0aW9uL3gtZWNtYXNjcmlwdCJ9LGNvbnRlbnRzOntzY3JpcHQ6L1xiKD86amF2YXxlY21hKXNjcmlwdFxiL30sY29udmVydGVyczp7InRleHQgc2NyaXB0IjpmdW5jdGlvbihlKXtyZXR1cm4gdy5nbG9iYWxFdmFsKGUpLGV9fX0pLHcuYWpheFByZWZpbHRlcigic2NyaXB0IixmdW5jdGlvbihlKXt2b2lkIDA9PT1lLmNhY2hlJiYoZS5jYWNoZT0hMSksZS5jcm9zc0RvbWFpbiYmKGUudHlwZT0iR0VUIil9KSx3LmFqYXhUcmFuc3BvcnQoInNjcmlwdCIsZnVuY3Rpb24oZSl7aWYoZS5jcm9zc0RvbWFpbil7dmFyIHQsbjtyZXR1cm57c2VuZDpmdW5jdGlvbihpLG8pe3Q9dygiPHNjcmlwdD4iKS5wcm9wKHtjaGFyc2V0OmUuc2NyaXB0Q2hhcnNldCxzcmM6ZS51cmx9KS5vbigibG9hZCBlcnJvciIsbj1mdW5jdGlvbihlKXt0LnJlbW92ZSgpLG49bnVsbCxlJiZvKCJlcnJvciI9PT1lLnR5cGU/NDA0OjIwMCxlLnR5cGUpfSksci5oZWFkLmFwcGVuZENoaWxkKHRbMF0pfSxhYm9ydDpmdW5jdGlvbigpe24mJm4oKX19fX0pO3ZhciBZdD1bXSxRdD0vKD0pXD8oPz0mfCQpfFw/XD8vO3cuYWpheFNldHVwKHtqc29ucDoiY2FsbGJhY2siLGpzb25wQ2FsbGJhY2s6ZnVuY3Rpb24oKXt2YXIgZT1ZdC5wb3AoKXx8dy5leHBhbmRvKyJfIitFdCsrO3JldHVybiB0aGlzW2VdPSEwLGV9fSksdy5hamF4UHJlZmlsdGVyKCJqc29uIGpzb25wIixmdW5jdGlvbih0LG4scil7dmFyIGksbyxhLHM9ITEhPT10Lmpzb25wJiYoUXQudGVzdCh0LnVybCk/InVybCI6InN0cmluZyI9PXR5cGVvZiB0LmRhdGEmJjA9PT0odC5jb250ZW50VHlwZXx8IiIpLmluZGV4T2YoImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpJiZRdC50ZXN0KHQuZGF0YSkmJiJkYXRhIik7aWYoc3x8Impzb25wIj09PXQuZGF0YVR5cGVzWzBdKXJldHVybiBpPXQuanNvbnBDYWxsYmFjaz1nKHQuanNvbnBDYWxsYmFjayk/dC5qc29ucENhbGxiYWNrKCk6dC5qc29ucENhbGxiYWNrLHM/dFtzXT10W3NdLnJlcGxhY2UoUXQsIiQxIitpKTohMSE9PXQuanNvbnAmJih0LnVybCs9KGt0LnRlc3QodC51cmwpPyImIjoiPyIpK3QuanNvbnArIj0iK2kpLHQuY29udmVydGVyc1sic2NyaXB0IGpzb24iXT1mdW5jdGlvbigpe3JldHVybiBhfHx3LmVycm9yKGkrIiB3YXMgbm90IGNhbGxlZCIpLGFbMF19LHQuZGF0YVR5cGVzWzBdPSJqc29uIixvPWVbaV0sZVtpXT1mdW5jdGlvbigpe2E9YXJndW1lbnRzfSxyLmFsd2F5cyhmdW5jdGlvbigpe3ZvaWQgMD09PW8/dyhlKS5yZW1vdmVQcm9wKGkpOmVbaV09byx0W2ldJiYodC5qc29ucENhbGxiYWNrPW4uanNvbnBDYWxsYmFjayxZdC5wdXNoKGkpKSxhJiZnKG8pJiZvKGFbMF0pLGE9bz12b2lkIDB9KSwic2NyaXB0In0pLGguY3JlYXRlSFRNTERvY3VtZW50PWZ1bmN0aW9uKCl7dmFyIGU9ci5pbXBsZW1lbnRhdGlvbi5jcmVhdGVIVE1MRG9jdW1lbnQoIiIpLmJvZHk7cmV0dXJuIGUuaW5uZXJIVE1MPSI8Zm9ybT48L2Zvcm0+PGZvcm0+PC9mb3JtPiIsMj09PWUuY2hpbGROb2Rlcy5sZW5ndGh9KCksdy5wYXJzZUhUTUw9ZnVuY3Rpb24oZSx0LG4pe2lmKCJzdHJpbmciIT10eXBlb2YgZSlyZXR1cm5bXTsiYm9vbGVhbiI9PXR5cGVvZiB0JiYobj10LHQ9ITEpO3ZhciBpLG8sYTtyZXR1cm4gdHx8KGguY3JlYXRlSFRNTERvY3VtZW50PygoaT0odD1yLmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudCgiIikpLmNyZWF0ZUVsZW1lbnQoImJhc2UiKSkuaHJlZj1yLmxvY2F0aW9uLmhyZWYsdC5oZWFkLmFwcGVuZENoaWxkKGkpKTp0PXIpLG89QS5leGVjKGUpLGE9IW4mJltdLG8/W3QuY3JlYXRlRWxlbWVudChvWzFdKV06KG89eGUoW2VdLHQsYSksYSYmYS5sZW5ndGgmJncoYSkucmVtb3ZlKCksdy5tZXJnZShbXSxvLmNoaWxkTm9kZXMpKX0sdy5mbi5sb2FkPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG8sYT10aGlzLHM9ZS5pbmRleE9mKCIgIik7cmV0dXJuIHM+LTEmJihyPXZ0KGUuc2xpY2UocykpLGU9ZS5zbGljZSgwLHMpKSxnKHQpPyhuPXQsdD12b2lkIDApOnQmJiJvYmplY3QiPT10eXBlb2YgdCYmKGk9IlBPU1QiKSxhLmxlbmd0aD4wJiZ3LmFqYXgoe3VybDplLHR5cGU6aXx8IkdFVCIsZGF0YVR5cGU6Imh0bWwiLGRhdGE6dH0pLmRvbmUoZnVuY3Rpb24oZSl7bz1hcmd1bWVudHMsYS5odG1sKHI/dygiPGRpdj4iKS5hcHBlbmQody5wYXJzZUhUTUwoZSkpLmZpbmQocik6ZSl9KS5hbHdheXMobiYmZnVuY3Rpb24oZSx0KXthLmVhY2goZnVuY3Rpb24oKXtuLmFwcGx5KHRoaXMsb3x8W2UucmVzcG9uc2VUZXh0LHQsZV0pfSl9KSx0aGlzfSx3LmVhY2goWyJhamF4U3RhcnQiLCJhamF4U3RvcCIsImFqYXhDb21wbGV0ZSIsImFqYXhFcnJvciIsImFqYXhTdWNjZXNzIiwiYWpheFNlbmQiXSxmdW5jdGlvbihlLHQpe3cuZm5bdF09ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMub24odCxlKX19KSx3LmV4cHIucHNldWRvcy5hbmltYXRlZD1mdW5jdGlvbihlKXtyZXR1cm4gdy5ncmVwKHcudGltZXJzLGZ1bmN0aW9uKHQpe3JldHVybiBlPT09dC5lbGVtfSkubGVuZ3RofSx3Lm9mZnNldD17c2V0T2Zmc2V0OmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG8sYSxzLHUsbCxjPXcuY3NzKGUsInBvc2l0aW9uIiksZj13KGUpLHA9e307InN0YXRpYyI9PT1jJiYoZS5zdHlsZS5wb3NpdGlvbj0icmVsYXRpdmUiKSxzPWYub2Zmc2V0KCksbz13LmNzcyhlLCJ0b3AiKSx1PXcuY3NzKGUsImxlZnQiKSwobD0oImFic29sdXRlIj09PWN8fCJmaXhlZCI9PT1jKSYmKG8rdSkuaW5kZXhPZigiYXV0byIpPi0xKT8oYT0ocj1mLnBvc2l0aW9uKCkpLnRvcCxpPXIubGVmdCk6KGE9cGFyc2VGbG9hdChvKXx8MCxpPXBhcnNlRmxvYXQodSl8fDApLGcodCkmJih0PXQuY2FsbChlLG4sdy5leHRlbmQoe30scykpKSxudWxsIT10LnRvcCYmKHAudG9wPXQudG9wLXMudG9wK2EpLG51bGwhPXQubGVmdCYmKHAubGVmdD10LmxlZnQtcy5sZWZ0K2kpLCJ1c2luZyJpbiB0P3QudXNpbmcuY2FsbChlLHApOmYuY3NzKHApfX0sdy5mbi5leHRlbmQoe29mZnNldDpmdW5jdGlvbihlKXtpZihhcmd1bWVudHMubGVuZ3RoKXJldHVybiB2b2lkIDA9PT1lP3RoaXM6dGhpcy5lYWNoKGZ1bmN0aW9uKHQpe3cub2Zmc2V0LnNldE9mZnNldCh0aGlzLGUsdCl9KTt2YXIgdCxuLHI9dGhpc1swXTtpZihyKXJldHVybiByLmdldENsaWVudFJlY3RzKCkubGVuZ3RoPyh0PXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksbj1yLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcse3RvcDp0LnRvcCtuLnBhZ2VZT2Zmc2V0LGxlZnQ6dC5sZWZ0K24ucGFnZVhPZmZzZXR9KTp7dG9wOjAsbGVmdDowfX0scG9zaXRpb246ZnVuY3Rpb24oKXtpZih0aGlzWzBdKXt2YXIgZSx0LG4scj10aGlzWzBdLGk9e3RvcDowLGxlZnQ6MH07aWYoImZpeGVkIj09PXcuY3NzKHIsInBvc2l0aW9uIikpdD1yLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO2Vsc2V7dD10aGlzLm9mZnNldCgpLG49ci5vd25lckRvY3VtZW50LGU9ci5vZmZzZXRQYXJlbnR8fG4uZG9jdW1lbnRFbGVtZW50O3doaWxlKGUmJihlPT09bi5ib2R5fHxlPT09bi5kb2N1bWVudEVsZW1lbnQpJiYic3RhdGljIj09PXcuY3NzKGUsInBvc2l0aW9uIikpZT1lLnBhcmVudE5vZGU7ZSYmZSE9PXImJjE9PT1lLm5vZGVUeXBlJiYoKGk9dyhlKS5vZmZzZXQoKSkudG9wKz13LmNzcyhlLCJib3JkZXJUb3BXaWR0aCIsITApLGkubGVmdCs9dy5jc3MoZSwiYm9yZGVyTGVmdFdpZHRoIiwhMCkpfXJldHVybnt0b3A6dC50b3AtaS50b3Atdy5jc3MociwibWFyZ2luVG9wIiwhMCksbGVmdDp0LmxlZnQtaS5sZWZ0LXcuY3NzKHIsIm1hcmdpbkxlZnQiLCEwKX19fSxvZmZzZXRQYXJlbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9mZnNldFBhcmVudDt3aGlsZShlJiYic3RhdGljIj09PXcuY3NzKGUsInBvc2l0aW9uIikpZT1lLm9mZnNldFBhcmVudDtyZXR1cm4gZXx8YmV9KX19KSx3LmVhY2goe3Njcm9sbExlZnQ6InBhZ2VYT2Zmc2V0IixzY3JvbGxUb3A6InBhZ2VZT2Zmc2V0In0sZnVuY3Rpb24oZSx0KXt2YXIgbj0icGFnZVlPZmZzZXQiPT09dDt3LmZuW2VdPWZ1bmN0aW9uKHIpe3JldHVybiB6KHRoaXMsZnVuY3Rpb24oZSxyLGkpe3ZhciBvO2lmKHkoZSk/bz1lOjk9PT1lLm5vZGVUeXBlJiYobz1lLmRlZmF1bHRWaWV3KSx2b2lkIDA9PT1pKXJldHVybiBvP29bdF06ZVtyXTtvP28uc2Nyb2xsVG8obj9vLnBhZ2VYT2Zmc2V0Omksbj9pOm8ucGFnZVlPZmZzZXQpOmVbcl09aX0sZSxyLGFyZ3VtZW50cy5sZW5ndGgpfX0pLHcuZWFjaChbInRvcCIsImxlZnQiXSxmdW5jdGlvbihlLHQpe3cuY3NzSG9va3NbdF09X2UoaC5waXhlbFBvc2l0aW9uLGZ1bmN0aW9uKGUsbil7aWYobilyZXR1cm4gbj1GZShlLHQpLFdlLnRlc3Qobik/dyhlKS5wb3NpdGlvbigpW3RdKyJweCI6bn0pfSksdy5lYWNoKHtIZWlnaHQ6ImhlaWdodCIsV2lkdGg6IndpZHRoIn0sZnVuY3Rpb24oZSx0KXt3LmVhY2goe3BhZGRpbmc6ImlubmVyIitlLGNvbnRlbnQ6dCwiIjoib3V0ZXIiK2V9LGZ1bmN0aW9uKG4scil7dy5mbltyXT1mdW5jdGlvbihpLG8pe3ZhciBhPWFyZ3VtZW50cy5sZW5ndGgmJihufHwiYm9vbGVhbiIhPXR5cGVvZiBpKSxzPW58fCghMD09PWl8fCEwPT09bz8ibWFyZ2luIjoiYm9yZGVyIik7cmV0dXJuIHoodGhpcyxmdW5jdGlvbih0LG4saSl7dmFyIG87cmV0dXJuIHkodCk/MD09PXIuaW5kZXhPZigib3V0ZXIiKT90WyJpbm5lciIrZV06dC5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnRbImNsaWVudCIrZV06OT09PXQubm9kZVR5cGU/KG89dC5kb2N1bWVudEVsZW1lbnQsTWF0aC5tYXgodC5ib2R5WyJzY3JvbGwiK2VdLG9bInNjcm9sbCIrZV0sdC5ib2R5WyJvZmZzZXQiK2VdLG9bIm9mZnNldCIrZV0sb1siY2xpZW50IitlXSkpOnZvaWQgMD09PWk/dy5jc3ModCxuLHMpOncuc3R5bGUodCxuLGkscyl9LHQsYT9pOnZvaWQgMCxhKX19KX0pLHcuZWFjaCgiYmx1ciBmb2N1cyBmb2N1c2luIGZvY3Vzb3V0IHJlc2l6ZSBzY3JvbGwgY2xpY2sgZGJsY2xpY2sgbW91c2Vkb3duIG1vdXNldXAgbW91c2Vtb3ZlIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZWVudGVyIG1vdXNlbGVhdmUgY2hhbmdlIHNlbGVjdCBzdWJtaXQga2V5ZG93biBrZXlwcmVzcyBrZXl1cCBjb250ZXh0bWVudSIuc3BsaXQoIiAiKSxmdW5jdGlvbihlLHQpe3cuZm5bdF09ZnVuY3Rpb24oZSxuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD4wP3RoaXMub24odCxudWxsLGUsbik6dGhpcy50cmlnZ2VyKHQpfX0pLHcuZm4uZXh0ZW5kKHtob3ZlcjpmdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLm1vdXNlZW50ZXIoZSkubW91c2VsZWF2ZSh0fHxlKX19KSx3LmZuLmV4dGVuZCh7YmluZDpmdW5jdGlvbihlLHQsbil7cmV0dXJuIHRoaXMub24oZSxudWxsLHQsbil9LHVuYmluZDpmdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLm9mZihlLG51bGwsdCl9LGRlbGVnYXRlOmZ1bmN0aW9uKGUsdCxuLHIpe3JldHVybiB0aGlzLm9uKHQsZSxuLHIpfSx1bmRlbGVnYXRlOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gMT09PWFyZ3VtZW50cy5sZW5ndGg/dGhpcy5vZmYoZSwiKioiKTp0aGlzLm9mZih0LGV8fCIqKiIsbil9fSksdy5wcm94eT1mdW5jdGlvbihlLHQpe3ZhciBuLHIsaTtpZigic3RyaW5nIj09dHlwZW9mIHQmJihuPWVbdF0sdD1lLGU9biksZyhlKSlyZXR1cm4gcj1vLmNhbGwoYXJndW1lbnRzLDIpLGk9ZnVuY3Rpb24oKXtyZXR1cm4gZS5hcHBseSh0fHx0aGlzLHIuY29uY2F0KG8uY2FsbChhcmd1bWVudHMpKSl9LGkuZ3VpZD1lLmd1aWQ9ZS5ndWlkfHx3Lmd1aWQrKyxpfSx3LmhvbGRSZWFkeT1mdW5jdGlvbihlKXtlP3cucmVhZHlXYWl0Kys6dy5yZWFkeSghMCl9LHcuaXNBcnJheT1BcnJheS5pc0FycmF5LHcucGFyc2VKU09OPUpTT04ucGFyc2Usdy5ub2RlTmFtZT1OLHcuaXNGdW5jdGlvbj1nLHcuaXNXaW5kb3c9eSx3LmNhbWVsQ2FzZT1HLHcudHlwZT14LHcubm93PURhdGUubm93LHcuaXNOdW1lcmljPWZ1bmN0aW9uKGUpe3ZhciB0PXcudHlwZShlKTtyZXR1cm4oIm51bWJlciI9PT10fHwic3RyaW5nIj09PXQpJiYhaXNOYU4oZS1wYXJzZUZsb2F0KGUpKX0sImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZCYmZGVmaW5lKCJqcXVlcnkiLFtdLGZ1bmN0aW9uKCl7cmV0dXJuIHd9KTt2YXIgSnQ9ZS5qUXVlcnksS3Q9ZS4kO3JldHVybiB3Lm5vQ29uZmxpY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIGUuJD09PXcmJihlLiQ9S3QpLHQmJmUualF1ZXJ5PT09dyYmKGUualF1ZXJ5PUp0KSx3fSx0fHwoZS5qUXVlcnk9ZS4kPXcpLHd9KTsNCg0KLyohCiAqIGpRdWVyeSBibG9ja1VJIHBsdWdpbgogKiBWZXJzaW9uIDIuNzAuMC0yMDE0LjExLjIzCiAqIFJlcXVpcmVzIGpRdWVyeSB2MS43IG9yIGxhdGVyCiAqCiAqIEV4YW1wbGVzIGF0OiBodHRwOi8vbWFsc3VwLmNvbS9qcXVlcnkvYmxvY2svCiAqIENvcHlyaWdodCAoYykgMjAwNy0yMDEzIE0uIEFsc3VwCiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBhbmQgR1BMIGxpY2Vuc2VzOgogKiBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocAogKiBodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvZ3BsLmh0bWwKICoKICogVGhhbmtzIHRvIEFtaXItSG9zc2VpbiBTb2JoaSBmb3Igc29tZSBleGNlbGxlbnQgY29udHJpYnV0aW9ucyEKICovCgo7KGZ1bmN0aW9uKCkgewovKmpzaGludCBlcWVxZXE6ZmFsc2UgY3VybHk6ZmFsc2UgbGF0ZWRlZjpmYWxzZSAqLwoidXNlIHN0cmljdCI7CgoJZnVuY3Rpb24gc2V0dXAoJCkgewoJCSQuZm4uX2ZhZGVJbiA9ICQuZm4uZmFkZUluOwoKCQl2YXIgbm9PcCA9ICQubm9vcCB8fCBmdW5jdGlvbigpIHt9OwoKCQkvLyB0aGlzIGJpdCBpcyB0byBlbnN1cmUgd2UgZG9uJ3QgY2FsbCBzZXRFeHByZXNzaW9uIHdoZW4gd2Ugc2hvdWxkbid0ICh3aXRoIGV4dHJhIG11c2NsZSB0byBoYW5kbGUKCQkvLyBjb25mdXNpbmcgdXNlckFnZW50IHN0cmluZ3Mgb24gVmlzdGEpCgkJdmFyIG1zaWUgPSAvTVNJRS8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTsKCQl2YXIgaWU2ICA9IC9NU0lFIDYuMC8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSAmJiAhIC9NU0lFIDguMC8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTsKCQl2YXIgbW9kZSA9IGRvY3VtZW50LmRvY3VtZW50TW9kZSB8fCAwOwoJCXZhciBzZXRFeHByID0gJC5pc0Z1bmN0aW9uKCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKS5zdHlsZS5zZXRFeHByZXNzaW9uICk7CgoJCS8vIGdsb2JhbCAkIG1ldGhvZHMgZm9yIGJsb2NraW5nL3VuYmxvY2tpbmcgdGhlIGVudGlyZSBwYWdlCgkJJC5ibG9ja1VJICAgPSBmdW5jdGlvbihvcHRzKSB7IGluc3RhbGwod2luZG93LCBvcHRzKTsgfTsKCQkkLnVuYmxvY2tVSSA9IGZ1bmN0aW9uKG9wdHMpIHsgcmVtb3ZlKHdpbmRvdywgb3B0cyk7IH07CgoJCS8vIGNvbnZlbmllbmNlIG1ldGhvZCBmb3IgcXVpY2sgZ3Jvd2wtbGlrZSBub3RpZmljYXRpb25zICAoaHR0cDovL3d3dy5nb29nbGUuY29tL3NlYXJjaD9xPWdyb3dsKQoJCSQuZ3Jvd2xVSSA9IGZ1bmN0aW9uKHRpdGxlLCBtZXNzYWdlLCB0aW1lb3V0LCBvbkNsb3NlKSB7CgkJCXZhciAkbSA9ICQoJzxkaXYgY2xhc3M9Imdyb3dsVUkiPjwvZGl2PicpOwoJCQlpZiAodGl0bGUpICRtLmFwcGVuZCgnPGgxPicrdGl0bGUrJzwvaDE+Jyk7CgkJCWlmIChtZXNzYWdlKSAkbS5hcHBlbmQoJzxoMj4nK21lc3NhZ2UrJzwvaDI+Jyk7CgkJCWlmICh0aW1lb3V0ID09PSB1bmRlZmluZWQpIHRpbWVvdXQgPSAzMDAwOwoKCQkJLy8gQWRkZWQgYnkga29uYXB1bjogU2V0IHRpbWVvdXQgdG8gMzAgc2Vjb25kcyBpZiB0aGlzIGdyb3dsIGlzIG1vdXNlZCBvdmVyLCBsaWtlIG5vcm1hbCB0b2FzdCBub3RpZmljYXRpb25zCgkJCXZhciBjYWxsQmxvY2sgPSBmdW5jdGlvbihvcHRzKSB7CgkJCQlvcHRzID0gb3B0cyB8fCB7fTsKCgkJCQkkLmJsb2NrVUkoewoJCQkJCW1lc3NhZ2U6ICRtLAoJCQkJCWZhZGVJbiA6IHR5cGVvZiBvcHRzLmZhZGVJbiAgIT09ICd1bmRlZmluZWQnID8gb3B0cy5mYWRlSW4gIDogNzAwLAoJCQkJCWZhZGVPdXQ6IHR5cGVvZiBvcHRzLmZhZGVPdXQgIT09ICd1bmRlZmluZWQnID8gb3B0cy5mYWRlT3V0IDogMTAwMCwKCQkJCQl0aW1lb3V0OiB0eXBlb2Ygb3B0cy50aW1lb3V0ICE9PSAndW5kZWZpbmVkJyA/IG9wdHMudGltZW91dCA6IHRpbWVvdXQsCgkJCQkJY2VudGVyWTogZmFsc2UsCgkJCQkJc2hvd092ZXJsYXk6IGZhbHNlLAoJCQkJCW9uVW5ibG9jazogb25DbG9zZSwKCQkJCQljc3M6ICQuYmxvY2tVSS5kZWZhdWx0cy5ncm93bENTUwoJCQkJfSk7CgkJCX07CgoJCQljYWxsQmxvY2soKTsKCQkJdmFyIG5vbm1vdXNlZE9wYWNpdHkgPSAkbS5jc3MoJ29wYWNpdHknKTsKCQkJJG0ubW91c2VvdmVyKGZ1bmN0aW9uKCkgewoJCQkJY2FsbEJsb2NrKHsKCQkJCQlmYWRlSW46IDAsCgkJCQkJdGltZW91dDogMzAwMDAKCQkJCX0pOwoKCQkJCXZhciBkaXNwbGF5QmxvY2sgPSAkKCcuYmxvY2tNc2cnKTsKCQkJCWRpc3BsYXlCbG9jay5zdG9wKCk7IC8vIGNhbmNlbCBmYWRlb3V0IGlmIGl0IGhhcyBzdGFydGVkCgkJCQlkaXNwbGF5QmxvY2suZmFkZVRvKDMwMCwgMSk7IC8vIG1ha2UgaXQgZWFzaWVyIHRvIHJlYWQgdGhlIG1lc3NhZ2UgYnkgcmVtb3ZpbmcgdHJhbnNwYXJlbmN5CgkJCX0pLm1vdXNlb3V0KGZ1bmN0aW9uKCkgewoJCQkJJCgnLmJsb2NrTXNnJykuZmFkZU91dCgxMDAwKTsKCQkJfSk7CgkJCS8vIEVuZCBrb25hcHVuIGFkZGl0aW9ucwoJCX07CgoJCS8vIHBsdWdpbiBtZXRob2QgZm9yIGJsb2NraW5nIGVsZW1lbnQgY29udGVudAoJCSQuZm4uYmxvY2sgPSBmdW5jdGlvbihvcHRzKSB7CgkJCWlmICggdGhpc1swXSA9PT0gd2luZG93ICkgewoJCQkJJC5ibG9ja1VJKCBvcHRzICk7CgkJCQlyZXR1cm4gdGhpczsKCQkJfQoJCQl2YXIgZnVsbE9wdHMgPSAkLmV4dGVuZCh7fSwgJC5ibG9ja1VJLmRlZmF1bHRzLCBvcHRzIHx8IHt9KTsKCQkJdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJdmFyICRlbCA9ICQodGhpcyk7CgkJCQlpZiAoZnVsbE9wdHMuaWdub3JlSWZCbG9ja2VkICYmICRlbC5kYXRhKCdibG9ja1VJLmlzQmxvY2tlZCcpKQoJCQkJCXJldHVybjsKCQkJCSRlbC51bmJsb2NrKHsgZmFkZU91dDogMCB9KTsKCQkJfSk7CgoJCQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewoJCQkJaWYgKCQuY3NzKHRoaXMsJ3Bvc2l0aW9uJykgPT0gJ3N0YXRpYycpIHsKCQkJCQl0aGlzLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJzsKCQkJCQkkKHRoaXMpLmRhdGEoJ2Jsb2NrVUkuc3RhdGljJywgdHJ1ZSk7CgkJCQl9CgkJCQl0aGlzLnN0eWxlLnpvb20gPSAxOyAvLyBmb3JjZSAnaGFzTGF5b3V0JyBpbiBpZQoJCQkJaW5zdGFsbCh0aGlzLCBvcHRzKTsKCQkJfSk7CgkJfTsKCgkJLy8gcGx1Z2luIG1ldGhvZCBmb3IgdW5ibG9ja2luZyBlbGVtZW50IGNvbnRlbnQKCQkkLmZuLnVuYmxvY2sgPSBmdW5jdGlvbihvcHRzKSB7CgkJCWlmICggdGhpc1swXSA9PT0gd2luZG93ICkgewoJCQkJJC51bmJsb2NrVUkoIG9wdHMgKTsKCQkJCXJldHVybiB0aGlzOwoJCQl9CgkJCXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7CgkJCQlyZW1vdmUodGhpcywgb3B0cyk7CgkJCX0pOwoJCX07CgoJCSQuYmxvY2tVSS52ZXJzaW9uID0gMi43MDsgLy8gMm5kIGdlbmVyYXRpb24gYmxvY2tpbmcgYXQgbm8gZXh0cmEgY29zdCEKCgkJLy8gb3ZlcnJpZGUgdGhlc2UgaW4geW91ciBjb2RlIHRvIGNoYW5nZSB0aGUgZGVmYXVsdCBiZWhhdmlvciBhbmQgc3R5bGUKCQkkLmJsb2NrVUkuZGVmYXVsdHMgPSB7CgkJCS8vIG1lc3NhZ2UgZGlzcGxheWVkIHdoZW4gYmxvY2tpbmcgKHVzZSBudWxsIGZvciBubyBtZXNzYWdlKQoJCQltZXNzYWdlOiAgJzxoMT5QbGVhc2Ugd2FpdC4uLjwvaDE+JywKCgkJCXRpdGxlOiBudWxsLAkJLy8gdGl0bGUgc3RyaW5nOyBvbmx5IHVzZWQgd2hlbiB0aGVtZSA9PSB0cnVlCgkJCWRyYWdnYWJsZTogdHJ1ZSwJLy8gb25seSB1c2VkIHdoZW4gdGhlbWUgPT0gdHJ1ZSAocmVxdWlyZXMganF1ZXJ5LXVpLmpzIHRvIGJlIGxvYWRlZCkKCgkJCXRoZW1lOiBmYWxzZSwgLy8gc2V0IHRvIHRydWUgdG8gdXNlIHdpdGggalF1ZXJ5IFVJIHRoZW1lcwoKCQkJLy8gc3R5bGVzIGZvciB0aGUgbWVzc2FnZSB3aGVuIGJsb2NraW5nOyBpZiB5b3Ugd2lzaCB0byBkaXNhYmxlCgkJCS8vIHRoZXNlIGFuZCB1c2UgYW4gZXh0ZXJuYWwgc3R5bGVzaGVldCB0aGVuIGRvIHRoaXMgaW4geW91ciBjb2RlOgoJCQkvLyAkLmJsb2NrVUkuZGVmYXVsdHMuY3NzID0ge307CgkJCWNzczogewoJCQkJcGFkZGluZzoJMCwKCQkJCW1hcmdpbjoJCTAsCgkJCQl3aWR0aDoJCSczMCUnLAoJCQkJdG9wOgkJJzQwJScsCgkJCQlsZWZ0OgkJJzM1JScsCgkJCQl0ZXh0QWxpZ246CSdjZW50ZXInLAoJCQkJY29sb3I6CQknIzAwMCcsCgkJCQlib3JkZXI6CQknM3B4IHNvbGlkICNhYWEnLAoJCQkJYmFja2dyb3VuZENvbG9yOicjZmZmJywKCQkJCWN1cnNvcjoJCSd3YWl0JwoJCQl9LAoKCQkJLy8gbWluaW1hbCBzdHlsZSBzZXQgdXNlZCB3aGVuIHRoZW1lcyBhcmUgdXNlZAoJCQl0aGVtZWRDU1M6IHsKCQkJCXdpZHRoOgknMzAlJywKCQkJCXRvcDoJJzQwJScsCgkJCQlsZWZ0OgknMzUlJwoJCQl9LAoKCQkJLy8gc3R5bGVzIGZvciB0aGUgb3ZlcmxheQoJCQlvdmVybGF5Q1NTOiAgewoJCQkJYmFja2dyb3VuZENvbG9yOgknIzAwMCcsCgkJCQlvcGFjaXR5OgkJCTAuNiwKCQkJCWN1cnNvcjoJCQkJJ3dhaXQnCgkJCX0sCgoJCQkvLyBzdHlsZSB0byByZXBsYWNlIHdhaXQgY3Vyc29yIGJlZm9yZSB1bmJsb2NraW5nIHRvIGNvcnJlY3QgaXNzdWUKCQkJLy8gb2YgbGluZ2VyaW5nIHdhaXQgY3Vyc29yCgkJCWN1cnNvclJlc2V0OiAnZGVmYXVsdCcsCgoJCQkvLyBzdHlsZXMgYXBwbGllZCB3aGVuIHVzaW5nICQuZ3Jvd2xVSQoJCQlncm93bENTUzogewoJCQkJd2lkdGg6CQknMzUwcHgnLAoJCQkJdG9wOgkJJzEwcHgnLAoJCQkJbGVmdDoJCScnLAoJCQkJcmlnaHQ6CQknMTBweCcsCgkJCQlib3JkZXI6CQknbm9uZScsCgkJCQlwYWRkaW5nOgknNXB4JywKCQkJCW9wYWNpdHk6CTAuNiwKCQkJCWN1cnNvcjoJCSdkZWZhdWx0JywKCQkJCWNvbG9yOgkJJyNmZmYnLAoJCQkJYmFja2dyb3VuZENvbG9yOiAnIzAwMCcsCgkJCQknLXdlYmtpdC1ib3JkZXItcmFkaXVzJzonMTBweCcsCgkJCQknLW1vei1ib3JkZXItcmFkaXVzJzoJJzEwcHgnLAoJCQkJJ2JvcmRlci1yYWRpdXMnOgkJJzEwcHgnCgkJCX0sCgoJCQkvLyBJRSBpc3N1ZXM6ICdhYm91dDpibGFuaycgZmFpbHMgb24gSFRUUFMgYW5kIGphdmFzY3JpcHQ6ZmFsc2UgaXMgcy1sLW8tdwoJCQkvLyAoaGF0IHRpcCB0byBKb3JnZSBILiBOLiBkZSBWYXNjb25jZWxvcykKCQkJLypqc2hpbnQgc2NyaXB0dXJsOnRydWUgKi8KCQkJaWZyYW1lU3JjOiAvXmh0dHBzL2kudGVzdCh3aW5kb3cubG9jYXRpb24uaHJlZiB8fCAnJykgPyAnamF2YXNjcmlwdDpmYWxzZScgOiAnYWJvdXQ6YmxhbmsnLAoKCQkJLy8gZm9yY2UgdXNhZ2Ugb2YgaWZyYW1lIGluIG5vbi1JRSBicm93c2VycyAoaGFuZHkgZm9yIGJsb2NraW5nIGFwcGxldHMpCgkJCWZvcmNlSWZyYW1lOiBmYWxzZSwKCgkJCS8vIHotaW5kZXggZm9yIHRoZSBibG9ja2luZyBvdmVybGF5CgkJCWJhc2VaOiAxMDAwLAoKCQkJLy8gc2V0IHRoZXNlIHRvIHRydWUgdG8gaGF2ZSB0aGUgbWVzc2FnZSBhdXRvbWF0aWNhbGx5IGNlbnRlcmVkCgkJCWNlbnRlclg6IHRydWUsIC8vIDwtLSBvbmx5IGVmZmVjdHMgZWxlbWVudCBibG9ja2luZyAocGFnZSBibG9jayBjb250cm9sbGVkIHZpYSBjc3MgYWJvdmUpCgkJCWNlbnRlclk6IHRydWUsCgoJCQkvLyBhbGxvdyBib2R5IGVsZW1lbnQgdG8gYmUgc3RldGNoZWQgaW4gaWU2OyB0aGlzIG1ha2VzIGJsb2NraW5nIGxvb2sgYmV0dGVyCgkJCS8vIG9uICJzaG9ydCIgcGFnZXMuICBkaXNhYmxlIGlmIHlvdSB3aXNoIHRvIHByZXZlbnQgY2hhbmdlcyB0byB0aGUgYm9keSBoZWlnaHQKCQkJYWxsb3dCb2R5U3RyZXRjaDogdHJ1ZSwKCgkJCS8vIGVuYWJsZSBpZiB5b3Ugd2FudCBrZXkgYW5kIG1vdXNlIGV2ZW50cyB0byBiZSBkaXNhYmxlZCBmb3IgY29udGVudCB0aGF0IGlzIGJsb2NrZWQKCQkJYmluZEV2ZW50czogdHJ1ZSwKCgkJCS8vIGJlIGRlZmF1bHQgYmxvY2tVSSB3aWxsIHN1cHJlc3MgdGFiIG5hdmlnYXRpb24gZnJvbSBsZWF2aW5nIGJsb2NraW5nIGNvbnRlbnQKCQkJLy8gKGlmIGJpbmRFdmVudHMgaXMgdHJ1ZSkKCQkJY29uc3RyYWluVGFiS2V5OiB0cnVlLAoKCQkJLy8gZmFkZUluIHRpbWUgaW4gbWlsbGlzOyBzZXQgdG8gMCB0byBkaXNhYmxlIGZhZGVJbiBvbiBibG9jawoJCQlmYWRlSW46ICAyMDAsCgoJCQkvLyBmYWRlT3V0IHRpbWUgaW4gbWlsbGlzOyBzZXQgdG8gMCB0byBkaXNhYmxlIGZhZGVPdXQgb24gdW5ibG9jawoJCQlmYWRlT3V0OiAgNDAwLAoKCQkJLy8gdGltZSBpbiBtaWxsaXMgdG8gd2FpdCBiZWZvcmUgYXV0by11bmJsb2NraW5nOyBzZXQgdG8gMCB0byBkaXNhYmxlIGF1dG8tdW5ibG9jawoJCQl0aW1lb3V0OiAwLAoKCQkJLy8gZGlzYWJsZSBpZiB5b3UgZG9uJ3Qgd2FudCB0byBzaG93IHRoZSBvdmVybGF5CgkJCXNob3dPdmVybGF5OiB0cnVlLAoKCQkJLy8gaWYgdHJ1ZSwgZm9jdXMgd2lsbCBiZSBwbGFjZWQgaW4gdGhlIGZpcnN0IGF2YWlsYWJsZSBpbnB1dCBmaWVsZCB3aGVuCgkJCS8vIHBhZ2UgYmxvY2tpbmcKCQkJZm9jdXNJbnB1dDogdHJ1ZSwKCiAgICAgICAgICAgIC8vIGVsZW1lbnRzIHRoYXQgY2FuIHJlY2VpdmUgZm9jdXMKICAgICAgICAgICAgZm9jdXNhYmxlRWxlbWVudHM6ICc6aW5wdXQ6ZW5hYmxlZDp2aXNpYmxlJywKCgkJCS8vIHN1cHByZXNzZXMgdGhlIHVzZSBvZiBvdmVybGF5IHN0eWxlcyBvbiBGRi9MaW51eCAoZHVlIHRvIHBlcmZvcm1hbmNlIGlzc3VlcyB3aXRoIG9wYWNpdHkpCgkJCS8vIG5vIGxvbmdlciBuZWVkZWQgaW4gMjAxMgoJCQkvLyBhcHBseVBsYXRmb3JtT3BhY2l0eVJ1bGVzOiB0cnVlLAoKCQkJLy8gY2FsbGJhY2sgbWV0aG9kIGludm9rZWQgd2hlbiBmYWRlSW4gaGFzIGNvbXBsZXRlZCBhbmQgYmxvY2tpbmcgbWVzc2FnZSBpcyB2aXNpYmxlCgkJCW9uQmxvY2s6IG51bGwsCgoJCQkvLyBjYWxsYmFjayBtZXRob2QgaW52b2tlZCB3aGVuIHVuYmxvY2tpbmcgaGFzIGNvbXBsZXRlZDsgdGhlIGNhbGxiYWNrIGlzCgkJCS8vIHBhc3NlZCB0aGUgZWxlbWVudCB0aGF0IGhhcyBiZWVuIHVuYmxvY2tlZCAod2hpY2ggaXMgdGhlIHdpbmRvdyBvYmplY3QgZm9yIHBhZ2UKCQkJLy8gYmxvY2tzKSBhbmQgdGhlIG9wdGlvbnMgdGhhdCB3ZXJlIHBhc3NlZCB0byB0aGUgdW5ibG9jayBjYWxsOgoJCQkvLwlvblVuYmxvY2soZWxlbWVudCwgb3B0aW9ucykKCQkJb25VbmJsb2NrOiBudWxsLAoKCQkJLy8gY2FsbGJhY2sgbWV0aG9kIGludm9rZWQgd2hlbiB0aGUgb3ZlcmxheSBhcmVhIGlzIGNsaWNrZWQuCgkJCS8vIHNldHRpbmcgdGhpcyB3aWxsIHR1cm4gdGhlIGN1cnNvciB0byBhIHBvaW50ZXIsIG90aGVyd2lzZSBjdXJzb3IgZGVmaW5lZCBpbiBvdmVybGF5Q3NzIHdpbGwgYmUgdXNlZC4KCQkJb25PdmVybGF5Q2xpY2s6IG51bGwsCgoJCQkvLyBkb24ndCBhc2s7IGlmIHlvdSByZWFsbHkgbXVzdCBrbm93OiBodHRwOi8vZ3JvdXBzLmdvb2dsZS5jb20vZ3JvdXAvanF1ZXJ5LWVuL2Jyb3dzZV90aHJlYWQvdGhyZWFkLzM2NjQwYTg3MzA1MDM1OTUvMmY2YTc5YTc3YTc4ZTQ5MyMyZjZhNzlhNzdhNzhlNDkzCgkJCXF1aXJrc21vZGVPZmZzZXRIYWNrOiA0LAoKCQkJLy8gY2xhc3MgbmFtZSBvZiB0aGUgbWVzc2FnZSBibG9jawoJCQlibG9ja01zZ0NsYXNzOiAnYmxvY2tNc2cnLAoKCQkJLy8gaWYgaXQgaXMgYWxyZWFkeSBibG9ja2VkLCB0aGVuIGlnbm9yZSBpdCAoZG9uJ3QgdW5ibG9jayBhbmQgcmVibG9jaykKCQkJaWdub3JlSWZCbG9ja2VkOiBmYWxzZQoJCX07CgoJCS8vIHByaXZhdGUgZGF0YSBhbmQgZnVuY3Rpb25zIGZvbGxvdy4uLgoKCQl2YXIgcGFnZUJsb2NrID0gbnVsbDsKCQl2YXIgcGFnZUJsb2NrRWxzID0gW107CgoJCWZ1bmN0aW9uIGluc3RhbGwoZWwsIG9wdHMpIHsKCQkJdmFyIGNzcywgdGhlbWVkQ1NTOwoJCQl2YXIgZnVsbCA9IChlbCA9PSB3aW5kb3cpOwoJCQl2YXIgbXNnID0gKG9wdHMgJiYgb3B0cy5tZXNzYWdlICE9PSB1bmRlZmluZWQgPyBvcHRzLm1lc3NhZ2UgOiB1bmRlZmluZWQpOwoJCQlvcHRzID0gJC5leHRlbmQoe30sICQuYmxvY2tVSS5kZWZhdWx0cywgb3B0cyB8fCB7fSk7CgoJCQlpZiAob3B0cy5pZ25vcmVJZkJsb2NrZWQgJiYgJChlbCkuZGF0YSgnYmxvY2tVSS5pc0Jsb2NrZWQnKSkKCQkJCXJldHVybjsKCgkJCW9wdHMub3ZlcmxheUNTUyA9ICQuZXh0ZW5kKHt9LCAkLmJsb2NrVUkuZGVmYXVsdHMub3ZlcmxheUNTUywgb3B0cy5vdmVybGF5Q1NTIHx8IHt9KTsKCQkJY3NzID0gJC5leHRlbmQoe30sICQuYmxvY2tVSS5kZWZhdWx0cy5jc3MsIG9wdHMuY3NzIHx8IHt9KTsKCQkJaWYgKG9wdHMub25PdmVybGF5Q2xpY2spCgkJCQlvcHRzLm92ZXJsYXlDU1MuY3Vyc29yID0gJ3BvaW50ZXInOwoKCQkJdGhlbWVkQ1NTID0gJC5leHRlbmQoe30sICQuYmxvY2tVSS5kZWZhdWx0cy50aGVtZWRDU1MsIG9wdHMudGhlbWVkQ1NTIHx8IHt9KTsKCQkJbXNnID0gbXNnID09PSB1bmRlZmluZWQgPyBvcHRzLm1lc3NhZ2UgOiBtc2c7CgoJCQkvLyByZW1vdmUgdGhlIGN1cnJlbnQgYmxvY2sgKGlmIHRoZXJlIGlzIG9uZSkKCQkJaWYgKGZ1bGwgJiYgcGFnZUJsb2NrKQoJCQkJcmVtb3ZlKHdpbmRvdywge2ZhZGVPdXQ6MH0pOwoKCQkJLy8gaWYgYW4gZXhpc3RpbmcgZWxlbWVudCBpcyBiZWluZyB1c2VkIGFzIHRoZSBibG9ja2luZyBjb250ZW50IHRoZW4gd2UgY2FwdHVyZQoJCQkvLyBpdHMgY3VycmVudCBwbGFjZSBpbiB0aGUgRE9NIChhbmQgY3VycmVudCBkaXNwbGF5IHN0eWxlKSBzbyB3ZSBjYW4gcmVzdG9yZQoJCQkvLyBpdCB3aGVuIHdlIHVuYmxvY2sKCQkJaWYgKG1zZyAmJiB0eXBlb2YgbXNnICE9ICdzdHJpbmcnICYmIChtc2cucGFyZW50Tm9kZSB8fCBtc2cuanF1ZXJ5KSkgewoJCQkJdmFyIG5vZGUgPSBtc2cuanF1ZXJ5ID8gbXNnWzBdIDogbXNnOwoJCQkJdmFyIGRhdGEgPSB7fTsKCQkJCSQoZWwpLmRhdGEoJ2Jsb2NrVUkuaGlzdG9yeScsIGRhdGEpOwoJCQkJZGF0YS5lbCA9IG5vZGU7CgkJCQlkYXRhLnBhcmVudCA9IG5vZGUucGFyZW50Tm9kZTsKCQkJCWRhdGEuZGlzcGxheSA9IG5vZGUuc3R5bGUuZGlzcGxheTsKCQkJCWRhdGEucG9zaXRpb24gPSBub2RlLnN0eWxlLnBvc2l0aW9uOwoJCQkJaWYgKGRhdGEucGFyZW50KQoJCQkJCWRhdGEucGFyZW50LnJlbW92ZUNoaWxkKG5vZGUpOwoJCQl9CgoJCQkkKGVsKS5kYXRhKCdibG9ja1VJLm9uVW5ibG9jaycsIG9wdHMub25VbmJsb2NrKTsKCQkJdmFyIHogPSBvcHRzLmJhc2VaOwoKCQkJLy8gYmxvY2tVSSB1c2VzIDMgbGF5ZXJzIGZvciBibG9ja2luZywgZm9yIHNpbXBsaWNpdHkgdGhleSBhcmUgYWxsIHVzZWQgb24gZXZlcnkgcGxhdGZvcm07CgkJCS8vIGxheWVyMSBpcyB0aGUgaWZyYW1lIGxheWVyIHdoaWNoIGlzIHVzZWQgdG8gc3VwcmVzcyBibGVlZCB0aHJvdWdoIG9mIHVuZGVybHlpbmcgY29udGVudAoJCQkvLyBsYXllcjIgaXMgdGhlIG92ZXJsYXkgbGF5ZXIgd2hpY2ggaGFzIG9wYWNpdHkgYW5kIGEgd2FpdCBjdXJzb3IgKGJ5IGRlZmF1bHQpCgkJCS8vIGxheWVyMyBpcyB0aGUgbWVzc2FnZSBjb250ZW50IHRoYXQgaXMgZGlzcGxheWVkIHdoaWxlIGJsb2NraW5nCgkJCXZhciBseXIxLCBseXIyLCBseXIzLCBzOwoJCQlpZiAobXNpZSB8fCBvcHRzLmZvcmNlSWZyYW1lKQoJCQkJbHlyMSA9ICQoJzxpZnJhbWUgY2xhc3M9ImJsb2NrVUkiIHN0eWxlPSJ6LWluZGV4OicrICh6KyspICsnO2Rpc3BsYXk6bm9uZTtib3JkZXI6bm9uZTttYXJnaW46MDtwYWRkaW5nOjA7cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTt0b3A6MDtsZWZ0OjAiIHNyYz0iJytvcHRzLmlmcmFtZVNyYysnIj48L2lmcmFtZT4nKTsKCQkJZWxzZQoJCQkJbHlyMSA9ICQoJzxkaXYgY2xhc3M9ImJsb2NrVUkiIHN0eWxlPSJkaXNwbGF5Om5vbmUiPjwvZGl2PicpOwoKCQkJaWYgKG9wdHMudGhlbWUpCgkJCQlseXIyID0gJCgnPGRpdiBjbGFzcz0iYmxvY2tVSSBibG9ja092ZXJsYXkgdWktd2lkZ2V0LW92ZXJsYXkiIHN0eWxlPSJ6LWluZGV4OicrICh6KyspICsnO2Rpc3BsYXk6bm9uZSI+PC9kaXY+Jyk7CgkJCWVsc2UKCQkJCWx5cjIgPSAkKCc8ZGl2IGNsYXNzPSJibG9ja1VJIGJsb2NrT3ZlcmxheSIgc3R5bGU9InotaW5kZXg6JysgKHorKykgKyc7ZGlzcGxheTpub25lO2JvcmRlcjpub25lO21hcmdpbjowO3BhZGRpbmc6MDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO3RvcDowO2xlZnQ6MCI+PC9kaXY+Jyk7CgoJCQlpZiAob3B0cy50aGVtZSAmJiBmdWxsKSB7CgkJCQlzID0gJzxkaXYgY2xhc3M9ImJsb2NrVUkgJyArIG9wdHMuYmxvY2tNc2dDbGFzcyArICcgYmxvY2tQYWdlIHVpLWRpYWxvZyB1aS13aWRnZXQgdWktY29ybmVyLWFsbCIgc3R5bGU9InotaW5kZXg6JysoeisxMCkrJztkaXNwbGF5Om5vbmU7cG9zaXRpb246Zml4ZWQiPic7CgkJCQlpZiAoIG9wdHMudGl0bGUgKSB7CgkJCQkJcyArPSAnPGRpdiBjbGFzcz0idWktd2lkZ2V0LWhlYWRlciB1aS1kaWFsb2ctdGl0bGViYXIgdWktY29ybmVyLWFsbCBibG9ja1RpdGxlIj4nKyhvcHRzLnRpdGxlIHx8ICcmbmJzcDsnKSsnPC9kaXY+JzsKCQkJCX0KCQkJCXMgKz0gJzxkaXYgY2xhc3M9InVpLXdpZGdldC1jb250ZW50IHVpLWRpYWxvZy1jb250ZW50Ij48L2Rpdj4nOwoJCQkJcyArPSAnPC9kaXY+JzsKCQkJfQoJCQllbHNlIGlmIChvcHRzLnRoZW1lKSB7CgkJCQlzID0gJzxkaXYgY2xhc3M9ImJsb2NrVUkgJyArIG9wdHMuYmxvY2tNc2dDbGFzcyArICcgYmxvY2tFbGVtZW50IHVpLWRpYWxvZyB1aS13aWRnZXQgdWktY29ybmVyLWFsbCIgc3R5bGU9InotaW5kZXg6JysoeisxMCkrJztkaXNwbGF5Om5vbmU7cG9zaXRpb246YWJzb2x1dGUiPic7CgkJCQlpZiAoIG9wdHMudGl0bGUgKSB7CgkJCQkJcyArPSAnPGRpdiBjbGFzcz0idWktd2lkZ2V0LWhlYWRlciB1aS1kaWFsb2ctdGl0bGViYXIgdWktY29ybmVyLWFsbCBibG9ja1RpdGxlIj4nKyhvcHRzLnRpdGxlIHx8ICcmbmJzcDsnKSsnPC9kaXY+JzsKCQkJCX0KCQkJCXMgKz0gJzxkaXYgY2xhc3M9InVpLXdpZGdldC1jb250ZW50IHVpLWRpYWxvZy1jb250ZW50Ij48L2Rpdj4nOwoJCQkJcyArPSAnPC9kaXY+JzsKCQkJfQoJCQllbHNlIGlmIChmdWxsKSB7CgkJCQlzID0gJzxkaXYgY2xhc3M9ImJsb2NrVUkgJyArIG9wdHMuYmxvY2tNc2dDbGFzcyArICcgYmxvY2tQYWdlIiBzdHlsZT0iei1pbmRleDonKyh6KzEwKSsnO2Rpc3BsYXk6bm9uZTtwb3NpdGlvbjpmaXhlZCI+PC9kaXY+JzsKCQkJfQoJCQllbHNlIHsKCQkJCXMgPSAnPGRpdiBjbGFzcz0iYmxvY2tVSSAnICsgb3B0cy5ibG9ja01zZ0NsYXNzICsgJyBibG9ja0VsZW1lbnQiIHN0eWxlPSJ6LWluZGV4OicrKHorMTApKyc7ZGlzcGxheTpub25lO3Bvc2l0aW9uOmFic29sdXRlIj48L2Rpdj4nOwoJCQl9CgkJCWx5cjMgPSAkKHMpOwoKCQkJLy8gaWYgd2UgaGF2ZSBhIG1lc3NhZ2UsIHN0eWxlIGl0CgkJCWlmIChtc2cpIHsKCQkJCWlmIChvcHRzLnRoZW1lKSB7CgkJCQkJbHlyMy5jc3ModGhlbWVkQ1NTKTsKCQkJCQlseXIzLmFkZENsYXNzKCd1aS13aWRnZXQtY29udGVudCcpOwoJCQkJfQoJCQkJZWxzZQoJCQkJCWx5cjMuY3NzKGNzcyk7CgkJCX0KCgkJCS8vIHN0eWxlIHRoZSBvdmVybGF5CgkJCWlmICghb3B0cy50aGVtZSAvKiYmICghb3B0cy5hcHBseVBsYXRmb3JtT3BhY2l0eVJ1bGVzKSovKQoJCQkJbHlyMi5jc3Mob3B0cy5vdmVybGF5Q1NTKTsKCQkJbHlyMi5jc3MoJ3Bvc2l0aW9uJywgZnVsbCA/ICdmaXhlZCcgOiAnYWJzb2x1dGUnKTsKCgkJCS8vIG1ha2UgaWZyYW1lIGxheWVyIHRyYW5zcGFyZW50IGluIElFCgkJCWlmIChtc2llIHx8IG9wdHMuZm9yY2VJZnJhbWUpCgkJCQlseXIxLmNzcygnb3BhY2l0eScsMC4wKTsKCgkJCS8vJChbbHlyMVswXSxseXIyWzBdLGx5cjNbMF1dKS5hcHBlbmRUbyhmdWxsID8gJ2JvZHknIDogZWwpOwoJCQl2YXIgbGF5ZXJzID0gW2x5cjEsbHlyMixseXIzXSwgJHBhciA9IGZ1bGwgPyAkKCdib2R5JykgOiAkKGVsKTsKCQkJJC5lYWNoKGxheWVycywgZnVuY3Rpb24oKSB7CgkJCQl0aGlzLmFwcGVuZFRvKCRwYXIpOwoJCQl9KTsKCgkJCWlmIChvcHRzLnRoZW1lICYmIG9wdHMuZHJhZ2dhYmxlICYmICQuZm4uZHJhZ2dhYmxlKSB7CgkJCQlseXIzLmRyYWdnYWJsZSh7CgkJCQkJaGFuZGxlOiAnLnVpLWRpYWxvZy10aXRsZWJhcicsCgkJCQkJY2FuY2VsOiAnbGknCgkJCQl9KTsKCQkJfQoKCQkJLy8gaWU3IG11c3QgdXNlIGFic29sdXRlIHBvc2l0aW9uaW5nIGluIHF1aXJrcyBtb2RlIGFuZCB0byBhY2NvdW50IGZvciBhY3RpdmV4IGlzc3VlcyAod2hlbiBzY3JvbGxpbmcpCgkJCXZhciBleHByID0gc2V0RXhwciAmJiAoISQuc3VwcG9ydC5ib3hNb2RlbCB8fCAkKCdvYmplY3QsZW1iZWQnLCBmdWxsID8gbnVsbCA6IGVsKS5sZW5ndGggPiAwKTsKCQkJaWYgKGllNiB8fCBleHByKSB7CgkJCQkvLyBnaXZlIGJvZHkgMTAwJSBoZWlnaHQKCQkJCWlmIChmdWxsICYmIG9wdHMuYWxsb3dCb2R5U3RyZXRjaCAmJiAkLnN1cHBvcnQuYm94TW9kZWwpCgkJCQkJJCgnaHRtbCxib2R5JykuY3NzKCdoZWlnaHQnLCcxMDAlJyk7CgoJCQkJLy8gZml4IGllNiBpc3N1ZSB3aGVuIGJsb2NrZWQgZWxlbWVudCBoYXMgYSBib3JkZXIgd2lkdGgKCQkJCWlmICgoaWU2IHx8ICEkLnN1cHBvcnQuYm94TW9kZWwpICYmICFmdWxsKSB7CgkJCQkJdmFyIHQgPSBzeihlbCwnYm9yZGVyVG9wV2lkdGgnKSwgbCA9IHN6KGVsLCdib3JkZXJMZWZ0V2lkdGgnKTsKCQkJCQl2YXIgZml4VCA9IHQgPyAnKDAgLSAnK3QrJyknIDogMDsKCQkJCQl2YXIgZml4TCA9IGwgPyAnKDAgLSAnK2wrJyknIDogMDsKCQkJCX0KCgkJCQkvLyBzaW11bGF0ZSBmaXhlZCBwb3NpdGlvbgoJCQkJJC5lYWNoKGxheWVycywgZnVuY3Rpb24oaSxvKSB7CgkJCQkJdmFyIHMgPSBvWzBdLnN0eWxlOwoJCQkJCXMucG9zaXRpb24gPSAnYWJzb2x1dGUnOwoJCQkJCWlmIChpIDwgMikgewoJCQkJCQlpZiAoZnVsbCkKCQkJCQkJCXMuc2V0RXhwcmVzc2lvbignaGVpZ2h0JywnTWF0aC5tYXgoZG9jdW1lbnQuYm9keS5zY3JvbGxIZWlnaHQsIGRvY3VtZW50LmJvZHkub2Zmc2V0SGVpZ2h0KSAtIChqUXVlcnkuc3VwcG9ydC5ib3hNb2RlbD8wOicrb3B0cy5xdWlya3Ntb2RlT2Zmc2V0SGFjaysnKSArICJweCInKTsKCQkJCQkJZWxzZQoJCQkJCQkJcy5zZXRFeHByZXNzaW9uKCdoZWlnaHQnLCd0aGlzLnBhcmVudE5vZGUub2Zmc2V0SGVpZ2h0ICsgInB4IicpOwoJCQkJCQlpZiAoZnVsbCkKCQkJCQkJCXMuc2V0RXhwcmVzc2lvbignd2lkdGgnLCdqUXVlcnkuc3VwcG9ydC5ib3hNb2RlbCAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggfHwgZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aCArICJweCInKTsKCQkJCQkJZWxzZQoJCQkJCQkJcy5zZXRFeHByZXNzaW9uKCd3aWR0aCcsJ3RoaXMucGFyZW50Tm9kZS5vZmZzZXRXaWR0aCArICJweCInKTsKCQkJCQkJaWYgKGZpeEwpIHMuc2V0RXhwcmVzc2lvbignbGVmdCcsIGZpeEwpOwoJCQkJCQlpZiAoZml4VCkgcy5zZXRFeHByZXNzaW9uKCd0b3AnLCBmaXhUKTsKCQkJCQl9CgkJCQkJZWxzZSBpZiAob3B0cy5jZW50ZXJZKSB7CgkJCQkJCWlmIChmdWxsKSBzLnNldEV4cHJlc3Npb24oJ3RvcCcsJyhkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IHx8IGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0KSAvIDIgLSAodGhpcy5vZmZzZXRIZWlnaHQgLyAyKSArIChibGFoID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA/IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgOiBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCkgKyAicHgiJyk7CgkJCQkJCXMubWFyZ2luVG9wID0gMDsKCQkJCQl9CgkJCQkJZWxzZSBpZiAoIW9wdHMuY2VudGVyWSAmJiBmdWxsKSB7CgkJCQkJCXZhciB0b3AgPSAob3B0cy5jc3MgJiYgb3B0cy5jc3MudG9wKSA/IHBhcnNlSW50KG9wdHMuY3NzLnRvcCwgMTApIDogMDsKCQkJCQkJdmFyIGV4cHJlc3Npb24gPSAnKChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wID8gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA6IGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wKSArICcrdG9wKycpICsgInB4Iic7CgkJCQkJCXMuc2V0RXhwcmVzc2lvbigndG9wJyxleHByZXNzaW9uKTsKCQkJCQl9CgkJCQl9KTsKCQkJfQoKCQkJLy8gc2hvdyB0aGUgbWVzc2FnZQoJCQlpZiAobXNnKSB7CgkJCQlpZiAob3B0cy50aGVtZSkKCQkJCQlseXIzLmZpbmQoJy51aS13aWRnZXQtY29udGVudCcpLmFwcGVuZChtc2cpOwoJCQkJZWxzZQoJCQkJCWx5cjMuYXBwZW5kKG1zZyk7CgkJCQlpZiAobXNnLmpxdWVyeSB8fCBtc2cubm9kZVR5cGUpCgkJCQkJJChtc2cpLnNob3coKTsKCQkJfQoKCQkJaWYgKChtc2llIHx8IG9wdHMuZm9yY2VJZnJhbWUpICYmIG9wdHMuc2hvd092ZXJsYXkpCgkJCQlseXIxLnNob3coKTsgLy8gb3BhY2l0eSBpcyB6ZXJvCgkJCWlmIChvcHRzLmZhZGVJbikgewoJCQkJdmFyIGNiID0gb3B0cy5vbkJsb2NrID8gb3B0cy5vbkJsb2NrIDogbm9PcDsKCQkJCXZhciBjYjEgPSAob3B0cy5zaG93T3ZlcmxheSAmJiAhbXNnKSA/IGNiIDogbm9PcDsKCQkJCXZhciBjYjIgPSBtc2cgPyBjYiA6IG5vT3A7CgkJCQlpZiAob3B0cy5zaG93T3ZlcmxheSkKCQkJCQlseXIyLl9mYWRlSW4ob3B0cy5mYWRlSW4sIGNiMSk7CgkJCQlpZiAobXNnKQoJCQkJCWx5cjMuX2ZhZGVJbihvcHRzLmZhZGVJbiwgY2IyKTsKCQkJfQoJCQllbHNlIHsKCQkJCWlmIChvcHRzLnNob3dPdmVybGF5KQoJCQkJCWx5cjIuc2hvdygpOwoJCQkJaWYgKG1zZykKCQkJCQlseXIzLnNob3coKTsKCQkJCWlmIChvcHRzLm9uQmxvY2spCgkJCQkJb3B0cy5vbkJsb2NrLmJpbmQobHlyMykoKTsKCQkJfQoKCQkJLy8gYmluZCBrZXkgYW5kIG1vdXNlIGV2ZW50cwoJCQliaW5kKDEsIGVsLCBvcHRzKTsKCgkJCWlmIChmdWxsKSB7CgkJCQlwYWdlQmxvY2sgPSBseXIzWzBdOwoJCQkJcGFnZUJsb2NrRWxzID0gJChvcHRzLmZvY3VzYWJsZUVsZW1lbnRzLHBhZ2VCbG9jayk7CgkJCQlpZiAob3B0cy5mb2N1c0lucHV0KQoJCQkJCXNldFRpbWVvdXQoZm9jdXMsIDIwKTsKCQkJfQoJCQllbHNlCgkJCQljZW50ZXIobHlyM1swXSwgb3B0cy5jZW50ZXJYLCBvcHRzLmNlbnRlclkpOwoKCQkJaWYgKG9wdHMudGltZW91dCkgewoJCQkJLy8gYXV0by11bmJsb2NrCgkJCQl2YXIgdG8gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewoJCQkJCWlmIChmdWxsKQoJCQkJCQkkLnVuYmxvY2tVSShvcHRzKTsKCQkJCQllbHNlCgkJCQkJCSQoZWwpLnVuYmxvY2sob3B0cyk7CgkJCQl9LCBvcHRzLnRpbWVvdXQpOwoJCQkJJChlbCkuZGF0YSgnYmxvY2tVSS50aW1lb3V0JywgdG8pOwoJCQl9CgkJfQoKCQkvLyByZW1vdmUgdGhlIGJsb2NrCgkJZnVuY3Rpb24gcmVtb3ZlKGVsLCBvcHRzKSB7CgkJCXZhciBjb3VudDsKCQkJdmFyIGZ1bGwgPSAoZWwgPT0gd2luZG93KTsKCQkJdmFyICRlbCA9ICQoZWwpOwoJCQl2YXIgZGF0YSA9ICRlbC5kYXRhKCdibG9ja1VJLmhpc3RvcnknKTsKCQkJdmFyIHRvID0gJGVsLmRhdGEoJ2Jsb2NrVUkudGltZW91dCcpOwoJCQlpZiAodG8pIHsKCQkJCWNsZWFyVGltZW91dCh0byk7CgkJCQkkZWwucmVtb3ZlRGF0YSgnYmxvY2tVSS50aW1lb3V0Jyk7CgkJCX0KCQkJb3B0cyA9ICQuZXh0ZW5kKHt9LCAkLmJsb2NrVUkuZGVmYXVsdHMsIG9wdHMgfHwge30pOwoJCQliaW5kKDAsIGVsLCBvcHRzKTsgLy8gdW5iaW5kIGV2ZW50cwoKCQkJaWYgKG9wdHMub25VbmJsb2NrID09PSBudWxsKSB7CgkJCQlvcHRzLm9uVW5ibG9jayA9ICRlbC5kYXRhKCdibG9ja1VJLm9uVW5ibG9jaycpOwoJCQkJJGVsLnJlbW92ZURhdGEoJ2Jsb2NrVUkub25VbmJsb2NrJyk7CgkJCX0KCgkJCXZhciBlbHM7CgkJCWlmIChmdWxsKSAvLyBjcmF6eSBzZWxlY3RvciB0byBoYW5kbGUgb2RkIGZpZWxkIGVycm9ycyBpbiBpZTYvNwoJCQkJZWxzID0gJCgnYm9keScpLmNoaWxkcmVuKCkuZmlsdGVyKCcuYmxvY2tVSScpLmFkZCgnYm9keSA+IC5ibG9ja1VJJyk7CgkJCWVsc2UKCQkJCWVscyA9ICRlbC5maW5kKCc+LmJsb2NrVUknKTsKCgkJCS8vIGZpeCBjdXJzb3IgaXNzdWUKCQkJaWYgKCBvcHRzLmN1cnNvclJlc2V0ICkgewoJCQkJaWYgKCBlbHMubGVuZ3RoID4gMSApCgkJCQkJZWxzWzFdLnN0eWxlLmN1cnNvciA9IG9wdHMuY3Vyc29yUmVzZXQ7CgkJCQlpZiAoIGVscy5sZW5ndGggPiAyICkKCQkJCQllbHNbMl0uc3R5bGUuY3Vyc29yID0gb3B0cy5jdXJzb3JSZXNldDsKCQkJfQoKCQkJaWYgKGZ1bGwpCgkJCQlwYWdlQmxvY2sgPSBwYWdlQmxvY2tFbHMgPSBudWxsOwoKCQkJaWYgKG9wdHMuZmFkZU91dCkgewoJCQkJY291bnQgPSBlbHMubGVuZ3RoOwoJCQkJZWxzLnN0b3AoKS5mYWRlT3V0KG9wdHMuZmFkZU91dCwgZnVuY3Rpb24oKSB7CgkJCQkJaWYgKCAtLWNvdW50ID09PSAwKQoJCQkJCQlyZXNldChlbHMsZGF0YSxvcHRzLGVsKTsKCQkJCX0pOwoJCQl9CgkJCWVsc2UKCQkJCXJlc2V0KGVscywgZGF0YSwgb3B0cywgZWwpOwoJCX0KCgkJLy8gbW92ZSBibG9ja2luZyBlbGVtZW50IGJhY2sgaW50byB0aGUgRE9NIHdoZXJlIGl0IHN0YXJ0ZWQKCQlmdW5jdGlvbiByZXNldChlbHMsZGF0YSxvcHRzLGVsKSB7CgkJCXZhciAkZWwgPSAkKGVsKTsKCQkJaWYgKCAkZWwuZGF0YSgnYmxvY2tVSS5pc0Jsb2NrZWQnKSApCgkJCQlyZXR1cm47CgoJCQllbHMuZWFjaChmdW5jdGlvbihpLG8pIHsKCQkJCS8vIHJlbW92ZSB2aWEgRE9NIGNhbGxzIHNvIHdlIGRvbid0IGxvc2UgZXZlbnQgaGFuZGxlcnMKCQkJCWlmICh0aGlzLnBhcmVudE5vZGUpCgkJCQkJdGhpcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMpOwoJCQl9KTsKCgkJCWlmIChkYXRhICYmIGRhdGEuZWwpIHsKCQkJCWRhdGEuZWwuc3R5bGUuZGlzcGxheSA9IGRhdGEuZGlzcGxheTsKCQkJCWRhdGEuZWwuc3R5bGUucG9zaXRpb24gPSBkYXRhLnBvc2l0aW9uOwoJCQkJZGF0YS5lbC5zdHlsZS5jdXJzb3IgPSAnZGVmYXVsdCc7IC8vICM1OQoJCQkJaWYgKGRhdGEucGFyZW50KQoJCQkJCWRhdGEucGFyZW50LmFwcGVuZENoaWxkKGRhdGEuZWwpOwoJCQkJJGVsLnJlbW92ZURhdGEoJ2Jsb2NrVUkuaGlzdG9yeScpOwoJCQl9CgoJCQlpZiAoJGVsLmRhdGEoJ2Jsb2NrVUkuc3RhdGljJykpIHsKCQkJCSRlbC5jc3MoJ3Bvc2l0aW9uJywgJ3N0YXRpYycpOyAvLyAjMjIKCQkJfQoKCQkJaWYgKHR5cGVvZiBvcHRzLm9uVW5ibG9jayA9PSAnZnVuY3Rpb24nKQoJCQkJb3B0cy5vblVuYmxvY2soZWwsb3B0cyk7CgoJCQkvLyBmaXggaXNzdWUgaW4gU2FmYXJpIDYgd2hlcmUgYmxvY2sgYXJ0aWZhY3RzIHJlbWFpbiB1bnRpbCByZWZsb3cKCQkJdmFyIGJvZHkgPSAkKGRvY3VtZW50LmJvZHkpLCB3ID0gYm9keS53aWR0aCgpLCBjc3NXID0gYm9keVswXS5zdHlsZS53aWR0aDsKCQkJYm9keS53aWR0aCh3LTEpLndpZHRoKHcpOwoJCQlib2R5WzBdLnN0eWxlLndpZHRoID0gY3NzVzsKCQl9CgoJCS8vIGJpbmQvdW5iaW5kIHRoZSBoYW5kbGVyCgkJZnVuY3Rpb24gYmluZChiLCBlbCwgb3B0cykgewoJCQl2YXIgZnVsbCA9IGVsID09IHdpbmRvdywgJGVsID0gJChlbCk7CgoJCQkvLyBkb24ndCBib3RoZXIgdW5iaW5kaW5nIGlmIHRoZXJlIGlzIG5vdGhpbmcgdG8gdW5iaW5kCgkJCWlmICghYiAmJiAoZnVsbCAmJiAhcGFnZUJsb2NrIHx8ICFmdWxsICYmICEkZWwuZGF0YSgnYmxvY2tVSS5pc0Jsb2NrZWQnKSkpCgkJCQlyZXR1cm47CgoJCQkkZWwuZGF0YSgnYmxvY2tVSS5pc0Jsb2NrZWQnLCBiKTsKCgkJCS8vIGRvbid0IGJpbmQgZXZlbnRzIHdoZW4gb3ZlcmxheSBpcyBub3QgaW4gdXNlIG9yIGlmIGJpbmRFdmVudHMgaXMgZmFsc2UKCQkJaWYgKCFmdWxsIHx8ICFvcHRzLmJpbmRFdmVudHMgfHwgKGIgJiYgIW9wdHMuc2hvd092ZXJsYXkpKQoJCQkJcmV0dXJuOwoKCQkJLy8gYmluZCBhbmNob3JzIGFuZCBpbnB1dHMgZm9yIG1vdXNlIGFuZCBrZXkgZXZlbnRzCgkJCXZhciBldmVudHMgPSAnbW91c2Vkb3duIG1vdXNldXAga2V5ZG93biBrZXlwcmVzcyBrZXl1cCB0b3VjaHN0YXJ0IHRvdWNoZW5kIHRvdWNobW92ZSc7CgkJCWlmIChiKQoJCQkJJChkb2N1bWVudCkuYmluZChldmVudHMsIG9wdHMsIGhhbmRsZXIpOwoJCQllbHNlCgkJCQkkKGRvY3VtZW50KS51bmJpbmQoZXZlbnRzLCBoYW5kbGVyKTsKCgkJLy8gZm9ybWVyIGltcGwuLi4KCQkvLwkJdmFyICRlID0gJCgnYSw6aW5wdXQnKTsKCQkvLwkJYiA/ICRlLmJpbmQoZXZlbnRzLCBvcHRzLCBoYW5kbGVyKSA6ICRlLnVuYmluZChldmVudHMsIGhhbmRsZXIpOwoJCX0KCgkJLy8gZXZlbnQgaGFuZGxlciB0byBzdXBwcmVzcyBrZXlib2FyZC9tb3VzZSBldmVudHMgd2hlbiBibG9ja2luZwoJCWZ1bmN0aW9uIGhhbmRsZXIoZSkgewoJCQkvLyBhbGxvdyB0YWIgbmF2aWdhdGlvbiAoY29uZGl0aW9uYWxseSkKCQkJaWYgKGUudHlwZSA9PT0gJ2tleWRvd24nICYmIGUua2V5Q29kZSAmJiBlLmtleUNvZGUgPT0gOSkgewoJCQkJaWYgKHBhZ2VCbG9jayAmJiBlLmRhdGEuY29uc3RyYWluVGFiS2V5KSB7CgkJCQkJdmFyIGVscyA9IHBhZ2VCbG9ja0VsczsKCQkJCQl2YXIgZndkID0gIWUuc2hpZnRLZXkgJiYgZS50YXJnZXQgPT09IGVsc1tlbHMubGVuZ3RoLTFdOwoJCQkJCXZhciBiYWNrID0gZS5zaGlmdEtleSAmJiBlLnRhcmdldCA9PT0gZWxzWzBdOwoJCQkJCWlmIChmd2QgfHwgYmFjaykgewoJCQkJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7Zm9jdXMoYmFjayk7fSwxMCk7CgkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQl9CgkJCQl9CgkJCX0KCQkJdmFyIG9wdHMgPSBlLmRhdGE7CgkJCXZhciB0YXJnZXQgPSAkKGUudGFyZ2V0KTsKCQkJaWYgKHRhcmdldC5oYXNDbGFzcygnYmxvY2tPdmVybGF5JykgJiYgb3B0cy5vbk92ZXJsYXlDbGljaykKCQkJCW9wdHMub25PdmVybGF5Q2xpY2soZSk7CgoJCQkvLyBhbGxvdyBldmVudHMgd2l0aGluIHRoZSBtZXNzYWdlIGNvbnRlbnQKCQkJaWYgKHRhcmdldC5wYXJlbnRzKCdkaXYuJyArIG9wdHMuYmxvY2tNc2dDbGFzcykubGVuZ3RoID4gMCkKCQkJCXJldHVybiB0cnVlOwoKCQkJLy8gYWxsb3cgZXZlbnRzIGZvciBjb250ZW50IHRoYXQgaXMgbm90IGJlaW5nIGJsb2NrZWQKCQkJcmV0dXJuIHRhcmdldC5wYXJlbnRzKCkuY2hpbGRyZW4oKS5maWx0ZXIoJ2Rpdi5ibG9ja1VJJykubGVuZ3RoID09PSAwOwoJCX0KCgkJZnVuY3Rpb24gZm9jdXMoYmFjaykgewoJCQlpZiAoIXBhZ2VCbG9ja0VscykKCQkJCXJldHVybjsKCQkJdmFyIGUgPSBwYWdlQmxvY2tFbHNbYmFjaz09PXRydWUgPyBwYWdlQmxvY2tFbHMubGVuZ3RoLTEgOiAwXTsKCQkJaWYgKGUpCgkJCQllLmZvY3VzKCk7CgkJfQoKCQlmdW5jdGlvbiBjZW50ZXIoZWwsIHgsIHkpIHsKCQkJdmFyIHAgPSBlbC5wYXJlbnROb2RlLCBzID0gZWwuc3R5bGU7CgkJCXZhciBsID0gKChwLm9mZnNldFdpZHRoIC0gZWwub2Zmc2V0V2lkdGgpLzIpIC0gc3oocCwnYm9yZGVyTGVmdFdpZHRoJyk7CgkJCXZhciB0ID0gKChwLm9mZnNldEhlaWdodCAtIGVsLm9mZnNldEhlaWdodCkvMikgLSBzeihwLCdib3JkZXJUb3BXaWR0aCcpOwoJCQlpZiAoeCkgcy5sZWZ0ID0gbCA+IDAgPyAobCsncHgnKSA6ICcwJzsKCQkJaWYgKHkpIHMudG9wICA9IHQgPiAwID8gKHQrJ3B4JykgOiAnMCc7CgkJfQoKCQlmdW5jdGlvbiBzeihlbCwgcCkgewoJCQlyZXR1cm4gcGFyc2VJbnQoJC5jc3MoZWwscCksMTApfHwwOwoJCX0KCgl9CgoKCS8qZ2xvYmFsIGRlZmluZTp0cnVlICovCglpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kICYmIGRlZmluZS5hbWQualF1ZXJ5KSB7CgkJZGVmaW5lKFsnanF1ZXJ5J10sIHNldHVwKTsKCX0gZWxzZSB7CgkJc2V0dXAoalF1ZXJ5KTsKCX0KCn0pKCk7CgovLyDvv73vv71l77+977+9DQpmdW5jdGlvbiBibG9ja1VJKCkgew0KICAgICQuYmxvY2tVSSh7DQogICAgICAgIG1lc3NhZ2U6ICI8aW1nIHNyYz0nIiArIGxvY2F0aW9uLnByb3RvY29sICsgIi9pbWFnZXMvbG9hZGluZy5naWYnLz4iLA0KICAgICAgICBjc3M6IHsNCiAgICAgICAgICAgIHRvcDogKCQod2luZG93KS5oZWlnaHQoKSAtIDIwMCkgLyAyICsgJ3B4JywNCiAgICAgICAgICAgIGxlZnQ6ICgkKHdpbmRvdykud2lkdGgoKSAtIDQwMCkgLyAyICsgJ3B4JywNCiAgICAgICAgICAgIHdpZHRoOiAnNDAwcHgnDQogICAgICAgIH0NCiAgICB9KTsNCn0NCg0KLyohCiAgKiBCb290c3RyYXAgdjQuMS4xIChodHRwczovL2dldGJvb3RzdHJhcC5jb20vKQogICogQ29weXJpZ2h0IDIwMTEtMjAxOCBUaGUgQm9vdHN0cmFwIEF1dGhvcnMgKGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9ncmFwaHMvY29udHJpYnV0b3JzKQogICogTGljZW5zZWQgdW5kZXIgTUlUIChodHRwczovL2dpdGh1Yi5jb20vdHdicy9ib290c3RyYXAvYmxvYi9tYXN0ZXIvTElDRU5TRSkKICAqLwohZnVuY3Rpb24odCxlKXsib2JqZWN0Ij09dHlwZW9mIGV4cG9ydHMmJiJ1bmRlZmluZWQiIT10eXBlb2YgbW9kdWxlP2UoZXhwb3J0cyxyZXF1aXJlKCJqcXVlcnkiKSk6ImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoWyJleHBvcnRzIiwianF1ZXJ5Il0sZSk6ZSh0LmJvb3RzdHJhcD17fSx0LmpRdWVyeSl9KHRoaXMsZnVuY3Rpb24odCxlKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gaSh0LGUpe2Zvcih2YXIgbj0wO248ZS5sZW5ndGg7bisrKXt2YXIgaT1lW25dO2kuZW51bWVyYWJsZT1pLmVudW1lcmFibGV8fCExLGkuY29uZmlndXJhYmxlPSEwLCJ2YWx1ZSJpbiBpJiYoaS53cml0YWJsZT0hMCksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsaS5rZXksaSl9fWZ1bmN0aW9uIHModCxlLG4pe3JldHVybiBlJiZpKHQucHJvdG90eXBlLGUpLG4mJmkodCxuKSx0fWZ1bmN0aW9uIGMocil7Zm9yKHZhciB0PTE7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyl7dmFyIG89bnVsbCE9YXJndW1lbnRzW3RdP2FyZ3VtZW50c1t0XTp7fSxlPU9iamVjdC5rZXlzKG8pOyJmdW5jdGlvbiI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzJiYoZT1lLmNvbmNhdChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG8pLmZpbHRlcihmdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvLHQpLmVudW1lcmFibGV9KSkpLGUuZm9yRWFjaChmdW5jdGlvbih0KXt2YXIgZSxuLGk7ZT1yLGk9b1tuPXRdLG4gaW4gZT9PYmplY3QuZGVmaW5lUHJvcGVydHkoZSxuLHt2YWx1ZTppLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwfSk6ZVtuXT1pfSl9cmV0dXJuIHJ9Zm9yKHZhciByLG4sbyxhLGwsZixoLHUsZCxwLGcsbSxfLHYsRSx5LGIsVCxDLHcsSSxELEEsUyxPLE4sayxMLFAseCxqLE0sUixILFcsRixVLEIsSyxWLFEsWSxHLHEseixYLEosWiwkLHR0LGV0LG50LGl0LHJ0LG90LHN0LGF0LGx0LGN0LGZ0LGh0LHV0LGR0LHB0LGd0PWZ1bmN0aW9uKGkpe3ZhciBlPSJ0cmFuc2l0aW9uZW5kIjtmdW5jdGlvbiB0KHQpe3ZhciBlPXRoaXMsbj0hMTtyZXR1cm4gaSh0aGlzKS5vbmUobC5UUkFOU0lUSU9OX0VORCxmdW5jdGlvbigpe249ITB9KSxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7bnx8bC50cmlnZ2VyVHJhbnNpdGlvbkVuZChlKX0sdCksdGhpc312YXIgbD17VFJBTlNJVElPTl9FTkQ6ImJzVHJhbnNpdGlvbkVuZCIsZ2V0VUlEOmZ1bmN0aW9uKHQpe2Zvcig7dCs9fn4oMWU2Kk1hdGgucmFuZG9tKCkpLGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHQpOyk7cmV0dXJuIHR9LGdldFNlbGVjdG9yRnJvbUVsZW1lbnQ6ZnVuY3Rpb24odCl7dmFyIGU9dC5nZXRBdHRyaWJ1dGUoImRhdGEtdGFyZ2V0Iik7ZSYmIiMiIT09ZXx8KGU9dC5nZXRBdHRyaWJ1dGUoImhyZWYiKXx8IiIpO3RyeXtyZXR1cm4gMDxpKGRvY3VtZW50KS5maW5kKGUpLmxlbmd0aD9lOm51bGx9Y2F0Y2godCl7cmV0dXJuIG51bGx9fSxnZXRUcmFuc2l0aW9uRHVyYXRpb25Gcm9tRWxlbWVudDpmdW5jdGlvbih0KXtpZighdClyZXR1cm4gMDt2YXIgZT1pKHQpLmNzcygidHJhbnNpdGlvbi1kdXJhdGlvbiIpO3JldHVybiBwYXJzZUZsb2F0KGUpPyhlPWUuc3BsaXQoIiwiKVswXSwxZTMqcGFyc2VGbG9hdChlKSk6MH0scmVmbG93OmZ1bmN0aW9uKHQpe3JldHVybiB0Lm9mZnNldEhlaWdodH0sdHJpZ2dlclRyYW5zaXRpb25FbmQ6ZnVuY3Rpb24odCl7aSh0KS50cmlnZ2VyKGUpfSxzdXBwb3J0c1RyYW5zaXRpb25FbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gQm9vbGVhbihlKX0saXNFbGVtZW50OmZ1bmN0aW9uKHQpe3JldHVybih0WzBdfHx0KS5ub2RlVHlwZX0sdHlwZUNoZWNrQ29uZmlnOmZ1bmN0aW9uKHQsZSxuKXtmb3IodmFyIGkgaW4gbilpZihPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobixpKSl7dmFyIHI9bltpXSxvPWVbaV0scz1vJiZsLmlzRWxlbWVudChvKT8iZWxlbWVudCI6KGE9byx7fS50b1N0cmluZy5jYWxsKGEpLm1hdGNoKC9ccyhbYS16XSspL2kpWzFdLnRvTG93ZXJDYXNlKCkpO2lmKCFuZXcgUmVnRXhwKHIpLnRlc3QocykpdGhyb3cgbmV3IEVycm9yKHQudG9VcHBlckNhc2UoKSsnOiBPcHRpb24gIicraSsnIiBwcm92aWRlZCB0eXBlICInK3MrJyIgYnV0IGV4cGVjdGVkIHR5cGUgIicrcisnIi4nKX12YXIgYX19O3JldHVybiBpLmZuLmVtdWxhdGVUcmFuc2l0aW9uRW5kPXQsaS5ldmVudC5zcGVjaWFsW2wuVFJBTlNJVElPTl9FTkRdPXtiaW5kVHlwZTplLGRlbGVnYXRlVHlwZTplLGhhbmRsZTpmdW5jdGlvbih0KXtpZihpKHQudGFyZ2V0KS5pcyh0aGlzKSlyZXR1cm4gdC5oYW5kbGVPYmouaGFuZGxlci5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSxsfShlPWUmJmUuaGFzT3duUHJvcGVydHkoImRlZmF1bHQiKT9lLmRlZmF1bHQ6ZSksbXQ9KG49ImFsZXJ0IixhPSIuIisobz0iYnMuYWxlcnQiKSxsPShyPWUpLmZuW25dLGY9e0NMT1NFOiJjbG9zZSIrYSxDTE9TRUQ6ImNsb3NlZCIrYSxDTElDS19EQVRBX0FQSToiY2xpY2siK2ErIi5kYXRhLWFwaSJ9LGg9ImFsZXJ0Iix1PSJmYWRlIixkPSJzaG93IixwPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gaSh0KXt0aGlzLl9lbGVtZW50PXR9dmFyIHQ9aS5wcm90b3R5cGU7cmV0dXJuIHQuY2xvc2U9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fZWxlbWVudDt0JiYoZT10aGlzLl9nZXRSb290RWxlbWVudCh0KSksdGhpcy5fdHJpZ2dlckNsb3NlRXZlbnQoZSkuaXNEZWZhdWx0UHJldmVudGVkKCl8fHRoaXMuX3JlbW92ZUVsZW1lbnQoZSl9LHQuZGlzcG9zZT1mdW5jdGlvbigpe3IucmVtb3ZlRGF0YSh0aGlzLl9lbGVtZW50LG8pLHRoaXMuX2VsZW1lbnQ9bnVsbH0sdC5fZ2V0Um9vdEVsZW1lbnQ9ZnVuY3Rpb24odCl7dmFyIGU9Z3QuZ2V0U2VsZWN0b3JGcm9tRWxlbWVudCh0KSxuPSExO3JldHVybiBlJiYobj1yKGUpWzBdKSxufHwobj1yKHQpLmNsb3Nlc3QoIi4iK2gpWzBdKSxufSx0Ll90cmlnZ2VyQ2xvc2VFdmVudD1mdW5jdGlvbih0KXt2YXIgZT1yLkV2ZW50KGYuQ0xPU0UpO3JldHVybiByKHQpLnRyaWdnZXIoZSksZX0sdC5fcmVtb3ZlRWxlbWVudD1mdW5jdGlvbihlKXt2YXIgbj10aGlzO2lmKHIoZSkucmVtb3ZlQ2xhc3MoZCkscihlKS5oYXNDbGFzcyh1KSl7dmFyIHQ9Z3QuZ2V0VHJhbnNpdGlvbkR1cmF0aW9uRnJvbUVsZW1lbnQoZSk7cihlKS5vbmUoZ3QuVFJBTlNJVElPTl9FTkQsZnVuY3Rpb24odCl7cmV0dXJuIG4uX2Rlc3Ryb3lFbGVtZW50KGUsdCl9KS5lbXVsYXRlVHJhbnNpdGlvbkVuZCh0KX1lbHNlIHRoaXMuX2Rlc3Ryb3lFbGVtZW50KGUpfSx0Ll9kZXN0cm95RWxlbWVudD1mdW5jdGlvbih0KXtyKHQpLmRldGFjaCgpLnRyaWdnZXIoZi5DTE9TRUQpLnJlbW92ZSgpfSxpLl9qUXVlcnlJbnRlcmZhY2U9ZnVuY3Rpb24obil7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciB0PXIodGhpcyksZT10LmRhdGEobyk7ZXx8KGU9bmV3IGkodGhpcyksdC5kYXRhKG8sZSkpLCJjbG9zZSI9PT1uJiZlW25dKHRoaXMpfSl9LGkuX2hhbmRsZURpc21pc3M9ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKHQpe3QmJnQucHJldmVudERlZmF1bHQoKSxlLmNsb3NlKHRoaXMpfX0scyhpLG51bGwsW3trZXk6IlZFUlNJT04iLGdldDpmdW5jdGlvbigpe3JldHVybiI0LjEuMSJ9fV0pLGl9KCkscihkb2N1bWVudCkub24oZi5DTElDS19EQVRBX0FQSSwnW2RhdGEtZGlzbWlzcz0iYWxlcnQiXScscC5faGFuZGxlRGlzbWlzcyhuZXcgcCkpLHIuZm5bbl09cC5falF1ZXJ5SW50ZXJmYWNlLHIuZm5bbl0uQ29uc3RydWN0b3I9cCxyLmZuW25dLm5vQ29uZmxpY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gci5mbltuXT1sLHAuX2pRdWVyeUludGVyZmFjZX0scCksX3Q9KG09ImJ1dHRvbiIsdj0iLiIrKF89ImJzLmJ1dHRvbiIpLEU9Ii5kYXRhLWFwaSIseT0oZz1lKS5mblttXSxiPSJhY3RpdmUiLFQ9ImJ0biIsdz0nW2RhdGEtdG9nZ2xlXj0iYnV0dG9uIl0nLEk9J1tkYXRhLXRvZ2dsZT0iYnV0dG9ucyJdJyxEPSJpbnB1dCIsQT0iLmFjdGl2ZSIsUz0iLmJ0biIsTz17Q0xJQ0tfREFUQV9BUEk6ImNsaWNrIit2K0UsRk9DVVNfQkxVUl9EQVRBX0FQSTooQz0iZm9jdXMiKSt2K0UrIiBibHVyIit2K0V9LE49ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKHQpe3RoaXMuX2VsZW1lbnQ9dH12YXIgdD1uLnByb3RvdHlwZTtyZXR1cm4gdC50b2dnbGU9ZnVuY3Rpb24oKXt2YXIgdD0hMCxlPSEwLG49Zyh0aGlzLl9lbGVtZW50KS5jbG9zZXN0KEkpWzBdO2lmKG4pe3ZhciBpPWcodGhpcy5fZWxlbWVudCkuZmluZChEKVswXTtpZihpKXtpZigicmFkaW8iPT09aS50eXBlKWlmKGkuY2hlY2tlZCYmZyh0aGlzLl9lbGVtZW50KS5oYXNDbGFzcyhiKSl0PSExO2Vsc2V7dmFyIHI9ZyhuKS5maW5kKEEpWzBdO3ImJmcocikucmVtb3ZlQ2xhc3MoYil9aWYodCl7aWYoaS5oYXNBdHRyaWJ1dGUoImRpc2FibGVkIil8fG4uaGFzQXR0cmlidXRlKCJkaXNhYmxlZCIpfHxpLmNsYXNzTGlzdC5jb250YWlucygiZGlzYWJsZWQiKXx8bi5jbGFzc0xpc3QuY29udGFpbnMoImRpc2FibGVkIikpcmV0dXJuO2kuY2hlY2tlZD0hZyh0aGlzLl9lbGVtZW50KS5oYXNDbGFzcyhiKSxnKGkpLnRyaWdnZXIoImNoYW5nZSIpfWkuZm9jdXMoKSxlPSExfX1lJiZ0aGlzLl9lbGVtZW50LnNldEF0dHJpYnV0ZSgiYXJpYS1wcmVzc2VkIiwhZyh0aGlzLl9lbGVtZW50KS5oYXNDbGFzcyhiKSksdCYmZyh0aGlzLl9lbGVtZW50KS50b2dnbGVDbGFzcyhiKX0sdC5kaXNwb3NlPWZ1bmN0aW9uKCl7Zy5yZW1vdmVEYXRhKHRoaXMuX2VsZW1lbnQsXyksdGhpcy5fZWxlbWVudD1udWxsfSxuLl9qUXVlcnlJbnRlcmZhY2U9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciB0PWcodGhpcykuZGF0YShfKTt0fHwodD1uZXcgbih0aGlzKSxnKHRoaXMpLmRhdGEoXyx0KSksInRvZ2dsZSI9PT1lJiZ0W2VdKCl9KX0scyhuLG51bGwsW3trZXk6IlZFUlNJT04iLGdldDpmdW5jdGlvbigpe3JldHVybiI0LjEuMSJ9fV0pLG59KCksZyhkb2N1bWVudCkub24oTy5DTElDS19EQVRBX0FQSSx3LGZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKTt2YXIgZT10LnRhcmdldDtnKGUpLmhhc0NsYXNzKFQpfHwoZT1nKGUpLmNsb3Nlc3QoUykpLE4uX2pRdWVyeUludGVyZmFjZS5jYWxsKGcoZSksInRvZ2dsZSIpfSkub24oTy5GT0NVU19CTFVSX0RBVEFfQVBJLHcsZnVuY3Rpb24odCl7dmFyIGU9Zyh0LnRhcmdldCkuY2xvc2VzdChTKVswXTtnKGUpLnRvZ2dsZUNsYXNzKEMsL15mb2N1cyhpbik/JC8udGVzdCh0LnR5cGUpKX0pLGcuZm5bbV09Ti5falF1ZXJ5SW50ZXJmYWNlLGcuZm5bbV0uQ29uc3RydWN0b3I9TixnLmZuW21dLm5vQ29uZmxpY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gZy5mblttXT15LE4uX2pRdWVyeUludGVyZmFjZX0sTiksdnQ9KEw9ImNhcm91c2VsIix4PSIuIisoUD0iYnMuY2Fyb3VzZWwiKSxqPSIuZGF0YS1hcGkiLE09KGs9ZSkuZm5bTF0sUj17aW50ZXJ2YWw6NWUzLGtleWJvYXJkOiEwLHNsaWRlOiExLHBhdXNlOiJob3ZlciIsd3JhcDohMH0sSD17aW50ZXJ2YWw6IihudW1iZXJ8Ym9vbGVhbikiLGtleWJvYXJkOiJib29sZWFuIixzbGlkZToiKGJvb2xlYW58c3RyaW5nKSIscGF1c2U6IihzdHJpbmd8Ym9vbGVhbikiLHdyYXA6ImJvb2xlYW4ifSxXPSJuZXh0IixGPSJwcmV2IixVPSJsZWZ0IixCPSJyaWdodCIsSz17U0xJREU6InNsaWRlIit4LFNMSUQ6InNsaWQiK3gsS0VZRE9XTjoia2V5ZG93biIreCxNT1VTRUVOVEVSOiJtb3VzZWVudGVyIit4LE1PVVNFTEVBVkU6Im1vdXNlbGVhdmUiK3gsVE9VQ0hFTkQ6InRvdWNoZW5kIit4LExPQURfREFUQV9BUEk6ImxvYWQiK3graixDTElDS19EQVRBX0FQSToiY2xpY2siK3gran0sVj0iY2Fyb3VzZWwiLFE9ImFjdGl2ZSIsWT0ic2xpZGUiLEc9ImNhcm91c2VsLWl0ZW0tcmlnaHQiLHE9ImNhcm91c2VsLWl0ZW0tbGVmdCIsej0iY2Fyb3VzZWwtaXRlbS1uZXh0IixYPSJjYXJvdXNlbC1pdGVtLXByZXYiLEo9e0FDVElWRToiLmFjdGl2ZSIsQUNUSVZFX0lURU06Ii5hY3RpdmUuY2Fyb3VzZWwtaXRlbSIsSVRFTToiLmNhcm91c2VsLWl0ZW0iLE5FWFRfUFJFVjoiLmNhcm91c2VsLWl0ZW0tbmV4dCwgLmNhcm91c2VsLWl0ZW0tcHJldiIsSU5ESUNBVE9SUzoiLmNhcm91c2VsLWluZGljYXRvcnMiLERBVEFfU0xJREU6IltkYXRhLXNsaWRlXSwgW2RhdGEtc2xpZGUtdG9dIixEQVRBX1JJREU6J1tkYXRhLXJpZGU9ImNhcm91c2VsIl0nfSxaPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gbyh0LGUpe3RoaXMuX2l0ZW1zPW51bGwsdGhpcy5faW50ZXJ2YWw9bnVsbCx0aGlzLl9hY3RpdmVFbGVtZW50PW51bGwsdGhpcy5faXNQYXVzZWQ9ITEsdGhpcy5faXNTbGlkaW5nPSExLHRoaXMudG91Y2hUaW1lb3V0PW51bGwsdGhpcy5fY29uZmlnPXRoaXMuX2dldENvbmZpZyhlKSx0aGlzLl9lbGVtZW50PWsodClbMF0sdGhpcy5faW5kaWNhdG9yc0VsZW1lbnQ9ayh0aGlzLl9lbGVtZW50KS5maW5kKEouSU5ESUNBVE9SUylbMF0sdGhpcy5fYWRkRXZlbnRMaXN0ZW5lcnMoKX12YXIgdD1vLnByb3RvdHlwZTtyZXR1cm4gdC5uZXh0PWZ1bmN0aW9uKCl7dGhpcy5faXNTbGlkaW5nfHx0aGlzLl9zbGlkZShXKX0sdC5uZXh0V2hlblZpc2libGU9ZnVuY3Rpb24oKXshZG9jdW1lbnQuaGlkZGVuJiZrKHRoaXMuX2VsZW1lbnQpLmlzKCI6dmlzaWJsZSIpJiYiaGlkZGVuIiE9PWsodGhpcy5fZWxlbWVudCkuY3NzKCJ2aXNpYmlsaXR5IikmJnRoaXMubmV4dCgpfSx0LnByZXY9ZnVuY3Rpb24oKXt0aGlzLl9pc1NsaWRpbmd8fHRoaXMuX3NsaWRlKEYpfSx0LnBhdXNlPWZ1bmN0aW9uKHQpe3R8fCh0aGlzLl9pc1BhdXNlZD0hMCksayh0aGlzLl9lbGVtZW50KS5maW5kKEouTkVYVF9QUkVWKVswXSYmKGd0LnRyaWdnZXJUcmFuc2l0aW9uRW5kKHRoaXMuX2VsZW1lbnQpLHRoaXMuY3ljbGUoITApKSxjbGVhckludGVydmFsKHRoaXMuX2ludGVydmFsKSx0aGlzLl9pbnRlcnZhbD1udWxsfSx0LmN5Y2xlPWZ1bmN0aW9uKHQpe3R8fCh0aGlzLl9pc1BhdXNlZD0hMSksdGhpcy5faW50ZXJ2YWwmJihjbGVhckludGVydmFsKHRoaXMuX2ludGVydmFsKSx0aGlzLl9pbnRlcnZhbD1udWxsKSx0aGlzLl9jb25maWcuaW50ZXJ2YWwmJiF0aGlzLl9pc1BhdXNlZCYmKHRoaXMuX2ludGVydmFsPXNldEludGVydmFsKChkb2N1bWVudC52aXNpYmlsaXR5U3RhdGU/dGhpcy5uZXh0V2hlblZpc2libGU6dGhpcy5uZXh0KS5iaW5kKHRoaXMpLHRoaXMuX2NvbmZpZy5pbnRlcnZhbCkpfSx0LnRvPWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXM7dGhpcy5fYWN0aXZlRWxlbWVudD1rKHRoaXMuX2VsZW1lbnQpLmZpbmQoSi5BQ1RJVkVfSVRFTSlbMF07dmFyIG49dGhpcy5fZ2V0SXRlbUluZGV4KHRoaXMuX2FjdGl2ZUVsZW1lbnQpO2lmKCEodD50aGlzLl9pdGVtcy5sZW5ndGgtMXx8dDwwKSlpZih0aGlzLl9pc1NsaWRpbmcpayh0aGlzLl9lbGVtZW50KS5vbmUoSy5TTElELGZ1bmN0aW9uKCl7cmV0dXJuIGUudG8odCl9KTtlbHNle2lmKG49PT10KXJldHVybiB0aGlzLnBhdXNlKCksdm9pZCB0aGlzLmN5Y2xlKCk7dmFyIGk9bjx0P1c6Rjt0aGlzLl9zbGlkZShpLHRoaXMuX2l0ZW1zW3RdKX19LHQuZGlzcG9zZT1mdW5jdGlvbigpe2sodGhpcy5fZWxlbWVudCkub2ZmKHgpLGsucmVtb3ZlRGF0YSh0aGlzLl9lbGVtZW50LFApLHRoaXMuX2l0ZW1zPW51bGwsdGhpcy5fY29uZmlnPW51bGwsdGhpcy5fZWxlbWVudD1udWxsLHRoaXMuX2ludGVydmFsPW51bGwsdGhpcy5faXNQYXVzZWQ9bnVsbCx0aGlzLl9pc1NsaWRpbmc9bnVsbCx0aGlzLl9hY3RpdmVFbGVtZW50PW51bGwsdGhpcy5faW5kaWNhdG9yc0VsZW1lbnQ9bnVsbH0sdC5fZ2V0Q29uZmlnPWZ1bmN0aW9uKHQpe3JldHVybiB0PWMoe30sUix0KSxndC50eXBlQ2hlY2tDb25maWcoTCx0LEgpLHR9LHQuX2FkZEV2ZW50TGlzdGVuZXJzPWZ1bmN0aW9uKCl7dmFyIGU9dGhpczt0aGlzLl9jb25maWcua2V5Ym9hcmQmJmsodGhpcy5fZWxlbWVudCkub24oSy5LRVlET1dOLGZ1bmN0aW9uKHQpe3JldHVybiBlLl9rZXlkb3duKHQpfSksImhvdmVyIj09PXRoaXMuX2NvbmZpZy5wYXVzZSYmKGsodGhpcy5fZWxlbWVudCkub24oSy5NT1VTRUVOVEVSLGZ1bmN0aW9uKHQpe3JldHVybiBlLnBhdXNlKHQpfSkub24oSy5NT1VTRUxFQVZFLGZ1bmN0aW9uKHQpe3JldHVybiBlLmN5Y2xlKHQpfSksIm9udG91Y2hzdGFydCJpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQmJmsodGhpcy5fZWxlbWVudCkub24oSy5UT1VDSEVORCxmdW5jdGlvbigpe2UucGF1c2UoKSxlLnRvdWNoVGltZW91dCYmY2xlYXJUaW1lb3V0KGUudG91Y2hUaW1lb3V0KSxlLnRvdWNoVGltZW91dD1zZXRUaW1lb3V0KGZ1bmN0aW9uKHQpe3JldHVybiBlLmN5Y2xlKHQpfSw1MDArZS5fY29uZmlnLmludGVydmFsKX0pKX0sdC5fa2V5ZG93bj1mdW5jdGlvbih0KXtpZighL2lucHV0fHRleHRhcmVhL2kudGVzdCh0LnRhcmdldC50YWdOYW1lKSlzd2l0Y2godC53aGljaCl7Y2FzZSAzNzp0LnByZXZlbnREZWZhdWx0KCksdGhpcy5wcmV2KCk7YnJlYWs7Y2FzZSAzOTp0LnByZXZlbnREZWZhdWx0KCksdGhpcy5uZXh0KCl9fSx0Ll9nZXRJdGVtSW5kZXg9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2l0ZW1zPWsubWFrZUFycmF5KGsodCkucGFyZW50KCkuZmluZChKLklURU0pKSx0aGlzLl9pdGVtcy5pbmRleE9mKHQpfSx0Ll9nZXRJdGVtQnlEaXJlY3Rpb249ZnVuY3Rpb24odCxlKXt2YXIgbj10PT09VyxpPXQ9PT1GLHI9dGhpcy5fZ2V0SXRlbUluZGV4KGUpLG89dGhpcy5faXRlbXMubGVuZ3RoLTE7aWYoKGkmJjA9PT1yfHxuJiZyPT09bykmJiF0aGlzLl9jb25maWcud3JhcClyZXR1cm4gZTt2YXIgcz0ocisodD09PUY/LTE6MSkpJXRoaXMuX2l0ZW1zLmxlbmd0aDtyZXR1cm4tMT09PXM/dGhpcy5faXRlbXNbdGhpcy5faXRlbXMubGVuZ3RoLTFdOnRoaXMuX2l0ZW1zW3NdfSx0Ll90cmlnZ2VyU2xpZGVFdmVudD1mdW5jdGlvbih0LGUpe3ZhciBuPXRoaXMuX2dldEl0ZW1JbmRleCh0KSxpPXRoaXMuX2dldEl0ZW1JbmRleChrKHRoaXMuX2VsZW1lbnQpLmZpbmQoSi5BQ1RJVkVfSVRFTSlbMF0pLHI9ay5FdmVudChLLlNMSURFLHtyZWxhdGVkVGFyZ2V0OnQsZGlyZWN0aW9uOmUsZnJvbTppLHRvOm59KTtyZXR1cm4gayh0aGlzLl9lbGVtZW50KS50cmlnZ2VyKHIpLHJ9LHQuX3NldEFjdGl2ZUluZGljYXRvckVsZW1lbnQ9ZnVuY3Rpb24odCl7aWYodGhpcy5faW5kaWNhdG9yc0VsZW1lbnQpe2sodGhpcy5faW5kaWNhdG9yc0VsZW1lbnQpLmZpbmQoSi5BQ1RJVkUpLnJlbW92ZUNsYXNzKFEpO3ZhciBlPXRoaXMuX2luZGljYXRvcnNFbGVtZW50LmNoaWxkcmVuW3RoaXMuX2dldEl0ZW1JbmRleCh0KV07ZSYmayhlKS5hZGRDbGFzcyhRKX19LHQuX3NsaWRlPWZ1bmN0aW9uKHQsZSl7dmFyIG4saSxyLG89dGhpcyxzPWsodGhpcy5fZWxlbWVudCkuZmluZChKLkFDVElWRV9JVEVNKVswXSxhPXRoaXMuX2dldEl0ZW1JbmRleChzKSxsPWV8fHMmJnRoaXMuX2dldEl0ZW1CeURpcmVjdGlvbih0LHMpLGM9dGhpcy5fZ2V0SXRlbUluZGV4KGwpLGY9Qm9vbGVhbih0aGlzLl9pbnRlcnZhbCk7aWYodD09PVc/KG49cSxpPXoscj1VKToobj1HLGk9WCxyPUIpLGwmJmsobCkuaGFzQ2xhc3MoUSkpdGhpcy5faXNTbGlkaW5nPSExO2Vsc2UgaWYoIXRoaXMuX3RyaWdnZXJTbGlkZUV2ZW50KGwscikuaXNEZWZhdWx0UHJldmVudGVkKCkmJnMmJmwpe3RoaXMuX2lzU2xpZGluZz0hMCxmJiZ0aGlzLnBhdXNlKCksdGhpcy5fc2V0QWN0aXZlSW5kaWNhdG9yRWxlbWVudChsKTt2YXIgaD1rLkV2ZW50KEsuU0xJRCx7cmVsYXRlZFRhcmdldDpsLGRpcmVjdGlvbjpyLGZyb206YSx0bzpjfSk7aWYoayh0aGlzLl9lbGVtZW50KS5oYXNDbGFzcyhZKSl7ayhsKS5hZGRDbGFzcyhpKSxndC5yZWZsb3cobCksayhzKS5hZGRDbGFzcyhuKSxrKGwpLmFkZENsYXNzKG4pO3ZhciB1PWd0LmdldFRyYW5zaXRpb25EdXJhdGlvbkZyb21FbGVtZW50KHMpO2socykub25lKGd0LlRSQU5TSVRJT05fRU5ELGZ1bmN0aW9uKCl7ayhsKS5yZW1vdmVDbGFzcyhuKyIgIitpKS5hZGRDbGFzcyhRKSxrKHMpLnJlbW92ZUNsYXNzKFErIiAiK2krIiAiK24pLG8uX2lzU2xpZGluZz0hMSxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cmV0dXJuIGsoby5fZWxlbWVudCkudHJpZ2dlcihoKX0sMCl9KS5lbXVsYXRlVHJhbnNpdGlvbkVuZCh1KX1lbHNlIGsocykucmVtb3ZlQ2xhc3MoUSksayhsKS5hZGRDbGFzcyhRKSx0aGlzLl9pc1NsaWRpbmc9ITEsayh0aGlzLl9lbGVtZW50KS50cmlnZ2VyKGgpO2YmJnRoaXMuY3ljbGUoKX19LG8uX2pRdWVyeUludGVyZmFjZT1mdW5jdGlvbihpKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIHQ9ayh0aGlzKS5kYXRhKFApLGU9Yyh7fSxSLGsodGhpcykuZGF0YSgpKTsib2JqZWN0Ij09dHlwZW9mIGkmJihlPWMoe30sZSxpKSk7dmFyIG49InN0cmluZyI9PXR5cGVvZiBpP2k6ZS5zbGlkZTtpZih0fHwodD1uZXcgbyh0aGlzLGUpLGsodGhpcykuZGF0YShQLHQpKSwibnVtYmVyIj09dHlwZW9mIGkpdC50byhpKTtlbHNlIGlmKCJzdHJpbmciPT10eXBlb2Ygbil7aWYoInVuZGVmaW5lZCI9PXR5cGVvZiB0W25dKXRocm93IG5ldyBUeXBlRXJyb3IoJ05vIG1ldGhvZCBuYW1lZCAiJytuKyciJyk7dFtuXSgpfWVsc2UgZS5pbnRlcnZhbCYmKHQucGF1c2UoKSx0LmN5Y2xlKCkpfSl9LG8uX2RhdGFBcGlDbGlja0hhbmRsZXI9ZnVuY3Rpb24odCl7dmFyIGU9Z3QuZ2V0U2VsZWN0b3JGcm9tRWxlbWVudCh0aGlzKTtpZihlKXt2YXIgbj1rKGUpWzBdO2lmKG4mJmsobikuaGFzQ2xhc3MoVikpe3ZhciBpPWMoe30sayhuKS5kYXRhKCksayh0aGlzKS5kYXRhKCkpLHI9dGhpcy5nZXRBdHRyaWJ1dGUoImRhdGEtc2xpZGUtdG8iKTtyJiYoaS5pbnRlcnZhbD0hMSksby5falF1ZXJ5SW50ZXJmYWNlLmNhbGwoayhuKSxpKSxyJiZrKG4pLmRhdGEoUCkudG8ociksdC5wcmV2ZW50RGVmYXVsdCgpfX19LHMobyxudWxsLFt7a2V5OiJWRVJTSU9OIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4iNC4xLjEifX0se2tleToiRGVmYXVsdCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIFJ9fV0pLG99KCksayhkb2N1bWVudCkub24oSy5DTElDS19EQVRBX0FQSSxKLkRBVEFfU0xJREUsWi5fZGF0YUFwaUNsaWNrSGFuZGxlciksayh3aW5kb3cpLm9uKEsuTE9BRF9EQVRBX0FQSSxmdW5jdGlvbigpe2soSi5EQVRBX1JJREUpLmVhY2goZnVuY3Rpb24oKXt2YXIgdD1rKHRoaXMpO1ouX2pRdWVyeUludGVyZmFjZS5jYWxsKHQsdC5kYXRhKCkpfSl9KSxrLmZuW0xdPVouX2pRdWVyeUludGVyZmFjZSxrLmZuW0xdLkNvbnN0cnVjdG9yPVosay5mbltMXS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cmV0dXJuIGsuZm5bTF09TSxaLl9qUXVlcnlJbnRlcmZhY2V9LFopLEV0PSh0dD0iY29sbGFwc2UiLG50PSIuIisoZXQ9ImJzLmNvbGxhcHNlIiksaXQ9KCQ9ZSkuZm5bdHRdLHJ0PXt0b2dnbGU6ITAscGFyZW50OiIifSxvdD17dG9nZ2xlOiJib29sZWFuIixwYXJlbnQ6IihzdHJpbmd8ZWxlbWVudCkifSxzdD17U0hPVzoic2hvdyIrbnQsU0hPV046InNob3duIitudCxISURFOiJoaWRlIitudCxISURERU46ImhpZGRlbiIrbnQsQ0xJQ0tfREFUQV9BUEk6ImNsaWNrIitudCsiLmRhdGEtYXBpIn0sYXQ9InNob3ciLGx0PSJjb2xsYXBzZSIsY3Q9ImNvbGxhcHNpbmciLGZ0PSJjb2xsYXBzZWQiLGh0PSJ3aWR0aCIsdXQ9ImhlaWdodCIsZHQ9e0FDVElWRVM6Ii5zaG93LCAuY29sbGFwc2luZyIsREFUQV9UT0dHTEU6J1tkYXRhLXRvZ2dsZT0iY29sbGFwc2UiXSd9LHB0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSh0LGUpe3RoaXMuX2lzVHJhbnNpdGlvbmluZz0hMSx0aGlzLl9lbGVtZW50PXQsdGhpcy5fY29uZmlnPXRoaXMuX2dldENvbmZpZyhlKSx0aGlzLl90cmlnZ2VyQXJyYXk9JC5tYWtlQXJyYXkoJCgnW2RhdGEtdG9nZ2xlPSJjb2xsYXBzZSJdW2hyZWY9IiMnK3QuaWQrJyJdLFtkYXRhLXRvZ2dsZT0iY29sbGFwc2UiXVtkYXRhLXRhcmdldD0iIycrdC5pZCsnIl0nKSk7Zm9yKHZhciBuPSQoZHQuREFUQV9UT0dHTEUpLGk9MDtpPG4ubGVuZ3RoO2krKyl7dmFyIHI9bltpXSxvPWd0LmdldFNlbGVjdG9yRnJvbUVsZW1lbnQocik7bnVsbCE9PW8mJjA8JChvKS5maWx0ZXIodCkubGVuZ3RoJiYodGhpcy5fc2VsZWN0b3I9byx0aGlzLl90cmlnZ2VyQXJyYXkucHVzaChyKSl9dGhpcy5fcGFyZW50PXRoaXMuX2NvbmZpZy5wYXJlbnQ/dGhpcy5fZ2V0UGFyZW50KCk6bnVsbCx0aGlzLl9jb25maWcucGFyZW50fHx0aGlzLl9hZGRBcmlhQW5kQ29sbGFwc2VkQ2xhc3ModGhpcy5fZWxlbWVudCx0aGlzLl90cmlnZ2VyQXJyYXkpLHRoaXMuX2NvbmZpZy50b2dnbGUmJnRoaXMudG9nZ2xlKCl9dmFyIHQ9YS5wcm90b3R5cGU7cmV0dXJuIHQudG9nZ2xlPWZ1bmN0aW9uKCl7JCh0aGlzLl9lbGVtZW50KS5oYXNDbGFzcyhhdCk/dGhpcy5oaWRlKCk6dGhpcy5zaG93KCl9LHQuc2hvdz1mdW5jdGlvbigpe3ZhciB0LGUsbj10aGlzO2lmKCF0aGlzLl9pc1RyYW5zaXRpb25pbmcmJiEkKHRoaXMuX2VsZW1lbnQpLmhhc0NsYXNzKGF0KSYmKHRoaXMuX3BhcmVudCYmMD09PSh0PSQubWFrZUFycmF5KCQodGhpcy5fcGFyZW50KS5maW5kKGR0LkFDVElWRVMpLmZpbHRlcignW2RhdGEtcGFyZW50PSInK3RoaXMuX2NvbmZpZy5wYXJlbnQrJyJdJykpKS5sZW5ndGgmJih0PW51bGwpLCEodCYmKGU9JCh0KS5ub3QodGhpcy5fc2VsZWN0b3IpLmRhdGEoZXQpKSYmZS5faXNUcmFuc2l0aW9uaW5nKSkpe3ZhciBpPSQuRXZlbnQoc3QuU0hPVyk7aWYoJCh0aGlzLl9lbGVtZW50KS50cmlnZ2VyKGkpLCFpLmlzRGVmYXVsdFByZXZlbnRlZCgpKXt0JiYoYS5falF1ZXJ5SW50ZXJmYWNlLmNhbGwoJCh0KS5ub3QodGhpcy5fc2VsZWN0b3IpLCJoaWRlIiksZXx8JCh0KS5kYXRhKGV0LG51bGwpKTt2YXIgcj10aGlzLl9nZXREaW1lbnNpb24oKTskKHRoaXMuX2VsZW1lbnQpLnJlbW92ZUNsYXNzKGx0KS5hZGRDbGFzcyhjdCksKHRoaXMuX2VsZW1lbnQuc3R5bGVbcl09MCk8dGhpcy5fdHJpZ2dlckFycmF5Lmxlbmd0aCYmJCh0aGlzLl90cmlnZ2VyQXJyYXkpLnJlbW92ZUNsYXNzKGZ0KS5hdHRyKCJhcmlhLWV4cGFuZGVkIiwhMCksdGhpcy5zZXRUcmFuc2l0aW9uaW5nKCEwKTt2YXIgbz0ic2Nyb2xsIisoclswXS50b1VwcGVyQ2FzZSgpK3Iuc2xpY2UoMSkpLHM9Z3QuZ2V0VHJhbnNpdGlvbkR1cmF0aW9uRnJvbUVsZW1lbnQodGhpcy5fZWxlbWVudCk7JCh0aGlzLl9lbGVtZW50KS5vbmUoZ3QuVFJBTlNJVElPTl9FTkQsZnVuY3Rpb24oKXskKG4uX2VsZW1lbnQpLnJlbW92ZUNsYXNzKGN0KS5hZGRDbGFzcyhsdCkuYWRkQ2xhc3MoYXQpLG4uX2VsZW1lbnQuc3R5bGVbcl09IiIsbi5zZXRUcmFuc2l0aW9uaW5nKCExKSwkKG4uX2VsZW1lbnQpLnRyaWdnZXIoc3QuU0hPV04pfSkuZW11bGF0ZVRyYW5zaXRpb25FbmQocyksdGhpcy5fZWxlbWVudC5zdHlsZVtyXT10aGlzLl9lbGVtZW50W29dKyJweCJ9fX0sdC5oaWRlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcztpZighdGhpcy5faXNUcmFuc2l0aW9uaW5nJiYkKHRoaXMuX2VsZW1lbnQpLmhhc0NsYXNzKGF0KSl7dmFyIGU9JC5FdmVudChzdC5ISURFKTtpZigkKHRoaXMuX2VsZW1lbnQpLnRyaWdnZXIoZSksIWUuaXNEZWZhdWx0UHJldmVudGVkKCkpe3ZhciBuPXRoaXMuX2dldERpbWVuc2lvbigpO2lmKHRoaXMuX2VsZW1lbnQuc3R5bGVbbl09dGhpcy5fZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVtuXSsicHgiLGd0LnJlZmxvdyh0aGlzLl9lbGVtZW50KSwkKHRoaXMuX2VsZW1lbnQpLmFkZENsYXNzKGN0KS5yZW1vdmVDbGFzcyhsdCkucmVtb3ZlQ2xhc3MoYXQpLDA8dGhpcy5fdHJpZ2dlckFycmF5Lmxlbmd0aClmb3IodmFyIGk9MDtpPHRoaXMuX3RyaWdnZXJBcnJheS5sZW5ndGg7aSsrKXt2YXIgcj10aGlzLl90cmlnZ2VyQXJyYXlbaV0sbz1ndC5nZXRTZWxlY3RvckZyb21FbGVtZW50KHIpO2lmKG51bGwhPT1vKSQobykuaGFzQ2xhc3MoYXQpfHwkKHIpLmFkZENsYXNzKGZ0KS5hdHRyKCJhcmlhLWV4cGFuZGVkIiwhMSl9dGhpcy5zZXRUcmFuc2l0aW9uaW5nKCEwKTt0aGlzLl9lbGVtZW50LnN0eWxlW25dPSIiO3ZhciBzPWd0LmdldFRyYW5zaXRpb25EdXJhdGlvbkZyb21FbGVtZW50KHRoaXMuX2VsZW1lbnQpOyQodGhpcy5fZWxlbWVudCkub25lKGd0LlRSQU5TSVRJT05fRU5ELGZ1bmN0aW9uKCl7dC5zZXRUcmFuc2l0aW9uaW5nKCExKSwkKHQuX2VsZW1lbnQpLnJlbW92ZUNsYXNzKGN0KS5hZGRDbGFzcyhsdCkudHJpZ2dlcihzdC5ISURERU4pfSkuZW11bGF0ZVRyYW5zaXRpb25FbmQocyl9fX0sdC5zZXRUcmFuc2l0aW9uaW5nPWZ1bmN0aW9uKHQpe3RoaXMuX2lzVHJhbnNpdGlvbmluZz10fSx0LmRpc3Bvc2U9ZnVuY3Rpb24oKXskLnJlbW92ZURhdGEodGhpcy5fZWxlbWVudCxldCksdGhpcy5fY29uZmlnPW51bGwsdGhpcy5fcGFyZW50PW51bGwsdGhpcy5fZWxlbWVudD1udWxsLHRoaXMuX3RyaWdnZXJBcnJheT1udWxsLHRoaXMuX2lzVHJhbnNpdGlvbmluZz1udWxsfSx0Ll9nZXRDb25maWc9ZnVuY3Rpb24odCl7cmV0dXJuKHQ9Yyh7fSxydCx0KSkudG9nZ2xlPUJvb2xlYW4odC50b2dnbGUpLGd0LnR5cGVDaGVja0NvbmZpZyh0dCx0LG90KSx0fSx0Ll9nZXREaW1lbnNpb249ZnVuY3Rpb24oKXtyZXR1cm4gJCh0aGlzLl9lbGVtZW50KS5oYXNDbGFzcyhodCk/aHQ6dXR9LHQuX2dldFBhcmVudD1mdW5jdGlvbigpe3ZhciBuPXRoaXMsdD1udWxsO2d0LmlzRWxlbWVudCh0aGlzLl9jb25maWcucGFyZW50KT8odD10aGlzLl9jb25maWcucGFyZW50LCJ1bmRlZmluZWQiIT10eXBlb2YgdGhpcy5fY29uZmlnLnBhcmVudC5qcXVlcnkmJih0PXRoaXMuX2NvbmZpZy5wYXJlbnRbMF0pKTp0PSQodGhpcy5fY29uZmlnLnBhcmVudClbMF07dmFyIGU9J1tkYXRhLXRvZ2dsZT0iY29sbGFwc2UiXVtkYXRhLXBhcmVudD0iJyt0aGlzLl9jb25maWcucGFyZW50KyciXSc7cmV0dXJuICQodCkuZmluZChlKS5lYWNoKGZ1bmN0aW9uKHQsZSl7bi5fYWRkQXJpYUFuZENvbGxhcHNlZENsYXNzKGEuX2dldFRhcmdldEZyb21FbGVtZW50KGUpLFtlXSl9KSx0fSx0Ll9hZGRBcmlhQW5kQ29sbGFwc2VkQ2xhc3M9ZnVuY3Rpb24odCxlKXtpZih0KXt2YXIgbj0kKHQpLmhhc0NsYXNzKGF0KTswPGUubGVuZ3RoJiYkKGUpLnRvZ2dsZUNsYXNzKGZ0LCFuKS5hdHRyKCJhcmlhLWV4cGFuZGVkIixuKX19LGEuX2dldFRhcmdldEZyb21FbGVtZW50PWZ1bmN0aW9uKHQpe3ZhciBlPWd0LmdldFNlbGVjdG9yRnJvbUVsZW1lbnQodCk7cmV0dXJuIGU/JChlKVswXTpudWxsfSxhLl9qUXVlcnlJbnRlcmZhY2U9ZnVuY3Rpb24oaSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciB0PSQodGhpcyksZT10LmRhdGEoZXQpLG49Yyh7fSxydCx0LmRhdGEoKSwib2JqZWN0Ij09dHlwZW9mIGkmJmk/aTp7fSk7aWYoIWUmJm4udG9nZ2xlJiYvc2hvd3xoaWRlLy50ZXN0KGkpJiYobi50b2dnbGU9ITEpLGV8fChlPW5ldyBhKHRoaXMsbiksdC5kYXRhKGV0LGUpKSwic3RyaW5nIj09dHlwZW9mIGkpe2lmKCJ1bmRlZmluZWQiPT10eXBlb2YgZVtpXSl0aHJvdyBuZXcgVHlwZUVycm9yKCdObyBtZXRob2QgbmFtZWQgIicraSsnIicpO2VbaV0oKX19KX0scyhhLG51bGwsW3trZXk6IlZFUlNJT04iLGdldDpmdW5jdGlvbigpe3JldHVybiI0LjEuMSJ9fSx7a2V5OiJEZWZhdWx0IixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gcnR9fV0pLGF9KCksJChkb2N1bWVudCkub24oc3QuQ0xJQ0tfREFUQV9BUEksZHQuREFUQV9UT0dHTEUsZnVuY3Rpb24odCl7IkEiPT09dC5jdXJyZW50VGFyZ2V0LnRhZ05hbWUmJnQucHJldmVudERlZmF1bHQoKTt2YXIgbj0kKHRoaXMpLGU9Z3QuZ2V0U2VsZWN0b3JGcm9tRWxlbWVudCh0aGlzKTskKGUpLmVhY2goZnVuY3Rpb24oKXt2YXIgdD0kKHRoaXMpLGU9dC5kYXRhKGV0KT8idG9nZ2xlIjpuLmRhdGEoKTtwdC5falF1ZXJ5SW50ZXJmYWNlLmNhbGwodCxlKX0pfSksJC5mblt0dF09cHQuX2pRdWVyeUludGVyZmFjZSwkLmZuW3R0XS5Db25zdHJ1Y3Rvcj1wdCwkLmZuW3R0XS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cmV0dXJuICQuZm5bdHRdPWl0LHB0Ll9qUXVlcnlJbnRlcmZhY2V9LHB0KSx5dD0idW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyYmInVuZGVmaW5lZCIhPXR5cGVvZiBkb2N1bWVudCxidD1bIkVkZ2UiLCJUcmlkZW50IiwiRmlyZWZveCJdLFR0PTAsQ3Q9MDtDdDxidC5sZW5ndGg7Q3QrPTEpaWYoeXQmJjA8PW5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihidFtDdF0pKXtUdD0xO2JyZWFrfXZhciB3dD15dCYmd2luZG93LlByb21pc2U/ZnVuY3Rpb24odCl7dmFyIGU9ITE7cmV0dXJuIGZ1bmN0aW9uKCl7ZXx8KGU9ITAsd2luZG93LlByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24oKXtlPSExLHQoKX0pKX19OmZ1bmN0aW9uKHQpe3ZhciBlPSExO3JldHVybiBmdW5jdGlvbigpe2V8fChlPSEwLHNldFRpbWVvdXQoZnVuY3Rpb24oKXtlPSExLHQoKX0sVHQpKX19O2Z1bmN0aW9uIEl0KHQpe3JldHVybiB0JiYiW29iamVjdCBGdW5jdGlvbl0iPT09e30udG9TdHJpbmcuY2FsbCh0KX1mdW5jdGlvbiBEdCh0LGUpe2lmKDEhPT10Lm5vZGVUeXBlKXJldHVybltdO3ZhciBuPWdldENvbXB1dGVkU3R5bGUodCxudWxsKTtyZXR1cm4gZT9uW2VdOm59ZnVuY3Rpb24gQXQodCl7cmV0dXJuIkhUTUwiPT09dC5ub2RlTmFtZT90OnQucGFyZW50Tm9kZXx8dC5ob3N0fWZ1bmN0aW9uIFN0KHQpe2lmKCF0KXJldHVybiBkb2N1bWVudC5ib2R5O3N3aXRjaCh0Lm5vZGVOYW1lKXtjYXNlIkhUTUwiOmNhc2UiQk9EWSI6cmV0dXJuIHQub3duZXJEb2N1bWVudC5ib2R5O2Nhc2UiI2RvY3VtZW50IjpyZXR1cm4gdC5ib2R5fXZhciBlPUR0KHQpLG49ZS5vdmVyZmxvdyxpPWUub3ZlcmZsb3dYLHI9ZS5vdmVyZmxvd1k7cmV0dXJuLyhhdXRvfHNjcm9sbHxvdmVybGF5KS8udGVzdChuK3IraSk/dDpTdChBdCh0KSl9dmFyIE90PXl0JiYhKCF3aW5kb3cuTVNJbnB1dE1ldGhvZENvbnRleHR8fCFkb2N1bWVudC5kb2N1bWVudE1vZGUpLE50PXl0JiYvTVNJRSAxMC8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtmdW5jdGlvbiBrdCh0KXtyZXR1cm4gMTE9PT10P090OjEwPT09dD9OdDpPdHx8TnR9ZnVuY3Rpb24gTHQodCl7aWYoIXQpcmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtmb3IodmFyIGU9a3QoMTApP2RvY3VtZW50LmJvZHk6bnVsbCxuPXQub2Zmc2V0UGFyZW50O249PT1lJiZ0Lm5leHRFbGVtZW50U2libGluZzspbj0odD10Lm5leHRFbGVtZW50U2libGluZykub2Zmc2V0UGFyZW50O3ZhciBpPW4mJm4ubm9kZU5hbWU7cmV0dXJuIGkmJiJCT0RZIiE9PWkmJiJIVE1MIiE9PWk/LTEhPT1bIlREIiwiVEFCTEUiXS5pbmRleE9mKG4ubm9kZU5hbWUpJiYic3RhdGljIj09PUR0KG4sInBvc2l0aW9uIik/THQobik6bjp0P3Qub3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ6ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50fWZ1bmN0aW9uIFB0KHQpe3JldHVybiBudWxsIT09dC5wYXJlbnROb2RlP1B0KHQucGFyZW50Tm9kZSk6dH1mdW5jdGlvbiB4dCh0LGUpe2lmKCEodCYmdC5ub2RlVHlwZSYmZSYmZS5ub2RlVHlwZSkpcmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDt2YXIgbj10LmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGUpJk5vZGUuRE9DVU1FTlRfUE9TSVRJT05fRk9MTE9XSU5HLGk9bj90OmUscj1uP2U6dCxvPWRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7by5zZXRTdGFydChpLDApLG8uc2V0RW5kKHIsMCk7dmFyIHMsYSxsPW8uY29tbW9uQW5jZXN0b3JDb250YWluZXI7aWYodCE9PWwmJmUhPT1sfHxpLmNvbnRhaW5zKHIpKXJldHVybiJCT0RZIj09PShhPShzPWwpLm5vZGVOYW1lKXx8IkhUTUwiIT09YSYmTHQocy5maXJzdEVsZW1lbnRDaGlsZCkhPT1zP0x0KGwpOmw7dmFyIGM9UHQodCk7cmV0dXJuIGMuaG9zdD94dChjLmhvc3QsZSk6eHQodCxQdChlKS5ob3N0KX1mdW5jdGlvbiBqdCh0KXt2YXIgZT0idG9wIj09PSgxPGFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06InRvcCIpPyJzY3JvbGxUb3AiOiJzY3JvbGxMZWZ0IixuPXQubm9kZU5hbWU7aWYoIkJPRFkiPT09bnx8IkhUTUwiPT09bil7dmFyIGk9dC5vd25lckRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtyZXR1cm4odC5vd25lckRvY3VtZW50LnNjcm9sbGluZ0VsZW1lbnR8fGkpW2VdfXJldHVybiB0W2VdfWZ1bmN0aW9uIE10KHQsZSl7dmFyIG49IngiPT09ZT8iTGVmdCI6IlRvcCIsaT0iTGVmdCI9PT1uPyJSaWdodCI6IkJvdHRvbSI7cmV0dXJuIHBhcnNlRmxvYXQodFsiYm9yZGVyIituKyJXaWR0aCJdLDEwKStwYXJzZUZsb2F0KHRbImJvcmRlciIraSsiV2lkdGgiXSwxMCl9ZnVuY3Rpb24gUnQodCxlLG4saSl7cmV0dXJuIE1hdGgubWF4KGVbIm9mZnNldCIrdF0sZVsic2Nyb2xsIit0XSxuWyJjbGllbnQiK3RdLG5bIm9mZnNldCIrdF0sblsic2Nyb2xsIit0XSxrdCgxMCk/blsib2Zmc2V0Iit0XStpWyJtYXJnaW4iKygiSGVpZ2h0Ij09PXQ/IlRvcCI6IkxlZnQiKV0raVsibWFyZ2luIisoIkhlaWdodCI9PT10PyJCb3R0b20iOiJSaWdodCIpXTowKX1mdW5jdGlvbiBIdCgpe3ZhciB0PWRvY3VtZW50LmJvZHksZT1kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsbj1rdCgxMCkmJmdldENvbXB1dGVkU3R5bGUoZSk7cmV0dXJue2hlaWdodDpSdCgiSGVpZ2h0Iix0LGUsbiksd2lkdGg6UnQoIldpZHRoIix0LGUsbil9fXZhciBXdD1mdW5jdGlvbih0LGUpe2lmKCEodCBpbnN0YW5jZW9mIGUpKXRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpfSxGdD1mdW5jdGlvbigpe2Z1bmN0aW9uIGkodCxlKXtmb3IodmFyIG49MDtuPGUubGVuZ3RoO24rKyl7dmFyIGk9ZVtuXTtpLmVudW1lcmFibGU9aS5lbnVtZXJhYmxlfHwhMSxpLmNvbmZpZ3VyYWJsZT0hMCwidmFsdWUiaW4gaSYmKGkud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LGkua2V5LGkpfX1yZXR1cm4gZnVuY3Rpb24odCxlLG4pe3JldHVybiBlJiZpKHQucHJvdG90eXBlLGUpLG4mJmkodCxuKSx0fX0oKSxVdD1mdW5jdGlvbih0LGUsbil7cmV0dXJuIGUgaW4gdD9PYmplY3QuZGVmaW5lUHJvcGVydHkodCxlLHt2YWx1ZTpuLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwfSk6dFtlXT1uLHR9LEJ0PU9iamVjdC5hc3NpZ258fGZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0xO2U8YXJndW1lbnRzLmxlbmd0aDtlKyspe3ZhciBuPWFyZ3VtZW50c1tlXTtmb3IodmFyIGkgaW4gbilPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobixpKSYmKHRbaV09bltpXSl9cmV0dXJuIHR9O2Z1bmN0aW9uIEt0KHQpe3JldHVybiBCdCh7fSx0LHtyaWdodDp0LmxlZnQrdC53aWR0aCxib3R0b206dC50b3ArdC5oZWlnaHR9KX1mdW5jdGlvbiBWdCh0KXt2YXIgZT17fTt0cnl7aWYoa3QoMTApKXtlPXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7dmFyIG49anQodCwidG9wIiksaT1qdCh0LCJsZWZ0Iik7ZS50b3ArPW4sZS5sZWZ0Kz1pLGUuYm90dG9tKz1uLGUucmlnaHQrPWl9ZWxzZSBlPXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCl9Y2F0Y2godCl7fXZhciByPXtsZWZ0OmUubGVmdCx0b3A6ZS50b3Asd2lkdGg6ZS5yaWdodC1lLmxlZnQsaGVpZ2h0OmUuYm90dG9tLWUudG9wfSxvPSJIVE1MIj09PXQubm9kZU5hbWU/SHQoKTp7fSxzPW8ud2lkdGh8fHQuY2xpZW50V2lkdGh8fHIucmlnaHQtci5sZWZ0LGE9by5oZWlnaHR8fHQuY2xpZW50SGVpZ2h0fHxyLmJvdHRvbS1yLnRvcCxsPXQub2Zmc2V0V2lkdGgtcyxjPXQub2Zmc2V0SGVpZ2h0LWE7aWYobHx8Yyl7dmFyIGY9RHQodCk7bC09TXQoZiwieCIpLGMtPU10KGYsInkiKSxyLndpZHRoLT1sLHIuaGVpZ2h0LT1jfXJldHVybiBLdChyKX1mdW5jdGlvbiBRdCh0LGUpe3ZhciBuPTI8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzJdJiZhcmd1bWVudHNbMl0saT1rdCgxMCkscj0iSFRNTCI9PT1lLm5vZGVOYW1lLG89VnQodCkscz1WdChlKSxhPVN0KHQpLGw9RHQoZSksYz1wYXJzZUZsb2F0KGwuYm9yZGVyVG9wV2lkdGgsMTApLGY9cGFyc2VGbG9hdChsLmJvcmRlckxlZnRXaWR0aCwxMCk7biYmIkhUTUwiPT09ZS5ub2RlTmFtZSYmKHMudG9wPU1hdGgubWF4KHMudG9wLDApLHMubGVmdD1NYXRoLm1heChzLmxlZnQsMCkpO3ZhciBoPUt0KHt0b3A6by50b3Atcy50b3AtYyxsZWZ0Om8ubGVmdC1zLmxlZnQtZix3aWR0aDpvLndpZHRoLGhlaWdodDpvLmhlaWdodH0pO2lmKGgubWFyZ2luVG9wPTAsaC5tYXJnaW5MZWZ0PTAsIWkmJnIpe3ZhciB1PXBhcnNlRmxvYXQobC5tYXJnaW5Ub3AsMTApLGQ9cGFyc2VGbG9hdChsLm1hcmdpbkxlZnQsMTApO2gudG9wLT1jLXUsaC5ib3R0b20tPWMtdSxoLmxlZnQtPWYtZCxoLnJpZ2h0LT1mLWQsaC5tYXJnaW5Ub3A9dSxoLm1hcmdpbkxlZnQ9ZH1yZXR1cm4oaSYmIW4/ZS5jb250YWlucyhhKTplPT09YSYmIkJPRFkiIT09YS5ub2RlTmFtZSkmJihoPWZ1bmN0aW9uKHQsZSl7dmFyIG49Mjxhcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbMl0mJmFyZ3VtZW50c1syXSxpPWp0KGUsInRvcCIpLHI9anQoZSwibGVmdCIpLG89bj8tMToxO3JldHVybiB0LnRvcCs9aSpvLHQuYm90dG9tKz1pKm8sdC5sZWZ0Kz1yKm8sdC5yaWdodCs9cipvLHR9KGgsZSkpLGh9ZnVuY3Rpb24gWXQodCl7aWYoIXR8fCF0LnBhcmVudEVsZW1lbnR8fGt0KCkpcmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtmb3IodmFyIGU9dC5wYXJlbnRFbGVtZW50O2UmJiJub25lIj09PUR0KGUsInRyYW5zZm9ybSIpOyllPWUucGFyZW50RWxlbWVudDtyZXR1cm4gZXx8ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50fWZ1bmN0aW9uIEd0KHQsZSxuLGkpe3ZhciByPTQ8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzRdJiZhcmd1bWVudHNbNF0sbz17dG9wOjAsbGVmdDowfSxzPXI/WXQodCk6eHQodCxlKTtpZigidmlld3BvcnQiPT09aSlvPWZ1bmN0aW9uKHQpe3ZhciBlPTE8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzFdJiZhcmd1bWVudHNbMV0sbj10Lm93bmVyRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LGk9UXQodCxuKSxyPU1hdGgubWF4KG4uY2xpZW50V2lkdGgsd2luZG93LmlubmVyV2lkdGh8fDApLG89TWF0aC5tYXgobi5jbGllbnRIZWlnaHQsd2luZG93LmlubmVySGVpZ2h0fHwwKSxzPWU/MDpqdChuKSxhPWU/MDpqdChuLCJsZWZ0Iik7cmV0dXJuIEt0KHt0b3A6cy1pLnRvcCtpLm1hcmdpblRvcCxsZWZ0OmEtaS5sZWZ0K2kubWFyZ2luTGVmdCx3aWR0aDpyLGhlaWdodDpvfSl9KHMscik7ZWxzZXt2YXIgYT12b2lkIDA7InNjcm9sbFBhcmVudCI9PT1pPyJCT0RZIj09PShhPVN0KEF0KGUpKSkubm9kZU5hbWUmJihhPXQub3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpOmE9IndpbmRvdyI9PT1pP3Qub3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ6aTt2YXIgbD1RdChhLHMscik7aWYoIkhUTUwiIT09YS5ub2RlTmFtZXx8ZnVuY3Rpb24gdChlKXt2YXIgbj1lLm5vZGVOYW1lO3JldHVybiJCT0RZIiE9PW4mJiJIVE1MIiE9PW4mJigiZml4ZWQiPT09RHQoZSwicG9zaXRpb24iKXx8dChBdChlKSkpfShzKSlvPWw7ZWxzZXt2YXIgYz1IdCgpLGY9Yy5oZWlnaHQsaD1jLndpZHRoO28udG9wKz1sLnRvcC1sLm1hcmdpblRvcCxvLmJvdHRvbT1mK2wudG9wLG8ubGVmdCs9bC5sZWZ0LWwubWFyZ2luTGVmdCxvLnJpZ2h0PWgrbC5sZWZ0fX1yZXR1cm4gby5sZWZ0Kz1uLG8udG9wKz1uLG8ucmlnaHQtPW4sby5ib3R0b20tPW4sb31mdW5jdGlvbiBxdCh0LGUsaSxuLHIpe3ZhciBvPTU8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzVdP2FyZ3VtZW50c1s1XTowO2lmKC0xPT09dC5pbmRleE9mKCJhdXRvIikpcmV0dXJuIHQ7dmFyIHM9R3QoaSxuLG8sciksYT17dG9wOnt3aWR0aDpzLndpZHRoLGhlaWdodDplLnRvcC1zLnRvcH0scmlnaHQ6e3dpZHRoOnMucmlnaHQtZS5yaWdodCxoZWlnaHQ6cy5oZWlnaHR9LGJvdHRvbTp7d2lkdGg6cy53aWR0aCxoZWlnaHQ6cy5ib3R0b20tZS5ib3R0b219LGxlZnQ6e3dpZHRoOmUubGVmdC1zLmxlZnQsaGVpZ2h0OnMuaGVpZ2h0fX0sbD1PYmplY3Qua2V5cyhhKS5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIEJ0KHtrZXk6dH0sYVt0XSx7YXJlYTooZT1hW3RdLGUud2lkdGgqZS5oZWlnaHQpfSk7dmFyIGV9KS5zb3J0KGZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuYXJlYS10LmFyZWF9KSxjPWwuZmlsdGVyKGZ1bmN0aW9uKHQpe3ZhciBlPXQud2lkdGgsbj10LmhlaWdodDtyZXR1cm4gZT49aS5jbGllbnRXaWR0aCYmbj49aS5jbGllbnRIZWlnaHR9KSxmPTA8Yy5sZW5ndGg/Y1swXS5rZXk6bFswXS5rZXksaD10LnNwbGl0KCItIilbMV07cmV0dXJuIGYrKGg/Ii0iK2g6IiIpfWZ1bmN0aW9uIHp0KHQsZSxuKXt2YXIgaT0zPGFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PWFyZ3VtZW50c1szXT9hcmd1bWVudHNbM106bnVsbDtyZXR1cm4gUXQobixpP1l0KGUpOnh0KGUsbiksaSl9ZnVuY3Rpb24gWHQodCl7dmFyIGU9Z2V0Q29tcHV0ZWRTdHlsZSh0KSxuPXBhcnNlRmxvYXQoZS5tYXJnaW5Ub3ApK3BhcnNlRmxvYXQoZS5tYXJnaW5Cb3R0b20pLGk9cGFyc2VGbG9hdChlLm1hcmdpbkxlZnQpK3BhcnNlRmxvYXQoZS5tYXJnaW5SaWdodCk7cmV0dXJue3dpZHRoOnQub2Zmc2V0V2lkdGgraSxoZWlnaHQ6dC5vZmZzZXRIZWlnaHQrbn19ZnVuY3Rpb24gSnQodCl7dmFyIGU9e2xlZnQ6InJpZ2h0IixyaWdodDoibGVmdCIsYm90dG9tOiJ0b3AiLHRvcDoiYm90dG9tIn07cmV0dXJuIHQucmVwbGFjZSgvbGVmdHxyaWdodHxib3R0b218dG9wL2csZnVuY3Rpb24odCl7cmV0dXJuIGVbdF19KX1mdW5jdGlvbiBadCh0LGUsbil7bj1uLnNwbGl0KCItIilbMF07dmFyIGk9WHQodCkscj17d2lkdGg6aS53aWR0aCxoZWlnaHQ6aS5oZWlnaHR9LG89LTEhPT1bInJpZ2h0IiwibGVmdCJdLmluZGV4T2Yobikscz1vPyJ0b3AiOiJsZWZ0IixhPW8/ImxlZnQiOiJ0b3AiLGw9bz8iaGVpZ2h0Ijoid2lkdGgiLGM9bz8id2lkdGgiOiJoZWlnaHQiO3JldHVybiByW3NdPWVbc10rZVtsXS8yLWlbbF0vMixyW2FdPW49PT1hP2VbYV0taVtjXTplW0p0KGEpXSxyfWZ1bmN0aW9uICR0KHQsZSl7cmV0dXJuIEFycmF5LnByb3RvdHlwZS5maW5kP3QuZmluZChlKTp0LmZpbHRlcihlKVswXX1mdW5jdGlvbiB0ZSh0LG4sZSl7cmV0dXJuKHZvaWQgMD09PWU/dDp0LnNsaWNlKDAsZnVuY3Rpb24odCxlLG4pe2lmKEFycmF5LnByb3RvdHlwZS5maW5kSW5kZXgpcmV0dXJuIHQuZmluZEluZGV4KGZ1bmN0aW9uKHQpe3JldHVybiB0W2VdPT09bn0pO3ZhciBpPSR0KHQsZnVuY3Rpb24odCl7cmV0dXJuIHRbZV09PT1ufSk7cmV0dXJuIHQuaW5kZXhPZihpKX0odCwibmFtZSIsZSkpKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QuZnVuY3Rpb24mJmNvbnNvbGUud2FybigiYG1vZGlmaWVyLmZ1bmN0aW9uYCBpcyBkZXByZWNhdGVkLCB1c2UgYG1vZGlmaWVyLmZuYCEiKTt2YXIgZT10LmZ1bmN0aW9ufHx0LmZuO3QuZW5hYmxlZCYmSXQoZSkmJihuLm9mZnNldHMucG9wcGVyPUt0KG4ub2Zmc2V0cy5wb3BwZXIpLG4ub2Zmc2V0cy5yZWZlcmVuY2U9S3Qobi5vZmZzZXRzLnJlZmVyZW5jZSksbj1lKG4sdCkpfSksbn1mdW5jdGlvbiBlZSh0LG4pe3JldHVybiB0LnNvbWUoZnVuY3Rpb24odCl7dmFyIGU9dC5uYW1lO3JldHVybiB0LmVuYWJsZWQmJmU9PT1ufSl9ZnVuY3Rpb24gbmUodCl7Zm9yKHZhciBlPVshMSwibXMiLCJXZWJraXQiLCJNb3oiLCJPIl0sbj10LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK3Quc2xpY2UoMSksaT0wO2k8ZS5sZW5ndGg7aSsrKXt2YXIgcj1lW2ldLG89cj8iIityK246dDtpZigidW5kZWZpbmVkIiE9dHlwZW9mIGRvY3VtZW50LmJvZHkuc3R5bGVbb10pcmV0dXJuIG99cmV0dXJuIG51bGx9ZnVuY3Rpb24gaWUodCl7dmFyIGU9dC5vd25lckRvY3VtZW50O3JldHVybiBlP2UuZGVmYXVsdFZpZXc6d2luZG93fWZ1bmN0aW9uIHJlKHQsZSxuLGkpe24udXBkYXRlQm91bmQ9aSxpZSh0KS5hZGRFdmVudExpc3RlbmVyKCJyZXNpemUiLG4udXBkYXRlQm91bmQse3Bhc3NpdmU6ITB9KTt2YXIgcj1TdCh0KTtyZXR1cm4gZnVuY3Rpb24gdChlLG4saSxyKXt2YXIgbz0iQk9EWSI9PT1lLm5vZGVOYW1lLHM9bz9lLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXc6ZTtzLmFkZEV2ZW50TGlzdGVuZXIobixpLHtwYXNzaXZlOiEwfSksb3x8dChTdChzLnBhcmVudE5vZGUpLG4saSxyKSxyLnB1c2gocyl9KHIsInNjcm9sbCIsbi51cGRhdGVCb3VuZCxuLnNjcm9sbFBhcmVudHMpLG4uc2Nyb2xsRWxlbWVudD1yLG4uZXZlbnRzRW5hYmxlZD0hMCxufWZ1bmN0aW9uIG9lKCl7dmFyIHQsZTt0aGlzLnN0YXRlLmV2ZW50c0VuYWJsZWQmJihjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLnNjaGVkdWxlVXBkYXRlKSx0aGlzLnN0YXRlPSh0PXRoaXMucmVmZXJlbmNlLGU9dGhpcy5zdGF0ZSxpZSh0KS5yZW1vdmVFdmVudExpc3RlbmVyKCJyZXNpemUiLGUudXBkYXRlQm91bmQpLGUuc2Nyb2xsUGFyZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QucmVtb3ZlRXZlbnRMaXN0ZW5lcigic2Nyb2xsIixlLnVwZGF0ZUJvdW5kKX0pLGUudXBkYXRlQm91bmQ9bnVsbCxlLnNjcm9sbFBhcmVudHM9W10sZS5zY3JvbGxFbGVtZW50PW51bGwsZS5ldmVudHNFbmFibGVkPSExLGUpKX1mdW5jdGlvbiBzZSh0KXtyZXR1cm4iIiE9PXQmJiFpc05hTihwYXJzZUZsb2F0KHQpKSYmaXNGaW5pdGUodCl9ZnVuY3Rpb24gYWUobixpKXtPYmplY3Qua2V5cyhpKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3ZhciBlPSIiOy0xIT09WyJ3aWR0aCIsImhlaWdodCIsInRvcCIsInJpZ2h0IiwiYm90dG9tIiwibGVmdCJdLmluZGV4T2YodCkmJnNlKGlbdF0pJiYoZT0icHgiKSxuLnN0eWxlW3RdPWlbdF0rZX0pfWZ1bmN0aW9uIGxlKHQsZSxuKXt2YXIgaT0kdCh0LGZ1bmN0aW9uKHQpe3JldHVybiB0Lm5hbWU9PT1lfSkscj0hIWkmJnQuc29tZShmdW5jdGlvbih0KXtyZXR1cm4gdC5uYW1lPT09biYmdC5lbmFibGVkJiZ0Lm9yZGVyPGkub3JkZXJ9KTtpZighcil7dmFyIG89ImAiK2UrImAiLHM9ImAiK24rImAiO2NvbnNvbGUud2FybihzKyIgbW9kaWZpZXIgaXMgcmVxdWlyZWQgYnkgIitvKyIgbW9kaWZpZXIgaW4gb3JkZXIgdG8gd29yaywgYmUgc3VyZSB0byBpbmNsdWRlIGl0IGJlZm9yZSAiK28rIiEiKX1yZXR1cm4gcn12YXIgY2U9WyJhdXRvLXN0YXJ0IiwiYXV0byIsImF1dG8tZW5kIiwidG9wLXN0YXJ0IiwidG9wIiwidG9wLWVuZCIsInJpZ2h0LXN0YXJ0IiwicmlnaHQiLCJyaWdodC1lbmQiLCJib3R0b20tZW5kIiwiYm90dG9tIiwiYm90dG9tLXN0YXJ0IiwibGVmdC1lbmQiLCJsZWZ0IiwibGVmdC1zdGFydCJdLGZlPWNlLnNsaWNlKDMpO2Z1bmN0aW9uIGhlKHQpe3ZhciBlPTE8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzFdJiZhcmd1bWVudHNbMV0sbj1mZS5pbmRleE9mKHQpLGk9ZmUuc2xpY2UobisxKS5jb25jYXQoZmUuc2xpY2UoMCxuKSk7cmV0dXJuIGU/aS5yZXZlcnNlKCk6aX12YXIgdWU9e0ZMSVA6ImZsaXAiLENMT0NLV0lTRToiY2xvY2t3aXNlIixDT1VOVEVSQ0xPQ0tXSVNFOiJjb3VudGVyY2xvY2t3aXNlIn07ZnVuY3Rpb24gZGUodCxyLG8sZSl7dmFyIHM9WzAsMF0sYT0tMSE9PVsicmlnaHQiLCJsZWZ0Il0uaW5kZXhPZihlKSxuPXQuc3BsaXQoLyhcK3xcLSkvKS5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIHQudHJpbSgpfSksaT1uLmluZGV4T2YoJHQobixmdW5jdGlvbih0KXtyZXR1cm4tMSE9PXQuc2VhcmNoKC8sfFxzLyl9KSk7bltpXSYmLTE9PT1uW2ldLmluZGV4T2YoIiwiKSYmY29uc29sZS53YXJuKCJPZmZzZXRzIHNlcGFyYXRlZCBieSB3aGl0ZSBzcGFjZShzKSBhcmUgZGVwcmVjYXRlZCwgdXNlIGEgY29tbWEgKCwpIGluc3RlYWQuIik7dmFyIGw9L1xzKixccyp8XHMrLyxjPS0xIT09aT9bbi5zbGljZSgwLGkpLmNvbmNhdChbbltpXS5zcGxpdChsKVswXV0pLFtuW2ldLnNwbGl0KGwpWzFdXS5jb25jYXQobi5zbGljZShpKzEpKV06W25dO3JldHVybihjPWMubWFwKGZ1bmN0aW9uKHQsZSl7dmFyIG49KDE9PT1lPyFhOmEpPyJoZWlnaHQiOiJ3aWR0aCIsaT0hMTtyZXR1cm4gdC5yZWR1Y2UoZnVuY3Rpb24odCxlKXtyZXR1cm4iIj09PXRbdC5sZW5ndGgtMV0mJi0xIT09WyIrIiwiLSJdLmluZGV4T2YoZSk/KHRbdC5sZW5ndGgtMV09ZSxpPSEwLHQpOmk/KHRbdC5sZW5ndGgtMV0rPWUsaT0hMSx0KTp0LmNvbmNhdChlKX0sW10pLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24odCxlLG4saSl7dmFyIHI9dC5tYXRjaCgvKCg/OlwtfFwrKT9cZCpcLj9cZCopKC4qKS8pLG89K3JbMV0scz1yWzJdO2lmKCFvKXJldHVybiB0O2lmKDA9PT1zLmluZGV4T2YoIiUiKSl7dmFyIGE9dm9pZCAwO3N3aXRjaChzKXtjYXNlIiVwIjphPW47YnJlYWs7Y2FzZSIlIjpjYXNlIiVyIjpkZWZhdWx0OmE9aX1yZXR1cm4gS3QoYSlbZV0vMTAwKm99aWYoInZoIj09PXN8fCJ2dyI9PT1zKXJldHVybigidmgiPT09cz9NYXRoLm1heChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0LHdpbmRvdy5pbm5lckhlaWdodHx8MCk6TWF0aC5tYXgoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoLHdpbmRvdy5pbm5lcldpZHRofHwwKSkvMTAwKm87cmV0dXJuIG99KHQsbixyLG8pfSl9KSkuZm9yRWFjaChmdW5jdGlvbihuLGkpe24uZm9yRWFjaChmdW5jdGlvbih0LGUpe3NlKHQpJiYoc1tpXSs9dCooIi0iPT09bltlLTFdPy0xOjEpKX0pfSksc312YXIgcGU9e3BsYWNlbWVudDoiYm90dG9tIixwb3NpdGlvbkZpeGVkOiExLGV2ZW50c0VuYWJsZWQ6ITAscmVtb3ZlT25EZXN0cm95OiExLG9uQ3JlYXRlOmZ1bmN0aW9uKCl7fSxvblVwZGF0ZTpmdW5jdGlvbigpe30sbW9kaWZpZXJzOntzaGlmdDp7b3JkZXI6MTAwLGVuYWJsZWQ6ITAsZm46ZnVuY3Rpb24odCl7dmFyIGU9dC5wbGFjZW1lbnQsbj1lLnNwbGl0KCItIilbMF0saT1lLnNwbGl0KCItIilbMV07aWYoaSl7dmFyIHI9dC5vZmZzZXRzLG89ci5yZWZlcmVuY2Uscz1yLnBvcHBlcixhPS0xIT09WyJib3R0b20iLCJ0b3AiXS5pbmRleE9mKG4pLGw9YT8ibGVmdCI6InRvcCIsYz1hPyJ3aWR0aCI6ImhlaWdodCIsZj17c3RhcnQ6VXQoe30sbCxvW2xdKSxlbmQ6VXQoe30sbCxvW2xdK29bY10tc1tjXSl9O3Qub2Zmc2V0cy5wb3BwZXI9QnQoe30scyxmW2ldKX1yZXR1cm4gdH19LG9mZnNldDp7b3JkZXI6MjAwLGVuYWJsZWQ6ITAsZm46ZnVuY3Rpb24odCxlKXt2YXIgbj1lLm9mZnNldCxpPXQucGxhY2VtZW50LHI9dC5vZmZzZXRzLG89ci5wb3BwZXIscz1yLnJlZmVyZW5jZSxhPWkuc3BsaXQoIi0iKVswXSxsPXZvaWQgMDtyZXR1cm4gbD1zZSgrbik/WytuLDBdOmRlKG4sbyxzLGEpLCJsZWZ0Ij09PWE/KG8udG9wKz1sWzBdLG8ubGVmdC09bFsxXSk6InJpZ2h0Ij09PWE/KG8udG9wKz1sWzBdLG8ubGVmdCs9bFsxXSk6InRvcCI9PT1hPyhvLmxlZnQrPWxbMF0sby50b3AtPWxbMV0pOiJib3R0b20iPT09YSYmKG8ubGVmdCs9bFswXSxvLnRvcCs9bFsxXSksdC5wb3BwZXI9byx0fSxvZmZzZXQ6MH0scHJldmVudE92ZXJmbG93OntvcmRlcjozMDAsZW5hYmxlZDohMCxmbjpmdW5jdGlvbih0LGkpe3ZhciBlPWkuYm91bmRhcmllc0VsZW1lbnR8fEx0KHQuaW5zdGFuY2UucG9wcGVyKTt0Lmluc3RhbmNlLnJlZmVyZW5jZT09PWUmJihlPUx0KGUpKTt2YXIgbj1uZSgidHJhbnNmb3JtIikscj10Lmluc3RhbmNlLnBvcHBlci5zdHlsZSxvPXIudG9wLHM9ci5sZWZ0LGE9cltuXTtyLnRvcD0iIixyLmxlZnQ9IiIscltuXT0iIjt2YXIgbD1HdCh0Lmluc3RhbmNlLnBvcHBlcix0Lmluc3RhbmNlLnJlZmVyZW5jZSxpLnBhZGRpbmcsZSx0LnBvc2l0aW9uRml4ZWQpO3IudG9wPW8sci5sZWZ0PXMscltuXT1hLGkuYm91bmRhcmllcz1sO3ZhciBjPWkucHJpb3JpdHksZj10Lm9mZnNldHMucG9wcGVyLGg9e3ByaW1hcnk6ZnVuY3Rpb24odCl7dmFyIGU9Zlt0XTtyZXR1cm4gZlt0XTxsW3RdJiYhaS5lc2NhcGVXaXRoUmVmZXJlbmNlJiYoZT1NYXRoLm1heChmW3RdLGxbdF0pKSxVdCh7fSx0LGUpfSxzZWNvbmRhcnk6ZnVuY3Rpb24odCl7dmFyIGU9InJpZ2h0Ij09PXQ/ImxlZnQiOiJ0b3AiLG49ZltlXTtyZXR1cm4gZlt0XT5sW3RdJiYhaS5lc2NhcGVXaXRoUmVmZXJlbmNlJiYobj1NYXRoLm1pbihmW2VdLGxbdF0tKCJyaWdodCI9PT10P2Yud2lkdGg6Zi5oZWlnaHQpKSksVXQoe30sZSxuKX19O3JldHVybiBjLmZvckVhY2goZnVuY3Rpb24odCl7dmFyIGU9LTEhPT1bImxlZnQiLCJ0b3AiXS5pbmRleE9mKHQpPyJwcmltYXJ5Ijoic2Vjb25kYXJ5IjtmPUJ0KHt9LGYsaFtlXSh0KSl9KSx0Lm9mZnNldHMucG9wcGVyPWYsdH0scHJpb3JpdHk6WyJsZWZ0IiwicmlnaHQiLCJ0b3AiLCJib3R0b20iXSxwYWRkaW5nOjUsYm91bmRhcmllc0VsZW1lbnQ6InNjcm9sbFBhcmVudCJ9LGtlZXBUb2dldGhlcjp7b3JkZXI6NDAwLGVuYWJsZWQ6ITAsZm46ZnVuY3Rpb24odCl7dmFyIGU9dC5vZmZzZXRzLG49ZS5wb3BwZXIsaT1lLnJlZmVyZW5jZSxyPXQucGxhY2VtZW50LnNwbGl0KCItIilbMF0sbz1NYXRoLmZsb29yLHM9LTEhPT1bInRvcCIsImJvdHRvbSJdLmluZGV4T2YociksYT1zPyJyaWdodCI6ImJvdHRvbSIsbD1zPyJsZWZ0IjoidG9wIixjPXM/IndpZHRoIjoiaGVpZ2h0IjtyZXR1cm4gblthXTxvKGlbbF0pJiYodC5vZmZzZXRzLnBvcHBlcltsXT1vKGlbbF0pLW5bY10pLG5bbF0+byhpW2FdKSYmKHQub2Zmc2V0cy5wb3BwZXJbbF09byhpW2FdKSksdH19LGFycm93OntvcmRlcjo1MDAsZW5hYmxlZDohMCxmbjpmdW5jdGlvbih0LGUpe3ZhciBuO2lmKCFsZSh0Lmluc3RhbmNlLm1vZGlmaWVycywiYXJyb3ciLCJrZWVwVG9nZXRoZXIiKSlyZXR1cm4gdDt2YXIgaT1lLmVsZW1lbnQ7aWYoInN0cmluZyI9PXR5cGVvZiBpKXtpZighKGk9dC5pbnN0YW5jZS5wb3BwZXIucXVlcnlTZWxlY3RvcihpKSkpcmV0dXJuIHR9ZWxzZSBpZighdC5pbnN0YW5jZS5wb3BwZXIuY29udGFpbnMoaSkpcmV0dXJuIGNvbnNvbGUud2FybigiV0FSTklORzogYGFycm93LmVsZW1lbnRgIG11c3QgYmUgY2hpbGQgb2YgaXRzIHBvcHBlciBlbGVtZW50ISIpLHQ7dmFyIHI9dC5wbGFjZW1lbnQuc3BsaXQoIi0iKVswXSxvPXQub2Zmc2V0cyxzPW8ucG9wcGVyLGE9by5yZWZlcmVuY2UsbD0tMSE9PVsibGVmdCIsInJpZ2h0Il0uaW5kZXhPZihyKSxjPWw/ImhlaWdodCI6IndpZHRoIixmPWw/IlRvcCI6IkxlZnQiLGg9Zi50b0xvd2VyQ2FzZSgpLHU9bD8ibGVmdCI6InRvcCIsZD1sPyJib3R0b20iOiJyaWdodCIscD1YdChpKVtjXTthW2RdLXA8c1toXSYmKHQub2Zmc2V0cy5wb3BwZXJbaF0tPXNbaF0tKGFbZF0tcCkpLGFbaF0rcD5zW2RdJiYodC5vZmZzZXRzLnBvcHBlcltoXSs9YVtoXStwLXNbZF0pLHQub2Zmc2V0cy5wb3BwZXI9S3QodC5vZmZzZXRzLnBvcHBlcik7dmFyIGc9YVtoXSthW2NdLzItcC8yLG09RHQodC5pbnN0YW5jZS5wb3BwZXIpLF89cGFyc2VGbG9hdChtWyJtYXJnaW4iK2ZdLDEwKSx2PXBhcnNlRmxvYXQobVsiYm9yZGVyIitmKyJXaWR0aCJdLDEwKSxFPWctdC5vZmZzZXRzLnBvcHBlcltoXS1fLXY7cmV0dXJuIEU9TWF0aC5tYXgoTWF0aC5taW4oc1tjXS1wLEUpLDApLHQuYXJyb3dFbGVtZW50PWksdC5vZmZzZXRzLmFycm93PShVdChuPXt9LGgsTWF0aC5yb3VuZChFKSksVXQobix1LCIiKSxuKSx0fSxlbGVtZW50OiJbeC1hcnJvd10ifSxmbGlwOntvcmRlcjo2MDAsZW5hYmxlZDohMCxmbjpmdW5jdGlvbihwLGcpe2lmKGVlKHAuaW5zdGFuY2UubW9kaWZpZXJzLCJpbm5lciIpKXJldHVybiBwO2lmKHAuZmxpcHBlZCYmcC5wbGFjZW1lbnQ9PT1wLm9yaWdpbmFsUGxhY2VtZW50KXJldHVybiBwO3ZhciBtPUd0KHAuaW5zdGFuY2UucG9wcGVyLHAuaW5zdGFuY2UucmVmZXJlbmNlLGcucGFkZGluZyxnLmJvdW5kYXJpZXNFbGVtZW50LHAucG9zaXRpb25GaXhlZCksXz1wLnBsYWNlbWVudC5zcGxpdCgiLSIpWzBdLHY9SnQoXyksRT1wLnBsYWNlbWVudC5zcGxpdCgiLSIpWzFdfHwiIix5PVtdO3N3aXRjaChnLmJlaGF2aW9yKXtjYXNlIHVlLkZMSVA6eT1bXyx2XTticmVhaztjYXNlIHVlLkNMT0NLV0lTRTp5PWhlKF8pO2JyZWFrO2Nhc2UgdWUuQ09VTlRFUkNMT0NLV0lTRTp5PWhlKF8sITApO2JyZWFrO2RlZmF1bHQ6eT1nLmJlaGF2aW9yfXJldHVybiB5LmZvckVhY2goZnVuY3Rpb24odCxlKXtpZihfIT09dHx8eS5sZW5ndGg9PT1lKzEpcmV0dXJuIHA7Xz1wLnBsYWNlbWVudC5zcGxpdCgiLSIpWzBdLHY9SnQoXyk7dmFyIG4saT1wLm9mZnNldHMucG9wcGVyLHI9cC5vZmZzZXRzLnJlZmVyZW5jZSxvPU1hdGguZmxvb3Iscz0ibGVmdCI9PT1fJiZvKGkucmlnaHQpPm8oci5sZWZ0KXx8InJpZ2h0Ij09PV8mJm8oaS5sZWZ0KTxvKHIucmlnaHQpfHwidG9wIj09PV8mJm8oaS5ib3R0b20pPm8oci50b3ApfHwiYm90dG9tIj09PV8mJm8oaS50b3ApPG8oci5ib3R0b20pLGE9byhpLmxlZnQpPG8obS5sZWZ0KSxsPW8oaS5yaWdodCk+byhtLnJpZ2h0KSxjPW8oaS50b3ApPG8obS50b3ApLGY9byhpLmJvdHRvbSk+byhtLmJvdHRvbSksaD0ibGVmdCI9PT1fJiZhfHwicmlnaHQiPT09XyYmbHx8InRvcCI9PT1fJiZjfHwiYm90dG9tIj09PV8mJmYsdT0tMSE9PVsidG9wIiwiYm90dG9tIl0uaW5kZXhPZihfKSxkPSEhZy5mbGlwVmFyaWF0aW9ucyYmKHUmJiJzdGFydCI9PT1FJiZhfHx1JiYiZW5kIj09PUUmJmx8fCF1JiYic3RhcnQiPT09RSYmY3x8IXUmJiJlbmQiPT09RSYmZik7KHN8fGh8fGQpJiYocC5mbGlwcGVkPSEwLChzfHxoKSYmKF89eVtlKzFdKSxkJiYoRT0iZW5kIj09PShuPUUpPyJzdGFydCI6InN0YXJ0Ij09PW4/ImVuZCI6bikscC5wbGFjZW1lbnQ9XysoRT8iLSIrRToiIikscC5vZmZzZXRzLnBvcHBlcj1CdCh7fSxwLm9mZnNldHMucG9wcGVyLFp0KHAuaW5zdGFuY2UucG9wcGVyLHAub2Zmc2V0cy5yZWZlcmVuY2UscC5wbGFjZW1lbnQpKSxwPXRlKHAuaW5zdGFuY2UubW9kaWZpZXJzLHAsImZsaXAiKSl9KSxwfSxiZWhhdmlvcjoiZmxpcCIscGFkZGluZzo1LGJvdW5kYXJpZXNFbGVtZW50OiJ2aWV3cG9ydCJ9LGlubmVyOntvcmRlcjo3MDAsZW5hYmxlZDohMSxmbjpmdW5jdGlvbih0KXt2YXIgZT10LnBsYWNlbWVudCxuPWUuc3BsaXQoIi0iKVswXSxpPXQub2Zmc2V0cyxyPWkucG9wcGVyLG89aS5yZWZlcmVuY2Uscz0tMSE9PVsibGVmdCIsInJpZ2h0Il0uaW5kZXhPZihuKSxhPS0xPT09WyJ0b3AiLCJsZWZ0Il0uaW5kZXhPZihuKTtyZXR1cm4gcltzPyJsZWZ0IjoidG9wIl09b1tuXS0oYT9yW3M/IndpZHRoIjoiaGVpZ2h0Il06MCksdC5wbGFjZW1lbnQ9SnQoZSksdC5vZmZzZXRzLnBvcHBlcj1LdChyKSx0fX0saGlkZTp7b3JkZXI6ODAwLGVuYWJsZWQ6ITAsZm46ZnVuY3Rpb24odCl7aWYoIWxlKHQuaW5zdGFuY2UubW9kaWZpZXJzLCJoaWRlIiwicHJldmVudE92ZXJmbG93IikpcmV0dXJuIHQ7dmFyIGU9dC5vZmZzZXRzLnJlZmVyZW5jZSxuPSR0KHQuaW5zdGFuY2UubW9kaWZpZXJzLGZ1bmN0aW9uKHQpe3JldHVybiJwcmV2ZW50T3ZlcmZsb3ciPT09dC5uYW1lfSkuYm91bmRhcmllcztpZihlLmJvdHRvbTxuLnRvcHx8ZS5sZWZ0Pm4ucmlnaHR8fGUudG9wPm4uYm90dG9tfHxlLnJpZ2h0PG4ubGVmdCl7aWYoITA9PT10LmhpZGUpcmV0dXJuIHQ7dC5oaWRlPSEwLHQuYXR0cmlidXRlc1sieC1vdXQtb2YtYm91bmRhcmllcyJdPSIifWVsc2V7aWYoITE9PT10LmhpZGUpcmV0dXJuIHQ7dC5oaWRlPSExLHQuYXR0cmlidXRlc1sieC1vdXQtb2YtYm91bmRhcmllcyJdPSExfXJldHVybiB0fX0sY29tcHV0ZVN0eWxlOntvcmRlcjo4NTAsZW5hYmxlZDohMCxmbjpmdW5jdGlvbih0LGUpe3ZhciBuPWUueCxpPWUueSxyPXQub2Zmc2V0cy5wb3BwZXIsbz0kdCh0Lmluc3RhbmNlLm1vZGlmaWVycyxmdW5jdGlvbih0KXtyZXR1cm4iYXBwbHlTdHlsZSI9PT10Lm5hbWV9KS5ncHVBY2NlbGVyYXRpb247dm9pZCAwIT09byYmY29uc29sZS53YXJuKCJXQVJOSU5HOiBgZ3B1QWNjZWxlcmF0aW9uYCBvcHRpb24gbW92ZWQgdG8gYGNvbXB1dGVTdHlsZWAgbW9kaWZpZXIgYW5kIHdpbGwgbm90IGJlIHN1cHBvcnRlZCBpbiBmdXR1cmUgdmVyc2lvbnMgb2YgUG9wcGVyLmpzISIpO3ZhciBzPXZvaWQgMCE9PW8/bzplLmdwdUFjY2VsZXJhdGlvbixhPVZ0KEx0KHQuaW5zdGFuY2UucG9wcGVyKSksbD17cG9zaXRpb246ci5wb3NpdGlvbn0sYz17bGVmdDpNYXRoLmZsb29yKHIubGVmdCksdG9wOk1hdGgucm91bmQoci50b3ApLGJvdHRvbTpNYXRoLnJvdW5kKHIuYm90dG9tKSxyaWdodDpNYXRoLmZsb29yKHIucmlnaHQpfSxmPSJib3R0b20iPT09bj8idG9wIjoiYm90dG9tIixoPSJyaWdodCI9PT1pPyJsZWZ0IjoicmlnaHQiLHU9bmUoInRyYW5zZm9ybSIpLGQ9dm9pZCAwLHA9dm9pZCAwO2lmKHA9ImJvdHRvbSI9PT1mPy1hLmhlaWdodCtjLmJvdHRvbTpjLnRvcCxkPSJyaWdodCI9PT1oPy1hLndpZHRoK2MucmlnaHQ6Yy5sZWZ0LHMmJnUpbFt1XT0idHJhbnNsYXRlM2QoIitkKyJweCwgIitwKyJweCwgMCkiLGxbZl09MCxsW2hdPTAsbC53aWxsQ2hhbmdlPSJ0cmFuc2Zvcm0iO2Vsc2V7dmFyIGc9ImJvdHRvbSI9PT1mPy0xOjEsbT0icmlnaHQiPT09aD8tMToxO2xbZl09cCpnLGxbaF09ZCptLGwud2lsbENoYW5nZT1mKyIsICIraH12YXIgXz17IngtcGxhY2VtZW50Ijp0LnBsYWNlbWVudH07cmV0dXJuIHQuYXR0cmlidXRlcz1CdCh7fSxfLHQuYXR0cmlidXRlcyksdC5zdHlsZXM9QnQoe30sbCx0LnN0eWxlcyksdC5hcnJvd1N0eWxlcz1CdCh7fSx0Lm9mZnNldHMuYXJyb3csdC5hcnJvd1N0eWxlcyksdH0sZ3B1QWNjZWxlcmF0aW9uOiEwLHg6ImJvdHRvbSIseToicmlnaHQifSxhcHBseVN0eWxlOntvcmRlcjo5MDAsZW5hYmxlZDohMCxmbjpmdW5jdGlvbih0KXt2YXIgZSxuO3JldHVybiBhZSh0Lmluc3RhbmNlLnBvcHBlcix0LnN0eWxlcyksZT10Lmluc3RhbmNlLnBvcHBlcixuPXQuYXR0cmlidXRlcyxPYmplY3Qua2V5cyhuKS5mb3JFYWNoKGZ1bmN0aW9uKHQpeyExIT09blt0XT9lLnNldEF0dHJpYnV0ZSh0LG5bdF0pOmUucmVtb3ZlQXR0cmlidXRlKHQpfSksdC5hcnJvd0VsZW1lbnQmJk9iamVjdC5rZXlzKHQuYXJyb3dTdHlsZXMpLmxlbmd0aCYmYWUodC5hcnJvd0VsZW1lbnQsdC5hcnJvd1N0eWxlcyksdH0sb25Mb2FkOmZ1bmN0aW9uKHQsZSxuLGkscil7dmFyIG89enQocixlLHQsbi5wb3NpdGlvbkZpeGVkKSxzPXF0KG4ucGxhY2VtZW50LG8sZSx0LG4ubW9kaWZpZXJzLmZsaXAuYm91bmRhcmllc0VsZW1lbnQsbi5tb2RpZmllcnMuZmxpcC5wYWRkaW5nKTtyZXR1cm4gZS5zZXRBdHRyaWJ1dGUoIngtcGxhY2VtZW50IixzKSxhZShlLHtwb3NpdGlvbjpuLnBvc2l0aW9uRml4ZWQ/ImZpeGVkIjoiYWJzb2x1dGUifSksbn0sZ3B1QWNjZWxlcmF0aW9uOnZvaWQgMH19fSxnZT1mdW5jdGlvbigpe2Z1bmN0aW9uIG8odCxlKXt2YXIgbj10aGlzLGk9Mjxhcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbMl0/YXJndW1lbnRzWzJdOnt9O1d0KHRoaXMsbyksdGhpcy5zY2hlZHVsZVVwZGF0ZT1mdW5jdGlvbigpe3JldHVybiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUobi51cGRhdGUpfSx0aGlzLnVwZGF0ZT13dCh0aGlzLnVwZGF0ZS5iaW5kKHRoaXMpKSx0aGlzLm9wdGlvbnM9QnQoe30sby5EZWZhdWx0cyxpKSx0aGlzLnN0YXRlPXtpc0Rlc3Ryb3llZDohMSxpc0NyZWF0ZWQ6ITEsc2Nyb2xsUGFyZW50czpbXX0sdGhpcy5yZWZlcmVuY2U9dCYmdC5qcXVlcnk/dFswXTp0LHRoaXMucG9wcGVyPWUmJmUuanF1ZXJ5P2VbMF06ZSx0aGlzLm9wdGlvbnMubW9kaWZpZXJzPXt9LE9iamVjdC5rZXlzKEJ0KHt9LG8uRGVmYXVsdHMubW9kaWZpZXJzLGkubW9kaWZpZXJzKSkuZm9yRWFjaChmdW5jdGlvbih0KXtuLm9wdGlvbnMubW9kaWZpZXJzW3RdPUJ0KHt9LG8uRGVmYXVsdHMubW9kaWZpZXJzW3RdfHx7fSxpLm1vZGlmaWVycz9pLm1vZGlmaWVyc1t0XTp7fSl9KSx0aGlzLm1vZGlmaWVycz1PYmplY3Qua2V5cyh0aGlzLm9wdGlvbnMubW9kaWZpZXJzKS5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIEJ0KHtuYW1lOnR9LG4ub3B0aW9ucy5tb2RpZmllcnNbdF0pfSkuc29ydChmdW5jdGlvbih0LGUpe3JldHVybiB0Lm9yZGVyLWUub3JkZXJ9KSx0aGlzLm1vZGlmaWVycy5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QuZW5hYmxlZCYmSXQodC5vbkxvYWQpJiZ0Lm9uTG9hZChuLnJlZmVyZW5jZSxuLnBvcHBlcixuLm9wdGlvbnMsdCxuLnN0YXRlKX0pLHRoaXMudXBkYXRlKCk7dmFyIHI9dGhpcy5vcHRpb25zLmV2ZW50c0VuYWJsZWQ7ciYmdGhpcy5lbmFibGVFdmVudExpc3RlbmVycygpLHRoaXMuc3RhdGUuZXZlbnRzRW5hYmxlZD1yfXJldHVybiBGdChvLFt7a2V5OiJ1cGRhdGUiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKCl7aWYoIXRoaXMuc3RhdGUuaXNEZXN0cm95ZWQpe3ZhciB0PXtpbnN0YW5jZTp0aGlzLHN0eWxlczp7fSxhcnJvd1N0eWxlczp7fSxhdHRyaWJ1dGVzOnt9LGZsaXBwZWQ6ITEsb2Zmc2V0czp7fX07dC5vZmZzZXRzLnJlZmVyZW5jZT16dCh0aGlzLnN0YXRlLHRoaXMucG9wcGVyLHRoaXMucmVmZXJlbmNlLHRoaXMub3B0aW9ucy5wb3NpdGlvbkZpeGVkKSx0LnBsYWNlbWVudD1xdCh0aGlzLm9wdGlvbnMucGxhY2VtZW50LHQub2Zmc2V0cy5yZWZlcmVuY2UsdGhpcy5wb3BwZXIsdGhpcy5yZWZlcmVuY2UsdGhpcy5vcHRpb25zLm1vZGlmaWVycy5mbGlwLmJvdW5kYXJpZXNFbGVtZW50LHRoaXMub3B0aW9ucy5tb2RpZmllcnMuZmxpcC5wYWRkaW5nKSx0Lm9yaWdpbmFsUGxhY2VtZW50PXQucGxhY2VtZW50LHQucG9zaXRpb25GaXhlZD10aGlzLm9wdGlvbnMucG9zaXRpb25GaXhlZCx0Lm9mZnNldHMucG9wcGVyPVp0KHRoaXMucG9wcGVyLHQub2Zmc2V0cy5yZWZlcmVuY2UsdC5wbGFjZW1lbnQpLHQub2Zmc2V0cy5wb3BwZXIucG9zaXRpb249dGhpcy5vcHRpb25zLnBvc2l0aW9uRml4ZWQ/ImZpeGVkIjoiYWJzb2x1dGUiLHQ9dGUodGhpcy5tb2RpZmllcnMsdCksdGhpcy5zdGF0ZS5pc0NyZWF0ZWQ/dGhpcy5vcHRpb25zLm9uVXBkYXRlKHQpOih0aGlzLnN0YXRlLmlzQ3JlYXRlZD0hMCx0aGlzLm9wdGlvbnMub25DcmVhdGUodCkpfX0uY2FsbCh0aGlzKX19LHtrZXk6ImRlc3Ryb3kiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RhdGUuaXNEZXN0cm95ZWQ9ITAsZWUodGhpcy5tb2RpZmllcnMsImFwcGx5U3R5bGUiKSYmKHRoaXMucG9wcGVyLnJlbW92ZUF0dHJpYnV0ZSgieC1wbGFjZW1lbnQiKSx0aGlzLnBvcHBlci5zdHlsZS5wb3NpdGlvbj0iIix0aGlzLnBvcHBlci5zdHlsZS50b3A9IiIsdGhpcy5wb3BwZXIuc3R5bGUubGVmdD0iIix0aGlzLnBvcHBlci5zdHlsZS5yaWdodD0iIix0aGlzLnBvcHBlci5zdHlsZS5ib3R0b209IiIsdGhpcy5wb3BwZXIuc3R5bGUud2lsbENoYW5nZT0iIix0aGlzLnBvcHBlci5zdHlsZVtuZSgidHJhbnNmb3JtIildPSIiKSx0aGlzLmRpc2FibGVFdmVudExpc3RlbmVycygpLHRoaXMub3B0aW9ucy5yZW1vdmVPbkRlc3Ryb3kmJnRoaXMucG9wcGVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5wb3BwZXIpLHRoaXN9LmNhbGwodGhpcyl9fSx7a2V5OiJlbmFibGVFdmVudExpc3RlbmVycyIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oKXt0aGlzLnN0YXRlLmV2ZW50c0VuYWJsZWR8fCh0aGlzLnN0YXRlPXJlKHRoaXMucmVmZXJlbmNlLHRoaXMub3B0aW9ucyx0aGlzLnN0YXRlLHRoaXMuc2NoZWR1bGVVcGRhdGUpKX0uY2FsbCh0aGlzKX19LHtrZXk6ImRpc2FibGVFdmVudExpc3RlbmVycyIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gb2UuY2FsbCh0aGlzKX19XSksb30oKTtnZS5VdGlscz0oInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3c/d2luZG93Omdsb2JhbCkuUG9wcGVyVXRpbHMsZ2UucGxhY2VtZW50cz1jZSxnZS5EZWZhdWx0cz1wZTt2YXIgbWUsX2UsdmUsRWUseWUsYmUsVGUsQ2Usd2UsSWUsRGUsQWUsU2UsT2UsTmUsa2UsTGUsUGUseGUsamUsTWUsUmUsSGUsV2UsRmUsVWUsQmUsS2UsVmUsUWUsWWUsR2UscWUsemUsWGUsSmUsWmUsJGUsdG4sZW4sbm4scm4sb24sc24sYW4sbG4sY24sZm4saG4sdW4sZG4scG4sZ24sbW4sX24sdm4sRW4seW4sYm4sVG4sQ24sd24sSW4sRG4sQW4sU24sT24sTm4sa24sTG4sUG4seG4sam4sTW4sUm4sSG4sV24sRm4sVW4sQm4sS24sVm4sUW4sWW4sR24scW4sem4sWG4sSm4sWm4sJG4sdGksZWksbmksaWkscmksb2ksc2ksYWksbGksY2ksZmksaGksdWksZGkscGksZ2ksbWksX2ksdmksRWkseWksYmksVGk9KF9lPSJkcm9wZG93biIsRWU9Ii4iKyh2ZT0iYnMuZHJvcGRvd24iKSx5ZT0iLmRhdGEtYXBpIixiZT0obWU9ZSkuZm5bX2VdLFRlPW5ldyBSZWdFeHAoIjM4fDQwfDI3IiksQ2U9e0hJREU6ImhpZGUiK0VlLEhJRERFTjoiaGlkZGVuIitFZSxTSE9XOiJzaG93IitFZSxTSE9XTjoic2hvd24iK0VlLENMSUNLOiJjbGljayIrRWUsQ0xJQ0tfREFUQV9BUEk6ImNsaWNrIitFZSt5ZSxLRVlET1dOX0RBVEFfQVBJOiJrZXlkb3duIitFZSt5ZSxLRVlVUF9EQVRBX0FQSToia2V5dXAiK0VlK3llfSx3ZT0iZGlzYWJsZWQiLEllPSJzaG93IixEZT0iZHJvcHVwIixBZT0iZHJvcHJpZ2h0IixTZT0iZHJvcGxlZnQiLE9lPSJkcm9wZG93bi1tZW51LXJpZ2h0IixOZT0icG9zaXRpb24tc3RhdGljIixrZT0nW2RhdGEtdG9nZ2xlPSJkcm9wZG93biJdJyxMZT0iLmRyb3Bkb3duIGZvcm0iLFBlPSIuZHJvcGRvd24tbWVudSIseGU9Ii5uYXZiYXItbmF2IixqZT0iLmRyb3Bkb3duLW1lbnUgLmRyb3Bkb3duLWl0ZW06bm90KC5kaXNhYmxlZCk6bm90KDpkaXNhYmxlZCkiLE1lPSJ0b3Atc3RhcnQiLFJlPSJ0b3AtZW5kIixIZT0iYm90dG9tLXN0YXJ0IixXZT0iYm90dG9tLWVuZCIsRmU9InJpZ2h0LXN0YXJ0IixVZT0ibGVmdC1zdGFydCIsQmU9e29mZnNldDowLGZsaXA6ITAsYm91bmRhcnk6InNjcm9sbFBhcmVudCIscmVmZXJlbmNlOiJ0b2dnbGUiLGRpc3BsYXk6ImR5bmFtaWMifSxLZT17b2Zmc2V0OiIobnVtYmVyfHN0cmluZ3xmdW5jdGlvbikiLGZsaXA6ImJvb2xlYW4iLGJvdW5kYXJ5OiIoc3RyaW5nfGVsZW1lbnQpIixyZWZlcmVuY2U6IihzdHJpbmd8ZWxlbWVudCkiLGRpc3BsYXk6InN0cmluZyJ9LFZlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gbCh0LGUpe3RoaXMuX2VsZW1lbnQ9dCx0aGlzLl9wb3BwZXI9bnVsbCx0aGlzLl9jb25maWc9dGhpcy5fZ2V0Q29uZmlnKGUpLHRoaXMuX21lbnU9dGhpcy5fZ2V0TWVudUVsZW1lbnQoKSx0aGlzLl9pbk5hdmJhcj10aGlzLl9kZXRlY3ROYXZiYXIoKSx0aGlzLl9hZGRFdmVudExpc3RlbmVycygpfXZhciB0PWwucHJvdG90eXBlO3JldHVybiB0LnRvZ2dsZT1mdW5jdGlvbigpe2lmKCF0aGlzLl9lbGVtZW50LmRpc2FibGVkJiYhbWUodGhpcy5fZWxlbWVudCkuaGFzQ2xhc3Mod2UpKXt2YXIgdD1sLl9nZXRQYXJlbnRGcm9tRWxlbWVudCh0aGlzLl9lbGVtZW50KSxlPW1lKHRoaXMuX21lbnUpLmhhc0NsYXNzKEllKTtpZihsLl9jbGVhck1lbnVzKCksIWUpe3ZhciBuPXtyZWxhdGVkVGFyZ2V0OnRoaXMuX2VsZW1lbnR9LGk9bWUuRXZlbnQoQ2UuU0hPVyxuKTtpZihtZSh0KS50cmlnZ2VyKGkpLCFpLmlzRGVmYXVsdFByZXZlbnRlZCgpKXtpZighdGhpcy5faW5OYXZiYXIpe2lmKCJ1bmRlZmluZWQiPT10eXBlb2YgZ2UpdGhyb3cgbmV3IFR5cGVFcnJvcigiQm9vdHN0cmFwIGRyb3Bkb3duIHJlcXVpcmUgUG9wcGVyLmpzIChodHRwczovL3BvcHBlci5qcy5vcmcpIik7dmFyIHI9dGhpcy5fZWxlbWVudDsicGFyZW50Ij09PXRoaXMuX2NvbmZpZy5yZWZlcmVuY2U/cj10Omd0LmlzRWxlbWVudCh0aGlzLl9jb25maWcucmVmZXJlbmNlKSYmKHI9dGhpcy5fY29uZmlnLnJlZmVyZW5jZSwidW5kZWZpbmVkIiE9dHlwZW9mIHRoaXMuX2NvbmZpZy5yZWZlcmVuY2UuanF1ZXJ5JiYocj10aGlzLl9jb25maWcucmVmZXJlbmNlWzBdKSksInNjcm9sbFBhcmVudCIhPT10aGlzLl9jb25maWcuYm91bmRhcnkmJm1lKHQpLmFkZENsYXNzKE5lKSx0aGlzLl9wb3BwZXI9bmV3IGdlKHIsdGhpcy5fbWVudSx0aGlzLl9nZXRQb3BwZXJDb25maWcoKSl9Im9udG91Y2hzdGFydCJpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQmJjA9PT1tZSh0KS5jbG9zZXN0KHhlKS5sZW5ndGgmJm1lKGRvY3VtZW50LmJvZHkpLmNoaWxkcmVuKCkub24oIm1vdXNlb3ZlciIsbnVsbCxtZS5ub29wKSx0aGlzLl9lbGVtZW50LmZvY3VzKCksdGhpcy5fZWxlbWVudC5zZXRBdHRyaWJ1dGUoImFyaWEtZXhwYW5kZWQiLCEwKSxtZSh0aGlzLl9tZW51KS50b2dnbGVDbGFzcyhJZSksbWUodCkudG9nZ2xlQ2xhc3MoSWUpLnRyaWdnZXIobWUuRXZlbnQoQ2UuU0hPV04sbikpfX19fSx0LmRpc3Bvc2U9ZnVuY3Rpb24oKXttZS5yZW1vdmVEYXRhKHRoaXMuX2VsZW1lbnQsdmUpLG1lKHRoaXMuX2VsZW1lbnQpLm9mZihFZSksdGhpcy5fZWxlbWVudD1udWxsLCh0aGlzLl9tZW51PW51bGwpIT09dGhpcy5fcG9wcGVyJiYodGhpcy5fcG9wcGVyLmRlc3Ryb3koKSx0aGlzLl9wb3BwZXI9bnVsbCl9LHQudXBkYXRlPWZ1bmN0aW9uKCl7dGhpcy5faW5OYXZiYXI9dGhpcy5fZGV0ZWN0TmF2YmFyKCksbnVsbCE9PXRoaXMuX3BvcHBlciYmdGhpcy5fcG9wcGVyLnNjaGVkdWxlVXBkYXRlKCl9LHQuX2FkZEV2ZW50TGlzdGVuZXJzPWZ1bmN0aW9uKCl7dmFyIGU9dGhpczttZSh0aGlzLl9lbGVtZW50KS5vbihDZS5DTElDSyxmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdC5zdG9wUHJvcGFnYXRpb24oKSxlLnRvZ2dsZSgpfSl9LHQuX2dldENvbmZpZz1mdW5jdGlvbih0KXtyZXR1cm4gdD1jKHt9LHRoaXMuY29uc3RydWN0b3IuRGVmYXVsdCxtZSh0aGlzLl9lbGVtZW50KS5kYXRhKCksdCksZ3QudHlwZUNoZWNrQ29uZmlnKF9lLHQsdGhpcy5jb25zdHJ1Y3Rvci5EZWZhdWx0VHlwZSksdH0sdC5fZ2V0TWVudUVsZW1lbnQ9ZnVuY3Rpb24oKXtpZighdGhpcy5fbWVudSl7dmFyIHQ9bC5fZ2V0UGFyZW50RnJvbUVsZW1lbnQodGhpcy5fZWxlbWVudCk7dGhpcy5fbWVudT1tZSh0KS5maW5kKFBlKVswXX1yZXR1cm4gdGhpcy5fbWVudX0sdC5fZ2V0UGxhY2VtZW50PWZ1bmN0aW9uKCl7dmFyIHQ9bWUodGhpcy5fZWxlbWVudCkucGFyZW50KCksZT1IZTtyZXR1cm4gdC5oYXNDbGFzcyhEZSk/KGU9TWUsbWUodGhpcy5fbWVudSkuaGFzQ2xhc3MoT2UpJiYoZT1SZSkpOnQuaGFzQ2xhc3MoQWUpP2U9RmU6dC5oYXNDbGFzcyhTZSk/ZT1VZTptZSh0aGlzLl9tZW51KS5oYXNDbGFzcyhPZSkmJihlPVdlKSxlfSx0Ll9kZXRlY3ROYXZiYXI9ZnVuY3Rpb24oKXtyZXR1cm4gMDxtZSh0aGlzLl9lbGVtZW50KS5jbG9zZXN0KCIubmF2YmFyIikubGVuZ3RofSx0Ll9nZXRQb3BwZXJDb25maWc9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9e307ImZ1bmN0aW9uIj09dHlwZW9mIHRoaXMuX2NvbmZpZy5vZmZzZXQ/dC5mbj1mdW5jdGlvbih0KXtyZXR1cm4gdC5vZmZzZXRzPWMoe30sdC5vZmZzZXRzLGUuX2NvbmZpZy5vZmZzZXQodC5vZmZzZXRzKXx8e30pLHR9OnQub2Zmc2V0PXRoaXMuX2NvbmZpZy5vZmZzZXQ7dmFyIG49e3BsYWNlbWVudDp0aGlzLl9nZXRQbGFjZW1lbnQoKSxtb2RpZmllcnM6e29mZnNldDp0LGZsaXA6e2VuYWJsZWQ6dGhpcy5fY29uZmlnLmZsaXB9LHByZXZlbnRPdmVyZmxvdzp7Ym91bmRhcmllc0VsZW1lbnQ6dGhpcy5fY29uZmlnLmJvdW5kYXJ5fX19O3JldHVybiJzdGF0aWMiPT09dGhpcy5fY29uZmlnLmRpc3BsYXkmJihuLm1vZGlmaWVycy5hcHBseVN0eWxlPXtlbmFibGVkOiExfSksbn0sbC5falF1ZXJ5SW50ZXJmYWNlPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdD1tZSh0aGlzKS5kYXRhKHZlKTtpZih0fHwodD1uZXcgbCh0aGlzLCJvYmplY3QiPT10eXBlb2YgZT9lOm51bGwpLG1lKHRoaXMpLmRhdGEodmUsdCkpLCJzdHJpbmciPT10eXBlb2YgZSl7aWYoInVuZGVmaW5lZCI9PXR5cGVvZiB0W2VdKXRocm93IG5ldyBUeXBlRXJyb3IoJ05vIG1ldGhvZCBuYW1lZCAiJytlKyciJyk7dFtlXSgpfX0pfSxsLl9jbGVhck1lbnVzPWZ1bmN0aW9uKHQpe2lmKCF0fHwzIT09dC53aGljaCYmKCJrZXl1cCIhPT10LnR5cGV8fDk9PT10LndoaWNoKSlmb3IodmFyIGU9bWUubWFrZUFycmF5KG1lKGtlKSksbj0wO248ZS5sZW5ndGg7bisrKXt2YXIgaT1sLl9nZXRQYXJlbnRGcm9tRWxlbWVudChlW25dKSxyPW1lKGVbbl0pLmRhdGEodmUpLG89e3JlbGF0ZWRUYXJnZXQ6ZVtuXX07aWYocil7dmFyIHM9ci5fbWVudTtpZihtZShpKS5oYXNDbGFzcyhJZSkmJiEodCYmKCJjbGljayI9PT10LnR5cGUmJi9pbnB1dHx0ZXh0YXJlYS9pLnRlc3QodC50YXJnZXQudGFnTmFtZSl8fCJrZXl1cCI9PT10LnR5cGUmJjk9PT10LndoaWNoKSYmbWUuY29udGFpbnMoaSx0LnRhcmdldCkpKXt2YXIgYT1tZS5FdmVudChDZS5ISURFLG8pO21lKGkpLnRyaWdnZXIoYSksYS5pc0RlZmF1bHRQcmV2ZW50ZWQoKXx8KCJvbnRvdWNoc3RhcnQiaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50JiZtZShkb2N1bWVudC5ib2R5KS5jaGlsZHJlbigpLm9mZigibW91c2VvdmVyIixudWxsLG1lLm5vb3ApLGVbbl0uc2V0QXR0cmlidXRlKCJhcmlhLWV4cGFuZGVkIiwiZmFsc2UiKSxtZShzKS5yZW1vdmVDbGFzcyhJZSksbWUoaSkucmVtb3ZlQ2xhc3MoSWUpLnRyaWdnZXIobWUuRXZlbnQoQ2UuSElEREVOLG8pKSl9fX19LGwuX2dldFBhcmVudEZyb21FbGVtZW50PWZ1bmN0aW9uKHQpe3ZhciBlLG49Z3QuZ2V0U2VsZWN0b3JGcm9tRWxlbWVudCh0KTtyZXR1cm4gbiYmKGU9bWUobilbMF0pLGV8fHQucGFyZW50Tm9kZX0sbC5fZGF0YUFwaUtleWRvd25IYW5kbGVyPWZ1bmN0aW9uKHQpe2lmKCgvaW5wdXR8dGV4dGFyZWEvaS50ZXN0KHQudGFyZ2V0LnRhZ05hbWUpPyEoMzI9PT10LndoaWNofHwyNyE9PXQud2hpY2gmJig0MCE9PXQud2hpY2gmJjM4IT09dC53aGljaHx8bWUodC50YXJnZXQpLmNsb3Nlc3QoUGUpLmxlbmd0aCkpOlRlLnRlc3QodC53aGljaCkpJiYodC5wcmV2ZW50RGVmYXVsdCgpLHQuc3RvcFByb3BhZ2F0aW9uKCksIXRoaXMuZGlzYWJsZWQmJiFtZSh0aGlzKS5oYXNDbGFzcyh3ZSkpKXt2YXIgZT1sLl9nZXRQYXJlbnRGcm9tRWxlbWVudCh0aGlzKSxuPW1lKGUpLmhhc0NsYXNzKEllKTtpZigobnx8Mjc9PT10LndoaWNoJiYzMj09PXQud2hpY2gpJiYoIW58fDI3IT09dC53aGljaCYmMzIhPT10LndoaWNoKSl7dmFyIGk9bWUoZSkuZmluZChqZSkuZ2V0KCk7aWYoMCE9PWkubGVuZ3RoKXt2YXIgcj1pLmluZGV4T2YodC50YXJnZXQpOzM4PT09dC53aGljaCYmMDxyJiZyLS0sNDA9PT10LndoaWNoJiZyPGkubGVuZ3RoLTEmJnIrKyxyPDAmJihyPTApLGlbcl0uZm9jdXMoKX19ZWxzZXtpZigyNz09PXQud2hpY2gpe3ZhciBvPW1lKGUpLmZpbmQoa2UpWzBdO21lKG8pLnRyaWdnZXIoImZvY3VzIil9bWUodGhpcykudHJpZ2dlcigiY2xpY2siKX19fSxzKGwsbnVsbCxbe2tleToiVkVSU0lPTiIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIjQuMS4xIn19LHtrZXk6IkRlZmF1bHQiLGdldDpmdW5jdGlvbigpe3JldHVybiBCZX19LHtrZXk6IkRlZmF1bHRUeXBlIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gS2V9fV0pLGx9KCksbWUoZG9jdW1lbnQpLm9uKENlLktFWURPV05fREFUQV9BUEksa2UsVmUuX2RhdGFBcGlLZXlkb3duSGFuZGxlcikub24oQ2UuS0VZRE9XTl9EQVRBX0FQSSxQZSxWZS5fZGF0YUFwaUtleWRvd25IYW5kbGVyKS5vbihDZS5DTElDS19EQVRBX0FQSSsiICIrQ2UuS0VZVVBfREFUQV9BUEksVmUuX2NsZWFyTWVudXMpLm9uKENlLkNMSUNLX0RBVEFfQVBJLGtlLGZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbigpLFZlLl9qUXVlcnlJbnRlcmZhY2UuY2FsbChtZSh0aGlzKSwidG9nZ2xlIil9KS5vbihDZS5DTElDS19EQVRBX0FQSSxMZSxmdW5jdGlvbih0KXt0LnN0b3BQcm9wYWdhdGlvbigpfSksbWUuZm5bX2VdPVZlLl9qUXVlcnlJbnRlcmZhY2UsbWUuZm5bX2VdLkNvbnN0cnVjdG9yPVZlLG1lLmZuW19lXS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cmV0dXJuIG1lLmZuW19lXT1iZSxWZS5falF1ZXJ5SW50ZXJmYWNlfSxWZSksQ2k9KFllPSJtb2RhbCIscWU9Ii4iKyhHZT0iYnMubW9kYWwiKSx6ZT0oUWU9ZSkuZm5bWWVdLFhlPXtiYWNrZHJvcDohMCxrZXlib2FyZDohMCxmb2N1czohMCxzaG93OiEwfSxKZT17YmFja2Ryb3A6Iihib29sZWFufHN0cmluZykiLGtleWJvYXJkOiJib29sZWFuIixmb2N1czoiYm9vbGVhbiIsc2hvdzoiYm9vbGVhbiJ9LFplPXtISURFOiJoaWRlIitxZSxISURERU46ImhpZGRlbiIrcWUsU0hPVzoic2hvdyIrcWUsU0hPV046InNob3duIitxZSxGT0NVU0lOOiJmb2N1c2luIitxZSxSRVNJWkU6InJlc2l6ZSIrcWUsQ0xJQ0tfRElTTUlTUzoiY2xpY2suZGlzbWlzcyIrcWUsS0VZRE9XTl9ESVNNSVNTOiJrZXlkb3duLmRpc21pc3MiK3FlLE1PVVNFVVBfRElTTUlTUzoibW91c2V1cC5kaXNtaXNzIitxZSxNT1VTRURPV05fRElTTUlTUzoibW91c2Vkb3duLmRpc21pc3MiK3FlLENMSUNLX0RBVEFfQVBJOiJjbGljayIrcWUrIi5kYXRhLWFwaSJ9LCRlPSJtb2RhbC1zY3JvbGxiYXItbWVhc3VyZSIsdG49Im1vZGFsLWJhY2tkcm9wIixlbj0ibW9kYWwtb3BlbiIsbm49ImZhZGUiLHJuPSJzaG93Iixvbj17RElBTE9HOiIubW9kYWwtZGlhbG9nIixEQVRBX1RPR0dMRTonW2RhdGEtdG9nZ2xlPSJtb2RhbCJdJyxEQVRBX0RJU01JU1M6J1tkYXRhLWRpc21pc3M9Im1vZGFsIl0nLEZJWEVEX0NPTlRFTlQ6Ii5maXhlZC10b3AsIC5maXhlZC1ib3R0b20sIC5pcy1maXhlZCwgLnN0aWNreS10b3AiLFNUSUNLWV9DT05URU5UOiIuc3RpY2t5LXRvcCIsTkFWQkFSX1RPR0dMRVI6Ii5uYXZiYXItdG9nZ2xlciJ9LHNuPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gcih0LGUpe3RoaXMuX2NvbmZpZz10aGlzLl9nZXRDb25maWcoZSksdGhpcy5fZWxlbWVudD10LHRoaXMuX2RpYWxvZz1RZSh0KS5maW5kKG9uLkRJQUxPRylbMF0sdGhpcy5fYmFja2Ryb3A9bnVsbCx0aGlzLl9pc1Nob3duPSExLHRoaXMuX2lzQm9keU92ZXJmbG93aW5nPSExLHRoaXMuX2lnbm9yZUJhY2tkcm9wQ2xpY2s9ITEsdGhpcy5fc2Nyb2xsYmFyV2lkdGg9MH12YXIgdD1yLnByb3RvdHlwZTtyZXR1cm4gdC50b2dnbGU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2lzU2hvd24/dGhpcy5oaWRlKCk6dGhpcy5zaG93KHQpfSx0LnNob3c9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcztpZighdGhpcy5faXNUcmFuc2l0aW9uaW5nJiYhdGhpcy5faXNTaG93bil7UWUodGhpcy5fZWxlbWVudCkuaGFzQ2xhc3Mobm4pJiYodGhpcy5faXNUcmFuc2l0aW9uaW5nPSEwKTt2YXIgbj1RZS5FdmVudChaZS5TSE9XLHtyZWxhdGVkVGFyZ2V0OnR9KTtRZSh0aGlzLl9lbGVtZW50KS50cmlnZ2VyKG4pLHRoaXMuX2lzU2hvd258fG4uaXNEZWZhdWx0UHJldmVudGVkKCl8fCh0aGlzLl9pc1Nob3duPSEwLHRoaXMuX2NoZWNrU2Nyb2xsYmFyKCksdGhpcy5fc2V0U2Nyb2xsYmFyKCksdGhpcy5fYWRqdXN0RGlhbG9nKCksUWUoZG9jdW1lbnQuYm9keSkuYWRkQ2xhc3MoZW4pLHRoaXMuX3NldEVzY2FwZUV2ZW50KCksdGhpcy5fc2V0UmVzaXplRXZlbnQoKSxRZSh0aGlzLl9lbGVtZW50KS5vbihaZS5DTElDS19ESVNNSVNTLG9uLkRBVEFfRElTTUlTUyxmdW5jdGlvbih0KXtyZXR1cm4gZS5oaWRlKHQpfSksUWUodGhpcy5fZGlhbG9nKS5vbihaZS5NT1VTRURPV05fRElTTUlTUyxmdW5jdGlvbigpe1FlKGUuX2VsZW1lbnQpLm9uZShaZS5NT1VTRVVQX0RJU01JU1MsZnVuY3Rpb24odCl7UWUodC50YXJnZXQpLmlzKGUuX2VsZW1lbnQpJiYoZS5faWdub3JlQmFja2Ryb3BDbGljaz0hMCl9KX0pLHRoaXMuX3Nob3dCYWNrZHJvcChmdW5jdGlvbigpe3JldHVybiBlLl9zaG93RWxlbWVudCh0KX0pKX19LHQuaGlkZT1mdW5jdGlvbih0KXt2YXIgZT10aGlzO2lmKHQmJnQucHJldmVudERlZmF1bHQoKSwhdGhpcy5faXNUcmFuc2l0aW9uaW5nJiZ0aGlzLl9pc1Nob3duKXt2YXIgbj1RZS5FdmVudChaZS5ISURFKTtpZihRZSh0aGlzLl9lbGVtZW50KS50cmlnZ2VyKG4pLHRoaXMuX2lzU2hvd24mJiFuLmlzRGVmYXVsdFByZXZlbnRlZCgpKXt0aGlzLl9pc1Nob3duPSExO3ZhciBpPVFlKHRoaXMuX2VsZW1lbnQpLmhhc0NsYXNzKG5uKTtpZihpJiYodGhpcy5faXNUcmFuc2l0aW9uaW5nPSEwKSx0aGlzLl9zZXRFc2NhcGVFdmVudCgpLHRoaXMuX3NldFJlc2l6ZUV2ZW50KCksUWUoZG9jdW1lbnQpLm9mZihaZS5GT0NVU0lOKSxRZSh0aGlzLl9lbGVtZW50KS5yZW1vdmVDbGFzcyhybiksUWUodGhpcy5fZWxlbWVudCkub2ZmKFplLkNMSUNLX0RJU01JU1MpLFFlKHRoaXMuX2RpYWxvZykub2ZmKFplLk1PVVNFRE9XTl9ESVNNSVNTKSxpKXt2YXIgcj1ndC5nZXRUcmFuc2l0aW9uRHVyYXRpb25Gcm9tRWxlbWVudCh0aGlzLl9lbGVtZW50KTtRZSh0aGlzLl9lbGVtZW50KS5vbmUoZ3QuVFJBTlNJVElPTl9FTkQsZnVuY3Rpb24odCl7cmV0dXJuIGUuX2hpZGVNb2RhbCh0KX0pLmVtdWxhdGVUcmFuc2l0aW9uRW5kKHIpfWVsc2UgdGhpcy5faGlkZU1vZGFsKCl9fX0sdC5kaXNwb3NlPWZ1bmN0aW9uKCl7UWUucmVtb3ZlRGF0YSh0aGlzLl9lbGVtZW50LEdlKSxRZSh3aW5kb3csZG9jdW1lbnQsdGhpcy5fZWxlbWVudCx0aGlzLl9iYWNrZHJvcCkub2ZmKHFlKSx0aGlzLl9jb25maWc9bnVsbCx0aGlzLl9lbGVtZW50PW51bGwsdGhpcy5fZGlhbG9nPW51bGwsdGhpcy5fYmFja2Ryb3A9bnVsbCx0aGlzLl9pc1Nob3duPW51bGwsdGhpcy5faXNCb2R5T3ZlcmZsb3dpbmc9bnVsbCx0aGlzLl9pZ25vcmVCYWNrZHJvcENsaWNrPW51bGwsdGhpcy5fc2Nyb2xsYmFyV2lkdGg9bnVsbH0sdC5oYW5kbGVVcGRhdGU9ZnVuY3Rpb24oKXt0aGlzLl9hZGp1c3REaWFsb2coKX0sdC5fZ2V0Q29uZmlnPWZ1bmN0aW9uKHQpe3JldHVybiB0PWMoe30sWGUsdCksZ3QudHlwZUNoZWNrQ29uZmlnKFllLHQsSmUpLHR9LHQuX3Nob3dFbGVtZW50PWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMsbj1RZSh0aGlzLl9lbGVtZW50KS5oYXNDbGFzcyhubik7dGhpcy5fZWxlbWVudC5wYXJlbnROb2RlJiZ0aGlzLl9lbGVtZW50LnBhcmVudE5vZGUubm9kZVR5cGU9PT1Ob2RlLkVMRU1FTlRfTk9ERXx8ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLl9lbGVtZW50KSx0aGlzLl9lbGVtZW50LnN0eWxlLmRpc3BsYXk9ImJsb2NrIix0aGlzLl9lbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgiYXJpYS1oaWRkZW4iKSx0aGlzLl9lbGVtZW50LnNjcm9sbFRvcD0wLG4mJmd0LnJlZmxvdyh0aGlzLl9lbGVtZW50KSxRZSh0aGlzLl9lbGVtZW50KS5hZGRDbGFzcyhybiksdGhpcy5fY29uZmlnLmZvY3VzJiZ0aGlzLl9lbmZvcmNlRm9jdXMoKTt2YXIgaT1RZS5FdmVudChaZS5TSE9XTix7cmVsYXRlZFRhcmdldDp0fSkscj1mdW5jdGlvbigpe2UuX2NvbmZpZy5mb2N1cyYmZS5fZWxlbWVudC5mb2N1cygpLGUuX2lzVHJhbnNpdGlvbmluZz0hMSxRZShlLl9lbGVtZW50KS50cmlnZ2VyKGkpfTtpZihuKXt2YXIgbz1ndC5nZXRUcmFuc2l0aW9uRHVyYXRpb25Gcm9tRWxlbWVudCh0aGlzLl9lbGVtZW50KTtRZSh0aGlzLl9kaWFsb2cpLm9uZShndC5UUkFOU0lUSU9OX0VORCxyKS5lbXVsYXRlVHJhbnNpdGlvbkVuZChvKX1lbHNlIHIoKX0sdC5fZW5mb3JjZUZvY3VzPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcztRZShkb2N1bWVudCkub2ZmKFplLkZPQ1VTSU4pLm9uKFplLkZPQ1VTSU4sZnVuY3Rpb24odCl7ZG9jdW1lbnQhPT10LnRhcmdldCYmZS5fZWxlbWVudCE9PXQudGFyZ2V0JiYwPT09UWUoZS5fZWxlbWVudCkuaGFzKHQudGFyZ2V0KS5sZW5ndGgmJmUuX2VsZW1lbnQuZm9jdXMoKX0pfSx0Ll9zZXRFc2NhcGVFdmVudD1mdW5jdGlvbigpe3ZhciBlPXRoaXM7dGhpcy5faXNTaG93biYmdGhpcy5fY29uZmlnLmtleWJvYXJkP1FlKHRoaXMuX2VsZW1lbnQpLm9uKFplLktFWURPV05fRElTTUlTUyxmdW5jdGlvbih0KXsyNz09PXQud2hpY2gmJih0LnByZXZlbnREZWZhdWx0KCksZS5oaWRlKCkpfSk6dGhpcy5faXNTaG93bnx8UWUodGhpcy5fZWxlbWVudCkub2ZmKFplLktFWURPV05fRElTTUlTUyl9LHQuX3NldFJlc2l6ZUV2ZW50PWZ1bmN0aW9uKCl7dmFyIGU9dGhpczt0aGlzLl9pc1Nob3duP1FlKHdpbmRvdykub24oWmUuUkVTSVpFLGZ1bmN0aW9uKHQpe3JldHVybiBlLmhhbmRsZVVwZGF0ZSh0KX0pOlFlKHdpbmRvdykub2ZmKFplLlJFU0laRSl9LHQuX2hpZGVNb2RhbD1mdW5jdGlvbigpe3ZhciB0PXRoaXM7dGhpcy5fZWxlbWVudC5zdHlsZS5kaXNwbGF5PSJub25lIix0aGlzLl9lbGVtZW50LnNldEF0dHJpYnV0ZSgiYXJpYS1oaWRkZW4iLCEwKSx0aGlzLl9pc1RyYW5zaXRpb25pbmc9ITEsdGhpcy5fc2hvd0JhY2tkcm9wKGZ1bmN0aW9uKCl7UWUoZG9jdW1lbnQuYm9keSkucmVtb3ZlQ2xhc3MoZW4pLHQuX3Jlc2V0QWRqdXN0bWVudHMoKSx0Ll9yZXNldFNjcm9sbGJhcigpLFFlKHQuX2VsZW1lbnQpLnRyaWdnZXIoWmUuSElEREVOKX0pfSx0Ll9yZW1vdmVCYWNrZHJvcD1mdW5jdGlvbigpe3RoaXMuX2JhY2tkcm9wJiYoUWUodGhpcy5fYmFja2Ryb3ApLnJlbW92ZSgpLHRoaXMuX2JhY2tkcm9wPW51bGwpfSx0Ll9zaG93QmFja2Ryb3A9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcyxuPVFlKHRoaXMuX2VsZW1lbnQpLmhhc0NsYXNzKG5uKT9ubjoiIjtpZih0aGlzLl9pc1Nob3duJiZ0aGlzLl9jb25maWcuYmFja2Ryb3Ape2lmKHRoaXMuX2JhY2tkcm9wPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLHRoaXMuX2JhY2tkcm9wLmNsYXNzTmFtZT10bixuJiZRZSh0aGlzLl9iYWNrZHJvcCkuYWRkQ2xhc3MobiksUWUodGhpcy5fYmFja2Ryb3ApLmFwcGVuZFRvKGRvY3VtZW50LmJvZHkpLFFlKHRoaXMuX2VsZW1lbnQpLm9uKFplLkNMSUNLX0RJU01JU1MsZnVuY3Rpb24odCl7ZS5faWdub3JlQmFja2Ryb3BDbGljaz9lLl9pZ25vcmVCYWNrZHJvcENsaWNrPSExOnQudGFyZ2V0PT09dC5jdXJyZW50VGFyZ2V0JiYoInN0YXRpYyI9PT1lLl9jb25maWcuYmFja2Ryb3A/ZS5fZWxlbWVudC5mb2N1cygpOmUuaGlkZSgpKX0pLG4mJmd0LnJlZmxvdyh0aGlzLl9iYWNrZHJvcCksUWUodGhpcy5fYmFja2Ryb3ApLmFkZENsYXNzKHJuKSwhdClyZXR1cm47aWYoIW4pcmV0dXJuIHZvaWQgdCgpO3ZhciBpPWd0LmdldFRyYW5zaXRpb25EdXJhdGlvbkZyb21FbGVtZW50KHRoaXMuX2JhY2tkcm9wKTtRZSh0aGlzLl9iYWNrZHJvcCkub25lKGd0LlRSQU5TSVRJT05fRU5ELHQpLmVtdWxhdGVUcmFuc2l0aW9uRW5kKGkpfWVsc2UgaWYoIXRoaXMuX2lzU2hvd24mJnRoaXMuX2JhY2tkcm9wKXtRZSh0aGlzLl9iYWNrZHJvcCkucmVtb3ZlQ2xhc3Mocm4pO3ZhciByPWZ1bmN0aW9uKCl7ZS5fcmVtb3ZlQmFja2Ryb3AoKSx0JiZ0KCl9O2lmKFFlKHRoaXMuX2VsZW1lbnQpLmhhc0NsYXNzKG5uKSl7dmFyIG89Z3QuZ2V0VHJhbnNpdGlvbkR1cmF0aW9uRnJvbUVsZW1lbnQodGhpcy5fYmFja2Ryb3ApO1FlKHRoaXMuX2JhY2tkcm9wKS5vbmUoZ3QuVFJBTlNJVElPTl9FTkQscikuZW11bGF0ZVRyYW5zaXRpb25FbmQobyl9ZWxzZSByKCl9ZWxzZSB0JiZ0KCl9LHQuX2FkanVzdERpYWxvZz1mdW5jdGlvbigpe3ZhciB0PXRoaXMuX2VsZW1lbnQuc2Nyb2xsSGVpZ2h0PmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQ7IXRoaXMuX2lzQm9keU92ZXJmbG93aW5nJiZ0JiYodGhpcy5fZWxlbWVudC5zdHlsZS5wYWRkaW5nTGVmdD10aGlzLl9zY3JvbGxiYXJXaWR0aCsicHgiKSx0aGlzLl9pc0JvZHlPdmVyZmxvd2luZyYmIXQmJih0aGlzLl9lbGVtZW50LnN0eWxlLnBhZGRpbmdSaWdodD10aGlzLl9zY3JvbGxiYXJXaWR0aCsicHgiKX0sdC5fcmVzZXRBZGp1c3RtZW50cz1mdW5jdGlvbigpe3RoaXMuX2VsZW1lbnQuc3R5bGUucGFkZGluZ0xlZnQ9IiIsdGhpcy5fZWxlbWVudC5zdHlsZS5wYWRkaW5nUmlnaHQ9IiJ9LHQuX2NoZWNrU2Nyb2xsYmFyPWZ1bmN0aW9uKCl7dmFyIHQ9ZG9jdW1lbnQuYm9keS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTt0aGlzLl9pc0JvZHlPdmVyZmxvd2luZz10LmxlZnQrdC5yaWdodDx3aW5kb3cuaW5uZXJXaWR0aCx0aGlzLl9zY3JvbGxiYXJXaWR0aD10aGlzLl9nZXRTY3JvbGxiYXJXaWR0aCgpfSx0Ll9zZXRTY3JvbGxiYXI9ZnVuY3Rpb24oKXt2YXIgcj10aGlzO2lmKHRoaXMuX2lzQm9keU92ZXJmbG93aW5nKXtRZShvbi5GSVhFRF9DT05URU5UKS5lYWNoKGZ1bmN0aW9uKHQsZSl7dmFyIG49UWUoZSlbMF0uc3R5bGUucGFkZGluZ1JpZ2h0LGk9UWUoZSkuY3NzKCJwYWRkaW5nLXJpZ2h0Iik7UWUoZSkuZGF0YSgicGFkZGluZy1yaWdodCIsbikuY3NzKCJwYWRkaW5nLXJpZ2h0IixwYXJzZUZsb2F0KGkpK3IuX3Njcm9sbGJhcldpZHRoKyJweCIpfSksUWUob24uU1RJQ0tZX0NPTlRFTlQpLmVhY2goZnVuY3Rpb24odCxlKXt2YXIgbj1RZShlKVswXS5zdHlsZS5tYXJnaW5SaWdodCxpPVFlKGUpLmNzcygibWFyZ2luLXJpZ2h0Iik7UWUoZSkuZGF0YSgibWFyZ2luLXJpZ2h0IixuKS5jc3MoIm1hcmdpbi1yaWdodCIscGFyc2VGbG9hdChpKS1yLl9zY3JvbGxiYXJXaWR0aCsicHgiKX0pLFFlKG9uLk5BVkJBUl9UT0dHTEVSKS5lYWNoKGZ1bmN0aW9uKHQsZSl7dmFyIG49UWUoZSlbMF0uc3R5bGUubWFyZ2luUmlnaHQsaT1RZShlKS5jc3MoIm1hcmdpbi1yaWdodCIpO1FlKGUpLmRhdGEoIm1hcmdpbi1yaWdodCIsbikuY3NzKCJtYXJnaW4tcmlnaHQiLHBhcnNlRmxvYXQoaSkrci5fc2Nyb2xsYmFyV2lkdGgrInB4Iil9KTt2YXIgdD1kb2N1bWVudC5ib2R5LnN0eWxlLnBhZGRpbmdSaWdodCxlPVFlKGRvY3VtZW50LmJvZHkpLmNzcygicGFkZGluZy1yaWdodCIpO1FlKGRvY3VtZW50LmJvZHkpLmRhdGEoInBhZGRpbmctcmlnaHQiLHQpLmNzcygicGFkZGluZy1yaWdodCIscGFyc2VGbG9hdChlKSt0aGlzLl9zY3JvbGxiYXJXaWR0aCsicHgiKX19LHQuX3Jlc2V0U2Nyb2xsYmFyPWZ1bmN0aW9uKCl7UWUob24uRklYRURfQ09OVEVOVCkuZWFjaChmdW5jdGlvbih0LGUpe3ZhciBuPVFlKGUpLmRhdGEoInBhZGRpbmctcmlnaHQiKTsidW5kZWZpbmVkIiE9dHlwZW9mIG4mJlFlKGUpLmNzcygicGFkZGluZy1yaWdodCIsbikucmVtb3ZlRGF0YSgicGFkZGluZy1yaWdodCIpfSksUWUob24uU1RJQ0tZX0NPTlRFTlQrIiwgIitvbi5OQVZCQVJfVE9HR0xFUikuZWFjaChmdW5jdGlvbih0LGUpe3ZhciBuPVFlKGUpLmRhdGEoIm1hcmdpbi1yaWdodCIpOyJ1bmRlZmluZWQiIT10eXBlb2YgbiYmUWUoZSkuY3NzKCJtYXJnaW4tcmlnaHQiLG4pLnJlbW92ZURhdGEoIm1hcmdpbi1yaWdodCIpfSk7dmFyIHQ9UWUoZG9jdW1lbnQuYm9keSkuZGF0YSgicGFkZGluZy1yaWdodCIpOyJ1bmRlZmluZWQiIT10eXBlb2YgdCYmUWUoZG9jdW1lbnQuYm9keSkuY3NzKCJwYWRkaW5nLXJpZ2h0Iix0KS5yZW1vdmVEYXRhKCJwYWRkaW5nLXJpZ2h0Iil9LHQuX2dldFNjcm9sbGJhcldpZHRoPWZ1bmN0aW9uKCl7dmFyIHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7dC5jbGFzc05hbWU9JGUsZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0KTt2YXIgZT10LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoLXQuY2xpZW50V2lkdGg7cmV0dXJuIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodCksZX0sci5falF1ZXJ5SW50ZXJmYWNlPWZ1bmN0aW9uKG4saSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciB0PVFlKHRoaXMpLmRhdGEoR2UpLGU9Yyh7fSxYZSxRZSh0aGlzKS5kYXRhKCksIm9iamVjdCI9PXR5cGVvZiBuJiZuP246e30pO2lmKHR8fCh0PW5ldyByKHRoaXMsZSksUWUodGhpcykuZGF0YShHZSx0KSksInN0cmluZyI9PXR5cGVvZiBuKXtpZigidW5kZWZpbmVkIj09dHlwZW9mIHRbbl0pdGhyb3cgbmV3IFR5cGVFcnJvcignTm8gbWV0aG9kIG5hbWVkICInK24rJyInKTt0W25dKGkpfWVsc2UgZS5zaG93JiZ0LnNob3coaSl9KX0scyhyLG51bGwsW3trZXk6IlZFUlNJT04iLGdldDpmdW5jdGlvbigpe3JldHVybiI0LjEuMSJ9fSx7a2V5OiJEZWZhdWx0IixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gWGV9fV0pLHJ9KCksUWUoZG9jdW1lbnQpLm9uKFplLkNMSUNLX0RBVEFfQVBJLG9uLkRBVEFfVE9HR0xFLGZ1bmN0aW9uKHQpe3ZhciBlLG49dGhpcyxpPWd0LmdldFNlbGVjdG9yRnJvbUVsZW1lbnQodGhpcyk7aSYmKGU9UWUoaSlbMF0pO3ZhciByPVFlKGUpLmRhdGEoR2UpPyJ0b2dnbGUiOmMoe30sUWUoZSkuZGF0YSgpLFFlKHRoaXMpLmRhdGEoKSk7IkEiIT09dGhpcy50YWdOYW1lJiYiQVJFQSIhPT10aGlzLnRhZ05hbWV8fHQucHJldmVudERlZmF1bHQoKTt2YXIgbz1RZShlKS5vbmUoWmUuU0hPVyxmdW5jdGlvbih0KXt0LmlzRGVmYXVsdFByZXZlbnRlZCgpfHxvLm9uZShaZS5ISURERU4sZnVuY3Rpb24oKXtRZShuKS5pcygiOnZpc2libGUiKSYmbi5mb2N1cygpfSl9KTtzbi5falF1ZXJ5SW50ZXJmYWNlLmNhbGwoUWUoZSkscix0aGlzKX0pLFFlLmZuW1llXT1zbi5falF1ZXJ5SW50ZXJmYWNlLFFlLmZuW1llXS5Db25zdHJ1Y3Rvcj1zbixRZS5mbltZZV0ubm9Db25mbGljdD1mdW5jdGlvbigpe3JldHVybiBRZS5mbltZZV09emUsc24uX2pRdWVyeUludGVyZmFjZX0sc24pLHdpPShsbj0idG9vbHRpcCIsZm49Ii4iKyhjbj0iYnMudG9vbHRpcCIpLGhuPShhbj1lKS5mbltsbl0sdW49ImJzLXRvb2x0aXAiLGRuPW5ldyBSZWdFeHAoIihefFxccykiK3VuKyJcXFMrIiwiZyIpLG1uPXthbmltYXRpb246ITAsdGVtcGxhdGU6JzxkaXYgY2xhc3M9InRvb2x0aXAiIHJvbGU9InRvb2x0aXAiPjxkaXYgY2xhc3M9ImFycm93Ij48L2Rpdj48ZGl2IGNsYXNzPSJ0b29sdGlwLWlubmVyIj48L2Rpdj48L2Rpdj4nLHRyaWdnZXI6ImhvdmVyIGZvY3VzIix0aXRsZToiIixkZWxheTowLGh0bWw6IShnbj17QVVUTzoiYXV0byIsVE9QOiJ0b3AiLFJJR0hUOiJyaWdodCIsQk9UVE9NOiJib3R0b20iLExFRlQ6ImxlZnQifSksc2VsZWN0b3I6IShwbj17YW5pbWF0aW9uOiJib29sZWFuIix0ZW1wbGF0ZToic3RyaW5nIix0aXRsZToiKHN0cmluZ3xlbGVtZW50fGZ1bmN0aW9uKSIsdHJpZ2dlcjoic3RyaW5nIixkZWxheToiKG51bWJlcnxvYmplY3QpIixodG1sOiJib29sZWFuIixzZWxlY3RvcjoiKHN0cmluZ3xib29sZWFuKSIscGxhY2VtZW50OiIoc3RyaW5nfGZ1bmN0aW9uKSIsb2Zmc2V0OiIobnVtYmVyfHN0cmluZykiLGNvbnRhaW5lcjoiKHN0cmluZ3xlbGVtZW50fGJvb2xlYW4pIixmYWxsYmFja1BsYWNlbWVudDoiKHN0cmluZ3xhcnJheSkiLGJvdW5kYXJ5OiIoc3RyaW5nfGVsZW1lbnQpIn0pLHBsYWNlbWVudDoidG9wIixvZmZzZXQ6MCxjb250YWluZXI6ITEsZmFsbGJhY2tQbGFjZW1lbnQ6ImZsaXAiLGJvdW5kYXJ5OiJzY3JvbGxQYXJlbnQifSx2bj0ib3V0IixFbj17SElERToiaGlkZSIrZm4sSElEREVOOiJoaWRkZW4iK2ZuLFNIT1c6KF9uPSJzaG93IikrZm4sU0hPV046InNob3duIitmbixJTlNFUlRFRDoiaW5zZXJ0ZWQiK2ZuLENMSUNLOiJjbGljayIrZm4sRk9DVVNJTjoiZm9jdXNpbiIrZm4sRk9DVVNPVVQ6ImZvY3Vzb3V0IitmbixNT1VTRUVOVEVSOiJtb3VzZWVudGVyIitmbixNT1VTRUxFQVZFOiJtb3VzZWxlYXZlIitmbn0seW49ImZhZGUiLGJuPSJzaG93IixUbj0iLnRvb2x0aXAtaW5uZXIiLENuPSIuYXJyb3ciLHduPSJob3ZlciIsSW49ImZvY3VzIixEbj0iY2xpY2siLEFuPSJtYW51YWwiLFNuPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gaSh0LGUpe2lmKCJ1bmRlZmluZWQiPT10eXBlb2YgZ2UpdGhyb3cgbmV3IFR5cGVFcnJvcigiQm9vdHN0cmFwIHRvb2x0aXBzIHJlcXVpcmUgUG9wcGVyLmpzIChodHRwczovL3BvcHBlci5qcy5vcmcpIik7dGhpcy5faXNFbmFibGVkPSEwLHRoaXMuX3RpbWVvdXQ9MCx0aGlzLl9ob3ZlclN0YXRlPSIiLHRoaXMuX2FjdGl2ZVRyaWdnZXI9e30sdGhpcy5fcG9wcGVyPW51bGwsdGhpcy5lbGVtZW50PXQsdGhpcy5jb25maWc9dGhpcy5fZ2V0Q29uZmlnKGUpLHRoaXMudGlwPW51bGwsdGhpcy5fc2V0TGlzdGVuZXJzKCl9dmFyIHQ9aS5wcm90b3R5cGU7cmV0dXJuIHQuZW5hYmxlPWZ1bmN0aW9uKCl7dGhpcy5faXNFbmFibGVkPSEwfSx0LmRpc2FibGU9ZnVuY3Rpb24oKXt0aGlzLl9pc0VuYWJsZWQ9ITF9LHQudG9nZ2xlRW5hYmxlZD1mdW5jdGlvbigpe3RoaXMuX2lzRW5hYmxlZD0hdGhpcy5faXNFbmFibGVkfSx0LnRvZ2dsZT1mdW5jdGlvbih0KXtpZih0aGlzLl9pc0VuYWJsZWQpaWYodCl7dmFyIGU9dGhpcy5jb25zdHJ1Y3Rvci5EQVRBX0tFWSxuPWFuKHQuY3VycmVudFRhcmdldCkuZGF0YShlKTtufHwobj1uZXcgdGhpcy5jb25zdHJ1Y3Rvcih0LmN1cnJlbnRUYXJnZXQsdGhpcy5fZ2V0RGVsZWdhdGVDb25maWcoKSksYW4odC5jdXJyZW50VGFyZ2V0KS5kYXRhKGUsbikpLG4uX2FjdGl2ZVRyaWdnZXIuY2xpY2s9IW4uX2FjdGl2ZVRyaWdnZXIuY2xpY2ssbi5faXNXaXRoQWN0aXZlVHJpZ2dlcigpP24uX2VudGVyKG51bGwsbik6bi5fbGVhdmUobnVsbCxuKX1lbHNle2lmKGFuKHRoaXMuZ2V0VGlwRWxlbWVudCgpKS5oYXNDbGFzcyhibikpcmV0dXJuIHZvaWQgdGhpcy5fbGVhdmUobnVsbCx0aGlzKTt0aGlzLl9lbnRlcihudWxsLHRoaXMpfX0sdC5kaXNwb3NlPWZ1bmN0aW9uKCl7Y2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVvdXQpLGFuLnJlbW92ZURhdGEodGhpcy5lbGVtZW50LHRoaXMuY29uc3RydWN0b3IuREFUQV9LRVkpLGFuKHRoaXMuZWxlbWVudCkub2ZmKHRoaXMuY29uc3RydWN0b3IuRVZFTlRfS0VZKSxhbih0aGlzLmVsZW1lbnQpLmNsb3Nlc3QoIi5tb2RhbCIpLm9mZigiaGlkZS5icy5tb2RhbCIpLHRoaXMudGlwJiZhbih0aGlzLnRpcCkucmVtb3ZlKCksdGhpcy5faXNFbmFibGVkPW51bGwsdGhpcy5fdGltZW91dD1udWxsLHRoaXMuX2hvdmVyU3RhdGU9bnVsbCwodGhpcy5fYWN0aXZlVHJpZ2dlcj1udWxsKSE9PXRoaXMuX3BvcHBlciYmdGhpcy5fcG9wcGVyLmRlc3Ryb3koKSx0aGlzLl9wb3BwZXI9bnVsbCx0aGlzLmVsZW1lbnQ9bnVsbCx0aGlzLmNvbmZpZz1udWxsLHRoaXMudGlwPW51bGx9LHQuc2hvdz1mdW5jdGlvbigpe3ZhciBlPXRoaXM7aWYoIm5vbmUiPT09YW4odGhpcy5lbGVtZW50KS5jc3MoImRpc3BsYXkiKSl0aHJvdyBuZXcgRXJyb3IoIlBsZWFzZSB1c2Ugc2hvdyBvbiB2aXNpYmxlIGVsZW1lbnRzIik7dmFyIHQ9YW4uRXZlbnQodGhpcy5jb25zdHJ1Y3Rvci5FdmVudC5TSE9XKTtpZih0aGlzLmlzV2l0aENvbnRlbnQoKSYmdGhpcy5faXNFbmFibGVkKXthbih0aGlzLmVsZW1lbnQpLnRyaWdnZXIodCk7dmFyIG49YW4uY29udGFpbnModGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LHRoaXMuZWxlbWVudCk7aWYodC5pc0RlZmF1bHRQcmV2ZW50ZWQoKXx8IW4pcmV0dXJuO3ZhciBpPXRoaXMuZ2V0VGlwRWxlbWVudCgpLHI9Z3QuZ2V0VUlEKHRoaXMuY29uc3RydWN0b3IuTkFNRSk7aS5zZXRBdHRyaWJ1dGUoImlkIixyKSx0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKCJhcmlhLWRlc2NyaWJlZGJ5IixyKSx0aGlzLnNldENvbnRlbnQoKSx0aGlzLmNvbmZpZy5hbmltYXRpb24mJmFuKGkpLmFkZENsYXNzKHluKTt2YXIgbz0iZnVuY3Rpb24iPT10eXBlb2YgdGhpcy5jb25maWcucGxhY2VtZW50P3RoaXMuY29uZmlnLnBsYWNlbWVudC5jYWxsKHRoaXMsaSx0aGlzLmVsZW1lbnQpOnRoaXMuY29uZmlnLnBsYWNlbWVudCxzPXRoaXMuX2dldEF0dGFjaG1lbnQobyk7dGhpcy5hZGRBdHRhY2htZW50Q2xhc3Mocyk7dmFyIGE9ITE9PT10aGlzLmNvbmZpZy5jb250YWluZXI/ZG9jdW1lbnQuYm9keTphbih0aGlzLmNvbmZpZy5jb250YWluZXIpO2FuKGkpLmRhdGEodGhpcy5jb25zdHJ1Y3Rvci5EQVRBX0tFWSx0aGlzKSxhbi5jb250YWlucyh0aGlzLmVsZW1lbnQub3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsdGhpcy50aXApfHxhbihpKS5hcHBlbmRUbyhhKSxhbih0aGlzLmVsZW1lbnQpLnRyaWdnZXIodGhpcy5jb25zdHJ1Y3Rvci5FdmVudC5JTlNFUlRFRCksdGhpcy5fcG9wcGVyPW5ldyBnZSh0aGlzLmVsZW1lbnQsaSx7cGxhY2VtZW50OnMsbW9kaWZpZXJzOntvZmZzZXQ6e29mZnNldDp0aGlzLmNvbmZpZy5vZmZzZXR9LGZsaXA6e2JlaGF2aW9yOnRoaXMuY29uZmlnLmZhbGxiYWNrUGxhY2VtZW50fSxhcnJvdzp7ZWxlbWVudDpDbn0scHJldmVudE92ZXJmbG93Ontib3VuZGFyaWVzRWxlbWVudDp0aGlzLmNvbmZpZy5ib3VuZGFyeX19LG9uQ3JlYXRlOmZ1bmN0aW9uKHQpe3Qub3JpZ2luYWxQbGFjZW1lbnQhPT10LnBsYWNlbWVudCYmZS5faGFuZGxlUG9wcGVyUGxhY2VtZW50Q2hhbmdlKHQpfSxvblVwZGF0ZTpmdW5jdGlvbih0KXtlLl9oYW5kbGVQb3BwZXJQbGFjZW1lbnRDaGFuZ2UodCl9fSksYW4oaSkuYWRkQ2xhc3MoYm4pLCJvbnRvdWNoc3RhcnQiaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50JiZhbihkb2N1bWVudC5ib2R5KS5jaGlsZHJlbigpLm9uKCJtb3VzZW92ZXIiLG51bGwsYW4ubm9vcCk7dmFyIGw9ZnVuY3Rpb24oKXtlLmNvbmZpZy5hbmltYXRpb24mJmUuX2ZpeFRyYW5zaXRpb24oKTt2YXIgdD1lLl9ob3ZlclN0YXRlO2UuX2hvdmVyU3RhdGU9bnVsbCxhbihlLmVsZW1lbnQpLnRyaWdnZXIoZS5jb25zdHJ1Y3Rvci5FdmVudC5TSE9XTiksdD09PXZuJiZlLl9sZWF2ZShudWxsLGUpfTtpZihhbih0aGlzLnRpcCkuaGFzQ2xhc3MoeW4pKXt2YXIgYz1ndC5nZXRUcmFuc2l0aW9uRHVyYXRpb25Gcm9tRWxlbWVudCh0aGlzLnRpcCk7YW4odGhpcy50aXApLm9uZShndC5UUkFOU0lUSU9OX0VORCxsKS5lbXVsYXRlVHJhbnNpdGlvbkVuZChjKX1lbHNlIGwoKX19LHQuaGlkZT1mdW5jdGlvbih0KXt2YXIgZT10aGlzLG49dGhpcy5nZXRUaXBFbGVtZW50KCksaT1hbi5FdmVudCh0aGlzLmNvbnN0cnVjdG9yLkV2ZW50LkhJREUpLHI9ZnVuY3Rpb24oKXtlLl9ob3ZlclN0YXRlIT09X24mJm4ucGFyZW50Tm9kZSYmbi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG4pLGUuX2NsZWFuVGlwQ2xhc3MoKSxlLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCJhcmlhLWRlc2NyaWJlZGJ5IiksYW4oZS5lbGVtZW50KS50cmlnZ2VyKGUuY29uc3RydWN0b3IuRXZlbnQuSElEREVOKSxudWxsIT09ZS5fcG9wcGVyJiZlLl9wb3BwZXIuZGVzdHJveSgpLHQmJnQoKX07aWYoYW4odGhpcy5lbGVtZW50KS50cmlnZ2VyKGkpLCFpLmlzRGVmYXVsdFByZXZlbnRlZCgpKXtpZihhbihuKS5yZW1vdmVDbGFzcyhibiksIm9udG91Y2hzdGFydCJpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQmJmFuKGRvY3VtZW50LmJvZHkpLmNoaWxkcmVuKCkub2ZmKCJtb3VzZW92ZXIiLG51bGwsYW4ubm9vcCksdGhpcy5fYWN0aXZlVHJpZ2dlcltEbl09ITEsdGhpcy5fYWN0aXZlVHJpZ2dlcltJbl09ITEsdGhpcy5fYWN0aXZlVHJpZ2dlclt3bl09ITEsYW4odGhpcy50aXApLmhhc0NsYXNzKHluKSl7dmFyIG89Z3QuZ2V0VHJhbnNpdGlvbkR1cmF0aW9uRnJvbUVsZW1lbnQobik7YW4obikub25lKGd0LlRSQU5TSVRJT05fRU5ELHIpLmVtdWxhdGVUcmFuc2l0aW9uRW5kKG8pfWVsc2UgcigpO3RoaXMuX2hvdmVyU3RhdGU9IiJ9fSx0LnVwZGF0ZT1mdW5jdGlvbigpe251bGwhPT10aGlzLl9wb3BwZXImJnRoaXMuX3BvcHBlci5zY2hlZHVsZVVwZGF0ZSgpfSx0LmlzV2l0aENvbnRlbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gQm9vbGVhbih0aGlzLmdldFRpdGxlKCkpfSx0LmFkZEF0dGFjaG1lbnRDbGFzcz1mdW5jdGlvbih0KXthbih0aGlzLmdldFRpcEVsZW1lbnQoKSkuYWRkQ2xhc3ModW4rIi0iK3QpfSx0LmdldFRpcEVsZW1lbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50aXA9dGhpcy50aXB8fGFuKHRoaXMuY29uZmlnLnRlbXBsYXRlKVswXSx0aGlzLnRpcH0sdC5zZXRDb250ZW50PWZ1bmN0aW9uKCl7dmFyIHQ9YW4odGhpcy5nZXRUaXBFbGVtZW50KCkpO3RoaXMuc2V0RWxlbWVudENvbnRlbnQodC5maW5kKFRuKSx0aGlzLmdldFRpdGxlKCkpLHQucmVtb3ZlQ2xhc3MoeW4rIiAiK2JuKX0sdC5zZXRFbGVtZW50Q29udGVudD1mdW5jdGlvbih0LGUpe3ZhciBuPXRoaXMuY29uZmlnLmh0bWw7Im9iamVjdCI9PXR5cGVvZiBlJiYoZS5ub2RlVHlwZXx8ZS5qcXVlcnkpP24/YW4oZSkucGFyZW50KCkuaXModCl8fHQuZW1wdHkoKS5hcHBlbmQoZSk6dC50ZXh0KGFuKGUpLnRleHQoKSk6dFtuPyJodG1sIjoidGV4dCJdKGUpfSx0LmdldFRpdGxlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgiZGF0YS1vcmlnaW5hbC10aXRsZSIpO3JldHVybiB0fHwodD0iZnVuY3Rpb24iPT10eXBlb2YgdGhpcy5jb25maWcudGl0bGU/dGhpcy5jb25maWcudGl0bGUuY2FsbCh0aGlzLmVsZW1lbnQpOnRoaXMuY29uZmlnLnRpdGxlKSx0fSx0Ll9nZXRBdHRhY2htZW50PWZ1bmN0aW9uKHQpe3JldHVybiBnblt0LnRvVXBwZXJDYXNlKCldfSx0Ll9zZXRMaXN0ZW5lcnM9ZnVuY3Rpb24oKXt2YXIgaT10aGlzO3RoaXMuY29uZmlnLnRyaWdnZXIuc3BsaXQoIiAiKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe2lmKCJjbGljayI9PT10KWFuKGkuZWxlbWVudCkub24oaS5jb25zdHJ1Y3Rvci5FdmVudC5DTElDSyxpLmNvbmZpZy5zZWxlY3RvcixmdW5jdGlvbih0KXtyZXR1cm4gaS50b2dnbGUodCl9KTtlbHNlIGlmKHQhPT1Bbil7dmFyIGU9dD09PXduP2kuY29uc3RydWN0b3IuRXZlbnQuTU9VU0VFTlRFUjppLmNvbnN0cnVjdG9yLkV2ZW50LkZPQ1VTSU4sbj10PT09d24/aS5jb25zdHJ1Y3Rvci5FdmVudC5NT1VTRUxFQVZFOmkuY29uc3RydWN0b3IuRXZlbnQuRk9DVVNPVVQ7YW4oaS5lbGVtZW50KS5vbihlLGkuY29uZmlnLnNlbGVjdG9yLGZ1bmN0aW9uKHQpe3JldHVybiBpLl9lbnRlcih0KX0pLm9uKG4saS5jb25maWcuc2VsZWN0b3IsZnVuY3Rpb24odCl7cmV0dXJuIGkuX2xlYXZlKHQpfSl9YW4oaS5lbGVtZW50KS5jbG9zZXN0KCIubW9kYWwiKS5vbigiaGlkZS5icy5tb2RhbCIsZnVuY3Rpb24oKXtyZXR1cm4gaS5oaWRlKCl9KX0pLHRoaXMuY29uZmlnLnNlbGVjdG9yP3RoaXMuY29uZmlnPWMoe30sdGhpcy5jb25maWcse3RyaWdnZXI6Im1hbnVhbCIsc2VsZWN0b3I6IiJ9KTp0aGlzLl9maXhUaXRsZSgpfSx0Ll9maXhUaXRsZT1mdW5jdGlvbigpe3ZhciB0PXR5cGVvZiB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCJkYXRhLW9yaWdpbmFsLXRpdGxlIik7KHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoInRpdGxlIil8fCJzdHJpbmciIT09dCkmJih0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKCJkYXRhLW9yaWdpbmFsLXRpdGxlIix0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCJ0aXRsZSIpfHwiIiksdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZSgidGl0bGUiLCIiKSl9LHQuX2VudGVyPWZ1bmN0aW9uKHQsZSl7dmFyIG49dGhpcy5jb25zdHJ1Y3Rvci5EQVRBX0tFWTsoZT1lfHxhbih0LmN1cnJlbnRUYXJnZXQpLmRhdGEobikpfHwoZT1uZXcgdGhpcy5jb25zdHJ1Y3Rvcih0LmN1cnJlbnRUYXJnZXQsdGhpcy5fZ2V0RGVsZWdhdGVDb25maWcoKSksYW4odC5jdXJyZW50VGFyZ2V0KS5kYXRhKG4sZSkpLHQmJihlLl9hY3RpdmVUcmlnZ2VyWyJmb2N1c2luIj09PXQudHlwZT9Jbjp3bl09ITApLGFuKGUuZ2V0VGlwRWxlbWVudCgpKS5oYXNDbGFzcyhibil8fGUuX2hvdmVyU3RhdGU9PT1fbj9lLl9ob3ZlclN0YXRlPV9uOihjbGVhclRpbWVvdXQoZS5fdGltZW91dCksZS5faG92ZXJTdGF0ZT1fbixlLmNvbmZpZy5kZWxheSYmZS5jb25maWcuZGVsYXkuc2hvdz9lLl90aW1lb3V0PXNldFRpbWVvdXQoZnVuY3Rpb24oKXtlLl9ob3ZlclN0YXRlPT09X24mJmUuc2hvdygpfSxlLmNvbmZpZy5kZWxheS5zaG93KTplLnNob3coKSl9LHQuX2xlYXZlPWZ1bmN0aW9uKHQsZSl7dmFyIG49dGhpcy5jb25zdHJ1Y3Rvci5EQVRBX0tFWTsoZT1lfHxhbih0LmN1cnJlbnRUYXJnZXQpLmRhdGEobikpfHwoZT1uZXcgdGhpcy5jb25zdHJ1Y3Rvcih0LmN1cnJlbnRUYXJnZXQsdGhpcy5fZ2V0RGVsZWdhdGVDb25maWcoKSksYW4odC5jdXJyZW50VGFyZ2V0KS5kYXRhKG4sZSkpLHQmJihlLl9hY3RpdmVUcmlnZ2VyWyJmb2N1c291dCI9PT10LnR5cGU/SW46d25dPSExKSxlLl9pc1dpdGhBY3RpdmVUcmlnZ2VyKCl8fChjbGVhclRpbWVvdXQoZS5fdGltZW91dCksZS5faG92ZXJTdGF0ZT12bixlLmNvbmZpZy5kZWxheSYmZS5jb25maWcuZGVsYXkuaGlkZT9lLl90aW1lb3V0PXNldFRpbWVvdXQoZnVuY3Rpb24oKXtlLl9ob3ZlclN0YXRlPT09dm4mJmUuaGlkZSgpfSxlLmNvbmZpZy5kZWxheS5oaWRlKTplLmhpZGUoKSl9LHQuX2lzV2l0aEFjdGl2ZVRyaWdnZXI9ZnVuY3Rpb24oKXtmb3IodmFyIHQgaW4gdGhpcy5fYWN0aXZlVHJpZ2dlcilpZih0aGlzLl9hY3RpdmVUcmlnZ2VyW3RdKXJldHVybiEwO3JldHVybiExfSx0Ll9nZXRDb25maWc9ZnVuY3Rpb24odCl7cmV0dXJuIm51bWJlciI9PXR5cGVvZih0PWMoe30sdGhpcy5jb25zdHJ1Y3Rvci5EZWZhdWx0LGFuKHRoaXMuZWxlbWVudCkuZGF0YSgpLCJvYmplY3QiPT10eXBlb2YgdCYmdD90Ont9KSkuZGVsYXkmJih0LmRlbGF5PXtzaG93OnQuZGVsYXksaGlkZTp0LmRlbGF5fSksIm51bWJlciI9PXR5cGVvZiB0LnRpdGxlJiYodC50aXRsZT10LnRpdGxlLnRvU3RyaW5nKCkpLCJudW1iZXIiPT10eXBlb2YgdC5jb250ZW50JiYodC5jb250ZW50PXQuY29udGVudC50b1N0cmluZygpKSxndC50eXBlQ2hlY2tDb25maWcobG4sdCx0aGlzLmNvbnN0cnVjdG9yLkRlZmF1bHRUeXBlKSx0fSx0Ll9nZXREZWxlZ2F0ZUNvbmZpZz1mdW5jdGlvbigpe3ZhciB0PXt9O2lmKHRoaXMuY29uZmlnKWZvcih2YXIgZSBpbiB0aGlzLmNvbmZpZyl0aGlzLmNvbnN0cnVjdG9yLkRlZmF1bHRbZV0hPT10aGlzLmNvbmZpZ1tlXSYmKHRbZV09dGhpcy5jb25maWdbZV0pO3JldHVybiB0fSx0Ll9jbGVhblRpcENsYXNzPWZ1bmN0aW9uKCl7dmFyIHQ9YW4odGhpcy5nZXRUaXBFbGVtZW50KCkpLGU9dC5hdHRyKCJjbGFzcyIpLm1hdGNoKGRuKTtudWxsIT09ZSYmMDxlLmxlbmd0aCYmdC5yZW1vdmVDbGFzcyhlLmpvaW4oIiIpKX0sdC5faGFuZGxlUG9wcGVyUGxhY2VtZW50Q2hhbmdlPWZ1bmN0aW9uKHQpe3RoaXMuX2NsZWFuVGlwQ2xhc3MoKSx0aGlzLmFkZEF0dGFjaG1lbnRDbGFzcyh0aGlzLl9nZXRBdHRhY2htZW50KHQucGxhY2VtZW50KSl9LHQuX2ZpeFRyYW5zaXRpb249ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldFRpcEVsZW1lbnQoKSxlPXRoaXMuY29uZmlnLmFuaW1hdGlvbjtudWxsPT09dC5nZXRBdHRyaWJ1dGUoIngtcGxhY2VtZW50IikmJihhbih0KS5yZW1vdmVDbGFzcyh5biksdGhpcy5jb25maWcuYW5pbWF0aW9uPSExLHRoaXMuaGlkZSgpLHRoaXMuc2hvdygpLHRoaXMuY29uZmlnLmFuaW1hdGlvbj1lKX0saS5falF1ZXJ5SW50ZXJmYWNlPWZ1bmN0aW9uKG4pe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdD1hbih0aGlzKS5kYXRhKGNuKSxlPSJvYmplY3QiPT10eXBlb2YgbiYmbjtpZigodHx8IS9kaXNwb3NlfGhpZGUvLnRlc3QobikpJiYodHx8KHQ9bmV3IGkodGhpcyxlKSxhbih0aGlzKS5kYXRhKGNuLHQpKSwic3RyaW5nIj09dHlwZW9mIG4pKXtpZigidW5kZWZpbmVkIj09dHlwZW9mIHRbbl0pdGhyb3cgbmV3IFR5cGVFcnJvcignTm8gbWV0aG9kIG5hbWVkICInK24rJyInKTt0W25dKCl9fSl9LHMoaSxudWxsLFt7a2V5OiJWRVJTSU9OIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4iNC4xLjEifX0se2tleToiRGVmYXVsdCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIG1ufX0se2tleToiTkFNRSIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGxufX0se2tleToiREFUQV9LRVkiLGdldDpmdW5jdGlvbigpe3JldHVybiBjbn19LHtrZXk6IkV2ZW50IixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gRW59fSx7a2V5OiJFVkVOVF9LRVkiLGdldDpmdW5jdGlvbigpe3JldHVybiBmbn19LHtrZXk6IkRlZmF1bHRUeXBlIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gcG59fV0pLGl9KCksYW4uZm5bbG5dPVNuLl9qUXVlcnlJbnRlcmZhY2UsYW4uZm5bbG5dLkNvbnN0cnVjdG9yPVNuLGFuLmZuW2xuXS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cmV0dXJuIGFuLmZuW2xuXT1obixTbi5falF1ZXJ5SW50ZXJmYWNlfSxTbiksSWk9KE5uPSJwb3BvdmVyIixMbj0iLiIrKGtuPSJicy5wb3BvdmVyIiksUG49KE9uPWUpLmZuW05uXSx4bj0iYnMtcG9wb3ZlciIsam49bmV3IFJlZ0V4cCgiKF58XFxzKSIreG4rIlxcUysiLCJnIiksTW49Yyh7fSx3aS5EZWZhdWx0LHtwbGFjZW1lbnQ6InJpZ2h0Iix0cmlnZ2VyOiJjbGljayIsY29udGVudDoiIix0ZW1wbGF0ZTonPGRpdiBjbGFzcz0icG9wb3ZlciIgcm9sZT0idG9vbHRpcCI+PGRpdiBjbGFzcz0iYXJyb3ciPjwvZGl2PjxoMyBjbGFzcz0icG9wb3Zlci1oZWFkZXIiPjwvaDM+PGRpdiBjbGFzcz0icG9wb3Zlci1ib2R5Ij48L2Rpdj48L2Rpdj4nfSksUm49Yyh7fSx3aS5EZWZhdWx0VHlwZSx7Y29udGVudDoiKHN0cmluZ3xlbGVtZW50fGZ1bmN0aW9uKSJ9KSxIbj0iZmFkZSIsRm49Ii5wb3BvdmVyLWhlYWRlciIsVW49Ii5wb3BvdmVyLWJvZHkiLEJuPXtISURFOiJoaWRlIitMbixISURERU46ImhpZGRlbiIrTG4sU0hPVzooV249InNob3ciKStMbixTSE9XTjoic2hvd24iK0xuLElOU0VSVEVEOiJpbnNlcnRlZCIrTG4sQ0xJQ0s6ImNsaWNrIitMbixGT0NVU0lOOiJmb2N1c2luIitMbixGT0NVU09VVDoiZm9jdXNvdXQiK0xuLE1PVVNFRU5URVI6Im1vdXNlZW50ZXIiK0xuLE1PVVNFTEVBVkU6Im1vdXNlbGVhdmUiK0xufSxLbj1mdW5jdGlvbih0KXt2YXIgZSxuO2Z1bmN0aW9uIGkoKXtyZXR1cm4gdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl8fHRoaXN9bj10LChlPWkpLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG4ucHJvdG90eXBlKSwoZS5wcm90b3R5cGUuY29uc3RydWN0b3I9ZSkuX19wcm90b19fPW47dmFyIHI9aS5wcm90b3R5cGU7cmV0dXJuIHIuaXNXaXRoQ29udGVudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFRpdGxlKCl8fHRoaXMuX2dldENvbnRlbnQoKX0sci5hZGRBdHRhY2htZW50Q2xhc3M9ZnVuY3Rpb24odCl7T24odGhpcy5nZXRUaXBFbGVtZW50KCkpLmFkZENsYXNzKHhuKyItIit0KX0sci5nZXRUaXBFbGVtZW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudGlwPXRoaXMudGlwfHxPbih0aGlzLmNvbmZpZy50ZW1wbGF0ZSlbMF0sdGhpcy50aXB9LHIuc2V0Q29udGVudD1mdW5jdGlvbigpe3ZhciB0PU9uKHRoaXMuZ2V0VGlwRWxlbWVudCgpKTt0aGlzLnNldEVsZW1lbnRDb250ZW50KHQuZmluZChGbiksdGhpcy5nZXRUaXRsZSgpKTt2YXIgZT10aGlzLl9nZXRDb250ZW50KCk7ImZ1bmN0aW9uIj09dHlwZW9mIGUmJihlPWUuY2FsbCh0aGlzLmVsZW1lbnQpKSx0aGlzLnNldEVsZW1lbnRDb250ZW50KHQuZmluZChVbiksZSksdC5yZW1vdmVDbGFzcyhIbisiICIrV24pfSxyLl9nZXRDb250ZW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoImRhdGEtY29udGVudCIpfHx0aGlzLmNvbmZpZy5jb250ZW50fSxyLl9jbGVhblRpcENsYXNzPWZ1bmN0aW9uKCl7dmFyIHQ9T24odGhpcy5nZXRUaXBFbGVtZW50KCkpLGU9dC5hdHRyKCJjbGFzcyIpLm1hdGNoKGpuKTtudWxsIT09ZSYmMDxlLmxlbmd0aCYmdC5yZW1vdmVDbGFzcyhlLmpvaW4oIiIpKX0saS5falF1ZXJ5SW50ZXJmYWNlPWZ1bmN0aW9uKG4pe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdD1Pbih0aGlzKS5kYXRhKGtuKSxlPSJvYmplY3QiPT10eXBlb2Ygbj9uOm51bGw7aWYoKHR8fCEvZGVzdHJveXxoaWRlLy50ZXN0KG4pKSYmKHR8fCh0PW5ldyBpKHRoaXMsZSksT24odGhpcykuZGF0YShrbix0KSksInN0cmluZyI9PXR5cGVvZiBuKSl7aWYoInVuZGVmaW5lZCI9PXR5cGVvZiB0W25dKXRocm93IG5ldyBUeXBlRXJyb3IoJ05vIG1ldGhvZCBuYW1lZCAiJytuKyciJyk7dFtuXSgpfX0pfSxzKGksbnVsbCxbe2tleToiVkVSU0lPTiIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIjQuMS4xIn19LHtrZXk6IkRlZmF1bHQiLGdldDpmdW5jdGlvbigpe3JldHVybiBNbn19LHtrZXk6Ik5BTUUiLGdldDpmdW5jdGlvbigpe3JldHVybiBObn19LHtrZXk6IkRBVEFfS0VZIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4ga259fSx7a2V5OiJFdmVudCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIEJufX0se2tleToiRVZFTlRfS0VZIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gTG59fSx7a2V5OiJEZWZhdWx0VHlwZSIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIFJufX1dKSxpfSh3aSksT24uZm5bTm5dPUtuLl9qUXVlcnlJbnRlcmZhY2UsT24uZm5bTm5dLkNvbnN0cnVjdG9yPUtuLE9uLmZuW05uXS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cmV0dXJuIE9uLmZuW05uXT1QbixLbi5falF1ZXJ5SW50ZXJmYWNlfSxLbiksRGk9KFFuPSJzY3JvbGxzcHkiLEduPSIuIisoWW49ImJzLnNjcm9sbHNweSIpLHFuPShWbj1lKS5mbltRbl0sem49e29mZnNldDoxMCxtZXRob2Q6ImF1dG8iLHRhcmdldDoiIn0sWG49e29mZnNldDoibnVtYmVyIixtZXRob2Q6InN0cmluZyIsdGFyZ2V0OiIoc3RyaW5nfGVsZW1lbnQpIn0sSm49e0FDVElWQVRFOiJhY3RpdmF0ZSIrR24sU0NST0xMOiJzY3JvbGwiK0duLExPQURfREFUQV9BUEk6ImxvYWQiK0duKyIuZGF0YS1hcGkifSxabj0iZHJvcGRvd24taXRlbSIsJG49ImFjdGl2ZSIsdGk9e0RBVEFfU1BZOidbZGF0YS1zcHk9InNjcm9sbCJdJyxBQ1RJVkU6Ii5hY3RpdmUiLE5BVl9MSVNUX0dST1VQOiIubmF2LCAubGlzdC1ncm91cCIsTkFWX0xJTktTOiIubmF2LWxpbmsiLE5BVl9JVEVNUzoiLm5hdi1pdGVtIixMSVNUX0lURU1TOiIubGlzdC1ncm91cC1pdGVtIixEUk9QRE9XTjoiLmRyb3Bkb3duIixEUk9QRE9XTl9JVEVNUzoiLmRyb3Bkb3duLWl0ZW0iLERST1BET1dOX1RPR0dMRToiLmRyb3Bkb3duLXRvZ2dsZSJ9LGVpPSJvZmZzZXQiLG5pPSJwb3NpdGlvbiIsaWk9ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKHQsZSl7dmFyIG49dGhpczt0aGlzLl9lbGVtZW50PXQsdGhpcy5fc2Nyb2xsRWxlbWVudD0iQk9EWSI9PT10LnRhZ05hbWU/d2luZG93OnQsdGhpcy5fY29uZmlnPXRoaXMuX2dldENvbmZpZyhlKSx0aGlzLl9zZWxlY3Rvcj10aGlzLl9jb25maWcudGFyZ2V0KyIgIit0aS5OQVZfTElOS1MrIiwiK3RoaXMuX2NvbmZpZy50YXJnZXQrIiAiK3RpLkxJU1RfSVRFTVMrIiwiK3RoaXMuX2NvbmZpZy50YXJnZXQrIiAiK3RpLkRST1BET1dOX0lURU1TLHRoaXMuX29mZnNldHM9W10sdGhpcy5fdGFyZ2V0cz1bXSx0aGlzLl9hY3RpdmVUYXJnZXQ9bnVsbCx0aGlzLl9zY3JvbGxIZWlnaHQ9MCxWbih0aGlzLl9zY3JvbGxFbGVtZW50KS5vbihKbi5TQ1JPTEwsZnVuY3Rpb24odCl7cmV0dXJuIG4uX3Byb2Nlc3ModCl9KSx0aGlzLnJlZnJlc2goKSx0aGlzLl9wcm9jZXNzKCl9dmFyIHQ9bi5wcm90b3R5cGU7cmV0dXJuIHQucmVmcmVzaD1mdW5jdGlvbigpe3ZhciBlPXRoaXMsdD10aGlzLl9zY3JvbGxFbGVtZW50PT09dGhpcy5fc2Nyb2xsRWxlbWVudC53aW5kb3c/ZWk6bmkscj0iYXV0byI9PT10aGlzLl9jb25maWcubWV0aG9kP3Q6dGhpcy5fY29uZmlnLm1ldGhvZCxvPXI9PT1uaT90aGlzLl9nZXRTY3JvbGxUb3AoKTowO3RoaXMuX29mZnNldHM9W10sdGhpcy5fdGFyZ2V0cz1bXSx0aGlzLl9zY3JvbGxIZWlnaHQ9dGhpcy5fZ2V0U2Nyb2xsSGVpZ2h0KCksVm4ubWFrZUFycmF5KFZuKHRoaXMuX3NlbGVjdG9yKSkubWFwKGZ1bmN0aW9uKHQpe3ZhciBlLG49Z3QuZ2V0U2VsZWN0b3JGcm9tRWxlbWVudCh0KTtpZihuJiYoZT1WbihuKVswXSksZSl7dmFyIGk9ZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtpZihpLndpZHRofHxpLmhlaWdodClyZXR1cm5bVm4oZSlbcl0oKS50b3ArbyxuXX1yZXR1cm4gbnVsbH0pLmZpbHRlcihmdW5jdGlvbih0KXtyZXR1cm4gdH0pLnNvcnQoZnVuY3Rpb24odCxlKXtyZXR1cm4gdFswXS1lWzBdfSkuZm9yRWFjaChmdW5jdGlvbih0KXtlLl9vZmZzZXRzLnB1c2godFswXSksZS5fdGFyZ2V0cy5wdXNoKHRbMV0pfSl9LHQuZGlzcG9zZT1mdW5jdGlvbigpe1ZuLnJlbW92ZURhdGEodGhpcy5fZWxlbWVudCxZbiksVm4odGhpcy5fc2Nyb2xsRWxlbWVudCkub2ZmKEduKSx0aGlzLl9lbGVtZW50PW51bGwsdGhpcy5fc2Nyb2xsRWxlbWVudD1udWxsLHRoaXMuX2NvbmZpZz1udWxsLHRoaXMuX3NlbGVjdG9yPW51bGwsdGhpcy5fb2Zmc2V0cz1udWxsLHRoaXMuX3RhcmdldHM9bnVsbCx0aGlzLl9hY3RpdmVUYXJnZXQ9bnVsbCx0aGlzLl9zY3JvbGxIZWlnaHQ9bnVsbH0sdC5fZ2V0Q29uZmlnPWZ1bmN0aW9uKHQpe2lmKCJzdHJpbmciIT10eXBlb2YodD1jKHt9LHpuLCJvYmplY3QiPT10eXBlb2YgdCYmdD90Ont9KSkudGFyZ2V0KXt2YXIgZT1Wbih0LnRhcmdldCkuYXR0cigiaWQiKTtlfHwoZT1ndC5nZXRVSUQoUW4pLFZuKHQudGFyZ2V0KS5hdHRyKCJpZCIsZSkpLHQudGFyZ2V0PSIjIitlfXJldHVybiBndC50eXBlQ2hlY2tDb25maWcoUW4sdCxYbiksdH0sdC5fZ2V0U2Nyb2xsVG9wPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Njcm9sbEVsZW1lbnQ9PT13aW5kb3c/dGhpcy5fc2Nyb2xsRWxlbWVudC5wYWdlWU9mZnNldDp0aGlzLl9zY3JvbGxFbGVtZW50LnNjcm9sbFRvcH0sdC5fZ2V0U2Nyb2xsSGVpZ2h0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Njcm9sbEVsZW1lbnQuc2Nyb2xsSGVpZ2h0fHxNYXRoLm1heChkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodCxkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsSGVpZ2h0KX0sdC5fZ2V0T2Zmc2V0SGVpZ2h0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Njcm9sbEVsZW1lbnQ9PT13aW5kb3c/d2luZG93LmlubmVySGVpZ2h0OnRoaXMuX3Njcm9sbEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0fSx0Ll9wcm9jZXNzPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fZ2V0U2Nyb2xsVG9wKCkrdGhpcy5fY29uZmlnLm9mZnNldCxlPXRoaXMuX2dldFNjcm9sbEhlaWdodCgpLG49dGhpcy5fY29uZmlnLm9mZnNldCtlLXRoaXMuX2dldE9mZnNldEhlaWdodCgpO2lmKHRoaXMuX3Njcm9sbEhlaWdodCE9PWUmJnRoaXMucmVmcmVzaCgpLG48PXQpe3ZhciBpPXRoaXMuX3RhcmdldHNbdGhpcy5fdGFyZ2V0cy5sZW5ndGgtMV07dGhpcy5fYWN0aXZlVGFyZ2V0IT09aSYmdGhpcy5fYWN0aXZhdGUoaSl9ZWxzZXtpZih0aGlzLl9hY3RpdmVUYXJnZXQmJnQ8dGhpcy5fb2Zmc2V0c1swXSYmMDx0aGlzLl9vZmZzZXRzWzBdKXJldHVybiB0aGlzLl9hY3RpdmVUYXJnZXQ9bnVsbCx2b2lkIHRoaXMuX2NsZWFyKCk7Zm9yKHZhciByPXRoaXMuX29mZnNldHMubGVuZ3RoO3ItLTspe3RoaXMuX2FjdGl2ZVRhcmdldCE9PXRoaXMuX3RhcmdldHNbcl0mJnQ+PXRoaXMuX29mZnNldHNbcl0mJigidW5kZWZpbmVkIj09dHlwZW9mIHRoaXMuX29mZnNldHNbcisxXXx8dDx0aGlzLl9vZmZzZXRzW3IrMV0pJiZ0aGlzLl9hY3RpdmF0ZSh0aGlzLl90YXJnZXRzW3JdKX19fSx0Ll9hY3RpdmF0ZT1mdW5jdGlvbihlKXt0aGlzLl9hY3RpdmVUYXJnZXQ9ZSx0aGlzLl9jbGVhcigpO3ZhciB0PXRoaXMuX3NlbGVjdG9yLnNwbGl0KCIsIik7dD10Lm1hcChmdW5jdGlvbih0KXtyZXR1cm4gdCsnW2RhdGEtdGFyZ2V0PSInK2UrJyJdLCcrdCsnW2hyZWY9IicrZSsnIl0nfSk7dmFyIG49Vm4odC5qb2luKCIsIikpO24uaGFzQ2xhc3MoWm4pPyhuLmNsb3Nlc3QodGkuRFJPUERPV04pLmZpbmQodGkuRFJPUERPV05fVE9HR0xFKS5hZGRDbGFzcygkbiksbi5hZGRDbGFzcygkbikpOihuLmFkZENsYXNzKCRuKSxuLnBhcmVudHModGkuTkFWX0xJU1RfR1JPVVApLnByZXYodGkuTkFWX0xJTktTKyIsICIrdGkuTElTVF9JVEVNUykuYWRkQ2xhc3MoJG4pLG4ucGFyZW50cyh0aS5OQVZfTElTVF9HUk9VUCkucHJldih0aS5OQVZfSVRFTVMpLmNoaWxkcmVuKHRpLk5BVl9MSU5LUykuYWRkQ2xhc3MoJG4pKSxWbih0aGlzLl9zY3JvbGxFbGVtZW50KS50cmlnZ2VyKEpuLkFDVElWQVRFLHtyZWxhdGVkVGFyZ2V0OmV9KX0sdC5fY2xlYXI9ZnVuY3Rpb24oKXtWbih0aGlzLl9zZWxlY3RvcikuZmlsdGVyKHRpLkFDVElWRSkucmVtb3ZlQ2xhc3MoJG4pfSxuLl9qUXVlcnlJbnRlcmZhY2U9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciB0PVZuKHRoaXMpLmRhdGEoWW4pO2lmKHR8fCh0PW5ldyBuKHRoaXMsIm9iamVjdCI9PXR5cGVvZiBlJiZlKSxWbih0aGlzKS5kYXRhKFluLHQpKSwic3RyaW5nIj09dHlwZW9mIGUpe2lmKCJ1bmRlZmluZWQiPT10eXBlb2YgdFtlXSl0aHJvdyBuZXcgVHlwZUVycm9yKCdObyBtZXRob2QgbmFtZWQgIicrZSsnIicpO3RbZV0oKX19KX0scyhuLG51bGwsW3trZXk6IlZFUlNJT04iLGdldDpmdW5jdGlvbigpe3JldHVybiI0LjEuMSJ9fSx7a2V5OiJEZWZhdWx0IixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gem59fV0pLG59KCksVm4od2luZG93KS5vbihKbi5MT0FEX0RBVEFfQVBJLGZ1bmN0aW9uKCl7Zm9yKHZhciB0PVZuLm1ha2VBcnJheShWbih0aS5EQVRBX1NQWSkpLGU9dC5sZW5ndGg7ZS0tOyl7dmFyIG49Vm4odFtlXSk7aWkuX2pRdWVyeUludGVyZmFjZS5jYWxsKG4sbi5kYXRhKCkpfX0pLFZuLmZuW1FuXT1paS5falF1ZXJ5SW50ZXJmYWNlLFZuLmZuW1FuXS5Db25zdHJ1Y3Rvcj1paSxWbi5mbltRbl0ubm9Db25mbGljdD1mdW5jdGlvbigpe3JldHVybiBWbi5mbltRbl09cW4saWkuX2pRdWVyeUludGVyZmFjZX0saWkpLEFpPShzaT0iLiIrKG9pPSJicy50YWIiKSxhaT0ocmk9ZSkuZm4udGFiLGxpPXtISURFOiJoaWRlIitzaSxISURERU46ImhpZGRlbiIrc2ksU0hPVzoic2hvdyIrc2ksU0hPV046InNob3duIitzaSxDTElDS19EQVRBX0FQSToiY2xpY2siK3NpKyIuZGF0YS1hcGkifSxjaT0iZHJvcGRvd24tbWVudSIsZmk9ImFjdGl2ZSIsaGk9ImRpc2FibGVkIix1aT0iZmFkZSIsZGk9InNob3ciLHBpPSIuZHJvcGRvd24iLGdpPSIubmF2LCAubGlzdC1ncm91cCIsbWk9Ii5hY3RpdmUiLF9pPSI+IGxpID4gLmFjdGl2ZSIsdmk9J1tkYXRhLXRvZ2dsZT0idGFiIl0sIFtkYXRhLXRvZ2dsZT0icGlsbCJdLCBbZGF0YS10b2dnbGU9Imxpc3QiXScsRWk9Ii5kcm9wZG93bi10b2dnbGUiLHlpPSI+IC5kcm9wZG93bi1tZW51IC5hY3RpdmUiLGJpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gaSh0KXt0aGlzLl9lbGVtZW50PXR9dmFyIHQ9aS5wcm90b3R5cGU7cmV0dXJuIHQuc2hvdz1mdW5jdGlvbigpe3ZhciBuPXRoaXM7aWYoISh0aGlzLl9lbGVtZW50LnBhcmVudE5vZGUmJnRoaXMuX2VsZW1lbnQucGFyZW50Tm9kZS5ub2RlVHlwZT09PU5vZGUuRUxFTUVOVF9OT0RFJiZyaSh0aGlzLl9lbGVtZW50KS5oYXNDbGFzcyhmaSl8fHJpKHRoaXMuX2VsZW1lbnQpLmhhc0NsYXNzKGhpKSkpe3ZhciB0LGksZT1yaSh0aGlzLl9lbGVtZW50KS5jbG9zZXN0KGdpKVswXSxyPWd0LmdldFNlbGVjdG9yRnJvbUVsZW1lbnQodGhpcy5fZWxlbWVudCk7aWYoZSl7dmFyIG89IlVMIj09PWUubm9kZU5hbWU/X2k6bWk7aT0oaT1yaS5tYWtlQXJyYXkocmkoZSkuZmluZChvKSkpW2kubGVuZ3RoLTFdfXZhciBzPXJpLkV2ZW50KGxpLkhJREUse3JlbGF0ZWRUYXJnZXQ6dGhpcy5fZWxlbWVudH0pLGE9cmkuRXZlbnQobGkuU0hPVyx7cmVsYXRlZFRhcmdldDppfSk7aWYoaSYmcmkoaSkudHJpZ2dlcihzKSxyaSh0aGlzLl9lbGVtZW50KS50cmlnZ2VyKGEpLCFhLmlzRGVmYXVsdFByZXZlbnRlZCgpJiYhcy5pc0RlZmF1bHRQcmV2ZW50ZWQoKSl7ciYmKHQ9cmkocilbMF0pLHRoaXMuX2FjdGl2YXRlKHRoaXMuX2VsZW1lbnQsZSk7dmFyIGw9ZnVuY3Rpb24oKXt2YXIgdD1yaS5FdmVudChsaS5ISURERU4se3JlbGF0ZWRUYXJnZXQ6bi5fZWxlbWVudH0pLGU9cmkuRXZlbnQobGkuU0hPV04se3JlbGF0ZWRUYXJnZXQ6aX0pO3JpKGkpLnRyaWdnZXIodCkscmkobi5fZWxlbWVudCkudHJpZ2dlcihlKX07dD90aGlzLl9hY3RpdmF0ZSh0LHQucGFyZW50Tm9kZSxsKTpsKCl9fX0sdC5kaXNwb3NlPWZ1bmN0aW9uKCl7cmkucmVtb3ZlRGF0YSh0aGlzLl9lbGVtZW50LG9pKSx0aGlzLl9lbGVtZW50PW51bGx9LHQuX2FjdGl2YXRlPWZ1bmN0aW9uKHQsZSxuKXt2YXIgaT10aGlzLHI9KCJVTCI9PT1lLm5vZGVOYW1lP3JpKGUpLmZpbmQoX2kpOnJpKGUpLmNoaWxkcmVuKG1pKSlbMF0sbz1uJiZyJiZyaShyKS5oYXNDbGFzcyh1aSkscz1mdW5jdGlvbigpe3JldHVybiBpLl90cmFuc2l0aW9uQ29tcGxldGUodCxyLG4pfTtpZihyJiZvKXt2YXIgYT1ndC5nZXRUcmFuc2l0aW9uRHVyYXRpb25Gcm9tRWxlbWVudChyKTtyaShyKS5vbmUoZ3QuVFJBTlNJVElPTl9FTkQscykuZW11bGF0ZVRyYW5zaXRpb25FbmQoYSl9ZWxzZSBzKCl9LHQuX3RyYW5zaXRpb25Db21wbGV0ZT1mdW5jdGlvbih0LGUsbil7aWYoZSl7cmkoZSkucmVtb3ZlQ2xhc3MoZGkrIiAiK2ZpKTt2YXIgaT1yaShlLnBhcmVudE5vZGUpLmZpbmQoeWkpWzBdO2kmJnJpKGkpLnJlbW92ZUNsYXNzKGZpKSwidGFiIj09PWUuZ2V0QXR0cmlidXRlKCJyb2xlIikmJmUuc2V0QXR0cmlidXRlKCJhcmlhLXNlbGVjdGVkIiwhMSl9aWYocmkodCkuYWRkQ2xhc3MoZmkpLCJ0YWIiPT09dC5nZXRBdHRyaWJ1dGUoInJvbGUiKSYmdC5zZXRBdHRyaWJ1dGUoImFyaWEtc2VsZWN0ZWQiLCEwKSxndC5yZWZsb3codCkscmkodCkuYWRkQ2xhc3MoZGkpLHQucGFyZW50Tm9kZSYmcmkodC5wYXJlbnROb2RlKS5oYXNDbGFzcyhjaSkpe3ZhciByPXJpKHQpLmNsb3Nlc3QocGkpWzBdO3ImJnJpKHIpLmZpbmQoRWkpLmFkZENsYXNzKGZpKSx0LnNldEF0dHJpYnV0ZSgiYXJpYS1leHBhbmRlZCIsITApfW4mJm4oKX0saS5falF1ZXJ5SW50ZXJmYWNlPWZ1bmN0aW9uKG4pe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdD1yaSh0aGlzKSxlPXQuZGF0YShvaSk7aWYoZXx8KGU9bmV3IGkodGhpcyksdC5kYXRhKG9pLGUpKSwic3RyaW5nIj09dHlwZW9mIG4pe2lmKCJ1bmRlZmluZWQiPT10eXBlb2YgZVtuXSl0aHJvdyBuZXcgVHlwZUVycm9yKCdObyBtZXRob2QgbmFtZWQgIicrbisnIicpO2Vbbl0oKX19KX0scyhpLG51bGwsW3trZXk6IlZFUlNJT04iLGdldDpmdW5jdGlvbigpe3JldHVybiI0LjEuMSJ9fV0pLGl9KCkscmkoZG9jdW1lbnQpLm9uKGxpLkNMSUNLX0RBVEFfQVBJLHZpLGZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSxiaS5falF1ZXJ5SW50ZXJmYWNlLmNhbGwocmkodGhpcyksInNob3ciKX0pLHJpLmZuLnRhYj1iaS5falF1ZXJ5SW50ZXJmYWNlLHJpLmZuLnRhYi5Db25zdHJ1Y3Rvcj1iaSxyaS5mbi50YWIubm9Db25mbGljdD1mdW5jdGlvbigpe3JldHVybiByaS5mbi50YWI9YWksYmkuX2pRdWVyeUludGVyZmFjZX0sYmkpOyFmdW5jdGlvbih0KXtpZigidW5kZWZpbmVkIj09dHlwZW9mIHQpdGhyb3cgbmV3IFR5cGVFcnJvcigiQm9vdHN0cmFwJ3MgSmF2YVNjcmlwdCByZXF1aXJlcyBqUXVlcnkuIGpRdWVyeSBtdXN0IGJlIGluY2x1ZGVkIGJlZm9yZSBCb290c3RyYXAncyBKYXZhU2NyaXB0LiIpO3ZhciBlPXQuZm4uanF1ZXJ5LnNwbGl0KCIgIilbMF0uc3BsaXQoIi4iKTtpZihlWzBdPDImJmVbMV08OXx8MT09PWVbMF0mJjk9PT1lWzFdJiZlWzJdPDF8fDQ8PWVbMF0pdGhyb3cgbmV3IEVycm9yKCJCb290c3RyYXAncyBKYXZhU2NyaXB0IHJlcXVpcmVzIGF0IGxlYXN0IGpRdWVyeSB2MS45LjEgYnV0IGxlc3MgdGhhbiB2NC4wLjAiKX0oZSksdC5VdGlsPWd0LHQuQWxlcnQ9bXQsdC5CdXR0b249X3QsdC5DYXJvdXNlbD12dCx0LkNvbGxhcHNlPUV0LHQuRHJvcGRvd249VGksdC5Nb2RhbD1DaSx0LlBvcG92ZXI9SWksdC5TY3JvbGxzcHk9RGksdC5UYWI9QWksdC5Ub29sdGlwPXdpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KX0pOwoNCi8qIQ0KICogVnVlLmpzIHYyLjUuMTMNCiAqIChjKSAyMDE0LTIwMTcgRXZhbiBZb3UNCiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4NCiAqLw0KIWZ1bmN0aW9uKHQsZSl7Im9iamVjdCI9PXR5cGVvZiBleHBvcnRzJiYidW5kZWZpbmVkIiE9dHlwZW9mIG1vZHVsZT9tb2R1bGUuZXhwb3J0cz1lKCk6ImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoZSk6dC5WdWU9ZSgpfSh0aGlzLGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHQodCl7cmV0dXJuIHZvaWQgMD09PXR8fG51bGw9PT10fWZ1bmN0aW9uIGUodCl7cmV0dXJuIHZvaWQgMCE9PXQmJm51bGwhPT10fWZ1bmN0aW9uIG4odCl7cmV0dXJuITA9PT10fWZ1bmN0aW9uIHIodCl7cmV0dXJuInN0cmluZyI9PXR5cGVvZiB0fHwibnVtYmVyIj09dHlwZW9mIHR8fCJzeW1ib2wiPT10eXBlb2YgdHx8ImJvb2xlYW4iPT10eXBlb2YgdH1mdW5jdGlvbiBpKHQpe3JldHVybiBudWxsIT09dCYmIm9iamVjdCI9PXR5cGVvZiB0fWZ1bmN0aW9uIG8odCl7cmV0dXJuIltvYmplY3QgT2JqZWN0XSI9PT1Obi5jYWxsKHQpfWZ1bmN0aW9uIGEodCl7dmFyIGU9cGFyc2VGbG9hdChTdHJpbmcodCkpO3JldHVybiBlPj0wJiZNYXRoLmZsb29yKGUpPT09ZSYmaXNGaW5pdGUodCl9ZnVuY3Rpb24gcyh0KXtyZXR1cm4gbnVsbD09dD8iIjoib2JqZWN0Ij09dHlwZW9mIHQ/SlNPTi5zdHJpbmdpZnkodCxudWxsLDIpOlN0cmluZyh0KX1mdW5jdGlvbiBjKHQpe3ZhciBlPXBhcnNlRmxvYXQodCk7cmV0dXJuIGlzTmFOKGUpP3Q6ZX1mdW5jdGlvbiB1KHQsZSl7Zm9yKHZhciBuPU9iamVjdC5jcmVhdGUobnVsbCkscj10LnNwbGl0KCIsIiksaT0wO2k8ci5sZW5ndGg7aSsrKW5bcltpXV09ITA7cmV0dXJuIGU/ZnVuY3Rpb24odCl7cmV0dXJuIG5bdC50b0xvd2VyQ2FzZSgpXX06ZnVuY3Rpb24odCl7cmV0dXJuIG5bdF19fWZ1bmN0aW9uIGwodCxlKXtpZih0Lmxlbmd0aCl7dmFyIG49dC5pbmRleE9mKGUpO2lmKG4+LTEpcmV0dXJuIHQuc3BsaWNlKG4sMSl9fWZ1bmN0aW9uIGYodCxlKXtyZXR1cm4gTW4uY2FsbCh0LGUpfWZ1bmN0aW9uIHAodCl7dmFyIGU9T2JqZWN0LmNyZWF0ZShudWxsKTtyZXR1cm4gZnVuY3Rpb24obil7cmV0dXJuIGVbbl18fChlW25dPXQobikpfX1mdW5jdGlvbiBkKHQsZSl7ZnVuY3Rpb24gbihuKXt2YXIgcj1hcmd1bWVudHMubGVuZ3RoO3JldHVybiByP3I+MT90LmFwcGx5KGUsYXJndW1lbnRzKTp0LmNhbGwoZSxuKTp0LmNhbGwoZSl9cmV0dXJuIG4uX2xlbmd0aD10Lmxlbmd0aCxufWZ1bmN0aW9uIHYodCxlKXtlPWV8fDA7Zm9yKHZhciBuPXQubGVuZ3RoLWUscj1uZXcgQXJyYXkobik7bi0tOylyW25dPXRbbitlXTtyZXR1cm4gcn1mdW5jdGlvbiBoKHQsZSl7Zm9yKHZhciBuIGluIGUpdFtuXT1lW25dO3JldHVybiB0fWZ1bmN0aW9uIG0odCl7Zm9yKHZhciBlPXt9LG49MDtuPHQubGVuZ3RoO24rKyl0W25dJiZoKGUsdFtuXSk7cmV0dXJuIGV9ZnVuY3Rpb24geSh0LGUsbil7fWZ1bmN0aW9uIGcodCxlKXtpZih0PT09ZSlyZXR1cm4hMDt2YXIgbj1pKHQpLHI9aShlKTtpZighbnx8IXIpcmV0dXJuIW4mJiFyJiZTdHJpbmcodCk9PT1TdHJpbmcoZSk7dHJ5e3ZhciBvPUFycmF5LmlzQXJyYXkodCksYT1BcnJheS5pc0FycmF5KGUpO2lmKG8mJmEpcmV0dXJuIHQubGVuZ3RoPT09ZS5sZW5ndGgmJnQuZXZlcnkoZnVuY3Rpb24odCxuKXtyZXR1cm4gZyh0LGVbbl0pfSk7aWYob3x8YSlyZXR1cm4hMTt2YXIgcz1PYmplY3Qua2V5cyh0KSxjPU9iamVjdC5rZXlzKGUpO3JldHVybiBzLmxlbmd0aD09PWMubGVuZ3RoJiZzLmV2ZXJ5KGZ1bmN0aW9uKG4pe3JldHVybiBnKHRbbl0sZVtuXSl9KX1jYXRjaCh0KXtyZXR1cm4hMX19ZnVuY3Rpb24gXyh0LGUpe2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKWlmKGcodFtuXSxlKSlyZXR1cm4gbjtyZXR1cm4tMX1mdW5jdGlvbiBiKHQpe3ZhciBlPSExO3JldHVybiBmdW5jdGlvbigpe2V8fChlPSEwLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpKX19ZnVuY3Rpb24gJCh0KXt2YXIgZT0odCsiIikuY2hhckNvZGVBdCgwKTtyZXR1cm4gMzY9PT1lfHw5NT09PWV9ZnVuY3Rpb24gQyh0LGUsbixyKXtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxlLHt2YWx1ZTpuLGVudW1lcmFibGU6ISFyLHdyaXRhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pfWZ1bmN0aW9uIHcodCl7cmV0dXJuImZ1bmN0aW9uIj09dHlwZW9mIHQmJi9uYXRpdmUgY29kZS8udGVzdCh0LnRvU3RyaW5nKCkpfWZ1bmN0aW9uIHgodCl7cmV0dXJuIG5ldyBtcih2b2lkIDAsdm9pZCAwLHZvaWQgMCxTdHJpbmcodCkpfWZ1bmN0aW9uIGsodCxlKXt2YXIgbj10LmNvbXBvbmVudE9wdGlvbnMscj1uZXcgbXIodC50YWcsdC5kYXRhLHQuY2hpbGRyZW4sdC50ZXh0LHQuZWxtLHQuY29udGV4dCxuLHQuYXN5bmNGYWN0b3J5KTtyZXR1cm4gci5ucz10Lm5zLHIuaXNTdGF0aWM9dC5pc1N0YXRpYyxyLmtleT10LmtleSxyLmlzQ29tbWVudD10LmlzQ29tbWVudCxyLmZuQ29udGV4dD10LmZuQ29udGV4dCxyLmZuT3B0aW9ucz10LmZuT3B0aW9ucyxyLmZuU2NvcGVJZD10LmZuU2NvcGVJZCxyLmlzQ2xvbmVkPSEwLGUmJih0LmNoaWxkcmVuJiYoci5jaGlsZHJlbj1BKHQuY2hpbGRyZW4sITApKSxuJiZuLmNoaWxkcmVuJiYobi5jaGlsZHJlbj1BKG4uY2hpbGRyZW4sITApKSkscn1mdW5jdGlvbiBBKHQsZSl7Zm9yKHZhciBuPXQubGVuZ3RoLHI9bmV3IEFycmF5KG4pLGk9MDtpPG47aSsrKXJbaV09ayh0W2ldLGUpO3JldHVybiByfWZ1bmN0aW9uIE8odCxlLG4pe3QuX19wcm90b19fPWV9ZnVuY3Rpb24gUyh0LGUsbil7Zm9yKHZhciByPTAsaT1uLmxlbmd0aDtyPGk7cisrKXt2YXIgbz1uW3JdO0ModCxvLGVbb10pfX1mdW5jdGlvbiBUKHQsZSl7aWYoaSh0KSYmISh0IGluc3RhbmNlb2YgbXIpKXt2YXIgbjtyZXR1cm4gZih0LCJfX29iX18iKSYmdC5fX29iX18gaW5zdGFuY2VvZiB3cj9uPXQuX19vYl9fOkNyLnNob3VsZENvbnZlcnQmJiF1cigpJiYoQXJyYXkuaXNBcnJheSh0KXx8byh0KSkmJk9iamVjdC5pc0V4dGVuc2libGUodCkmJiF0Ll9pc1Z1ZSYmKG49bmV3IHdyKHQpKSxlJiZuJiZuLnZtQ291bnQrKyxufX1mdW5jdGlvbiBFKHQsZSxuLHIsaSl7dmFyIG89bmV3IHZyLGE9T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0LGUpO2lmKCFhfHwhMSE9PWEuY29uZmlndXJhYmxlKXt2YXIgcz1hJiZhLmdldCxjPWEmJmEuc2V0LHU9IWkmJlQobik7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsZSx7ZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsZ2V0OmZ1bmN0aW9uKCl7dmFyIGU9cz9zLmNhbGwodCk6bjtyZXR1cm4gdnIudGFyZ2V0JiYoby5kZXBlbmQoKSx1JiYodS5kZXAuZGVwZW5kKCksQXJyYXkuaXNBcnJheShlKSYmSShlKSkpLGV9LHNldDpmdW5jdGlvbihlKXt2YXIgcj1zP3MuY2FsbCh0KTpuO2U9PT1yfHxlIT1lJiZyIT1yfHwoYz9jLmNhbGwodCxlKTpuPWUsdT0haSYmVChlKSxvLm5vdGlmeSgpKX19KX19ZnVuY3Rpb24gaih0LGUsbil7aWYoQXJyYXkuaXNBcnJheSh0KSYmYShlKSlyZXR1cm4gdC5sZW5ndGg9TWF0aC5tYXgodC5sZW5ndGgsZSksdC5zcGxpY2UoZSwxLG4pLG47aWYoZSBpbiB0JiYhKGUgaW4gT2JqZWN0LnByb3RvdHlwZSkpcmV0dXJuIHRbZV09bixuO3ZhciByPXQuX19vYl9fO3JldHVybiB0Ll9pc1Z1ZXx8ciYmci52bUNvdW50P246cj8oRShyLnZhbHVlLGUsbiksci5kZXAubm90aWZ5KCksbik6KHRbZV09bixuKX1mdW5jdGlvbiBOKHQsZSl7aWYoQXJyYXkuaXNBcnJheSh0KSYmYShlKSl0LnNwbGljZShlLDEpO2Vsc2V7dmFyIG49dC5fX29iX187dC5faXNWdWV8fG4mJm4udm1Db3VudHx8Zih0LGUpJiYoZGVsZXRlIHRbZV0sbiYmbi5kZXAubm90aWZ5KCkpfX1mdW5jdGlvbiBJKHQpe2Zvcih2YXIgZT12b2lkIDAsbj0wLHI9dC5sZW5ndGg7bjxyO24rKykoZT10W25dKSYmZS5fX29iX18mJmUuX19vYl9fLmRlcC5kZXBlbmQoKSxBcnJheS5pc0FycmF5KGUpJiZJKGUpfWZ1bmN0aW9uIEwodCxlKXtpZighZSlyZXR1cm4gdDtmb3IodmFyIG4scixpLGE9T2JqZWN0LmtleXMoZSkscz0wO3M8YS5sZW5ndGg7cysrKXI9dFtuPWFbc11dLGk9ZVtuXSxmKHQsbik/byhyKSYmbyhpKSYmTChyLGkpOmoodCxuLGkpO3JldHVybiB0fWZ1bmN0aW9uIE0odCxlLG4pe3JldHVybiBuP2Z1bmN0aW9uKCl7dmFyIHI9ImZ1bmN0aW9uIj09dHlwZW9mIGU/ZS5jYWxsKG4sbik6ZSxpPSJmdW5jdGlvbiI9PXR5cGVvZiB0P3QuY2FsbChuLG4pOnQ7cmV0dXJuIHI/TChyLGkpOml9OmU/dD9mdW5jdGlvbigpe3JldHVybiBMKCJmdW5jdGlvbiI9PXR5cGVvZiBlP2UuY2FsbCh0aGlzLHRoaXMpOmUsImZ1bmN0aW9uIj09dHlwZW9mIHQ/dC5jYWxsKHRoaXMsdGhpcyk6dCl9OmU6dH1mdW5jdGlvbiBEKHQsZSl7cmV0dXJuIGU/dD90LmNvbmNhdChlKTpBcnJheS5pc0FycmF5KGUpP2U6W2VdOnR9ZnVuY3Rpb24gUCh0LGUsbixyKXt2YXIgaT1PYmplY3QuY3JlYXRlKHR8fG51bGwpO3JldHVybiBlP2goaSxlKTppfWZ1bmN0aW9uIEYodCxlLG4pe2Z1bmN0aW9uIHIocil7dmFyIGk9eHJbcl18fE9yO3Vbcl09aSh0W3JdLGVbcl0sbixyKX0iZnVuY3Rpb24iPT10eXBlb2YgZSYmKGU9ZS5vcHRpb25zKSxmdW5jdGlvbih0LGUpe3ZhciBuPXQucHJvcHM7aWYobil7dmFyIHIsaSxhPXt9O2lmKEFycmF5LmlzQXJyYXkobikpZm9yKHI9bi5sZW5ndGg7ci0tOykic3RyaW5nIj09dHlwZW9mKGk9bltyXSkmJihhW1BuKGkpXT17dHlwZTpudWxsfSk7ZWxzZSBpZihvKG4pKWZvcih2YXIgcyBpbiBuKWk9bltzXSxhW1BuKHMpXT1vKGkpP2k6e3R5cGU6aX07dC5wcm9wcz1hfX0oZSksZnVuY3Rpb24odCxlKXt2YXIgbj10LmluamVjdDtpZihuKXt2YXIgcj10LmluamVjdD17fTtpZihBcnJheS5pc0FycmF5KG4pKWZvcih2YXIgaT0wO2k8bi5sZW5ndGg7aSsrKXJbbltpXV09e2Zyb206bltpXX07ZWxzZSBpZihvKG4pKWZvcih2YXIgYSBpbiBuKXt2YXIgcz1uW2FdO3JbYV09byhzKT9oKHtmcm9tOmF9LHMpOntmcm9tOnN9fX19KGUpLGZ1bmN0aW9uKHQpe3ZhciBlPXQuZGlyZWN0aXZlcztpZihlKWZvcih2YXIgbiBpbiBlKXt2YXIgcj1lW25dOyJmdW5jdGlvbiI9PXR5cGVvZiByJiYoZVtuXT17YmluZDpyLHVwZGF0ZTpyfSl9fShlKTt2YXIgaT1lLmV4dGVuZHM7aWYoaSYmKHQ9Rih0LGksbikpLGUubWl4aW5zKWZvcih2YXIgYT0wLHM9ZS5taXhpbnMubGVuZ3RoO2E8czthKyspdD1GKHQsZS5taXhpbnNbYV0sbik7dmFyIGMsdT17fTtmb3IoYyBpbiB0KXIoYyk7Zm9yKGMgaW4gZSlmKHQsYyl8fHIoYyk7cmV0dXJuIHV9ZnVuY3Rpb24gUih0LGUsbixyKXtpZigic3RyaW5nIj09dHlwZW9mIG4pe3ZhciBpPXRbZV07aWYoZihpLG4pKXJldHVybiBpW25dO3ZhciBvPVBuKG4pO2lmKGYoaSxvKSlyZXR1cm4gaVtvXTt2YXIgYT1GbihvKTtpZihmKGksYSkpcmV0dXJuIGlbYV07cmV0dXJuIGlbbl18fGlbb118fGlbYV19fWZ1bmN0aW9uIEgodCxlLG4scil7dmFyIGk9ZVt0XSxvPSFmKG4sdCksYT1uW3RdO2lmKFUoQm9vbGVhbixpLnR5cGUpJiYobyYmIWYoaSwiZGVmYXVsdCIpP2E9ITE6VShTdHJpbmcsaS50eXBlKXx8IiIhPT1hJiZhIT09SG4odCl8fChhPSEwKSksdm9pZCAwPT09YSl7YT1mdW5jdGlvbih0LGUsbil7aWYoIWYoZSwiZGVmYXVsdCIpKXJldHVybjt2YXIgcj1lLmRlZmF1bHQ7aWYodCYmdC4kb3B0aW9ucy5wcm9wc0RhdGEmJnZvaWQgMD09PXQuJG9wdGlvbnMucHJvcHNEYXRhW25dJiZ2b2lkIDAhPT10Ll9wcm9wc1tuXSlyZXR1cm4gdC5fcHJvcHNbbl07cmV0dXJuImZ1bmN0aW9uIj09dHlwZW9mIHImJiJGdW5jdGlvbiIhPT1CKGUudHlwZSk/ci5jYWxsKHQpOnJ9KHIsaSx0KTt2YXIgcz1Dci5zaG91bGRDb252ZXJ0O0NyLnNob3VsZENvbnZlcnQ9ITAsVChhKSxDci5zaG91bGRDb252ZXJ0PXN9cmV0dXJuIGF9ZnVuY3Rpb24gQih0KXt2YXIgZT10JiZ0LnRvU3RyaW5nKCkubWF0Y2goL15ccypmdW5jdGlvbiAoXHcrKS8pO3JldHVybiBlP2VbMV06IiJ9ZnVuY3Rpb24gVSh0LGUpe2lmKCFBcnJheS5pc0FycmF5KGUpKXJldHVybiBCKGUpPT09Qih0KTtmb3IodmFyIG49MCxyPWUubGVuZ3RoO248cjtuKyspaWYoQihlW25dKT09PUIodCkpcmV0dXJuITA7cmV0dXJuITF9ZnVuY3Rpb24gVih0LGUsbil7aWYoZSlmb3IodmFyIHI9ZTtyPXIuJHBhcmVudDspe3ZhciBpPXIuJG9wdGlvbnMuZXJyb3JDYXB0dXJlZDtpZihpKWZvcih2YXIgbz0wO288aS5sZW5ndGg7bysrKXRyeXtpZighMT09PWlbb10uY2FsbChyLHQsZSxuKSlyZXR1cm59Y2F0Y2godCl7eih0LHIsImVycm9yQ2FwdHVyZWQgaG9vayIpfX16KHQsZSxuKX1mdW5jdGlvbiB6KHQsZSxuKXtpZihKbi5lcnJvckhhbmRsZXIpdHJ5e3JldHVybiBKbi5lcnJvckhhbmRsZXIuY2FsbChudWxsLHQsZSxuKX1jYXRjaCh0KXtLKHQsbnVsbCwiY29uZmlnLmVycm9ySGFuZGxlciIpfUsodCxlLG4pfWZ1bmN0aW9uIEsodCxlLG4pe2lmKCFHbiYmIVpufHwidW5kZWZpbmVkIj09dHlwZW9mIGNvbnNvbGUpdGhyb3cgdDtjb25zb2xlLmVycm9yKHQpfWZ1bmN0aW9uIEooKXtUcj0hMTt2YXIgdD1Tci5zbGljZSgwKTtTci5sZW5ndGg9MDtmb3IodmFyIGU9MDtlPHQubGVuZ3RoO2UrKyl0W2VdKCl9ZnVuY3Rpb24gcSh0LGUpe3ZhciBuO2lmKFNyLnB1c2goZnVuY3Rpb24oKXtpZih0KXRyeXt0LmNhbGwoZSl9Y2F0Y2godCl7Vih0LGUsIm5leHRUaWNrIil9ZWxzZSBuJiZuKGUpfSksVHJ8fChUcj0hMCxFcj9BcigpOmtyKCkpLCF0JiYidW5kZWZpbmVkIiE9dHlwZW9mIFByb21pc2UpcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHQpe249dH0pfWZ1bmN0aW9uIFcodCl7Ryh0LE1yKSxNci5jbGVhcigpfWZ1bmN0aW9uIEcodCxlKXt2YXIgbixyLG89QXJyYXkuaXNBcnJheSh0KTtpZigob3x8aSh0KSkmJiFPYmplY3QuaXNGcm96ZW4odCkpe2lmKHQuX19vYl9fKXt2YXIgYT10Ll9fb2JfXy5kZXAuaWQ7aWYoZS5oYXMoYSkpcmV0dXJuO2UuYWRkKGEpfWlmKG8pZm9yKG49dC5sZW5ndGg7bi0tOylHKHRbbl0sZSk7ZWxzZSBmb3Iobj0ocj1PYmplY3Qua2V5cyh0KSkubGVuZ3RoO24tLTspRyh0W3Jbbl1dLGUpfX1mdW5jdGlvbiBaKHQpe2Z1bmN0aW9uIGUoKXt2YXIgdD1hcmd1bWVudHMsbj1lLmZucztpZighQXJyYXkuaXNBcnJheShuKSlyZXR1cm4gbi5hcHBseShudWxsLGFyZ3VtZW50cyk7Zm9yKHZhciByPW4uc2xpY2UoKSxpPTA7aTxyLmxlbmd0aDtpKyspcltpXS5hcHBseShudWxsLHQpfXJldHVybiBlLmZucz10LGV9ZnVuY3Rpb24gWChlLG4scixpLG8pe3ZhciBhLHMsYyx1O2ZvcihhIGluIGUpcz1lW2FdLGM9blthXSx1PURyKGEpLHQocyl8fCh0KGMpPyh0KHMuZm5zKSYmKHM9ZVthXT1aKHMpKSxyKHUubmFtZSxzLHUub25jZSx1LmNhcHR1cmUsdS5wYXNzaXZlLHUucGFyYW1zKSk6cyE9PWMmJihjLmZucz1zLGVbYV09YykpO2ZvcihhIGluIG4pdChlW2FdKSYmaSgodT1EcihhKSkubmFtZSxuW2FdLHUuY2FwdHVyZSl9ZnVuY3Rpb24gWShyLGksbyl7ZnVuY3Rpb24gYSgpe28uYXBwbHkodGhpcyxhcmd1bWVudHMpLGwocy5mbnMsYSl9ciBpbnN0YW5jZW9mIG1yJiYocj1yLmRhdGEuaG9va3x8KHIuZGF0YS5ob29rPXt9KSk7dmFyIHMsYz1yW2ldO3QoYyk/cz1aKFthXSk6ZShjLmZucykmJm4oYy5tZXJnZWQpPyhzPWMpLmZucy5wdXNoKGEpOnM9WihbYyxhXSkscy5tZXJnZWQ9ITAscltpXT1zfWZ1bmN0aW9uIFEodCxuLHIsaSxvKXtpZihlKG4pKXtpZihmKG4scikpcmV0dXJuIHRbcl09bltyXSxvfHxkZWxldGUgbltyXSwhMDtpZihmKG4saSkpcmV0dXJuIHRbcl09bltpXSxvfHxkZWxldGUgbltpXSwhMH1yZXR1cm4hMX1mdW5jdGlvbiB0dCh0KXtyZXR1cm4gZSh0KSYmZSh0LnRleHQpJiZmdW5jdGlvbih0KXtyZXR1cm4hMT09PXR9KHQuaXNDb21tZW50KX1mdW5jdGlvbiBldChpLG8pe3ZhciBhLHMsYyx1LGw9W107Zm9yKGE9MDthPGkubGVuZ3RoO2ErKyl0KHM9aVthXSl8fCJib29sZWFuIj09dHlwZW9mIHN8fCh1PWxbYz1sLmxlbmd0aC0xXSxBcnJheS5pc0FycmF5KHMpP3MubGVuZ3RoPjAmJih0dCgocz1ldChzLChvfHwiIikrIl8iK2EpKVswXSkmJnR0KHUpJiYobFtjXT14KHUudGV4dCtzWzBdLnRleHQpLHMuc2hpZnQoKSksbC5wdXNoLmFwcGx5KGwscykpOnIocyk/dHQodSk/bFtjXT14KHUudGV4dCtzKToiIiE9PXMmJmwucHVzaCh4KHMpKTp0dChzKSYmdHQodSk/bFtjXT14KHUudGV4dCtzLnRleHQpOihuKGkuX2lzVkxpc3QpJiZlKHMudGFnKSYmdChzLmtleSkmJmUobykmJihzLmtleT0iX192bGlzdCIrbysiXyIrYSsiX18iKSxsLnB1c2gocykpKTtyZXR1cm4gbH1mdW5jdGlvbiBudCh0LGUpe3JldHVybih0Ll9fZXNNb2R1bGV8fGZyJiYiTW9kdWxlIj09PXRbU3ltYm9sLnRvU3RyaW5nVGFnXSkmJih0PXQuZGVmYXVsdCksaSh0KT9lLmV4dGVuZCh0KTp0fWZ1bmN0aW9uIHJ0KHQpe3JldHVybiB0LmlzQ29tbWVudCYmdC5hc3luY0ZhY3Rvcnl9ZnVuY3Rpb24gaXQodCl7aWYoQXJyYXkuaXNBcnJheSh0KSlmb3IodmFyIG49MDtuPHQubGVuZ3RoO24rKyl7dmFyIHI9dFtuXTtpZihlKHIpJiYoZShyLmNvbXBvbmVudE9wdGlvbnMpfHxydChyKSkpcmV0dXJuIHJ9fWZ1bmN0aW9uIG90KHQsZSxuKXtuP0xyLiRvbmNlKHQsZSk6THIuJG9uKHQsZSl9ZnVuY3Rpb24gYXQodCxlKXtMci4kb2ZmKHQsZSl9ZnVuY3Rpb24gc3QodCxlLG4pe0xyPXQsWChlLG58fHt9LG90LGF0KSxMcj12b2lkIDB9ZnVuY3Rpb24gY3QodCxlKXt2YXIgbj17fTtpZighdClyZXR1cm4gbjtmb3IodmFyIHI9MCxpPXQubGVuZ3RoO3I8aTtyKyspe3ZhciBvPXRbcl0sYT1vLmRhdGE7aWYoYSYmYS5hdHRycyYmYS5hdHRycy5zbG90JiZkZWxldGUgYS5hdHRycy5zbG90LG8uY29udGV4dCE9PWUmJm8uZm5Db250ZXh0IT09ZXx8IWF8fG51bGw9PWEuc2xvdCkobi5kZWZhdWx0fHwobi5kZWZhdWx0PVtdKSkucHVzaChvKTtlbHNle3ZhciBzPWEuc2xvdCxjPW5bc118fChuW3NdPVtdKTsidGVtcGxhdGUiPT09by50YWc/Yy5wdXNoLmFwcGx5KGMsby5jaGlsZHJlbnx8W10pOmMucHVzaChvKX19Zm9yKHZhciB1IGluIG4pblt1XS5ldmVyeSh1dCkmJmRlbGV0ZSBuW3VdO3JldHVybiBufWZ1bmN0aW9uIHV0KHQpe3JldHVybiB0LmlzQ29tbWVudCYmIXQuYXN5bmNGYWN0b3J5fHwiICI9PT10LnRleHR9ZnVuY3Rpb24gbHQodCxlKXtlPWV8fHt9O2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKUFycmF5LmlzQXJyYXkodFtuXSk/bHQodFtuXSxlKTplW3Rbbl0ua2V5XT10W25dLmZuO3JldHVybiBlfWZ1bmN0aW9uIGZ0KHQpe2Zvcig7dCYmKHQ9dC4kcGFyZW50KTspaWYodC5faW5hY3RpdmUpcmV0dXJuITA7cmV0dXJuITF9ZnVuY3Rpb24gcHQodCxlKXtpZihlKXtpZih0Ll9kaXJlY3RJbmFjdGl2ZT0hMSxmdCh0KSlyZXR1cm59ZWxzZSBpZih0Ll9kaXJlY3RJbmFjdGl2ZSlyZXR1cm47aWYodC5faW5hY3RpdmV8fG51bGw9PT10Ll9pbmFjdGl2ZSl7dC5faW5hY3RpdmU9ITE7Zm9yKHZhciBuPTA7bjx0LiRjaGlsZHJlbi5sZW5ndGg7bisrKXB0KHQuJGNoaWxkcmVuW25dKTt2dCh0LCJhY3RpdmF0ZWQiKX19ZnVuY3Rpb24gZHQodCxlKXtpZighKGUmJih0Ll9kaXJlY3RJbmFjdGl2ZT0hMCxmdCh0KSl8fHQuX2luYWN0aXZlKSl7dC5faW5hY3RpdmU9ITA7Zm9yKHZhciBuPTA7bjx0LiRjaGlsZHJlbi5sZW5ndGg7bisrKWR0KHQuJGNoaWxkcmVuW25dKTt2dCh0LCJkZWFjdGl2YXRlZCIpfX1mdW5jdGlvbiB2dCh0LGUpe3ZhciBuPXQuJG9wdGlvbnNbZV07aWYobilmb3IodmFyIHI9MCxpPW4ubGVuZ3RoO3I8aTtyKyspdHJ5e25bcl0uY2FsbCh0KX1jYXRjaChuKXtWKG4sdCxlKyIgaG9vayIpfXQuX2hhc0hvb2tFdmVudCYmdC4kZW1pdCgiaG9vazoiK2UpfWZ1bmN0aW9uIGh0KCl7VXI9ITA7dmFyIHQsZTtmb3IoRnIuc29ydChmdW5jdGlvbih0LGUpe3JldHVybiB0LmlkLWUuaWR9KSxWcj0wO1ZyPEZyLmxlbmd0aDtWcisrKWU9KHQ9RnJbVnJdKS5pZCxIcltlXT1udWxsLHQucnVuKCk7dmFyIG49UnIuc2xpY2UoKSxyPUZyLnNsaWNlKCk7VnI9RnIubGVuZ3RoPVJyLmxlbmd0aD0wLEhyPXt9LEJyPVVyPSExLGZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wO2U8dC5sZW5ndGg7ZSsrKXRbZV0uX2luYWN0aXZlPSEwLHB0KHRbZV0sITApfShuKSxmdW5jdGlvbih0KXt2YXIgZT10Lmxlbmd0aDtmb3IoO2UtLTspe3ZhciBuPXRbZV0scj1uLnZtO3IuX3dhdGNoZXI9PT1uJiZyLl9pc01vdW50ZWQmJnZ0KHIsInVwZGF0ZWQiKX19KHIpLGxyJiZKbi5kZXZ0b29scyYmbHIuZW1pdCgiZmx1c2giKX1mdW5jdGlvbiBtdCh0LGUsbil7SnIuZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXNbZV1bbl19LEpyLnNldD1mdW5jdGlvbih0KXt0aGlzW2VdW25dPXR9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LG4sSnIpfWZ1bmN0aW9uIHl0KHQpe3QuX3dhdGNoZXJzPVtdO3ZhciBlPXQuJG9wdGlvbnM7ZS5wcm9wcyYmZnVuY3Rpb24odCxlKXt2YXIgbj10LiRvcHRpb25zLnByb3BzRGF0YXx8e30scj10Ll9wcm9wcz17fSxpPXQuJG9wdGlvbnMuX3Byb3BLZXlzPVtdLG89IXQuJHBhcmVudDtDci5zaG91bGRDb252ZXJ0PW87dmFyIGE9ZnVuY3Rpb24obyl7aS5wdXNoKG8pO3ZhciBhPUgobyxlLG4sdCk7RShyLG8sYSksbyBpbiB0fHxtdCh0LCJfcHJvcHMiLG8pfTtmb3IodmFyIHMgaW4gZSlhKHMpO0NyLnNob3VsZENvbnZlcnQ9ITB9KHQsZS5wcm9wcyksZS5tZXRob2RzJiZmdW5jdGlvbih0LGUpe3QuJG9wdGlvbnMucHJvcHM7Zm9yKHZhciBuIGluIGUpdFtuXT1udWxsPT1lW25dP3k6ZChlW25dLHQpfSh0LGUubWV0aG9kcyksZS5kYXRhP2Z1bmN0aW9uKHQpe3ZhciBlPXQuJG9wdGlvbnMuZGF0YTtlPXQuX2RhdGE9ImZ1bmN0aW9uIj09dHlwZW9mIGU/ZnVuY3Rpb24odCxlKXt0cnl7cmV0dXJuIHQuY2FsbChlLGUpfWNhdGNoKHQpe3JldHVybiBWKHQsZSwiZGF0YSgpIikse319fShlLHQpOmV8fHt9LG8oZSl8fChlPXt9KTt2YXIgbj1PYmplY3Qua2V5cyhlKSxyPXQuJG9wdGlvbnMucHJvcHMsaT0odC4kb3B0aW9ucy5tZXRob2RzLG4ubGVuZ3RoKTtmb3IoO2ktLTspe3ZhciBhPW5baV07ciYmZihyLGEpfHwkKGEpfHxtdCh0LCJfZGF0YSIsYSl9VChlLCEwKX0odCk6VCh0Ll9kYXRhPXt9LCEwKSxlLmNvbXB1dGVkJiZmdW5jdGlvbih0LGUpe3ZhciBuPXQuX2NvbXB1dGVkV2F0Y2hlcnM9T2JqZWN0LmNyZWF0ZShudWxsKSxyPXVyKCk7Zm9yKHZhciBpIGluIGUpe3ZhciBvPWVbaV0sYT0iZnVuY3Rpb24iPT10eXBlb2Ygbz9vOm8uZ2V0O3J8fChuW2ldPW5ldyBLcih0LGF8fHkseSxxcikpLGkgaW4gdHx8Z3QodCxpLG8pfX0odCxlLmNvbXB1dGVkKSxlLndhdGNoJiZlLndhdGNoIT09aXImJmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBuIGluIGUpe3ZhciByPWVbbl07aWYoQXJyYXkuaXNBcnJheShyKSlmb3IodmFyIGk9MDtpPHIubGVuZ3RoO2krKylidCh0LG4scltpXSk7ZWxzZSBidCh0LG4scil9fSh0LGUud2F0Y2gpfWZ1bmN0aW9uIGd0KHQsZSxuKXt2YXIgcj0hdXIoKTsiZnVuY3Rpb24iPT10eXBlb2Ygbj8oSnIuZ2V0PXI/X3QoZSk6bixKci5zZXQ9eSk6KEpyLmdldD1uLmdldD9yJiYhMSE9PW4uY2FjaGU/X3QoZSk6bi5nZXQ6eSxKci5zZXQ9bi5zZXQ/bi5zZXQ6eSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsZSxKcil9ZnVuY3Rpb24gX3QodCl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fY29tcHV0ZWRXYXRjaGVycyYmdGhpcy5fY29tcHV0ZWRXYXRjaGVyc1t0XTtpZihlKXJldHVybiBlLmRpcnR5JiZlLmV2YWx1YXRlKCksdnIudGFyZ2V0JiZlLmRlcGVuZCgpLGUudmFsdWV9fWZ1bmN0aW9uIGJ0KHQsZSxuLHIpe3JldHVybiBvKG4pJiYocj1uLG49bi5oYW5kbGVyKSwic3RyaW5nIj09dHlwZW9mIG4mJihuPXRbbl0pLHQuJHdhdGNoKGUsbixyKX1mdW5jdGlvbiAkdCh0LGUpe2lmKHQpe2Zvcih2YXIgbj1PYmplY3QuY3JlYXRlKG51bGwpLHI9ZnI/UmVmbGVjdC5vd25LZXlzKHQpLmZpbHRlcihmdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0LGUpLmVudW1lcmFibGV9KTpPYmplY3Qua2V5cyh0KSxpPTA7aTxyLmxlbmd0aDtpKyspe2Zvcih2YXIgbz1yW2ldLGE9dFtvXS5mcm9tLHM9ZTtzOyl7aWYocy5fcHJvdmlkZWQmJmEgaW4gcy5fcHJvdmlkZWQpe25bb109cy5fcHJvdmlkZWRbYV07YnJlYWt9cz1zLiRwYXJlbnR9aWYoIXMmJiJkZWZhdWx0ImluIHRbb10pe3ZhciBjPXRbb10uZGVmYXVsdDtuW29dPSJmdW5jdGlvbiI9PXR5cGVvZiBjP2MuY2FsbChlKTpjfX1yZXR1cm4gbn19ZnVuY3Rpb24gQ3QodCxuKXt2YXIgcixvLGEscyxjO2lmKEFycmF5LmlzQXJyYXkodCl8fCJzdHJpbmciPT10eXBlb2YgdClmb3Iocj1uZXcgQXJyYXkodC5sZW5ndGgpLG89MCxhPXQubGVuZ3RoO288YTtvKyspcltvXT1uKHRbb10sbyk7ZWxzZSBpZigibnVtYmVyIj09dHlwZW9mIHQpZm9yKHI9bmV3IEFycmF5KHQpLG89MDtvPHQ7bysrKXJbb109bihvKzEsbyk7ZWxzZSBpZihpKHQpKWZvcihzPU9iamVjdC5rZXlzKHQpLHI9bmV3IEFycmF5KHMubGVuZ3RoKSxvPTAsYT1zLmxlbmd0aDtvPGE7bysrKWM9c1tvXSxyW29dPW4odFtjXSxjLG8pO3JldHVybiBlKHIpJiYoci5faXNWTGlzdD0hMCkscn1mdW5jdGlvbiB3dCh0LGUsbixyKXt2YXIgaSxvPXRoaXMuJHNjb3BlZFNsb3RzW3RdO2lmKG8pbj1ufHx7fSxyJiYobj1oKGgoe30sciksbikpLGk9byhuKXx8ZTtlbHNle3ZhciBhPXRoaXMuJHNsb3RzW3RdO2EmJihhLl9yZW5kZXJlZD0hMCksaT1hfHxlfXZhciBzPW4mJm4uc2xvdDtyZXR1cm4gcz90aGlzLiRjcmVhdGVFbGVtZW50KCJ0ZW1wbGF0ZSIse3Nsb3Q6c30saSk6aX1mdW5jdGlvbiB4dCh0KXtyZXR1cm4gUih0aGlzLiRvcHRpb25zLCJmaWx0ZXJzIix0KXx8VW59ZnVuY3Rpb24ga3QodCxlLG4scil7dmFyIGk9Sm4ua2V5Q29kZXNbZV18fG47cmV0dXJuIGk/QXJyYXkuaXNBcnJheShpKT8tMT09PWkuaW5kZXhPZih0KTppIT09dDpyP0huKHIpIT09ZTp2b2lkIDB9ZnVuY3Rpb24gQXQodCxlLG4scixvKXtpZihuKWlmKGkobikpe0FycmF5LmlzQXJyYXkobikmJihuPW0obikpO3ZhciBhLHM9ZnVuY3Rpb24oaSl7aWYoImNsYXNzIj09PWl8fCJzdHlsZSI9PT1pfHxMbihpKSlhPXQ7ZWxzZXt2YXIgcz10LmF0dHJzJiZ0LmF0dHJzLnR5cGU7YT1yfHxKbi5tdXN0VXNlUHJvcChlLHMsaSk/dC5kb21Qcm9wc3x8KHQuZG9tUHJvcHM9e30pOnQuYXR0cnN8fCh0LmF0dHJzPXt9KX1pZighKGkgaW4gYSkmJihhW2ldPW5baV0sbykpeyh0Lm9ufHwodC5vbj17fSkpWyJ1cGRhdGU6IitpXT1mdW5jdGlvbih0KXtuW2ldPXR9fX07Zm9yKHZhciBjIGluIG4pcyhjKX1lbHNlO3JldHVybiB0fWZ1bmN0aW9uIE90KHQsZSl7dmFyIG49dGhpcy5fc3RhdGljVHJlZXN8fCh0aGlzLl9zdGF0aWNUcmVlcz1bXSkscj1uW3RdO3JldHVybiByJiYhZT9BcnJheS5pc0FycmF5KHIpP0Eocik6ayhyKToocj1uW3RdPXRoaXMuJG9wdGlvbnMuc3RhdGljUmVuZGVyRm5zW3RdLmNhbGwodGhpcy5fcmVuZGVyUHJveHksbnVsbCx0aGlzKSxUdChyLCJfX3N0YXRpY19fIit0LCExKSxyKX1mdW5jdGlvbiBTdCh0LGUsbil7cmV0dXJuIFR0KHQsIl9fb25jZV9fIitlKyhuPyJfIituOiIiKSwhMCksdH1mdW5jdGlvbiBUdCh0LGUsbil7aWYoQXJyYXkuaXNBcnJheSh0KSlmb3IodmFyIHI9MDtyPHQubGVuZ3RoO3IrKyl0W3JdJiYic3RyaW5nIiE9dHlwZW9mIHRbcl0mJkV0KHRbcl0sZSsiXyIrcixuKTtlbHNlIEV0KHQsZSxuKX1mdW5jdGlvbiBFdCh0LGUsbil7dC5pc1N0YXRpYz0hMCx0LmtleT1lLHQuaXNPbmNlPW59ZnVuY3Rpb24ganQodCxlKXtpZihlKWlmKG8oZSkpe3ZhciBuPXQub249dC5vbj9oKHt9LHQub24pOnt9O2Zvcih2YXIgciBpbiBlKXt2YXIgaT1uW3JdLGE9ZVtyXTtuW3JdPWk/W10uY29uY2F0KGksYSk6YX19ZWxzZTtyZXR1cm4gdH1mdW5jdGlvbiBOdCh0KXt0Ll9vPVN0LHQuX249Yyx0Ll9zPXMsdC5fbD1DdCx0Ll90PXd0LHQuX3E9Zyx0Ll9pPV8sdC5fbT1PdCx0Ll9mPXh0LHQuX2s9a3QsdC5fYj1BdCx0Ll92PXgsdC5fZT1ncix0Ll91PWx0LHQuX2c9anR9ZnVuY3Rpb24gSXQodCxlLHIsaSxvKXt2YXIgYT1vLm9wdGlvbnM7dGhpcy5kYXRhPXQsdGhpcy5wcm9wcz1lLHRoaXMuY2hpbGRyZW49cix0aGlzLnBhcmVudD1pLHRoaXMubGlzdGVuZXJzPXQub258fGpuLHRoaXMuaW5qZWN0aW9ucz0kdChhLmluamVjdCxpKSx0aGlzLnNsb3RzPWZ1bmN0aW9uKCl7cmV0dXJuIGN0KHIsaSl9O3ZhciBzPU9iamVjdC5jcmVhdGUoaSksYz1uKGEuX2NvbXBpbGVkKSx1PSFjO2MmJih0aGlzLiRvcHRpb25zPWEsdGhpcy4kc2xvdHM9dGhpcy5zbG90cygpLHRoaXMuJHNjb3BlZFNsb3RzPXQuc2NvcGVkU2xvdHN8fGpuKSxhLl9zY29wZUlkP3RoaXMuX2M9ZnVuY3Rpb24odCxlLG4scil7dmFyIG89RHQocyx0LGUsbixyLHUpO3JldHVybiBvJiYoby5mblNjb3BlSWQ9YS5fc2NvcGVJZCxvLmZuQ29udGV4dD1pKSxvfTp0aGlzLl9jPWZ1bmN0aW9uKHQsZSxuLHIpe3JldHVybiBEdChzLHQsZSxuLHIsdSl9fWZ1bmN0aW9uIEx0KHQsZSl7Zm9yKHZhciBuIGluIGUpdFtQbihuKV09ZVtuXX1mdW5jdGlvbiBNdChyLG8sYSxzLGMpe2lmKCF0KHIpKXt2YXIgdT1hLiRvcHRpb25zLl9iYXNlO2lmKGkocikmJihyPXUuZXh0ZW5kKHIpKSwiZnVuY3Rpb24iPT10eXBlb2Ygcil7dmFyIGw7aWYodChyLmNpZCkmJihsPXIsdm9pZCAwPT09KHI9ZnVuY3Rpb24ocixvLGEpe2lmKG4oci5lcnJvcikmJmUoci5lcnJvckNvbXApKXJldHVybiByLmVycm9yQ29tcDtpZihlKHIucmVzb2x2ZWQpKXJldHVybiByLnJlc29sdmVkO2lmKG4oci5sb2FkaW5nKSYmZShyLmxvYWRpbmdDb21wKSlyZXR1cm4gci5sb2FkaW5nQ29tcDtpZighZShyLmNvbnRleHRzKSl7dmFyIHM9ci5jb250ZXh0cz1bYV0sYz0hMCx1PWZ1bmN0aW9uKCl7Zm9yKHZhciB0PTAsZT1zLmxlbmd0aDt0PGU7dCsrKXNbdF0uJGZvcmNlVXBkYXRlKCl9LGw9YihmdW5jdGlvbih0KXtyLnJlc29sdmVkPW50KHQsbyksY3x8dSgpfSksZj1iKGZ1bmN0aW9uKHQpe2Uoci5lcnJvckNvbXApJiYoci5lcnJvcj0hMCx1KCkpfSkscD1yKGwsZik7cmV0dXJuIGkocCkmJigiZnVuY3Rpb24iPT10eXBlb2YgcC50aGVuP3Qoci5yZXNvbHZlZCkmJnAudGhlbihsLGYpOmUocC5jb21wb25lbnQpJiYiZnVuY3Rpb24iPT10eXBlb2YgcC5jb21wb25lbnQudGhlbiYmKHAuY29tcG9uZW50LnRoZW4obCxmKSxlKHAuZXJyb3IpJiYoci5lcnJvckNvbXA9bnQocC5lcnJvcixvKSksZShwLmxvYWRpbmcpJiYoci5sb2FkaW5nQ29tcD1udChwLmxvYWRpbmcsbyksMD09PXAuZGVsYXk/ci5sb2FkaW5nPSEwOnNldFRpbWVvdXQoZnVuY3Rpb24oKXt0KHIucmVzb2x2ZWQpJiZ0KHIuZXJyb3IpJiYoci5sb2FkaW5nPSEwLHUoKSl9LHAuZGVsYXl8fDIwMCkpLGUocC50aW1lb3V0KSYmc2V0VGltZW91dChmdW5jdGlvbigpe3Qoci5yZXNvbHZlZCkmJmYobnVsbCl9LHAudGltZW91dCkpKSxjPSExLHIubG9hZGluZz9yLmxvYWRpbmdDb21wOnIucmVzb2x2ZWR9ci5jb250ZXh0cy5wdXNoKGEpfShsLHUsYSkpKSlyZXR1cm4gZnVuY3Rpb24odCxlLG4scixpKXt2YXIgbz1ncigpO3JldHVybiBvLmFzeW5jRmFjdG9yeT10LG8uYXN5bmNNZXRhPXtkYXRhOmUsY29udGV4dDpuLGNoaWxkcmVuOnIsdGFnOml9LG99KGwsbyxhLHMsYyk7bz1vfHx7fSxGdChyKSxlKG8ubW9kZWwpJiZmdW5jdGlvbih0LG4pe3ZhciByPXQubW9kZWwmJnQubW9kZWwucHJvcHx8InZhbHVlIixpPXQubW9kZWwmJnQubW9kZWwuZXZlbnR8fCJpbnB1dCI7KG4ucHJvcHN8fChuLnByb3BzPXt9KSlbcl09bi5tb2RlbC52YWx1ZTt2YXIgbz1uLm9ufHwobi5vbj17fSk7ZShvW2ldKT9vW2ldPVtuLm1vZGVsLmNhbGxiYWNrXS5jb25jYXQob1tpXSk6b1tpXT1uLm1vZGVsLmNhbGxiYWNrfShyLm9wdGlvbnMsbyk7dmFyIGY9ZnVuY3Rpb24obixyLGkpe3ZhciBvPXIub3B0aW9ucy5wcm9wcztpZighdChvKSl7dmFyIGE9e30scz1uLmF0dHJzLGM9bi5wcm9wcztpZihlKHMpfHxlKGMpKWZvcih2YXIgdSBpbiBvKXt2YXIgbD1Ibih1KTtRKGEsYyx1LGwsITApfHxRKGEscyx1LGwsITEpfXJldHVybiBhfX0obyxyKTtpZihuKHIub3B0aW9ucy5mdW5jdGlvbmFsKSlyZXR1cm4gZnVuY3Rpb24odCxuLHIsaSxvKXt2YXIgYT10Lm9wdGlvbnMscz17fSxjPWEucHJvcHM7aWYoZShjKSlmb3IodmFyIHUgaW4gYylzW3VdPUgodSxjLG58fGpuKTtlbHNlIGUoci5hdHRycykmJkx0KHMsci5hdHRycyksZShyLnByb3BzKSYmTHQocyxyLnByb3BzKTt2YXIgbD1uZXcgSXQocixzLG8saSx0KSxmPWEucmVuZGVyLmNhbGwobnVsbCxsLl9jLGwpO3JldHVybiBmIGluc3RhbmNlb2YgbXImJihmLmZuQ29udGV4dD1pLGYuZm5PcHRpb25zPWEsci5zbG90JiYoKGYuZGF0YXx8KGYuZGF0YT17fSkpLnNsb3Q9ci5zbG90KSksZn0ocixmLG8sYSxzKTt2YXIgcD1vLm9uO2lmKG8ub249by5uYXRpdmVPbixuKHIub3B0aW9ucy5hYnN0cmFjdCkpe3ZhciBkPW8uc2xvdDtvPXt9LGQmJihvLnNsb3Q9ZCl9IWZ1bmN0aW9uKHQpe3QuaG9va3x8KHQuaG9vaz17fSk7Zm9yKHZhciBlPTA7ZTxHci5sZW5ndGg7ZSsrKXt2YXIgbj1HcltlXSxyPXQuaG9va1tuXSxpPVdyW25dO3QuaG9va1tuXT1yP2Z1bmN0aW9uKHQsZSl7cmV0dXJuIGZ1bmN0aW9uKG4scixpLG8pe3QobixyLGksbyksZShuLHIsaSxvKX19KGkscik6aX19KG8pO3ZhciB2PXIub3B0aW9ucy5uYW1lfHxjO3JldHVybiBuZXcgbXIoInZ1ZS1jb21wb25lbnQtIityLmNpZCsodj8iLSIrdjoiIiksbyx2b2lkIDAsdm9pZCAwLHZvaWQgMCxhLHtDdG9yOnIscHJvcHNEYXRhOmYsbGlzdGVuZXJzOnAsdGFnOmMsY2hpbGRyZW46c30sbCl9fX1mdW5jdGlvbiBEdCh0LGksbyxhLHMsYyl7cmV0dXJuKEFycmF5LmlzQXJyYXkobyl8fHIobykpJiYocz1hLGE9byxvPXZvaWQgMCksbihjKSYmKHM9WHIpLGZ1bmN0aW9uKHQsbixpLG8sYSl7aWYoZShpKSYmZShpLl9fb2JfXykpcmV0dXJuIGdyKCk7ZShpKSYmZShpLmlzKSYmKG49aS5pcyk7aWYoIW4pcmV0dXJuIGdyKCk7QXJyYXkuaXNBcnJheShvKSYmImZ1bmN0aW9uIj09dHlwZW9mIG9bMF0mJigoaT1pfHx7fSkuc2NvcGVkU2xvdHM9e2RlZmF1bHQ6b1swXX0sby5sZW5ndGg9MCk7YT09PVhyP289ZnVuY3Rpb24odCl7cmV0dXJuIHIodCk/W3godCldOkFycmF5LmlzQXJyYXkodCk/ZXQodCk6dm9pZCAwfShvKTphPT09WnImJihvPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wO2U8dC5sZW5ndGg7ZSsrKWlmKEFycmF5LmlzQXJyYXkodFtlXSkpcmV0dXJuIEFycmF5LnByb3RvdHlwZS5jb25jYXQuYXBwbHkoW10sdCk7cmV0dXJuIHR9KG8pKTt2YXIgcyxjO2lmKCJzdHJpbmciPT10eXBlb2Ygbil7dmFyIHU7Yz10LiR2bm9kZSYmdC4kdm5vZGUubnN8fEpuLmdldFRhZ05hbWVzcGFjZShuKSxzPUpuLmlzUmVzZXJ2ZWRUYWcobik/bmV3IG1yKEpuLnBhcnNlUGxhdGZvcm1UYWdOYW1lKG4pLGksbyx2b2lkIDAsdm9pZCAwLHQpOmUodT1SKHQuJG9wdGlvbnMsImNvbXBvbmVudHMiLG4pKT9NdCh1LGksdCxvLG4pOm5ldyBtcihuLGksbyx2b2lkIDAsdm9pZCAwLHQpfWVsc2Ugcz1NdChuLGksdCxvKTtyZXR1cm4gZShzKT8oYyYmUHQocyxjKSxzKTpncigpfSh0LGksbyxhLHMpfWZ1bmN0aW9uIFB0KHIsaSxvKXtpZihyLm5zPWksImZvcmVpZ25PYmplY3QiPT09ci50YWcmJihpPXZvaWQgMCxvPSEwKSxlKHIuY2hpbGRyZW4pKWZvcih2YXIgYT0wLHM9ci5jaGlsZHJlbi5sZW5ndGg7YTxzO2ErKyl7dmFyIGM9ci5jaGlsZHJlblthXTtlKGMudGFnKSYmKHQoYy5ucyl8fG4obykpJiZQdChjLGksbyl9fWZ1bmN0aW9uIEZ0KHQpe3ZhciBlPXQub3B0aW9ucztpZih0LnN1cGVyKXt2YXIgbj1GdCh0LnN1cGVyKTtpZihuIT09dC5zdXBlck9wdGlvbnMpe3Quc3VwZXJPcHRpb25zPW47dmFyIHI9ZnVuY3Rpb24odCl7dmFyIGUsbj10Lm9wdGlvbnMscj10LmV4dGVuZE9wdGlvbnMsaT10LnNlYWxlZE9wdGlvbnM7Zm9yKHZhciBvIGluIG4pbltvXSE9PWlbb10mJihlfHwoZT17fSksZVtvXT1mdW5jdGlvbih0LGUsbil7e2lmKEFycmF5LmlzQXJyYXkodCkpe3ZhciByPVtdO249QXJyYXkuaXNBcnJheShuKT9uOltuXSxlPUFycmF5LmlzQXJyYXkoZSk/ZTpbZV07Zm9yKHZhciBpPTA7aTx0Lmxlbmd0aDtpKyspKGUuaW5kZXhPZih0W2ldKT49MHx8bi5pbmRleE9mKHRbaV0pPDApJiZyLnB1c2godFtpXSk7cmV0dXJuIHJ9cmV0dXJuIHR9fShuW29dLHJbb10saVtvXSkpO3JldHVybiBlfSh0KTtyJiZoKHQuZXh0ZW5kT3B0aW9ucyxyKSwoZT10Lm9wdGlvbnM9RihuLHQuZXh0ZW5kT3B0aW9ucykpLm5hbWUmJihlLmNvbXBvbmVudHNbZS5uYW1lXT10KX19cmV0dXJuIGV9ZnVuY3Rpb24gUnQodCl7dGhpcy5faW5pdCh0KX1mdW5jdGlvbiBIdCh0KXt0LmNpZD0wO3ZhciBlPTE7dC5leHRlbmQ9ZnVuY3Rpb24odCl7dD10fHx7fTt2YXIgbj10aGlzLHI9bi5jaWQsaT10Ll9DdG9yfHwodC5fQ3Rvcj17fSk7aWYoaVtyXSlyZXR1cm4gaVtyXTt2YXIgbz10Lm5hbWV8fG4ub3B0aW9ucy5uYW1lLGE9ZnVuY3Rpb24odCl7dGhpcy5faW5pdCh0KX07cmV0dXJuIGEucHJvdG90eXBlPU9iamVjdC5jcmVhdGUobi5wcm90b3R5cGUpLGEucHJvdG90eXBlLmNvbnN0cnVjdG9yPWEsYS5jaWQ9ZSsrLGEub3B0aW9ucz1GKG4ub3B0aW9ucyx0KSxhLnN1cGVyPW4sYS5vcHRpb25zLnByb3BzJiZmdW5jdGlvbih0KXt2YXIgZT10Lm9wdGlvbnMucHJvcHM7Zm9yKHZhciBuIGluIGUpbXQodC5wcm90b3R5cGUsIl9wcm9wcyIsbil9KGEpLGEub3B0aW9ucy5jb21wdXRlZCYmZnVuY3Rpb24odCl7dmFyIGU9dC5vcHRpb25zLmNvbXB1dGVkO2Zvcih2YXIgbiBpbiBlKWd0KHQucHJvdG90eXBlLG4sZVtuXSl9KGEpLGEuZXh0ZW5kPW4uZXh0ZW5kLGEubWl4aW49bi5taXhpbixhLnVzZT1uLnVzZSx6bi5mb3JFYWNoKGZ1bmN0aW9uKHQpe2FbdF09blt0XX0pLG8mJihhLm9wdGlvbnMuY29tcG9uZW50c1tvXT1hKSxhLnN1cGVyT3B0aW9ucz1uLm9wdGlvbnMsYS5leHRlbmRPcHRpb25zPXQsYS5zZWFsZWRPcHRpb25zPWgoe30sYS5vcHRpb25zKSxpW3JdPWEsYX19ZnVuY3Rpb24gQnQodCl7cmV0dXJuIHQmJih0LkN0b3Iub3B0aW9ucy5uYW1lfHx0LnRhZyl9ZnVuY3Rpb24gVXQodCxlKXtyZXR1cm4gQXJyYXkuaXNBcnJheSh0KT90LmluZGV4T2YoZSk+LTE6InN0cmluZyI9PXR5cGVvZiB0P3Quc3BsaXQoIiwiKS5pbmRleE9mKGUpPi0xOiEhZnVuY3Rpb24odCl7cmV0dXJuIltvYmplY3QgUmVnRXhwXSI9PT1Obi5jYWxsKHQpfSh0KSYmdC50ZXN0KGUpfWZ1bmN0aW9uIFZ0KHQsZSl7dmFyIG49dC5jYWNoZSxyPXQua2V5cyxpPXQuX3Zub2RlO2Zvcih2YXIgbyBpbiBuKXt2YXIgYT1uW29dO2lmKGEpe3ZhciBzPUJ0KGEuY29tcG9uZW50T3B0aW9ucyk7cyYmIWUocykmJnp0KG4sbyxyLGkpfX19ZnVuY3Rpb24genQodCxlLG4scil7dmFyIGk9dFtlXTshaXx8ciYmaS50YWc9PT1yLnRhZ3x8aS5jb21wb25lbnRJbnN0YW5jZS4kZGVzdHJveSgpLHRbZV09bnVsbCxsKG4sZSl9ZnVuY3Rpb24gS3QodCl7Zm9yKHZhciBuPXQuZGF0YSxyPXQsaT10O2UoaS5jb21wb25lbnRJbnN0YW5jZSk7KShpPWkuY29tcG9uZW50SW5zdGFuY2UuX3Zub2RlKSYmaS5kYXRhJiYobj1KdChpLmRhdGEsbikpO2Zvcig7ZShyPXIucGFyZW50KTspciYmci5kYXRhJiYobj1KdChuLHIuZGF0YSkpO3JldHVybiBmdW5jdGlvbih0LG4pe2lmKGUodCl8fGUobikpcmV0dXJuIHF0KHQsV3QobikpO3JldHVybiIifShuLnN0YXRpY0NsYXNzLG4uY2xhc3MpfWZ1bmN0aW9uIEp0KHQsbil7cmV0dXJue3N0YXRpY0NsYXNzOnF0KHQuc3RhdGljQ2xhc3Msbi5zdGF0aWNDbGFzcyksY2xhc3M6ZSh0LmNsYXNzKT9bdC5jbGFzcyxuLmNsYXNzXTpuLmNsYXNzfX1mdW5jdGlvbiBxdCh0LGUpe3JldHVybiB0P2U/dCsiICIrZTp0OmV8fCIifWZ1bmN0aW9uIFd0KHQpe3JldHVybiBBcnJheS5pc0FycmF5KHQpP2Z1bmN0aW9uKHQpe2Zvcih2YXIgbixyPSIiLGk9MCxvPXQubGVuZ3RoO2k8bztpKyspZShuPVd0KHRbaV0pKSYmIiIhPT1uJiYociYmKHIrPSIgIikscis9bik7cmV0dXJuIHJ9KHQpOmkodCk/ZnVuY3Rpb24odCl7dmFyIGU9IiI7Zm9yKHZhciBuIGluIHQpdFtuXSYmKGUmJihlKz0iICIpLGUrPW4pO3JldHVybiBlfSh0KToic3RyaW5nIj09dHlwZW9mIHQ/dDoiIn1mdW5jdGlvbiBHdCh0KXtyZXR1cm4gYmkodCk/InN2ZyI6Im1hdGgiPT09dD8ibWF0aCI6dm9pZCAwfWZ1bmN0aW9uIFp0KHQpe2lmKCJzdHJpbmciPT10eXBlb2YgdCl7dmFyIGU9ZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0KTtyZXR1cm4gZXx8ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iil9cmV0dXJuIHR9ZnVuY3Rpb24gWHQodCxlKXt2YXIgbj10LmRhdGEucmVmO2lmKG4pe3ZhciByPXQuY29udGV4dCxpPXQuY29tcG9uZW50SW5zdGFuY2V8fHQuZWxtLG89ci4kcmVmcztlP0FycmF5LmlzQXJyYXkob1tuXSk/bChvW25dLGkpOm9bbl09PT1pJiYob1tuXT12b2lkIDApOnQuZGF0YS5yZWZJbkZvcj9BcnJheS5pc0FycmF5KG9bbl0pP29bbl0uaW5kZXhPZihpKTwwJiZvW25dLnB1c2goaSk6b1tuXT1baV06b1tuXT1pfX1mdW5jdGlvbiBZdChyLGkpe3JldHVybiByLmtleT09PWkua2V5JiYoci50YWc9PT1pLnRhZyYmci5pc0NvbW1lbnQ9PT1pLmlzQ29tbWVudCYmZShyLmRhdGEpPT09ZShpLmRhdGEpJiZmdW5jdGlvbih0LG4pe2lmKCJpbnB1dCIhPT10LnRhZylyZXR1cm4hMDt2YXIgcixpPWUocj10LmRhdGEpJiZlKHI9ci5hdHRycykmJnIudHlwZSxvPWUocj1uLmRhdGEpJiZlKHI9ci5hdHRycykmJnIudHlwZTtyZXR1cm4gaT09PW98fHdpKGkpJiZ3aShvKX0ocixpKXx8bihyLmlzQXN5bmNQbGFjZWhvbGRlcikmJnIuYXN5bmNGYWN0b3J5PT09aS5hc3luY0ZhY3RvcnkmJnQoaS5hc3luY0ZhY3RvcnkuZXJyb3IpKX1mdW5jdGlvbiBRdCh0LG4scil7dmFyIGksbyxhPXt9O2ZvcihpPW47aTw9cjsrK2kpZShvPXRbaV0ua2V5KSYmKGFbb109aSk7cmV0dXJuIGF9ZnVuY3Rpb24gdGUodCxlKXsodC5kYXRhLmRpcmVjdGl2ZXN8fGUuZGF0YS5kaXJlY3RpdmVzKSYmZnVuY3Rpb24odCxlKXt2YXIgbixyLGksbz10PT09QWksYT1lPT09QWkscz1lZSh0LmRhdGEuZGlyZWN0aXZlcyx0LmNvbnRleHQpLGM9ZWUoZS5kYXRhLmRpcmVjdGl2ZXMsZS5jb250ZXh0KSx1PVtdLGw9W107Zm9yKG4gaW4gYylyPXNbbl0saT1jW25dLHI/KGkub2xkVmFsdWU9ci52YWx1ZSxuZShpLCJ1cGRhdGUiLGUsdCksaS5kZWYmJmkuZGVmLmNvbXBvbmVudFVwZGF0ZWQmJmwucHVzaChpKSk6KG5lKGksImJpbmQiLGUsdCksaS5kZWYmJmkuZGVmLmluc2VydGVkJiZ1LnB1c2goaSkpO2lmKHUubGVuZ3RoKXt2YXIgZj1mdW5jdGlvbigpe2Zvcih2YXIgbj0wO248dS5sZW5ndGg7bisrKW5lKHVbbl0sImluc2VydGVkIixlLHQpfTtvP1koZSwiaW5zZXJ0IixmKTpmKCl9bC5sZW5ndGgmJlkoZSwicG9zdHBhdGNoIixmdW5jdGlvbigpe2Zvcih2YXIgbj0wO248bC5sZW5ndGg7bisrKW5lKGxbbl0sImNvbXBvbmVudFVwZGF0ZWQiLGUsdCl9KTtpZighbylmb3IobiBpbiBzKWNbbl18fG5lKHNbbl0sInVuYmluZCIsdCx0LGEpfSh0LGUpfWZ1bmN0aW9uIGVlKHQsZSl7dmFyIG49T2JqZWN0LmNyZWF0ZShudWxsKTtpZighdClyZXR1cm4gbjt2YXIgcixpO2ZvcihyPTA7cjx0Lmxlbmd0aDtyKyspKGk9dFtyXSkubW9kaWZpZXJzfHwoaS5tb2RpZmllcnM9VGkpLG5bZnVuY3Rpb24odCl7cmV0dXJuIHQucmF3TmFtZXx8dC5uYW1lKyIuIitPYmplY3Qua2V5cyh0Lm1vZGlmaWVyc3x8e30pLmpvaW4oIi4iKX0oaSldPWksaS5kZWY9UihlLiRvcHRpb25zLCJkaXJlY3RpdmVzIixpLm5hbWUpO3JldHVybiBufWZ1bmN0aW9uIG5lKHQsZSxuLHIsaSl7dmFyIG89dC5kZWYmJnQuZGVmW2VdO2lmKG8pdHJ5e28obi5lbG0sdCxuLHIsaSl9Y2F0Y2gocil7VihyLG4uY29udGV4dCwiZGlyZWN0aXZlICIrdC5uYW1lKyIgIitlKyIgaG9vayIpfX1mdW5jdGlvbiByZShuLHIpe3ZhciBpPXIuY29tcG9uZW50T3B0aW9ucztpZighKGUoaSkmJiExPT09aS5DdG9yLm9wdGlvbnMuaW5oZXJpdEF0dHJzfHx0KG4uZGF0YS5hdHRycykmJnQoci5kYXRhLmF0dHJzKSkpe3ZhciBvLGEscz1yLmVsbSxjPW4uZGF0YS5hdHRyc3x8e30sdT1yLmRhdGEuYXR0cnN8fHt9O2UodS5fX29iX18pJiYodT1yLmRhdGEuYXR0cnM9aCh7fSx1KSk7Zm9yKG8gaW4gdSlhPXVbb10sY1tvXSE9PWEmJmllKHMsbyxhKTsoUW58fGVyKSYmdS52YWx1ZSE9PWMudmFsdWUmJmllKHMsInZhbHVlIix1LnZhbHVlKTtmb3IobyBpbiBjKXQodVtvXSkmJihoaShvKT9zLnJlbW92ZUF0dHJpYnV0ZU5TKHZpLG1pKG8pKTpwaShvKXx8cy5yZW1vdmVBdHRyaWJ1dGUobykpfX1mdW5jdGlvbiBpZSh0LGUsbil7aWYoZGkoZSkpeWkobik/dC5yZW1vdmVBdHRyaWJ1dGUoZSk6KG49ImFsbG93ZnVsbHNjcmVlbiI9PT1lJiYiRU1CRUQiPT09dC50YWdOYW1lPyJ0cnVlIjplLHQuc2V0QXR0cmlidXRlKGUsbikpO2Vsc2UgaWYocGkoZSkpdC5zZXRBdHRyaWJ1dGUoZSx5aShuKXx8ImZhbHNlIj09PW4/ImZhbHNlIjoidHJ1ZSIpO2Vsc2UgaWYoaGkoZSkpeWkobik/dC5yZW1vdmVBdHRyaWJ1dGVOUyh2aSxtaShlKSk6dC5zZXRBdHRyaWJ1dGVOUyh2aSxlLG4pO2Vsc2UgaWYoeWkobikpdC5yZW1vdmVBdHRyaWJ1dGUoZSk7ZWxzZXtpZihRbiYmIXRyJiYiVEVYVEFSRUEiPT09dC50YWdOYW1lJiYicGxhY2Vob2xkZXIiPT09ZSYmIXQuX19pZXBoKXt2YXIgcj1mdW5jdGlvbihlKXtlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLHQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiaW5wdXQiLHIpfTt0LmFkZEV2ZW50TGlzdGVuZXIoImlucHV0IixyKSx0Ll9faWVwaD0hMH10LnNldEF0dHJpYnV0ZShlLG4pfX1mdW5jdGlvbiBvZShuLHIpe3ZhciBpPXIuZWxtLG89ci5kYXRhLGE9bi5kYXRhO2lmKCEodChvLnN0YXRpY0NsYXNzKSYmdChvLmNsYXNzKSYmKHQoYSl8fHQoYS5zdGF0aWNDbGFzcykmJnQoYS5jbGFzcykpKSl7dmFyIHM9S3QociksYz1pLl90cmFuc2l0aW9uQ2xhc3NlcztlKGMpJiYocz1xdChzLFd0KGMpKSkscyE9PWkuX3ByZXZDbGFzcyYmKGkuc2V0QXR0cmlidXRlKCJjbGFzcyIscyksaS5fcHJldkNsYXNzPXMpfX1mdW5jdGlvbiBhZSh0KXtmdW5jdGlvbiBlKCl7KGF8fChhPVtdKSkucHVzaCh0LnNsaWNlKHYsaSkudHJpbSgpKSx2PWkrMX12YXIgbixyLGksbyxhLHM9ITEsYz0hMSx1PSExLGw9ITEsZj0wLHA9MCxkPTAsdj0wO2ZvcihpPTA7aTx0Lmxlbmd0aDtpKyspaWYocj1uLG49dC5jaGFyQ29kZUF0KGkpLHMpMzk9PT1uJiY5MiE9PXImJihzPSExKTtlbHNlIGlmKGMpMzQ9PT1uJiY5MiE9PXImJihjPSExKTtlbHNlIGlmKHUpOTY9PT1uJiY5MiE9PXImJih1PSExKTtlbHNlIGlmKGwpNDc9PT1uJiY5MiE9PXImJihsPSExKTtlbHNlIGlmKDEyNCE9PW58fDEyND09PXQuY2hhckNvZGVBdChpKzEpfHwxMjQ9PT10LmNoYXJDb2RlQXQoaS0xKXx8Znx8cHx8ZCl7c3dpdGNoKG4pe2Nhc2UgMzQ6Yz0hMDticmVhaztjYXNlIDM5OnM9ITA7YnJlYWs7Y2FzZSA5Njp1PSEwO2JyZWFrO2Nhc2UgNDA6ZCsrO2JyZWFrO2Nhc2UgNDE6ZC0tO2JyZWFrO2Nhc2UgOTE6cCsrO2JyZWFrO2Nhc2UgOTM6cC0tO2JyZWFrO2Nhc2UgMTIzOmYrKzticmVhaztjYXNlIDEyNTpmLS19aWYoNDc9PT1uKXtmb3IodmFyIGg9aS0xLG09dm9pZCAwO2g+PTAmJiIgIj09PShtPXQuY2hhckF0KGgpKTtoLS0pO20mJklpLnRlc3QobSl8fChsPSEwKX19ZWxzZSB2b2lkIDA9PT1vPyh2PWkrMSxvPXQuc2xpY2UoMCxpKS50cmltKCkpOmUoKTtpZih2b2lkIDA9PT1vP289dC5zbGljZSgwLGkpLnRyaW0oKTowIT09diYmZSgpLGEpZm9yKGk9MDtpPGEubGVuZ3RoO2krKylvPWZ1bmN0aW9uKHQsZSl7dmFyIG49ZS5pbmRleE9mKCIoIik7e2lmKG48MClyZXR1cm4nX2YoIicrZSsnIikoJyt0KyIpIjt2YXIgcj1lLnNsaWNlKDAsbiksaT1lLnNsaWNlKG4rMSk7cmV0dXJuJ19mKCInK3IrJyIpKCcrdCsiLCIraX19KG8sYVtpXSk7cmV0dXJuIG99ZnVuY3Rpb24gc2UodCl7Y29uc29sZS5lcnJvcigiW1Z1ZSBjb21waWxlcl06ICIrdCl9ZnVuY3Rpb24gY2UodCxlKXtyZXR1cm4gdD90Lm1hcChmdW5jdGlvbih0KXtyZXR1cm4gdFtlXX0pLmZpbHRlcihmdW5jdGlvbih0KXtyZXR1cm4gdH0pOltdfWZ1bmN0aW9uIHVlKHQsZSxuKXsodC5wcm9wc3x8KHQucHJvcHM9W10pKS5wdXNoKHtuYW1lOmUsdmFsdWU6bn0pLHQucGxhaW49ITF9ZnVuY3Rpb24gbGUodCxlLG4peyh0LmF0dHJzfHwodC5hdHRycz1bXSkpLnB1c2goe25hbWU6ZSx2YWx1ZTpufSksdC5wbGFpbj0hMX1mdW5jdGlvbiBmZSh0LGUsbil7dC5hdHRyc01hcFtlXT1uLHQuYXR0cnNMaXN0LnB1c2goe25hbWU6ZSx2YWx1ZTpufSl9ZnVuY3Rpb24gcGUodCxlLG4scixpLG8peyh0LmRpcmVjdGl2ZXN8fCh0LmRpcmVjdGl2ZXM9W10pKS5wdXNoKHtuYW1lOmUscmF3TmFtZTpuLHZhbHVlOnIsYXJnOmksbW9kaWZpZXJzOm99KSx0LnBsYWluPSExfWZ1bmN0aW9uIGRlKHQsZSxuLHIsaSxvKXsocj1yfHxqbikuY2FwdHVyZSYmKGRlbGV0ZSByLmNhcHR1cmUsZT0iISIrZSksci5vbmNlJiYoZGVsZXRlIHIub25jZSxlPSJ+IitlKSxyLnBhc3NpdmUmJihkZWxldGUgci5wYXNzaXZlLGU9IiYiK2UpLCJjbGljayI9PT1lJiYoci5yaWdodD8oZT0iY29udGV4dG1lbnUiLGRlbGV0ZSByLnJpZ2h0KTpyLm1pZGRsZSYmKGU9Im1vdXNldXAiKSk7dmFyIGE7ci5uYXRpdmU/KGRlbGV0ZSByLm5hdGl2ZSxhPXQubmF0aXZlRXZlbnRzfHwodC5uYXRpdmVFdmVudHM9e30pKTphPXQuZXZlbnRzfHwodC5ldmVudHM9e30pO3ZhciBzPXt2YWx1ZTpufTtyIT09am4mJihzLm1vZGlmaWVycz1yKTt2YXIgYz1hW2VdO0FycmF5LmlzQXJyYXkoYyk/aT9jLnVuc2hpZnQocyk6Yy5wdXNoKHMpOmFbZV09Yz9pP1tzLGNdOltjLHNdOnMsdC5wbGFpbj0hMX1mdW5jdGlvbiB2ZSh0LGUsbil7dmFyIHI9aGUodCwiOiIrZSl8fGhlKHQsInYtYmluZDoiK2UpO2lmKG51bGwhPXIpcmV0dXJuIGFlKHIpO2lmKCExIT09bil7dmFyIGk9aGUodCxlKTtpZihudWxsIT1pKXJldHVybiBKU09OLnN0cmluZ2lmeShpKX19ZnVuY3Rpb24gaGUodCxlLG4pe3ZhciByO2lmKG51bGwhPShyPXQuYXR0cnNNYXBbZV0pKWZvcih2YXIgaT10LmF0dHJzTGlzdCxvPTAsYT1pLmxlbmd0aDtvPGE7bysrKWlmKGlbb10ubmFtZT09PWUpe2kuc3BsaWNlKG8sMSk7YnJlYWt9cmV0dXJuIG4mJmRlbGV0ZSB0LmF0dHJzTWFwW2VdLHJ9ZnVuY3Rpb24gbWUodCxlLG4pe3ZhciByPW58fHt9LGk9IiQkdiI7ci50cmltJiYoaT0iKHR5cGVvZiAkJHYgPT09ICdzdHJpbmcnPyAkJHYudHJpbSgpOiAkJHYpIiksci5udW1iZXImJihpPSJfbigiK2krIikiKTt2YXIgbz15ZShlLGkpO3QubW9kZWw9e3ZhbHVlOiIoIitlKyIpIixleHByZXNzaW9uOiciJytlKyciJyxjYWxsYmFjazoiZnVuY3Rpb24gKCQkdikgeyIrbysifSJ9fWZ1bmN0aW9uIHllKHQsZSl7dmFyIG49ZnVuY3Rpb24odCl7aWYoZWk9dC5sZW5ndGgsdC5pbmRleE9mKCJbIik8MHx8dC5sYXN0SW5kZXhPZigiXSIpPGVpLTEpcmV0dXJuKGlpPXQubGFzdEluZGV4T2YoIi4iKSk+LTE/e2V4cDp0LnNsaWNlKDAsaWkpLGtleTonIicrdC5zbGljZShpaSsxKSsnIid9OntleHA6dCxrZXk6bnVsbH07bmk9dCxpaT1vaT1haT0wO2Zvcig7IV9lKCk7KWJlKHJpPWdlKCkpPyRlKHJpKTo5MT09PXJpJiZmdW5jdGlvbih0KXt2YXIgZT0xO29pPWlpO2Zvcig7IV9lKCk7KWlmKHQ9Z2UoKSxiZSh0KSkkZSh0KTtlbHNlIGlmKDkxPT09dCYmZSsrLDkzPT09dCYmZS0tLDA9PT1lKXthaT1paTticmVha319KHJpKTtyZXR1cm57ZXhwOnQuc2xpY2UoMCxvaSksa2V5OnQuc2xpY2Uob2krMSxhaSl9fSh0KTtyZXR1cm4gbnVsbD09PW4ua2V5P3QrIj0iK2U6IiRzZXQoIituLmV4cCsiLCAiK24ua2V5KyIsICIrZSsiKSJ9ZnVuY3Rpb24gZ2UoKXtyZXR1cm4gbmkuY2hhckNvZGVBdCgrK2lpKX1mdW5jdGlvbiBfZSgpe3JldHVybiBpaT49ZWl9ZnVuY3Rpb24gYmUodCl7cmV0dXJuIDM0PT09dHx8Mzk9PT10fWZ1bmN0aW9uICRlKHQpe2Zvcih2YXIgZT10OyFfZSgpJiYodD1nZSgpKSE9PWU7KTt9ZnVuY3Rpb24gQ2UodCxlLG4scixpKXtlPWZ1bmN0aW9uKHQpe3JldHVybiB0Ll93aXRoVGFza3x8KHQuX3dpdGhUYXNrPWZ1bmN0aW9uKCl7RXI9ITA7dmFyIGU9dC5hcHBseShudWxsLGFyZ3VtZW50cyk7cmV0dXJuIEVyPSExLGV9KX0oZSksbiYmKGU9ZnVuY3Rpb24odCxlLG4pe3ZhciByPXNpO3JldHVybiBmdW5jdGlvbiBpKCl7bnVsbCE9PXQuYXBwbHkobnVsbCxhcmd1bWVudHMpJiZ3ZShlLGksbixyKX19KGUsdCxyKSksc2kuYWRkRXZlbnRMaXN0ZW5lcih0LGUsb3I/e2NhcHR1cmU6cixwYXNzaXZlOml9OnIpfWZ1bmN0aW9uIHdlKHQsZSxuLHIpeyhyfHxzaSkucmVtb3ZlRXZlbnRMaXN0ZW5lcih0LGUuX3dpdGhUYXNrfHxlLG4pfWZ1bmN0aW9uIHhlKG4scil7aWYoIXQobi5kYXRhLm9uKXx8IXQoci5kYXRhLm9uKSl7dmFyIGk9ci5kYXRhLm9ufHx7fSxvPW4uZGF0YS5vbnx8e307c2k9ci5lbG0sZnVuY3Rpb24odCl7aWYoZSh0W0xpXSkpe3ZhciBuPVFuPyJjaGFuZ2UiOiJpbnB1dCI7dFtuXT1bXS5jb25jYXQodFtMaV0sdFtuXXx8W10pLGRlbGV0ZSB0W0xpXX1lKHRbTWldKSYmKHQuY2hhbmdlPVtdLmNvbmNhdCh0W01pXSx0LmNoYW5nZXx8W10pLGRlbGV0ZSB0W01pXSl9KGkpLFgoaSxvLENlLHdlLHIuY29udGV4dCksc2k9dm9pZCAwfX1mdW5jdGlvbiBrZShuLHIpe2lmKCF0KG4uZGF0YS5kb21Qcm9wcyl8fCF0KHIuZGF0YS5kb21Qcm9wcykpe3ZhciBpLG8sYT1yLmVsbSxzPW4uZGF0YS5kb21Qcm9wc3x8e30sdT1yLmRhdGEuZG9tUHJvcHN8fHt9O2UodS5fX29iX18pJiYodT1yLmRhdGEuZG9tUHJvcHM9aCh7fSx1KSk7Zm9yKGkgaW4gcyl0KHVbaV0pJiYoYVtpXT0iIik7Zm9yKGkgaW4gdSl7aWYobz11W2ldLCJ0ZXh0Q29udGVudCI9PT1pfHwiaW5uZXJIVE1MIj09PWkpe2lmKHIuY2hpbGRyZW4mJihyLmNoaWxkcmVuLmxlbmd0aD0wKSxvPT09c1tpXSljb250aW51ZTsxPT09YS5jaGlsZE5vZGVzLmxlbmd0aCYmYS5yZW1vdmVDaGlsZChhLmNoaWxkTm9kZXNbMF0pfWlmKCJ2YWx1ZSI9PT1pKXthLl92YWx1ZT1vO3ZhciBsPXQobyk/IiI6U3RyaW5nKG8pOyhmdW5jdGlvbih0LG4pe3JldHVybiF0LmNvbXBvc2luZyYmKCJPUFRJT04iPT09dC50YWdOYW1lfHxmdW5jdGlvbih0LGUpe3ZhciBuPSEwO3RyeXtuPWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQhPT10fWNhdGNoKHQpe31yZXR1cm4gbiYmdC52YWx1ZSE9PWV9KHQsbil8fGZ1bmN0aW9uKHQsbil7dmFyIHI9dC52YWx1ZSxpPXQuX3ZNb2RpZmllcnM7aWYoZShpKSl7aWYoaS5sYXp5KXJldHVybiExO2lmKGkubnVtYmVyKXJldHVybiBjKHIpIT09YyhuKTtpZihpLnRyaW0pcmV0dXJuIHIudHJpbSgpIT09bi50cmltKCl9cmV0dXJuIHIhPT1ufSh0LG4pKX0pKGEsbCkmJihhLnZhbHVlPWwpfWVsc2UgYVtpXT1vfX19ZnVuY3Rpb24gQWUodCl7dmFyIGU9T2UodC5zdHlsZSk7cmV0dXJuIHQuc3RhdGljU3R5bGU/aCh0LnN0YXRpY1N0eWxlLGUpOmV9ZnVuY3Rpb24gT2UodCl7cmV0dXJuIEFycmF5LmlzQXJyYXkodCk/bSh0KToic3RyaW5nIj09dHlwZW9mIHQ/RmkodCk6dH1mdW5jdGlvbiBTZShuLHIpe3ZhciBpPXIuZGF0YSxvPW4uZGF0YTtpZighKHQoaS5zdGF0aWNTdHlsZSkmJnQoaS5zdHlsZSkmJnQoby5zdGF0aWNTdHlsZSkmJnQoby5zdHlsZSkpKXt2YXIgYSxzLGM9ci5lbG0sdT1vLnN0YXRpY1N0eWxlLGw9by5ub3JtYWxpemVkU3R5bGV8fG8uc3R5bGV8fHt9LGY9dXx8bCxwPU9lKHIuZGF0YS5zdHlsZSl8fHt9O3IuZGF0YS5ub3JtYWxpemVkU3R5bGU9ZShwLl9fb2JfXyk/aCh7fSxwKTpwO3ZhciBkPWZ1bmN0aW9uKHQsZSl7dmFyIG4scj17fTtpZihlKWZvcih2YXIgaT10O2kuY29tcG9uZW50SW5zdGFuY2U7KShpPWkuY29tcG9uZW50SW5zdGFuY2UuX3Zub2RlKSYmaS5kYXRhJiYobj1BZShpLmRhdGEpKSYmaChyLG4pOyhuPUFlKHQuZGF0YSkpJiZoKHIsbik7Zm9yKHZhciBvPXQ7bz1vLnBhcmVudDspby5kYXRhJiYobj1BZShvLmRhdGEpKSYmaChyLG4pO3JldHVybiByfShyLCEwKTtmb3IocyBpbiBmKXQoZFtzXSkmJkJpKGMscywiIik7Zm9yKHMgaW4gZCkoYT1kW3NdKSE9PWZbc10mJkJpKGMscyxudWxsPT1hPyIiOmEpfX1mdW5jdGlvbiBUZSh0LGUpe2lmKGUmJihlPWUudHJpbSgpKSlpZih0LmNsYXNzTGlzdCllLmluZGV4T2YoIiAiKT4tMT9lLnNwbGl0KC9ccysvKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3JldHVybiB0LmNsYXNzTGlzdC5hZGQoZSl9KTp0LmNsYXNzTGlzdC5hZGQoZSk7ZWxzZXt2YXIgbj0iICIrKHQuZ2V0QXR0cmlidXRlKCJjbGFzcyIpfHwiIikrIiAiO24uaW5kZXhPZigiICIrZSsiICIpPDAmJnQuc2V0QXR0cmlidXRlKCJjbGFzcyIsKG4rZSkudHJpbSgpKX19ZnVuY3Rpb24gRWUodCxlKXtpZihlJiYoZT1lLnRyaW0oKSkpaWYodC5jbGFzc0xpc3QpZS5pbmRleE9mKCIgIik+LTE/ZS5zcGxpdCgvXHMrLykuZm9yRWFjaChmdW5jdGlvbihlKXtyZXR1cm4gdC5jbGFzc0xpc3QucmVtb3ZlKGUpfSk6dC5jbGFzc0xpc3QucmVtb3ZlKGUpLHQuY2xhc3NMaXN0Lmxlbmd0aHx8dC5yZW1vdmVBdHRyaWJ1dGUoImNsYXNzIik7ZWxzZXtmb3IodmFyIG49IiAiKyh0LmdldEF0dHJpYnV0ZSgiY2xhc3MiKXx8IiIpKyIgIixyPSIgIitlKyIgIjtuLmluZGV4T2Yocik+PTA7KW49bi5yZXBsYWNlKHIsIiAiKTsobj1uLnRyaW0oKSk/dC5zZXRBdHRyaWJ1dGUoImNsYXNzIixuKTp0LnJlbW92ZUF0dHJpYnV0ZSgiY2xhc3MiKX19ZnVuY3Rpb24gamUodCl7aWYodCl7aWYoIm9iamVjdCI9PXR5cGVvZiB0KXt2YXIgZT17fTtyZXR1cm4hMSE9PXQuY3NzJiZoKGUsS2kodC5uYW1lfHwidiIpKSxoKGUsdCksZX1yZXR1cm4ic3RyaW5nIj09dHlwZW9mIHQ/S2kodCk6dm9pZCAwfX1mdW5jdGlvbiBOZSh0KXtRaShmdW5jdGlvbigpe1FpKHQpfSl9ZnVuY3Rpb24gSWUodCxlKXt2YXIgbj10Ll90cmFuc2l0aW9uQ2xhc3Nlc3x8KHQuX3RyYW5zaXRpb25DbGFzc2VzPVtdKTtuLmluZGV4T2YoZSk8MCYmKG4ucHVzaChlKSxUZSh0LGUpKX1mdW5jdGlvbiBMZSh0LGUpe3QuX3RyYW5zaXRpb25DbGFzc2VzJiZsKHQuX3RyYW5zaXRpb25DbGFzc2VzLGUpLEVlKHQsZSl9ZnVuY3Rpb24gTWUodCxlLG4pe3ZhciByPURlKHQsZSksaT1yLnR5cGUsbz1yLnRpbWVvdXQsYT1yLnByb3BDb3VudDtpZighaSlyZXR1cm4gbigpO3ZhciBzPWk9PT1xaT9aaTpZaSxjPTAsdT1mdW5jdGlvbigpe3QucmVtb3ZlRXZlbnRMaXN0ZW5lcihzLGwpLG4oKX0sbD1mdW5jdGlvbihlKXtlLnRhcmdldD09PXQmJisrYz49YSYmdSgpfTtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7YzxhJiZ1KCl9LG8rMSksdC5hZGRFdmVudExpc3RlbmVyKHMsbCl9ZnVuY3Rpb24gRGUodCxlKXt2YXIgbixyPXdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHQpLGk9cltHaSsiRGVsYXkiXS5zcGxpdCgiLCAiKSxvPXJbR2krIkR1cmF0aW9uIl0uc3BsaXQoIiwgIiksYT1QZShpLG8pLHM9cltYaSsiRGVsYXkiXS5zcGxpdCgiLCAiKSxjPXJbWGkrIkR1cmF0aW9uIl0uc3BsaXQoIiwgIiksdT1QZShzLGMpLGw9MCxmPTA7ZT09PXFpP2E+MCYmKG49cWksbD1hLGY9by5sZW5ndGgpOmU9PT1XaT91PjAmJihuPVdpLGw9dSxmPWMubGVuZ3RoKTpmPShuPShsPU1hdGgubWF4KGEsdSkpPjA/YT51P3FpOldpOm51bGwpP249PT1xaT9vLmxlbmd0aDpjLmxlbmd0aDowO3JldHVybnt0eXBlOm4sdGltZW91dDpsLHByb3BDb3VudDpmLGhhc1RyYW5zZm9ybTpuPT09cWkmJnRvLnRlc3QocltHaSsiUHJvcGVydHkiXSl9fWZ1bmN0aW9uIFBlKHQsZSl7Zm9yKDt0Lmxlbmd0aDxlLmxlbmd0aDspdD10LmNvbmNhdCh0KTtyZXR1cm4gTWF0aC5tYXguYXBwbHkobnVsbCxlLm1hcChmdW5jdGlvbihlLG4pe3JldHVybiBGZShlKStGZSh0W25dKX0pKX1mdW5jdGlvbiBGZSh0KXtyZXR1cm4gMWUzKk51bWJlcih0LnNsaWNlKDAsLTEpKX1mdW5jdGlvbiBSZShuLHIpe3ZhciBvPW4uZWxtO2Uoby5fbGVhdmVDYikmJihvLl9sZWF2ZUNiLmNhbmNlbGxlZD0hMCxvLl9sZWF2ZUNiKCkpO3ZhciBhPWplKG4uZGF0YS50cmFuc2l0aW9uKTtpZighdChhKSYmIWUoby5fZW50ZXJDYikmJjE9PT1vLm5vZGVUeXBlKXtmb3IodmFyIHM9YS5jc3MsdT1hLnR5cGUsbD1hLmVudGVyQ2xhc3MsZj1hLmVudGVyVG9DbGFzcyxwPWEuZW50ZXJBY3RpdmVDbGFzcyxkPWEuYXBwZWFyQ2xhc3Msdj1hLmFwcGVhclRvQ2xhc3MsaD1hLmFwcGVhckFjdGl2ZUNsYXNzLG09YS5iZWZvcmVFbnRlcix5PWEuZW50ZXIsZz1hLmFmdGVyRW50ZXIsXz1hLmVudGVyQ2FuY2VsbGVkLCQ9YS5iZWZvcmVBcHBlYXIsQz1hLmFwcGVhcix3PWEuYWZ0ZXJBcHBlYXIseD1hLmFwcGVhckNhbmNlbGxlZCxrPWEuZHVyYXRpb24sQT1QcixPPVByLiR2bm9kZTtPJiZPLnBhcmVudDspQT0oTz1PLnBhcmVudCkuY29udGV4dDt2YXIgUz0hQS5faXNNb3VudGVkfHwhbi5pc1Jvb3RJbnNlcnQ7aWYoIVN8fEN8fCIiPT09Qyl7dmFyIFQ9UyYmZD9kOmwsRT1TJiZoP2g6cCxqPVMmJnY/djpmLE49Uz8kfHxtOm0sST1TJiYiZnVuY3Rpb24iPT10eXBlb2YgQz9DOnksTD1TP3d8fGc6ZyxNPVM/eHx8XzpfLEQ9YyhpKGspP2suZW50ZXI6ayksUD0hMSE9PXMmJiF0cixGPVVlKEkpLFI9by5fZW50ZXJDYj1iKGZ1bmN0aW9uKCl7UCYmKExlKG8saiksTGUobyxFKSksUi5jYW5jZWxsZWQ/KFAmJkxlKG8sVCksTSYmTShvKSk6TCYmTChvKSxvLl9lbnRlckNiPW51bGx9KTtuLmRhdGEuc2hvd3x8WShuLCJpbnNlcnQiLGZ1bmN0aW9uKCl7dmFyIHQ9by5wYXJlbnROb2RlLGU9dCYmdC5fcGVuZGluZyYmdC5fcGVuZGluZ1tuLmtleV07ZSYmZS50YWc9PT1uLnRhZyYmZS5lbG0uX2xlYXZlQ2ImJmUuZWxtLl9sZWF2ZUNiKCksSSYmSShvLFIpfSksTiYmTihvKSxQJiYoSWUobyxUKSxJZShvLEUpLE5lKGZ1bmN0aW9uKCl7SWUobyxqKSxMZShvLFQpLFIuY2FuY2VsbGVkfHxGfHwoQmUoRCk/c2V0VGltZW91dChSLEQpOk1lKG8sdSxSKSl9KSksbi5kYXRhLnNob3cmJihyJiZyKCksSSYmSShvLFIpKSxQfHxGfHxSKCl9fX1mdW5jdGlvbiBIZShuLHIpe2Z1bmN0aW9uIG8oKXt4LmNhbmNlbGxlZHx8KG4uZGF0YS5zaG93fHwoKGEucGFyZW50Tm9kZS5fcGVuZGluZ3x8KGEucGFyZW50Tm9kZS5fcGVuZGluZz17fSkpW24ua2V5XT1uKSx2JiZ2KGEpLCQmJihJZShhLGYpLEllKGEsZCksTmUoZnVuY3Rpb24oKXtJZShhLHApLExlKGEsZikseC5jYW5jZWxsZWR8fEN8fChCZSh3KT9zZXRUaW1lb3V0KHgsdyk6TWUoYSxsLHgpKX0pKSxoJiZoKGEseCksJHx8Q3x8eCgpKX12YXIgYT1uLmVsbTtlKGEuX2VudGVyQ2IpJiYoYS5fZW50ZXJDYi5jYW5jZWxsZWQ9ITAsYS5fZW50ZXJDYigpKTt2YXIgcz1qZShuLmRhdGEudHJhbnNpdGlvbik7aWYodChzKXx8MSE9PWEubm9kZVR5cGUpcmV0dXJuIHIoKTtpZighZShhLl9sZWF2ZUNiKSl7dmFyIHU9cy5jc3MsbD1zLnR5cGUsZj1zLmxlYXZlQ2xhc3MscD1zLmxlYXZlVG9DbGFzcyxkPXMubGVhdmVBY3RpdmVDbGFzcyx2PXMuYmVmb3JlTGVhdmUsaD1zLmxlYXZlLG09cy5hZnRlckxlYXZlLHk9cy5sZWF2ZUNhbmNlbGxlZCxnPXMuZGVsYXlMZWF2ZSxfPXMuZHVyYXRpb24sJD0hMSE9PXUmJiF0cixDPVVlKGgpLHc9YyhpKF8pP18ubGVhdmU6XykseD1hLl9sZWF2ZUNiPWIoZnVuY3Rpb24oKXthLnBhcmVudE5vZGUmJmEucGFyZW50Tm9kZS5fcGVuZGluZyYmKGEucGFyZW50Tm9kZS5fcGVuZGluZ1tuLmtleV09bnVsbCksJCYmKExlKGEscCksTGUoYSxkKSkseC5jYW5jZWxsZWQ/KCQmJkxlKGEsZikseSYmeShhKSk6KHIoKSxtJiZtKGEpKSxhLl9sZWF2ZUNiPW51bGx9KTtnP2cobyk6bygpfX1mdW5jdGlvbiBCZSh0KXtyZXR1cm4ibnVtYmVyIj09dHlwZW9mIHQmJiFpc05hTih0KX1mdW5jdGlvbiBVZShuKXtpZih0KG4pKXJldHVybiExO3ZhciByPW4uZm5zO3JldHVybiBlKHIpP1VlKEFycmF5LmlzQXJyYXkocik/clswXTpyKToobi5fbGVuZ3RofHxuLmxlbmd0aCk+MX1mdW5jdGlvbiBWZSh0LGUpeyEwIT09ZS5kYXRhLnNob3cmJlJlKGUpfWZ1bmN0aW9uIHplKHQsZSxuKXtLZSh0LGUsbiksKFFufHxlcikmJnNldFRpbWVvdXQoZnVuY3Rpb24oKXtLZSh0LGUsbil9LDApfWZ1bmN0aW9uIEtlKHQsZSxuKXt2YXIgcj1lLnZhbHVlLGk9dC5tdWx0aXBsZTtpZighaXx8QXJyYXkuaXNBcnJheShyKSl7Zm9yKHZhciBvLGEscz0wLGM9dC5vcHRpb25zLmxlbmd0aDtzPGM7cysrKWlmKGE9dC5vcHRpb25zW3NdLGkpbz1fKHIscWUoYSkpPi0xLGEuc2VsZWN0ZWQhPT1vJiYoYS5zZWxlY3RlZD1vKTtlbHNlIGlmKGcocWUoYSkscikpcmV0dXJuIHZvaWQodC5zZWxlY3RlZEluZGV4IT09cyYmKHQuc2VsZWN0ZWRJbmRleD1zKSk7aXx8KHQuc2VsZWN0ZWRJbmRleD0tMSl9fWZ1bmN0aW9uIEplKHQsZSl7cmV0dXJuIGUuZXZlcnkoZnVuY3Rpb24oZSl7cmV0dXJuIWcoZSx0KX0pfWZ1bmN0aW9uIHFlKHQpe3JldHVybiJfdmFsdWUiaW4gdD90Ll92YWx1ZTp0LnZhbHVlfWZ1bmN0aW9uIFdlKHQpe3QudGFyZ2V0LmNvbXBvc2luZz0hMH1mdW5jdGlvbiBHZSh0KXt0LnRhcmdldC5jb21wb3NpbmcmJih0LnRhcmdldC5jb21wb3Npbmc9ITEsWmUodC50YXJnZXQsImlucHV0IikpfWZ1bmN0aW9uIFplKHQsZSl7dmFyIG49ZG9jdW1lbnQuY3JlYXRlRXZlbnQoIkhUTUxFdmVudHMiKTtuLmluaXRFdmVudChlLCEwLCEwKSx0LmRpc3BhdGNoRXZlbnQobil9ZnVuY3Rpb24gWGUodCl7cmV0dXJuIXQuY29tcG9uZW50SW5zdGFuY2V8fHQuZGF0YSYmdC5kYXRhLnRyYW5zaXRpb24/dDpYZSh0LmNvbXBvbmVudEluc3RhbmNlLl92bm9kZSl9ZnVuY3Rpb24gWWUodCl7dmFyIGU9dCYmdC5jb21wb25lbnRPcHRpb25zO3JldHVybiBlJiZlLkN0b3Iub3B0aW9ucy5hYnN0cmFjdD9ZZShpdChlLmNoaWxkcmVuKSk6dH1mdW5jdGlvbiBRZSh0KXt2YXIgZT17fSxuPXQuJG9wdGlvbnM7Zm9yKHZhciByIGluIG4ucHJvcHNEYXRhKWVbcl09dFtyXTt2YXIgaT1uLl9wYXJlbnRMaXN0ZW5lcnM7Zm9yKHZhciBvIGluIGkpZVtQbihvKV09aVtvXTtyZXR1cm4gZX1mdW5jdGlvbiB0bih0LGUpe2lmKC9cZC1rZWVwLWFsaXZlJC8udGVzdChlLnRhZykpcmV0dXJuIHQoImtlZXAtYWxpdmUiLHtwcm9wczplLmNvbXBvbmVudE9wdGlvbnMucHJvcHNEYXRhfSl9ZnVuY3Rpb24gZW4odCl7dC5lbG0uX21vdmVDYiYmdC5lbG0uX21vdmVDYigpLHQuZWxtLl9lbnRlckNiJiZ0LmVsbS5fZW50ZXJDYigpfWZ1bmN0aW9uIG5uKHQpe3QuZGF0YS5uZXdQb3M9dC5lbG0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCl9ZnVuY3Rpb24gcm4odCl7dmFyIGU9dC5kYXRhLnBvcyxuPXQuZGF0YS5uZXdQb3Mscj1lLmxlZnQtbi5sZWZ0LGk9ZS50b3Atbi50b3A7aWYocnx8aSl7dC5kYXRhLm1vdmVkPSEwO3ZhciBvPXQuZWxtLnN0eWxlO28udHJhbnNmb3JtPW8uV2Via2l0VHJhbnNmb3JtPSJ0cmFuc2xhdGUoIityKyJweCwiK2krInB4KSIsby50cmFuc2l0aW9uRHVyYXRpb249IjBzIn19ZnVuY3Rpb24gb24odCxlKXt2YXIgbj1lP3pvOlZvO3JldHVybiB0LnJlcGxhY2UobixmdW5jdGlvbih0KXtyZXR1cm4gVW9bdF19KX1mdW5jdGlvbiBhbih0LGUsbil7cmV0dXJue3R5cGU6MSx0YWc6dCxhdHRyc0xpc3Q6ZSxhdHRyc01hcDpmdW5jdGlvbih0KXtmb3IodmFyIGU9e30sbj0wLHI9dC5sZW5ndGg7bjxyO24rKyllW3Rbbl0ubmFtZV09dFtuXS52YWx1ZTtyZXR1cm4gZX0oZSkscGFyZW50Om4sY2hpbGRyZW46W119fWZ1bmN0aW9uIHNuKHQsZSl7ZnVuY3Rpb24gbih0KXt0LnByZSYmKHM9ITEpLExvKHQudGFnKSYmKGM9ITEpO2Zvcih2YXIgbj0wO248SW8ubGVuZ3RoO24rKylJb1tuXSh0LGUpfVRvPWUud2Fybnx8c2UsTG89ZS5pc1ByZVRhZ3x8Qm4sTW89ZS5tdXN0VXNlUHJvcHx8Qm4sRG89ZS5nZXRUYWdOYW1lc3BhY2V8fEJuLGpvPWNlKGUubW9kdWxlcywidHJhbnNmb3JtTm9kZSIpLE5vPWNlKGUubW9kdWxlcywicHJlVHJhbnNmb3JtTm9kZSIpLElvPWNlKGUubW9kdWxlcywicG9zdFRyYW5zZm9ybU5vZGUiKSxFbz1lLmRlbGltaXRlcnM7dmFyIHIsaSxvPVtdLGE9ITEhPT1lLnByZXNlcnZlV2hpdGVzcGFjZSxzPSExLGM9ITE7cmV0dXJuIGZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbihlKXtsKz1lLHQ9dC5zdWJzdHJpbmcoZSl9ZnVuY3Rpb24gcih0LG4scil7dmFyIGkscztpZihudWxsPT1uJiYobj1sKSxudWxsPT1yJiYocj1sKSx0JiYocz10LnRvTG93ZXJDYXNlKCkpLHQpZm9yKGk9YS5sZW5ndGgtMTtpPj0wJiZhW2ldLmxvd2VyQ2FzZWRUYWchPT1zO2ktLSk7ZWxzZSBpPTA7aWYoaT49MCl7Zm9yKHZhciBjPWEubGVuZ3RoLTE7Yz49aTtjLS0pZS5lbmQmJmUuZW5kKGFbY10udGFnLG4scik7YS5sZW5ndGg9aSxvPWkmJmFbaS0xXS50YWd9ZWxzZSJiciI9PT1zP2Uuc3RhcnQmJmUuc3RhcnQodCxbXSwhMCxuLHIpOiJwIj09PXMmJihlLnN0YXJ0JiZlLnN0YXJ0KHQsW10sITEsbixyKSxlLmVuZCYmZS5lbmQodCxuLHIpKX1mb3IodmFyIGksbyxhPVtdLHM9ZS5leHBlY3RIVE1MLGM9ZS5pc1VuYXJ5VGFnfHxCbix1PWUuY2FuQmVMZWZ0T3BlblRhZ3x8Qm4sbD0wO3Q7KXtpZihpPXQsbyYmSG8obykpe3ZhciBmPTAscD1vLnRvTG93ZXJDYXNlKCksZD1Cb1twXXx8KEJvW3BdPW5ldyBSZWdFeHAoIihbXFxzXFxTXSo/KSg8LyIrcCsiW14+XSo+KSIsImkiKSksdj10LnJlcGxhY2UoZCxmdW5jdGlvbih0LG4scil7cmV0dXJuIGY9ci5sZW5ndGgsSG8ocCl8fCJub3NjcmlwdCI9PT1wfHwobj1uLnJlcGxhY2UoLzwhLS0oW1xzXFNdKj8pLS0+L2csIiQxIikucmVwbGFjZSgvPCFcW0NEQVRBXFsoW1xzXFNdKj8pXV0+L2csIiQxIikpLEpvKHAsbikmJihuPW4uc2xpY2UoMSkpLGUuY2hhcnMmJmUuY2hhcnMobiksIiJ9KTtsKz10Lmxlbmd0aC12Lmxlbmd0aCx0PXYscihwLGwtZixsKX1lbHNle3ZhciBoPXQuaW5kZXhPZigiPCIpO2lmKDA9PT1oKXtpZihBby50ZXN0KHQpKXt2YXIgbT10LmluZGV4T2YoIi0tXHgzZSIpO2lmKG0+PTApe2Uuc2hvdWxkS2VlcENvbW1lbnQmJmUuY29tbWVudCh0LnN1YnN0cmluZyg0LG0pKSxuKG0rMyk7Y29udGludWV9fWlmKE9vLnRlc3QodCkpe3ZhciB5PXQuaW5kZXhPZigiXT4iKTtpZih5Pj0wKXtuKHkrMik7Y29udGludWV9fXZhciBnPXQubWF0Y2goa28pO2lmKGcpe24oZ1swXS5sZW5ndGgpO2NvbnRpbnVlfXZhciBfPXQubWF0Y2goeG8pO2lmKF8pe3ZhciBiPWw7bihfWzBdLmxlbmd0aCkscihfWzFdLGIsbCk7Y29udGludWV9dmFyICQ9ZnVuY3Rpb24oKXt2YXIgZT10Lm1hdGNoKENvKTtpZihlKXt2YXIgcj17dGFnTmFtZTplWzFdLGF0dHJzOltdLHN0YXJ0Omx9O24oZVswXS5sZW5ndGgpO2Zvcih2YXIgaSxvOyEoaT10Lm1hdGNoKHdvKSkmJihvPXQubWF0Y2goX28pKTspbihvWzBdLmxlbmd0aCksci5hdHRycy5wdXNoKG8pO2lmKGkpcmV0dXJuIHIudW5hcnlTbGFzaD1pWzFdLG4oaVswXS5sZW5ndGgpLHIuZW5kPWwscn19KCk7aWYoJCl7IWZ1bmN0aW9uKHQpe3ZhciBuPXQudGFnTmFtZSxpPXQudW5hcnlTbGFzaDtzJiYoInAiPT09byYmZ28obikmJnIobyksdShuKSYmbz09PW4mJnIobikpO2Zvcih2YXIgbD1jKG4pfHwhIWksZj10LmF0dHJzLmxlbmd0aCxwPW5ldyBBcnJheShmKSxkPTA7ZDxmO2QrKyl7dmFyIHY9dC5hdHRyc1tkXTtTbyYmLTE9PT12WzBdLmluZGV4T2YoJyIiJykmJigiIj09PXZbM10mJmRlbGV0ZSB2WzNdLCIiPT09dls0XSYmZGVsZXRlIHZbNF0sIiI9PT12WzVdJiZkZWxldGUgdls1XSk7dmFyIGg9dlszXXx8dls0XXx8dls1XXx8IiIsbT0iYSI9PT1uJiYiaHJlZiI9PT12WzFdP2Uuc2hvdWxkRGVjb2RlTmV3bGluZXNGb3JIcmVmOmUuc2hvdWxkRGVjb2RlTmV3bGluZXM7cFtkXT17bmFtZTp2WzFdLHZhbHVlOm9uKGgsbSl9fWx8fChhLnB1c2goe3RhZzpuLGxvd2VyQ2FzZWRUYWc6bi50b0xvd2VyQ2FzZSgpLGF0dHJzOnB9KSxvPW4pLGUuc3RhcnQmJmUuc3RhcnQobixwLGwsdC5zdGFydCx0LmVuZCl9KCQpLEpvKG8sdCkmJm4oMSk7Y29udGludWV9fXZhciBDPXZvaWQgMCx3PXZvaWQgMCx4PXZvaWQgMDtpZihoPj0wKXtmb3Iodz10LnNsaWNlKGgpOyEoeG8udGVzdCh3KXx8Q28udGVzdCh3KXx8QW8udGVzdCh3KXx8T28udGVzdCh3KXx8KHg9dy5pbmRleE9mKCI8IiwxKSk8MCk7KWgrPXgsdz10LnNsaWNlKGgpO0M9dC5zdWJzdHJpbmcoMCxoKSxuKGgpfWg8MCYmKEM9dCx0PSIiKSxlLmNoYXJzJiZDJiZlLmNoYXJzKEMpfWlmKHQ9PT1pKXtlLmNoYXJzJiZlLmNoYXJzKHQpO2JyZWFrfX1yKCl9KHQse3dhcm46VG8sZXhwZWN0SFRNTDplLmV4cGVjdEhUTUwsaXNVbmFyeVRhZzplLmlzVW5hcnlUYWcsY2FuQmVMZWZ0T3BlblRhZzplLmNhbkJlTGVmdE9wZW5UYWcsc2hvdWxkRGVjb2RlTmV3bGluZXM6ZS5zaG91bGREZWNvZGVOZXdsaW5lcyxzaG91bGREZWNvZGVOZXdsaW5lc0ZvckhyZWY6ZS5zaG91bGREZWNvZGVOZXdsaW5lc0ZvckhyZWYsc2hvdWxkS2VlcENvbW1lbnQ6ZS5jb21tZW50cyxzdGFydDpmdW5jdGlvbih0LGEsdSl7dmFyIGw9aSYmaS5uc3x8RG8odCk7UW4mJiJzdmciPT09bCYmKGE9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPVtdLG49MDtuPHQubGVuZ3RoO24rKyl7dmFyIHI9dFtuXTtuYS50ZXN0KHIubmFtZSl8fChyLm5hbWU9ci5uYW1lLnJlcGxhY2UocmEsIiIpLGUucHVzaChyKSl9cmV0dXJuIGV9KGEpKTt2YXIgZj1hbih0LGEsaSk7bCYmKGYubnM9bCksZnVuY3Rpb24odCl7cmV0dXJuInN0eWxlIj09PXQudGFnfHwic2NyaXB0Ij09PXQudGFnJiYoIXQuYXR0cnNNYXAudHlwZXx8InRleHQvamF2YXNjcmlwdCI9PT10LmF0dHJzTWFwLnR5cGUpfShmKSYmIXVyKCkmJihmLmZvcmJpZGRlbj0hMCk7Zm9yKHZhciBwPTA7cDxOby5sZW5ndGg7cCsrKWY9Tm9bcF0oZixlKXx8ZjtpZihzfHwoIWZ1bmN0aW9uKHQpe251bGwhPWhlKHQsInYtcHJlIikmJih0LnByZT0hMCl9KGYpLGYucHJlJiYocz0hMCkpLExvKGYudGFnKSYmKGM9ITApLHM/ZnVuY3Rpb24odCl7dmFyIGU9dC5hdHRyc0xpc3QubGVuZ3RoO2lmKGUpZm9yKHZhciBuPXQuYXR0cnM9bmV3IEFycmF5KGUpLHI9MDtyPGU7cisrKW5bcl09e25hbWU6dC5hdHRyc0xpc3Rbcl0ubmFtZSx2YWx1ZTpKU09OLnN0cmluZ2lmeSh0LmF0dHJzTGlzdFtyXS52YWx1ZSl9O2Vsc2UgdC5wcmV8fCh0LnBsYWluPSEwKX0oZik6Zi5wcm9jZXNzZWR8fCh1bihmKSxmdW5jdGlvbih0KXt2YXIgZT1oZSh0LCJ2LWlmIik7aWYoZSl0LmlmPWUsbG4odCx7ZXhwOmUsYmxvY2s6dH0pO2Vsc2V7bnVsbCE9aGUodCwidi1lbHNlIikmJih0LmVsc2U9ITApO3ZhciBuPWhlKHQsInYtZWxzZS1pZiIpO24mJih0LmVsc2VpZj1uKX19KGYpLGZ1bmN0aW9uKHQpe251bGwhPWhlKHQsInYtb25jZSIpJiYodC5vbmNlPSEwKX0oZiksY24oZixlKSkscj9vLmxlbmd0aHx8ci5pZiYmKGYuZWxzZWlmfHxmLmVsc2UpJiZsbihyLHtleHA6Zi5lbHNlaWYsYmxvY2s6Zn0pOnI9ZixpJiYhZi5mb3JiaWRkZW4paWYoZi5lbHNlaWZ8fGYuZWxzZSkhZnVuY3Rpb24odCxlKXt2YXIgbj1mdW5jdGlvbih0KXt2YXIgZT10Lmxlbmd0aDtmb3IoO2UtLTspe2lmKDE9PT10W2VdLnR5cGUpcmV0dXJuIHRbZV07dC5wb3AoKX19KGUuY2hpbGRyZW4pO24mJm4uaWYmJmxuKG4se2V4cDp0LmVsc2VpZixibG9jazp0fSl9KGYsaSk7ZWxzZSBpZihmLnNsb3RTY29wZSl7aS5wbGFpbj0hMTt2YXIgZD1mLnNsb3RUYXJnZXR8fCciZGVmYXVsdCInOyhpLnNjb3BlZFNsb3RzfHwoaS5zY29wZWRTbG90cz17fSkpW2RdPWZ9ZWxzZSBpLmNoaWxkcmVuLnB1c2goZiksZi5wYXJlbnQ9aTt1P24oZik6KGk9ZixvLnB1c2goZikpfSxlbmQ6ZnVuY3Rpb24oKXt2YXIgdD1vW28ubGVuZ3RoLTFdLGU9dC5jaGlsZHJlblt0LmNoaWxkcmVuLmxlbmd0aC0xXTtlJiYzPT09ZS50eXBlJiYiICI9PT1lLnRleHQmJiFjJiZ0LmNoaWxkcmVuLnBvcCgpLG8ubGVuZ3RoLT0xLGk9b1tvLmxlbmd0aC0xXSxuKHQpfSxjaGFyczpmdW5jdGlvbih0KXtpZihpJiYoIVFufHwidGV4dGFyZWEiIT09aS50YWd8fGkuYXR0cnNNYXAucGxhY2Vob2xkZXIhPT10KSl7dmFyIGU9aS5jaGlsZHJlbjtpZih0PWN8fHQudHJpbSgpP2Z1bmN0aW9uKHQpe3JldHVybiJzY3JpcHQiPT09dC50YWd8fCJzdHlsZSI9PT10LnRhZ30oaSk/dDplYSh0KTphJiZlLmxlbmd0aD8iICI6IiIpe3ZhciBuOyFzJiYiICIhPT10JiYobj1mdW5jdGlvbih0LGUpe3ZhciBuPWU/Zm8oZSk6dW87aWYobi50ZXN0KHQpKXtmb3IodmFyIHIsaSxvLGE9W10scz1bXSxjPW4ubGFzdEluZGV4PTA7cj1uLmV4ZWModCk7KXsoaT1yLmluZGV4KT5jJiYocy5wdXNoKG89dC5zbGljZShjLGkpKSxhLnB1c2goSlNPTi5zdHJpbmdpZnkobykpKTt2YXIgdT1hZShyWzFdLnRyaW0oKSk7YS5wdXNoKCJfcygiK3UrIikiKSxzLnB1c2goeyJAYmluZGluZyI6dX0pLGM9aStyWzBdLmxlbmd0aH1yZXR1cm4gYzx0Lmxlbmd0aCYmKHMucHVzaChvPXQuc2xpY2UoYykpLGEucHVzaChKU09OLnN0cmluZ2lmeShvKSkpLHtleHByZXNzaW9uOmEuam9pbigiKyIpLHRva2VuczpzfX19KHQsRW8pKT9lLnB1c2goe3R5cGU6MixleHByZXNzaW9uOm4uZXhwcmVzc2lvbix0b2tlbnM6bi50b2tlbnMsdGV4dDp0fSk6IiAiPT09dCYmZS5sZW5ndGgmJiIgIj09PWVbZS5sZW5ndGgtMV0udGV4dHx8ZS5wdXNoKHt0eXBlOjMsdGV4dDp0fSl9fX0sY29tbWVudDpmdW5jdGlvbih0KXtpLmNoaWxkcmVuLnB1c2goe3R5cGU6Myx0ZXh0OnQsaXNDb21tZW50OiEwfSl9fSkscn1mdW5jdGlvbiBjbih0LGUpeyFmdW5jdGlvbih0KXt2YXIgZT12ZSh0LCJrZXkiKTtlJiYodC5rZXk9ZSl9KHQpLHQucGxhaW49IXQua2V5JiYhdC5hdHRyc0xpc3QubGVuZ3RoLGZ1bmN0aW9uKHQpe3ZhciBlPXZlKHQsInJlZiIpO2UmJih0LnJlZj1lLHQucmVmSW5Gb3I9ZnVuY3Rpb24odCl7dmFyIGU9dDtmb3IoO2U7KXtpZih2b2lkIDAhPT1lLmZvcilyZXR1cm4hMDtlPWUucGFyZW50fXJldHVybiExfSh0KSl9KHQpLGZ1bmN0aW9uKHQpe2lmKCJzbG90Ij09PXQudGFnKXQuc2xvdE5hbWU9dmUodCwibmFtZSIpO2Vsc2V7dmFyIGU7InRlbXBsYXRlIj09PXQudGFnPyhlPWhlKHQsInNjb3BlIiksdC5zbG90U2NvcGU9ZXx8aGUodCwic2xvdC1zY29wZSIpKTooZT1oZSh0LCJzbG90LXNjb3BlIikpJiYodC5zbG90U2NvcGU9ZSk7dmFyIG49dmUodCwic2xvdCIpO24mJih0LnNsb3RUYXJnZXQ9JyIiJz09PW4/JyJkZWZhdWx0Iic6biwidGVtcGxhdGUiPT09dC50YWd8fHQuc2xvdFNjb3BlfHxsZSh0LCJzbG90IixuKSl9fSh0KSxmdW5jdGlvbih0KXt2YXIgZTsoZT12ZSh0LCJpcyIpKSYmKHQuY29tcG9uZW50PWUpO251bGwhPWhlKHQsImlubGluZS10ZW1wbGF0ZSIpJiYodC5pbmxpbmVUZW1wbGF0ZT0hMCl9KHQpO2Zvcih2YXIgbj0wO248am8ubGVuZ3RoO24rKyl0PWpvW25dKHQsZSl8fHQ7IWZ1bmN0aW9uKHQpe3ZhciBlLG4scixpLG8sYSxzLGM9dC5hdHRyc0xpc3Q7Zm9yKGU9MCxuPWMubGVuZ3RoO2U8bjtlKyspaWYocj1pPWNbZV0ubmFtZSxvPWNbZV0udmFsdWUsV28udGVzdChyKSlpZih0Lmhhc0JpbmRpbmdzPSEwLChhPWZ1bmN0aW9uKHQpe3ZhciBlPXQubWF0Y2godGEpO2lmKGUpe3ZhciBuPXt9O3JldHVybiBlLmZvckVhY2goZnVuY3Rpb24odCl7blt0LnNsaWNlKDEpXT0hMH0pLG59fShyKSkmJihyPXIucmVwbGFjZSh0YSwiIikpLFFvLnRlc3Qocikpcj1yLnJlcGxhY2UoUW8sIiIpLG89YWUobykscz0hMSxhJiYoYS5wcm9wJiYocz0hMCwiaW5uZXJIdG1sIj09PShyPVBuKHIpKSYmKHI9ImlubmVySFRNTCIpKSxhLmNhbWVsJiYocj1QbihyKSksYS5zeW5jJiZkZSh0LCJ1cGRhdGU6IitQbihyKSx5ZShvLCIkZXZlbnQiKSkpLHN8fCF0LmNvbXBvbmVudCYmTW8odC50YWcsdC5hdHRyc01hcC50eXBlLHIpP3VlKHQscixvKTpsZSh0LHIsbyk7ZWxzZSBpZihxby50ZXN0KHIpKXI9ci5yZXBsYWNlKHFvLCIiKSxkZSh0LHIsbyxhLCExKTtlbHNle3ZhciB1PShyPXIucmVwbGFjZShXbywiIikpLm1hdGNoKFlvKSxsPXUmJnVbMV07bCYmKHI9ci5zbGljZSgwLC0obC5sZW5ndGgrMSkpKSxwZSh0LHIsaSxvLGwsYSl9ZWxzZSBsZSh0LHIsSlNPTi5zdHJpbmdpZnkobykpLCF0LmNvbXBvbmVudCYmIm11dGVkIj09PXImJk1vKHQudGFnLHQuYXR0cnNNYXAudHlwZSxyKSYmdWUodCxyLCJ0cnVlIil9KHQpfWZ1bmN0aW9uIHVuKHQpe3ZhciBlO2lmKGU9aGUodCwidi1mb3IiKSl7dmFyIG49ZnVuY3Rpb24odCl7dmFyIGU9dC5tYXRjaChHbyk7aWYoIWUpcmV0dXJuO3ZhciBuPXt9O24uZm9yPWVbMl0udHJpbSgpO3ZhciByPWVbMV0udHJpbSgpLnJlcGxhY2UoWG8sIiIpLGk9ci5tYXRjaChabyk7aT8obi5hbGlhcz1yLnJlcGxhY2UoWm8sIiIpLG4uaXRlcmF0b3IxPWlbMV0udHJpbSgpLGlbMl0mJihuLml0ZXJhdG9yMj1pWzJdLnRyaW0oKSkpOm4uYWxpYXM9cjtyZXR1cm4gbn0oZSk7biYmaCh0LG4pfX1mdW5jdGlvbiBsbih0LGUpe3QuaWZDb25kaXRpb25zfHwodC5pZkNvbmRpdGlvbnM9W10pLHQuaWZDb25kaXRpb25zLnB1c2goZSl9ZnVuY3Rpb24gZm4odCl7cmV0dXJuIGFuKHQudGFnLHQuYXR0cnNMaXN0LnNsaWNlKCksdC5wYXJlbnQpfWZ1bmN0aW9uIHBuKHQpe2lmKHQuc3RhdGljPWZ1bmN0aW9uKHQpe2lmKDI9PT10LnR5cGUpcmV0dXJuITE7aWYoMz09PXQudHlwZSlyZXR1cm4hMDtyZXR1cm4hKCF0LnByZSYmKHQuaGFzQmluZGluZ3N8fHQuaWZ8fHQuZm9yfHxJbih0LnRhZyl8fCFGbyh0LnRhZyl8fGZ1bmN0aW9uKHQpe2Zvcig7dC5wYXJlbnQ7KXtpZigidGVtcGxhdGUiIT09KHQ9dC5wYXJlbnQpLnRhZylyZXR1cm4hMTtpZih0LmZvcilyZXR1cm4hMH1yZXR1cm4hMX0odCl8fCFPYmplY3Qua2V5cyh0KS5ldmVyeShQbykpKX0odCksMT09PXQudHlwZSl7aWYoIUZvKHQudGFnKSYmInNsb3QiIT09dC50YWcmJm51bGw9PXQuYXR0cnNNYXBbImlubGluZS10ZW1wbGF0ZSJdKXJldHVybjtmb3IodmFyIGU9MCxuPXQuY2hpbGRyZW4ubGVuZ3RoO2U8bjtlKyspe3ZhciByPXQuY2hpbGRyZW5bZV07cG4ociksci5zdGF0aWN8fCh0LnN0YXRpYz0hMSl9aWYodC5pZkNvbmRpdGlvbnMpZm9yKHZhciBpPTEsbz10LmlmQ29uZGl0aW9ucy5sZW5ndGg7aTxvO2krKyl7dmFyIGE9dC5pZkNvbmRpdGlvbnNbaV0uYmxvY2s7cG4oYSksYS5zdGF0aWN8fCh0LnN0YXRpYz0hMSl9fX1mdW5jdGlvbiBkbih0LGUpe2lmKDE9PT10LnR5cGUpe2lmKCh0LnN0YXRpY3x8dC5vbmNlKSYmKHQuc3RhdGljSW5Gb3I9ZSksdC5zdGF0aWMmJnQuY2hpbGRyZW4ubGVuZ3RoJiYoMSE9PXQuY2hpbGRyZW4ubGVuZ3RofHwzIT09dC5jaGlsZHJlblswXS50eXBlKSlyZXR1cm4gdm9pZCh0LnN0YXRpY1Jvb3Q9ITApO2lmKHQuc3RhdGljUm9vdD0hMSx0LmNoaWxkcmVuKWZvcih2YXIgbj0wLHI9dC5jaGlsZHJlbi5sZW5ndGg7bjxyO24rKylkbih0LmNoaWxkcmVuW25dLGV8fCEhdC5mb3IpO2lmKHQuaWZDb25kaXRpb25zKWZvcih2YXIgaT0xLG89dC5pZkNvbmRpdGlvbnMubGVuZ3RoO2k8bztpKyspZG4odC5pZkNvbmRpdGlvbnNbaV0uYmxvY2ssZSl9fWZ1bmN0aW9uIHZuKHQsZSxuKXt2YXIgcj1lPyJuYXRpdmVPbjp7Ijoib246eyI7Zm9yKHZhciBpIGluIHQpcis9JyInK2krJyI6JytobihpLHRbaV0pKyIsIjtyZXR1cm4gci5zbGljZSgwLC0xKSsifSJ9ZnVuY3Rpb24gaG4odCxlKXtpZighZSlyZXR1cm4iZnVuY3Rpb24oKXt9IjtpZihBcnJheS5pc0FycmF5KGUpKXJldHVybiJbIitlLm1hcChmdW5jdGlvbihlKXtyZXR1cm4gaG4odCxlKX0pLmpvaW4oIiwiKSsiXSI7dmFyIG49Y2EudGVzdChlLnZhbHVlKSxyPXNhLnRlc3QoZS52YWx1ZSk7aWYoZS5tb2RpZmllcnMpe3ZhciBpPSIiLG89IiIsYT1bXTtmb3IodmFyIHMgaW4gZS5tb2RpZmllcnMpaWYoZmFbc10pbys9ZmFbc10sdWFbc10mJmEucHVzaChzKTtlbHNlIGlmKCJleGFjdCI9PT1zKXt2YXIgYz1lLm1vZGlmaWVycztvKz1sYShbImN0cmwiLCJzaGlmdCIsImFsdCIsIm1ldGEiXS5maWx0ZXIoZnVuY3Rpb24odCl7cmV0dXJuIWNbdF19KS5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIiRldmVudC4iK3QrIktleSJ9KS5qb2luKCJ8fCIpKX1lbHNlIGEucHVzaChzKTthLmxlbmd0aCYmKGkrPWZ1bmN0aW9uKHQpe3JldHVybiJpZighKCdidXR0b24nIGluICRldmVudCkmJiIrdC5tYXAobW4pLmpvaW4oIiYmIikrIilyZXR1cm4gbnVsbDsifShhKSksbyYmKGkrPW8pO3JldHVybiJmdW5jdGlvbigkZXZlbnQpeyIraSsobj9lLnZhbHVlKyIoJGV2ZW50KSI6cj8iKCIrZS52YWx1ZSsiKSgkZXZlbnQpIjplLnZhbHVlKSsifSJ9cmV0dXJuIG58fHI/ZS52YWx1ZToiZnVuY3Rpb24oJGV2ZW50KXsiK2UudmFsdWUrIn0ifWZ1bmN0aW9uIG1uKHQpe3ZhciBlPXBhcnNlSW50KHQsMTApO2lmKGUpcmV0dXJuIiRldmVudC5rZXlDb2RlIT09IitlO3ZhciBuPXVhW3RdO3JldHVybiJfaygkZXZlbnQua2V5Q29kZSwiK0pTT04uc3RyaW5naWZ5KHQpKyIsIitKU09OLnN0cmluZ2lmeShuKSsiLCRldmVudC5rZXkpIn1mdW5jdGlvbiB5bih0LGUpe3ZhciBuPW5ldyBkYShlKTtyZXR1cm57cmVuZGVyOiJ3aXRoKHRoaXMpe3JldHVybiAiKyh0P2duKHQsbik6J19jKCJkaXYiKScpKyJ9IixzdGF0aWNSZW5kZXJGbnM6bi5zdGF0aWNSZW5kZXJGbnN9fWZ1bmN0aW9uIGduKHQsZSl7aWYodC5zdGF0aWNSb290JiYhdC5zdGF0aWNQcm9jZXNzZWQpcmV0dXJuIF9uKHQsZSk7aWYodC5vbmNlJiYhdC5vbmNlUHJvY2Vzc2VkKXJldHVybiBibih0LGUpO2lmKHQuZm9yJiYhdC5mb3JQcm9jZXNzZWQpcmV0dXJuIGZ1bmN0aW9uKHQsZSxuLHIpe3ZhciBpPXQuZm9yLG89dC5hbGlhcyxhPXQuaXRlcmF0b3IxPyIsIit0Lml0ZXJhdG9yMToiIixzPXQuaXRlcmF0b3IyPyIsIit0Lml0ZXJhdG9yMjoiIjtyZXR1cm4gdC5mb3JQcm9jZXNzZWQ9ITAsKHJ8fCJfbCIpKyIoKCIraSsiKSxmdW5jdGlvbigiK28rYStzKyIpe3JldHVybiAiKyhufHxnbikodCxlKSsifSkifSh0LGUpO2lmKHQuaWYmJiF0LmlmUHJvY2Vzc2VkKXJldHVybiAkbih0LGUpO2lmKCJ0ZW1wbGF0ZSIhPT10LnRhZ3x8dC5zbG90VGFyZ2V0KXtpZigic2xvdCI9PT10LnRhZylyZXR1cm4gZnVuY3Rpb24odCxlKXt2YXIgbj10LnNsb3ROYW1lfHwnImRlZmF1bHQiJyxyPWtuKHQsZSksaT0iX3QoIituKyhyPyIsIityOiIiKSxvPXQuYXR0cnMmJiJ7Iit0LmF0dHJzLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gUG4odC5uYW1lKSsiOiIrdC52YWx1ZX0pLmpvaW4oIiwiKSsifSIsYT10LmF0dHJzTWFwWyJ2LWJpbmQiXTshbyYmIWF8fHJ8fChpKz0iLG51bGwiKTtvJiYoaSs9IiwiK28pO2EmJihpKz0obz8iIjoiLG51bGwiKSsiLCIrYSk7cmV0dXJuIGkrIikifSh0LGUpO3ZhciBuO2lmKHQuY29tcG9uZW50KW49ZnVuY3Rpb24odCxlLG4pe3ZhciByPWUuaW5saW5lVGVtcGxhdGU/bnVsbDprbihlLG4sITApO3JldHVybiJfYygiK3QrIiwiK3duKGUsbikrKHI/IiwiK3I6IiIpKyIpIn0odC5jb21wb25lbnQsdCxlKTtlbHNle3ZhciByPXQucGxhaW4/dm9pZCAwOnduKHQsZSksaT10LmlubGluZVRlbXBsYXRlP251bGw6a24odCxlLCEwKTtuPSJfYygnIit0LnRhZysiJyIrKHI/IiwiK3I6IiIpKyhpPyIsIitpOiIiKSsiKSJ9Zm9yKHZhciBvPTA7bzxlLnRyYW5zZm9ybXMubGVuZ3RoO28rKyluPWUudHJhbnNmb3Jtc1tvXSh0LG4pO3JldHVybiBufXJldHVybiBrbih0LGUpfHwidm9pZCAwIn1mdW5jdGlvbiBfbih0LGUpe3JldHVybiB0LnN0YXRpY1Byb2Nlc3NlZD0hMCxlLnN0YXRpY1JlbmRlckZucy5wdXNoKCJ3aXRoKHRoaXMpe3JldHVybiAiK2duKHQsZSkrIn0iKSwiX20oIisoZS5zdGF0aWNSZW5kZXJGbnMubGVuZ3RoLTEpKyh0LnN0YXRpY0luRm9yPyIsdHJ1ZSI6IiIpKyIpIn1mdW5jdGlvbiBibih0LGUpe2lmKHQub25jZVByb2Nlc3NlZD0hMCx0LmlmJiYhdC5pZlByb2Nlc3NlZClyZXR1cm4gJG4odCxlKTtpZih0LnN0YXRpY0luRm9yKXtmb3IodmFyIG49IiIscj10LnBhcmVudDtyOyl7aWYoci5mb3Ipe249ci5rZXk7YnJlYWt9cj1yLnBhcmVudH1yZXR1cm4gbj8iX28oIitnbih0LGUpKyIsIitlLm9uY2VJZCsrKyIsIituKyIpIjpnbih0LGUpfXJldHVybiBfbih0LGUpfWZ1bmN0aW9uICRuKHQsZSxuLHIpe3JldHVybiB0LmlmUHJvY2Vzc2VkPSEwLENuKHQuaWZDb25kaXRpb25zLnNsaWNlKCksZSxuLHIpfWZ1bmN0aW9uIENuKHQsZSxuLHIpe2Z1bmN0aW9uIGkodCl7cmV0dXJuIG4/bih0LGUpOnQub25jZT9ibih0LGUpOmduKHQsZSl9aWYoIXQubGVuZ3RoKXJldHVybiByfHwiX2UoKSI7dmFyIG89dC5zaGlmdCgpO3JldHVybiBvLmV4cD8iKCIrby5leHArIik/IitpKG8uYmxvY2spKyI6IitDbih0LGUsbixyKToiIitpKG8uYmxvY2spfWZ1bmN0aW9uIHduKHQsZSl7dmFyIG49InsiLHI9ZnVuY3Rpb24odCxlKXt2YXIgbj10LmRpcmVjdGl2ZXM7aWYoIW4pcmV0dXJuO3ZhciByLGksbyxhLHM9ImRpcmVjdGl2ZXM6WyIsYz0hMTtmb3Iocj0wLGk9bi5sZW5ndGg7cjxpO3IrKyl7bz1uW3JdLGE9ITA7dmFyIHU9ZS5kaXJlY3RpdmVzW28ubmFtZV07dSYmKGE9ISF1KHQsbyxlLndhcm4pKSxhJiYoYz0hMCxzKz0ne25hbWU6Iicrby5uYW1lKyciLHJhd05hbWU6Iicrby5yYXdOYW1lKyciJysoby52YWx1ZT8iLHZhbHVlOigiK28udmFsdWUrIiksZXhwcmVzc2lvbjoiK0pTT04uc3RyaW5naWZ5KG8udmFsdWUpOiIiKSsoby5hcmc/Jyxhcmc6Iicrby5hcmcrJyInOiIiKSsoby5tb2RpZmllcnM/Iixtb2RpZmllcnM6IitKU09OLnN0cmluZ2lmeShvLm1vZGlmaWVycyk6IiIpKyJ9LCIpfWlmKGMpcmV0dXJuIHMuc2xpY2UoMCwtMSkrIl0ifSh0LGUpO3ImJihuKz1yKyIsIiksdC5rZXkmJihuKz0ia2V5OiIrdC5rZXkrIiwiKSx0LnJlZiYmKG4rPSJyZWY6Iit0LnJlZisiLCIpLHQucmVmSW5Gb3ImJihuKz0icmVmSW5Gb3I6dHJ1ZSwiKSx0LnByZSYmKG4rPSJwcmU6dHJ1ZSwiKSx0LmNvbXBvbmVudCYmKG4rPSd0YWc6IicrdC50YWcrJyIsJyk7Zm9yKHZhciBpPTA7aTxlLmRhdGFHZW5GbnMubGVuZ3RoO2krKyluKz1lLmRhdGFHZW5GbnNbaV0odCk7aWYodC5hdHRycyYmKG4rPSJhdHRyczp7IitPbih0LmF0dHJzKSsifSwiKSx0LnByb3BzJiYobis9ImRvbVByb3BzOnsiK09uKHQucHJvcHMpKyJ9LCIpLHQuZXZlbnRzJiYobis9dm4odC5ldmVudHMsITEsZS53YXJuKSsiLCIpLHQubmF0aXZlRXZlbnRzJiYobis9dm4odC5uYXRpdmVFdmVudHMsITAsZS53YXJuKSsiLCIpLHQuc2xvdFRhcmdldCYmIXQuc2xvdFNjb3BlJiYobis9InNsb3Q6Iit0LnNsb3RUYXJnZXQrIiwiKSx0LnNjb3BlZFNsb3RzJiYobis9ZnVuY3Rpb24odCxlKXtyZXR1cm4ic2NvcGVkU2xvdHM6X3UoWyIrT2JqZWN0LmtleXModCkubWFwKGZ1bmN0aW9uKG4pe3JldHVybiB4bihuLHRbbl0sZSl9KS5qb2luKCIsIikrIl0pIn0odC5zY29wZWRTbG90cyxlKSsiLCIpLHQubW9kZWwmJihuKz0ibW9kZWw6e3ZhbHVlOiIrdC5tb2RlbC52YWx1ZSsiLGNhbGxiYWNrOiIrdC5tb2RlbC5jYWxsYmFjaysiLGV4cHJlc3Npb246Iit0Lm1vZGVsLmV4cHJlc3Npb24rIn0sIiksdC5pbmxpbmVUZW1wbGF0ZSl7dmFyIG89ZnVuY3Rpb24odCxlKXt2YXIgbj10LmNoaWxkcmVuWzBdO2lmKDE9PT1uLnR5cGUpe3ZhciByPXluKG4sZS5vcHRpb25zKTtyZXR1cm4iaW5saW5lVGVtcGxhdGU6e3JlbmRlcjpmdW5jdGlvbigpeyIrci5yZW5kZXIrIn0sc3RhdGljUmVuZGVyRm5zOlsiK3Iuc3RhdGljUmVuZGVyRm5zLm1hcChmdW5jdGlvbih0KXtyZXR1cm4iZnVuY3Rpb24oKXsiK3QrIn0ifSkuam9pbigiLCIpKyJdfSJ9fSh0LGUpO28mJihuKz1vKyIsIil9cmV0dXJuIG49bi5yZXBsYWNlKC8sJC8sIiIpKyJ9Iix0LndyYXBEYXRhJiYobj10LndyYXBEYXRhKG4pKSx0LndyYXBMaXN0ZW5lcnMmJihuPXQud3JhcExpc3RlbmVycyhuKSksbn1mdW5jdGlvbiB4bih0LGUsbil7aWYoZS5mb3ImJiFlLmZvclByb2Nlc3NlZClyZXR1cm4gZnVuY3Rpb24odCxlLG4pe3ZhciByPWUuZm9yLGk9ZS5hbGlhcyxvPWUuaXRlcmF0b3IxPyIsIitlLml0ZXJhdG9yMToiIixhPWUuaXRlcmF0b3IyPyIsIitlLml0ZXJhdG9yMjoiIjtyZXR1cm4gZS5mb3JQcm9jZXNzZWQ9ITAsIl9sKCgiK3IrIiksZnVuY3Rpb24oIitpK28rYSsiKXtyZXR1cm4gIit4bih0LGUsbikrIn0pIn0odCxlLG4pO3JldHVybiJ7a2V5OiIrdCsiLGZuOiIrKCJmdW5jdGlvbigiK1N0cmluZyhlLnNsb3RTY29wZSkrIil7cmV0dXJuICIrKCJ0ZW1wbGF0ZSI9PT1lLnRhZz9lLmlmP2UuaWYrIj8iKyhrbihlLG4pfHwidW5kZWZpbmVkIikrIjp1bmRlZmluZWQiOmtuKGUsbil8fCJ1bmRlZmluZWQiOmduKGUsbikpKyJ9IikrIn0ifWZ1bmN0aW9uIGtuKHQsZSxuLHIsaSl7dmFyIG89dC5jaGlsZHJlbjtpZihvLmxlbmd0aCl7dmFyIGE9b1swXTtpZigxPT09by5sZW5ndGgmJmEuZm9yJiYidGVtcGxhdGUiIT09YS50YWcmJiJzbG90IiE9PWEudGFnKXJldHVybihyfHxnbikoYSxlKTt2YXIgcz1uP2Z1bmN0aW9uKHQsZSl7Zm9yKHZhciBuPTAscj0wO3I8dC5sZW5ndGg7cisrKXt2YXIgaT10W3JdO2lmKDE9PT1pLnR5cGUpe2lmKEFuKGkpfHxpLmlmQ29uZGl0aW9ucyYmaS5pZkNvbmRpdGlvbnMuc29tZShmdW5jdGlvbih0KXtyZXR1cm4gQW4odC5ibG9jayl9KSl7bj0yO2JyZWFrfShlKGkpfHxpLmlmQ29uZGl0aW9ucyYmaS5pZkNvbmRpdGlvbnMuc29tZShmdW5jdGlvbih0KXtyZXR1cm4gZSh0LmJsb2NrKX0pKSYmKG49MSl9fXJldHVybiBufShvLGUubWF5YmVDb21wb25lbnQpOjAsYz1pfHxmdW5jdGlvbih0LGUpe2lmKDE9PT10LnR5cGUpcmV0dXJuIGduKHQsZSk7cmV0dXJuIDM9PT10LnR5cGUmJnQuaXNDb21tZW50P2Z1bmN0aW9uKHQpe3JldHVybiJfZSgiK0pTT04uc3RyaW5naWZ5KHQudGV4dCkrIikifSh0KTpmdW5jdGlvbih0KXtyZXR1cm4iX3YoIisoMj09PXQudHlwZT90LmV4cHJlc3Npb246U24oSlNPTi5zdHJpbmdpZnkodC50ZXh0KSkpKyIpIn0odCl9O3JldHVybiJbIitvLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gYyh0LGUpfSkuam9pbigiLCIpKyJdIisocz8iLCIrczoiIil9fWZ1bmN0aW9uIEFuKHQpe3JldHVybiB2b2lkIDAhPT10LmZvcnx8InRlbXBsYXRlIj09PXQudGFnfHwic2xvdCI9PT10LnRhZ31mdW5jdGlvbiBPbih0KXtmb3IodmFyIGU9IiIsbj0wO248dC5sZW5ndGg7bisrKXt2YXIgcj10W25dO2UrPSciJytyLm5hbWUrJyI6JytTbihyLnZhbHVlKSsiLCJ9cmV0dXJuIGUuc2xpY2UoMCwtMSl9ZnVuY3Rpb24gU24odCl7cmV0dXJuIHQucmVwbGFjZSgvXHUyMDI4L2csIlxcdTIwMjgiKS5yZXBsYWNlKC9cdTIwMjkvZywiXFx1MjAyOSIpfWZ1bmN0aW9uIFRuKHQsZSl7dHJ5e3JldHVybiBuZXcgRnVuY3Rpb24odCl9Y2F0Y2gobil7cmV0dXJuIGUucHVzaCh7ZXJyOm4sY29kZTp0fSkseX19ZnVuY3Rpb24gRW4odCl7cmV0dXJuIFJvPVJvfHxkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSxSby5pbm5lckhUTUw9dD8nPGEgaHJlZj0iXG4iLz4nOic8ZGl2IGE9IlxuIi8+JyxSby5pbm5lckhUTUwuaW5kZXhPZigiJiMxMDsiKT4wfXZhciBqbj1PYmplY3QuZnJlZXplKHt9KSxObj1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLEluPXUoInNsb3QsY29tcG9uZW50IiwhMCksTG49dSgia2V5LHJlZixzbG90LHNsb3Qtc2NvcGUsaXMiKSxNbj1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LERuPS8tKFx3KS9nLFBuPXAoZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZShEbixmdW5jdGlvbih0LGUpe3JldHVybiBlP2UudG9VcHBlckNhc2UoKToiIn0pfSksRm49cChmdW5jdGlvbih0KXtyZXR1cm4gdC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSt0LnNsaWNlKDEpfSksUm49L1xCKFtBLVpdKS9nLEhuPXAoZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZShSbiwiLSQxIikudG9Mb3dlckNhc2UoKX0pLEJuPWZ1bmN0aW9uKHQsZSxuKXtyZXR1cm4hMX0sVW49ZnVuY3Rpb24odCl7cmV0dXJuIHR9LFZuPSJkYXRhLXNlcnZlci1yZW5kZXJlZCIsem49WyJjb21wb25lbnQiLCJkaXJlY3RpdmUiLCJmaWx0ZXIiXSxLbj1bImJlZm9yZUNyZWF0ZSIsImNyZWF0ZWQiLCJiZWZvcmVNb3VudCIsIm1vdW50ZWQiLCJiZWZvcmVVcGRhdGUiLCJ1cGRhdGVkIiwiYmVmb3JlRGVzdHJveSIsImRlc3Ryb3llZCIsImFjdGl2YXRlZCIsImRlYWN0aXZhdGVkIiwiZXJyb3JDYXB0dXJlZCJdLEpuPXtvcHRpb25NZXJnZVN0cmF0ZWdpZXM6T2JqZWN0LmNyZWF0ZShudWxsKSxzaWxlbnQ6ITEscHJvZHVjdGlvblRpcDohMSxkZXZ0b29sczohMSxwZXJmb3JtYW5jZTohMSxlcnJvckhhbmRsZXI6bnVsbCx3YXJuSGFuZGxlcjpudWxsLGlnbm9yZWRFbGVtZW50czpbXSxrZXlDb2RlczpPYmplY3QuY3JlYXRlKG51bGwpLGlzUmVzZXJ2ZWRUYWc6Qm4saXNSZXNlcnZlZEF0dHI6Qm4saXNVbmtub3duRWxlbWVudDpCbixnZXRUYWdOYW1lc3BhY2U6eSxwYXJzZVBsYXRmb3JtVGFnTmFtZTpVbixtdXN0VXNlUHJvcDpCbixfbGlmZWN5Y2xlSG9va3M6S259LHFuPS9bXlx3LiRdLyxXbj0iX19wcm90b19fImlue30sR249InVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3csWm49InVuZGVmaW5lZCIhPXR5cGVvZiBXWEVudmlyb25tZW50JiYhIVdYRW52aXJvbm1lbnQucGxhdGZvcm0sWG49Wm4mJldYRW52aXJvbm1lbnQucGxhdGZvcm0udG9Mb3dlckNhc2UoKSxZbj1HbiYmd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKSxRbj1ZbiYmL21zaWV8dHJpZGVudC8udGVzdChZbiksdHI9WW4mJlluLmluZGV4T2YoIm1zaWUgOS4wIik+MCxlcj1ZbiYmWW4uaW5kZXhPZigiZWRnZS8iKT4wLG5yPVluJiZZbi5pbmRleE9mKCJhbmRyb2lkIik+MHx8ImFuZHJvaWQiPT09WG4scnI9WW4mJi9pcGhvbmV8aXBhZHxpcG9kfGlvcy8udGVzdChZbil8fCJpb3MiPT09WG4saXI9KFluJiYvY2hyb21lXC9cZCsvLnRlc3QoWW4pLHt9LndhdGNoKSxvcj0hMTtpZihHbil0cnl7dmFyIGFyPXt9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShhciwicGFzc2l2ZSIse2dldDpmdW5jdGlvbigpe29yPSEwfX0pLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJ0ZXN0LXBhc3NpdmUiLG51bGwsYXIpfWNhdGNoKHQpe312YXIgc3IsY3IsdXI9ZnVuY3Rpb24oKXtyZXR1cm4gdm9pZCAwPT09c3ImJihzcj0hR24mJiJ1bmRlZmluZWQiIT10eXBlb2YgZ2xvYmFsJiYic2VydmVyIj09PWdsb2JhbC5wcm9jZXNzLmVudi5WVUVfRU5WKSxzcn0sbHI9R24mJndpbmRvdy5fX1ZVRV9ERVZUT09MU19HTE9CQUxfSE9PS19fLGZyPSJ1bmRlZmluZWQiIT10eXBlb2YgU3ltYm9sJiZ3KFN5bWJvbCkmJiJ1bmRlZmluZWQiIT10eXBlb2YgUmVmbGVjdCYmdyhSZWZsZWN0Lm93bktleXMpO2NyPSJ1bmRlZmluZWQiIT10eXBlb2YgU2V0JiZ3KFNldCk/U2V0OmZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3RoaXMuc2V0PU9iamVjdC5jcmVhdGUobnVsbCl9cmV0dXJuIHQucHJvdG90eXBlLmhhcz1mdW5jdGlvbih0KXtyZXR1cm4hMD09PXRoaXMuc2V0W3RdfSx0LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24odCl7dGhpcy5zZXRbdF09ITB9LHQucHJvdG90eXBlLmNsZWFyPWZ1bmN0aW9uKCl7dGhpcy5zZXQ9T2JqZWN0LmNyZWF0ZShudWxsKX0sdH0oKTt2YXIgcHI9eSxkcj0wLHZyPWZ1bmN0aW9uKCl7dGhpcy5pZD1kcisrLHRoaXMuc3Vicz1bXX07dnIucHJvdG90eXBlLmFkZFN1Yj1mdW5jdGlvbih0KXt0aGlzLnN1YnMucHVzaCh0KX0sdnIucHJvdG90eXBlLnJlbW92ZVN1Yj1mdW5jdGlvbih0KXtsKHRoaXMuc3Vicyx0KX0sdnIucHJvdG90eXBlLmRlcGVuZD1mdW5jdGlvbigpe3ZyLnRhcmdldCYmdnIudGFyZ2V0LmFkZERlcCh0aGlzKX0sdnIucHJvdG90eXBlLm5vdGlmeT1mdW5jdGlvbigpe2Zvcih2YXIgdD10aGlzLnN1YnMuc2xpY2UoKSxlPTAsbj10Lmxlbmd0aDtlPG47ZSsrKXRbZV0udXBkYXRlKCl9LHZyLnRhcmdldD1udWxsO3ZhciBocj1bXSxtcj1mdW5jdGlvbih0LGUsbixyLGksbyxhLHMpe3RoaXMudGFnPXQsdGhpcy5kYXRhPWUsdGhpcy5jaGlsZHJlbj1uLHRoaXMudGV4dD1yLHRoaXMuZWxtPWksdGhpcy5ucz12b2lkIDAsdGhpcy5jb250ZXh0PW8sdGhpcy5mbkNvbnRleHQ9dm9pZCAwLHRoaXMuZm5PcHRpb25zPXZvaWQgMCx0aGlzLmZuU2NvcGVJZD12b2lkIDAsdGhpcy5rZXk9ZSYmZS5rZXksdGhpcy5jb21wb25lbnRPcHRpb25zPWEsdGhpcy5jb21wb25lbnRJbnN0YW5jZT12b2lkIDAsdGhpcy5wYXJlbnQ9dm9pZCAwLHRoaXMucmF3PSExLHRoaXMuaXNTdGF0aWM9ITEsdGhpcy5pc1Jvb3RJbnNlcnQ9ITAsdGhpcy5pc0NvbW1lbnQ9ITEsdGhpcy5pc0Nsb25lZD0hMSx0aGlzLmlzT25jZT0hMSx0aGlzLmFzeW5jRmFjdG9yeT1zLHRoaXMuYXN5bmNNZXRhPXZvaWQgMCx0aGlzLmlzQXN5bmNQbGFjZWhvbGRlcj0hMX0seXI9e2NoaWxkOntjb25maWd1cmFibGU6ITB9fTt5ci5jaGlsZC5nZXQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb21wb25lbnRJbnN0YW5jZX0sT2JqZWN0LmRlZmluZVByb3BlcnRpZXMobXIucHJvdG90eXBlLHlyKTt2YXIgZ3I9ZnVuY3Rpb24odCl7dm9pZCAwPT09dCYmKHQ9IiIpO3ZhciBlPW5ldyBtcjtyZXR1cm4gZS50ZXh0PXQsZS5pc0NvbW1lbnQ9ITAsZX0sX3I9QXJyYXkucHJvdG90eXBlLGJyPU9iamVjdC5jcmVhdGUoX3IpO1sicHVzaCIsInBvcCIsInNoaWZ0IiwidW5zaGlmdCIsInNwbGljZSIsInNvcnQiLCJyZXZlcnNlIl0uZm9yRWFjaChmdW5jdGlvbih0KXt2YXIgZT1fclt0XTtDKGJyLHQsZnVuY3Rpb24oKXtmb3IodmFyIG49W10scj1hcmd1bWVudHMubGVuZ3RoO3ItLTspbltyXT1hcmd1bWVudHNbcl07dmFyIGksbz1lLmFwcGx5KHRoaXMsbiksYT10aGlzLl9fb2JfXztzd2l0Y2godCl7Y2FzZSJwdXNoIjpjYXNlInVuc2hpZnQiOmk9bjticmVhaztjYXNlInNwbGljZSI6aT1uLnNsaWNlKDIpfXJldHVybiBpJiZhLm9ic2VydmVBcnJheShpKSxhLmRlcC5ub3RpZnkoKSxvfSl9KTt2YXIgJHI9T2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoYnIpLENyPXtzaG91bGRDb252ZXJ0OiEwfSx3cj1mdW5jdGlvbih0KXtpZih0aGlzLnZhbHVlPXQsdGhpcy5kZXA9bmV3IHZyLHRoaXMudm1Db3VudD0wLEModCwiX19vYl9fIix0aGlzKSxBcnJheS5pc0FycmF5KHQpKXsoV24/TzpTKSh0LGJyLCRyKSx0aGlzLm9ic2VydmVBcnJheSh0KX1lbHNlIHRoaXMud2Fsayh0KX07d3IucHJvdG90eXBlLndhbGs9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPU9iamVjdC5rZXlzKHQpLG49MDtuPGUubGVuZ3RoO24rKylFKHQsZVtuXSx0W2Vbbl1dKX0sd3IucHJvdG90eXBlLm9ic2VydmVBcnJheT1mdW5jdGlvbih0KXtmb3IodmFyIGU9MCxuPXQubGVuZ3RoO2U8bjtlKyspVCh0W2VdKX07dmFyIHhyPUpuLm9wdGlvbk1lcmdlU3RyYXRlZ2llczt4ci5kYXRhPWZ1bmN0aW9uKHQsZSxuKXtyZXR1cm4gbj9NKHQsZSxuKTplJiYiZnVuY3Rpb24iIT10eXBlb2YgZT90Ok0odCxlKX0sS24uZm9yRWFjaChmdW5jdGlvbih0KXt4clt0XT1EfSksem4uZm9yRWFjaChmdW5jdGlvbih0KXt4clt0KyJzIl09UH0pLHhyLndhdGNoPWZ1bmN0aW9uKHQsZSxuLHIpe2lmKHQ9PT1pciYmKHQ9dm9pZCAwKSxlPT09aXImJihlPXZvaWQgMCksIWUpcmV0dXJuIE9iamVjdC5jcmVhdGUodHx8bnVsbCk7aWYoIXQpcmV0dXJuIGU7dmFyIGk9e307aChpLHQpO2Zvcih2YXIgbyBpbiBlKXt2YXIgYT1pW29dLHM9ZVtvXTthJiYhQXJyYXkuaXNBcnJheShhKSYmKGE9W2FdKSxpW29dPWE/YS5jb25jYXQocyk6QXJyYXkuaXNBcnJheShzKT9zOltzXX1yZXR1cm4gaX0seHIucHJvcHM9eHIubWV0aG9kcz14ci5pbmplY3Q9eHIuY29tcHV0ZWQ9ZnVuY3Rpb24odCxlLG4scil7aWYoIXQpcmV0dXJuIGU7dmFyIGk9T2JqZWN0LmNyZWF0ZShudWxsKTtyZXR1cm4gaChpLHQpLGUmJmgoaSxlKSxpfSx4ci5wcm92aWRlPU07dmFyIGtyLEFyLE9yPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHZvaWQgMD09PWU/dDplfSxTcj1bXSxUcj0hMSxFcj0hMTtpZigidW5kZWZpbmVkIiE9dHlwZW9mIHNldEltbWVkaWF0ZSYmdyhzZXRJbW1lZGlhdGUpKUFyPWZ1bmN0aW9uKCl7c2V0SW1tZWRpYXRlKEopfTtlbHNlIGlmKCJ1bmRlZmluZWQiPT10eXBlb2YgTWVzc2FnZUNoYW5uZWx8fCF3KE1lc3NhZ2VDaGFubmVsKSYmIltvYmplY3QgTWVzc2FnZUNoYW5uZWxDb25zdHJ1Y3Rvcl0iIT09TWVzc2FnZUNoYW5uZWwudG9TdHJpbmcoKSlBcj1mdW5jdGlvbigpe3NldFRpbWVvdXQoSiwwKX07ZWxzZXt2YXIganI9bmV3IE1lc3NhZ2VDaGFubmVsLE5yPWpyLnBvcnQyO2pyLnBvcnQxLm9ubWVzc2FnZT1KLEFyPWZ1bmN0aW9uKCl7TnIucG9zdE1lc3NhZ2UoMSl9fWlmKCJ1bmRlZmluZWQiIT10eXBlb2YgUHJvbWlzZSYmdyhQcm9taXNlKSl7dmFyIElyPVByb21pc2UucmVzb2x2ZSgpO2tyPWZ1bmN0aW9uKCl7SXIudGhlbihKKSxyciYmc2V0VGltZW91dCh5KX19ZWxzZSBrcj1Bcjt2YXIgTHIsTXI9bmV3IGNyLERyPXAoZnVuY3Rpb24odCl7dmFyIGU9IiYiPT09dC5jaGFyQXQoMCksbj0ifiI9PT0odD1lP3Quc2xpY2UoMSk6dCkuY2hhckF0KDApLHI9IiEiPT09KHQ9bj90LnNsaWNlKDEpOnQpLmNoYXJBdCgwKTtyZXR1cm4gdD1yP3Quc2xpY2UoMSk6dCx7bmFtZTp0LG9uY2U6bixjYXB0dXJlOnIscGFzc2l2ZTplfX0pLFByPW51bGwsRnI9W10sUnI9W10sSHI9e30sQnI9ITEsVXI9ITEsVnI9MCx6cj0wLEtyPWZ1bmN0aW9uKHQsZSxuLHIsaSl7dGhpcy52bT10LGkmJih0Ll93YXRjaGVyPXRoaXMpLHQuX3dhdGNoZXJzLnB1c2godGhpcykscj8odGhpcy5kZWVwPSEhci5kZWVwLHRoaXMudXNlcj0hIXIudXNlcix0aGlzLmxhenk9ISFyLmxhenksdGhpcy5zeW5jPSEhci5zeW5jKTp0aGlzLmRlZXA9dGhpcy51c2VyPXRoaXMubGF6eT10aGlzLnN5bmM9ITEsdGhpcy5jYj1uLHRoaXMuaWQ9Kyt6cix0aGlzLmFjdGl2ZT0hMCx0aGlzLmRpcnR5PXRoaXMubGF6eSx0aGlzLmRlcHM9W10sdGhpcy5uZXdEZXBzPVtdLHRoaXMuZGVwSWRzPW5ldyBjcix0aGlzLm5ld0RlcElkcz1uZXcgY3IsdGhpcy5leHByZXNzaW9uPSIiLCJmdW5jdGlvbiI9PXR5cGVvZiBlP3RoaXMuZ2V0dGVyPWU6KHRoaXMuZ2V0dGVyPWZ1bmN0aW9uKHQpe2lmKCFxbi50ZXN0KHQpKXt2YXIgZT10LnNwbGl0KCIuIik7cmV0dXJuIGZ1bmN0aW9uKHQpe2Zvcih2YXIgbj0wO248ZS5sZW5ndGg7bisrKXtpZighdClyZXR1cm47dD10W2Vbbl1dfXJldHVybiB0fX19KGUpLHRoaXMuZ2V0dGVyfHwodGhpcy5nZXR0ZXI9ZnVuY3Rpb24oKXt9KSksdGhpcy52YWx1ZT10aGlzLmxhenk/dm9pZCAwOnRoaXMuZ2V0KCl9O0tyLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oKXshZnVuY3Rpb24odCl7dnIudGFyZ2V0JiZoci5wdXNoKHZyLnRhcmdldCksdnIudGFyZ2V0PXR9KHRoaXMpO3ZhciB0LGU9dGhpcy52bTt0cnl7dD10aGlzLmdldHRlci5jYWxsKGUsZSl9Y2F0Y2godCl7aWYoIXRoaXMudXNlcil0aHJvdyB0O1YodCxlLCdnZXR0ZXIgZm9yIHdhdGNoZXIgIicrdGhpcy5leHByZXNzaW9uKyciJyl9ZmluYWxseXt0aGlzLmRlZXAmJlcodCksdnIudGFyZ2V0PWhyLnBvcCgpLHRoaXMuY2xlYW51cERlcHMoKX1yZXR1cm4gdH0sS3IucHJvdG90eXBlLmFkZERlcD1mdW5jdGlvbih0KXt2YXIgZT10LmlkO3RoaXMubmV3RGVwSWRzLmhhcyhlKXx8KHRoaXMubmV3RGVwSWRzLmFkZChlKSx0aGlzLm5ld0RlcHMucHVzaCh0KSx0aGlzLmRlcElkcy5oYXMoZSl8fHQuYWRkU3ViKHRoaXMpKX0sS3IucHJvdG90eXBlLmNsZWFudXBEZXBzPWZ1bmN0aW9uKCl7Zm9yKHZhciB0PXRoaXMuZGVwcy5sZW5ndGg7dC0tOyl7dmFyIGU9dGhpcy5kZXBzW3RdO3RoaXMubmV3RGVwSWRzLmhhcyhlLmlkKXx8ZS5yZW1vdmVTdWIodGhpcyl9dmFyIG49dGhpcy5kZXBJZHM7dGhpcy5kZXBJZHM9dGhpcy5uZXdEZXBJZHMsdGhpcy5uZXdEZXBJZHM9bix0aGlzLm5ld0RlcElkcy5jbGVhcigpLG49dGhpcy5kZXBzLHRoaXMuZGVwcz10aGlzLm5ld0RlcHMsdGhpcy5uZXdEZXBzPW4sdGhpcy5uZXdEZXBzLmxlbmd0aD0wfSxLci5wcm90b3R5cGUudXBkYXRlPWZ1bmN0aW9uKCl7dGhpcy5sYXp5P3RoaXMuZGlydHk9ITA6dGhpcy5zeW5jP3RoaXMucnVuKCk6ZnVuY3Rpb24odCl7dmFyIGU9dC5pZDtpZihudWxsPT1IcltlXSl7aWYoSHJbZV09ITAsVXIpe2Zvcih2YXIgbj1Gci5sZW5ndGgtMTtuPlZyJiZGcltuXS5pZD50LmlkOyluLS07RnIuc3BsaWNlKG4rMSwwLHQpfWVsc2UgRnIucHVzaCh0KTtCcnx8KEJyPSEwLHEoaHQpKX19KHRoaXMpfSxLci5wcm90b3R5cGUucnVuPWZ1bmN0aW9uKCl7aWYodGhpcy5hY3RpdmUpe3ZhciB0PXRoaXMuZ2V0KCk7aWYodCE9PXRoaXMudmFsdWV8fGkodCl8fHRoaXMuZGVlcCl7dmFyIGU9dGhpcy52YWx1ZTtpZih0aGlzLnZhbHVlPXQsdGhpcy51c2VyKXRyeXt0aGlzLmNiLmNhbGwodGhpcy52bSx0LGUpfWNhdGNoKHQpe1YodCx0aGlzLnZtLCdjYWxsYmFjayBmb3Igd2F0Y2hlciAiJyt0aGlzLmV4cHJlc3Npb24rJyInKX1lbHNlIHRoaXMuY2IuY2FsbCh0aGlzLnZtLHQsZSl9fX0sS3IucHJvdG90eXBlLmV2YWx1YXRlPWZ1bmN0aW9uKCl7dGhpcy52YWx1ZT10aGlzLmdldCgpLHRoaXMuZGlydHk9ITF9LEtyLnByb3RvdHlwZS5kZXBlbmQ9ZnVuY3Rpb24oKXtmb3IodmFyIHQ9dGhpcy5kZXBzLmxlbmd0aDt0LS07KXRoaXMuZGVwc1t0XS5kZXBlbmQoKX0sS3IucHJvdG90eXBlLnRlYXJkb3duPWZ1bmN0aW9uKCl7aWYodGhpcy5hY3RpdmUpe3RoaXMudm0uX2lzQmVpbmdEZXN0cm95ZWR8fGwodGhpcy52bS5fd2F0Y2hlcnMsdGhpcyk7Zm9yKHZhciB0PXRoaXMuZGVwcy5sZW5ndGg7dC0tOyl0aGlzLmRlcHNbdF0ucmVtb3ZlU3ViKHRoaXMpO3RoaXMuYWN0aXZlPSExfX07dmFyIEpyPXtlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCxnZXQ6eSxzZXQ6eX0scXI9e2xhenk6ITB9O050KEl0LnByb3RvdHlwZSk7dmFyIFdyPXtpbml0OmZ1bmN0aW9uKHQsbixyLGkpe2lmKCF0LmNvbXBvbmVudEluc3RhbmNlfHx0LmNvbXBvbmVudEluc3RhbmNlLl9pc0Rlc3Ryb3llZCl7KHQuY29tcG9uZW50SW5zdGFuY2U9ZnVuY3Rpb24odCxuLHIsaSl7dmFyIG89e19pc0NvbXBvbmVudDohMCxwYXJlbnQ6bixfcGFyZW50Vm5vZGU6dCxfcGFyZW50RWxtOnJ8fG51bGwsX3JlZkVsbTppfHxudWxsfSxhPXQuZGF0YS5pbmxpbmVUZW1wbGF0ZTtyZXR1cm4gZShhKSYmKG8ucmVuZGVyPWEucmVuZGVyLG8uc3RhdGljUmVuZGVyRm5zPWEuc3RhdGljUmVuZGVyRm5zKSxuZXcgdC5jb21wb25lbnRPcHRpb25zLkN0b3Iobyl9KHQsUHIscixpKSkuJG1vdW50KG4/dC5lbG06dm9pZCAwLG4pfWVsc2UgaWYodC5kYXRhLmtlZXBBbGl2ZSl7dmFyIG89dDtXci5wcmVwYXRjaChvLG8pfX0scHJlcGF0Y2g6ZnVuY3Rpb24odCxlKXt2YXIgbj1lLmNvbXBvbmVudE9wdGlvbnM7IWZ1bmN0aW9uKHQsZSxuLHIsaSl7dmFyIG89ISEoaXx8dC4kb3B0aW9ucy5fcmVuZGVyQ2hpbGRyZW58fHIuZGF0YS5zY29wZWRTbG90c3x8dC4kc2NvcGVkU2xvdHMhPT1qbik7aWYodC4kb3B0aW9ucy5fcGFyZW50Vm5vZGU9cix0LiR2bm9kZT1yLHQuX3Zub2RlJiYodC5fdm5vZGUucGFyZW50PXIpLHQuJG9wdGlvbnMuX3JlbmRlckNoaWxkcmVuPWksdC4kYXR0cnM9ci5kYXRhJiZyLmRhdGEuYXR0cnN8fGpuLHQuJGxpc3RlbmVycz1ufHxqbixlJiZ0LiRvcHRpb25zLnByb3BzKXtDci5zaG91bGRDb252ZXJ0PSExO2Zvcih2YXIgYT10Ll9wcm9wcyxzPXQuJG9wdGlvbnMuX3Byb3BLZXlzfHxbXSxjPTA7YzxzLmxlbmd0aDtjKyspe3ZhciB1PXNbY107YVt1XT1IKHUsdC4kb3B0aW9ucy5wcm9wcyxlLHQpfUNyLnNob3VsZENvbnZlcnQ9ITAsdC4kb3B0aW9ucy5wcm9wc0RhdGE9ZX1pZihuKXt2YXIgbD10LiRvcHRpb25zLl9wYXJlbnRMaXN0ZW5lcnM7dC4kb3B0aW9ucy5fcGFyZW50TGlzdGVuZXJzPW4sc3QodCxuLGwpfW8mJih0LiRzbG90cz1jdChpLHIuY29udGV4dCksdC4kZm9yY2VVcGRhdGUoKSl9KGUuY29tcG9uZW50SW5zdGFuY2U9dC5jb21wb25lbnRJbnN0YW5jZSxuLnByb3BzRGF0YSxuLmxpc3RlbmVycyxlLG4uY2hpbGRyZW4pfSxpbnNlcnQ6ZnVuY3Rpb24odCl7dmFyIGU9dC5jb250ZXh0LG49dC5jb21wb25lbnRJbnN0YW5jZTtuLl9pc01vdW50ZWR8fChuLl9pc01vdW50ZWQ9ITAsdnQobiwibW91bnRlZCIpKSx0LmRhdGEua2VlcEFsaXZlJiYoZS5faXNNb3VudGVkP2Z1bmN0aW9uKHQpe3QuX2luYWN0aXZlPSExLFJyLnB1c2godCl9KG4pOnB0KG4sITApKX0sZGVzdHJveTpmdW5jdGlvbih0KXt2YXIgZT10LmNvbXBvbmVudEluc3RhbmNlO2UuX2lzRGVzdHJveWVkfHwodC5kYXRhLmtlZXBBbGl2ZT9kdChlLCEwKTplLiRkZXN0cm95KCkpfX0sR3I9T2JqZWN0LmtleXMoV3IpLFpyPTEsWHI9MixZcj0wOyFmdW5jdGlvbih0KXt0LnByb3RvdHlwZS5faW5pdD1mdW5jdGlvbih0KXt0aGlzLl91aWQ9WXIrKyx0aGlzLl9pc1Z1ZT0hMCx0JiZ0Ll9pc0NvbXBvbmVudD9mdW5jdGlvbih0LGUpe3ZhciBuPXQuJG9wdGlvbnM9T2JqZWN0LmNyZWF0ZSh0LmNvbnN0cnVjdG9yLm9wdGlvbnMpLHI9ZS5fcGFyZW50Vm5vZGU7bi5wYXJlbnQ9ZS5wYXJlbnQsbi5fcGFyZW50Vm5vZGU9cixuLl9wYXJlbnRFbG09ZS5fcGFyZW50RWxtLG4uX3JlZkVsbT1lLl9yZWZFbG07dmFyIGk9ci5jb21wb25lbnRPcHRpb25zO24ucHJvcHNEYXRhPWkucHJvcHNEYXRhLG4uX3BhcmVudExpc3RlbmVycz1pLmxpc3RlbmVycyxuLl9yZW5kZXJDaGlsZHJlbj1pLmNoaWxkcmVuLG4uX2NvbXBvbmVudFRhZz1pLnRhZyxlLnJlbmRlciYmKG4ucmVuZGVyPWUucmVuZGVyLG4uc3RhdGljUmVuZGVyRm5zPWUuc3RhdGljUmVuZGVyRm5zKX0odGhpcyx0KTp0aGlzLiRvcHRpb25zPUYoRnQodGhpcy5jb25zdHJ1Y3RvciksdHx8e30sdGhpcyksdGhpcy5fcmVuZGVyUHJveHk9dGhpcyx0aGlzLl9zZWxmPXRoaXMsZnVuY3Rpb24odCl7dmFyIGU9dC4kb3B0aW9ucyxuPWUucGFyZW50O2lmKG4mJiFlLmFic3RyYWN0KXtmb3IoO24uJG9wdGlvbnMuYWJzdHJhY3QmJm4uJHBhcmVudDspbj1uLiRwYXJlbnQ7bi4kY2hpbGRyZW4ucHVzaCh0KX10LiRwYXJlbnQ9bix0LiRyb290PW4/bi4kcm9vdDp0LHQuJGNoaWxkcmVuPVtdLHQuJHJlZnM9e30sdC5fd2F0Y2hlcj1udWxsLHQuX2luYWN0aXZlPW51bGwsdC5fZGlyZWN0SW5hY3RpdmU9ITEsdC5faXNNb3VudGVkPSExLHQuX2lzRGVzdHJveWVkPSExLHQuX2lzQmVpbmdEZXN0cm95ZWQ9ITF9KHRoaXMpLGZ1bmN0aW9uKHQpe3QuX2V2ZW50cz1PYmplY3QuY3JlYXRlKG51bGwpLHQuX2hhc0hvb2tFdmVudD0hMTt2YXIgZT10LiRvcHRpb25zLl9wYXJlbnRMaXN0ZW5lcnM7ZSYmc3QodCxlKX0odGhpcyksZnVuY3Rpb24odCl7dC5fdm5vZGU9bnVsbCx0Ll9zdGF0aWNUcmVlcz1udWxsO3ZhciBlPXQuJG9wdGlvbnMsbj10LiR2bm9kZT1lLl9wYXJlbnRWbm9kZSxyPW4mJm4uY29udGV4dDt0LiRzbG90cz1jdChlLl9yZW5kZXJDaGlsZHJlbixyKSx0LiRzY29wZWRTbG90cz1qbix0Ll9jPWZ1bmN0aW9uKGUsbixyLGkpe3JldHVybiBEdCh0LGUsbixyLGksITEpfSx0LiRjcmVhdGVFbGVtZW50PWZ1bmN0aW9uKGUsbixyLGkpe3JldHVybiBEdCh0LGUsbixyLGksITApfTt2YXIgaT1uJiZuLmRhdGE7RSh0LCIkYXR0cnMiLGkmJmkuYXR0cnN8fGpuLDAsITApLEUodCwiJGxpc3RlbmVycyIsZS5fcGFyZW50TGlzdGVuZXJzfHxqbiwwLCEwKX0odGhpcyksdnQodGhpcywiYmVmb3JlQ3JlYXRlIiksZnVuY3Rpb24odCl7dmFyIGU9JHQodC4kb3B0aW9ucy5pbmplY3QsdCk7ZSYmKENyLnNob3VsZENvbnZlcnQ9ITEsT2JqZWN0LmtleXMoZSkuZm9yRWFjaChmdW5jdGlvbihuKXtFKHQsbixlW25dKX0pLENyLnNob3VsZENvbnZlcnQ9ITApfSh0aGlzKSx5dCh0aGlzKSxmdW5jdGlvbih0KXt2YXIgZT10LiRvcHRpb25zLnByb3ZpZGU7ZSYmKHQuX3Byb3ZpZGVkPSJmdW5jdGlvbiI9PXR5cGVvZiBlP2UuY2FsbCh0KTplKX0odGhpcyksdnQodGhpcywiY3JlYXRlZCIpLHRoaXMuJG9wdGlvbnMuZWwmJnRoaXMuJG1vdW50KHRoaXMuJG9wdGlvbnMuZWwpfX0oUnQpLGZ1bmN0aW9uKHQpe3ZhciBlPXt9O2UuZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2RhdGF9O3ZhciBuPXt9O24uZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Byb3BzfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsIiRkYXRhIixlKSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsIiRwcm9wcyIsbiksdC5wcm90b3R5cGUuJHNldD1qLHQucHJvdG90eXBlLiRkZWxldGU9Tix0LnByb3RvdHlwZS4kd2F0Y2g9ZnVuY3Rpb24odCxlLG4pe2lmKG8oZSkpcmV0dXJuIGJ0KHRoaXMsdCxlLG4pOyhuPW58fHt9KS51c2VyPSEwO3ZhciByPW5ldyBLcih0aGlzLHQsZSxuKTtyZXR1cm4gbi5pbW1lZGlhdGUmJmUuY2FsbCh0aGlzLHIudmFsdWUpLGZ1bmN0aW9uKCl7ci50ZWFyZG93bigpfX19KFJ0KSxmdW5jdGlvbih0KXt2YXIgZT0vXmhvb2s6Lzt0LnByb3RvdHlwZS4kb249ZnVuY3Rpb24odCxuKXtpZihBcnJheS5pc0FycmF5KHQpKWZvcih2YXIgcj0wLGk9dC5sZW5ndGg7cjxpO3IrKyl0aGlzLiRvbih0W3JdLG4pO2Vsc2UodGhpcy5fZXZlbnRzW3RdfHwodGhpcy5fZXZlbnRzW3RdPVtdKSkucHVzaChuKSxlLnRlc3QodCkmJih0aGlzLl9oYXNIb29rRXZlbnQ9ITApO3JldHVybiB0aGlzfSx0LnByb3RvdHlwZS4kb25jZT1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIG4oKXtyLiRvZmYodCxuKSxlLmFwcGx5KHIsYXJndW1lbnRzKX12YXIgcj10aGlzO3JldHVybiBuLmZuPWUsci4kb24odCxuKSxyfSx0LnByb3RvdHlwZS4kb2ZmPWZ1bmN0aW9uKHQsZSl7aWYoIWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHRoaXMuX2V2ZW50cz1PYmplY3QuY3JlYXRlKG51bGwpLHRoaXM7aWYoQXJyYXkuaXNBcnJheSh0KSl7Zm9yKHZhciBuPTAscj10Lmxlbmd0aDtuPHI7bisrKXRoaXMuJG9mZih0W25dLGUpO3JldHVybiB0aGlzfXZhciBpPXRoaXMuX2V2ZW50c1t0XTtpZighaSlyZXR1cm4gdGhpcztpZighZSlyZXR1cm4gdGhpcy5fZXZlbnRzW3RdPW51bGwsdGhpcztpZihlKWZvcih2YXIgbyxhPWkubGVuZ3RoO2EtLTspaWYoKG89aVthXSk9PT1lfHxvLmZuPT09ZSl7aS5zcGxpY2UoYSwxKTticmVha31yZXR1cm4gdGhpc30sdC5wcm90b3R5cGUuJGVtaXQ9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcyxuPWUuX2V2ZW50c1t0XTtpZihuKXtuPW4ubGVuZ3RoPjE/dihuKTpuO2Zvcih2YXIgcj12KGFyZ3VtZW50cywxKSxpPTAsbz1uLmxlbmd0aDtpPG87aSsrKXRyeXtuW2ldLmFwcGx5KGUscil9Y2F0Y2gobil7VihuLGUsJ2V2ZW50IGhhbmRsZXIgZm9yICInK3QrJyInKX19cmV0dXJuIGV9fShSdCksZnVuY3Rpb24odCl7dC5wcm90b3R5cGUuX3VwZGF0ZT1mdW5jdGlvbih0LGUpe3RoaXMuX2lzTW91bnRlZCYmdnQodGhpcywiYmVmb3JlVXBkYXRlIik7dmFyIG49dGhpcy4kZWwscj10aGlzLl92bm9kZSxpPVByO1ByPXRoaXMsdGhpcy5fdm5vZGU9dCxyP3RoaXMuJGVsPXRoaXMuX19wYXRjaF9fKHIsdCk6KHRoaXMuJGVsPXRoaXMuX19wYXRjaF9fKHRoaXMuJGVsLHQsZSwhMSx0aGlzLiRvcHRpb25zLl9wYXJlbnRFbG0sdGhpcy4kb3B0aW9ucy5fcmVmRWxtKSx0aGlzLiRvcHRpb25zLl9wYXJlbnRFbG09dGhpcy4kb3B0aW9ucy5fcmVmRWxtPW51bGwpLFByPWksbiYmKG4uX192dWVfXz1udWxsKSx0aGlzLiRlbCYmKHRoaXMuJGVsLl9fdnVlX189dGhpcyksdGhpcy4kdm5vZGUmJnRoaXMuJHBhcmVudCYmdGhpcy4kdm5vZGU9PT10aGlzLiRwYXJlbnQuX3Zub2RlJiYodGhpcy4kcGFyZW50LiRlbD10aGlzLiRlbCl9LHQucHJvdG90eXBlLiRmb3JjZVVwZGF0ZT1mdW5jdGlvbigpe3RoaXMuX3dhdGNoZXImJnRoaXMuX3dhdGNoZXIudXBkYXRlKCl9LHQucHJvdG90eXBlLiRkZXN0cm95PWZ1bmN0aW9uKCl7aWYoIXRoaXMuX2lzQmVpbmdEZXN0cm95ZWQpe3Z0KHRoaXMsImJlZm9yZURlc3Ryb3kiKSx0aGlzLl9pc0JlaW5nRGVzdHJveWVkPSEwO3ZhciB0PXRoaXMuJHBhcmVudDshdHx8dC5faXNCZWluZ0Rlc3Ryb3llZHx8dGhpcy4kb3B0aW9ucy5hYnN0cmFjdHx8bCh0LiRjaGlsZHJlbix0aGlzKSx0aGlzLl93YXRjaGVyJiZ0aGlzLl93YXRjaGVyLnRlYXJkb3duKCk7Zm9yKHZhciBlPXRoaXMuX3dhdGNoZXJzLmxlbmd0aDtlLS07KXRoaXMuX3dhdGNoZXJzW2VdLnRlYXJkb3duKCk7dGhpcy5fZGF0YS5fX29iX18mJnRoaXMuX2RhdGEuX19vYl9fLnZtQ291bnQtLSx0aGlzLl9pc0Rlc3Ryb3llZD0hMCx0aGlzLl9fcGF0Y2hfXyh0aGlzLl92bm9kZSxudWxsKSx2dCh0aGlzLCJkZXN0cm95ZWQiKSx0aGlzLiRvZmYoKSx0aGlzLiRlbCYmKHRoaXMuJGVsLl9fdnVlX189bnVsbCksdGhpcy4kdm5vZGUmJih0aGlzLiR2bm9kZS5wYXJlbnQ9bnVsbCl9fX0oUnQpLGZ1bmN0aW9uKHQpe050KHQucHJvdG90eXBlKSx0LnByb3RvdHlwZS4kbmV4dFRpY2s9ZnVuY3Rpb24odCl7cmV0dXJuIHEodCx0aGlzKX0sdC5wcm90b3R5cGUuX3JlbmRlcj1mdW5jdGlvbigpe3ZhciB0PXRoaXMsZT10LiRvcHRpb25zLG49ZS5yZW5kZXIscj1lLl9wYXJlbnRWbm9kZTtpZih0Ll9pc01vdW50ZWQpZm9yKHZhciBpIGluIHQuJHNsb3RzKXt2YXIgbz10LiRzbG90c1tpXTsoby5fcmVuZGVyZWR8fG9bMF0mJm9bMF0uZWxtKSYmKHQuJHNsb3RzW2ldPUEobywhMCkpfXQuJHNjb3BlZFNsb3RzPXImJnIuZGF0YS5zY29wZWRTbG90c3x8am4sdC4kdm5vZGU9cjt2YXIgYTt0cnl7YT1uLmNhbGwodC5fcmVuZGVyUHJveHksdC4kY3JlYXRlRWxlbWVudCl9Y2F0Y2goZSl7VihlLHQsInJlbmRlciIpLGE9dC5fdm5vZGV9cmV0dXJuIGEgaW5zdGFuY2VvZiBtcnx8KGE9Z3IoKSksYS5wYXJlbnQ9cixhfX0oUnQpO3ZhciBRcj1bU3RyaW5nLFJlZ0V4cCxBcnJheV0sdGk9e0tlZXBBbGl2ZTp7bmFtZToia2VlcC1hbGl2ZSIsYWJzdHJhY3Q6ITAscHJvcHM6e2luY2x1ZGU6UXIsZXhjbHVkZTpRcixtYXg6W1N0cmluZyxOdW1iZXJdfSxjcmVhdGVkOmZ1bmN0aW9uKCl7dGhpcy5jYWNoZT1PYmplY3QuY3JlYXRlKG51bGwpLHRoaXMua2V5cz1bXX0sZGVzdHJveWVkOmZ1bmN0aW9uKCl7Zm9yKHZhciB0IGluIHRoaXMuY2FjaGUpenQodGhpcy5jYWNoZSx0LHRoaXMua2V5cyl9LHdhdGNoOntpbmNsdWRlOmZ1bmN0aW9uKHQpe1Z0KHRoaXMsZnVuY3Rpb24oZSl7cmV0dXJuIFV0KHQsZSl9KX0sZXhjbHVkZTpmdW5jdGlvbih0KXtWdCh0aGlzLGZ1bmN0aW9uKGUpe3JldHVybiFVdCh0LGUpfSl9fSxyZW5kZXI6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLiRzbG90cy5kZWZhdWx0LGU9aXQodCksbj1lJiZlLmNvbXBvbmVudE9wdGlvbnM7aWYobil7dmFyIHI9QnQobiksaT10aGlzLmluY2x1ZGUsbz10aGlzLmV4Y2x1ZGU7aWYoaSYmKCFyfHwhVXQoaSxyKSl8fG8mJnImJlV0KG8scikpcmV0dXJuIGU7dmFyIGE9dGhpcy5jYWNoZSxzPXRoaXMua2V5cyxjPW51bGw9PWUua2V5P24uQ3Rvci5jaWQrKG4udGFnPyI6OiIrbi50YWc6IiIpOmUua2V5O2FbY10/KGUuY29tcG9uZW50SW5zdGFuY2U9YVtjXS5jb21wb25lbnRJbnN0YW5jZSxsKHMsYykscy5wdXNoKGMpKTooYVtjXT1lLHMucHVzaChjKSx0aGlzLm1heCYmcy5sZW5ndGg+cGFyc2VJbnQodGhpcy5tYXgpJiZ6dChhLHNbMF0scyx0aGlzLl92bm9kZSkpLGUuZGF0YS5rZWVwQWxpdmU9ITB9cmV0dXJuIGV8fHQmJnRbMF19fX07IWZ1bmN0aW9uKHQpe3ZhciBlPXt9O2UuZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIEpufSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiY29uZmlnIixlKSx0LnV0aWw9e3dhcm46cHIsZXh0ZW5kOmgsbWVyZ2VPcHRpb25zOkYsZGVmaW5lUmVhY3RpdmU6RX0sdC5zZXQ9aix0LmRlbGV0ZT1OLHQubmV4dFRpY2s9cSx0Lm9wdGlvbnM9T2JqZWN0LmNyZWF0ZShudWxsKSx6bi5mb3JFYWNoKGZ1bmN0aW9uKGUpe3Qub3B0aW9uc1tlKyJzIl09T2JqZWN0LmNyZWF0ZShudWxsKX0pLHQub3B0aW9ucy5fYmFzZT10LGgodC5vcHRpb25zLmNvbXBvbmVudHMsdGkpLGZ1bmN0aW9uKHQpe3QudXNlPWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX2luc3RhbGxlZFBsdWdpbnN8fCh0aGlzLl9pbnN0YWxsZWRQbHVnaW5zPVtdKTtpZihlLmluZGV4T2YodCk+LTEpcmV0dXJuIHRoaXM7dmFyIG49dihhcmd1bWVudHMsMSk7cmV0dXJuIG4udW5zaGlmdCh0aGlzKSwiZnVuY3Rpb24iPT10eXBlb2YgdC5pbnN0YWxsP3QuaW5zdGFsbC5hcHBseSh0LG4pOiJmdW5jdGlvbiI9PXR5cGVvZiB0JiZ0LmFwcGx5KG51bGwsbiksZS5wdXNoKHQpLHRoaXN9fSh0KSxmdW5jdGlvbih0KXt0Lm1peGluPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm9wdGlvbnM9Rih0aGlzLm9wdGlvbnMsdCksdGhpc319KHQpLEh0KHQpLGZ1bmN0aW9uKHQpe3puLmZvckVhY2goZnVuY3Rpb24oZSl7dFtlXT1mdW5jdGlvbih0LG4pe3JldHVybiBuPygiY29tcG9uZW50Ij09PWUmJm8obikmJihuLm5hbWU9bi5uYW1lfHx0LG49dGhpcy5vcHRpb25zLl9iYXNlLmV4dGVuZChuKSksImRpcmVjdGl2ZSI9PT1lJiYiZnVuY3Rpb24iPT10eXBlb2YgbiYmKG49e2JpbmQ6bix1cGRhdGU6bn0pLHRoaXMub3B0aW9uc1tlKyJzIl1bdF09bixuKTp0aGlzLm9wdGlvbnNbZSsicyJdW3RdfX0pfSh0KX0oUnQpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSdC5wcm90b3R5cGUsIiRpc1NlcnZlciIse2dldDp1cn0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSdC5wcm90b3R5cGUsIiRzc3JDb250ZXh0Iix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJHZub2RlJiZ0aGlzLiR2bm9kZS5zc3JDb250ZXh0fX0pLFJ0LnZlcnNpb249IjIuNS4xMyI7dmFyIGVpLG5pLHJpLGlpLG9pLGFpLHNpLGNpLHVpPXUoInN0eWxlLGNsYXNzIiksbGk9dSgiaW5wdXQsdGV4dGFyZWEsb3B0aW9uLHNlbGVjdCxwcm9ncmVzcyIpLGZpPWZ1bmN0aW9uKHQsZSxuKXtyZXR1cm4idmFsdWUiPT09biYmbGkodCkmJiJidXR0b24iIT09ZXx8InNlbGVjdGVkIj09PW4mJiJvcHRpb24iPT09dHx8ImNoZWNrZWQiPT09biYmImlucHV0Ij09PXR8fCJtdXRlZCI9PT1uJiYidmlkZW8iPT09dH0scGk9dSgiY29udGVudGVkaXRhYmxlLGRyYWdnYWJsZSxzcGVsbGNoZWNrIiksZGk9dSgiYWxsb3dmdWxsc2NyZWVuLGFzeW5jLGF1dG9mb2N1cyxhdXRvcGxheSxjaGVja2VkLGNvbXBhY3QsY29udHJvbHMsZGVjbGFyZSxkZWZhdWx0LGRlZmF1bHRjaGVja2VkLGRlZmF1bHRtdXRlZCxkZWZhdWx0c2VsZWN0ZWQsZGVmZXIsZGlzYWJsZWQsZW5hYmxlZCxmb3Jtbm92YWxpZGF0ZSxoaWRkZW4saW5kZXRlcm1pbmF0ZSxpbmVydCxpc21hcCxpdGVtc2NvcGUsbG9vcCxtdWx0aXBsZSxtdXRlZCxub2hyZWYsbm9yZXNpemUsbm9zaGFkZSxub3ZhbGlkYXRlLG5vd3JhcCxvcGVuLHBhdXNlb25leGl0LHJlYWRvbmx5LHJlcXVpcmVkLHJldmVyc2VkLHNjb3BlZCxzZWFtbGVzcyxzZWxlY3RlZCxzb3J0YWJsZSx0cmFuc2xhdGUsdHJ1ZXNwZWVkLHR5cGVtdXN0bWF0Y2gsdmlzaWJsZSIpLHZpPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIixoaT1mdW5jdGlvbih0KXtyZXR1cm4iOiI9PT10LmNoYXJBdCg1KSYmInhsaW5rIj09PXQuc2xpY2UoMCw1KX0sbWk9ZnVuY3Rpb24odCl7cmV0dXJuIGhpKHQpP3Quc2xpY2UoNix0Lmxlbmd0aCk6IiJ9LHlpPWZ1bmN0aW9uKHQpe3JldHVybiBudWxsPT10fHwhMT09PXR9LGdpPXtzdmc6Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIixtYXRoOiJodHRwOi8vd3d3LnczLm9yZy8xOTk4L01hdGgvTWF0aE1MIn0sX2k9dSgiaHRtbCxib2R5LGJhc2UsaGVhZCxsaW5rLG1ldGEsc3R5bGUsdGl0bGUsYWRkcmVzcyxhcnRpY2xlLGFzaWRlLGZvb3RlcixoZWFkZXIsaDEsaDIsaDMsaDQsaDUsaDYsaGdyb3VwLG5hdixzZWN0aW9uLGRpdixkZCxkbCxkdCxmaWdjYXB0aW9uLGZpZ3VyZSxwaWN0dXJlLGhyLGltZyxsaSxtYWluLG9sLHAscHJlLHVsLGEsYixhYmJyLGJkaSxiZG8sYnIsY2l0ZSxjb2RlLGRhdGEsZGZuLGVtLGksa2JkLG1hcmsscSxycCxydCxydGMscnVieSxzLHNhbXAsc21hbGwsc3BhbixzdHJvbmcsc3ViLHN1cCx0aW1lLHUsdmFyLHdicixhcmVhLGF1ZGlvLG1hcCx0cmFjayx2aWRlbyxlbWJlZCxvYmplY3QscGFyYW0sc291cmNlLGNhbnZhcyxzY3JpcHQsbm9zY3JpcHQsZGVsLGlucyxjYXB0aW9uLGNvbCxjb2xncm91cCx0YWJsZSx0aGVhZCx0Ym9keSx0ZCx0aCx0cixidXR0b24sZGF0YWxpc3QsZmllbGRzZXQsZm9ybSxpbnB1dCxsYWJlbCxsZWdlbmQsbWV0ZXIsb3B0Z3JvdXAsb3B0aW9uLG91dHB1dCxwcm9ncmVzcyxzZWxlY3QsdGV4dGFyZWEsZGV0YWlscyxkaWFsb2csbWVudSxtZW51aXRlbSxzdW1tYXJ5LGNvbnRlbnQsZWxlbWVudCxzaGFkb3csdGVtcGxhdGUsYmxvY2txdW90ZSxpZnJhbWUsdGZvb3QiKSxiaT11KCJzdmcsYW5pbWF0ZSxjaXJjbGUsY2xpcHBhdGgsY3Vyc29yLGRlZnMsZGVzYyxlbGxpcHNlLGZpbHRlcixmb250LWZhY2UsZm9yZWlnbk9iamVjdCxnLGdseXBoLGltYWdlLGxpbmUsbWFya2VyLG1hc2ssbWlzc2luZy1nbHlwaCxwYXRoLHBhdHRlcm4scG9seWdvbixwb2x5bGluZSxyZWN0LHN3aXRjaCxzeW1ib2wsdGV4dCx0ZXh0cGF0aCx0c3Bhbix1c2UsdmlldyIsITApLCRpPWZ1bmN0aW9uKHQpe3JldHVybiBfaSh0KXx8YmkodCl9LENpPU9iamVjdC5jcmVhdGUobnVsbCksd2k9dSgidGV4dCxudW1iZXIscGFzc3dvcmQsc2VhcmNoLGVtYWlsLHRlbCx1cmwiKSx4aT1PYmplY3QuZnJlZXplKHtjcmVhdGVFbGVtZW50OmZ1bmN0aW9uKHQsZSl7dmFyIG49ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0KTtyZXR1cm4ic2VsZWN0IiE9PXQ/bjooZS5kYXRhJiZlLmRhdGEuYXR0cnMmJnZvaWQgMCE9PWUuZGF0YS5hdHRycy5tdWx0aXBsZSYmbi5zZXRBdHRyaWJ1dGUoIm11bHRpcGxlIiwibXVsdGlwbGUiKSxuKX0sY3JlYXRlRWxlbWVudE5TOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhnaVt0XSxlKX0sY3JlYXRlVGV4dE5vZGU6ZnVuY3Rpb24odCl7cmV0dXJuIGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHQpfSxjcmVhdGVDb21tZW50OmZ1bmN0aW9uKHQpe3JldHVybiBkb2N1bWVudC5jcmVhdGVDb21tZW50KHQpfSxpbnNlcnRCZWZvcmU6ZnVuY3Rpb24odCxlLG4pe3QuaW5zZXJ0QmVmb3JlKGUsbil9LHJlbW92ZUNoaWxkOmZ1bmN0aW9uKHQsZSl7dC5yZW1vdmVDaGlsZChlKX0sYXBwZW5kQ2hpbGQ6ZnVuY3Rpb24odCxlKXt0LmFwcGVuZENoaWxkKGUpfSxwYXJlbnROb2RlOmZ1bmN0aW9uKHQpe3JldHVybiB0LnBhcmVudE5vZGV9LG5leHRTaWJsaW5nOmZ1bmN0aW9uKHQpe3JldHVybiB0Lm5leHRTaWJsaW5nfSx0YWdOYW1lOmZ1bmN0aW9uKHQpe3JldHVybiB0LnRhZ05hbWV9LHNldFRleHRDb250ZW50OmZ1bmN0aW9uKHQsZSl7dC50ZXh0Q29udGVudD1lfSxzZXRBdHRyaWJ1dGU6ZnVuY3Rpb24odCxlLG4pe3Quc2V0QXR0cmlidXRlKGUsbil9fSksa2k9e2NyZWF0ZTpmdW5jdGlvbih0LGUpe1h0KGUpfSx1cGRhdGU6ZnVuY3Rpb24odCxlKXt0LmRhdGEucmVmIT09ZS5kYXRhLnJlZiYmKFh0KHQsITApLFh0KGUpKX0sZGVzdHJveTpmdW5jdGlvbih0KXtYdCh0LCEwKX19LEFpPW5ldyBtcigiIix7fSxbXSksT2k9WyJjcmVhdGUiLCJhY3RpdmF0ZSIsInVwZGF0ZSIsInJlbW92ZSIsImRlc3Ryb3kiXSxTaT17Y3JlYXRlOnRlLHVwZGF0ZTp0ZSxkZXN0cm95OmZ1bmN0aW9uKHQpe3RlKHQsQWkpfX0sVGk9T2JqZWN0LmNyZWF0ZShudWxsKSxFaT1ba2ksU2ldLGppPXtjcmVhdGU6cmUsdXBkYXRlOnJlfSxOaT17Y3JlYXRlOm9lLHVwZGF0ZTpvZX0sSWk9L1tcdykuK1wtXyRcXV0vLExpPSJfX3IiLE1pPSJfX2MiLERpPXtjcmVhdGU6eGUsdXBkYXRlOnhlfSxQaT17Y3JlYXRlOmtlLHVwZGF0ZTprZX0sRmk9cChmdW5jdGlvbih0KXt2YXIgZT17fSxuPS86KC4rKS87cmV0dXJuIHQuc3BsaXQoLzsoPyFbXihdKlwpKS9nKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe2lmKHQpe3ZhciByPXQuc3BsaXQobik7ci5sZW5ndGg+MSYmKGVbclswXS50cmltKCldPXJbMV0udHJpbSgpKX19KSxlfSksUmk9L14tLS8sSGk9L1xzKiFpbXBvcnRhbnQkLyxCaT1mdW5jdGlvbih0LGUsbil7aWYoUmkudGVzdChlKSl0LnN0eWxlLnNldFByb3BlcnR5KGUsbik7ZWxzZSBpZihIaS50ZXN0KG4pKXQuc3R5bGUuc2V0UHJvcGVydHkoZSxuLnJlcGxhY2UoSGksIiIpLCJpbXBvcnRhbnQiKTtlbHNle3ZhciByPVZpKGUpO2lmKEFycmF5LmlzQXJyYXkobikpZm9yKHZhciBpPTAsbz1uLmxlbmd0aDtpPG87aSsrKXQuc3R5bGVbcl09bltpXTtlbHNlIHQuc3R5bGVbcl09bn19LFVpPVsiV2Via2l0IiwiTW96IiwibXMiXSxWaT1wKGZ1bmN0aW9uKHQpe2lmKGNpPWNpfHxkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKS5zdHlsZSwiZmlsdGVyIiE9PSh0PVBuKHQpKSYmdCBpbiBjaSlyZXR1cm4gdDtmb3IodmFyIGU9dC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSt0LnNsaWNlKDEpLG49MDtuPFVpLmxlbmd0aDtuKyspe3ZhciByPVVpW25dK2U7aWYociBpbiBjaSlyZXR1cm4gcn19KSx6aT17Y3JlYXRlOlNlLHVwZGF0ZTpTZX0sS2k9cChmdW5jdGlvbih0KXtyZXR1cm57ZW50ZXJDbGFzczp0KyItZW50ZXIiLGVudGVyVG9DbGFzczp0KyItZW50ZXItdG8iLGVudGVyQWN0aXZlQ2xhc3M6dCsiLWVudGVyLWFjdGl2ZSIsbGVhdmVDbGFzczp0KyItbGVhdmUiLGxlYXZlVG9DbGFzczp0KyItbGVhdmUtdG8iLGxlYXZlQWN0aXZlQ2xhc3M6dCsiLWxlYXZlLWFjdGl2ZSJ9fSksSmk9R24mJiF0cixxaT0idHJhbnNpdGlvbiIsV2k9ImFuaW1hdGlvbiIsR2k9InRyYW5zaXRpb24iLFppPSJ0cmFuc2l0aW9uZW5kIixYaT0iYW5pbWF0aW9uIixZaT0iYW5pbWF0aW9uZW5kIjtKaSYmKHZvaWQgMD09PXdpbmRvdy5vbnRyYW5zaXRpb25lbmQmJnZvaWQgMCE9PXdpbmRvdy5vbndlYmtpdHRyYW5zaXRpb25lbmQmJihHaT0iV2Via2l0VHJhbnNpdGlvbiIsWmk9IndlYmtpdFRyYW5zaXRpb25FbmQiKSx2b2lkIDA9PT13aW5kb3cub25hbmltYXRpb25lbmQmJnZvaWQgMCE9PXdpbmRvdy5vbndlYmtpdGFuaW1hdGlvbmVuZCYmKFhpPSJXZWJraXRBbmltYXRpb24iLFlpPSJ3ZWJraXRBbmltYXRpb25FbmQiKSk7dmFyIFFpPUduP3dpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU/d2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZS5iaW5kKHdpbmRvdyk6c2V0VGltZW91dDpmdW5jdGlvbih0KXtyZXR1cm4gdCgpfSx0bz0vXGIodHJhbnNmb3JtfGFsbCkoLHwkKS8sZW89ZnVuY3Rpb24oaSl7ZnVuY3Rpb24gbyh0KXt2YXIgbj1BLnBhcmVudE5vZGUodCk7ZShuKSYmQS5yZW1vdmVDaGlsZChuLHQpfWZ1bmN0aW9uIGEodCxyLGksbyxhKXtpZih0LmlzUm9vdEluc2VydD0hYSwhZnVuY3Rpb24odCxyLGksbyl7dmFyIGE9dC5kYXRhO2lmKGUoYSkpe3ZhciB1PWUodC5jb21wb25lbnRJbnN0YW5jZSkmJmEua2VlcEFsaXZlO2lmKGUoYT1hLmhvb2spJiZlKGE9YS5pbml0KSYmYSh0LCExLGksbyksZSh0LmNvbXBvbmVudEluc3RhbmNlKSlyZXR1cm4gcyh0LHIpLG4odSkmJmZ1bmN0aW9uKHQsbixyLGkpe2Zvcih2YXIgbyxhPXQ7YS5jb21wb25lbnRJbnN0YW5jZTspaWYoYT1hLmNvbXBvbmVudEluc3RhbmNlLl92bm9kZSxlKG89YS5kYXRhKSYmZShvPW8udHJhbnNpdGlvbikpe2ZvcihvPTA7bzx4LmFjdGl2YXRlLmxlbmd0aDsrK28peC5hY3RpdmF0ZVtvXShBaSxhKTtuLnB1c2goYSk7YnJlYWt9YyhyLHQuZWxtLGkpfSh0LHIsaSxvKSwhMH19KHQscixpLG8pKXt2YXIgdT10LmRhdGEsZj10LmNoaWxkcmVuLHY9dC50YWc7ZSh2KT8odC5lbG09dC5ucz9BLmNyZWF0ZUVsZW1lbnROUyh0Lm5zLHYpOkEuY3JlYXRlRWxlbWVudCh2LHQpLGQodCksbCh0LGYsciksZSh1KSYmcCh0LHIpLGMoaSx0LmVsbSxvKSk6bih0LmlzQ29tbWVudCk/KHQuZWxtPUEuY3JlYXRlQ29tbWVudCh0LnRleHQpLGMoaSx0LmVsbSxvKSk6KHQuZWxtPUEuY3JlYXRlVGV4dE5vZGUodC50ZXh0KSxjKGksdC5lbG0sbykpfX1mdW5jdGlvbiBzKHQsbil7ZSh0LmRhdGEucGVuZGluZ0luc2VydCkmJihuLnB1c2guYXBwbHkobix0LmRhdGEucGVuZGluZ0luc2VydCksdC5kYXRhLnBlbmRpbmdJbnNlcnQ9bnVsbCksdC5lbG09dC5jb21wb25lbnRJbnN0YW5jZS4kZWwsZih0KT8ocCh0LG4pLGQodCkpOihYdCh0KSxuLnB1c2godCkpfWZ1bmN0aW9uIGModCxuLHIpe2UodCkmJihlKHIpP3IucGFyZW50Tm9kZT09PXQmJkEuaW5zZXJ0QmVmb3JlKHQsbixyKTpBLmFwcGVuZENoaWxkKHQsbikpfWZ1bmN0aW9uIGwodCxlLG4pe2lmKEFycmF5LmlzQXJyYXkoZSkpZm9yKHZhciBpPTA7aTxlLmxlbmd0aDsrK2kpYShlW2ldLG4sdC5lbG0sbnVsbCwhMCk7ZWxzZSByKHQudGV4dCkmJkEuYXBwZW5kQ2hpbGQodC5lbG0sQS5jcmVhdGVUZXh0Tm9kZShTdHJpbmcodC50ZXh0KSkpfWZ1bmN0aW9uIGYodCl7Zm9yKDt0LmNvbXBvbmVudEluc3RhbmNlOyl0PXQuY29tcG9uZW50SW5zdGFuY2UuX3Zub2RlO3JldHVybiBlKHQudGFnKX1mdW5jdGlvbiBwKHQsbil7Zm9yKHZhciByPTA7cjx4LmNyZWF0ZS5sZW5ndGg7KytyKXguY3JlYXRlW3JdKEFpLHQpO2UoQz10LmRhdGEuaG9vaykmJihlKEMuY3JlYXRlKSYmQy5jcmVhdGUoQWksdCksZShDLmluc2VydCkmJm4ucHVzaCh0KSl9ZnVuY3Rpb24gZCh0KXt2YXIgbjtpZihlKG49dC5mblNjb3BlSWQpKUEuc2V0QXR0cmlidXRlKHQuZWxtLG4sIiIpO2Vsc2UgZm9yKHZhciByPXQ7cjspZShuPXIuY29udGV4dCkmJmUobj1uLiRvcHRpb25zLl9zY29wZUlkKSYmQS5zZXRBdHRyaWJ1dGUodC5lbG0sbiwiIikscj1yLnBhcmVudDtlKG49UHIpJiZuIT09dC5jb250ZXh0JiZuIT09dC5mbkNvbnRleHQmJmUobj1uLiRvcHRpb25zLl9zY29wZUlkKSYmQS5zZXRBdHRyaWJ1dGUodC5lbG0sbiwiIil9ZnVuY3Rpb24gdih0LGUsbixyLGksbyl7Zm9yKDtyPD1pOysrcilhKG5bcl0sbyx0LGUpfWZ1bmN0aW9uIGgodCl7dmFyIG4scixpPXQuZGF0YTtpZihlKGkpKWZvcihlKG49aS5ob29rKSYmZShuPW4uZGVzdHJveSkmJm4odCksbj0wO248eC5kZXN0cm95Lmxlbmd0aDsrK24peC5kZXN0cm95W25dKHQpO2lmKGUobj10LmNoaWxkcmVuKSlmb3Iocj0wO3I8dC5jaGlsZHJlbi5sZW5ndGg7KytyKWgodC5jaGlsZHJlbltyXSl9ZnVuY3Rpb24gbSh0LG4scixpKXtmb3IoO3I8PWk7KytyKXt2YXIgYT1uW3JdO2UoYSkmJihlKGEudGFnKT8oeShhKSxoKGEpKTpvKGEuZWxtKSl9fWZ1bmN0aW9uIHkodCxuKXtpZihlKG4pfHxlKHQuZGF0YSkpe3ZhciByLGk9eC5yZW1vdmUubGVuZ3RoKzE7Zm9yKGUobik/bi5saXN0ZW5lcnMrPWk6bj1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIG4oKXswPT0tLW4ubGlzdGVuZXJzJiZvKHQpfXJldHVybiBuLmxpc3RlbmVycz1lLG59KHQuZWxtLGkpLGUocj10LmNvbXBvbmVudEluc3RhbmNlKSYmZShyPXIuX3Zub2RlKSYmZShyLmRhdGEpJiZ5KHIsbikscj0wO3I8eC5yZW1vdmUubGVuZ3RoOysrcil4LnJlbW92ZVtyXSh0LG4pO2Uocj10LmRhdGEuaG9vaykmJmUocj1yLnJlbW92ZSk/cih0LG4pOm4oKX1lbHNlIG8odC5lbG0pfWZ1bmN0aW9uIGcobixyLGksbyxzKXtmb3IodmFyIGMsdSxsLGY9MCxwPTAsZD1yLmxlbmd0aC0xLGg9clswXSx5PXJbZF0sZz1pLmxlbmd0aC0xLGI9aVswXSwkPWlbZ10sQz0hcztmPD1kJiZwPD1nOyl0KGgpP2g9clsrK2ZdOnQoeSk/eT1yWy0tZF06WXQoaCxiKT8oXyhoLGIsbyksaD1yWysrZl0sYj1pWysrcF0pOll0KHksJCk/KF8oeSwkLG8pLHk9clstLWRdLCQ9aVstLWddKTpZdChoLCQpPyhfKGgsJCxvKSxDJiZBLmluc2VydEJlZm9yZShuLGguZWxtLEEubmV4dFNpYmxpbmcoeS5lbG0pKSxoPXJbKytmXSwkPWlbLS1nXSk6WXQoeSxiKT8oXyh5LGIsbyksQyYmQS5pbnNlcnRCZWZvcmUobix5LmVsbSxoLmVsbSkseT1yWy0tZF0sYj1pWysrcF0pOih0KGMpJiYoYz1RdChyLGYsZCkpLHQodT1lKGIua2V5KT9jW2Iua2V5XTpmdW5jdGlvbih0LG4scixpKXtmb3IodmFyIG89cjtvPGk7bysrKXt2YXIgYT1uW29dO2lmKGUoYSkmJll0KHQsYSkpcmV0dXJuIG99fShiLHIsZixkKSk/YShiLG8sbixoLmVsbSk6WXQobD1yW3VdLGIpPyhfKGwsYixvKSxyW3VdPXZvaWQgMCxDJiZBLmluc2VydEJlZm9yZShuLGwuZWxtLGguZWxtKSk6YShiLG8sbixoLmVsbSksYj1pWysrcF0pO2Y+ZD92KG4sdChpW2crMV0pP251bGw6aVtnKzFdLmVsbSxpLHAsZyxvKTpwPmcmJm0oMCxyLGYsZCl9ZnVuY3Rpb24gXyhyLGksbyxhKXtpZihyIT09aSl7dmFyIHM9aS5lbG09ci5lbG07aWYobihyLmlzQXN5bmNQbGFjZWhvbGRlcikpZShpLmFzeW5jRmFjdG9yeS5yZXNvbHZlZCk/JChyLmVsbSxpLG8pOmkuaXNBc3luY1BsYWNlaG9sZGVyPSEwO2Vsc2UgaWYobihpLmlzU3RhdGljKSYmbihyLmlzU3RhdGljKSYmaS5rZXk9PT1yLmtleSYmKG4oaS5pc0Nsb25lZCl8fG4oaS5pc09uY2UpKSlpLmNvbXBvbmVudEluc3RhbmNlPXIuY29tcG9uZW50SW5zdGFuY2U7ZWxzZXt2YXIgYyx1PWkuZGF0YTtlKHUpJiZlKGM9dS5ob29rKSYmZShjPWMucHJlcGF0Y2gpJiZjKHIsaSk7dmFyIGw9ci5jaGlsZHJlbixwPWkuY2hpbGRyZW47aWYoZSh1KSYmZihpKSl7Zm9yKGM9MDtjPHgudXBkYXRlLmxlbmd0aDsrK2MpeC51cGRhdGVbY10ocixpKTtlKGM9dS5ob29rKSYmZShjPWMudXBkYXRlKSYmYyhyLGkpfXQoaS50ZXh0KT9lKGwpJiZlKHApP2whPT1wJiZnKHMsbCxwLG8sYSk6ZShwKT8oZShyLnRleHQpJiZBLnNldFRleHRDb250ZW50KHMsIiIpLHYocyxudWxsLHAsMCxwLmxlbmd0aC0xLG8pKTplKGwpP20oMCxsLDAsbC5sZW5ndGgtMSk6ZShyLnRleHQpJiZBLnNldFRleHRDb250ZW50KHMsIiIpOnIudGV4dCE9PWkudGV4dCYmQS5zZXRUZXh0Q29udGVudChzLGkudGV4dCksZSh1KSYmZShjPXUuaG9vaykmJmUoYz1jLnBvc3RwYXRjaCkmJmMocixpKX19fWZ1bmN0aW9uIGIodCxyLGkpe2lmKG4oaSkmJmUodC5wYXJlbnQpKXQucGFyZW50LmRhdGEucGVuZGluZ0luc2VydD1yO2Vsc2UgZm9yKHZhciBvPTA7bzxyLmxlbmd0aDsrK28pcltvXS5kYXRhLmhvb2suaW5zZXJ0KHJbb10pfWZ1bmN0aW9uICQodCxyLGksbyl7dmFyIGEsYz1yLnRhZyx1PXIuZGF0YSxmPXIuY2hpbGRyZW47aWYobz1vfHx1JiZ1LnByZSxyLmVsbT10LG4oci5pc0NvbW1lbnQpJiZlKHIuYXN5bmNGYWN0b3J5KSlyZXR1cm4gci5pc0FzeW5jUGxhY2Vob2xkZXI9ITAsITA7aWYoZSh1KSYmKGUoYT11Lmhvb2spJiZlKGE9YS5pbml0KSYmYShyLCEwKSxlKGE9ci5jb21wb25lbnRJbnN0YW5jZSkpKXJldHVybiBzKHIsaSksITA7aWYoZShjKSl7aWYoZShmKSlpZih0Lmhhc0NoaWxkTm9kZXMoKSlpZihlKGE9dSkmJmUoYT1hLmRvbVByb3BzKSYmZShhPWEuaW5uZXJIVE1MKSl7aWYoYSE9PXQuaW5uZXJIVE1MKXJldHVybiExfWVsc2V7Zm9yKHZhciBkPSEwLHY9dC5maXJzdENoaWxkLGg9MDtoPGYubGVuZ3RoO2grKyl7aWYoIXZ8fCEkKHYsZltoXSxpLG8pKXtkPSExO2JyZWFrfXY9di5uZXh0U2libGluZ31pZighZHx8dilyZXR1cm4hMX1lbHNlIGwocixmLGkpO2lmKGUodSkpe3ZhciBtPSExO2Zvcih2YXIgeSBpbiB1KWlmKCFPKHkpKXttPSEwLHAocixpKTticmVha30hbSYmdS5jbGFzcyYmVyh1LmNsYXNzKX19ZWxzZSB0LmRhdGEhPT1yLnRleHQmJih0LmRhdGE9ci50ZXh0KTtyZXR1cm4hMH12YXIgQyx3LHg9e30saz1pLm1vZHVsZXMsQT1pLm5vZGVPcHM7Zm9yKEM9MDtDPE9pLmxlbmd0aDsrK0MpZm9yKHhbT2lbQ11dPVtdLHc9MDt3PGsubGVuZ3RoOysrdyllKGtbd11bT2lbQ11dKSYmeFtPaVtDXV0ucHVzaChrW3ddW09pW0NdXSk7dmFyIE89dSgiYXR0cnMsY2xhc3Msc3RhdGljQ2xhc3Msc3RhdGljU3R5bGUsa2V5Iik7cmV0dXJuIGZ1bmN0aW9uKHIsaSxvLHMsYyx1KXtpZighdChpKSl7dmFyIGw9ITEscD1bXTtpZih0KHIpKWw9ITAsYShpLHAsYyx1KTtlbHNle3ZhciBkPWUoci5ub2RlVHlwZSk7aWYoIWQmJll0KHIsaSkpXyhyLGkscCxzKTtlbHNle2lmKGQpe2lmKDE9PT1yLm5vZGVUeXBlJiZyLmhhc0F0dHJpYnV0ZShWbikmJihyLnJlbW92ZUF0dHJpYnV0ZShWbiksbz0hMCksbihvKSYmJChyLGkscCkpcmV0dXJuIGIoaSxwLCEwKSxyO3I9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBtcihBLnRhZ05hbWUodCkudG9Mb3dlckNhc2UoKSx7fSxbXSx2b2lkIDAsdCl9KHIpfXZhciB2PXIuZWxtLHk9QS5wYXJlbnROb2RlKHYpO2lmKGEoaSxwLHYuX2xlYXZlQ2I/bnVsbDp5LEEubmV4dFNpYmxpbmcodikpLGUoaS5wYXJlbnQpKWZvcih2YXIgZz1pLnBhcmVudCxDPWYoaSk7Zzspe2Zvcih2YXIgdz0wO3c8eC5kZXN0cm95Lmxlbmd0aDsrK3cpeC5kZXN0cm95W3ddKGcpO2lmKGcuZWxtPWkuZWxtLEMpe2Zvcih2YXIgaz0wO2s8eC5jcmVhdGUubGVuZ3RoOysrayl4LmNyZWF0ZVtrXShBaSxnKTt2YXIgTz1nLmRhdGEuaG9vay5pbnNlcnQ7aWYoTy5tZXJnZWQpZm9yKHZhciBTPTE7UzxPLmZucy5sZW5ndGg7UysrKU8uZm5zW1NdKCl9ZWxzZSBYdChnKTtnPWcucGFyZW50fWUoeSk/bSgwLFtyXSwwLDApOmUoci50YWcpJiZoKHIpfX1yZXR1cm4gYihpLHAsbCksaS5lbG19ZShyKSYmaChyKX19KHtub2RlT3BzOnhpLG1vZHVsZXM6W2ppLE5pLERpLFBpLHppLEduP3tjcmVhdGU6VmUsYWN0aXZhdGU6VmUscmVtb3ZlOmZ1bmN0aW9uKHQsZSl7ITAhPT10LmRhdGEuc2hvdz9IZSh0LGUpOmUoKX19Ont9XS5jb25jYXQoRWkpfSk7dHImJmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoInNlbGVjdGlvbmNoYW5nZSIsZnVuY3Rpb24oKXt2YXIgdD1kb2N1bWVudC5hY3RpdmVFbGVtZW50O3QmJnQudm1vZGVsJiZaZSh0LCJpbnB1dCIpfSk7dmFyIG5vPXtpbnNlcnRlZDpmdW5jdGlvbih0LGUsbixyKXsic2VsZWN0Ij09PW4udGFnPyhyLmVsbSYmIXIuZWxtLl92T3B0aW9ucz9ZKG4sInBvc3RwYXRjaCIsZnVuY3Rpb24oKXtuby5jb21wb25lbnRVcGRhdGVkKHQsZSxuKX0pOnplKHQsZSxuLmNvbnRleHQpLHQuX3ZPcHRpb25zPVtdLm1hcC5jYWxsKHQub3B0aW9ucyxxZSkpOigidGV4dGFyZWEiPT09bi50YWd8fHdpKHQudHlwZSkpJiYodC5fdk1vZGlmaWVycz1lLm1vZGlmaWVycyxlLm1vZGlmaWVycy5sYXp5fHwodC5hZGRFdmVudExpc3RlbmVyKCJjaGFuZ2UiLEdlKSxucnx8KHQuYWRkRXZlbnRMaXN0ZW5lcigiY29tcG9zaXRpb25zdGFydCIsV2UpLHQuYWRkRXZlbnRMaXN0ZW5lcigiY29tcG9zaXRpb25lbmQiLEdlKSksdHImJih0LnZtb2RlbD0hMCkpKX0sY29tcG9uZW50VXBkYXRlZDpmdW5jdGlvbih0LGUsbil7aWYoInNlbGVjdCI9PT1uLnRhZyl7emUodCxlLG4uY29udGV4dCk7dmFyIHI9dC5fdk9wdGlvbnMsaT10Ll92T3B0aW9ucz1bXS5tYXAuY2FsbCh0Lm9wdGlvbnMscWUpO2lmKGkuc29tZShmdW5jdGlvbih0LGUpe3JldHVybiFnKHQscltlXSl9KSl7KHQubXVsdGlwbGU/ZS52YWx1ZS5zb21lKGZ1bmN0aW9uKHQpe3JldHVybiBKZSh0LGkpfSk6ZS52YWx1ZSE9PWUub2xkVmFsdWUmJkplKGUudmFsdWUsaSkpJiZaZSh0LCJjaGFuZ2UiKX19fX0scm89e21vZGVsOm5vLHNob3c6e2JpbmQ6ZnVuY3Rpb24odCxlLG4pe3ZhciByPWUudmFsdWUsaT0obj1YZShuKSkuZGF0YSYmbi5kYXRhLnRyYW5zaXRpb24sbz10Ll9fdk9yaWdpbmFsRGlzcGxheT0ibm9uZSI9PT10LnN0eWxlLmRpc3BsYXk/IiI6dC5zdHlsZS5kaXNwbGF5O3ImJmk/KG4uZGF0YS5zaG93PSEwLFJlKG4sZnVuY3Rpb24oKXt0LnN0eWxlLmRpc3BsYXk9b30pKTp0LnN0eWxlLmRpc3BsYXk9cj9vOiJub25lIn0sdXBkYXRlOmZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1lLnZhbHVlO2lmKHIhPT1lLm9sZFZhbHVlKXsobj1YZShuKSkuZGF0YSYmbi5kYXRhLnRyYW5zaXRpb24/KG4uZGF0YS5zaG93PSEwLHI/UmUobixmdW5jdGlvbigpe3Quc3R5bGUuZGlzcGxheT10Ll9fdk9yaWdpbmFsRGlzcGxheX0pOkhlKG4sZnVuY3Rpb24oKXt0LnN0eWxlLmRpc3BsYXk9Im5vbmUifSkpOnQuc3R5bGUuZGlzcGxheT1yP3QuX192T3JpZ2luYWxEaXNwbGF5OiJub25lIn19LHVuYmluZDpmdW5jdGlvbih0LGUsbixyLGkpe2l8fCh0LnN0eWxlLmRpc3BsYXk9dC5fX3ZPcmlnaW5hbERpc3BsYXkpfX19LGlvPXtuYW1lOlN0cmluZyxhcHBlYXI6Qm9vbGVhbixjc3M6Qm9vbGVhbixtb2RlOlN0cmluZyx0eXBlOlN0cmluZyxlbnRlckNsYXNzOlN0cmluZyxsZWF2ZUNsYXNzOlN0cmluZyxlbnRlclRvQ2xhc3M6U3RyaW5nLGxlYXZlVG9DbGFzczpTdHJpbmcsZW50ZXJBY3RpdmVDbGFzczpTdHJpbmcsbGVhdmVBY3RpdmVDbGFzczpTdHJpbmcsYXBwZWFyQ2xhc3M6U3RyaW5nLGFwcGVhckFjdGl2ZUNsYXNzOlN0cmluZyxhcHBlYXJUb0NsYXNzOlN0cmluZyxkdXJhdGlvbjpbTnVtYmVyLFN0cmluZyxPYmplY3RdfSxvbz17bmFtZToidHJhbnNpdGlvbiIscHJvcHM6aW8sYWJzdHJhY3Q6ITAscmVuZGVyOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMsbj10aGlzLiRzbG90cy5kZWZhdWx0O2lmKG4mJihuPW4uZmlsdGVyKGZ1bmN0aW9uKHQpe3JldHVybiB0LnRhZ3x8cnQodCl9KSkubGVuZ3RoKXt2YXIgaT10aGlzLm1vZGUsbz1uWzBdO2lmKGZ1bmN0aW9uKHQpe2Zvcig7dD10LnBhcmVudDspaWYodC5kYXRhLnRyYW5zaXRpb24pcmV0dXJuITB9KHRoaXMuJHZub2RlKSlyZXR1cm4gbzt2YXIgYT1ZZShvKTtpZighYSlyZXR1cm4gbztpZih0aGlzLl9sZWF2aW5nKXJldHVybiB0bih0LG8pO3ZhciBzPSJfX3RyYW5zaXRpb24tIit0aGlzLl91aWQrIi0iO2Eua2V5PW51bGw9PWEua2V5P2EuaXNDb21tZW50P3MrImNvbW1lbnQiOnMrYS50YWc6cihhLmtleSk/MD09PVN0cmluZyhhLmtleSkuaW5kZXhPZihzKT9hLmtleTpzK2Eua2V5OmEua2V5O3ZhciBjPShhLmRhdGF8fChhLmRhdGE9e30pKS50cmFuc2l0aW9uPVFlKHRoaXMpLHU9dGhpcy5fdm5vZGUsbD1ZZSh1KTtpZihhLmRhdGEuZGlyZWN0aXZlcyYmYS5kYXRhLmRpcmVjdGl2ZXMuc29tZShmdW5jdGlvbih0KXtyZXR1cm4ic2hvdyI9PT10Lm5hbWV9KSYmKGEuZGF0YS5zaG93PSEwKSxsJiZsLmRhdGEmJiFmdW5jdGlvbih0LGUpe3JldHVybiBlLmtleT09PXQua2V5JiZlLnRhZz09PXQudGFnfShhLGwpJiYhcnQobCkmJighbC5jb21wb25lbnRJbnN0YW5jZXx8IWwuY29tcG9uZW50SW5zdGFuY2UuX3Zub2RlLmlzQ29tbWVudCkpe3ZhciBmPWwuZGF0YS50cmFuc2l0aW9uPWgoe30sYyk7aWYoIm91dC1pbiI9PT1pKXJldHVybiB0aGlzLl9sZWF2aW5nPSEwLFkoZiwiYWZ0ZXJMZWF2ZSIsZnVuY3Rpb24oKXtlLl9sZWF2aW5nPSExLGUuJGZvcmNlVXBkYXRlKCl9KSx0bih0LG8pO2lmKCJpbi1vdXQiPT09aSl7aWYocnQoYSkpcmV0dXJuIHU7dmFyIHAsZD1mdW5jdGlvbigpe3AoKX07WShjLCJhZnRlckVudGVyIixkKSxZKGMsImVudGVyQ2FuY2VsbGVkIixkKSxZKGYsImRlbGF5TGVhdmUiLGZ1bmN0aW9uKHQpe3A9dH0pfX1yZXR1cm4gb319fSxhbz1oKHt0YWc6U3RyaW5nLG1vdmVDbGFzczpTdHJpbmd9LGlvKTtkZWxldGUgYW8ubW9kZTt2YXIgc289e1RyYW5zaXRpb246b28sVHJhbnNpdGlvbkdyb3VwOntwcm9wczphbyxyZW5kZXI6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXRoaXMudGFnfHx0aGlzLiR2bm9kZS5kYXRhLnRhZ3x8InNwYW4iLG49T2JqZWN0LmNyZWF0ZShudWxsKSxyPXRoaXMucHJldkNoaWxkcmVuPXRoaXMuY2hpbGRyZW4saT10aGlzLiRzbG90cy5kZWZhdWx0fHxbXSxvPXRoaXMuY2hpbGRyZW49W10sYT1RZSh0aGlzKSxzPTA7czxpLmxlbmd0aDtzKyspe3ZhciBjPWlbc107Yy50YWcmJm51bGwhPWMua2V5JiYwIT09U3RyaW5nKGMua2V5KS5pbmRleE9mKCJfX3ZsaXN0IikmJihvLnB1c2goYyksbltjLmtleV09YywoYy5kYXRhfHwoYy5kYXRhPXt9KSkudHJhbnNpdGlvbj1hKX1pZihyKXtmb3IodmFyIHU9W10sbD1bXSxmPTA7ZjxyLmxlbmd0aDtmKyspe3ZhciBwPXJbZl07cC5kYXRhLnRyYW5zaXRpb249YSxwLmRhdGEucG9zPXAuZWxtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLG5bcC5rZXldP3UucHVzaChwKTpsLnB1c2gocCl9dGhpcy5rZXB0PXQoZSxudWxsLHUpLHRoaXMucmVtb3ZlZD1sfXJldHVybiB0KGUsbnVsbCxvKX0sYmVmb3JlVXBkYXRlOmZ1bmN0aW9uKCl7dGhpcy5fX3BhdGNoX18odGhpcy5fdm5vZGUsdGhpcy5rZXB0LCExLCEwKSx0aGlzLl92bm9kZT10aGlzLmtlcHR9LHVwZGF0ZWQ6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLnByZXZDaGlsZHJlbixlPXRoaXMubW92ZUNsYXNzfHwodGhpcy5uYW1lfHwidiIpKyItbW92ZSI7dC5sZW5ndGgmJnRoaXMuaGFzTW92ZSh0WzBdLmVsbSxlKSYmKHQuZm9yRWFjaChlbiksdC5mb3JFYWNoKG5uKSx0LmZvckVhY2gocm4pLHRoaXMuX3JlZmxvdz1kb2N1bWVudC5ib2R5Lm9mZnNldEhlaWdodCx0LmZvckVhY2goZnVuY3Rpb24odCl7aWYodC5kYXRhLm1vdmVkKXt2YXIgbj10LmVsbSxyPW4uc3R5bGU7SWUobixlKSxyLnRyYW5zZm9ybT1yLldlYmtpdFRyYW5zZm9ybT1yLnRyYW5zaXRpb25EdXJhdGlvbj0iIixuLmFkZEV2ZW50TGlzdGVuZXIoWmksbi5fbW92ZUNiPWZ1bmN0aW9uIHQocil7ciYmIS90cmFuc2Zvcm0kLy50ZXN0KHIucHJvcGVydHlOYW1lKXx8KG4ucmVtb3ZlRXZlbnRMaXN0ZW5lcihaaSx0KSxuLl9tb3ZlQ2I9bnVsbCxMZShuLGUpKX0pfX0pKX0sbWV0aG9kczp7aGFzTW92ZTpmdW5jdGlvbih0LGUpe2lmKCFKaSlyZXR1cm4hMTtpZih0aGlzLl9oYXNNb3ZlKXJldHVybiB0aGlzLl9oYXNNb3ZlO3ZhciBuPXQuY2xvbmVOb2RlKCk7dC5fdHJhbnNpdGlvbkNsYXNzZXMmJnQuX3RyYW5zaXRpb25DbGFzc2VzLmZvckVhY2goZnVuY3Rpb24odCl7RWUobix0KX0pLFRlKG4sZSksbi5zdHlsZS5kaXNwbGF5PSJub25lIix0aGlzLiRlbC5hcHBlbmRDaGlsZChuKTt2YXIgcj1EZShuKTtyZXR1cm4gdGhpcy4kZWwucmVtb3ZlQ2hpbGQobiksdGhpcy5faGFzTW92ZT1yLmhhc1RyYW5zZm9ybX19fX07UnQuY29uZmlnLm11c3RVc2VQcm9wPWZpLFJ0LmNvbmZpZy5pc1Jlc2VydmVkVGFnPSRpLFJ0LmNvbmZpZy5pc1Jlc2VydmVkQXR0cj11aSxSdC5jb25maWcuZ2V0VGFnTmFtZXNwYWNlPUd0LFJ0LmNvbmZpZy5pc1Vua25vd25FbGVtZW50PWZ1bmN0aW9uKHQpe2lmKCFHbilyZXR1cm4hMDtpZigkaSh0KSlyZXR1cm4hMTtpZih0PXQudG9Mb3dlckNhc2UoKSxudWxsIT1DaVt0XSlyZXR1cm4gQ2lbdF07dmFyIGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0KTtyZXR1cm4gdC5pbmRleE9mKCItIik+LTE/Q2lbdF09ZS5jb25zdHJ1Y3Rvcj09PXdpbmRvdy5IVE1MVW5rbm93bkVsZW1lbnR8fGUuY29uc3RydWN0b3I9PT13aW5kb3cuSFRNTEVsZW1lbnQ6Q2lbdF09L0hUTUxVbmtub3duRWxlbWVudC8udGVzdChlLnRvU3RyaW5nKCkpfSxoKFJ0Lm9wdGlvbnMuZGlyZWN0aXZlcyxybyksaChSdC5vcHRpb25zLmNvbXBvbmVudHMsc28pLFJ0LnByb3RvdHlwZS5fX3BhdGNoX189R24/ZW86eSxSdC5wcm90b3R5cGUuJG1vdW50PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQ9dCYmR24/WnQodCk6dm9pZCAwLGZ1bmN0aW9uKHQsZSxuKXt0LiRlbD1lLHQuJG9wdGlvbnMucmVuZGVyfHwodC4kb3B0aW9ucy5yZW5kZXI9Z3IpLHZ0KHQsImJlZm9yZU1vdW50Iik7dmFyIHI7cmV0dXJuIHI9ZnVuY3Rpb24oKXt0Ll91cGRhdGUodC5fcmVuZGVyKCksbil9LG5ldyBLcih0LHIseSxudWxsLCEwKSxuPSExLG51bGw9PXQuJHZub2RlJiYodC5faXNNb3VudGVkPSEwLHZ0KHQsIm1vdW50ZWQiKSksdH0odGhpcyx0LGUpfSxSdC5uZXh0VGljayhmdW5jdGlvbigpe0puLmRldnRvb2xzJiZsciYmbHIuZW1pdCgiaW5pdCIsUnQpfSwwKTt2YXIgY28sdW89L1x7XHsoKD86LnxcbikrPylcfVx9L2csbG89L1stLiorP14ke30oKXxbXF1cL1xcXS9nLGZvPXAoZnVuY3Rpb24odCl7dmFyIGU9dFswXS5yZXBsYWNlKGxvLCJcXCQmIiksbj10WzFdLnJlcGxhY2UobG8sIlxcJCYiKTtyZXR1cm4gbmV3IFJlZ0V4cChlKyIoKD86LnxcXG4pKz8pIituLCJnIil9KSxwbz17c3RhdGljS2V5czpbInN0YXRpY0NsYXNzIl0sdHJhbnNmb3JtTm9kZTpmdW5jdGlvbih0LGUpe2Uud2Fybjt2YXIgbj1oZSh0LCJjbGFzcyIpO24mJih0LnN0YXRpY0NsYXNzPUpTT04uc3RyaW5naWZ5KG4pKTt2YXIgcj12ZSh0LCJjbGFzcyIsITEpO3ImJih0LmNsYXNzQmluZGluZz1yKX0sZ2VuRGF0YTpmdW5jdGlvbih0KXt2YXIgZT0iIjtyZXR1cm4gdC5zdGF0aWNDbGFzcyYmKGUrPSJzdGF0aWNDbGFzczoiK3Quc3RhdGljQ2xhc3MrIiwiKSx0LmNsYXNzQmluZGluZyYmKGUrPSJjbGFzczoiK3QuY2xhc3NCaW5kaW5nKyIsIiksZX19LHZvPXtzdGF0aWNLZXlzOlsic3RhdGljU3R5bGUiXSx0cmFuc2Zvcm1Ob2RlOmZ1bmN0aW9uKHQsZSl7ZS53YXJuO3ZhciBuPWhlKHQsInN0eWxlIik7biYmKHQuc3RhdGljU3R5bGU9SlNPTi5zdHJpbmdpZnkoRmkobikpKTt2YXIgcj12ZSh0LCJzdHlsZSIsITEpO3ImJih0LnN0eWxlQmluZGluZz1yKX0sZ2VuRGF0YTpmdW5jdGlvbih0KXt2YXIgZT0iIjtyZXR1cm4gdC5zdGF0aWNTdHlsZSYmKGUrPSJzdGF0aWNTdHlsZToiK3Quc3RhdGljU3R5bGUrIiwiKSx0LnN0eWxlQmluZGluZyYmKGUrPSJzdHlsZTooIit0LnN0eWxlQmluZGluZysiKSwiKSxlfX0saG89ZnVuY3Rpb24odCl7cmV0dXJuIGNvPWNvfHxkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSxjby5pbm5lckhUTUw9dCxjby50ZXh0Q29udGVudH0sbW89dSgiYXJlYSxiYXNlLGJyLGNvbCxlbWJlZCxmcmFtZSxocixpbWcsaW5wdXQsaXNpbmRleCxrZXlnZW4sbGluayxtZXRhLHBhcmFtLHNvdXJjZSx0cmFjayx3YnIiKSx5bz11KCJjb2xncm91cCxkZCxkdCxsaSxvcHRpb25zLHAsdGQsdGZvb3QsdGgsdGhlYWQsdHIsc291cmNlIiksZ289dSgiYWRkcmVzcyxhcnRpY2xlLGFzaWRlLGJhc2UsYmxvY2txdW90ZSxib2R5LGNhcHRpb24sY29sLGNvbGdyb3VwLGRkLGRldGFpbHMsZGlhbG9nLGRpdixkbCxkdCxmaWVsZHNldCxmaWdjYXB0aW9uLGZpZ3VyZSxmb290ZXIsZm9ybSxoMSxoMixoMyxoNCxoNSxoNixoZWFkLGhlYWRlcixoZ3JvdXAsaHIsaHRtbCxsZWdlbmQsbGksbWVudWl0ZW0sbWV0YSxvcHRncm91cCxvcHRpb24scGFyYW0scnAscnQsc291cmNlLHN0eWxlLHN1bW1hcnksdGJvZHksdGQsdGZvb3QsdGgsdGhlYWQsdGl0bGUsdHIsdHJhY2siKSxfbz0vXlxzKihbXlxzIic8PlwvPV0rKSg/OlxzKig9KVxzKig/OiIoW14iXSopIit8JyhbXiddKiknK3woW15ccyInPTw+YF0rKSkpPy8sYm89IlthLXpBLVpfXVtcXHdcXC1cXC5dKiIsJG89IigoPzoiK2JvKyJcXDopPyIrYm8rIikiLENvPW5ldyBSZWdFeHAoIl48Iiskbyksd289L15ccyooXC8/KT4vLHhvPW5ldyBSZWdFeHAoIl48XFwvIiskbysiW14+XSo+Iiksa289L148IURPQ1RZUEUgW14+XSs+L2ksQW89L148IS0tLyxPbz0vXjwhXFsvLFNvPSExOyJ4Ii5yZXBsYWNlKC94KC4pPy9nLGZ1bmN0aW9uKHQsZSl7U289IiI9PT1lfSk7dmFyIFRvLEVvLGpvLE5vLElvLExvLE1vLERvLFBvLEZvLFJvLEhvPXUoInNjcmlwdCxzdHlsZSx0ZXh0YXJlYSIsITApLEJvPXt9LFVvPXsiJmx0OyI6IjwiLCImZ3Q7IjoiPiIsIiZxdW90OyI6JyInLCImYW1wOyI6IiYiLCImIzEwOyI6IlxuIiwiJiM5OyI6Ilx0In0sVm89LyYoPzpsdHxndHxxdW90fGFtcCk7L2csem89LyYoPzpsdHxndHxxdW90fGFtcHwjMTB8IzkpOy9nLEtvPXUoInByZSx0ZXh0YXJlYSIsITApLEpvPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQmJktvKHQpJiYiXG4iPT09ZVswXX0scW89L15AfF52LW9uOi8sV289L152LXxeQHxeOi8sR289LyguKj8pXHMrKD86aW58b2YpXHMrKC4qKS8sWm89LywoW14sXH1cXV0qKSg/OiwoW14sXH1cXV0qKSk/JC8sWG89L15cKHxcKSQvZyxZbz0vOiguKikkLyxRbz0vXjp8XnYtYmluZDovLHRhPS9cLlteLl0rL2csZWE9cChobyksbmE9L154bWxuczpOU1xkKy8scmE9L15OU1xkKzovLGlhPVtwbyx2byx7cHJlVHJhbnNmb3JtTm9kZTpmdW5jdGlvbih0LGUpe2lmKCJpbnB1dCI9PT10LnRhZyl7dmFyIG49dC5hdHRyc01hcDtpZihuWyJ2LW1vZGVsIl0mJihuWyJ2LWJpbmQ6dHlwZSJdfHxuWyI6dHlwZSJdKSl7dmFyIHI9dmUodCwidHlwZSIpLGk9aGUodCwidi1pZiIsITApLG89aT8iJiYoIitpKyIpIjoiIixhPW51bGwhPWhlKHQsInYtZWxzZSIsITApLHM9aGUodCwidi1lbHNlLWlmIiwhMCksYz1mbih0KTt1bihjKSxmZShjLCJ0eXBlIiwiY2hlY2tib3giKSxjbihjLGUpLGMucHJvY2Vzc2VkPSEwLGMuaWY9IigiK3IrIik9PT0nY2hlY2tib3gnIitvLGxuKGMse2V4cDpjLmlmLGJsb2NrOmN9KTt2YXIgdT1mbih0KTtoZSh1LCJ2LWZvciIsITApLGZlKHUsInR5cGUiLCJyYWRpbyIpLGNuKHUsZSksbG4oYyx7ZXhwOiIoIityKyIpPT09J3JhZGlvJyIrbyxibG9jazp1fSk7dmFyIGw9Zm4odCk7cmV0dXJuIGhlKGwsInYtZm9yIiwhMCksZmUobCwiOnR5cGUiLHIpLGNuKGwsZSksbG4oYyx7ZXhwOmksYmxvY2s6bH0pLGE/Yy5lbHNlPSEwOnMmJihjLmVsc2VpZj1zKSxjfX19fV0sb2E9e2V4cGVjdEhUTUw6ITAsbW9kdWxlczppYSxkaXJlY3RpdmVzOnttb2RlbDpmdW5jdGlvbih0LGUsbil7dmFyIHI9ZS52YWx1ZSxpPWUubW9kaWZpZXJzLG89dC50YWcsYT10LmF0dHJzTWFwLnR5cGU7aWYodC5jb21wb25lbnQpcmV0dXJuIG1lKHQscixpKSwhMTtpZigic2VsZWN0Ij09PW8pIWZ1bmN0aW9uKHQsZSxuKXt2YXIgcj0ndmFyICQkc2VsZWN0ZWRWYWwgPSBBcnJheS5wcm90b3R5cGUuZmlsdGVyLmNhbGwoJGV2ZW50LnRhcmdldC5vcHRpb25zLGZ1bmN0aW9uKG8pe3JldHVybiBvLnNlbGVjdGVkfSkubWFwKGZ1bmN0aW9uKG8pe3ZhciB2YWwgPSAiX3ZhbHVlIiBpbiBvID8gby5fdmFsdWUgOiBvLnZhbHVlO3JldHVybiAnKyhuJiZuLm51bWJlcj8iX24odmFsKSI6InZhbCIpKyJ9KTsiO3I9cisiICIreWUoZSwiJGV2ZW50LnRhcmdldC5tdWx0aXBsZSA/ICQkc2VsZWN0ZWRWYWwgOiAkJHNlbGVjdGVkVmFsWzBdIiksZGUodCwiY2hhbmdlIixyLG51bGwsITApfSh0LHIsaSk7ZWxzZSBpZigiaW5wdXQiPT09byYmImNoZWNrYm94Ij09PWEpIWZ1bmN0aW9uKHQsZSxuKXt2YXIgcj1uJiZuLm51bWJlcixpPXZlKHQsInZhbHVlIil8fCJudWxsIixvPXZlKHQsInRydWUtdmFsdWUiKXx8InRydWUiLGE9dmUodCwiZmFsc2UtdmFsdWUiKXx8ImZhbHNlIjt1ZSh0LCJjaGVja2VkIiwiQXJyYXkuaXNBcnJheSgiK2UrIik/X2koIitlKyIsIitpKyIpPi0xIisoInRydWUiPT09bz8iOigiK2UrIikiOiI6X3EoIitlKyIsIitvKyIpIikpLGRlKHQsImNoYW5nZSIsInZhciAkJGE9IitlKyIsJCRlbD0kZXZlbnQudGFyZ2V0LCQkYz0kJGVsLmNoZWNrZWQ/KCIrbysiKTooIithKyIpO2lmKEFycmF5LmlzQXJyYXkoJCRhKSl7dmFyICQkdj0iKyhyPyJfbigiK2krIikiOmkpKyIsJCRpPV9pKCQkYSwkJHYpO2lmKCQkZWwuY2hlY2tlZCl7JCRpPDAmJigiK2UrIj0kJGEuY29uY2F0KFskJHZdKSl9ZWxzZXskJGk+LTEmJigiK2UrIj0kJGEuc2xpY2UoMCwkJGkpLmNvbmNhdCgkJGEuc2xpY2UoJCRpKzEpKSl9fWVsc2V7Iit5ZShlLCIkJGMiKSsifSIsbnVsbCwhMCl9KHQscixpKTtlbHNlIGlmKCJpbnB1dCI9PT1vJiYicmFkaW8iPT09YSkhZnVuY3Rpb24odCxlLG4pe3ZhciByPW4mJm4ubnVtYmVyLGk9dmUodCwidmFsdWUiKXx8Im51bGwiO3VlKHQsImNoZWNrZWQiLCJfcSgiK2UrIiwiKyhpPXI/Il9uKCIraSsiKSI6aSkrIikiKSxkZSh0LCJjaGFuZ2UiLHllKGUsaSksbnVsbCwhMCl9KHQscixpKTtlbHNlIGlmKCJpbnB1dCI9PT1vfHwidGV4dGFyZWEiPT09bykhZnVuY3Rpb24odCxlLG4pe3ZhciByPXQuYXR0cnNNYXAudHlwZSxpPW58fHt9LG89aS5sYXp5LGE9aS5udW1iZXIscz1pLnRyaW0sYz0hbyYmInJhbmdlIiE9PXIsdT1vPyJjaGFuZ2UiOiJyYW5nZSI9PT1yP0xpOiJpbnB1dCIsbD0iJGV2ZW50LnRhcmdldC52YWx1ZSI7cyYmKGw9IiRldmVudC50YXJnZXQudmFsdWUudHJpbSgpIiksYSYmKGw9Il9uKCIrbCsiKSIpO3ZhciBmPXllKGUsbCk7YyYmKGY9ImlmKCRldmVudC50YXJnZXQuY29tcG9zaW5nKXJldHVybjsiK2YpLHVlKHQsInZhbHVlIiwiKCIrZSsiKSIpLGRlKHQsdSxmLG51bGwsITApLChzfHxhKSYmZGUodCwiYmx1ciIsIiRmb3JjZVVwZGF0ZSgpIil9KHQscixpKTtlbHNlIGlmKCFKbi5pc1Jlc2VydmVkVGFnKG8pKXJldHVybiBtZSh0LHIsaSksITE7cmV0dXJuITB9LHRleHQ6ZnVuY3Rpb24odCxlKXtlLnZhbHVlJiZ1ZSh0LCJ0ZXh0Q29udGVudCIsIl9zKCIrZS52YWx1ZSsiKSIpfSxodG1sOmZ1bmN0aW9uKHQsZSl7ZS52YWx1ZSYmdWUodCwiaW5uZXJIVE1MIiwiX3MoIitlLnZhbHVlKyIpIil9fSxpc1ByZVRhZzpmdW5jdGlvbih0KXtyZXR1cm4icHJlIj09PXR9LGlzVW5hcnlUYWc6bW8sbXVzdFVzZVByb3A6ZmksY2FuQmVMZWZ0T3BlblRhZzp5byxpc1Jlc2VydmVkVGFnOiRpLGdldFRhZ05hbWVzcGFjZTpHdCxzdGF0aWNLZXlzOmZ1bmN0aW9uKHQpe3JldHVybiB0LnJlZHVjZShmdW5jdGlvbih0LGUpe3JldHVybiB0LmNvbmNhdChlLnN0YXRpY0tleXN8fFtdKX0sW10pLmpvaW4oIiwiKX0oaWEpfSxhYT1wKGZ1bmN0aW9uKHQpe3JldHVybiB1KCJ0eXBlLHRhZyxhdHRyc0xpc3QsYXR0cnNNYXAscGxhaW4scGFyZW50LGNoaWxkcmVuLGF0dHJzIisodD8iLCIrdDoiIikpfSksc2E9L15ccyooW1x3JF9dK3xcKFteKV0qP1wpKVxzKj0+fF5mdW5jdGlvblxzKlwoLyxjYT0vXlxzKltBLVphLXpfJF1bXHckXSooPzpcLltBLVphLXpfJF1bXHckXSp8XFsnLio/J118XFsiLio/Il18XFtcZCtdfFxbW0EtWmEtel8kXVtcdyRdKl0pKlxzKiQvLHVhPXtlc2M6MjcsdGFiOjksZW50ZXI6MTMsc3BhY2U6MzIsdXA6MzgsbGVmdDozNyxyaWdodDozOSxkb3duOjQwLGRlbGV0ZTpbOCw0Nl19LGxhPWZ1bmN0aW9uKHQpe3JldHVybiJpZigiK3QrIilyZXR1cm4gbnVsbDsifSxmYT17c3RvcDoiJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOyIscHJldmVudDoiJGV2ZW50LnByZXZlbnREZWZhdWx0KCk7IixzZWxmOmxhKCIkZXZlbnQudGFyZ2V0ICE9PSAkZXZlbnQuY3VycmVudFRhcmdldCIpLGN0cmw6bGEoIiEkZXZlbnQuY3RybEtleSIpLHNoaWZ0OmxhKCIhJGV2ZW50LnNoaWZ0S2V5IiksYWx0OmxhKCIhJGV2ZW50LmFsdEtleSIpLG1ldGE6bGEoIiEkZXZlbnQubWV0YUtleSIpLGxlZnQ6bGEoIididXR0b24nIGluICRldmVudCAmJiAkZXZlbnQuYnV0dG9uICE9PSAwIiksbWlkZGxlOmxhKCInYnV0dG9uJyBpbiAkZXZlbnQgJiYgJGV2ZW50LmJ1dHRvbiAhPT0gMSIpLHJpZ2h0OmxhKCInYnV0dG9uJyBpbiAkZXZlbnQgJiYgJGV2ZW50LmJ1dHRvbiAhPT0gMiIpfSxwYT17b246ZnVuY3Rpb24odCxlKXt0LndyYXBMaXN0ZW5lcnM9ZnVuY3Rpb24odCl7cmV0dXJuIl9nKCIrdCsiLCIrZS52YWx1ZSsiKSJ9fSxiaW5kOmZ1bmN0aW9uKHQsZSl7dC53cmFwRGF0YT1mdW5jdGlvbihuKXtyZXR1cm4iX2IoIituKyIsJyIrdC50YWcrIicsIitlLnZhbHVlKyIsIisoZS5tb2RpZmllcnMmJmUubW9kaWZpZXJzLnByb3A/InRydWUiOiJmYWxzZSIpKyhlLm1vZGlmaWVycyYmZS5tb2RpZmllcnMuc3luYz8iLHRydWUiOiIiKSsiKSJ9fSxjbG9hazp5fSxkYT1mdW5jdGlvbih0KXt0aGlzLm9wdGlvbnM9dCx0aGlzLndhcm49dC53YXJufHxzZSx0aGlzLnRyYW5zZm9ybXM9Y2UodC5tb2R1bGVzLCJ0cmFuc2Zvcm1Db2RlIiksdGhpcy5kYXRhR2VuRm5zPWNlKHQubW9kdWxlcywiZ2VuRGF0YSIpLHRoaXMuZGlyZWN0aXZlcz1oKGgoe30scGEpLHQuZGlyZWN0aXZlcyk7dmFyIGU9dC5pc1Jlc2VydmVkVGFnfHxCbjt0aGlzLm1heWJlQ29tcG9uZW50PWZ1bmN0aW9uKHQpe3JldHVybiFlKHQudGFnKX0sdGhpcy5vbmNlSWQ9MCx0aGlzLnN0YXRpY1JlbmRlckZucz1bXX0sdmE9KG5ldyBSZWdFeHAoIlxcYiIrImRvLGlmLGZvcixsZXQsbmV3LHRyeSx2YXIsY2FzZSxlbHNlLHdpdGgsYXdhaXQsYnJlYWssY2F0Y2gsY2xhc3MsY29uc3Qsc3VwZXIsdGhyb3csd2hpbGUseWllbGQsZGVsZXRlLGV4cG9ydCxpbXBvcnQscmV0dXJuLHN3aXRjaCxkZWZhdWx0LGV4dGVuZHMsZmluYWxseSxjb250aW51ZSxkZWJ1Z2dlcixmdW5jdGlvbixhcmd1bWVudHMiLnNwbGl0KCIsIikuam9pbigiXFxifFxcYiIpKyJcXGIiKSxuZXcgUmVnRXhwKCJcXGIiKyJkZWxldGUsdHlwZW9mLHZvaWQiLnNwbGl0KCIsIikuam9pbigiXFxzKlxcKFteXFwpXSpcXCl8XFxiIikrIlxccypcXChbXlxcKV0qXFwpIiksZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIG4obixyKXt2YXIgaT1PYmplY3QuY3JlYXRlKGUpLG89W10sYT1bXTtpZihpLndhcm49ZnVuY3Rpb24odCxlKXsoZT9hOm8pLnB1c2godCl9LHIpe3IubW9kdWxlcyYmKGkubW9kdWxlcz0oZS5tb2R1bGVzfHxbXSkuY29uY2F0KHIubW9kdWxlcykpLHIuZGlyZWN0aXZlcyYmKGkuZGlyZWN0aXZlcz1oKE9iamVjdC5jcmVhdGUoZS5kaXJlY3RpdmVzfHxudWxsKSxyLmRpcmVjdGl2ZXMpKTtmb3IodmFyIHMgaW4gcikibW9kdWxlcyIhPT1zJiYiZGlyZWN0aXZlcyIhPT1zJiYoaVtzXT1yW3NdKX12YXIgYz10KG4saSk7cmV0dXJuIGMuZXJyb3JzPW8sYy50aXBzPWEsY31yZXR1cm57Y29tcGlsZTpuLGNvbXBpbGVUb0Z1bmN0aW9uczpmdW5jdGlvbih0KXt2YXIgZT1PYmplY3QuY3JlYXRlKG51bGwpO3JldHVybiBmdW5jdGlvbihuLHIsaSl7KHI9aCh7fSxyKSkud2FybixkZWxldGUgci53YXJuO3ZhciBvPXIuZGVsaW1pdGVycz9TdHJpbmcoci5kZWxpbWl0ZXJzKStuOm47aWYoZVtvXSlyZXR1cm4gZVtvXTt2YXIgYT10KG4scikscz17fSxjPVtdO3JldHVybiBzLnJlbmRlcj1UbihhLnJlbmRlcixjKSxzLnN0YXRpY1JlbmRlckZucz1hLnN0YXRpY1JlbmRlckZucy5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIFRuKHQsYyl9KSxlW29dPXN9fShuKX19fShmdW5jdGlvbih0LGUpe3ZhciBuPXNuKHQudHJpbSgpLGUpOyExIT09ZS5vcHRpbWl6ZSYmZnVuY3Rpb24odCxlKXt0JiYoUG89YWEoZS5zdGF0aWNLZXlzfHwiIiksRm89ZS5pc1Jlc2VydmVkVGFnfHxCbixwbih0KSxkbih0LCExKSl9KG4sZSk7dmFyIHI9eW4obixlKTtyZXR1cm57YXN0Om4scmVuZGVyOnIucmVuZGVyLHN0YXRpY1JlbmRlckZuczpyLnN0YXRpY1JlbmRlckZuc319KShvYSkuY29tcGlsZVRvRnVuY3Rpb25zKSxoYT0hIUduJiZFbighMSksbWE9ISFHbiYmRW4oITApLHlhPXAoZnVuY3Rpb24odCl7dmFyIGU9WnQodCk7cmV0dXJuIGUmJmUuaW5uZXJIVE1MfSksZ2E9UnQucHJvdG90eXBlLiRtb3VudDtyZXR1cm4gUnQucHJvdG90eXBlLiRtb3VudD1mdW5jdGlvbih0LGUpe2lmKCh0PXQmJlp0KHQpKT09PWRvY3VtZW50LmJvZHl8fHQ9PT1kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpcmV0dXJuIHRoaXM7dmFyIG49dGhpcy4kb3B0aW9ucztpZighbi5yZW5kZXIpe3ZhciByPW4udGVtcGxhdGU7aWYocilpZigic3RyaW5nIj09dHlwZW9mIHIpIiMiPT09ci5jaGFyQXQoMCkmJihyPXlhKHIpKTtlbHNle2lmKCFyLm5vZGVUeXBlKXJldHVybiB0aGlzO3I9ci5pbm5lckhUTUx9ZWxzZSB0JiYocj1mdW5jdGlvbih0KXtpZih0Lm91dGVySFRNTClyZXR1cm4gdC5vdXRlckhUTUw7dmFyIGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7cmV0dXJuIGUuYXBwZW5kQ2hpbGQodC5jbG9uZU5vZGUoITApKSxlLmlubmVySFRNTH0odCkpO2lmKHIpe3ZhciBpPXZhKHIse3Nob3VsZERlY29kZU5ld2xpbmVzOmhhLHNob3VsZERlY29kZU5ld2xpbmVzRm9ySHJlZjptYSxkZWxpbWl0ZXJzOm4uZGVsaW1pdGVycyxjb21tZW50czpuLmNvbW1lbnRzfSx0aGlzKSxvPWkucmVuZGVyLGE9aS5zdGF0aWNSZW5kZXJGbnM7bi5yZW5kZXI9byxuLnN0YXRpY1JlbmRlckZucz1hfX1yZXR1cm4gZ2EuY2FsbCh0aGlzLHQsZSl9LFJ0LmNvbXBpbGU9dmEsUnR9KTsNCi8qIGF4aW9zIHYwLjE3LjAgfCAoYykgMjAxNyBieSBNYXR0IFphYnJpc2tpZSAqLwohZnVuY3Rpb24oZSx0KXsib2JqZWN0Ij09dHlwZW9mIGV4cG9ydHMmJiJvYmplY3QiPT10eXBlb2YgbW9kdWxlP21vZHVsZS5leHBvcnRzPXQoKToiZnVuY3Rpb24iPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShbXSx0KToib2JqZWN0Ij09dHlwZW9mIGV4cG9ydHM/ZXhwb3J0cy5heGlvcz10KCk6ZS5heGlvcz10KCl9KHRoaXMsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChyKXtpZihuW3JdKXJldHVybiBuW3JdLmV4cG9ydHM7dmFyIG89bltyXT17ZXhwb3J0czp7fSxpZDpyLGxvYWRlZDohMX07cmV0dXJuIGVbcl0uY2FsbChvLmV4cG9ydHMsbyxvLmV4cG9ydHMsdCksby5sb2FkZWQ9ITAsby5leHBvcnRzfXZhciBuPXt9O3JldHVybiB0Lm09ZSx0LmM9bix0LnA9IiIsdCgwKX0oW2Z1bmN0aW9uKGUsdCxuKXtlLmV4cG9ydHM9bigxKX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiByKGUpe3ZhciB0PW5ldyBzKGUpLG49aShzLnByb3RvdHlwZS5yZXF1ZXN0LHQpO3JldHVybiBvLmV4dGVuZChuLHMucHJvdG90eXBlLHQpLG8uZXh0ZW5kKG4sdCksbn12YXIgbz1uKDIpLGk9bigzKSxzPW4oNSksdT1uKDYpLGE9cih1KTthLkF4aW9zPXMsYS5jcmVhdGU9ZnVuY3Rpb24oZSl7cmV0dXJuIHIoby5tZXJnZSh1LGUpKX0sYS5DYW5jZWw9bigyMyksYS5DYW5jZWxUb2tlbj1uKDI0KSxhLmlzQ2FuY2VsPW4oMjApLGEuYWxsPWZ1bmN0aW9uKGUpe3JldHVybiBQcm9taXNlLmFsbChlKX0sYS5zcHJlYWQ9bigyNSksZS5leHBvcnRzPWEsZS5leHBvcnRzLmRlZmF1bHQ9YX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiByKGUpe3JldHVybiJbb2JqZWN0IEFycmF5XSI9PT1SLmNhbGwoZSl9ZnVuY3Rpb24gbyhlKXtyZXR1cm4iW29iamVjdCBBcnJheUJ1ZmZlcl0iPT09Ui5jYWxsKGUpfWZ1bmN0aW9uIGkoZSl7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiBGb3JtRGF0YSYmZSBpbnN0YW5jZW9mIEZvcm1EYXRhfWZ1bmN0aW9uIHMoZSl7dmFyIHQ7cmV0dXJuIHQ9InVuZGVmaW5lZCIhPXR5cGVvZiBBcnJheUJ1ZmZlciYmQXJyYXlCdWZmZXIuaXNWaWV3P0FycmF5QnVmZmVyLmlzVmlldyhlKTplJiZlLmJ1ZmZlciYmZS5idWZmZXIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcn1mdW5jdGlvbiB1KGUpe3JldHVybiJzdHJpbmciPT10eXBlb2YgZX1mdW5jdGlvbiBhKGUpe3JldHVybiJudW1iZXIiPT10eXBlb2YgZX1mdW5jdGlvbiBjKGUpe3JldHVybiJ1bmRlZmluZWQiPT10eXBlb2YgZX1mdW5jdGlvbiBmKGUpe3JldHVybiBudWxsIT09ZSYmIm9iamVjdCI9PXR5cGVvZiBlfWZ1bmN0aW9uIHAoZSl7cmV0dXJuIltvYmplY3QgRGF0ZV0iPT09Ui5jYWxsKGUpfWZ1bmN0aW9uIGQoZSl7cmV0dXJuIltvYmplY3QgRmlsZV0iPT09Ui5jYWxsKGUpfWZ1bmN0aW9uIGwoZSl7cmV0dXJuIltvYmplY3QgQmxvYl0iPT09Ui5jYWxsKGUpfWZ1bmN0aW9uIGgoZSl7cmV0dXJuIltvYmplY3QgRnVuY3Rpb25dIj09PVIuY2FsbChlKX1mdW5jdGlvbiBtKGUpe3JldHVybiBmKGUpJiZoKGUucGlwZSl9ZnVuY3Rpb24geShlKXtyZXR1cm4idW5kZWZpbmVkIiE9dHlwZW9mIFVSTFNlYXJjaFBhcmFtcyYmZSBpbnN0YW5jZW9mIFVSTFNlYXJjaFBhcmFtc31mdW5jdGlvbiB3KGUpe3JldHVybiBlLnJlcGxhY2UoL15ccyovLCIiKS5yZXBsYWNlKC9ccyokLywiIil9ZnVuY3Rpb24gZygpe3JldHVybigidW5kZWZpbmVkIj09dHlwZW9mIG5hdmlnYXRvcnx8IlJlYWN0TmF0aXZlIiE9PW5hdmlnYXRvci5wcm9kdWN0KSYmKCJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93JiYidW5kZWZpbmVkIiE9dHlwZW9mIGRvY3VtZW50KX1mdW5jdGlvbiB2KGUsdCl7aWYobnVsbCE9PWUmJiJ1bmRlZmluZWQiIT10eXBlb2YgZSlpZigib2JqZWN0Ij09dHlwZW9mIGV8fHIoZSl8fChlPVtlXSkscihlKSlmb3IodmFyIG49MCxvPWUubGVuZ3RoO248bztuKyspdC5jYWxsKG51bGwsZVtuXSxuLGUpO2Vsc2UgZm9yKHZhciBpIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsaSkmJnQuY2FsbChudWxsLGVbaV0saSxlKX1mdW5jdGlvbiB4KCl7ZnVuY3Rpb24gZShlLG4peyJvYmplY3QiPT10eXBlb2YgdFtuXSYmIm9iamVjdCI9PXR5cGVvZiBlP3Rbbl09eCh0W25dLGUpOnRbbl09ZX1mb3IodmFyIHQ9e30sbj0wLHI9YXJndW1lbnRzLmxlbmd0aDtuPHI7bisrKXYoYXJndW1lbnRzW25dLGUpO3JldHVybiB0fWZ1bmN0aW9uIGIoZSx0LG4pe3JldHVybiB2KHQsZnVuY3Rpb24odCxyKXtuJiYiZnVuY3Rpb24iPT10eXBlb2YgdD9lW3JdPUUodCxuKTplW3JdPXR9KSxlfXZhciBFPW4oMyksQz1uKDQpLFI9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztlLmV4cG9ydHM9e2lzQXJyYXk6cixpc0FycmF5QnVmZmVyOm8saXNCdWZmZXI6Qyxpc0Zvcm1EYXRhOmksaXNBcnJheUJ1ZmZlclZpZXc6cyxpc1N0cmluZzp1LGlzTnVtYmVyOmEsaXNPYmplY3Q6Zixpc1VuZGVmaW5lZDpjLGlzRGF0ZTpwLGlzRmlsZTpkLGlzQmxvYjpsLGlzRnVuY3Rpb246aCxpc1N0cmVhbTptLGlzVVJMU2VhcmNoUGFyYW1zOnksaXNTdGFuZGFyZEJyb3dzZXJFbnY6Zyxmb3JFYWNoOnYsbWVyZ2U6eCxleHRlbmQ6Yix0cmltOnd9fSxmdW5jdGlvbihlLHQpeyJ1c2Ugc3RyaWN0IjtlLmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZnVuY3Rpb24oKXtmb3IodmFyIG49bmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGgpLHI9MDtyPG4ubGVuZ3RoO3IrKyluW3JdPWFyZ3VtZW50c1tyXTtyZXR1cm4gZS5hcHBseSh0LG4pfX19LGZ1bmN0aW9uKGUsdCl7ZnVuY3Rpb24gbihlKXtyZXR1cm4hIWUuY29uc3RydWN0b3ImJiJmdW5jdGlvbiI9PXR5cGVvZiBlLmNvbnN0cnVjdG9yLmlzQnVmZmVyJiZlLmNvbnN0cnVjdG9yLmlzQnVmZmVyKGUpfWZ1bmN0aW9uIHIoZSl7cmV0dXJuImZ1bmN0aW9uIj09dHlwZW9mIGUucmVhZEZsb2F0TEUmJiJmdW5jdGlvbiI9PXR5cGVvZiBlLnNsaWNlJiZuKGUuc2xpY2UoMCwwKSl9LyohCgkgKiBEZXRlcm1pbmUgaWYgYW4gb2JqZWN0IGlzIGEgQnVmZmVyCgkgKgoJICogQGF1dGhvciAgIEZlcm9zcyBBYm91a2hhZGlqZWggPGZlcm9zc0BmZXJvc3Mub3JnPiA8aHR0cDovL2Zlcm9zcy5vcmc+CgkgKiBAbGljZW5zZSAgTUlUCgkgKi8KZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiBudWxsIT1lJiYobihlKXx8cihlKXx8ISFlLl9pc0J1ZmZlcil9fSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHIoZSl7dGhpcy5kZWZhdWx0cz1lLHRoaXMuaW50ZXJjZXB0b3JzPXtyZXF1ZXN0Om5ldyBzLHJlc3BvbnNlOm5ldyBzfX12YXIgbz1uKDYpLGk9bigyKSxzPW4oMTcpLHU9bigxOCk7ci5wcm90b3R5cGUucmVxdWVzdD1mdW5jdGlvbihlKXsic3RyaW5nIj09dHlwZW9mIGUmJihlPWkubWVyZ2Uoe3VybDphcmd1bWVudHNbMF19LGFyZ3VtZW50c1sxXSkpLGU9aS5tZXJnZShvLHRoaXMuZGVmYXVsdHMse21ldGhvZDoiZ2V0In0sZSksZS5tZXRob2Q9ZS5tZXRob2QudG9Mb3dlckNhc2UoKTt2YXIgdD1bdSx2b2lkIDBdLG49UHJvbWlzZS5yZXNvbHZlKGUpO2Zvcih0aGlzLmludGVyY2VwdG9ycy5yZXF1ZXN0LmZvckVhY2goZnVuY3Rpb24oZSl7dC51bnNoaWZ0KGUuZnVsZmlsbGVkLGUucmVqZWN0ZWQpfSksdGhpcy5pbnRlcmNlcHRvcnMucmVzcG9uc2UuZm9yRWFjaChmdW5jdGlvbihlKXt0LnB1c2goZS5mdWxmaWxsZWQsZS5yZWplY3RlZCl9KTt0Lmxlbmd0aDspbj1uLnRoZW4odC5zaGlmdCgpLHQuc2hpZnQoKSk7cmV0dXJuIG59LGkuZm9yRWFjaChbImRlbGV0ZSIsImdldCIsImhlYWQiLCJvcHRpb25zIl0sZnVuY3Rpb24oZSl7ci5wcm90b3R5cGVbZV09ZnVuY3Rpb24odCxuKXtyZXR1cm4gdGhpcy5yZXF1ZXN0KGkubWVyZ2Uobnx8e30se21ldGhvZDplLHVybDp0fSkpfX0pLGkuZm9yRWFjaChbInBvc3QiLCJwdXQiLCJwYXRjaCJdLGZ1bmN0aW9uKGUpe3IucHJvdG90eXBlW2VdPWZ1bmN0aW9uKHQsbixyKXtyZXR1cm4gdGhpcy5yZXF1ZXN0KGkubWVyZ2Uocnx8e30se21ldGhvZDplLHVybDp0LGRhdGE6bn0pKX19KSxlLmV4cG9ydHM9cn0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiByKGUsdCl7IWkuaXNVbmRlZmluZWQoZSkmJmkuaXNVbmRlZmluZWQoZVsiQ29udGVudC1UeXBlIl0pJiYoZVsiQ29udGVudC1UeXBlIl09dCl9ZnVuY3Rpb24gbygpe3ZhciBlO3JldHVybiJ1bmRlZmluZWQiIT10eXBlb2YgWE1MSHR0cFJlcXVlc3Q/ZT1uKDgpOiJ1bmRlZmluZWQiIT10eXBlb2YgcHJvY2VzcyYmKGU9big4KSksZX12YXIgaT1uKDIpLHM9big3KSx1PXsiQ29udGVudC1UeXBlIjoiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIn0sYT17YWRhcHRlcjpvKCksdHJhbnNmb3JtUmVxdWVzdDpbZnVuY3Rpb24oZSx0KXtyZXR1cm4gcyh0LCJDb250ZW50LVR5cGUiKSxpLmlzRm9ybURhdGEoZSl8fGkuaXNBcnJheUJ1ZmZlcihlKXx8aS5pc0J1ZmZlcihlKXx8aS5pc1N0cmVhbShlKXx8aS5pc0ZpbGUoZSl8fGkuaXNCbG9iKGUpP2U6aS5pc0FycmF5QnVmZmVyVmlldyhlKT9lLmJ1ZmZlcjppLmlzVVJMU2VhcmNoUGFyYW1zKGUpPyhyKHQsImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDtjaGFyc2V0PXV0Zi04IiksZS50b1N0cmluZygpKTppLmlzT2JqZWN0KGUpPyhyKHQsImFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtOCIpLEpTT04uc3RyaW5naWZ5KGUpKTplfV0sdHJhbnNmb3JtUmVzcG9uc2U6W2Z1bmN0aW9uKGUpe2lmKCJzdHJpbmciPT10eXBlb2YgZSl0cnl7ZT1KU09OLnBhcnNlKGUpfWNhdGNoKGUpe31yZXR1cm4gZX1dLHRpbWVvdXQ6MCx4c3JmQ29va2llTmFtZToiWFNSRi1UT0tFTiIseHNyZkhlYWRlck5hbWU6IlgtWFNSRi1UT0tFTiIsbWF4Q29udGVudExlbmd0aDotMSx2YWxpZGF0ZVN0YXR1czpmdW5jdGlvbihlKXtyZXR1cm4gZT49MjAwJiZlPDMwMH19O2EuaGVhZGVycz17Y29tbW9uOntBY2NlcHQ6ImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiJ9fSxpLmZvckVhY2goWyJkZWxldGUiLCJnZXQiLCJoZWFkIl0sZnVuY3Rpb24oZSl7YS5oZWFkZXJzW2VdPXt9fSksaS5mb3JFYWNoKFsicG9zdCIsInB1dCIsInBhdGNoIl0sZnVuY3Rpb24oZSl7YS5oZWFkZXJzW2VdPWkubWVyZ2UodSl9KSxlLmV4cG9ydHM9YX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0Ijt2YXIgcj1uKDIpO2UuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3IuZm9yRWFjaChlLGZ1bmN0aW9uKG4scil7ciE9PXQmJnIudG9VcHBlckNhc2UoKT09PXQudG9VcHBlckNhc2UoKSYmKGVbdF09bixkZWxldGUgZVtyXSl9KX19LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7dmFyIHI9bigyKSxvPW4oOSksaT1uKDEyKSxzPW4oMTMpLHU9bigxNCksYT1uKDEwKSxjPSJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93JiZ3aW5kb3cuYnRvYSYmd2luZG93LmJ0b2EuYmluZCh3aW5kb3cpfHxuKDE1KTtlLmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHQsZil7dmFyIHA9ZS5kYXRhLGQ9ZS5oZWFkZXJzO3IuaXNGb3JtRGF0YShwKSYmZGVsZXRlIGRbIkNvbnRlbnQtVHlwZSJdO3ZhciBsPW5ldyBYTUxIdHRwUmVxdWVzdCxoPSJvbnJlYWR5c3RhdGVjaGFuZ2UiLG09ITE7aWYod2luZG93LlhNTEh0dHBSZXF1ZXN0fHwidW5kZWZpbmVkIj09dHlwZW9mIHdpbmRvd3x8IXdpbmRvdy5YRG9tYWluUmVxdWVzdHx8IndpdGhDcmVkZW50aWFscyJpbiBsfHx1KGUudXJsKXx8KGw9bmV3IHdpbmRvdy5YRG9tYWluUmVxdWVzdCxoPSJvbmxvYWQiLG09ITAsbC5vbnByb2dyZXNzPWZ1bmN0aW9uKCl7fSxsLm9udGltZW91dD1mdW5jdGlvbigpe30pLGUuYXV0aCl7dmFyIHk9ZS5hdXRoLnVzZXJuYW1lfHwiIix3PWUuYXV0aC5wYXNzd29yZHx8IiI7ZC5BdXRob3JpemF0aW9uPSJCYXNpYyAiK2MoeSsiOiIrdyl9aWYobC5vcGVuKGUubWV0aG9kLnRvVXBwZXJDYXNlKCksaShlLnVybCxlLnBhcmFtcyxlLnBhcmFtc1NlcmlhbGl6ZXIpLCEwKSxsLnRpbWVvdXQ9ZS50aW1lb3V0LGxbaF09ZnVuY3Rpb24oKXtpZihsJiYoND09PWwucmVhZHlTdGF0ZXx8bSkmJigwIT09bC5zdGF0dXN8fGwucmVzcG9uc2VVUkwmJjA9PT1sLnJlc3BvbnNlVVJMLmluZGV4T2YoImZpbGU6IikpKXt2YXIgbj0iZ2V0QWxsUmVzcG9uc2VIZWFkZXJzImluIGw/cyhsLmdldEFsbFJlc3BvbnNlSGVhZGVycygpKTpudWxsLHI9ZS5yZXNwb25zZVR5cGUmJiJ0ZXh0IiE9PWUucmVzcG9uc2VUeXBlP2wucmVzcG9uc2U6bC5yZXNwb25zZVRleHQsaT17ZGF0YTpyLHN0YXR1czoxMjIzPT09bC5zdGF0dXM/MjA0Omwuc3RhdHVzLHN0YXR1c1RleHQ6MTIyMz09PWwuc3RhdHVzPyJObyBDb250ZW50IjpsLnN0YXR1c1RleHQsaGVhZGVyczpuLGNvbmZpZzplLHJlcXVlc3Q6bH07byh0LGYsaSksbD1udWxsfX0sbC5vbmVycm9yPWZ1bmN0aW9uKCl7ZihhKCJOZXR3b3JrIEVycm9yIixlLG51bGwsbCkpLGw9bnVsbH0sbC5vbnRpbWVvdXQ9ZnVuY3Rpb24oKXtmKGEoInRpbWVvdXQgb2YgIitlLnRpbWVvdXQrIm1zIGV4Y2VlZGVkIixlLCJFQ09OTkFCT1JURUQiLGwpKSxsPW51bGx9LHIuaXNTdGFuZGFyZEJyb3dzZXJFbnYoKSl7dmFyIGc9bigxNiksdj0oZS53aXRoQ3JlZGVudGlhbHN8fHUoZS51cmwpKSYmZS54c3JmQ29va2llTmFtZT9nLnJlYWQoZS54c3JmQ29va2llTmFtZSk6dm9pZCAwO3YmJihkW2UueHNyZkhlYWRlck5hbWVdPXYpfWlmKCJzZXRSZXF1ZXN0SGVhZGVyImluIGwmJnIuZm9yRWFjaChkLGZ1bmN0aW9uKGUsdCl7InVuZGVmaW5lZCI9PXR5cGVvZiBwJiYiY29udGVudC10eXBlIj09PXQudG9Mb3dlckNhc2UoKT9kZWxldGUgZFt0XTpsLnNldFJlcXVlc3RIZWFkZXIodCxlKX0pLGUud2l0aENyZWRlbnRpYWxzJiYobC53aXRoQ3JlZGVudGlhbHM9ITApLGUucmVzcG9uc2VUeXBlKXRyeXtsLnJlc3BvbnNlVHlwZT1lLnJlc3BvbnNlVHlwZX1jYXRjaCh0KXtpZigianNvbiIhPT1lLnJlc3BvbnNlVHlwZSl0aHJvdyB0fSJmdW5jdGlvbiI9PXR5cGVvZiBlLm9uRG93bmxvYWRQcm9ncmVzcyYmbC5hZGRFdmVudExpc3RlbmVyKCJwcm9ncmVzcyIsZS5vbkRvd25sb2FkUHJvZ3Jlc3MpLCJmdW5jdGlvbiI9PXR5cGVvZiBlLm9uVXBsb2FkUHJvZ3Jlc3MmJmwudXBsb2FkJiZsLnVwbG9hZC5hZGRFdmVudExpc3RlbmVyKCJwcm9ncmVzcyIsZS5vblVwbG9hZFByb2dyZXNzKSxlLmNhbmNlbFRva2VuJiZlLmNhbmNlbFRva2VuLnByb21pc2UudGhlbihmdW5jdGlvbihlKXtsJiYobC5hYm9ydCgpLGYoZSksbD1udWxsKX0pLHZvaWQgMD09PXAmJihwPW51bGwpLGwuc2VuZChwKX0pfX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0Ijt2YXIgcj1uKDEwKTtlLmV4cG9ydHM9ZnVuY3Rpb24oZSx0LG4pe3ZhciBvPW4uY29uZmlnLnZhbGlkYXRlU3RhdHVzO24uc3RhdHVzJiZvJiYhbyhuLnN0YXR1cyk/dChyKCJSZXF1ZXN0IGZhaWxlZCB3aXRoIHN0YXR1cyBjb2RlICIrbi5zdGF0dXMsbi5jb25maWcsbnVsbCxuLnJlcXVlc3QsbikpOmUobil9fSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO3ZhciByPW4oMTEpO2UuZXhwb3J0cz1mdW5jdGlvbihlLHQsbixvLGkpe3ZhciBzPW5ldyBFcnJvcihlKTtyZXR1cm4gcihzLHQsbixvLGkpfX0sZnVuY3Rpb24oZSx0KXsidXNlIHN0cmljdCI7ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCxuLHIsbyl7cmV0dXJuIGUuY29uZmlnPXQsbiYmKGUuY29kZT1uKSxlLnJlcXVlc3Q9cixlLnJlc3BvbnNlPW8sZX19LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gcihlKXtyZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGUpLnJlcGxhY2UoLyU0MC9naSwiQCIpLnJlcGxhY2UoLyUzQS9naSwiOiIpLnJlcGxhY2UoLyUyNC9nLCIkIikucmVwbGFjZSgvJTJDL2dpLCIsIikucmVwbGFjZSgvJTIwL2csIisiKS5yZXBsYWNlKC8lNUIvZ2ksIlsiKS5yZXBsYWNlKC8lNUQvZ2ksIl0iKX12YXIgbz1uKDIpO2UuZXhwb3J0cz1mdW5jdGlvbihlLHQsbil7aWYoIXQpcmV0dXJuIGU7dmFyIGk7aWYobilpPW4odCk7ZWxzZSBpZihvLmlzVVJMU2VhcmNoUGFyYW1zKHQpKWk9dC50b1N0cmluZygpO2Vsc2V7dmFyIHM9W107by5mb3JFYWNoKHQsZnVuY3Rpb24oZSx0KXtudWxsIT09ZSYmInVuZGVmaW5lZCIhPXR5cGVvZiBlJiYoby5pc0FycmF5KGUpJiYodCs9IltdIiksby5pc0FycmF5KGUpfHwoZT1bZV0pLG8uZm9yRWFjaChlLGZ1bmN0aW9uKGUpe28uaXNEYXRlKGUpP2U9ZS50b0lTT1N0cmluZygpOm8uaXNPYmplY3QoZSkmJihlPUpTT04uc3RyaW5naWZ5KGUpKSxzLnB1c2gocih0KSsiPSIrcihlKSl9KSl9KSxpPXMuam9pbigiJiIpfXJldHVybiBpJiYoZSs9KGUuaW5kZXhPZigiPyIpPT09LTE/Ij8iOiImIikraSksZX19LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7dmFyIHI9bigyKSxvPVsiYWdlIiwiYXV0aG9yaXphdGlvbiIsImNvbnRlbnQtbGVuZ3RoIiwiY29udGVudC10eXBlIiwiZXRhZyIsImV4cGlyZXMiLCJmcm9tIiwiaG9zdCIsImlmLW1vZGlmaWVkLXNpbmNlIiwiaWYtdW5tb2RpZmllZC1zaW5jZSIsImxhc3QtbW9kaWZpZWQiLCJsb2NhdGlvbiIsIm1heC1mb3J3YXJkcyIsInByb3h5LWF1dGhvcml6YXRpb24iLCJyZWZlcmVyIiwicmV0cnktYWZ0ZXIiLCJ1c2VyLWFnZW50Il07ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3ZhciB0LG4saSxzPXt9O3JldHVybiBlPyhyLmZvckVhY2goZS5zcGxpdCgiXG4iKSxmdW5jdGlvbihlKXtpZihpPWUuaW5kZXhPZigiOiIpLHQ9ci50cmltKGUuc3Vic3RyKDAsaSkpLnRvTG93ZXJDYXNlKCksbj1yLnRyaW0oZS5zdWJzdHIoaSsxKSksdCl7aWYoc1t0XSYmby5pbmRleE9mKHQpPj0wKXJldHVybjsic2V0LWNvb2tpZSI9PT10P3NbdF09KHNbdF0/c1t0XTpbXSkuY29uY2F0KFtuXSk6c1t0XT1zW3RdP3NbdF0rIiwgIituOm59fSkscyk6c319LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7dmFyIHI9bigyKTtlLmV4cG9ydHM9ci5pc1N0YW5kYXJkQnJvd3NlckVudigpP2Z1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXt2YXIgdD1lO3JldHVybiBuJiYoby5zZXRBdHRyaWJ1dGUoImhyZWYiLHQpLHQ9by5ocmVmKSxvLnNldEF0dHJpYnV0ZSgiaHJlZiIsdCkse2hyZWY6by5ocmVmLHByb3RvY29sOm8ucHJvdG9jb2w/by5wcm90b2NvbC5yZXBsYWNlKC86JC8sIiIpOiIiLGhvc3Q6by5ob3N0LHNlYXJjaDpvLnNlYXJjaD9vLnNlYXJjaC5yZXBsYWNlKC9eXD8vLCIiKToiIixoYXNoOm8uaGFzaD9vLmhhc2gucmVwbGFjZSgvXiMvLCIiKToiIixob3N0bmFtZTpvLmhvc3RuYW1lLHBvcnQ6by5wb3J0LHBhdGhuYW1lOiIvIj09PW8ucGF0aG5hbWUuY2hhckF0KDApP28ucGF0aG5hbWU6Ii8iK28ucGF0aG5hbWV9fXZhciB0LG49Lyhtc2llfHRyaWRlbnQpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSxvPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTtyZXR1cm4gdD1lKHdpbmRvdy5sb2NhdGlvbi5ocmVmKSxmdW5jdGlvbihuKXt2YXIgbz1yLmlzU3RyaW5nKG4pP2Uobik6bjtyZXR1cm4gby5wcm90b2NvbD09PXQucHJvdG9jb2wmJm8uaG9zdD09PXQuaG9zdH19KCk6ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4hMH19KCl9LGZ1bmN0aW9uKGUsdCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIG4oKXt0aGlzLm1lc3NhZ2U9IlN0cmluZyBjb250YWlucyBhbiBpbnZhbGlkIGNoYXJhY3RlciJ9ZnVuY3Rpb24gcihlKXtmb3IodmFyIHQscixpPVN0cmluZyhlKSxzPSIiLHU9MCxhPW87aS5jaGFyQXQoMHx1KXx8KGE9Ij0iLHUlMSk7cys9YS5jaGFyQXQoNjMmdD4+OC11JTEqOCkpe2lmKHI9aS5jaGFyQ29kZUF0KHUrPS43NSkscj4yNTUpdGhyb3cgbmV3IG47dD10PDw4fHJ9cmV0dXJuIHN9dmFyIG89IkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89IjtuLnByb3RvdHlwZT1uZXcgRXJyb3Isbi5wcm90b3R5cGUuY29kZT01LG4ucHJvdG90eXBlLm5hbWU9IkludmFsaWRDaGFyYWN0ZXJFcnJvciIsZS5leHBvcnRzPXJ9LGZ1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7dmFyIHI9bigyKTtlLmV4cG9ydHM9ci5pc1N0YW5kYXJkQnJvd3NlckVudigpP2Z1bmN0aW9uKCl7cmV0dXJue3dyaXRlOmZ1bmN0aW9uKGUsdCxuLG8saSxzKXt2YXIgdT1bXTt1LnB1c2goZSsiPSIrZW5jb2RlVVJJQ29tcG9uZW50KHQpKSxyLmlzTnVtYmVyKG4pJiZ1LnB1c2goImV4cGlyZXM9IituZXcgRGF0ZShuKS50b0dNVFN0cmluZygpKSxyLmlzU3RyaW5nKG8pJiZ1LnB1c2goInBhdGg9IitvKSxyLmlzU3RyaW5nKGkpJiZ1LnB1c2goImRvbWFpbj0iK2kpLHM9PT0hMCYmdS5wdXNoKCJzZWN1cmUiKSxkb2N1bWVudC5jb29raWU9dS5qb2luKCI7ICIpfSxyZWFkOmZ1bmN0aW9uKGUpe3ZhciB0PWRvY3VtZW50LmNvb2tpZS5tYXRjaChuZXcgUmVnRXhwKCIoXnw7XFxzKikoIitlKyIpPShbXjtdKikiKSk7cmV0dXJuIHQ/ZGVjb2RlVVJJQ29tcG9uZW50KHRbM10pOm51bGx9LHJlbW92ZTpmdW5jdGlvbihlKXt0aGlzLndyaXRlKGUsIiIsRGF0ZS5ub3coKS04NjRlNSl9fX0oKTpmdW5jdGlvbigpe3JldHVybnt3cml0ZTpmdW5jdGlvbigpe30scmVhZDpmdW5jdGlvbigpe3JldHVybiBudWxsfSxyZW1vdmU6ZnVuY3Rpb24oKXt9fX0oKX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiByKCl7dGhpcy5oYW5kbGVycz1bXX12YXIgbz1uKDIpO3IucHJvdG90eXBlLnVzZT1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmhhbmRsZXJzLnB1c2goe2Z1bGZpbGxlZDplLHJlamVjdGVkOnR9KSx0aGlzLmhhbmRsZXJzLmxlbmd0aC0xfSxyLnByb3RvdHlwZS5lamVjdD1mdW5jdGlvbihlKXt0aGlzLmhhbmRsZXJzW2VdJiYodGhpcy5oYW5kbGVyc1tlXT1udWxsKX0sci5wcm90b3R5cGUuZm9yRWFjaD1mdW5jdGlvbihlKXtvLmZvckVhY2godGhpcy5oYW5kbGVycyxmdW5jdGlvbih0KXtudWxsIT09dCYmZSh0KX0pfSxlLmV4cG9ydHM9cn0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiByKGUpe2UuY2FuY2VsVG9rZW4mJmUuY2FuY2VsVG9rZW4udGhyb3dJZlJlcXVlc3RlZCgpfXZhciBvPW4oMiksaT1uKDE5KSxzPW4oMjApLHU9big2KSxhPW4oMjEpLGM9bigyMik7ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3IoZSksZS5iYXNlVVJMJiYhYShlLnVybCkmJihlLnVybD1jKGUuYmFzZVVSTCxlLnVybCkpLGUuaGVhZGVycz1lLmhlYWRlcnN8fHt9LGUuZGF0YT1pKGUuZGF0YSxlLmhlYWRlcnMsZS50cmFuc2Zvcm1SZXF1ZXN0KSxlLmhlYWRlcnM9by5tZXJnZShlLmhlYWRlcnMuY29tbW9ufHx7fSxlLmhlYWRlcnNbZS5tZXRob2RdfHx7fSxlLmhlYWRlcnN8fHt9KSxvLmZvckVhY2goWyJkZWxldGUiLCJnZXQiLCJoZWFkIiwicG9zdCIsInB1dCIsInBhdGNoIiwiY29tbW9uIl0sZnVuY3Rpb24odCl7ZGVsZXRlIGUuaGVhZGVyc1t0XX0pO3ZhciB0PWUuYWRhcHRlcnx8dS5hZGFwdGVyO3JldHVybiB0KGUpLnRoZW4oZnVuY3Rpb24odCl7cmV0dXJuIHIoZSksdC5kYXRhPWkodC5kYXRhLHQuaGVhZGVycyxlLnRyYW5zZm9ybVJlc3BvbnNlKSx0fSxmdW5jdGlvbih0KXtyZXR1cm4gcyh0KXx8KHIoZSksdCYmdC5yZXNwb25zZSYmKHQucmVzcG9uc2UuZGF0YT1pKHQucmVzcG9uc2UuZGF0YSx0LnJlc3BvbnNlLmhlYWRlcnMsZS50cmFuc2Zvcm1SZXNwb25zZSkpKSxQcm9taXNlLnJlamVjdCh0KX0pfX0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0Ijt2YXIgcj1uKDIpO2UuZXhwb3J0cz1mdW5jdGlvbihlLHQsbil7cmV0dXJuIHIuZm9yRWFjaChuLGZ1bmN0aW9uKG4pe2U9bihlLHQpfSksZX19LGZ1bmN0aW9uKGUsdCl7InVzZSBzdHJpY3QiO2UuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4hKCFlfHwhZS5fX0NBTkNFTF9fKX19LGZ1bmN0aW9uKGUsdCl7InVzZSBzdHJpY3QiO2UuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4vXihbYS16XVthLXpcZFwrXC1cLl0qOik/XC9cLy9pLnRlc3QoZSl9fSxmdW5jdGlvbihlLHQpeyJ1c2Ugc3RyaWN0IjtlLmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdD9lLnJlcGxhY2UoL1wvKyQvLCIiKSsiLyIrdC5yZXBsYWNlKC9eXC8rLywiIik6ZX19LGZ1bmN0aW9uKGUsdCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIG4oZSl7dGhpcy5tZXNzYWdlPWV9bi5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4iQ2FuY2VsIisodGhpcy5tZXNzYWdlPyI6ICIrdGhpcy5tZXNzYWdlOiIiKX0sbi5wcm90b3R5cGUuX19DQU5DRUxfXz0hMCxlLmV4cG9ydHM9bn0sZnVuY3Rpb24oZSx0LG4peyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiByKGUpe2lmKCJmdW5jdGlvbiIhPXR5cGVvZiBlKXRocm93IG5ldyBUeXBlRXJyb3IoImV4ZWN1dG9yIG11c3QgYmUgYSBmdW5jdGlvbi4iKTt2YXIgdDt0aGlzLnByb21pc2U9bmV3IFByb21pc2UoZnVuY3Rpb24oZSl7dD1lfSk7dmFyIG49dGhpcztlKGZ1bmN0aW9uKGUpe24ucmVhc29ufHwobi5yZWFzb249bmV3IG8oZSksdChuLnJlYXNvbikpfSl9dmFyIG89bigyMyk7ci5wcm90b3R5cGUudGhyb3dJZlJlcXVlc3RlZD1mdW5jdGlvbigpe2lmKHRoaXMucmVhc29uKXRocm93IHRoaXMucmVhc29ufSxyLnNvdXJjZT1mdW5jdGlvbigpe3ZhciBlLHQ9bmV3IHIoZnVuY3Rpb24odCl7ZT10fSk7cmV0dXJue3Rva2VuOnQsY2FuY2VsOmV9fSxlLmV4cG9ydHM9cn0sZnVuY3Rpb24oZSx0KXsidXNlIHN0cmljdCI7ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gZS5hcHBseShudWxsLHQpfX19XSl9KTsKDQovLyDns7vntbHpjK/oqqToppbnqpcNCmZ1bmN0aW9uIGVycm9yTW9kYWwobWVzc2FnZSkgew0KICAgICQudW5ibG9ja1VJKCk7DQogICAgc3dhbCh7DQogICAgICAgIHRpdGxlOiAi5pON5L2c5aSx5pWXIiwNCiAgICAgICAgaHRtbDogIuiri+a0veezu+e1seeuoeeQhuWToSE8YnJcPiIgKyAoIW1lc3NhZ2UgPyAiIiA6IG1lc3NhZ2UucmVwbGFjZSgvXi4qPzxib2R5W14+XSo+KC4qPyk8XC9ib2R5Pi4qPyQvaSwgIiQxIikpLA0KICAgICAgICB0eXBlOiAiZXJyb3IiLA0KICAgICAgICAvL3RpbWVyOiAzMDAwLA0KICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIueiuuWumiIsDQogICAgICAgIHdpZHRoOiAoIW1lc3NhZ2UgPyA1MDAgOiAxMjAwKQ0KICAgIH0pLnRoZW4oDQogICAgICAgIGZ1bmN0aW9uIChyZXN1bHQpIHsgfQ0KICAgICk7DQp9DQoNCi8vIOWEsuWtmOaZguWRvOWPq+eahGZ1bmN0aW9uDQovLyDngrrkuobpgb/lhY1DU1JG5pS75pOKLCDmnIPlj5blvpdSZXF1ZXN0VmVyaWZpY2F0aW9uVG9rZW4NCi8vIOWFiOS4iuWCs+aqlOahiCwg5YaN5a+r5YWlREINCmZ1bmN0aW9uIGFqYXhVcGxvYWQoc2F2ZVVybCwgZGF0YSwgdXBsb2FkVXJsLCBmb3JtZGF0YSkgew0KICAgIC8vYWxlcnQoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOw0KDQogICAgJC5hamF4KHsNCiAgICAgICAgdXJsOiBzYXZlVXJsLA0KICAgICAgICB0eXBlOiAiUE9TVCIsDQogICAgICAgIGRhdGFUeXBlOiAnanNvbicsDQogICAgICAgIGRhdGE6IHsNCiAgICAgICAgICAgIF9fUmVxdWVzdFZlcmlmaWNhdGlvblRva2VuOiAkKCdbbmFtZT1fX1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbl0nKS52YWwoKSwNCiAgICAgICAgICAgIGZvcm06IGRhdGENCiAgICAgICAgfSwNCiAgICAgICAgYmVmb3JlU2VuZDogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgYmxvY2tVSSgpOw0KICAgICAgICB9LA0KICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgew0KICAgICAgICAgICAgJC5hamF4KHsNCiAgICAgICAgICAgICAgICB1cmw6IHVwbG9hZFVybCwNCiAgICAgICAgICAgICAgICB0eXBlOiAiUE9TVCIsDQogICAgICAgICAgICAgICAgZGF0YTogZm9ybWRhdGEsDQogICAgICAgICAgICAgICAgY29udGVudFR5cGU6IGZhbHNlLA0KICAgICAgICAgICAgICAgIHByb2Nlc3NEYXRhOiBmYWxzZSwNCiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAocmVzcG9uc2UpIHsNCiAgICAgICAgICAgICAgICAgICAgLy9hbGVydChyZXNwb25zZSk7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBhamF4UmVzcG9uc2UoIuWEsuWtmCIsIGRhdGEpOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIGFqYXhPcHRpb25zLCB0aHJvd25FcnJvcikgew0KICAgICAgICAgICAgICAgICAgICBlcnJvck1vZGFsKHhoci5yZXNwb25zZVRleHQpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KDQoNCg0KICAgICAgICB9LA0KICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgYWpheE9wdGlvbnMsIHRocm93bkVycm9yKSB7DQogICAgICAgICAgICBlcnJvck1vZGFsKHhoci5yZXNwb25zZVRleHQpOw0KICAgICAgICB9LA0KICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgJC51bmJsb2NrVUkoKTsNCiAgICAgICAgfQ0KICAgIH0pOw0KfQ0KDQoNCi8vIOWEsuWtmOaZguWRvOWPq+eahGZ1bmN0aW9uDQovLyDngrrkuobpgb/lhY1DU1JG5pS75pOKLCDmnIPlj5blvpdSZXF1ZXN0VmVyaWZpY2F0aW9uVG9rZW4NCi8vIOesrOS6jOWAi+WPg+aVuOeCuueVq+mdouizh+aWmSwg5pyq5YKz5YWl5pmC6aCQ6Kit5oqTW25hbWU9Zm9ybV3ljrtzZXJpYWxpemUNCmZ1bmN0aW9uIGFqYXhTYXZlKHNhdmVVcmwsIGRhdGEpIHsNCiAgICAvL2FsZXJ0KEpTT04uc3RyaW5naWZ5KGRhdGEpKTsNCg0KICAgICQuYWpheCh7DQogICAgICAgIHVybDogc2F2ZVVybCwNCiAgICAgICAgdHlwZTogIlBPU1QiLA0KICAgICAgICBkYXRhVHlwZTogJ2pzb24nLA0KICAgICAgICBkYXRhOiB7DQogICAgICAgICAgICBfX1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbjogJCgnW25hbWU9X19SZXF1ZXN0VmVyaWZpY2F0aW9uVG9rZW5dJykudmFsKCksDQogICAgICAgICAgICBmb3JtOiBkYXRhDQogICAgICAgIH0sDQogICAgICAgIGJlZm9yZVNlbmQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGJsb2NrVUkoKTsNCiAgICAgICAgfSwNCiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsNCiAgICAgICAgICAgIGFqYXhSZXNwb25zZSgi5YSy5a2YIiwgZGF0YSk7DQogICAgICAgIH0sDQogICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBhamF4T3B0aW9ucywgdGhyb3duRXJyb3IpIHsNCiAgICAgICAgICAgIGVycm9yTW9kYWwoeGhyLnJlc3BvbnNlVGV4dCk7DQogICAgICAgIH0sDQogICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAkLnVuYmxvY2tVSSgpOw0KICAgICAgICB9DQogICAgfSk7DQp9DQoNCi8vIGFqYXjlm57opoboqIrmga8NCmZ1bmN0aW9uIGFqYXhSZXNwb25zZShhY3Rpb25UeXBlVGV4dCwgZGF0YSwgbWVzc2FnZSwgZWxhcHNlKSB7DQogICAgaWYgKCFkYXRhLlN1Y2Nlc3MpIHsNCiAgICAgICAgJCgiLnZhbGlkYXRpb24tc3VtbWFyeS1lcnJvcnMgdWwgbGkiKS5yZW1vdmUoKTsNCiAgICAgICAgJC5lYWNoKGRhdGEuTWVzc2FnZSwgZnVuY3Rpb24gKGluZGV4LCBpdGVtKSB7DQogICAgICAgICAgICAkKCIudmFsaWRhdGlvbi1zdW1tYXJ5LWVycm9ycyB1bCIpLmFwcGVuZCgkKCI8bGk+IikudGV4dChpdGVtKSk7DQogICAgICAgIH0pOw0KICAgIH0gZWxzZSB7DQogICAgICAgIHN3YWwoew0KICAgICAgICAgICAgdGl0bGU6ICLlrozmiJAiLA0KICAgICAgICAgICAgaHRtbDogIW1lc3NhZ2UgPyBhY3Rpb25UeXBlVGV4dCArICLmiJDlip8hIiA6IG1lc3NhZ2UsDQogICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsDQogICAgICAgICAgICB0aW1lcjogIWVsYXBzZSA/IDIwMDAgOiBlbGFwc2UsDQogICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UNCiAgICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7DQogICAgICAgICAgICBpZiAocmVzdWx0LmRpc21pc3MgPT09IHN3YWwuRGlzbWlzc1JlYXNvbi50aW1lcikgew0KICAgICAgICAgICAgICAgIGlmICghZGF0YS5MaW5rKSB7DQogICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBkYXRhLkxpbms7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQp9DQoNCg0KLy8g6Lez6Iez5YmN5LiA6aCBDQpmdW5jdGlvbiBwcmV2aW91c1BhZ2UobGluaykgew0KICAgIGxvY2F0aW9uLmhyZWYgPSBkb2N1bWVudC5yZWZlcnJlcjsNCn0NCg0KLy8g5Yiq6Zmk56K66KqN6KaW56qXZnVuY3Rpb24NCi8vIOacg+WFiOi3s+WHuuWIqumZpOeiuuiqjQ0KLy8g6Iul6amX6K2J5LiN5oiQ5YqfLCDmnIPot7Plh7rpjK/oqqToqIrmga8o6aGv56S65b6M56uvY29udHJvbGxlciBtZXNzYWdlKQ0KLy8g6Iul5Yiq6Zmk5LiN5oiQ5YqfLCDmnIPot7Plh7rns7vntbHpjK/oqqToqIrmga8NCmZ1bmN0aW9uIGNvbmZpcm1EaWFsb2cocGF0aCwgZGVsZXRlS2V5LCBtZXNzYWdlKSB7DQogICAgdmFyIGRhdGEgPSB7fTsNCiAgICBkYXRhLl9fUmVxdWVzdFZlcmlmaWNhdGlvblRva2VuID0gJCgnW25hbWU9X19SZXF1ZXN0VmVyaWZpY2F0aW9uVG9rZW5dJykudmFsKCk7DQogICAgZGF0YS5pZCA9IGRlbGV0ZUtleTsNCg0KICAgIC8vIGFsZXJ0KHBhdGgpOw0KICAgIC8vIGFsZXJ0KEpTT04uc3RyaW5naWZ5KGRhdGEpKTsNCg0KICAgIHN3YWwoew0KICAgICAgICB0aXRsZTogJ+eiuuiqjeimlueqlycsDQogICAgICAgIHRleHQ6ICLnorroqo3opoEiICsgKCEhbWVzc2FnZSA/IG1lc3NhZ2UgOiAi5Yiq6ZmkIikgKyAi6Kmy562G6LOH5paZPyIsDQogICAgICAgIHR5cGU6ICd3YXJuaW5nJywNCiAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwNCiAgICAgICAgY29uZmlybUJ1dHRvbkNvbG9yOiAiIzMwODVkNiIsDQogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56K66KqNJywNCiAgICAgICAgY29uZmlybUJ1dHRvbkNsYXNzOiAnYnRuIGJ0bi1zdWNjZXNzJywNCiAgICAgICAgY2FuY2VsQnV0dG9uQ29sb3I6ICcjZDMzJywNCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WQpicsDQogICAgICAgIGNhbmNlbEJ1dHRvbkNsYXNzOiAnYnRuIGJ0bi1kYW5nZXInDQogICAgfSkudGhlbigNCiAgICAgICAgZnVuY3Rpb24gKGlzQ29uZmlybSkgew0KICAgICAgICAgICAgJC5ibG9ja1VJKHsgbWVzc2FnZTogIiIgfSk7DQogICAgICAgICAgICAkLmFqYXgoew0KICAgICAgICAgICAgICAgIHVybDogcGF0aCwNCiAgICAgICAgICAgICAgICB0eXBlOiAiREVMRVRFIiwNCiAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLA0KICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7DQogICAgICAgICAgICAgICAgICAgIGFqYXhSZXNwb25zZSgoISFtZXNzYWdlID8gbWVzc2FnZSA6ICLliKrpmaQiKSwgZGF0YSk7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgYWpheE9wdGlvbnMsIHRocm93bkVycm9yKSB7DQogICAgICAgICAgICAgICAgICAgIGVycm9yTW9kYWwoeGhyLnJlc3BvbnNlVGV4dCk7DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAkLnVuYmxvY2tVSSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9LA0KICAgICAgICBmdW5jdGlvbiAoZGlzbWlzcykgew0KICAgICAgICAgICAgaWYgKGRpc21pc3MgPT09ICdjYW5jZWwnKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgKTsNCn0NCg0KDQovLyDnorroqo3oppbnqpdmdW5jdGlvbg0KLy8g5pyD5YWI6Lez5Ye65Yiq6Zmk56K66KqNDQovLyDoi6XpqZforYnkuI3miJDlip8sIOacg+i3s+WHuumMr+iqpOioiuaBryjpoa/npLrlvoznq69jb250cm9sbGVyIG1lc3NhZ2UpDQovLyDoi6XliKrpmaTkuI3miJDlip8sIOacg+i3s+WHuuezu+e1semMr+iqpOioiuaBrw0KZnVuY3Rpb24gY29uZmlybShwYXRoLCBkYXRhLCBtZXNzYWdlKSB7DQogICAgLy8gYWxlcnQocGF0aCk7DQogICAgZGF0YS5fX1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbiA9ICQoJ1tuYW1lPV9fUmVxdWVzdFZlcmlmaWNhdGlvblRva2VuXScpLnZhbCgpOw0KDQogICAgc3dhbCh7DQogICAgICAgIHRpdGxlOiAn56K66KqN6KaW56qXJywNCiAgICAgICAgdGV4dDogIueiuuiqjeimgSIgKyBtZXNzYWdlICsgIuipsuethuizh+aWmT8iLA0KICAgICAgICB0eXBlOiAnd2FybmluZycsDQogICAgICAgIHNob3dDYW5jZWxCdXR0b246IHRydWUsDQogICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogIiMzMDg1ZDYiLA0KICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+eiuuiqjScsDQogICAgICAgIGNvbmZpcm1CdXR0b25DbGFzczogJ2J0biBidG4tc3VjY2VzcycsDQogICAgICAgIGNhbmNlbEJ1dHRvbkNvbG9yOiAnI2QzMycsDQogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflkKYnLA0KICAgICAgICBjYW5jZWxCdXR0b25DbGFzczogJ2J0biBidG4tZGFuZ2VyJw0KICAgIH0pLnRoZW4oDQogICAgICAgIGZ1bmN0aW9uIChpc0NvbmZpcm0pIHsNCiAgICAgICAgICAgICQuYmxvY2tVSSh7IG1lc3NhZ2U6ICIiIH0pOw0KICAgICAgICAgICAgJC5hamF4KHsNCiAgICAgICAgICAgICAgICB1cmw6IHBhdGgsDQogICAgICAgICAgICAgICAgdHlwZTogIlBPU1QiLA0KICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsDQogICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgYWpheFJlc3BvbnNlKG1lc3NhZ2UsIGRhdGEpOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIGFqYXhPcHRpb25zLCB0aHJvd25FcnJvcikgew0KICAgICAgICAgICAgICAgICAgICBlcnJvck1vZGFsKHhoci5yZXNwb25zZVRleHQpOw0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgJC51bmJsb2NrVUkoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSwNCiAgICAgICAgZnVuY3Rpb24gKGRpc21pc3MpIHsNCiAgICAgICAgICAgIGlmIChkaXNtaXNzID09PSAnY2FuY2VsJykgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICk7DQp9DQoNCg0KLy/pgJnoo6HmmK/oqK3lrppzZXNzaW9uIHRpbWVvdXTlgJLmlbjmmYLplpMNCmZ1bmN0aW9uIHNldFRpbWVyKHNlY29uZHMpIHsNCg0KICAgIHZhciBpbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgaWYgKHNlY29uZHMgPiAwKSB7DQogICAgICAgICAgICBzZWNvbmRzLS07DQogICAgICAgICAgICAvL2lmIChzZWNvbmRzICUgMyA9PSAwICkgYWxlcnQoc2Vjb25kcyk7DQogICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhzZWNvbmRzKTsNCiAgICAgICAgICAgIC8v5aaC5p6cdGltZW915bCx5o+Q56S66KiK5oGv55m75Ye6DQogICAgICAgICAgICBpZiAoc2Vjb25kcyA9PT0gMCkgew0KICAgICAgICAgICAgICAgIHN3YWwoew0KICAgICAgICAgICAgICAgICAgICB0aXRsZTogIueZu+WHuiIsDQogICAgICAgICAgICAgICAgICAgIGh0bWw6ICI8Zm9udCBjb2xvcj0ncmVkJz7mgqjnmoTplpLnva7mmYLplpPpgY7kuYUhPGJyPuW3suiiq+ezu+e1seeZu+WHuu+8jOiri+mHjeaWsOeZu+WFpSE8L2ZvbnQ+IiwNCiAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLA0KICAgICAgICAgICAgICAgICAgICB0aW1lcjogMzAwMCwNCiAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlDQogICAgICAgICAgICAgICAgfSkudGhlbigNCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHJlc3VsdCkgeyB9LA0KICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZGlzbWlzcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRpc21pc3MgPT09ICd0aW1lcicpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjbG9nb3V0Rm9ybScpLnN1Ym1pdCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9IGVsc2UgeyAvL+WAkuaVuOaZgumWk+W3sue1kOadn++8jOWwh+ipsuS9v+eUqOiAheeZu+WHuuWwjuWQkeeZu+WFpemggQ0KICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7IC8v5riF6Zmk5q2k5YCS5pW45pa55rOVDQogICAgICAgIH0NCiAgICB9LCAxMDAwKTsvL+ioreWumuavj+enkumQmOWft+ihjA0KDQogICAgcmV0dXJuIGludGVydmFsOw0KfQ0KDQovLyDnt6jovK/jgIHliKrpmaQgYnV0dG9uDQovLyBlZGl0UGF0aCA6IOe3qOi8r+i3r+W+kQ0KLy8gZGVsZXRlUGF0aCA6IOWIqumZpOi3r+W+kSANCi8vIGlkIDoga2V5DQpmdW5jdGlvbiBlZGl0RGVsZXRlQnV0dG9uKGVkaXRQYXRoLCBkZWxldGVQYXRoLCBpZCkgew0KICAgIC8vYWxlcnQoYnV0dG9ucyk7DQogICAgcmV0dXJuIGVkaXRCdXR0b24oZWRpdFBhdGgsIGlkKSArIGRlbGV0ZUJ1dHRvbihkZWxldGVQYXRoLCBpZCk7DQp9DQoNCg0KLy8g57eo6LyvIGJ1dHRvbg0KLy8gZWRpdFBhdGggOiDnt6jovK/ot6/lvpENCi8vIGlkIDoga2V5DQpmdW5jdGlvbiBlZGl0QnV0dG9uKGVkaXRQYXRoLCBpZCkgew0KICAgIHZhciBidXR0b24gPSAiPGJ1dHRvbiBjbGFzcz0nYnRuIGJ0bi1wcmltYXJ5IGJ0bi1zbScgb25DbGljaz1cImxvY2F0aW9uLmhyZWY9JyIgKyBlZGl0UGF0aCArIGlkICsgIidcIj48aSBjbGFzcz0nZmEgZmEtZWRpdCc+PC9pPue3qOi8rzwvYnV0dG9uPiAiOw0KDQogICAgLy9hbGVydChidXR0b25zKTsNCiAgICByZXR1cm4gYnV0dG9uOw0KfQ0KDQovLyDliKrpmaQgYnV0dG9uDQovLyBkZWxldGVQYXRoIDog5Yiq6Zmk6Lev5b6RIA0KLy8gaWQgOiBrZXkNCmZ1bmN0aW9uIGRlbGV0ZUJ1dHRvbihkZWxldGVQYXRoLCBpZCkgew0KICAgIHZhciBidXR0b24gPSAiPGJ1dHRvbiBjbGFzcz0nYnRuIGJ0bi1kYW5nZXIgYnRuLXNtJyBvbkNsaWNrPSdjb25maXJtRGlhbG9nKFwiIiArIGRlbGV0ZVBhdGggKyAiXCIsIFwiIiArIGlkICsgIlwiKSc+PGkgY2xhc3M9J2ZhIGZhLXJlbW92ZSc+PC9pPuWIqumZpDwvYnV0dG9uPiAiOw0KDQogICAgLy9hbGVydChidXR0b24pOw0KICAgIHJldHVybiBidXR0b247DQp9DQoNCi8vIOWIl+WNsCBidXR0b24NCi8vIGVkaXRQYXRoIDog5YiX5Y2w6Lev5b6RDQovLyBpZCA6IGtleQ0KZnVuY3Rpb24gcHJpbnRCdXR0b24ocHJpbnRQYXRoLCBpZCkgew0KICAgIHZhciBidXR0b24gPSAiPGJ1dHRvbiBjbGFzcz0nYnRuIGJ0bi1pbmZvIGJ0bi1zbScgb25DbGljaz1cIndpbmRvdy5vcGVuKCciICsgcHJpbnRQYXRoICsgIj9rZXk9IiArIGlkICsgIicsICdfYmxhbmsnKSBcIj48aSBjbGFzcz0nZmEgZmEtZWRpdCc+PC9pPuWIl+WNsDwvYnV0dG9uPiAiOw0KICAgIC8vYWxlcnQoYnV0dG9ucyk7DQogICAgcmV0dXJuIGJ1dHRvbjsNCn0NCg0KZnVuY3Rpb24gZXJyb3JNZXNzYWdlKG1lc3NhZ2UpIHsNCiAgICBzd2FsKHsNCiAgICAgICAgdGl0bGU6ICLpjK/oqqQiLA0KICAgICAgICB0ZXh0OiBtZXNzYWdlLA0KICAgICAgICB0eXBlOiAiZXJyb3IiLA0KICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIueiuuWumiIsDQogICAgfSk7DQp9DQoNCmZ1bmN0aW9uIHdhcm5pbmdNZXNzYWdlKG1lc3NhZ2UpIHsNCiAgICBzd2FsKHsNCiAgICAgICAgdGl0bGU6ICLorabnpLoiLA0KICAgICAgICB0ZXh0OiBtZXNzYWdlLA0KICAgICAgICB0eXBlOiAid2FybmluZyIsDQogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAi56K65a6aIiwNCiAgICB9KTsNCn0NCg0KZnVuY3Rpb24gZXhwb3J0RXhjZWwocGF0aCwgbW9kZWwsIGZpbGVOYW1lKSB7DQogICAgLy9hbGVydChKU09OLnN0cmluZ2lmeShtb2RlbCkpOw0KICAgIGJsb2NrVUkoKTsNCiAgICBheGlvcy5nZXQocGF0aCwgew0KICAgICAgICBwYXJhbXM6IG1vZGVsLA0KICAgICAgICBtZXRob2Q6ICdnZXQnLA0KICAgICAgICB3aXRoQ3JlZGVudGlhbHM6IHRydWUsDQogICAgICAgIHJlc3BvbnNlVHlwZTogJ2Jsb2InLA0KICAgICAgICBoZWFkZXJzOiB7DQogICAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC5zcHJlYWRzaGVldG1sLnNoZWV0JywNCiAgICAgICAgfSwNCiAgICB9KS50aGVuKChyZXNwb25zZSkgPT4gew0KICAgICAgICBkb3dubG9hZChyZXNwb25zZS5kYXRhLCBmaWxlTmFtZSk7DQogICAgICAgICQudW5ibG9ja1VJKCk7DQogICAgfSk7DQp9DQoNCg0KLy8g5LiK5YKz5qqU5qGIDQpmdW5jdGlvbiB1cGxvYWRGaWxlKGZpbGUpIHsNCiAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsNCiAgICB2YXIgZGVmZXJyZWQgPSAkLkRlZmVycmVkKCk7DQoNCiAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGV2ZW50KSB7DQogICAgICAgIGRlZmVycmVkLnJlc29sdmUoZXZlbnQudGFyZ2V0LnJlc3VsdCk7DQogICAgfTsNCg0KICAgIHJlYWRlci5vbmVycm9yID0gZnVuY3Rpb24gKCkgew0KICAgICAgICBkZWZlcnJlZC5yZWplY3QodGhpcyk7DQogICAgfTsNCg0KICAgIGlmICgvXmltYWdlLy50ZXN0KGZpbGUudHlwZSkpIHsNCiAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgcmVhZGVyLnJlYWRBc1RleHQoZmlsZSk7DQogICAgfQ0KDQogICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTsNCn0NCi8vIOWwh0pzb27ml6XmnJ/ovYnmiJDml6XmnJ/moLzlvI8NCmZ1bmN0aW9uIEpzb24yRGF0ZShzdHIpIHsNCiAgICAvL2FsZXJ0KHN0cik7DQogICAgaWYgKHN0ciA9PSAiL0RhdGUoLTYyMTM1NTk2ODAwMDAwKS8iKSByZXR1cm4gbnVsbDsNCiAgICByZXR1cm4gbmV3IERhdGUocGFyc2VJbnQoc3RyLnN1YnN0cig2KSwgMTApKS5mKCJ5eXl5L01NL2RkIik7DQp9DQoNCmZ1bmN0aW9uIElTT0RhdGUyU3RyKHN0cikgew0KICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKDAsIDEwKS5yZXBsYWNlKC8tL2csICIvIik7DQp9DQoNCmZ1bmN0aW9uIGRhdGUyU3RyKGRhdGUpIHsNCiAgICB2YXIgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTsNCiAgICB2YXIgbW9udGggPSBscGFkKChkYXRlLmdldE1vbnRoKCkgKyAxKSwgMiwgIjAiKTsNCiAgICB2YXIgZGF5ID0gbHBhZChkYXRlLmdldERhdGUoKSwgMiwgIjAiKTsNCiAgICByZXR1cm4gZGF0ZSA/ICh5ZWFyICsgIi8iICsgbW9udGggKyAiLyIgKyBkYXkpIDogIiI7DQp9DQoNCmZ1bmN0aW9uIHBhcnNlSnNvbkRhdGUoanNvbkRhdGVTdHJpbmcpIHsNCiAgICByZXR1cm4gbmV3IERhdGUocGFyc2VJbnQoanNvbkRhdGVTdHJpbmcucmVwbGFjZSgnL0RhdGUoJywgJycpKSk7DQp9DQoNCg0KLy8g5Lu75pyf5qC85byP6L2J5o+bDQpmdW5jdGlvbiBwYXJzZURhdGUoc3RyKSB7DQogICAgaWYgKCFzdHIpIHJldHVybiBudWxsOw0KICAgIGlmIChpc1ZhbGlkRGF0ZShzdHIpKSB7DQogICAgICAgIHZhciB0ZW1wRGF0ZSA9IHN0ci5zcGxpdCgnLycpOw0KICAgICAgICB2YXIgeWVhciA9IHRlbXBEYXRlWzBdOyAvLyBhbGVydCh5ZWFyKTsNCiAgICAgICAgdmFyIG1vbnRoID0gdGVtcERhdGVbMV07IC8vIGFsZXJ0KG1vbnRoKTsNCiAgICAgICAgdmFyIGRheSA9IHRlbXBEYXRlWzJdOyAvLyBhbGVydChkYXkpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAvL3BsZWFzZSBwdXQgYXR0ZW50aW9uIHRvIHRoZSBtb250aCAocGFydHNbMF0pLCBKYXZhc2NyaXB0IGNvdW50cyBtb250aHMgZnJvbSAwDQogICAgICAgIHJldHVybiBuZXcgRGF0ZSh5ZWFyLCBtb250aCAtIDEsIGRheSk7DQogICAgfQ0KICAgIHJldHVybiB1bmRlZmluZWQ7DQp9DQoNCmZ1bmN0aW9uIHJhbmdlKHN0YXJ0LCBlbmQpIHsNCiAgICByZXR1cm4gKG5ldyBBcnJheShlbmQgLSBzdGFydCArIDEpKS5maWxsKHVuZGVmaW5lZCkubWFwKChfLCBpKSA9PiBpICsgc3RhcnQpOw0KfQ0KDQoNCg0KLy8g6amX6K2J5pel5pyfDQpmdW5jdGlvbiBpc1ZhbGlkRGF0ZShkYXRlU3RyaW5nKSB7DQogICAgaWYgKCEvXihcZHs0fSkoXC98LSkoXGR7MSwyfSkoXC98LSkoXGR7MSwyfSkkLy50ZXN0KGRhdGVTdHJpbmcpIHx8IGRhdGVTdHJpbmcubGVuZ3RoICE9IDEwKSByZXR1cm4gZmFsc2U7DQoNCiAgICB2YXIgdGVtcERhdGUgPSBkYXRlU3RyaW5nLnNwbGl0KCcvJyk7DQogICAgdmFyIHZhbGlkID0gdHJ1ZTsNCiAgICB2YXIgeWVhciA9IHRlbXBEYXRlWzBdOyAvLyBhbGVydCh5ZWFyKTsNCiAgICB2YXIgbW9udGggPSB0ZW1wRGF0ZVsxXTsgLy8gYWxlcnQobW9udGgpOw0KICAgIHZhciBkYXkgPSB0ZW1wRGF0ZVsyXTsgLy8gYWxlcnQoZGF5KTsNCg0KICAgIGlmICgobW9udGggPCAxKSB8fCAobW9udGggPiAxMikpIHZhbGlkID0gZmFsc2U7DQogICAgZWxzZSBpZiAoKGRheSA8IDEpIHx8IChkYXkgPiAzMSkpIHZhbGlkID0gZmFsc2U7DQogICAgZWxzZSBpZiAoKChtb250aCA9PSA0KSB8fCAobW9udGggPT0gNikgfHwgKG1vbnRoID09IDkpIHx8IChtb250aCA9PSAxMSkpICYmIChkYXkgPiAzMCkpIHZhbGlkID0gZmFsc2U7DQogICAgZWxzZSBpZiAoKG1vbnRoID09IDIpICYmICgoKHllYXIgJSA0MDApID09IDApIHx8ICgoeWVhciAlIDQpID09IDApKSAmJiAoKHllYXIgJSAxMDApICE9IDApICYmIChkYXkgPiAyOSkpIHZhbGlkID0gZmFsc2U7DQogICAgZWxzZSBpZiAoKG1vbnRoID09IDIpICYmICgoeWVhciAlIDEwMCkgPT0gMCkgJiYgKGRheSA+IDI5KSkgdmFsaWQgPSBmYWxzZTsNCiAgICBlbHNlIGlmICgobW9udGggPT0gMikgJiYgKGRheSA+IDI4KSkgdmFsaWQgPSBmYWxzZTsNCiAgICANCiAgICByZXR1cm4gdmFsaWQ7DQp9DQoNCi8vIOmHkemMouespuiZnw0KZnVuY3Rpb24gZm9ybWF0TnVtYmVyKG51bSkgew0KICAgIHJldHVybiAoIW51bSA/IDAgOiBudW0udG9TdHJpbmcoKS5yZXBsYWNlKC8oXGQpKD89KFxkezN9KSsoPyFcZCkpL2csICIkMSwiKSk7DQp9DQoNCi8vIOWinuWKoOWkqeaVuA0KLy8gdmFyIGRhdCA9IG5ldyBEYXRlKCk7DQovLyBhbGVydChkYXQuYWRkRGF5cyg1KSkNCkRhdGUucHJvdG90eXBlLmFkZERheXMgPSBmdW5jdGlvbiAoZGF5cykgew0KICAgIHRoaXMuc2V0RGF0ZSh0aGlzLmdldERhdGUoKSArIGRheXMpOw0KICAgIHJldHVybiB0aGlzOw0KfQ0KDQpEYXRlLnByb3RvdHlwZS5hZGRNb250aHMgPSBmdW5jdGlvbiAodmFsdWUpIHsNCiAgICB2YXIgbiA9IHRoaXMuZ2V0RGF0ZSgpOw0KICAgIHRoaXMuc2V0RGF0ZSgxKTsNCiAgICB0aGlzLnNldE1vbnRoKHRoaXMuZ2V0TW9udGgoKSArIHZhbHVlKTsNCiAgICB0aGlzLnNldERhdGUoTWF0aC5taW4obiwgdGhpcy5nZXREYXlzSW5Nb250aCgpKSk7DQogICAgcmV0dXJuIHRoaXM7DQp9Ow0KDQpmdW5jdGlvbiBwYWQobnVtYmVyKSB7DQogICAgdmFyIHIgPSBTdHJpbmcobnVtYmVyKTsNCiAgICBpZiAoci5sZW5ndGggPT09IDEpIHsNCiAgICAgICAgciA9ICcwJyArIHI7DQogICAgfQ0KICAgIHJldHVybiByOw0KfQ0KDQpEYXRlLnByb3RvdHlwZS50b0lTT1N0cmluZyA9IGZ1bmN0aW9uICgpIHsNCiAgICByZXR1cm4gdGhpcy5nZXRVVENGdWxsWWVhcigpDQogICAgICAgICsgJy0nICsgcGFkKHRoaXMuZ2V0VVRDTW9udGgoKSArIDEpDQogICAgICAgICsgJy0nICsgcGFkKHRoaXMuZ2V0VVRDRGF0ZSgpKQ0KICAgICAgICArICdUJyArIHBhZCh0aGlzLmdldFVUQ0hvdXJzKCkpDQogICAgICAgICsgJzonICsgcGFkKHRoaXMuZ2V0VVRDTWludXRlcygpKQ0KICAgICAgICArICc6JyArIHBhZCh0aGlzLmdldFVUQ1NlY29uZHMoKSkNCiAgICAgICAgKyAnLicgKyBTdHJpbmcoKHRoaXMuZ2V0VVRDTWlsbGlzZWNvbmRzKCkgLyAxMDAwKS50b0ZpeGVkKDMpKS5zbGljZSgyLCA1KQ0KICAgICAgICArICdaJzsNCn07DQoNCg0KLy8gbGVmdCBwYWRkaW5nIHMgd2l0aCBjIHRvIGEgdG90YWwgb2YgbiBjaGFycw0KLy8gbHBhZCgnZXVyZWthJywgMTAsICcqJykNCmZ1bmN0aW9uIGxwYWQoaW5wdXQsIHdpZHRoLCBwYWRkaW5nKSB7DQogICAgdmFyIHN0ciA9ICcnICsgaW5wdXQ7DQogICAgd2hpbGUgKHN0ci5sZW5ndGggPCB3aWR0aCkgew0KICAgICAgICBzdHIgPSBwYWRkaW5nICsgc3RyOw0KICAgIH0NCiAgICByZXR1cm4gc3RyOw0KfQ0KDQovLyByaWdodCBwYWRkaW5nIHMgd2l0aCBjIHRvIGEgdG90YWwgb2YgbiBjaGFycw0KLy8gcnBhZCgnZXVyZWthJywgJyonLCAxMCkNCmZ1bmN0aW9uIHJwYWQocywgd2lkdGgsIHBhZGRpbmcpIHsNCiAgICB2YXIgc3RyID0gJycgKyBpbnB1dDsNCiAgICB3aGlsZSAoc3RyLmxlbmd0aCA8IHdpZHRoKSB7DQogICAgICAgIHN0ciA9IHN0ciArIHBhZGRpbmc7DQogICAgIH0NCiAgICByZXR1cm4gc3RyOw0KfQ0KDQpmdW5jdGlvbiBkZGxEZXNjcmlwdGlvbihqc29uQXJyYXksIGNvbXBhcmVLZXkpIHsNCiAgICBpZiAoIWNvbXBhcmVLZXkpIHJldHVybiAiIjsNCiAgICB2YXIgcmVzdWx0ID0ganNvbkFycmF5LmZpbHRlcihmdW5jdGlvbiAoZW50cnkpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVudHJ5WyJDb2RlIl0gPT09IGNvbXBhcmVLZXk7DQogICAgICAgICAgICAgICAgfSkubWFwKGZ1bmN0aW9uIChlbnRyeSkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZW50cnlbIkRlc2NyaXB0aW9uIl07DQogICAgICAgICAgICAgICAgfSk7DQoNCiAgICByZXR1cm4gcmVzdWx0LnRvU3RyaW5nKCk7DQp9DQoNCg0KZnVuY3Rpb24gYnl0ZUxlbmd0aChzdHIpIHsNCiAgICAvLyByZXR1cm5zIHRoZSBieXRlIGxlbmd0aCBvZiBhbiB1dGY4IHN0cmluZw0KICAgIHZhciBzID0gc3RyLmxlbmd0aDsNCiAgICBmb3IgKHZhciBpID0gc3RyLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7DQogICAgICAgIHZhciBjb2RlID0gc3RyLmNoYXJDb2RlQXQoaSk7DQogICAgICAgIGlmIChjb2RlID4gMHg3ZiAmJiBjb2RlIDw9IDB4N2ZmKSBzKys7DQogICAgICAgIGVsc2UgaWYgKGNvZGUgPiAweDdmZiAmJiBjb2RlIDw9IDB4ZmZmZikgcyArPSAyOw0KICAgICAgICBpZiAoY29kZSA+PSAweERDMDAgJiYgY29kZSA8PSAweERGRkYpIGktLTsgLy90cmFpbCBzdXJyb2dhdGUNCiAgICB9DQogICAgcmV0dXJuIHM7DQp9DQoNCmZ1bmN0aW9uIGNhcGl0YWxpemVGaXJzdExldHRlcihzdHJpbmcpIHsNCiAgICByZXR1cm4gc3RyaW5nLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3RyaW5nLnNsaWNlKDEpOw0KfQ0KLy9kb3dubG9hZC5qcyB2NC4yMSwgYnkgZGFuZGF2aXM7IDIwMDgtMjAxOC4gW01JVF0gc2VlIGh0dHA6Ly9kYW5tbC5jb20vZG93bmxvYWQuaHRtbCBmb3IgdGVzdHMvdXNhZ2UKOyhmdW5jdGlvbihyb290LGZhY3Rvcnkpe3R5cGVvZiBkZWZpbmU9PSJmdW5jdGlvbiImJmRlZmluZS5hbWQ/ZGVmaW5lKFtdLGZhY3RvcnkpOnR5cGVvZiBleHBvcnRzPT0ib2JqZWN0Ij9tb2R1bGUuZXhwb3J0cz1mYWN0b3J5KCk6cm9vdC5kb3dubG9hZD1mYWN0b3J5KCl9KSh0aGlzLGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uIGRvd25sb2FkKGRhdGEsc3RyRmlsZU5hbWUsc3RyTWltZVR5cGUpe3ZhciBzZWxmPXdpbmRvdyxkZWZhdWx0TWltZT0iYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtIixtaW1lVHlwZT1zdHJNaW1lVHlwZXx8ZGVmYXVsdE1pbWUscGF5bG9hZD1kYXRhLHVybD0hc3RyRmlsZU5hbWUmJiFzdHJNaW1lVHlwZSYmcGF5bG9hZCxhbmNob3I9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpLHRvU3RyaW5nPWZ1bmN0aW9uKGEpe3JldHVybiBTdHJpbmcoYSl9LG15QmxvYj1zZWxmLkJsb2J8fHNlbGYuTW96QmxvYnx8c2VsZi5XZWJLaXRCbG9ifHx0b1N0cmluZyxmaWxlTmFtZT1zdHJGaWxlTmFtZXx8ImRvd25sb2FkIixibG9iLHJlYWRlcjtteUJsb2I9bXlCbG9iLmNhbGw/bXlCbG9iLmJpbmQoc2VsZik6QmxvYixTdHJpbmcodGhpcyk9PT0idHJ1ZSImJihwYXlsb2FkPVtwYXlsb2FkLG1pbWVUeXBlXSxtaW1lVHlwZT1wYXlsb2FkWzBdLHBheWxvYWQ9cGF5bG9hZFsxXSk7aWYodXJsJiZ1cmwubGVuZ3RoPDIwNDgpe2ZpbGVOYW1lPXVybC5zcGxpdCgiLyIpLnBvcCgpLnNwbGl0KCI/IilbMF0sYW5jaG9yLmhyZWY9dXJsO2lmKGFuY2hvci5ocmVmLmluZGV4T2YodXJsKSE9PS0xKXt2YXIgYWpheD1uZXcgWE1MSHR0cFJlcXVlc3Q7cmV0dXJuIGFqYXgub3BlbigiR0VUIix1cmwsITApLGFqYXgucmVzcG9uc2VUeXBlPSJibG9iIixhamF4Lm9ubG9hZD1mdW5jdGlvbihlKXtkb3dubG9hZChlLnRhcmdldC5yZXNwb25zZSxmaWxlTmFtZSxkZWZhdWx0TWltZSl9LHNldFRpbWVvdXQoZnVuY3Rpb24oKXthamF4LnNlbmQoKX0sMCksYWpheH19aWYoL15kYXRhOihbXHcrLV0rXC9bXHcrLi1dKyk/Wyw7XS8udGVzdChwYXlsb2FkKSl7aWYoIShwYXlsb2FkLmxlbmd0aD4yMDk2MTAzLjQyNCYmbXlCbG9iIT09dG9TdHJpbmcpKXJldHVybiBuYXZpZ2F0b3IubXNTYXZlQmxvYj9uYXZpZ2F0b3IubXNTYXZlQmxvYihkYXRhVXJsVG9CbG9iKHBheWxvYWQpLGZpbGVOYW1lKTpzYXZlcihwYXlsb2FkKTtwYXlsb2FkPWRhdGFVcmxUb0Jsb2IocGF5bG9hZCksbWltZVR5cGU9cGF5bG9hZC50eXBlfHxkZWZhdWx0TWltZX1lbHNlIGlmKC8oW1x4ODAtXHhmZl0pLy50ZXN0KHBheWxvYWQpKXt2YXIgaT0wLHRlbXBVaUFycj1uZXcgVWludDhBcnJheShwYXlsb2FkLmxlbmd0aCksbXg9dGVtcFVpQXJyLmxlbmd0aDtmb3IoaTtpPG14OysraSl0ZW1wVWlBcnJbaV09cGF5bG9hZC5jaGFyQ29kZUF0KGkpO3BheWxvYWQ9bmV3IG15QmxvYihbdGVtcFVpQXJyXSx7dHlwZTptaW1lVHlwZX0pfWJsb2I9cGF5bG9hZCBpbnN0YW5jZW9mIG15QmxvYj9wYXlsb2FkOm5ldyBteUJsb2IoW3BheWxvYWRdLHt0eXBlOm1pbWVUeXBlfSk7ZnVuY3Rpb24gZGF0YVVybFRvQmxvYihzdHJVcmwpe3ZhciBwYXJ0cz1zdHJVcmwuc3BsaXQoL1s6OyxdLyksdHlwZT1wYXJ0c1sxXSxpbmRleERlY29kZXI9c3RyVXJsLmluZGV4T2YoImNoYXJzZXQiKT4wPzM6MixkZWNvZGVyPXBhcnRzW2luZGV4RGVjb2Rlcl09PSJiYXNlNjQiP2F0b2I6ZGVjb2RlVVJJQ29tcG9uZW50LGJpbkRhdGE9ZGVjb2RlcihwYXJ0cy5wb3AoKSksbXg9YmluRGF0YS5sZW5ndGgsaT0wLHVpQXJyPW5ldyBVaW50OEFycmF5KG14KTtmb3IoaTtpPG14OysraSl1aUFycltpXT1iaW5EYXRhLmNoYXJDb2RlQXQoaSk7cmV0dXJuIG5ldyBteUJsb2IoW3VpQXJyXSx7dHlwZTp0eXBlfSl9ZnVuY3Rpb24gc2F2ZXIodXJsLHdpbk1vZGUpe2lmKCJkb3dubG9hZCJpbiBhbmNob3IpcmV0dXJuIGFuY2hvci5ocmVmPXVybCxhbmNob3Iuc2V0QXR0cmlidXRlKCJkb3dubG9hZCIsZmlsZU5hbWUpLGFuY2hvci5jbGFzc05hbWU9ImRvd25sb2FkLWpzLWxpbmsiLGFuY2hvci5pbm5lckhUTUw9ImRvd25sb2FkaW5nLi4uIixhbmNob3Iuc3R5bGUuZGlzcGxheT0ibm9uZSIsYW5jaG9yLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIixmdW5jdGlvbihlKXtlLnN0b3BQcm9wYWdhdGlvbigpLHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigiY2xpY2siLGFyZ3VtZW50cy5jYWxsZWUpfSksZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhbmNob3IpLHNldFRpbWVvdXQoZnVuY3Rpb24oKXthbmNob3IuY2xpY2soKSxkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGFuY2hvciksd2luTW9kZT09PSEwJiZzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7c2VsZi5VUkwucmV2b2tlT2JqZWN0VVJMKGFuY2hvci5ocmVmKX0sMjUwKX0sNjYpLCEwO2lmKC8oVmVyc2lvbilcLyhcZCspXC4oXGQrKSg/OlwuKFxkKykpPy4qU2FmYXJpXC8vLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpcmV0dXJuL15kYXRhOi8udGVzdCh1cmwpJiYodXJsPSJkYXRhOiIrdXJsLnJlcGxhY2UoL15kYXRhOihbXHdcL1wtXCtdKykvLGRlZmF1bHRNaW1lKSksd2luZG93Lm9wZW4odXJsKXx8Y29uZmlybSgiRGlzcGxheWluZyBOZXcgRG9jdW1lbnRcblxuVXNlIFNhdmUgQXMuLi4gdG8gZG93bmxvYWQsIHRoZW4gY2xpY2sgYmFjayB0byByZXR1cm4gdG8gdGhpcyBwYWdlLiIpJiYobG9jYXRpb24uaHJlZj11cmwpLCEwO3ZhciBmPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlmcmFtZSIpO2RvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZiksIXdpbk1vZGUmJi9eZGF0YTovLnRlc3QodXJsKSYmKHVybD0iZGF0YToiK3VybC5yZXBsYWNlKC9eZGF0YTooW1x3XC9cLVwrXSspLyxkZWZhdWx0TWltZSkpLGYuc3JjPXVybCxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChmKX0sMzMzKX1pZihuYXZpZ2F0b3IubXNTYXZlQmxvYilyZXR1cm4gbmF2aWdhdG9yLm1zU2F2ZUJsb2IoYmxvYixmaWxlTmFtZSk7aWYoc2VsZi5VUkwpc2F2ZXIoc2VsZi5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpLCEwKTtlbHNle2lmKHR5cGVvZiBibG9iPT0ic3RyaW5nInx8YmxvYi5jb25zdHJ1Y3Rvcj09PXRvU3RyaW5nKXRyeXtyZXR1cm4gc2F2ZXIoImRhdGE6IittaW1lVHlwZSsiO2Jhc2U2NCwiK3NlbGYuYnRvYShibG9iKSl9Y2F0Y2goeSl7cmV0dXJuIHNhdmVyKCJkYXRhOiIrbWltZVR5cGUrIiwiK2VuY29kZVVSSUNvbXBvbmVudChibG9iKSl9cmVhZGVyPW5ldyBGaWxlUmVhZGVyLHJlYWRlci5vbmxvYWQ9ZnVuY3Rpb24oZSl7c2F2ZXIodGhpcy5yZXN1bHQpfSxyZWFkZXIucmVhZEFzRGF0YVVSTChibG9iKX1yZXR1cm4hMH19KTsKDQohZnVuY3Rpb24oZSx0KXsib2JqZWN0Ij09dHlwZW9mIGV4cG9ydHMmJiJ1bmRlZmluZWQiIT10eXBlb2YgbW9kdWxlP21vZHVsZS5leHBvcnRzPXQoKToiZnVuY3Rpb24iPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZSh0KTplLm1vbWVudD10KCl9KHRoaXMsZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7dmFyIGUsaTtmdW5jdGlvbiBjKCl7cmV0dXJuIGUuYXBwbHkobnVsbCxhcmd1bWVudHMpfWZ1bmN0aW9uIG8oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBBcnJheXx8IltvYmplY3QgQXJyYXldIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlKX1mdW5jdGlvbiB1KGUpe3JldHVybiBudWxsIT1lJiYiW29iamVjdCBPYmplY3RdIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlKX1mdW5jdGlvbiBsKGUpe3JldHVybiB2b2lkIDA9PT1lfWZ1bmN0aW9uIGQoZSl7cmV0dXJuIm51bWJlciI9PXR5cGVvZiBlfHwiW29iamVjdCBOdW1iZXJdIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlKX1mdW5jdGlvbiBoKGUpe3JldHVybiBlIGluc3RhbmNlb2YgRGF0ZXx8IltvYmplY3QgRGF0ZV0iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUpfWZ1bmN0aW9uIGYoZSx0KXt2YXIgbixzPVtdO2ZvcihuPTA7bjxlLmxlbmd0aDsrK24pcy5wdXNoKHQoZVtuXSxuKSk7cmV0dXJuIHN9ZnVuY3Rpb24gbShlLHQpe3JldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSx0KX1mdW5jdGlvbiBfKGUsdCl7Zm9yKHZhciBuIGluIHQpbSh0LG4pJiYoZVtuXT10W25dKTtyZXR1cm4gbSh0LCJ0b1N0cmluZyIpJiYoZS50b1N0cmluZz10LnRvU3RyaW5nKSxtKHQsInZhbHVlT2YiKSYmKGUudmFsdWVPZj10LnZhbHVlT2YpLGV9ZnVuY3Rpb24geShlLHQsbixzKXtyZXR1cm4gT3QoZSx0LG4scywhMCkudXRjKCl9ZnVuY3Rpb24gZyhlKXtyZXR1cm4gbnVsbD09ZS5fcGYmJihlLl9wZj17ZW1wdHk6ITEsdW51c2VkVG9rZW5zOltdLHVudXNlZElucHV0OltdLG92ZXJmbG93Oi0yLGNoYXJzTGVmdE92ZXI6MCxudWxsSW5wdXQ6ITEsaW52YWxpZE1vbnRoOm51bGwsaW52YWxpZEZvcm1hdDohMSx1c2VySW52YWxpZGF0ZWQ6ITEsaXNvOiExLHBhcnNlZERhdGVQYXJ0czpbXSxtZXJpZGllbTpudWxsLHJmYzI4MjI6ITEsd2Vla2RheU1pc21hdGNoOiExfSksZS5fcGZ9ZnVuY3Rpb24gcChlKXtpZihudWxsPT1lLl9pc1ZhbGlkKXt2YXIgdD1nKGUpLG49aS5jYWxsKHQucGFyc2VkRGF0ZVBhcnRzLGZ1bmN0aW9uKGUpe3JldHVybiBudWxsIT1lfSkscz0haXNOYU4oZS5fZC5nZXRUaW1lKCkpJiZ0Lm92ZXJmbG93PDAmJiF0LmVtcHR5JiYhdC5pbnZhbGlkTW9udGgmJiF0LmludmFsaWRXZWVrZGF5JiYhdC53ZWVrZGF5TWlzbWF0Y2gmJiF0Lm51bGxJbnB1dCYmIXQuaW52YWxpZEZvcm1hdCYmIXQudXNlckludmFsaWRhdGVkJiYoIXQubWVyaWRpZW18fHQubWVyaWRpZW0mJm4pO2lmKGUuX3N0cmljdCYmKHM9cyYmMD09PXQuY2hhcnNMZWZ0T3ZlciYmMD09PXQudW51c2VkVG9rZW5zLmxlbmd0aCYmdm9pZCAwPT09dC5iaWdIb3VyKSxudWxsIT1PYmplY3QuaXNGcm96ZW4mJk9iamVjdC5pc0Zyb3plbihlKSlyZXR1cm4gcztlLl9pc1ZhbGlkPXN9cmV0dXJuIGUuX2lzVmFsaWR9ZnVuY3Rpb24gdihlKXt2YXIgdD15KE5hTik7cmV0dXJuIG51bGwhPWU/XyhnKHQpLGUpOmcodCkudXNlckludmFsaWRhdGVkPSEwLHR9aT1BcnJheS5wcm90b3R5cGUuc29tZT9BcnJheS5wcm90b3R5cGUuc29tZTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9T2JqZWN0KHRoaXMpLG49dC5sZW5ndGg+Pj4wLHM9MDtzPG47cysrKWlmKHMgaW4gdCYmZS5jYWxsKHRoaXMsdFtzXSxzLHQpKXJldHVybiEwO3JldHVybiExfTt2YXIgcj1jLm1vbWVudFByb3BlcnRpZXM9W107ZnVuY3Rpb24gdyhlLHQpe3ZhciBuLHMsaTtpZihsKHQuX2lzQU1vbWVudE9iamVjdCl8fChlLl9pc0FNb21lbnRPYmplY3Q9dC5faXNBTW9tZW50T2JqZWN0KSxsKHQuX2kpfHwoZS5faT10Ll9pKSxsKHQuX2YpfHwoZS5fZj10Ll9mKSxsKHQuX2wpfHwoZS5fbD10Ll9sKSxsKHQuX3N0cmljdCl8fChlLl9zdHJpY3Q9dC5fc3RyaWN0KSxsKHQuX3R6bSl8fChlLl90em09dC5fdHptKSxsKHQuX2lzVVRDKXx8KGUuX2lzVVRDPXQuX2lzVVRDKSxsKHQuX29mZnNldCl8fChlLl9vZmZzZXQ9dC5fb2Zmc2V0KSxsKHQuX3BmKXx8KGUuX3BmPWcodCkpLGwodC5fbG9jYWxlKXx8KGUuX2xvY2FsZT10Ll9sb2NhbGUpLDA8ci5sZW5ndGgpZm9yKG49MDtuPHIubGVuZ3RoO24rKylsKGk9dFtzPXJbbl1dKXx8KGVbc109aSk7cmV0dXJuIGV9dmFyIHQ9ITE7ZnVuY3Rpb24gTShlKXt3KHRoaXMsZSksdGhpcy5fZD1uZXcgRGF0ZShudWxsIT1lLl9kP2UuX2QuZ2V0VGltZSgpOk5hTiksdGhpcy5pc1ZhbGlkKCl8fCh0aGlzLl9kPW5ldyBEYXRlKE5hTikpLCExPT09dCYmKHQ9ITAsYy51cGRhdGVPZmZzZXQodGhpcyksdD0hMSl9ZnVuY3Rpb24gUyhlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIE18fG51bGwhPWUmJm51bGwhPWUuX2lzQU1vbWVudE9iamVjdH1mdW5jdGlvbiBEKGUpe3JldHVybiBlPDA/TWF0aC5jZWlsKGUpfHwwOk1hdGguZmxvb3IoZSl9ZnVuY3Rpb24gayhlKXt2YXIgdD0rZSxuPTA7cmV0dXJuIDAhPT10JiZpc0Zpbml0ZSh0KSYmKG49RCh0KSksbn1mdW5jdGlvbiBhKGUsdCxuKXt2YXIgcyxpPU1hdGgubWluKGUubGVuZ3RoLHQubGVuZ3RoKSxyPU1hdGguYWJzKGUubGVuZ3RoLXQubGVuZ3RoKSxhPTA7Zm9yKHM9MDtzPGk7cysrKShuJiZlW3NdIT09dFtzXXx8IW4mJmsoZVtzXSkhPT1rKHRbc10pKSYmYSsrO3JldHVybiBhK3J9ZnVuY3Rpb24gWShlKXshMT09PWMuc3VwcHJlc3NEZXByZWNhdGlvbldhcm5pbmdzJiYidW5kZWZpbmVkIiE9dHlwZW9mIGNvbnNvbGUmJmNvbnNvbGUud2FybiYmY29uc29sZS53YXJuKCJEZXByZWNhdGlvbiB3YXJuaW5nOiAiK2UpfWZ1bmN0aW9uIG4oaSxyKXt2YXIgYT0hMDtyZXR1cm4gXyhmdW5jdGlvbigpe2lmKG51bGwhPWMuZGVwcmVjYXRpb25IYW5kbGVyJiZjLmRlcHJlY2F0aW9uSGFuZGxlcihudWxsLGkpLGEpe2Zvcih2YXIgZSx0PVtdLG49MDtuPGFyZ3VtZW50cy5sZW5ndGg7bisrKXtpZihlPSIiLCJvYmplY3QiPT10eXBlb2YgYXJndW1lbnRzW25dKXtmb3IodmFyIHMgaW4gZSs9IlxuWyIrbisiXSAiLGFyZ3VtZW50c1swXSllKz1zKyI6ICIrYXJndW1lbnRzWzBdW3NdKyIsICI7ZT1lLnNsaWNlKDAsLTIpfWVsc2UgZT1hcmd1bWVudHNbbl07dC5wdXNoKGUpfVkoaSsiXG5Bcmd1bWVudHM6ICIrQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodCkuam9pbigiIikrIlxuIisobmV3IEVycm9yKS5zdGFjayksYT0hMX1yZXR1cm4gci5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LHIpfXZhciBzLE89e307ZnVuY3Rpb24gVChlLHQpe251bGwhPWMuZGVwcmVjYXRpb25IYW5kbGVyJiZjLmRlcHJlY2F0aW9uSGFuZGxlcihlLHQpLE9bZV18fChZKHQpLE9bZV09ITApfWZ1bmN0aW9uIHgoZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBGdW5jdGlvbnx8IltvYmplY3QgRnVuY3Rpb25dIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlKX1mdW5jdGlvbiBiKGUsdCl7dmFyIG4scz1fKHt9LGUpO2ZvcihuIGluIHQpbSh0LG4pJiYodShlW25dKSYmdSh0W25dKT8oc1tuXT17fSxfKHNbbl0sZVtuXSksXyhzW25dLHRbbl0pKTpudWxsIT10W25dP3Nbbl09dFtuXTpkZWxldGUgc1tuXSk7Zm9yKG4gaW4gZSltKGUsbikmJiFtKHQsbikmJnUoZVtuXSkmJihzW25dPV8oe30sc1tuXSkpO3JldHVybiBzfWZ1bmN0aW9uIFAoZSl7bnVsbCE9ZSYmdGhpcy5zZXQoZSl9Yy5zdXBwcmVzc0RlcHJlY2F0aW9uV2FybmluZ3M9ITEsYy5kZXByZWNhdGlvbkhhbmRsZXI9bnVsbCxzPU9iamVjdC5rZXlzP09iamVjdC5rZXlzOmZ1bmN0aW9uKGUpe3ZhciB0LG49W107Zm9yKHQgaW4gZSltKGUsdCkmJm4ucHVzaCh0KTtyZXR1cm4gbn07dmFyIFc9e307ZnVuY3Rpb24gSChlLHQpe3ZhciBuPWUudG9Mb3dlckNhc2UoKTtXW25dPVdbbisicyJdPVdbdF09ZX1mdW5jdGlvbiBSKGUpe3JldHVybiJzdHJpbmciPT10eXBlb2YgZT9XW2VdfHxXW2UudG9Mb3dlckNhc2UoKV06dm9pZCAwfWZ1bmN0aW9uIEMoZSl7dmFyIHQsbixzPXt9O2ZvcihuIGluIGUpbShlLG4pJiYodD1SKG4pKSYmKHNbdF09ZVtuXSk7cmV0dXJuIHN9dmFyIEY9e307ZnVuY3Rpb24gTChlLHQpe0ZbZV09dH1mdW5jdGlvbiBVKGUsdCxuKXt2YXIgcz0iIitNYXRoLmFicyhlKSxpPXQtcy5sZW5ndGg7cmV0dXJuKDA8PWU/bj8iKyI6IiI6Ii0iKStNYXRoLnBvdygxMCxNYXRoLm1heCgwLGkpKS50b1N0cmluZygpLnN1YnN0cigxKStzfXZhciBOPS8oXFtbXlxbXSpcXSl8KFxcKT8oW0hoXW1tKHNzKT98TW98TU0/TT9NP3xEb3xERERvfEREP0Q/RD98ZGRkP2Q/fGRvP3x3W298d10/fFdbb3xXXT98UW8/fFlZWVlZWXxZWVlZWXxZWVlZfFlZfGdnKGdnZz8pP3xHRyhHR0c/KT98ZXxFfGF8QXxoaD98SEg/fGtrP3xtbT98c3M/fFN7MSw5fXx4fFh8eno/fFpaP3wuKS9nLEc9LyhcW1teXFtdKlxdKXwoXFwpPyhMVFN8TFR8TEw/TD9MP3xsezEsNH0pL2csVj17fSxFPXt9O2Z1bmN0aW9uIEkoZSx0LG4scyl7dmFyIGk9czsic3RyaW5nIj09dHlwZW9mIHMmJihpPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXNbc10oKX0pLGUmJihFW2VdPWkpLHQmJihFW3RbMF1dPWZ1bmN0aW9uKCl7cmV0dXJuIFUoaS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdFsxXSx0WzJdKX0pLG4mJihFW25dPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLm9yZGluYWwoaS5hcHBseSh0aGlzLGFyZ3VtZW50cyksZSl9KX1mdW5jdGlvbiBBKGUsdCl7cmV0dXJuIGUuaXNWYWxpZCgpPyh0PWoodCxlLmxvY2FsZURhdGEoKSksVlt0XT1WW3RdfHxmdW5jdGlvbihzKXt2YXIgZSxpLHQscj1zLm1hdGNoKE4pO2ZvcihlPTAsaT1yLmxlbmd0aDtlPGk7ZSsrKUVbcltlXV0/cltlXT1FW3JbZV1dOnJbZV09KHQ9cltlXSkubWF0Y2goL1xbW1xzXFNdLyk/dC5yZXBsYWNlKC9eXFt8XF0kL2csIiIpOnQucmVwbGFjZSgvXFwvZywiIik7cmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciB0LG49IiI7Zm9yKHQ9MDt0PGk7dCsrKW4rPXgoclt0XSk/clt0XS5jYWxsKGUscyk6clt0XTtyZXR1cm4gbn19KHQpLFZbdF0oZSkpOmUubG9jYWxlRGF0YSgpLmludmFsaWREYXRlKCl9ZnVuY3Rpb24gaihlLHQpe3ZhciBuPTU7ZnVuY3Rpb24gcyhlKXtyZXR1cm4gdC5sb25nRGF0ZUZvcm1hdChlKXx8ZX1mb3IoRy5sYXN0SW5kZXg9MDswPD1uJiZHLnRlc3QoZSk7KWU9ZS5yZXBsYWNlKEcscyksRy5sYXN0SW5kZXg9MCxuLT0xO3JldHVybiBlfXZhciBaPS9cZC8sej0vXGRcZC8sJD0vXGR7M30vLHE9L1xkezR9LyxKPS9bKy1dP1xkezZ9LyxCPS9cZFxkPy8sUT0vXGRcZFxkXGQ/LyxYPS9cZFxkXGRcZFxkXGQ/LyxLPS9cZHsxLDN9LyxlZT0vXGR7MSw0fS8sdGU9L1srLV0/XGR7MSw2fS8sbmU9L1xkKy8sc2U9L1srLV0/XGQrLyxpZT0vWnxbKy1dXGRcZDo/XGRcZC9naSxyZT0vWnxbKy1dXGRcZCg/Ojo/XGRcZCk/L2dpLGFlPS9bMC05XXswLDI1Nn1bJ2Etelx1MDBBMC1cdTA1RkZcdTA3MDAtXHVEN0ZGXHVGOTAwLVx1RkRDRlx1RkRGMC1cdUZGMDdcdUZGMTAtXHVGRkVGXXsxLDI1Nn18W1x1MDYwMC1cdTA2RkZcL117MSwyNTZ9KFxzKj9bXHUwNjAwLVx1MDZGRl17MSwyNTZ9KXsxLDJ9L2ksb2U9e307ZnVuY3Rpb24gdWUoZSxuLHMpe29lW2VdPXgobik/bjpmdW5jdGlvbihlLHQpe3JldHVybiBlJiZzP3M6bn19ZnVuY3Rpb24gbGUoZSx0KXtyZXR1cm4gbShvZSxlKT9vZVtlXSh0Ll9zdHJpY3QsdC5fbG9jYWxlKTpuZXcgUmVnRXhwKGRlKGUucmVwbGFjZSgiXFwiLCIiKS5yZXBsYWNlKC9cXChcWyl8XFwoXF0pfFxbKFteXF1cW10qKVxdfFxcKC4pL2csZnVuY3Rpb24oZSx0LG4scyxpKXtyZXR1cm4gdHx8bnx8c3x8aX0pKSl9ZnVuY3Rpb24gZGUoZSl7cmV0dXJuIGUucmVwbGFjZSgvWy1cL1xcXiQqKz8uKCl8W1xde31dL2csIlxcJCYiKX12YXIgaGU9e307ZnVuY3Rpb24gY2UoZSxuKXt2YXIgdCxzPW47Zm9yKCJzdHJpbmciPT10eXBlb2YgZSYmKGU9W2VdKSxkKG4pJiYocz1mdW5jdGlvbihlLHQpe3Rbbl09ayhlKX0pLHQ9MDt0PGUubGVuZ3RoO3QrKyloZVtlW3RdXT1zfWZ1bmN0aW9uIGZlKGUsaSl7Y2UoZSxmdW5jdGlvbihlLHQsbixzKXtuLl93PW4uX3d8fHt9LGkoZSxuLl93LG4scyl9KX12YXIgbWU9MCxfZT0xLHllPTIsZ2U9MyxwZT00LHZlPTUsd2U9NixNZT03LFNlPTg7ZnVuY3Rpb24gRGUoZSl7cmV0dXJuIGtlKGUpPzM2NjozNjV9ZnVuY3Rpb24ga2UoZSl7cmV0dXJuIGUlND09MCYmZSUxMDAhPTB8fGUlNDAwPT0wfUkoIlkiLDAsMCxmdW5jdGlvbigpe3ZhciBlPXRoaXMueWVhcigpO3JldHVybiBlPD05OTk5PyIiK2U6IisiK2V9KSxJKDAsWyJZWSIsMl0sMCxmdW5jdGlvbigpe3JldHVybiB0aGlzLnllYXIoKSUxMDB9KSxJKDAsWyJZWVlZIiw0XSwwLCJ5ZWFyIiksSSgwLFsiWVlZWVkiLDVdLDAsInllYXIiKSxJKDAsWyJZWVlZWVkiLDYsITBdLDAsInllYXIiKSxIKCJ5ZWFyIiwieSIpLEwoInllYXIiLDEpLHVlKCJZIixzZSksdWUoIllZIixCLHopLHVlKCJZWVlZIixlZSxxKSx1ZSgiWVlZWVkiLHRlLEopLHVlKCJZWVlZWVkiLHRlLEopLGNlKFsiWVlZWVkiLCJZWVlZWVkiXSxtZSksY2UoIllZWVkiLGZ1bmN0aW9uKGUsdCl7dFttZV09Mj09PWUubGVuZ3RoP2MucGFyc2VUd29EaWdpdFllYXIoZSk6ayhlKX0pLGNlKCJZWSIsZnVuY3Rpb24oZSx0KXt0W21lXT1jLnBhcnNlVHdvRGlnaXRZZWFyKGUpfSksY2UoIlkiLGZ1bmN0aW9uKGUsdCl7dFttZV09cGFyc2VJbnQoZSwxMCl9KSxjLnBhcnNlVHdvRGlnaXRZZWFyPWZ1bmN0aW9uKGUpe3JldHVybiBrKGUpKyg2ODxrKGUpPzE5MDA6MmUzKX07dmFyIFllLE9lPVRlKCJGdWxsWWVhciIsITApO2Z1bmN0aW9uIFRlKHQsbil7cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiBudWxsIT1lPyhiZSh0aGlzLHQsZSksYy51cGRhdGVPZmZzZXQodGhpcyxuKSx0aGlzKTp4ZSh0aGlzLHQpfX1mdW5jdGlvbiB4ZShlLHQpe3JldHVybiBlLmlzVmFsaWQoKT9lLl9kWyJnZXQiKyhlLl9pc1VUQz8iVVRDIjoiIikrdF0oKTpOYU59ZnVuY3Rpb24gYmUoZSx0LG4pe2UuaXNWYWxpZCgpJiYhaXNOYU4obikmJigiRnVsbFllYXIiPT09dCYma2UoZS55ZWFyKCkpJiYxPT09ZS5tb250aCgpJiYyOT09PWUuZGF0ZSgpP2UuX2RbInNldCIrKGUuX2lzVVRDPyJVVEMiOiIiKSt0XShuLGUubW9udGgoKSxQZShuLGUubW9udGgoKSkpOmUuX2RbInNldCIrKGUuX2lzVVRDPyJVVEMiOiIiKSt0XShuKSl9ZnVuY3Rpb24gUGUoZSx0KXtpZihpc05hTihlKXx8aXNOYU4odCkpcmV0dXJuIE5hTjt2YXIgbixzPSh0JShuPTEyKStuKSVuO3JldHVybiBlKz0odC1zKS8xMiwxPT09cz9rZShlKT8yOToyODozMS1zJTclMn1ZZT1BcnJheS5wcm90b3R5cGUuaW5kZXhPZj9BcnJheS5wcm90b3R5cGUuaW5kZXhPZjpmdW5jdGlvbihlKXt2YXIgdDtmb3IodD0wO3Q8dGhpcy5sZW5ndGg7Kyt0KWlmKHRoaXNbdF09PT1lKXJldHVybiB0O3JldHVybi0xfSxJKCJNIixbIk1NIiwyXSwiTW8iLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9udGgoKSsxfSksSSgiTU1NIiwwLDAsZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLm1vbnRoc1Nob3J0KHRoaXMsZSl9KSxJKCJNTU1NIiwwLDAsZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLm1vbnRocyh0aGlzLGUpfSksSCgibW9udGgiLCJNIiksTCgibW9udGgiLDgpLHVlKCJNIixCKSx1ZSgiTU0iLEIseiksdWUoIk1NTSIsZnVuY3Rpb24oZSx0KXtyZXR1cm4gdC5tb250aHNTaG9ydFJlZ2V4KGUpfSksdWUoIk1NTU0iLGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQubW9udGhzUmVnZXgoZSl9KSxjZShbIk0iLCJNTSJdLGZ1bmN0aW9uKGUsdCl7dFtfZV09ayhlKS0xfSksY2UoWyJNTU0iLCJNTU1NIl0sZnVuY3Rpb24oZSx0LG4scyl7dmFyIGk9bi5fbG9jYWxlLm1vbnRoc1BhcnNlKGUscyxuLl9zdHJpY3QpO251bGwhPWk/dFtfZV09aTpnKG4pLmludmFsaWRNb250aD1lfSk7dmFyIFdlPS9EW29EXT8oXFtbXlxbXF1dKlxdfFxzKStNTU1NPy8sSGU9IkphbnVhcnlfRmVicnVhcnlfTWFyY2hfQXByaWxfTWF5X0p1bmVfSnVseV9BdWd1c3RfU2VwdGVtYmVyX09jdG9iZXJfTm92ZW1iZXJfRGVjZW1iZXIiLnNwbGl0KCJfIik7dmFyIFJlPSJKYW5fRmViX01hcl9BcHJfTWF5X0p1bl9KdWxfQXVnX1NlcF9PY3RfTm92X0RlYyIuc3BsaXQoIl8iKTtmdW5jdGlvbiBDZShlLHQpe3ZhciBuO2lmKCFlLmlzVmFsaWQoKSlyZXR1cm4gZTtpZigic3RyaW5nIj09dHlwZW9mIHQpaWYoL15cZCskLy50ZXN0KHQpKXQ9ayh0KTtlbHNlIGlmKCFkKHQ9ZS5sb2NhbGVEYXRhKCkubW9udGhzUGFyc2UodCkpKXJldHVybiBlO3JldHVybiBuPU1hdGgubWluKGUuZGF0ZSgpLFBlKGUueWVhcigpLHQpKSxlLl9kWyJzZXQiKyhlLl9pc1VUQz8iVVRDIjoiIikrIk1vbnRoIl0odCxuKSxlfWZ1bmN0aW9uIEZlKGUpe3JldHVybiBudWxsIT1lPyhDZSh0aGlzLGUpLGMudXBkYXRlT2Zmc2V0KHRoaXMsITApLHRoaXMpOnhlKHRoaXMsIk1vbnRoIil9dmFyIExlPWFlO3ZhciBVZT1hZTtmdW5jdGlvbiBOZSgpe2Z1bmN0aW9uIGUoZSx0KXtyZXR1cm4gdC5sZW5ndGgtZS5sZW5ndGh9dmFyIHQsbixzPVtdLGk9W10scj1bXTtmb3IodD0wO3Q8MTI7dCsrKW49eShbMmUzLHRdKSxzLnB1c2godGhpcy5tb250aHNTaG9ydChuLCIiKSksaS5wdXNoKHRoaXMubW9udGhzKG4sIiIpKSxyLnB1c2godGhpcy5tb250aHMobiwiIikpLHIucHVzaCh0aGlzLm1vbnRoc1Nob3J0KG4sIiIpKTtmb3Iocy5zb3J0KGUpLGkuc29ydChlKSxyLnNvcnQoZSksdD0wO3Q8MTI7dCsrKXNbdF09ZGUoc1t0XSksaVt0XT1kZShpW3RdKTtmb3IodD0wO3Q8MjQ7dCsrKXJbdF09ZGUoclt0XSk7dGhpcy5fbW9udGhzUmVnZXg9bmV3IFJlZ0V4cCgiXigiK3Iuam9pbigifCIpKyIpIiwiaSIpLHRoaXMuX21vbnRoc1Nob3J0UmVnZXg9dGhpcy5fbW9udGhzUmVnZXgsdGhpcy5fbW9udGhzU3RyaWN0UmVnZXg9bmV3IFJlZ0V4cCgiXigiK2kuam9pbigifCIpKyIpIiwiaSIpLHRoaXMuX21vbnRoc1Nob3J0U3RyaWN0UmVnZXg9bmV3IFJlZ0V4cCgiXigiK3Muam9pbigifCIpKyIpIiwiaSIpfWZ1bmN0aW9uIEdlKGUpe3ZhciB0PW5ldyBEYXRlKERhdGUuVVRDLmFwcGx5KG51bGwsYXJndW1lbnRzKSk7cmV0dXJuIGU8MTAwJiYwPD1lJiZpc0Zpbml0ZSh0LmdldFVUQ0Z1bGxZZWFyKCkpJiZ0LnNldFVUQ0Z1bGxZZWFyKGUpLHR9ZnVuY3Rpb24gVmUoZSx0LG4pe3ZhciBzPTcrdC1uO3JldHVybi0oKDcrR2UoZSwwLHMpLmdldFVUQ0RheSgpLXQpJTcpK3MtMX1mdW5jdGlvbiBFZShlLHQsbixzLGkpe3ZhciByLGEsbz0xKzcqKHQtMSkrKDcrbi1zKSU3K1ZlKGUscyxpKTtyZXR1cm4gbzw9MD9hPURlKHI9ZS0xKStvOm8+RGUoZSk/KHI9ZSsxLGE9by1EZShlKSk6KHI9ZSxhPW8pLHt5ZWFyOnIsZGF5T2ZZZWFyOmF9fWZ1bmN0aW9uIEllKGUsdCxuKXt2YXIgcyxpLHI9VmUoZS55ZWFyKCksdCxuKSxhPU1hdGguZmxvb3IoKGUuZGF5T2ZZZWFyKCktci0xKS83KSsxO3JldHVybiBhPDE/cz1hK0FlKGk9ZS55ZWFyKCktMSx0LG4pOmE+QWUoZS55ZWFyKCksdCxuKT8ocz1hLUFlKGUueWVhcigpLHQsbiksaT1lLnllYXIoKSsxKTooaT1lLnllYXIoKSxzPWEpLHt3ZWVrOnMseWVhcjppfX1mdW5jdGlvbiBBZShlLHQsbil7dmFyIHM9VmUoZSx0LG4pLGk9VmUoZSsxLHQsbik7cmV0dXJuKERlKGUpLXMraSkvN31JKCJ3IixbInd3IiwyXSwid28iLCJ3ZWVrIiksSSgiVyIsWyJXVyIsMl0sIldvIiwiaXNvV2VlayIpLEgoIndlZWsiLCJ3IiksSCgiaXNvV2VlayIsIlciKSxMKCJ3ZWVrIiw1KSxMKCJpc29XZWVrIiw1KSx1ZSgidyIsQiksdWUoInd3IixCLHopLHVlKCJXIixCKSx1ZSgiV1ciLEIseiksZmUoWyJ3Iiwid3ciLCJXIiwiV1ciXSxmdW5jdGlvbihlLHQsbixzKXt0W3Muc3Vic3RyKDAsMSldPWsoZSl9KTtJKCJkIiwwLCJkbyIsImRheSIpLEkoImRkIiwwLDAsZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLndlZWtkYXlzTWluKHRoaXMsZSl9KSxJKCJkZGQiLDAsMCxmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkud2Vla2RheXNTaG9ydCh0aGlzLGUpfSksSSgiZGRkZCIsMCwwLGZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmxvY2FsZURhdGEoKS53ZWVrZGF5cyh0aGlzLGUpfSksSSgiZSIsMCwwLCJ3ZWVrZGF5IiksSSgiRSIsMCwwLCJpc29XZWVrZGF5IiksSCgiZGF5IiwiZCIpLEgoIndlZWtkYXkiLCJlIiksSCgiaXNvV2Vla2RheSIsIkUiKSxMKCJkYXkiLDExKSxMKCJ3ZWVrZGF5IiwxMSksTCgiaXNvV2Vla2RheSIsMTEpLHVlKCJkIixCKSx1ZSgiZSIsQiksdWUoIkUiLEIpLHVlKCJkZCIsZnVuY3Rpb24oZSx0KXtyZXR1cm4gdC53ZWVrZGF5c01pblJlZ2V4KGUpfSksdWUoImRkZCIsZnVuY3Rpb24oZSx0KXtyZXR1cm4gdC53ZWVrZGF5c1Nob3J0UmVnZXgoZSl9KSx1ZSgiZGRkZCIsZnVuY3Rpb24oZSx0KXtyZXR1cm4gdC53ZWVrZGF5c1JlZ2V4KGUpfSksZmUoWyJkZCIsImRkZCIsImRkZGQiXSxmdW5jdGlvbihlLHQsbixzKXt2YXIgaT1uLl9sb2NhbGUud2Vla2RheXNQYXJzZShlLHMsbi5fc3RyaWN0KTtudWxsIT1pP3QuZD1pOmcobikuaW52YWxpZFdlZWtkYXk9ZX0pLGZlKFsiZCIsImUiLCJFIl0sZnVuY3Rpb24oZSx0LG4scyl7dFtzXT1rKGUpfSk7dmFyIGplPSJTdW5kYXlfTW9uZGF5X1R1ZXNkYXlfV2VkbmVzZGF5X1RodXJzZGF5X0ZyaWRheV9TYXR1cmRheSIuc3BsaXQoIl8iKTt2YXIgWmU9IlN1bl9Nb25fVHVlX1dlZF9UaHVfRnJpX1NhdCIuc3BsaXQoIl8iKTt2YXIgemU9IlN1X01vX1R1X1dlX1RoX0ZyX1NhIi5zcGxpdCgiXyIpO3ZhciAkZT1hZTt2YXIgcWU9YWU7dmFyIEplPWFlO2Z1bmN0aW9uIEJlKCl7ZnVuY3Rpb24gZShlLHQpe3JldHVybiB0Lmxlbmd0aC1lLmxlbmd0aH12YXIgdCxuLHMsaSxyLGE9W10sbz1bXSx1PVtdLGw9W107Zm9yKHQ9MDt0PDc7dCsrKW49eShbMmUzLDFdKS5kYXkodCkscz10aGlzLndlZWtkYXlzTWluKG4sIiIpLGk9dGhpcy53ZWVrZGF5c1Nob3J0KG4sIiIpLHI9dGhpcy53ZWVrZGF5cyhuLCIiKSxhLnB1c2gocyksby5wdXNoKGkpLHUucHVzaChyKSxsLnB1c2gocyksbC5wdXNoKGkpLGwucHVzaChyKTtmb3IoYS5zb3J0KGUpLG8uc29ydChlKSx1LnNvcnQoZSksbC5zb3J0KGUpLHQ9MDt0PDc7dCsrKW9bdF09ZGUob1t0XSksdVt0XT1kZSh1W3RdKSxsW3RdPWRlKGxbdF0pO3RoaXMuX3dlZWtkYXlzUmVnZXg9bmV3IFJlZ0V4cCgiXigiK2wuam9pbigifCIpKyIpIiwiaSIpLHRoaXMuX3dlZWtkYXlzU2hvcnRSZWdleD10aGlzLl93ZWVrZGF5c1JlZ2V4LHRoaXMuX3dlZWtkYXlzTWluUmVnZXg9dGhpcy5fd2Vla2RheXNSZWdleCx0aGlzLl93ZWVrZGF5c1N0cmljdFJlZ2V4PW5ldyBSZWdFeHAoIl4oIit1LmpvaW4oInwiKSsiKSIsImkiKSx0aGlzLl93ZWVrZGF5c1Nob3J0U3RyaWN0UmVnZXg9bmV3IFJlZ0V4cCgiXigiK28uam9pbigifCIpKyIpIiwiaSIpLHRoaXMuX3dlZWtkYXlzTWluU3RyaWN0UmVnZXg9bmV3IFJlZ0V4cCgiXigiK2Euam9pbigifCIpKyIpIiwiaSIpfWZ1bmN0aW9uIFFlKCl7cmV0dXJuIHRoaXMuaG91cnMoKSUxMnx8MTJ9ZnVuY3Rpb24gWGUoZSx0KXtJKGUsMCwwLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLm1lcmlkaWVtKHRoaXMuaG91cnMoKSx0aGlzLm1pbnV0ZXMoKSx0KX0pfWZ1bmN0aW9uIEtlKGUsdCl7cmV0dXJuIHQuX21lcmlkaWVtUGFyc2V9SSgiSCIsWyJISCIsMl0sMCwiaG91ciIpLEkoImgiLFsiaGgiLDJdLDAsUWUpLEkoImsiLFsia2siLDJdLDAsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ob3VycygpfHwyNH0pLEkoImhtbSIsMCwwLGZ1bmN0aW9uKCl7cmV0dXJuIiIrUWUuYXBwbHkodGhpcykrVSh0aGlzLm1pbnV0ZXMoKSwyKX0pLEkoImhtbXNzIiwwLDAsZnVuY3Rpb24oKXtyZXR1cm4iIitRZS5hcHBseSh0aGlzKStVKHRoaXMubWludXRlcygpLDIpK1UodGhpcy5zZWNvbmRzKCksMil9KSxJKCJIbW0iLDAsMCxmdW5jdGlvbigpe3JldHVybiIiK3RoaXMuaG91cnMoKStVKHRoaXMubWludXRlcygpLDIpfSksSSgiSG1tc3MiLDAsMCxmdW5jdGlvbigpe3JldHVybiIiK3RoaXMuaG91cnMoKStVKHRoaXMubWludXRlcygpLDIpK1UodGhpcy5zZWNvbmRzKCksMil9KSxYZSgiYSIsITApLFhlKCJBIiwhMSksSCgiaG91ciIsImgiKSxMKCJob3VyIiwxMyksdWUoImEiLEtlKSx1ZSgiQSIsS2UpLHVlKCJIIixCKSx1ZSgiaCIsQiksdWUoImsiLEIpLHVlKCJISCIsQix6KSx1ZSgiaGgiLEIseiksdWUoImtrIixCLHopLHVlKCJobW0iLFEpLHVlKCJobW1zcyIsWCksdWUoIkhtbSIsUSksdWUoIkhtbXNzIixYKSxjZShbIkgiLCJISCJdLGdlKSxjZShbImsiLCJrayJdLGZ1bmN0aW9uKGUsdCxuKXt2YXIgcz1rKGUpO3RbZ2VdPTI0PT09cz8wOnN9KSxjZShbImEiLCJBIl0sZnVuY3Rpb24oZSx0LG4pe24uX2lzUG09bi5fbG9jYWxlLmlzUE0oZSksbi5fbWVyaWRpZW09ZX0pLGNlKFsiaCIsImhoIl0sZnVuY3Rpb24oZSx0LG4pe3RbZ2VdPWsoZSksZyhuKS5iaWdIb3VyPSEwfSksY2UoImhtbSIsZnVuY3Rpb24oZSx0LG4pe3ZhciBzPWUubGVuZ3RoLTI7dFtnZV09ayhlLnN1YnN0cigwLHMpKSx0W3BlXT1rKGUuc3Vic3RyKHMpKSxnKG4pLmJpZ0hvdXI9ITB9KSxjZSgiaG1tc3MiLGZ1bmN0aW9uKGUsdCxuKXt2YXIgcz1lLmxlbmd0aC00LGk9ZS5sZW5ndGgtMjt0W2dlXT1rKGUuc3Vic3RyKDAscykpLHRbcGVdPWsoZS5zdWJzdHIocywyKSksdFt2ZV09ayhlLnN1YnN0cihpKSksZyhuKS5iaWdIb3VyPSEwfSksY2UoIkhtbSIsZnVuY3Rpb24oZSx0LG4pe3ZhciBzPWUubGVuZ3RoLTI7dFtnZV09ayhlLnN1YnN0cigwLHMpKSx0W3BlXT1rKGUuc3Vic3RyKHMpKX0pLGNlKCJIbW1zcyIsZnVuY3Rpb24oZSx0LG4pe3ZhciBzPWUubGVuZ3RoLTQsaT1lLmxlbmd0aC0yO3RbZ2VdPWsoZS5zdWJzdHIoMCxzKSksdFtwZV09ayhlLnN1YnN0cihzLDIpKSx0W3ZlXT1rKGUuc3Vic3RyKGkpKX0pO3ZhciBldCx0dD1UZSgiSG91cnMiLCEwKSxudD17Y2FsZW5kYXI6e3NhbWVEYXk6IltUb2RheSBhdF0gTFQiLG5leHREYXk6IltUb21vcnJvdyBhdF0gTFQiLG5leHRXZWVrOiJkZGRkIFthdF0gTFQiLGxhc3REYXk6IltZZXN0ZXJkYXkgYXRdIExUIixsYXN0V2VlazoiW0xhc3RdIGRkZGQgW2F0XSBMVCIsc2FtZUVsc2U6IkwifSxsb25nRGF0ZUZvcm1hdDp7TFRTOiJoOm1tOnNzIEEiLExUOiJoOm1tIEEiLEw6Ik1NL0REL1lZWVkiLExMOiJNTU1NIEQsIFlZWVkiLExMTDoiTU1NTSBELCBZWVlZIGg6bW0gQSIsTExMTDoiZGRkZCwgTU1NTSBELCBZWVlZIGg6bW0gQSJ9LGludmFsaWREYXRlOiJJbnZhbGlkIGRhdGUiLG9yZGluYWw6IiVkIixkYXlPZk1vbnRoT3JkaW5hbFBhcnNlOi9cZHsxLDJ9LyxyZWxhdGl2ZVRpbWU6e2Z1dHVyZToiaW4gJXMiLHBhc3Q6IiVzIGFnbyIsczoiYSBmZXcgc2Vjb25kcyIsc3M6IiVkIHNlY29uZHMiLG06ImEgbWludXRlIixtbToiJWQgbWludXRlcyIsaDoiYW4gaG91ciIsaGg6IiVkIGhvdXJzIixkOiJhIGRheSIsZGQ6IiVkIGRheXMiLE06ImEgbW9udGgiLE1NOiIlZCBtb250aHMiLHk6ImEgeWVhciIseXk6IiVkIHllYXJzIn0sbW9udGhzOkhlLG1vbnRoc1Nob3J0OlJlLHdlZWs6e2RvdzowLGRveTo2fSx3ZWVrZGF5czpqZSx3ZWVrZGF5c01pbjp6ZSx3ZWVrZGF5c1Nob3J0OlplLG1lcmlkaWVtUGFyc2U6L1thcF1cLj9tP1wuPy9pfSxzdD17fSxpdD17fTtmdW5jdGlvbiBydChlKXtyZXR1cm4gZT9lLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgiXyIsIi0iKTplfWZ1bmN0aW9uIGF0KGUpe3ZhciB0PW51bGw7aWYoIXN0W2VdJiYidW5kZWZpbmVkIiE9dHlwZW9mIG1vZHVsZSYmbW9kdWxlJiZtb2R1bGUuZXhwb3J0cyl0cnl7dD1ldC5fYWJicixyZXF1aXJlKCIuL2xvY2FsZS8iK2UpLG90KHQpfWNhdGNoKGUpe31yZXR1cm4gc3RbZV19ZnVuY3Rpb24gb3QoZSx0KXt2YXIgbjtyZXR1cm4gZSYmKChuPWwodCk/bHQoZSk6dXQoZSx0KSk/ZXQ9bjoidW5kZWZpbmVkIiE9dHlwZW9mIGNvbnNvbGUmJmNvbnNvbGUud2FybiYmY29uc29sZS53YXJuKCJMb2NhbGUgIitlKyIgbm90IGZvdW5kLiBEaWQgeW91IGZvcmdldCB0byBsb2FkIGl0PyIpKSxldC5fYWJicn1mdW5jdGlvbiB1dChlLHQpe2lmKG51bGwhPT10KXt2YXIgbixzPW50O2lmKHQuYWJicj1lLG51bGwhPXN0W2VdKVQoImRlZmluZUxvY2FsZU92ZXJyaWRlIiwidXNlIG1vbWVudC51cGRhdGVMb2NhbGUobG9jYWxlTmFtZSwgY29uZmlnKSB0byBjaGFuZ2UgYW4gZXhpc3RpbmcgbG9jYWxlLiBtb21lbnQuZGVmaW5lTG9jYWxlKGxvY2FsZU5hbWUsIGNvbmZpZykgc2hvdWxkIG9ubHkgYmUgdXNlZCBmb3IgY3JlYXRpbmcgYSBuZXcgbG9jYWxlIFNlZSBodHRwOi8vbW9tZW50anMuY29tL2d1aWRlcy8jL3dhcm5pbmdzL2RlZmluZS1sb2NhbGUvIGZvciBtb3JlIGluZm8uIikscz1zdFtlXS5fY29uZmlnO2Vsc2UgaWYobnVsbCE9dC5wYXJlbnRMb2NhbGUpaWYobnVsbCE9c3RbdC5wYXJlbnRMb2NhbGVdKXM9c3RbdC5wYXJlbnRMb2NhbGVdLl9jb25maWc7ZWxzZXtpZihudWxsPT0obj1hdCh0LnBhcmVudExvY2FsZSkpKXJldHVybiBpdFt0LnBhcmVudExvY2FsZV18fChpdFt0LnBhcmVudExvY2FsZV09W10pLGl0W3QucGFyZW50TG9jYWxlXS5wdXNoKHtuYW1lOmUsY29uZmlnOnR9KSxudWxsO3M9bi5fY29uZmlnfXJldHVybiBzdFtlXT1uZXcgUChiKHMsdCkpLGl0W2VdJiZpdFtlXS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3V0KGUubmFtZSxlLmNvbmZpZyl9KSxvdChlKSxzdFtlXX1yZXR1cm4gZGVsZXRlIHN0W2VdLG51bGx9ZnVuY3Rpb24gbHQoZSl7dmFyIHQ7aWYoZSYmZS5fbG9jYWxlJiZlLl9sb2NhbGUuX2FiYnImJihlPWUuX2xvY2FsZS5fYWJiciksIWUpcmV0dXJuIGV0O2lmKCFvKGUpKXtpZih0PWF0KGUpKXJldHVybiB0O2U9W2VdfXJldHVybiBmdW5jdGlvbihlKXtmb3IodmFyIHQsbixzLGkscj0wO3I8ZS5sZW5ndGg7KXtmb3IodD0oaT1ydChlW3JdKS5zcGxpdCgiLSIpKS5sZW5ndGgsbj0obj1ydChlW3IrMV0pKT9uLnNwbGl0KCItIik6bnVsbDswPHQ7KXtpZihzPWF0KGkuc2xpY2UoMCx0KS5qb2luKCItIikpKXJldHVybiBzO2lmKG4mJm4ubGVuZ3RoPj10JiZhKGksbiwhMCk+PXQtMSlicmVhazt0LS19cisrfXJldHVybiBldH0oZSl9ZnVuY3Rpb24gZHQoZSl7dmFyIHQsbj1lLl9hO3JldHVybiBuJiYtMj09PWcoZSkub3ZlcmZsb3cmJih0PW5bX2VdPDB8fDExPG5bX2VdP19lOm5beWVdPDF8fG5beWVdPlBlKG5bbWVdLG5bX2VdKT95ZTpuW2dlXTwwfHwyNDxuW2dlXXx8MjQ9PT1uW2dlXSYmKDAhPT1uW3BlXXx8MCE9PW5bdmVdfHwwIT09blt3ZV0pP2dlOm5bcGVdPDB8fDU5PG5bcGVdP3BlOm5bdmVdPDB8fDU5PG5bdmVdP3ZlOm5bd2VdPDB8fDk5OTxuW3dlXT93ZTotMSxnKGUpLl9vdmVyZmxvd0RheU9mWWVhciYmKHQ8bWV8fHllPHQpJiYodD15ZSksZyhlKS5fb3ZlcmZsb3dXZWVrcyYmLTE9PT10JiYodD1NZSksZyhlKS5fb3ZlcmZsb3dXZWVrZGF5JiYtMT09PXQmJih0PVNlKSxnKGUpLm92ZXJmbG93PXQpLGV9ZnVuY3Rpb24gaHQoZSx0LG4pe3JldHVybiBudWxsIT1lP2U6bnVsbCE9dD90Om59ZnVuY3Rpb24gY3QoZSl7dmFyIHQsbixzLGkscixhPVtdO2lmKCFlLl9kKXt2YXIgbyx1O2ZvcihvPWUsdT1uZXcgRGF0ZShjLm5vdygpKSxzPW8uX3VzZVVUQz9bdS5nZXRVVENGdWxsWWVhcigpLHUuZ2V0VVRDTW9udGgoKSx1LmdldFVUQ0RhdGUoKV06W3UuZ2V0RnVsbFllYXIoKSx1LmdldE1vbnRoKCksdS5nZXREYXRlKCldLGUuX3cmJm51bGw9PWUuX2FbeWVdJiZudWxsPT1lLl9hW19lXSYmZnVuY3Rpb24oZSl7dmFyIHQsbixzLGkscixhLG8sdTtpZihudWxsIT0odD1lLl93KS5HR3x8bnVsbCE9dC5XfHxudWxsIT10LkUpcj0xLGE9NCxuPWh0KHQuR0csZS5fYVttZV0sSWUoVHQoKSwxLDQpLnllYXIpLHM9aHQodC5XLDEpLCgoaT1odCh0LkUsMSkpPDF8fDc8aSkmJih1PSEwKTtlbHNle3I9ZS5fbG9jYWxlLl93ZWVrLmRvdyxhPWUuX2xvY2FsZS5fd2Vlay5kb3k7dmFyIGw9SWUoVHQoKSxyLGEpO249aHQodC5nZyxlLl9hW21lXSxsLnllYXIpLHM9aHQodC53LGwud2VlayksbnVsbCE9dC5kPygoaT10LmQpPDB8fDY8aSkmJih1PSEwKTpudWxsIT10LmU/KGk9dC5lK3IsKHQuZTwwfHw2PHQuZSkmJih1PSEwKSk6aT1yfXM8MXx8cz5BZShuLHIsYSk/ZyhlKS5fb3ZlcmZsb3dXZWVrcz0hMDpudWxsIT11P2coZSkuX292ZXJmbG93V2Vla2RheT0hMDoobz1FZShuLHMsaSxyLGEpLGUuX2FbbWVdPW8ueWVhcixlLl9kYXlPZlllYXI9by5kYXlPZlllYXIpfShlKSxudWxsIT1lLl9kYXlPZlllYXImJihyPWh0KGUuX2FbbWVdLHNbbWVdKSwoZS5fZGF5T2ZZZWFyPkRlKHIpfHwwPT09ZS5fZGF5T2ZZZWFyKSYmKGcoZSkuX292ZXJmbG93RGF5T2ZZZWFyPSEwKSxuPUdlKHIsMCxlLl9kYXlPZlllYXIpLGUuX2FbX2VdPW4uZ2V0VVRDTW9udGgoKSxlLl9hW3llXT1uLmdldFVUQ0RhdGUoKSksdD0wO3Q8MyYmbnVsbD09ZS5fYVt0XTsrK3QpZS5fYVt0XT1hW3RdPXNbdF07Zm9yKDt0PDc7dCsrKWUuX2FbdF09YVt0XT1udWxsPT1lLl9hW3RdPzI9PT10PzE6MDplLl9hW3RdOzI0PT09ZS5fYVtnZV0mJjA9PT1lLl9hW3BlXSYmMD09PWUuX2FbdmVdJiYwPT09ZS5fYVt3ZV0mJihlLl9uZXh0RGF5PSEwLGUuX2FbZ2VdPTApLGUuX2Q9KGUuX3VzZVVUQz9HZTpmdW5jdGlvbihlLHQsbixzLGkscixhKXt2YXIgbz1uZXcgRGF0ZShlLHQsbixzLGkscixhKTtyZXR1cm4gZTwxMDAmJjA8PWUmJmlzRmluaXRlKG8uZ2V0RnVsbFllYXIoKSkmJm8uc2V0RnVsbFllYXIoZSksb30pLmFwcGx5KG51bGwsYSksaT1lLl91c2VVVEM/ZS5fZC5nZXRVVENEYXkoKTplLl9kLmdldERheSgpLG51bGwhPWUuX3R6bSYmZS5fZC5zZXRVVENNaW51dGVzKGUuX2QuZ2V0VVRDTWludXRlcygpLWUuX3R6bSksZS5fbmV4dERheSYmKGUuX2FbZ2VdPTI0KSxlLl93JiZ2b2lkIDAhPT1lLl93LmQmJmUuX3cuZCE9PWkmJihnKGUpLndlZWtkYXlNaXNtYXRjaD0hMCl9fXZhciBmdD0vXlxzKigoPzpbKy1dXGR7Nn18XGR7NH0pLSg/OlxkXGQtXGRcZHxXXGRcZC1cZHxXXGRcZHxcZFxkXGR8XGRcZCkpKD86KFR8ICkoXGRcZCg/OjpcZFxkKD86OlxkXGQoPzpbLixdXGQrKT8pPyk/KShbXCtcLV1cZFxkKD86Oj9cZFxkKT98XHMqWik/KT8kLyxtdD0vXlxzKigoPzpbKy1dXGR7Nn18XGR7NH0pKD86XGRcZFxkXGR8V1xkXGRcZHxXXGRcZHxcZFxkXGR8XGRcZCkpKD86KFR8ICkoXGRcZCg/OlxkXGQoPzpcZFxkKD86Wy4sXVxkKyk/KT8pPykoW1wrXC1dXGRcZCg/Ojo/XGRcZCk/fFxzKlopPyk/JC8sX3Q9L1p8WystXVxkXGQoPzo6P1xkXGQpPy8seXQ9W1siWVlZWVlZLU1NLUREIiwvWystXVxkezZ9LVxkXGQtXGRcZC9dLFsiWVlZWS1NTS1ERCIsL1xkezR9LVxkXGQtXGRcZC9dLFsiR0dHRy1bV11XVy1FIiwvXGR7NH0tV1xkXGQtXGQvXSxbIkdHR0ctW1ddV1ciLC9cZHs0fS1XXGRcZC8sITFdLFsiWVlZWS1EREQiLC9cZHs0fS1cZHszfS9dLFsiWVlZWS1NTSIsL1xkezR9LVxkXGQvLCExXSxbIllZWVlZWU1NREQiLC9bKy1dXGR7MTB9L10sWyJZWVlZTU1ERCIsL1xkezh9L10sWyJHR0dHW1ddV1dFIiwvXGR7NH1XXGR7M30vXSxbIkdHR0dbV11XVyIsL1xkezR9V1xkezJ9LywhMV0sWyJZWVlZREREIiwvXGR7N30vXV0sZ3Q9W1siSEg6bW06c3MuU1NTUyIsL1xkXGQ6XGRcZDpcZFxkXC5cZCsvXSxbIkhIOm1tOnNzLFNTU1MiLC9cZFxkOlxkXGQ6XGRcZCxcZCsvXSxbIkhIOm1tOnNzIiwvXGRcZDpcZFxkOlxkXGQvXSxbIkhIOm1tIiwvXGRcZDpcZFxkL10sWyJISG1tc3MuU1NTUyIsL1xkXGRcZFxkXGRcZFwuXGQrL10sWyJISG1tc3MsU1NTUyIsL1xkXGRcZFxkXGRcZCxcZCsvXSxbIkhIbW1zcyIsL1xkXGRcZFxkXGRcZC9dLFsiSEhtbSIsL1xkXGRcZFxkL10sWyJISCIsL1xkXGQvXV0scHQ9L15cLz9EYXRlXCgoXC0/XGQrKS9pO2Z1bmN0aW9uIHZ0KGUpe3ZhciB0LG4scyxpLHIsYSxvPWUuX2ksdT1mdC5leGVjKG8pfHxtdC5leGVjKG8pO2lmKHUpe2ZvcihnKGUpLmlzbz0hMCx0PTAsbj15dC5sZW5ndGg7dDxuO3QrKylpZih5dFt0XVsxXS5leGVjKHVbMV0pKXtpPXl0W3RdWzBdLHM9ITEhPT15dFt0XVsyXTticmVha31pZihudWxsPT1pKXJldHVybiB2b2lkKGUuX2lzVmFsaWQ9ITEpO2lmKHVbM10pe2Zvcih0PTAsbj1ndC5sZW5ndGg7dDxuO3QrKylpZihndFt0XVsxXS5leGVjKHVbM10pKXtyPSh1WzJdfHwiICIpK2d0W3RdWzBdO2JyZWFrfWlmKG51bGw9PXIpcmV0dXJuIHZvaWQoZS5faXNWYWxpZD0hMSl9aWYoIXMmJm51bGwhPXIpcmV0dXJuIHZvaWQoZS5faXNWYWxpZD0hMSk7aWYodVs0XSl7aWYoIV90LmV4ZWModVs0XSkpcmV0dXJuIHZvaWQoZS5faXNWYWxpZD0hMSk7YT0iWiJ9ZS5fZj1pKyhyfHwiIikrKGF8fCIiKSxrdChlKX1lbHNlIGUuX2lzVmFsaWQ9ITF9dmFyIHd0PS9eKD86KE1vbnxUdWV8V2VkfFRodXxGcml8U2F0fFN1biksP1xzKT8oXGR7MSwyfSlccyhKYW58RmVifE1hcnxBcHJ8TWF5fEp1bnxKdWx8QXVnfFNlcHxPY3R8Tm92fERlYylccyhcZHsyLDR9KVxzKFxkXGQpOihcZFxkKSg/OjooXGRcZCkpP1xzKD86KFVUfEdNVHxbRUNNUF1bU0RdVCl8KFtael0pfChbKy1dXGR7NH0pKSQvO2Z1bmN0aW9uIE10KGUsdCxuLHMsaSxyKXt2YXIgYT1bZnVuY3Rpb24oZSl7dmFyIHQ9cGFyc2VJbnQoZSwxMCk7e2lmKHQ8PTQ5KXJldHVybiAyZTMrdDtpZih0PD05OTkpcmV0dXJuIDE5MDArdH1yZXR1cm4gdH0oZSksUmUuaW5kZXhPZih0KSxwYXJzZUludChuLDEwKSxwYXJzZUludChzLDEwKSxwYXJzZUludChpLDEwKV07cmV0dXJuIHImJmEucHVzaChwYXJzZUludChyLDEwKSksYX12YXIgU3Q9e1VUOjAsR01UOjAsRURUOi0yNDAsRVNUOi0zMDAsQ0RUOi0zMDAsQ1NUOi0zNjAsTURUOi0zNjAsTVNUOi00MjAsUERUOi00MjAsUFNUOi00ODB9O2Z1bmN0aW9uIER0KGUpe3ZhciB0LG4scyxpPXd0LmV4ZWMoZS5faS5yZXBsYWNlKC9cKFteKV0qXCl8W1xuXHRdL2csIiAiKS5yZXBsYWNlKC8oXHNccyspL2csIiAiKS5yZXBsYWNlKC9eXHNccyovLCIiKS5yZXBsYWNlKC9cc1xzKiQvLCIiKSk7aWYoaSl7dmFyIHI9TXQoaVs0XSxpWzNdLGlbMl0saVs1XSxpWzZdLGlbN10pO2lmKHQ9aVsxXSxuPXIscz1lLHQmJlplLmluZGV4T2YodCkhPT1uZXcgRGF0ZShuWzBdLG5bMV0sblsyXSkuZ2V0RGF5KCkmJihnKHMpLndlZWtkYXlNaXNtYXRjaD0hMCwhKHMuX2lzVmFsaWQ9ITEpKSlyZXR1cm47ZS5fYT1yLGUuX3R6bT1mdW5jdGlvbihlLHQsbil7aWYoZSlyZXR1cm4gU3RbZV07aWYodClyZXR1cm4gMDt2YXIgcz1wYXJzZUludChuLDEwKSxpPXMlMTAwO3JldHVybihzLWkpLzEwMCo2MCtpfShpWzhdLGlbOV0saVsxMF0pLGUuX2Q9R2UuYXBwbHkobnVsbCxlLl9hKSxlLl9kLnNldFVUQ01pbnV0ZXMoZS5fZC5nZXRVVENNaW51dGVzKCktZS5fdHptKSxnKGUpLnJmYzI4MjI9ITB9ZWxzZSBlLl9pc1ZhbGlkPSExfWZ1bmN0aW9uIGt0KGUpe2lmKGUuX2YhPT1jLklTT184NjAxKWlmKGUuX2YhPT1jLlJGQ18yODIyKXtlLl9hPVtdLGcoZSkuZW1wdHk9ITA7dmFyIHQsbixzLGkscixhLG8sdSxsPSIiK2UuX2ksZD1sLmxlbmd0aCxoPTA7Zm9yKHM9aihlLl9mLGUuX2xvY2FsZSkubWF0Y2goTil8fFtdLHQ9MDt0PHMubGVuZ3RoO3QrKylpPXNbdF0sKG49KGwubWF0Y2gobGUoaSxlKSl8fFtdKVswXSkmJigwPChyPWwuc3Vic3RyKDAsbC5pbmRleE9mKG4pKSkubGVuZ3RoJiZnKGUpLnVudXNlZElucHV0LnB1c2gociksbD1sLnNsaWNlKGwuaW5kZXhPZihuKStuLmxlbmd0aCksaCs9bi5sZW5ndGgpLEVbaV0/KG4/ZyhlKS5lbXB0eT0hMTpnKGUpLnVudXNlZFRva2Vucy5wdXNoKGkpLGE9aSx1PWUsbnVsbCE9KG89bikmJm0oaGUsYSkmJmhlW2FdKG8sdS5fYSx1LGEpKTplLl9zdHJpY3QmJiFuJiZnKGUpLnVudXNlZFRva2Vucy5wdXNoKGkpO2coZSkuY2hhcnNMZWZ0T3Zlcj1kLWgsMDxsLmxlbmd0aCYmZyhlKS51bnVzZWRJbnB1dC5wdXNoKGwpLGUuX2FbZ2VdPD0xMiYmITA9PT1nKGUpLmJpZ0hvdXImJjA8ZS5fYVtnZV0mJihnKGUpLmJpZ0hvdXI9dm9pZCAwKSxnKGUpLnBhcnNlZERhdGVQYXJ0cz1lLl9hLnNsaWNlKDApLGcoZSkubWVyaWRpZW09ZS5fbWVyaWRpZW0sZS5fYVtnZV09ZnVuY3Rpb24oZSx0LG4pe3ZhciBzO2lmKG51bGw9PW4pcmV0dXJuIHQ7cmV0dXJuIG51bGwhPWUubWVyaWRpZW1Ib3VyP2UubWVyaWRpZW1Ib3VyKHQsbik6KG51bGwhPWUuaXNQTSYmKChzPWUuaXNQTShuKSkmJnQ8MTImJih0Kz0xMiksc3x8MTIhPT10fHwodD0wKSksdCl9KGUuX2xvY2FsZSxlLl9hW2dlXSxlLl9tZXJpZGllbSksY3QoZSksZHQoZSl9ZWxzZSBEdChlKTtlbHNlIHZ0KGUpfWZ1bmN0aW9uIFl0KGUpe3ZhciB0LG4scyxpLHI9ZS5faSxhPWUuX2Y7cmV0dXJuIGUuX2xvY2FsZT1lLl9sb2NhbGV8fGx0KGUuX2wpLG51bGw9PT1yfHx2b2lkIDA9PT1hJiYiIj09PXI/dih7bnVsbElucHV0OiEwfSk6KCJzdHJpbmciPT10eXBlb2YgciYmKGUuX2k9cj1lLl9sb2NhbGUucHJlcGFyc2UocikpLFMocik/bmV3IE0oZHQocikpOihoKHIpP2UuX2Q9cjpvKGEpP2Z1bmN0aW9uKGUpe3ZhciB0LG4scyxpLHI7aWYoMD09PWUuX2YubGVuZ3RoKXJldHVybiBnKGUpLmludmFsaWRGb3JtYXQ9ITAsZS5fZD1uZXcgRGF0ZShOYU4pO2ZvcihpPTA7aTxlLl9mLmxlbmd0aDtpKyspcj0wLHQ9dyh7fSxlKSxudWxsIT1lLl91c2VVVEMmJih0Ll91c2VVVEM9ZS5fdXNlVVRDKSx0Ll9mPWUuX2ZbaV0sa3QodCkscCh0KSYmKHIrPWcodCkuY2hhcnNMZWZ0T3ZlcixyKz0xMCpnKHQpLnVudXNlZFRva2Vucy5sZW5ndGgsZyh0KS5zY29yZT1yLChudWxsPT1zfHxyPHMpJiYocz1yLG49dCkpO18oZSxufHx0KX0oZSk6YT9rdChlKTpsKG49KHQ9ZSkuX2kpP3QuX2Q9bmV3IERhdGUoYy5ub3coKSk6aChuKT90Ll9kPW5ldyBEYXRlKG4udmFsdWVPZigpKToic3RyaW5nIj09dHlwZW9mIG4/KHM9dCxudWxsPT09KGk9cHQuZXhlYyhzLl9pKSk/KHZ0KHMpLCExPT09cy5faXNWYWxpZCYmKGRlbGV0ZSBzLl9pc1ZhbGlkLER0KHMpLCExPT09cy5faXNWYWxpZCYmKGRlbGV0ZSBzLl9pc1ZhbGlkLGMuY3JlYXRlRnJvbUlucHV0RmFsbGJhY2socykpKSk6cy5fZD1uZXcgRGF0ZSgraVsxXSkpOm8obik/KHQuX2E9ZihuLnNsaWNlKDApLGZ1bmN0aW9uKGUpe3JldHVybiBwYXJzZUludChlLDEwKX0pLGN0KHQpKTp1KG4pP2Z1bmN0aW9uKGUpe2lmKCFlLl9kKXt2YXIgdD1DKGUuX2kpO2UuX2E9ZihbdC55ZWFyLHQubW9udGgsdC5kYXl8fHQuZGF0ZSx0LmhvdXIsdC5taW51dGUsdC5zZWNvbmQsdC5taWxsaXNlY29uZF0sZnVuY3Rpb24oZSl7cmV0dXJuIGUmJnBhcnNlSW50KGUsMTApfSksY3QoZSl9fSh0KTpkKG4pP3QuX2Q9bmV3IERhdGUobik6Yy5jcmVhdGVGcm9tSW5wdXRGYWxsYmFjayh0KSxwKGUpfHwoZS5fZD1udWxsKSxlKSl9ZnVuY3Rpb24gT3QoZSx0LG4scyxpKXt2YXIgcixhPXt9O3JldHVybiEwIT09biYmITEhPT1ufHwocz1uLG49dm9pZCAwKSwodShlKSYmZnVuY3Rpb24oZSl7aWYoT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMpcmV0dXJuIDA9PT1PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhlKS5sZW5ndGg7dmFyIHQ7Zm9yKHQgaW4gZSlpZihlLmhhc093blByb3BlcnR5KHQpKXJldHVybiExO3JldHVybiEwfShlKXx8byhlKSYmMD09PWUubGVuZ3RoKSYmKGU9dm9pZCAwKSxhLl9pc0FNb21lbnRPYmplY3Q9ITAsYS5fdXNlVVRDPWEuX2lzVVRDPWksYS5fbD1uLGEuX2k9ZSxhLl9mPXQsYS5fc3RyaWN0PXMsKHI9bmV3IE0oZHQoWXQoYSkpKSkuX25leHREYXkmJihyLmFkZCgxLCJkIiksci5fbmV4dERheT12b2lkIDApLHJ9ZnVuY3Rpb24gVHQoZSx0LG4scyl7cmV0dXJuIE90KGUsdCxuLHMsITEpfWMuY3JlYXRlRnJvbUlucHV0RmFsbGJhY2s9bigidmFsdWUgcHJvdmlkZWQgaXMgbm90IGluIGEgcmVjb2duaXplZCBSRkMyODIyIG9yIElTTyBmb3JtYXQuIG1vbWVudCBjb25zdHJ1Y3Rpb24gZmFsbHMgYmFjayB0byBqcyBEYXRlKCksIHdoaWNoIGlzIG5vdCByZWxpYWJsZSBhY3Jvc3MgYWxsIGJyb3dzZXJzIGFuZCB2ZXJzaW9ucy4gTm9uIFJGQzI4MjIvSVNPIGRhdGUgZm9ybWF0cyBhcmUgZGlzY291cmFnZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiBhbiB1cGNvbWluZyBtYWpvciByZWxlYXNlLiBQbGVhc2UgcmVmZXIgdG8gaHR0cDovL21vbWVudGpzLmNvbS9ndWlkZXMvIy93YXJuaW5ncy9qcy1kYXRlLyBmb3IgbW9yZSBpbmZvLiIsZnVuY3Rpb24oZSl7ZS5fZD1uZXcgRGF0ZShlLl9pKyhlLl91c2VVVEM/IiBVVEMiOiIiKSl9KSxjLklTT184NjAxPWZ1bmN0aW9uKCl7fSxjLlJGQ18yODIyPWZ1bmN0aW9uKCl7fTt2YXIgeHQ9bigibW9tZW50KCkubWluIGlzIGRlcHJlY2F0ZWQsIHVzZSBtb21lbnQubWF4IGluc3RlYWQuIGh0dHA6Ly9tb21lbnRqcy5jb20vZ3VpZGVzLyMvd2FybmluZ3MvbWluLW1heC8iLGZ1bmN0aW9uKCl7dmFyIGU9VHQuYXBwbHkobnVsbCxhcmd1bWVudHMpO3JldHVybiB0aGlzLmlzVmFsaWQoKSYmZS5pc1ZhbGlkKCk/ZTx0aGlzP3RoaXM6ZTp2KCl9KSxidD1uKCJtb21lbnQoKS5tYXggaXMgZGVwcmVjYXRlZCwgdXNlIG1vbWVudC5taW4gaW5zdGVhZC4gaHR0cDovL21vbWVudGpzLmNvbS9ndWlkZXMvIy93YXJuaW5ncy9taW4tbWF4LyIsZnVuY3Rpb24oKXt2YXIgZT1UdC5hcHBseShudWxsLGFyZ3VtZW50cyk7cmV0dXJuIHRoaXMuaXNWYWxpZCgpJiZlLmlzVmFsaWQoKT90aGlzPGU/dGhpczplOnYoKX0pO2Z1bmN0aW9uIFB0KGUsdCl7dmFyIG4scztpZigxPT09dC5sZW5ndGgmJm8odFswXSkmJih0PXRbMF0pLCF0Lmxlbmd0aClyZXR1cm4gVHQoKTtmb3Iobj10WzBdLHM9MTtzPHQubGVuZ3RoOysrcyl0W3NdLmlzVmFsaWQoKSYmIXRbc11bZV0obil8fChuPXRbc10pO3JldHVybiBufXZhciBXdD1bInllYXIiLCJxdWFydGVyIiwibW9udGgiLCJ3ZWVrIiwiZGF5IiwiaG91ciIsIm1pbnV0ZSIsInNlY29uZCIsIm1pbGxpc2Vjb25kIl07ZnVuY3Rpb24gSHQoZSl7dmFyIHQ9QyhlKSxuPXQueWVhcnx8MCxzPXQucXVhcnRlcnx8MCxpPXQubW9udGh8fDAscj10LndlZWt8fDAsYT10LmRheXx8MCxvPXQuaG91cnx8MCx1PXQubWludXRlfHwwLGw9dC5zZWNvbmR8fDAsZD10Lm1pbGxpc2Vjb25kfHwwO3RoaXMuX2lzVmFsaWQ9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0IGluIGUpaWYoLTE9PT1ZZS5jYWxsKFd0LHQpfHxudWxsIT1lW3RdJiZpc05hTihlW3RdKSlyZXR1cm4hMTtmb3IodmFyIG49ITEscz0wO3M8V3QubGVuZ3RoOysrcylpZihlW1d0W3NdXSl7aWYobilyZXR1cm4hMTtwYXJzZUZsb2F0KGVbV3Rbc11dKSE9PWsoZVtXdFtzXV0pJiYobj0hMCl9cmV0dXJuITB9KHQpLHRoaXMuX21pbGxpc2Vjb25kcz0rZCsxZTMqbCs2ZTQqdSsxZTMqbyo2MCo2MCx0aGlzLl9kYXlzPSthKzcqcix0aGlzLl9tb250aHM9K2krMypzKzEyKm4sdGhpcy5fZGF0YT17fSx0aGlzLl9sb2NhbGU9bHQoKSx0aGlzLl9idWJibGUoKX1mdW5jdGlvbiBSdChlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIEh0fWZ1bmN0aW9uIEN0KGUpe3JldHVybiBlPDA/LTEqTWF0aC5yb3VuZCgtMSplKTpNYXRoLnJvdW5kKGUpfWZ1bmN0aW9uIEZ0KGUsbil7SShlLDAsMCxmdW5jdGlvbigpe3ZhciBlPXRoaXMudXRjT2Zmc2V0KCksdD0iKyI7cmV0dXJuIGU8MCYmKGU9LWUsdD0iLSIpLHQrVSh+fihlLzYwKSwyKStuK1Uofn5lJTYwLDIpfSl9RnQoIloiLCI6IiksRnQoIlpaIiwiIiksdWUoIloiLHJlKSx1ZSgiWloiLHJlKSxjZShbIloiLCJaWiJdLGZ1bmN0aW9uKGUsdCxuKXtuLl91c2VVVEM9ITAsbi5fdHptPVV0KHJlLGUpfSk7dmFyIEx0PS8oW1wrXC1dfFxkXGQpL2dpO2Z1bmN0aW9uIFV0KGUsdCl7dmFyIG49KHR8fCIiKS5tYXRjaChlKTtpZihudWxsPT09bilyZXR1cm4gbnVsbDt2YXIgcz0oKG5bbi5sZW5ndGgtMV18fFtdKSsiIikubWF0Y2goTHQpfHxbIi0iLDAsMF0saT02MCpzWzFdK2soc1syXSk7cmV0dXJuIDA9PT1pPzA6IisiPT09c1swXT9pOi1pfWZ1bmN0aW9uIE50KGUsdCl7dmFyIG4scztyZXR1cm4gdC5faXNVVEM/KG49dC5jbG9uZSgpLHM9KFMoZSl8fGgoZSk/ZS52YWx1ZU9mKCk6VHQoZSkudmFsdWVPZigpKS1uLnZhbHVlT2YoKSxuLl9kLnNldFRpbWUobi5fZC52YWx1ZU9mKCkrcyksYy51cGRhdGVPZmZzZXQobiwhMSksbik6VHQoZSkubG9jYWwoKX1mdW5jdGlvbiBHdChlKXtyZXR1cm4gMTUqLU1hdGgucm91bmQoZS5fZC5nZXRUaW1lem9uZU9mZnNldCgpLzE1KX1mdW5jdGlvbiBWdCgpe3JldHVybiEhdGhpcy5pc1ZhbGlkKCkmJih0aGlzLl9pc1VUQyYmMD09PXRoaXMuX29mZnNldCl9Yy51cGRhdGVPZmZzZXQ9ZnVuY3Rpb24oKXt9O3ZhciBFdD0vXihcLXxcKyk/KD86KFxkKilbLiBdKT8oXGQrKVw6KFxkKykoPzpcOihcZCspKFwuXGQqKT8pPyQvLEl0PS9eKC18XCspP1AoPzooWy0rXT9bMC05LC5dKilZKT8oPzooWy0rXT9bMC05LC5dKilNKT8oPzooWy0rXT9bMC05LC5dKilXKT8oPzooWy0rXT9bMC05LC5dKilEKT8oPzpUKD86KFstK10/WzAtOSwuXSopSCk/KD86KFstK10/WzAtOSwuXSopTSk/KD86KFstK10/WzAtOSwuXSopUyk/KT8kLztmdW5jdGlvbiBBdChlLHQpe3ZhciBuLHMsaSxyPWUsYT1udWxsO3JldHVybiBSdChlKT9yPXttczplLl9taWxsaXNlY29uZHMsZDplLl9kYXlzLE06ZS5fbW9udGhzfTpkKGUpPyhyPXt9LHQ/clt0XT1lOnIubWlsbGlzZWNvbmRzPWUpOihhPUV0LmV4ZWMoZSkpPyhuPSItIj09PWFbMV0/LTE6MSxyPXt5OjAsZDprKGFbeWVdKSpuLGg6ayhhW2dlXSkqbixtOmsoYVtwZV0pKm4sczprKGFbdmVdKSpuLG1zOmsoQ3QoMWUzKmFbd2VdKSkqbn0pOihhPUl0LmV4ZWMoZSkpPyhuPSItIj09PWFbMV0/LTE6KGFbMV0sMSkscj17eTpqdChhWzJdLG4pLE06anQoYVszXSxuKSx3Omp0KGFbNF0sbiksZDpqdChhWzVdLG4pLGg6anQoYVs2XSxuKSxtOmp0KGFbN10sbiksczpqdChhWzhdLG4pfSk6bnVsbD09cj9yPXt9OiJvYmplY3QiPT10eXBlb2YgciYmKCJmcm9tImluIHJ8fCJ0byJpbiByKSYmKGk9ZnVuY3Rpb24oZSx0KXt2YXIgbjtpZighZS5pc1ZhbGlkKCl8fCF0LmlzVmFsaWQoKSlyZXR1cm57bWlsbGlzZWNvbmRzOjAsbW9udGhzOjB9O3Q9TnQodCxlKSxlLmlzQmVmb3JlKHQpP249WnQoZSx0KTooKG49WnQodCxlKSkubWlsbGlzZWNvbmRzPS1uLm1pbGxpc2Vjb25kcyxuLm1vbnRocz0tbi5tb250aHMpO3JldHVybiBufShUdChyLmZyb20pLFR0KHIudG8pKSwocj17fSkubXM9aS5taWxsaXNlY29uZHMsci5NPWkubW9udGhzKSxzPW5ldyBIdChyKSxSdChlKSYmbShlLCJfbG9jYWxlIikmJihzLl9sb2NhbGU9ZS5fbG9jYWxlKSxzfWZ1bmN0aW9uIGp0KGUsdCl7dmFyIG49ZSYmcGFyc2VGbG9hdChlLnJlcGxhY2UoIiwiLCIuIikpO3JldHVybihpc05hTihuKT8wOm4pKnR9ZnVuY3Rpb24gWnQoZSx0KXt2YXIgbj17bWlsbGlzZWNvbmRzOjAsbW9udGhzOjB9O3JldHVybiBuLm1vbnRocz10Lm1vbnRoKCktZS5tb250aCgpKzEyKih0LnllYXIoKS1lLnllYXIoKSksZS5jbG9uZSgpLmFkZChuLm1vbnRocywiTSIpLmlzQWZ0ZXIodCkmJi0tbi5tb250aHMsbi5taWxsaXNlY29uZHM9K3QtK2UuY2xvbmUoKS5hZGQobi5tb250aHMsIk0iKSxufWZ1bmN0aW9uIHp0KHMsaSl7cmV0dXJuIGZ1bmN0aW9uKGUsdCl7dmFyIG47cmV0dXJuIG51bGw9PT10fHxpc05hTigrdCl8fChUKGksIm1vbWVudCgpLiIraSsiKHBlcmlvZCwgbnVtYmVyKSBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIG1vbWVudCgpLiIraSsiKG51bWJlciwgcGVyaW9kKS4gU2VlIGh0dHA6Ly9tb21lbnRqcy5jb20vZ3VpZGVzLyMvd2FybmluZ3MvYWRkLWludmVydGVkLXBhcmFtLyBmb3IgbW9yZSBpbmZvLiIpLG49ZSxlPXQsdD1uKSwkdCh0aGlzLEF0KGU9InN0cmluZyI9PXR5cGVvZiBlPytlOmUsdCkscyksdGhpc319ZnVuY3Rpb24gJHQoZSx0LG4scyl7dmFyIGk9dC5fbWlsbGlzZWNvbmRzLHI9Q3QodC5fZGF5cyksYT1DdCh0Ll9tb250aHMpO2UuaXNWYWxpZCgpJiYocz1udWxsPT1zfHxzLGEmJkNlKGUseGUoZSwiTW9udGgiKSthKm4pLHImJmJlKGUsIkRhdGUiLHhlKGUsIkRhdGUiKStyKm4pLGkmJmUuX2Quc2V0VGltZShlLl9kLnZhbHVlT2YoKStpKm4pLHMmJmMudXBkYXRlT2Zmc2V0KGUscnx8YSkpfUF0LmZuPUh0LnByb3RvdHlwZSxBdC5pbnZhbGlkPWZ1bmN0aW9uKCl7cmV0dXJuIEF0KE5hTil9O3ZhciBxdD16dCgxLCJhZGQiKSxKdD16dCgtMSwic3VidHJhY3QiKTtmdW5jdGlvbiBCdChlLHQpe3ZhciBuPTEyKih0LnllYXIoKS1lLnllYXIoKSkrKHQubW9udGgoKS1lLm1vbnRoKCkpLHM9ZS5jbG9uZSgpLmFkZChuLCJtb250aHMiKTtyZXR1cm4tKG4rKHQtczwwPyh0LXMpLyhzLWUuY2xvbmUoKS5hZGQobi0xLCJtb250aHMiKSk6KHQtcykvKGUuY2xvbmUoKS5hZGQobisxLCJtb250aHMiKS1zKSkpfHwwfWZ1bmN0aW9uIFF0KGUpe3ZhciB0O3JldHVybiB2b2lkIDA9PT1lP3RoaXMuX2xvY2FsZS5fYWJicjoobnVsbCE9KHQ9bHQoZSkpJiYodGhpcy5fbG9jYWxlPXQpLHRoaXMpfWMuZGVmYXVsdEZvcm1hdD0iWVlZWS1NTS1ERFRISDptbTpzc1oiLGMuZGVmYXVsdEZvcm1hdFV0Yz0iWVlZWS1NTS1ERFRISDptbTpzc1taXSI7dmFyIFh0PW4oIm1vbWVudCgpLmxhbmcoKSBpcyBkZXByZWNhdGVkLiBJbnN0ZWFkLCB1c2UgbW9tZW50KCkubG9jYWxlRGF0YSgpIHRvIGdldCB0aGUgbGFuZ3VhZ2UgY29uZmlndXJhdGlvbi4gVXNlIG1vbWVudCgpLmxvY2FsZSgpIHRvIGNoYW5nZSBsYW5ndWFnZXMuIixmdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZT90aGlzLmxvY2FsZURhdGEoKTp0aGlzLmxvY2FsZShlKX0pO2Z1bmN0aW9uIEt0KCl7cmV0dXJuIHRoaXMuX2xvY2FsZX1mdW5jdGlvbiBlbihlLHQpe0koMCxbZSxlLmxlbmd0aF0sMCx0KX1mdW5jdGlvbiB0bihlLHQsbixzLGkpe3ZhciByO3JldHVybiBudWxsPT1lP0llKHRoaXMscyxpKS55ZWFyOigocj1BZShlLHMsaSkpPHQmJih0PXIpLGZ1bmN0aW9uKGUsdCxuLHMsaSl7dmFyIHI9RWUoZSx0LG4scyxpKSxhPUdlKHIueWVhciwwLHIuZGF5T2ZZZWFyKTtyZXR1cm4gdGhpcy55ZWFyKGEuZ2V0VVRDRnVsbFllYXIoKSksdGhpcy5tb250aChhLmdldFVUQ01vbnRoKCkpLHRoaXMuZGF0ZShhLmdldFVUQ0RhdGUoKSksdGhpc30uY2FsbCh0aGlzLGUsdCxuLHMsaSkpfUkoMCxbImdnIiwyXSwwLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMud2Vla1llYXIoKSUxMDB9KSxJKDAsWyJHRyIsMl0sMCxmdW5jdGlvbigpe3JldHVybiB0aGlzLmlzb1dlZWtZZWFyKCklMTAwfSksZW4oImdnZ2ciLCJ3ZWVrWWVhciIpLGVuKCJnZ2dnZyIsIndlZWtZZWFyIiksZW4oIkdHR0ciLCJpc29XZWVrWWVhciIpLGVuKCJHR0dHRyIsImlzb1dlZWtZZWFyIiksSCgid2Vla1llYXIiLCJnZyIpLEgoImlzb1dlZWtZZWFyIiwiR0ciKSxMKCJ3ZWVrWWVhciIsMSksTCgiaXNvV2Vla1llYXIiLDEpLHVlKCJHIixzZSksdWUoImciLHNlKSx1ZSgiR0ciLEIseiksdWUoImdnIixCLHopLHVlKCJHR0dHIixlZSxxKSx1ZSgiZ2dnZyIsZWUscSksdWUoIkdHR0dHIix0ZSxKKSx1ZSgiZ2dnZ2ciLHRlLEopLGZlKFsiZ2dnZyIsImdnZ2dnIiwiR0dHRyIsIkdHR0dHIl0sZnVuY3Rpb24oZSx0LG4scyl7dFtzLnN1YnN0cigwLDIpXT1rKGUpfSksZmUoWyJnZyIsIkdHIl0sZnVuY3Rpb24oZSx0LG4scyl7dFtzXT1jLnBhcnNlVHdvRGlnaXRZZWFyKGUpfSksSSgiUSIsMCwiUW8iLCJxdWFydGVyIiksSCgicXVhcnRlciIsIlEiKSxMKCJxdWFydGVyIiw3KSx1ZSgiUSIsWiksY2UoIlEiLGZ1bmN0aW9uKGUsdCl7dFtfZV09MyooayhlKS0xKX0pLEkoIkQiLFsiREQiLDJdLCJEbyIsImRhdGUiKSxIKCJkYXRlIiwiRCIpLEwoImRhdGUiLDkpLHVlKCJEIixCKSx1ZSgiREQiLEIseiksdWUoIkRvIixmdW5jdGlvbihlLHQpe3JldHVybiBlP3QuX2RheU9mTW9udGhPcmRpbmFsUGFyc2V8fHQuX29yZGluYWxQYXJzZTp0Ll9kYXlPZk1vbnRoT3JkaW5hbFBhcnNlTGVuaWVudH0pLGNlKFsiRCIsIkREIl0seWUpLGNlKCJEbyIsZnVuY3Rpb24oZSx0KXt0W3llXT1rKGUubWF0Y2goQilbMF0pfSk7dmFyIG5uPVRlKCJEYXRlIiwhMCk7SSgiREREIixbIkREREQiLDNdLCJERERvIiwiZGF5T2ZZZWFyIiksSCgiZGF5T2ZZZWFyIiwiREREIiksTCgiZGF5T2ZZZWFyIiw0KSx1ZSgiREREIixLKSx1ZSgiRERERCIsJCksY2UoWyJEREQiLCJEREREIl0sZnVuY3Rpb24oZSx0LG4pe24uX2RheU9mWWVhcj1rKGUpfSksSSgibSIsWyJtbSIsMl0sMCwibWludXRlIiksSCgibWludXRlIiwibSIpLEwoIm1pbnV0ZSIsMTQpLHVlKCJtIixCKSx1ZSgibW0iLEIseiksY2UoWyJtIiwibW0iXSxwZSk7dmFyIHNuPVRlKCJNaW51dGVzIiwhMSk7SSgicyIsWyJzcyIsMl0sMCwic2Vjb25kIiksSCgic2Vjb25kIiwicyIpLEwoInNlY29uZCIsMTUpLHVlKCJzIixCKSx1ZSgic3MiLEIseiksY2UoWyJzIiwic3MiXSx2ZSk7dmFyIHJuLGFuPVRlKCJTZWNvbmRzIiwhMSk7Zm9yKEkoIlMiLDAsMCxmdW5jdGlvbigpe3JldHVybn5+KHRoaXMubWlsbGlzZWNvbmQoKS8xMDApfSksSSgwLFsiU1MiLDJdLDAsZnVuY3Rpb24oKXtyZXR1cm5+fih0aGlzLm1pbGxpc2Vjb25kKCkvMTApfSksSSgwLFsiU1NTIiwzXSwwLCJtaWxsaXNlY29uZCIpLEkoMCxbIlNTU1MiLDRdLDAsZnVuY3Rpb24oKXtyZXR1cm4gMTAqdGhpcy5taWxsaXNlY29uZCgpfSksSSgwLFsiU1NTU1MiLDVdLDAsZnVuY3Rpb24oKXtyZXR1cm4gMTAwKnRoaXMubWlsbGlzZWNvbmQoKX0pLEkoMCxbIlNTU1NTUyIsNl0sMCxmdW5jdGlvbigpe3JldHVybiAxZTMqdGhpcy5taWxsaXNlY29uZCgpfSksSSgwLFsiU1NTU1NTUyIsN10sMCxmdW5jdGlvbigpe3JldHVybiAxZTQqdGhpcy5taWxsaXNlY29uZCgpfSksSSgwLFsiU1NTU1NTU1MiLDhdLDAsZnVuY3Rpb24oKXtyZXR1cm4gMWU1KnRoaXMubWlsbGlzZWNvbmQoKX0pLEkoMCxbIlNTU1NTU1NTUyIsOV0sMCxmdW5jdGlvbigpe3JldHVybiAxZTYqdGhpcy5taWxsaXNlY29uZCgpfSksSCgibWlsbGlzZWNvbmQiLCJtcyIpLEwoIm1pbGxpc2Vjb25kIiwxNiksdWUoIlMiLEssWiksdWUoIlNTIixLLHopLHVlKCJTU1MiLEssJCkscm49IlNTU1MiO3JuLmxlbmd0aDw9OTtybis9IlMiKXVlKHJuLG5lKTtmdW5jdGlvbiBvbihlLHQpe3Rbd2VdPWsoMWUzKigiMC4iK2UpKX1mb3Iocm49IlMiO3JuLmxlbmd0aDw9OTtybis9IlMiKWNlKHJuLG9uKTt2YXIgdW49VGUoIk1pbGxpc2Vjb25kcyIsITEpO0koInoiLDAsMCwiem9uZUFiYnIiKSxJKCJ6eiIsMCwwLCJ6b25lTmFtZSIpO3ZhciBsbj1NLnByb3RvdHlwZTtmdW5jdGlvbiBkbihlKXtyZXR1cm4gZX1sbi5hZGQ9cXQsbG4uY2FsZW5kYXI9ZnVuY3Rpb24oZSx0KXt2YXIgbj1lfHxUdCgpLHM9TnQobix0aGlzKS5zdGFydE9mKCJkYXkiKSxpPWMuY2FsZW5kYXJGb3JtYXQodGhpcyxzKXx8InNhbWVFbHNlIixyPXQmJih4KHRbaV0pP3RbaV0uY2FsbCh0aGlzLG4pOnRbaV0pO3JldHVybiB0aGlzLmZvcm1hdChyfHx0aGlzLmxvY2FsZURhdGEoKS5jYWxlbmRhcihpLHRoaXMsVHQobikpKX0sbG4uY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IE0odGhpcyl9LGxuLmRpZmY9ZnVuY3Rpb24oZSx0LG4pe3ZhciBzLGkscjtpZighdGhpcy5pc1ZhbGlkKCkpcmV0dXJuIE5hTjtpZighKHM9TnQoZSx0aGlzKSkuaXNWYWxpZCgpKXJldHVybiBOYU47c3dpdGNoKGk9NmU0KihzLnV0Y09mZnNldCgpLXRoaXMudXRjT2Zmc2V0KCkpLHQ9Uih0KSl7Y2FzZSJ5ZWFyIjpyPUJ0KHRoaXMscykvMTI7YnJlYWs7Y2FzZSJtb250aCI6cj1CdCh0aGlzLHMpO2JyZWFrO2Nhc2UicXVhcnRlciI6cj1CdCh0aGlzLHMpLzM7YnJlYWs7Y2FzZSJzZWNvbmQiOnI9KHRoaXMtcykvMWUzO2JyZWFrO2Nhc2UibWludXRlIjpyPSh0aGlzLXMpLzZlNDticmVhaztjYXNlImhvdXIiOnI9KHRoaXMtcykvMzZlNTticmVhaztjYXNlImRheSI6cj0odGhpcy1zLWkpLzg2NGU1O2JyZWFrO2Nhc2Uid2VlayI6cj0odGhpcy1zLWkpLzYwNDhlNTticmVhaztkZWZhdWx0OnI9dGhpcy1zfXJldHVybiBuP3I6RChyKX0sbG4uZW5kT2Y9ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMD09PShlPVIoZSkpfHwibWlsbGlzZWNvbmQiPT09ZT90aGlzOigiZGF0ZSI9PT1lJiYoZT0iZGF5IiksdGhpcy5zdGFydE9mKGUpLmFkZCgxLCJpc29XZWVrIj09PWU/IndlZWsiOmUpLnN1YnRyYWN0KDEsIm1zIikpfSxsbi5mb3JtYXQ9ZnVuY3Rpb24oZSl7ZXx8KGU9dGhpcy5pc1V0YygpP2MuZGVmYXVsdEZvcm1hdFV0YzpjLmRlZmF1bHRGb3JtYXQpO3ZhciB0PUEodGhpcyxlKTtyZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkucG9zdGZvcm1hdCh0KX0sbG4uZnJvbT1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmlzVmFsaWQoKSYmKFMoZSkmJmUuaXNWYWxpZCgpfHxUdChlKS5pc1ZhbGlkKCkpP0F0KHt0bzp0aGlzLGZyb206ZX0pLmxvY2FsZSh0aGlzLmxvY2FsZSgpKS5odW1hbml6ZSghdCk6dGhpcy5sb2NhbGVEYXRhKCkuaW52YWxpZERhdGUoKX0sbG4uZnJvbU5vdz1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5mcm9tKFR0KCksZSl9LGxuLnRvPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuaXNWYWxpZCgpJiYoUyhlKSYmZS5pc1ZhbGlkKCl8fFR0KGUpLmlzVmFsaWQoKSk/QXQoe2Zyb206dGhpcyx0bzplfSkubG9jYWxlKHRoaXMubG9jYWxlKCkpLmh1bWFuaXplKCF0KTp0aGlzLmxvY2FsZURhdGEoKS5pbnZhbGlkRGF0ZSgpfSxsbi50b05vdz1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy50byhUdCgpLGUpfSxsbi5nZXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIHgodGhpc1tlPVIoZSldKT90aGlzW2VdKCk6dGhpc30sbG4uaW52YWxpZEF0PWZ1bmN0aW9uKCl7cmV0dXJuIGcodGhpcykub3ZlcmZsb3d9LGxuLmlzQWZ0ZXI9ZnVuY3Rpb24oZSx0KXt2YXIgbj1TKGUpP2U6VHQoZSk7cmV0dXJuISghdGhpcy5pc1ZhbGlkKCl8fCFuLmlzVmFsaWQoKSkmJigibWlsbGlzZWNvbmQiPT09KHQ9UihsKHQpPyJtaWxsaXNlY29uZCI6dCkpP3RoaXMudmFsdWVPZigpPm4udmFsdWVPZigpOm4udmFsdWVPZigpPHRoaXMuY2xvbmUoKS5zdGFydE9mKHQpLnZhbHVlT2YoKSl9LGxuLmlzQmVmb3JlPWZ1bmN0aW9uKGUsdCl7dmFyIG49UyhlKT9lOlR0KGUpO3JldHVybiEoIXRoaXMuaXNWYWxpZCgpfHwhbi5pc1ZhbGlkKCkpJiYoIm1pbGxpc2Vjb25kIj09PSh0PVIobCh0KT8ibWlsbGlzZWNvbmQiOnQpKT90aGlzLnZhbHVlT2YoKTxuLnZhbHVlT2YoKTp0aGlzLmNsb25lKCkuZW5kT2YodCkudmFsdWVPZigpPG4udmFsdWVPZigpKX0sbG4uaXNCZXR3ZWVuPWZ1bmN0aW9uKGUsdCxuLHMpe3JldHVybigiKCI9PT0ocz1zfHwiKCkiKVswXT90aGlzLmlzQWZ0ZXIoZSxuKTohdGhpcy5pc0JlZm9yZShlLG4pKSYmKCIpIj09PXNbMV0/dGhpcy5pc0JlZm9yZSh0LG4pOiF0aGlzLmlzQWZ0ZXIodCxuKSl9LGxuLmlzU2FtZT1mdW5jdGlvbihlLHQpe3ZhciBuLHM9UyhlKT9lOlR0KGUpO3JldHVybiEoIXRoaXMuaXNWYWxpZCgpfHwhcy5pc1ZhbGlkKCkpJiYoIm1pbGxpc2Vjb25kIj09PSh0PVIodHx8Im1pbGxpc2Vjb25kIikpP3RoaXMudmFsdWVPZigpPT09cy52YWx1ZU9mKCk6KG49cy52YWx1ZU9mKCksdGhpcy5jbG9uZSgpLnN0YXJ0T2YodCkudmFsdWVPZigpPD1uJiZuPD10aGlzLmNsb25lKCkuZW5kT2YodCkudmFsdWVPZigpKSl9LGxuLmlzU2FtZU9yQWZ0ZXI9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5pc1NhbWUoZSx0KXx8dGhpcy5pc0FmdGVyKGUsdCl9LGxuLmlzU2FtZU9yQmVmb3JlPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuaXNTYW1lKGUsdCl8fHRoaXMuaXNCZWZvcmUoZSx0KX0sbG4uaXNWYWxpZD1mdW5jdGlvbigpe3JldHVybiBwKHRoaXMpfSxsbi5sYW5nPVh0LGxuLmxvY2FsZT1RdCxsbi5sb2NhbGVEYXRhPUt0LGxuLm1heD1idCxsbi5taW49eHQsbG4ucGFyc2luZ0ZsYWdzPWZ1bmN0aW9uKCl7cmV0dXJuIF8oe30sZyh0aGlzKSl9LGxuLnNldD1mdW5jdGlvbihlLHQpe2lmKCJvYmplY3QiPT10eXBlb2YgZSlmb3IodmFyIG49ZnVuY3Rpb24oZSl7dmFyIHQ9W107Zm9yKHZhciBuIGluIGUpdC5wdXNoKHt1bml0Om4scHJpb3JpdHk6RltuXX0pO3JldHVybiB0LnNvcnQoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5wcmlvcml0eS10LnByaW9yaXR5fSksdH0oZT1DKGUpKSxzPTA7czxuLmxlbmd0aDtzKyspdGhpc1tuW3NdLnVuaXRdKGVbbltzXS51bml0XSk7ZWxzZSBpZih4KHRoaXNbZT1SKGUpXSkpcmV0dXJuIHRoaXNbZV0odCk7cmV0dXJuIHRoaXN9LGxuLnN0YXJ0T2Y9ZnVuY3Rpb24oZSl7c3dpdGNoKGU9UihlKSl7Y2FzZSJ5ZWFyIjp0aGlzLm1vbnRoKDApO2Nhc2UicXVhcnRlciI6Y2FzZSJtb250aCI6dGhpcy5kYXRlKDEpO2Nhc2Uid2VlayI6Y2FzZSJpc29XZWVrIjpjYXNlImRheSI6Y2FzZSJkYXRlIjp0aGlzLmhvdXJzKDApO2Nhc2UiaG91ciI6dGhpcy5taW51dGVzKDApO2Nhc2UibWludXRlIjp0aGlzLnNlY29uZHMoMCk7Y2FzZSJzZWNvbmQiOnRoaXMubWlsbGlzZWNvbmRzKDApfXJldHVybiJ3ZWVrIj09PWUmJnRoaXMud2Vla2RheSgwKSwiaXNvV2VlayI9PT1lJiZ0aGlzLmlzb1dlZWtkYXkoMSksInF1YXJ0ZXIiPT09ZSYmdGhpcy5tb250aCgzKk1hdGguZmxvb3IodGhpcy5tb250aCgpLzMpKSx0aGlzfSxsbi5zdWJ0cmFjdD1KdCxsbi50b0FycmF5PWZ1bmN0aW9uKCl7dmFyIGU9dGhpcztyZXR1cm5bZS55ZWFyKCksZS5tb250aCgpLGUuZGF0ZSgpLGUuaG91cigpLGUubWludXRlKCksZS5zZWNvbmQoKSxlLm1pbGxpc2Vjb25kKCldfSxsbi50b09iamVjdD1mdW5jdGlvbigpe3ZhciBlPXRoaXM7cmV0dXJue3llYXJzOmUueWVhcigpLG1vbnRoczplLm1vbnRoKCksZGF0ZTplLmRhdGUoKSxob3VyczplLmhvdXJzKCksbWludXRlczplLm1pbnV0ZXMoKSxzZWNvbmRzOmUuc2Vjb25kcygpLG1pbGxpc2Vjb25kczplLm1pbGxpc2Vjb25kcygpfX0sbG4udG9EYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBEYXRlKHRoaXMudmFsdWVPZigpKX0sbG4udG9JU09TdHJpbmc9ZnVuY3Rpb24oZSl7aWYoIXRoaXMuaXNWYWxpZCgpKXJldHVybiBudWxsO3ZhciB0PSEwIT09ZSxuPXQ/dGhpcy5jbG9uZSgpLnV0YygpOnRoaXM7cmV0dXJuIG4ueWVhcigpPDB8fDk5OTk8bi55ZWFyKCk/QShuLHQ/IllZWVlZWS1NTS1ERFtUXUhIOm1tOnNzLlNTU1taXSI6IllZWVlZWS1NTS1ERFtUXUhIOm1tOnNzLlNTU1oiKTp4KERhdGUucHJvdG90eXBlLnRvSVNPU3RyaW5nKT90P3RoaXMudG9EYXRlKCkudG9JU09TdHJpbmcoKTpuZXcgRGF0ZSh0aGlzLnZhbHVlT2YoKSs2MCp0aGlzLnV0Y09mZnNldCgpKjFlMykudG9JU09TdHJpbmcoKS5yZXBsYWNlKCJaIixBKG4sIloiKSk6QShuLHQ/IllZWVktTU0tRERbVF1ISDptbTpzcy5TU1NbWl0iOiJZWVlZLU1NLUREW1RdSEg6bW06c3MuU1NTWiIpfSxsbi5pbnNwZWN0PWZ1bmN0aW9uKCl7aWYoIXRoaXMuaXNWYWxpZCgpKXJldHVybiJtb21lbnQuaW52YWxpZCgvKiAiK3RoaXMuX2krIiAqLykiO3ZhciBlPSJtb21lbnQiLHQ9IiI7dGhpcy5pc0xvY2FsKCl8fChlPTA9PT10aGlzLnV0Y09mZnNldCgpPyJtb21lbnQudXRjIjoibW9tZW50LnBhcnNlWm9uZSIsdD0iWiIpO3ZhciBuPSJbIitlKycoIl0nLHM9MDw9dGhpcy55ZWFyKCkmJnRoaXMueWVhcigpPD05OTk5PyJZWVlZIjoiWVlZWVlZIixpPXQrJ1siKV0nO3JldHVybiB0aGlzLmZvcm1hdChuK3MrIi1NTS1ERFtUXUhIOm1tOnNzLlNTUyIraSl9LGxuLnRvSlNPTj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlzVmFsaWQoKT90aGlzLnRvSVNPU3RyaW5nKCk6bnVsbH0sbG4udG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jbG9uZSgpLmxvY2FsZSgiZW4iKS5mb3JtYXQoImRkZCBNTU0gREQgWVlZWSBISDptbTpzcyBbR01UXVpaIil9LGxuLnVuaXg9ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5mbG9vcih0aGlzLnZhbHVlT2YoKS8xZTMpfSxsbi52YWx1ZU9mPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2QudmFsdWVPZigpLTZlNCoodGhpcy5fb2Zmc2V0fHwwKX0sbG4uY3JlYXRpb25EYXRhPWZ1bmN0aW9uKCl7cmV0dXJue2lucHV0OnRoaXMuX2ksZm9ybWF0OnRoaXMuX2YsbG9jYWxlOnRoaXMuX2xvY2FsZSxpc1VUQzp0aGlzLl9pc1VUQyxzdHJpY3Q6dGhpcy5fc3RyaWN0fX0sbG4ueWVhcj1PZSxsbi5pc0xlYXBZZWFyPWZ1bmN0aW9uKCl7cmV0dXJuIGtlKHRoaXMueWVhcigpKX0sbG4ud2Vla1llYXI9ZnVuY3Rpb24oZSl7cmV0dXJuIHRuLmNhbGwodGhpcyxlLHRoaXMud2VlaygpLHRoaXMud2Vla2RheSgpLHRoaXMubG9jYWxlRGF0YSgpLl93ZWVrLmRvdyx0aGlzLmxvY2FsZURhdGEoKS5fd2Vlay5kb3kpfSxsbi5pc29XZWVrWWVhcj1mdW5jdGlvbihlKXtyZXR1cm4gdG4uY2FsbCh0aGlzLGUsdGhpcy5pc29XZWVrKCksdGhpcy5pc29XZWVrZGF5KCksMSw0KX0sbG4ucXVhcnRlcj1sbi5xdWFydGVycz1mdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09ZT9NYXRoLmNlaWwoKHRoaXMubW9udGgoKSsxKS8zKTp0aGlzLm1vbnRoKDMqKGUtMSkrdGhpcy5tb250aCgpJTMpfSxsbi5tb250aD1GZSxsbi5kYXlzSW5Nb250aD1mdW5jdGlvbigpe3JldHVybiBQZSh0aGlzLnllYXIoKSx0aGlzLm1vbnRoKCkpfSxsbi53ZWVrPWxuLndlZWtzPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMubG9jYWxlRGF0YSgpLndlZWsodGhpcyk7cmV0dXJuIG51bGw9PWU/dDp0aGlzLmFkZCg3KihlLXQpLCJkIil9LGxuLmlzb1dlZWs9bG4uaXNvV2Vla3M9ZnVuY3Rpb24oZSl7dmFyIHQ9SWUodGhpcywxLDQpLndlZWs7cmV0dXJuIG51bGw9PWU/dDp0aGlzLmFkZCg3KihlLXQpLCJkIil9LGxuLndlZWtzSW5ZZWFyPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5sb2NhbGVEYXRhKCkuX3dlZWs7cmV0dXJuIEFlKHRoaXMueWVhcigpLGUuZG93LGUuZG95KX0sbG4uaXNvV2Vla3NJblllYXI9ZnVuY3Rpb24oKXtyZXR1cm4gQWUodGhpcy55ZWFyKCksMSw0KX0sbG4uZGF0ZT1ubixsbi5kYXk9bG4uZGF5cz1mdW5jdGlvbihlKXtpZighdGhpcy5pc1ZhbGlkKCkpcmV0dXJuIG51bGwhPWU/dGhpczpOYU47dmFyIHQsbixzPXRoaXMuX2lzVVRDP3RoaXMuX2QuZ2V0VVRDRGF5KCk6dGhpcy5fZC5nZXREYXkoKTtyZXR1cm4gbnVsbCE9ZT8odD1lLG49dGhpcy5sb2NhbGVEYXRhKCksZT0ic3RyaW5nIiE9dHlwZW9mIHQ/dDppc05hTih0KT8ibnVtYmVyIj09dHlwZW9mKHQ9bi53ZWVrZGF5c1BhcnNlKHQpKT90Om51bGw6cGFyc2VJbnQodCwxMCksdGhpcy5hZGQoZS1zLCJkIikpOnN9LGxuLndlZWtkYXk9ZnVuY3Rpb24oZSl7aWYoIXRoaXMuaXNWYWxpZCgpKXJldHVybiBudWxsIT1lP3RoaXM6TmFOO3ZhciB0PSh0aGlzLmRheSgpKzctdGhpcy5sb2NhbGVEYXRhKCkuX3dlZWsuZG93KSU3O3JldHVybiBudWxsPT1lP3Q6dGhpcy5hZGQoZS10LCJkIil9LGxuLmlzb1dlZWtkYXk9ZnVuY3Rpb24oZSl7aWYoIXRoaXMuaXNWYWxpZCgpKXJldHVybiBudWxsIT1lP3RoaXM6TmFOO2lmKG51bGwhPWUpe3ZhciB0PShuPWUscz10aGlzLmxvY2FsZURhdGEoKSwic3RyaW5nIj09dHlwZW9mIG4/cy53ZWVrZGF5c1BhcnNlKG4pJTd8fDc6aXNOYU4obik/bnVsbDpuKTtyZXR1cm4gdGhpcy5kYXkodGhpcy5kYXkoKSU3P3Q6dC03KX1yZXR1cm4gdGhpcy5kYXkoKXx8Nzt2YXIgbixzfSxsbi5kYXlPZlllYXI9ZnVuY3Rpb24oZSl7dmFyIHQ9TWF0aC5yb3VuZCgodGhpcy5jbG9uZSgpLnN0YXJ0T2YoImRheSIpLXRoaXMuY2xvbmUoKS5zdGFydE9mKCJ5ZWFyIikpLzg2NGU1KSsxO3JldHVybiBudWxsPT1lP3Q6dGhpcy5hZGQoZS10LCJkIil9LGxuLmhvdXI9bG4uaG91cnM9dHQsbG4ubWludXRlPWxuLm1pbnV0ZXM9c24sbG4uc2Vjb25kPWxuLnNlY29uZHM9YW4sbG4ubWlsbGlzZWNvbmQ9bG4ubWlsbGlzZWNvbmRzPXVuLGxuLnV0Y09mZnNldD1mdW5jdGlvbihlLHQsbil7dmFyIHMsaT10aGlzLl9vZmZzZXR8fDA7aWYoIXRoaXMuaXNWYWxpZCgpKXJldHVybiBudWxsIT1lP3RoaXM6TmFOO2lmKG51bGwhPWUpe2lmKCJzdHJpbmciPT10eXBlb2YgZSl7aWYobnVsbD09PShlPVV0KHJlLGUpKSlyZXR1cm4gdGhpc31lbHNlIE1hdGguYWJzKGUpPDE2JiYhbiYmKGUqPTYwKTtyZXR1cm4hdGhpcy5faXNVVEMmJnQmJihzPUd0KHRoaXMpKSx0aGlzLl9vZmZzZXQ9ZSx0aGlzLl9pc1VUQz0hMCxudWxsIT1zJiZ0aGlzLmFkZChzLCJtIiksaSE9PWUmJighdHx8dGhpcy5fY2hhbmdlSW5Qcm9ncmVzcz8kdCh0aGlzLEF0KGUtaSwibSIpLDEsITEpOnRoaXMuX2NoYW5nZUluUHJvZ3Jlc3N8fCh0aGlzLl9jaGFuZ2VJblByb2dyZXNzPSEwLGMudXBkYXRlT2Zmc2V0KHRoaXMsITApLHRoaXMuX2NoYW5nZUluUHJvZ3Jlc3M9bnVsbCkpLHRoaXN9cmV0dXJuIHRoaXMuX2lzVVRDP2k6R3QodGhpcyl9LGxuLnV0Yz1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy51dGNPZmZzZXQoMCxlKX0sbG4ubG9jYWw9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2lzVVRDJiYodGhpcy51dGNPZmZzZXQoMCxlKSx0aGlzLl9pc1VUQz0hMSxlJiZ0aGlzLnN1YnRyYWN0KEd0KHRoaXMpLCJtIikpLHRoaXN9LGxuLnBhcnNlWm9uZT1mdW5jdGlvbigpe2lmKG51bGwhPXRoaXMuX3R6bSl0aGlzLnV0Y09mZnNldCh0aGlzLl90em0sITEsITApO2Vsc2UgaWYoInN0cmluZyI9PXR5cGVvZiB0aGlzLl9pKXt2YXIgZT1VdChpZSx0aGlzLl9pKTtudWxsIT1lP3RoaXMudXRjT2Zmc2V0KGUpOnRoaXMudXRjT2Zmc2V0KDAsITApfXJldHVybiB0aGlzfSxsbi5oYXNBbGlnbmVkSG91ck9mZnNldD1mdW5jdGlvbihlKXtyZXR1cm4hIXRoaXMuaXNWYWxpZCgpJiYoZT1lP1R0KGUpLnV0Y09mZnNldCgpOjAsKHRoaXMudXRjT2Zmc2V0KCktZSklNjA9PTApfSxsbi5pc0RTVD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnV0Y09mZnNldCgpPnRoaXMuY2xvbmUoKS5tb250aCgwKS51dGNPZmZzZXQoKXx8dGhpcy51dGNPZmZzZXQoKT50aGlzLmNsb25lKCkubW9udGgoNSkudXRjT2Zmc2V0KCl9LGxuLmlzTG9jYWw9ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMuaXNWYWxpZCgpJiYhdGhpcy5faXNVVEN9LGxuLmlzVXRjT2Zmc2V0PWZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLmlzVmFsaWQoKSYmdGhpcy5faXNVVEN9LGxuLmlzVXRjPVZ0LGxuLmlzVVRDPVZ0LGxuLnpvbmVBYmJyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzVVRDPyJVVEMiOiIifSxsbi56b25lTmFtZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc1VUQz8iQ29vcmRpbmF0ZWQgVW5pdmVyc2FsIFRpbWUiOiIifSxsbi5kYXRlcz1uKCJkYXRlcyBhY2Nlc3NvciBpcyBkZXByZWNhdGVkLiBVc2UgZGF0ZSBpbnN0ZWFkLiIsbm4pLGxuLm1vbnRocz1uKCJtb250aHMgYWNjZXNzb3IgaXMgZGVwcmVjYXRlZC4gVXNlIG1vbnRoIGluc3RlYWQiLEZlKSxsbi55ZWFycz1uKCJ5ZWFycyBhY2Nlc3NvciBpcyBkZXByZWNhdGVkLiBVc2UgeWVhciBpbnN0ZWFkIixPZSksbG4uem9uZT1uKCJtb21lbnQoKS56b25lIGlzIGRlcHJlY2F0ZWQsIHVzZSBtb21lbnQoKS51dGNPZmZzZXQgaW5zdGVhZC4gaHR0cDovL21vbWVudGpzLmNvbS9ndWlkZXMvIy93YXJuaW5ncy96b25lLyIsZnVuY3Rpb24oZSx0KXtyZXR1cm4gbnVsbCE9ZT8oInN0cmluZyIhPXR5cGVvZiBlJiYoZT0tZSksdGhpcy51dGNPZmZzZXQoZSx0KSx0aGlzKTotdGhpcy51dGNPZmZzZXQoKX0pLGxuLmlzRFNUU2hpZnRlZD1uKCJpc0RTVFNoaWZ0ZWQgaXMgZGVwcmVjYXRlZC4gU2VlIGh0dHA6Ly9tb21lbnRqcy5jb20vZ3VpZGVzLyMvd2FybmluZ3MvZHN0LXNoaWZ0ZWQvIGZvciBtb3JlIGluZm9ybWF0aW9uIixmdW5jdGlvbigpe2lmKCFsKHRoaXMuX2lzRFNUU2hpZnRlZCkpcmV0dXJuIHRoaXMuX2lzRFNUU2hpZnRlZDt2YXIgZT17fTtpZih3KGUsdGhpcyksKGU9WXQoZSkpLl9hKXt2YXIgdD1lLl9pc1VUQz95KGUuX2EpOlR0KGUuX2EpO3RoaXMuX2lzRFNUU2hpZnRlZD10aGlzLmlzVmFsaWQoKSYmMDxhKGUuX2EsdC50b0FycmF5KCkpfWVsc2UgdGhpcy5faXNEU1RTaGlmdGVkPSExO3JldHVybiB0aGlzLl9pc0RTVFNoaWZ0ZWR9KTt2YXIgaG49UC5wcm90b3R5cGU7ZnVuY3Rpb24gY24oZSx0LG4scyl7dmFyIGk9bHQoKSxyPXkoKS5zZXQocyx0KTtyZXR1cm4gaVtuXShyLGUpfWZ1bmN0aW9uIGZuKGUsdCxuKXtpZihkKGUpJiYodD1lLGU9dm9pZCAwKSxlPWV8fCIiLG51bGwhPXQpcmV0dXJuIGNuKGUsdCxuLCJtb250aCIpO3ZhciBzLGk9W107Zm9yKHM9MDtzPDEyO3MrKylpW3NdPWNuKGUscyxuLCJtb250aCIpO3JldHVybiBpfWZ1bmN0aW9uIG1uKGUsdCxuLHMpeyJib29sZWFuIj09dHlwZW9mIGU/ZCh0KSYmKG49dCx0PXZvaWQgMCk6KHQ9ZSxlPSExLGQobj10KSYmKG49dCx0PXZvaWQgMCkpLHQ9dHx8IiI7dmFyIGkscj1sdCgpLGE9ZT9yLl93ZWVrLmRvdzowO2lmKG51bGwhPW4pcmV0dXJuIGNuKHQsKG4rYSklNyxzLCJkYXkiKTt2YXIgbz1bXTtmb3IoaT0wO2k8NztpKyspb1tpXT1jbih0LChpK2EpJTcscywiZGF5Iik7cmV0dXJuIG99aG4uY2FsZW5kYXI9ZnVuY3Rpb24oZSx0LG4pe3ZhciBzPXRoaXMuX2NhbGVuZGFyW2VdfHx0aGlzLl9jYWxlbmRhci5zYW1lRWxzZTtyZXR1cm4geChzKT9zLmNhbGwodCxuKTpzfSxobi5sb25nRGF0ZUZvcm1hdD1mdW5jdGlvbihlKXt2YXIgdD10aGlzLl9sb25nRGF0ZUZvcm1hdFtlXSxuPXRoaXMuX2xvbmdEYXRlRm9ybWF0W2UudG9VcHBlckNhc2UoKV07cmV0dXJuIHR8fCFuP3Q6KHRoaXMuX2xvbmdEYXRlRm9ybWF0W2VdPW4ucmVwbGFjZSgvTU1NTXxNTXxERHxkZGRkL2csZnVuY3Rpb24oZSl7cmV0dXJuIGUuc2xpY2UoMSl9KSx0aGlzLl9sb25nRGF0ZUZvcm1hdFtlXSl9LGhuLmludmFsaWREYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2ludmFsaWREYXRlfSxobi5vcmRpbmFsPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9vcmRpbmFsLnJlcGxhY2UoIiVkIixlKX0saG4ucHJlcGFyc2U9ZG4saG4ucG9zdGZvcm1hdD1kbixobi5yZWxhdGl2ZVRpbWU9ZnVuY3Rpb24oZSx0LG4scyl7dmFyIGk9dGhpcy5fcmVsYXRpdmVUaW1lW25dO3JldHVybiB4KGkpP2koZSx0LG4scyk6aS5yZXBsYWNlKC8lZC9pLGUpfSxobi5wYXN0RnV0dXJlPWZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpcy5fcmVsYXRpdmVUaW1lWzA8ZT8iZnV0dXJlIjoicGFzdCJdO3JldHVybiB4KG4pP24odCk6bi5yZXBsYWNlKC8lcy9pLHQpfSxobi5zZXQ9ZnVuY3Rpb24oZSl7dmFyIHQsbjtmb3IobiBpbiBlKXgodD1lW25dKT90aGlzW25dPXQ6dGhpc1siXyIrbl09dDt0aGlzLl9jb25maWc9ZSx0aGlzLl9kYXlPZk1vbnRoT3JkaW5hbFBhcnNlTGVuaWVudD1uZXcgUmVnRXhwKCh0aGlzLl9kYXlPZk1vbnRoT3JkaW5hbFBhcnNlLnNvdXJjZXx8dGhpcy5fb3JkaW5hbFBhcnNlLnNvdXJjZSkrInwiKy9cZHsxLDJ9Ly5zb3VyY2UpfSxobi5tb250aHM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZT9vKHRoaXMuX21vbnRocyk/dGhpcy5fbW9udGhzW2UubW9udGgoKV06dGhpcy5fbW9udGhzWyh0aGlzLl9tb250aHMuaXNGb3JtYXR8fFdlKS50ZXN0KHQpPyJmb3JtYXQiOiJzdGFuZGFsb25lIl1bZS5tb250aCgpXTpvKHRoaXMuX21vbnRocyk/dGhpcy5fbW9udGhzOnRoaXMuX21vbnRocy5zdGFuZGFsb25lfSxobi5tb250aHNTaG9ydD1mdW5jdGlvbihlLHQpe3JldHVybiBlP28odGhpcy5fbW9udGhzU2hvcnQpP3RoaXMuX21vbnRoc1Nob3J0W2UubW9udGgoKV06dGhpcy5fbW9udGhzU2hvcnRbV2UudGVzdCh0KT8iZm9ybWF0Ijoic3RhbmRhbG9uZSJdW2UubW9udGgoKV06byh0aGlzLl9tb250aHNTaG9ydCk/dGhpcy5fbW9udGhzU2hvcnQ6dGhpcy5fbW9udGhzU2hvcnQuc3RhbmRhbG9uZX0saG4ubW9udGhzUGFyc2U9ZnVuY3Rpb24oZSx0LG4pe3ZhciBzLGkscjtpZih0aGlzLl9tb250aHNQYXJzZUV4YWN0KXJldHVybiBmdW5jdGlvbihlLHQsbil7dmFyIHMsaSxyLGE9ZS50b0xvY2FsZUxvd2VyQ2FzZSgpO2lmKCF0aGlzLl9tb250aHNQYXJzZSlmb3IodGhpcy5fbW9udGhzUGFyc2U9W10sdGhpcy5fbG9uZ01vbnRoc1BhcnNlPVtdLHRoaXMuX3Nob3J0TW9udGhzUGFyc2U9W10scz0wO3M8MTI7KytzKXI9eShbMmUzLHNdKSx0aGlzLl9zaG9ydE1vbnRoc1BhcnNlW3NdPXRoaXMubW9udGhzU2hvcnQociwiIikudG9Mb2NhbGVMb3dlckNhc2UoKSx0aGlzLl9sb25nTW9udGhzUGFyc2Vbc109dGhpcy5tb250aHMociwiIikudG9Mb2NhbGVMb3dlckNhc2UoKTtyZXR1cm4gbj8iTU1NIj09PXQ/LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX3Nob3J0TW9udGhzUGFyc2UsYSkpP2k6bnVsbDotMSE9PShpPVllLmNhbGwodGhpcy5fbG9uZ01vbnRoc1BhcnNlLGEpKT9pOm51bGw6Ik1NTSI9PT10Py0xIT09KGk9WWUuY2FsbCh0aGlzLl9zaG9ydE1vbnRoc1BhcnNlLGEpKT9pOi0xIT09KGk9WWUuY2FsbCh0aGlzLl9sb25nTW9udGhzUGFyc2UsYSkpP2k6bnVsbDotMSE9PShpPVllLmNhbGwodGhpcy5fbG9uZ01vbnRoc1BhcnNlLGEpKT9pOi0xIT09KGk9WWUuY2FsbCh0aGlzLl9zaG9ydE1vbnRoc1BhcnNlLGEpKT9pOm51bGx9LmNhbGwodGhpcyxlLHQsbik7Zm9yKHRoaXMuX21vbnRoc1BhcnNlfHwodGhpcy5fbW9udGhzUGFyc2U9W10sdGhpcy5fbG9uZ01vbnRoc1BhcnNlPVtdLHRoaXMuX3Nob3J0TW9udGhzUGFyc2U9W10pLHM9MDtzPDEyO3MrKyl7aWYoaT15KFsyZTMsc10pLG4mJiF0aGlzLl9sb25nTW9udGhzUGFyc2Vbc10mJih0aGlzLl9sb25nTW9udGhzUGFyc2Vbc109bmV3IFJlZ0V4cCgiXiIrdGhpcy5tb250aHMoaSwiIikucmVwbGFjZSgiLiIsIiIpKyIkIiwiaSIpLHRoaXMuX3Nob3J0TW9udGhzUGFyc2Vbc109bmV3IFJlZ0V4cCgiXiIrdGhpcy5tb250aHNTaG9ydChpLCIiKS5yZXBsYWNlKCIuIiwiIikrIiQiLCJpIikpLG58fHRoaXMuX21vbnRoc1BhcnNlW3NdfHwocj0iXiIrdGhpcy5tb250aHMoaSwiIikrInxeIit0aGlzLm1vbnRoc1Nob3J0KGksIiIpLHRoaXMuX21vbnRoc1BhcnNlW3NdPW5ldyBSZWdFeHAoci5yZXBsYWNlKCIuIiwiIiksImkiKSksbiYmIk1NTU0iPT09dCYmdGhpcy5fbG9uZ01vbnRoc1BhcnNlW3NdLnRlc3QoZSkpcmV0dXJuIHM7aWYobiYmIk1NTSI9PT10JiZ0aGlzLl9zaG9ydE1vbnRoc1BhcnNlW3NdLnRlc3QoZSkpcmV0dXJuIHM7aWYoIW4mJnRoaXMuX21vbnRoc1BhcnNlW3NdLnRlc3QoZSkpcmV0dXJuIHN9fSxobi5tb250aHNSZWdleD1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fbW9udGhzUGFyc2VFeGFjdD8obSh0aGlzLCJfbW9udGhzUmVnZXgiKXx8TmUuY2FsbCh0aGlzKSxlP3RoaXMuX21vbnRoc1N0cmljdFJlZ2V4OnRoaXMuX21vbnRoc1JlZ2V4KToobSh0aGlzLCJfbW9udGhzUmVnZXgiKXx8KHRoaXMuX21vbnRoc1JlZ2V4PVVlKSx0aGlzLl9tb250aHNTdHJpY3RSZWdleCYmZT90aGlzLl9tb250aHNTdHJpY3RSZWdleDp0aGlzLl9tb250aHNSZWdleCl9LGhuLm1vbnRoc1Nob3J0UmVnZXg9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX21vbnRoc1BhcnNlRXhhY3Q/KG0odGhpcywiX21vbnRoc1JlZ2V4Iil8fE5lLmNhbGwodGhpcyksZT90aGlzLl9tb250aHNTaG9ydFN0cmljdFJlZ2V4OnRoaXMuX21vbnRoc1Nob3J0UmVnZXgpOihtKHRoaXMsIl9tb250aHNTaG9ydFJlZ2V4Iil8fCh0aGlzLl9tb250aHNTaG9ydFJlZ2V4PUxlKSx0aGlzLl9tb250aHNTaG9ydFN0cmljdFJlZ2V4JiZlP3RoaXMuX21vbnRoc1Nob3J0U3RyaWN0UmVnZXg6dGhpcy5fbW9udGhzU2hvcnRSZWdleCl9LGhuLndlZWs9ZnVuY3Rpb24oZSl7cmV0dXJuIEllKGUsdGhpcy5fd2Vlay5kb3csdGhpcy5fd2Vlay5kb3kpLndlZWt9LGhuLmZpcnN0RGF5T2ZZZWFyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3dlZWsuZG95fSxobi5maXJzdERheU9mV2Vlaz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl93ZWVrLmRvd30saG4ud2Vla2RheXM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZT9vKHRoaXMuX3dlZWtkYXlzKT90aGlzLl93ZWVrZGF5c1tlLmRheSgpXTp0aGlzLl93ZWVrZGF5c1t0aGlzLl93ZWVrZGF5cy5pc0Zvcm1hdC50ZXN0KHQpPyJmb3JtYXQiOiJzdGFuZGFsb25lIl1bZS5kYXkoKV06byh0aGlzLl93ZWVrZGF5cyk/dGhpcy5fd2Vla2RheXM6dGhpcy5fd2Vla2RheXMuc3RhbmRhbG9uZX0saG4ud2Vla2RheXNNaW49ZnVuY3Rpb24oZSl7cmV0dXJuIGU/dGhpcy5fd2Vla2RheXNNaW5bZS5kYXkoKV06dGhpcy5fd2Vla2RheXNNaW59LGhuLndlZWtkYXlzU2hvcnQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGU/dGhpcy5fd2Vla2RheXNTaG9ydFtlLmRheSgpXTp0aGlzLl93ZWVrZGF5c1Nob3J0fSxobi53ZWVrZGF5c1BhcnNlPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcyxpLHI7aWYodGhpcy5fd2Vla2RheXNQYXJzZUV4YWN0KXJldHVybiBmdW5jdGlvbihlLHQsbil7dmFyIHMsaSxyLGE9ZS50b0xvY2FsZUxvd2VyQ2FzZSgpO2lmKCF0aGlzLl93ZWVrZGF5c1BhcnNlKWZvcih0aGlzLl93ZWVrZGF5c1BhcnNlPVtdLHRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZT1bXSx0aGlzLl9taW5XZWVrZGF5c1BhcnNlPVtdLHM9MDtzPDc7KytzKXI9eShbMmUzLDFdKS5kYXkocyksdGhpcy5fbWluV2Vla2RheXNQYXJzZVtzXT10aGlzLndlZWtkYXlzTWluKHIsIiIpLnRvTG9jYWxlTG93ZXJDYXNlKCksdGhpcy5fc2hvcnRXZWVrZGF5c1BhcnNlW3NdPXRoaXMud2Vla2RheXNTaG9ydChyLCIiKS50b0xvY2FsZUxvd2VyQ2FzZSgpLHRoaXMuX3dlZWtkYXlzUGFyc2Vbc109dGhpcy53ZWVrZGF5cyhyLCIiKS50b0xvY2FsZUxvd2VyQ2FzZSgpO3JldHVybiBuPyJkZGRkIj09PXQ/LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX3dlZWtkYXlzUGFyc2UsYSkpP2k6bnVsbDoiZGRkIj09PXQ/LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZSxhKSk/aTpudWxsOi0xIT09KGk9WWUuY2FsbCh0aGlzLl9taW5XZWVrZGF5c1BhcnNlLGEpKT9pOm51bGw6ImRkZGQiPT09dD8tMSE9PShpPVllLmNhbGwodGhpcy5fd2Vla2RheXNQYXJzZSxhKSk/aTotMSE9PShpPVllLmNhbGwodGhpcy5fc2hvcnRXZWVrZGF5c1BhcnNlLGEpKT9pOi0xIT09KGk9WWUuY2FsbCh0aGlzLl9taW5XZWVrZGF5c1BhcnNlLGEpKT9pOm51bGw6ImRkZCI9PT10Py0xIT09KGk9WWUuY2FsbCh0aGlzLl9zaG9ydFdlZWtkYXlzUGFyc2UsYSkpP2k6LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX3dlZWtkYXlzUGFyc2UsYSkpP2k6LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX21pbldlZWtkYXlzUGFyc2UsYSkpP2k6bnVsbDotMSE9PShpPVllLmNhbGwodGhpcy5fbWluV2Vla2RheXNQYXJzZSxhKSk/aTotMSE9PShpPVllLmNhbGwodGhpcy5fd2Vla2RheXNQYXJzZSxhKSk/aTotMSE9PShpPVllLmNhbGwodGhpcy5fc2hvcnRXZWVrZGF5c1BhcnNlLGEpKT9pOm51bGx9LmNhbGwodGhpcyxlLHQsbik7Zm9yKHRoaXMuX3dlZWtkYXlzUGFyc2V8fCh0aGlzLl93ZWVrZGF5c1BhcnNlPVtdLHRoaXMuX21pbldlZWtkYXlzUGFyc2U9W10sdGhpcy5fc2hvcnRXZWVrZGF5c1BhcnNlPVtdLHRoaXMuX2Z1bGxXZWVrZGF5c1BhcnNlPVtdKSxzPTA7czw3O3MrKyl7aWYoaT15KFsyZTMsMV0pLmRheShzKSxuJiYhdGhpcy5fZnVsbFdlZWtkYXlzUGFyc2Vbc10mJih0aGlzLl9mdWxsV2Vla2RheXNQYXJzZVtzXT1uZXcgUmVnRXhwKCJeIit0aGlzLndlZWtkYXlzKGksIiIpLnJlcGxhY2UoIi4iLCJcXC4/IikrIiQiLCJpIiksdGhpcy5fc2hvcnRXZWVrZGF5c1BhcnNlW3NdPW5ldyBSZWdFeHAoIl4iK3RoaXMud2Vla2RheXNTaG9ydChpLCIiKS5yZXBsYWNlKCIuIiwiXFwuPyIpKyIkIiwiaSIpLHRoaXMuX21pbldlZWtkYXlzUGFyc2Vbc109bmV3IFJlZ0V4cCgiXiIrdGhpcy53ZWVrZGF5c01pbihpLCIiKS5yZXBsYWNlKCIuIiwiXFwuPyIpKyIkIiwiaSIpKSx0aGlzLl93ZWVrZGF5c1BhcnNlW3NdfHwocj0iXiIrdGhpcy53ZWVrZGF5cyhpLCIiKSsifF4iK3RoaXMud2Vla2RheXNTaG9ydChpLCIiKSsifF4iK3RoaXMud2Vla2RheXNNaW4oaSwiIiksdGhpcy5fd2Vla2RheXNQYXJzZVtzXT1uZXcgUmVnRXhwKHIucmVwbGFjZSgiLiIsIiIpLCJpIikpLG4mJiJkZGRkIj09PXQmJnRoaXMuX2Z1bGxXZWVrZGF5c1BhcnNlW3NdLnRlc3QoZSkpcmV0dXJuIHM7aWYobiYmImRkZCI9PT10JiZ0aGlzLl9zaG9ydFdlZWtkYXlzUGFyc2Vbc10udGVzdChlKSlyZXR1cm4gcztpZihuJiYiZGQiPT09dCYmdGhpcy5fbWluV2Vla2RheXNQYXJzZVtzXS50ZXN0KGUpKXJldHVybiBzO2lmKCFuJiZ0aGlzLl93ZWVrZGF5c1BhcnNlW3NdLnRlc3QoZSkpcmV0dXJuIHN9fSxobi53ZWVrZGF5c1JlZ2V4PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl93ZWVrZGF5c1BhcnNlRXhhY3Q/KG0odGhpcywiX3dlZWtkYXlzUmVnZXgiKXx8QmUuY2FsbCh0aGlzKSxlP3RoaXMuX3dlZWtkYXlzU3RyaWN0UmVnZXg6dGhpcy5fd2Vla2RheXNSZWdleCk6KG0odGhpcywiX3dlZWtkYXlzUmVnZXgiKXx8KHRoaXMuX3dlZWtkYXlzUmVnZXg9JGUpLHRoaXMuX3dlZWtkYXlzU3RyaWN0UmVnZXgmJmU/dGhpcy5fd2Vla2RheXNTdHJpY3RSZWdleDp0aGlzLl93ZWVrZGF5c1JlZ2V4KX0saG4ud2Vla2RheXNTaG9ydFJlZ2V4PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl93ZWVrZGF5c1BhcnNlRXhhY3Q/KG0odGhpcywiX3dlZWtkYXlzUmVnZXgiKXx8QmUuY2FsbCh0aGlzKSxlP3RoaXMuX3dlZWtkYXlzU2hvcnRTdHJpY3RSZWdleDp0aGlzLl93ZWVrZGF5c1Nob3J0UmVnZXgpOihtKHRoaXMsIl93ZWVrZGF5c1Nob3J0UmVnZXgiKXx8KHRoaXMuX3dlZWtkYXlzU2hvcnRSZWdleD1xZSksdGhpcy5fd2Vla2RheXNTaG9ydFN0cmljdFJlZ2V4JiZlP3RoaXMuX3dlZWtkYXlzU2hvcnRTdHJpY3RSZWdleDp0aGlzLl93ZWVrZGF5c1Nob3J0UmVnZXgpfSxobi53ZWVrZGF5c01pblJlZ2V4PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl93ZWVrZGF5c1BhcnNlRXhhY3Q/KG0odGhpcywiX3dlZWtkYXlzUmVnZXgiKXx8QmUuY2FsbCh0aGlzKSxlP3RoaXMuX3dlZWtkYXlzTWluU3RyaWN0UmVnZXg6dGhpcy5fd2Vla2RheXNNaW5SZWdleCk6KG0odGhpcywiX3dlZWtkYXlzTWluUmVnZXgiKXx8KHRoaXMuX3dlZWtkYXlzTWluUmVnZXg9SmUpLHRoaXMuX3dlZWtkYXlzTWluU3RyaWN0UmVnZXgmJmU/dGhpcy5fd2Vla2RheXNNaW5TdHJpY3RSZWdleDp0aGlzLl93ZWVrZGF5c01pblJlZ2V4KX0saG4uaXNQTT1mdW5jdGlvbihlKXtyZXR1cm4icCI9PT0oZSsiIikudG9Mb3dlckNhc2UoKS5jaGFyQXQoMCl9LGhuLm1lcmlkaWVtPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gMTE8ZT9uPyJwbSI6IlBNIjpuPyJhbSI6IkFNIn0sb3QoImVuIix7ZGF5T2ZNb250aE9yZGluYWxQYXJzZTovXGR7MSwyfSh0aHxzdHxuZHxyZCkvLG9yZGluYWw6ZnVuY3Rpb24oZSl7dmFyIHQ9ZSUxMDtyZXR1cm4gZSsoMT09PWsoZSUxMDAvMTApPyJ0aCI6MT09PXQ/InN0IjoyPT09dD8ibmQiOjM9PT10PyJyZCI6InRoIil9fSksYy5sYW5nPW4oIm1vbWVudC5sYW5nIGlzIGRlcHJlY2F0ZWQuIFVzZSBtb21lbnQubG9jYWxlIGluc3RlYWQuIixvdCksYy5sYW5nRGF0YT1uKCJtb21lbnQubGFuZ0RhdGEgaXMgZGVwcmVjYXRlZC4gVXNlIG1vbWVudC5sb2NhbGVEYXRhIGluc3RlYWQuIixsdCk7dmFyIF9uPU1hdGguYWJzO2Z1bmN0aW9uIHluKGUsdCxuLHMpe3ZhciBpPUF0KHQsbik7cmV0dXJuIGUuX21pbGxpc2Vjb25kcys9cyppLl9taWxsaXNlY29uZHMsZS5fZGF5cys9cyppLl9kYXlzLGUuX21vbnRocys9cyppLl9tb250aHMsZS5fYnViYmxlKCl9ZnVuY3Rpb24gZ24oZSl7cmV0dXJuIGU8MD9NYXRoLmZsb29yKGUpOk1hdGguY2VpbChlKX1mdW5jdGlvbiBwbihlKXtyZXR1cm4gNDgwMCplLzE0NjA5N31mdW5jdGlvbiB2bihlKXtyZXR1cm4gMTQ2MDk3KmUvNDgwMH1mdW5jdGlvbiB3bihlKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hcyhlKX19dmFyIE1uPXduKCJtcyIpLFNuPXduKCJzIiksRG49d24oIm0iKSxrbj13bigiaCIpLFluPXduKCJkIiksT249d24oInciKSxUbj13bigiTSIpLHhuPXduKCJ5Iik7ZnVuY3Rpb24gYm4oZSl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNWYWxpZCgpP3RoaXMuX2RhdGFbZV06TmFOfX12YXIgUG49Ym4oIm1pbGxpc2Vjb25kcyIpLFduPWJuKCJzZWNvbmRzIiksSG49Ym4oIm1pbnV0ZXMiKSxSbj1ibigiaG91cnMiKSxDbj1ibigiZGF5cyIpLEZuPWJuKCJtb250aHMiKSxMbj1ibigieWVhcnMiKTt2YXIgVW49TWF0aC5yb3VuZCxObj17c3M6NDQsczo0NSxtOjQ1LGg6MjIsZDoyNixNOjExfTt2YXIgR249TWF0aC5hYnM7ZnVuY3Rpb24gVm4oZSl7cmV0dXJuKDA8ZSktKGU8MCl8fCtlfWZ1bmN0aW9uIEVuKCl7aWYoIXRoaXMuaXNWYWxpZCgpKXJldHVybiB0aGlzLmxvY2FsZURhdGEoKS5pbnZhbGlkRGF0ZSgpO3ZhciBlLHQsbj1Hbih0aGlzLl9taWxsaXNlY29uZHMpLzFlMyxzPUduKHRoaXMuX2RheXMpLGk9R24odGhpcy5fbW9udGhzKTt0PUQoKGU9RChuLzYwKSkvNjApLG4lPTYwLGUlPTYwO3ZhciByPUQoaS8xMiksYT1pJT0xMixvPXMsdT10LGw9ZSxkPW4/bi50b0ZpeGVkKDMpLnJlcGxhY2UoL1wuPzArJC8sIiIpOiIiLGg9dGhpcy5hc1NlY29uZHMoKTtpZighaClyZXR1cm4iUDBEIjt2YXIgYz1oPDA/Ii0iOiIiLGY9Vm4odGhpcy5fbW9udGhzKSE9PVZuKGgpPyItIjoiIixtPVZuKHRoaXMuX2RheXMpIT09Vm4oaCk/Ii0iOiIiLF89Vm4odGhpcy5fbWlsbGlzZWNvbmRzKSE9PVZuKGgpPyItIjoiIjtyZXR1cm4gYysiUCIrKHI/ZityKyJZIjoiIikrKGE/ZithKyJNIjoiIikrKG8/bStvKyJEIjoiIikrKHV8fGx8fGQ/IlQiOiIiKSsodT9fK3UrIkgiOiIiKSsobD9fK2wrIk0iOiIiKSsoZD9fK2QrIlMiOiIiKX12YXIgSW49SHQucHJvdG90eXBlO3JldHVybiBJbi5pc1ZhbGlkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzVmFsaWR9LEluLmFicz1mdW5jdGlvbigpe3ZhciBlPXRoaXMuX2RhdGE7cmV0dXJuIHRoaXMuX21pbGxpc2Vjb25kcz1fbih0aGlzLl9taWxsaXNlY29uZHMpLHRoaXMuX2RheXM9X24odGhpcy5fZGF5cyksdGhpcy5fbW9udGhzPV9uKHRoaXMuX21vbnRocyksZS5taWxsaXNlY29uZHM9X24oZS5taWxsaXNlY29uZHMpLGUuc2Vjb25kcz1fbihlLnNlY29uZHMpLGUubWludXRlcz1fbihlLm1pbnV0ZXMpLGUuaG91cnM9X24oZS5ob3VycyksZS5tb250aHM9X24oZS5tb250aHMpLGUueWVhcnM9X24oZS55ZWFycyksdGhpc30sSW4uYWRkPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHluKHRoaXMsZSx0LDEpfSxJbi5zdWJ0cmFjdD1mdW5jdGlvbihlLHQpe3JldHVybiB5bih0aGlzLGUsdCwtMSl9LEluLmFzPWZ1bmN0aW9uKGUpe2lmKCF0aGlzLmlzVmFsaWQoKSlyZXR1cm4gTmFOO3ZhciB0LG4scz10aGlzLl9taWxsaXNlY29uZHM7aWYoIm1vbnRoIj09PShlPVIoZSkpfHwieWVhciI9PT1lKXJldHVybiB0PXRoaXMuX2RheXMrcy84NjRlNSxuPXRoaXMuX21vbnRocytwbih0KSwibW9udGgiPT09ZT9uOm4vMTI7c3dpdGNoKHQ9dGhpcy5fZGF5cytNYXRoLnJvdW5kKHZuKHRoaXMuX21vbnRocykpLGUpe2Nhc2Uid2VlayI6cmV0dXJuIHQvNytzLzYwNDhlNTtjYXNlImRheSI6cmV0dXJuIHQrcy84NjRlNTtjYXNlImhvdXIiOnJldHVybiAyNCp0K3MvMzZlNTtjYXNlIm1pbnV0ZSI6cmV0dXJuIDE0NDAqdCtzLzZlNDtjYXNlInNlY29uZCI6cmV0dXJuIDg2NDAwKnQrcy8xZTM7Y2FzZSJtaWxsaXNlY29uZCI6cmV0dXJuIE1hdGguZmxvb3IoODY0ZTUqdCkrcztkZWZhdWx0OnRocm93IG5ldyBFcnJvcigiVW5rbm93biB1bml0ICIrZSl9fSxJbi5hc01pbGxpc2Vjb25kcz1NbixJbi5hc1NlY29uZHM9U24sSW4uYXNNaW51dGVzPURuLEluLmFzSG91cnM9a24sSW4uYXNEYXlzPVluLEluLmFzV2Vla3M9T24sSW4uYXNNb250aHM9VG4sSW4uYXNZZWFycz14bixJbi52YWx1ZU9mPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNWYWxpZCgpP3RoaXMuX21pbGxpc2Vjb25kcys4NjRlNSp0aGlzLl9kYXlzK3RoaXMuX21vbnRocyUxMioyNTkyZTYrMzE1MzZlNiprKHRoaXMuX21vbnRocy8xMik6TmFOfSxJbi5fYnViYmxlPWZ1bmN0aW9uKCl7dmFyIGUsdCxuLHMsaSxyPXRoaXMuX21pbGxpc2Vjb25kcyxhPXRoaXMuX2RheXMsbz10aGlzLl9tb250aHMsdT10aGlzLl9kYXRhO3JldHVybiAwPD1yJiYwPD1hJiYwPD1vfHxyPD0wJiZhPD0wJiZvPD0wfHwocis9ODY0ZTUqZ24odm4obykrYSksbz1hPTApLHUubWlsbGlzZWNvbmRzPXIlMWUzLGU9RChyLzFlMyksdS5zZWNvbmRzPWUlNjAsdD1EKGUvNjApLHUubWludXRlcz10JTYwLG49RCh0LzYwKSx1LmhvdXJzPW4lMjQsbys9aT1EKHBuKGErPUQobi8yNCkpKSxhLT1nbih2bihpKSkscz1EKG8vMTIpLG8lPTEyLHUuZGF5cz1hLHUubW9udGhzPW8sdS55ZWFycz1zLHRoaXN9LEluLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIEF0KHRoaXMpfSxJbi5nZXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGU9UihlKSx0aGlzLmlzVmFsaWQoKT90aGlzW2UrInMiXSgpOk5hTn0sSW4ubWlsbGlzZWNvbmRzPVBuLEluLnNlY29uZHM9V24sSW4ubWludXRlcz1IbixJbi5ob3Vycz1SbixJbi5kYXlzPUNuLEluLndlZWtzPWZ1bmN0aW9uKCl7cmV0dXJuIEQodGhpcy5kYXlzKCkvNyl9LEluLm1vbnRocz1GbixJbi55ZWFycz1MbixJbi5odW1hbml6ZT1mdW5jdGlvbihlKXtpZighdGhpcy5pc1ZhbGlkKCkpcmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLmludmFsaWREYXRlKCk7dmFyIHQsbixzLGkscixhLG8sdSxsLGQsaCxjPXRoaXMubG9jYWxlRGF0YSgpLGY9KG49IWUscz1jLGk9QXQodD10aGlzKS5hYnMoKSxyPVVuKGkuYXMoInMiKSksYT1VbihpLmFzKCJtIikpLG89VW4oaS5hcygiaCIpKSx1PVVuKGkuYXMoImQiKSksbD1VbihpLmFzKCJNIikpLGQ9VW4oaS5hcygieSIpKSwoaD1yPD1Obi5zcyYmWyJzIixyXXx8cjxObi5zJiZbInNzIixyXXx8YTw9MSYmWyJtIl18fGE8Tm4ubSYmWyJtbSIsYV18fG88PTEmJlsiaCJdfHxvPE5uLmgmJlsiaGgiLG9dfHx1PD0xJiZbImQiXXx8dTxObi5kJiZbImRkIix1XXx8bDw9MSYmWyJNIl18fGw8Tm4uTSYmWyJNTSIsbF18fGQ8PTEmJlsieSJdfHxbInl5IixkXSlbMl09bixoWzNdPTA8K3QsaFs0XT1zLGZ1bmN0aW9uKGUsdCxuLHMsaSl7cmV0dXJuIGkucmVsYXRpdmVUaW1lKHR8fDEsISFuLGUscyl9LmFwcGx5KG51bGwsaCkpO3JldHVybiBlJiYoZj1jLnBhc3RGdXR1cmUoK3RoaXMsZikpLGMucG9zdGZvcm1hdChmKX0sSW4udG9JU09TdHJpbmc9RW4sSW4udG9TdHJpbmc9RW4sSW4udG9KU09OPUVuLEluLmxvY2FsZT1RdCxJbi5sb2NhbGVEYXRhPUt0LEluLnRvSXNvU3RyaW5nPW4oInRvSXNvU3RyaW5nKCkgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSB0b0lTT1N0cmluZygpIGluc3RlYWQgKG5vdGljZSB0aGUgY2FwaXRhbHMpIixFbiksSW4ubGFuZz1YdCxJKCJYIiwwLDAsInVuaXgiKSxJKCJ4IiwwLDAsInZhbHVlT2YiKSx1ZSgieCIsc2UpLHVlKCJYIiwvWystXT9cZCsoXC5cZHsxLDN9KT8vKSxjZSgiWCIsZnVuY3Rpb24oZSx0LG4pe24uX2Q9bmV3IERhdGUoMWUzKnBhcnNlRmxvYXQoZSwxMCkpfSksY2UoIngiLGZ1bmN0aW9uKGUsdCxuKXtuLl9kPW5ldyBEYXRlKGsoZSkpfSksYy52ZXJzaW9uPSIyLjIyLjIiLGU9VHQsYy5mbj1sbixjLm1pbj1mdW5jdGlvbigpe3JldHVybiBQdCgiaXNCZWZvcmUiLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApKX0sYy5tYXg9ZnVuY3Rpb24oKXtyZXR1cm4gUHQoImlzQWZ0ZXIiLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApKX0sYy5ub3c9ZnVuY3Rpb24oKXtyZXR1cm4gRGF0ZS5ub3c/RGF0ZS5ub3coKTorbmV3IERhdGV9LGMudXRjPXksYy51bml4PWZ1bmN0aW9uKGUpe3JldHVybiBUdCgxZTMqZSl9LGMubW9udGhzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGZuKGUsdCwibW9udGhzIil9LGMuaXNEYXRlPWgsYy5sb2NhbGU9b3QsYy5pbnZhbGlkPXYsYy5kdXJhdGlvbj1BdCxjLmlzTW9tZW50PVMsYy53ZWVrZGF5cz1mdW5jdGlvbihlLHQsbil7cmV0dXJuIG1uKGUsdCxuLCJ3ZWVrZGF5cyIpfSxjLnBhcnNlWm9uZT1mdW5jdGlvbigpe3JldHVybiBUdC5hcHBseShudWxsLGFyZ3VtZW50cykucGFyc2Vab25lKCl9LGMubG9jYWxlRGF0YT1sdCxjLmlzRHVyYXRpb249UnQsYy5tb250aHNTaG9ydD1mdW5jdGlvbihlLHQpe3JldHVybiBmbihlLHQsIm1vbnRoc1Nob3J0Iil9LGMud2Vla2RheXNNaW49ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBtbihlLHQsbiwid2Vla2RheXNNaW4iKX0sYy5kZWZpbmVMb2NhbGU9dXQsYy51cGRhdGVMb2NhbGU9ZnVuY3Rpb24oZSx0KXtpZihudWxsIT10KXt2YXIgbixzLGk9bnQ7bnVsbCE9KHM9YXQoZSkpJiYoaT1zLl9jb25maWcpLChuPW5ldyBQKHQ9YihpLHQpKSkucGFyZW50TG9jYWxlPXN0W2VdLHN0W2VdPW4sb3QoZSl9ZWxzZSBudWxsIT1zdFtlXSYmKG51bGwhPXN0W2VdLnBhcmVudExvY2FsZT9zdFtlXT1zdFtlXS5wYXJlbnRMb2NhbGU6bnVsbCE9c3RbZV0mJmRlbGV0ZSBzdFtlXSk7cmV0dXJuIHN0W2VdfSxjLmxvY2FsZXM9ZnVuY3Rpb24oKXtyZXR1cm4gcyhzdCl9LGMud2Vla2RheXNTaG9ydD1mdW5jdGlvbihlLHQsbil7cmV0dXJuIG1uKGUsdCxuLCJ3ZWVrZGF5c1Nob3J0Iil9LGMubm9ybWFsaXplVW5pdHM9UixjLnJlbGF0aXZlVGltZVJvdW5kaW5nPWZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lP1VuOiJmdW5jdGlvbiI9PXR5cGVvZiBlJiYoVW49ZSwhMCl9LGMucmVsYXRpdmVUaW1lVGhyZXNob2xkPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHZvaWQgMCE9PU5uW2VdJiYodm9pZCAwPT09dD9ObltlXTooTm5bZV09dCwicyI9PT1lJiYoTm4uc3M9dC0xKSwhMCkpfSxjLmNhbGVuZGFyRm9ybWF0PWZ1bmN0aW9uKGUsdCl7dmFyIG49ZS5kaWZmKHQsImRheXMiLCEwKTtyZXR1cm4gbjwtNj8ic2FtZUVsc2UiOm48LTE/Imxhc3RXZWVrIjpuPDA/Imxhc3REYXkiOm48MT8ic2FtZURheSI6bjwyPyJuZXh0RGF5IjpuPDc/Im5leHRXZWVrIjoic2FtZUVsc2UifSxjLnByb3RvdHlwZT1sbixjLkhUTUw1X0ZNVD17REFURVRJTUVfTE9DQUw6IllZWVktTU0tRERUSEg6bW0iLERBVEVUSU1FX0xPQ0FMX1NFQ09ORFM6IllZWVktTU0tRERUSEg6bW06c3MiLERBVEVUSU1FX0xPQ0FMX01TOiJZWVlZLU1NLUREVEhIOm1tOnNzLlNTUyIsREFURToiWVlZWS1NTS1ERCIsVElNRToiSEg6bW0iLFRJTUVfU0VDT05EUzoiSEg6bW06c3MiLFRJTUVfTVM6IkhIOm1tOnNzLlNTUyIsV0VFSzoiWVlZWS1bV11XVyIsTU9OVEg6IllZWVktTU0ifSxjfSk7DQohZnVuY3Rpb24oZSx0KXsib2JqZWN0Ij09dHlwZW9mIGV4cG9ydHMmJiJ1bmRlZmluZWQiIT10eXBlb2YgbW9kdWxlP21vZHVsZS5leHBvcnRzPXQoKToiZnVuY3Rpb24iPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZSh0KTplLlN3ZWV0YWxlcnQyPXQoKX0odGhpcyxmdW5jdGlvbigpeyJ1c2Ugc3RyaWN0Ijt2YXIgcT0iZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiYic3ltYm9sIj09dHlwZW9mIFN5bWJvbC5pdGVyYXRvcj9mdW5jdGlvbihlKXtyZXR1cm4gdHlwZW9mIGV9OmZ1bmN0aW9uKGUpe3JldHVybiBlJiYiZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiZlLmNvbnN0cnVjdG9yPT09U3ltYm9sJiZlIT09U3ltYm9sLnByb3RvdHlwZT8ic3ltYm9sIjp0eXBlb2YgZX0scz1mdW5jdGlvbihlLHQpe2lmKCEoZSBpbnN0YW5jZW9mIHQpKXRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpfSxvPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gbyhlLHQpe2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKXt2YXIgbz10W25dO28uZW51bWVyYWJsZT1vLmVudW1lcmFibGV8fCExLG8uY29uZmlndXJhYmxlPSEwLCJ2YWx1ZSJpbiBvJiYoby53cml0YWJsZT0hMCksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsby5rZXksbyl9fXJldHVybiBmdW5jdGlvbihlLHQsbil7cmV0dXJuIHQmJm8oZS5wcm90b3R5cGUsdCksbiYmbyhlLG4pLGV9fSgpLHI9T2JqZWN0LmFzc2lnbnx8ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTE7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyl7dmFyIG49YXJndW1lbnRzW3RdO2Zvcih2YXIgbyBpbiBuKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChuLG8pJiYoZVtvXT1uW29dKX1yZXR1cm4gZX0saT1mdW5jdGlvbiBlKHQsbixvKXtudWxsPT09dCYmKHQ9RnVuY3Rpb24ucHJvdG90eXBlKTt2YXIgcj1PYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHQsbik7aWYodm9pZCAwPT09cil7dmFyIGk9T2JqZWN0LmdldFByb3RvdHlwZU9mKHQpO3JldHVybiBudWxsPT09aT92b2lkIDA6ZShpLG4sbyl9aWYoInZhbHVlImluIHIpcmV0dXJuIHIudmFsdWU7dmFyIGE9ci5nZXQ7cmV0dXJuIHZvaWQgMCE9PWE/YS5jYWxsKG8pOnZvaWQgMH0sYT1mdW5jdGlvbihlLHQpe2lmKCJmdW5jdGlvbiIhPXR5cGVvZiB0JiZudWxsIT09dCl0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICIrdHlwZW9mIHQpO2UucHJvdG90eXBlPU9iamVjdC5jcmVhdGUodCYmdC5wcm90b3R5cGUse2NvbnN0cnVjdG9yOnt2YWx1ZTplLGVudW1lcmFibGU6ITEsd3JpdGFibGU6ITAsY29uZmlndXJhYmxlOiEwfX0pLHQmJihPYmplY3Quc2V0UHJvdG90eXBlT2Y/T2JqZWN0LnNldFByb3RvdHlwZU9mKGUsdCk6ZS5fX3Byb3RvX189dCl9LHU9ZnVuY3Rpb24oZSx0KXtpZighZSl0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpO3JldHVybiF0fHwib2JqZWN0IiE9dHlwZW9mIHQmJiJmdW5jdGlvbiIhPXR5cGVvZiB0P2U6dH0sTT1mdW5jdGlvbihlLHQpe2lmKEFycmF5LmlzQXJyYXkoZSkpcmV0dXJuIGU7aWYoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChlKSlyZXR1cm4gZnVuY3Rpb24oZSx0KXt2YXIgbj1bXSxvPSEwLHI9ITEsaT12b2lkIDA7dHJ5e2Zvcih2YXIgYSxzPWVbU3ltYm9sLml0ZXJhdG9yXSgpOyEobz0oYT1zLm5leHQoKSkuZG9uZSkmJihuLnB1c2goYS52YWx1ZSksIXR8fG4ubGVuZ3RoIT09dCk7bz0hMCk7fWNhdGNoKGUpe3I9ITAsaT1lfWZpbmFsbHl7dHJ5eyFvJiZzLnJldHVybiYmcy5yZXR1cm4oKX1maW5hbGx5e2lmKHIpdGhyb3cgaX19cmV0dXJuIG59KGUsdCk7dGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZSIpfSx0PSJTd2VldEFsZXJ0MjoiLG49ZnVuY3Rpb24oZSl7cmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGUpfSx4PWZ1bmN0aW9uKGUpe2NvbnNvbGUud2Fybih0KyIgIitlKX0sST1mdW5jdGlvbihlKXtjb25zb2xlLmVycm9yKHQrIiAiK2UpfSxjPVtdLGw9ZnVuY3Rpb24oZSl7LTE9PT1jLmluZGV4T2YoZSkmJihjLnB1c2goZSkseChlKSl9LEg9ZnVuY3Rpb24oZSl7cmV0dXJuImZ1bmN0aW9uIj09dHlwZW9mIGU/ZSgpOmV9LFI9ZnVuY3Rpb24oZSl7cmV0dXJuIm9iamVjdCI9PT0odm9pZCAwPT09ZT8idW5kZWZpbmVkIjpxKGUpKSYmImZ1bmN0aW9uIj09dHlwZW9mIGUudGhlbn0sZT1PYmplY3QuZnJlZXplKHtjYW5jZWw6ImNhbmNlbCIsYmFja2Ryb3A6Im92ZXJsYXkiLGNsb3NlOiJjbG9zZSIsZXNjOiJlc2MiLHRpbWVyOiJ0aW1lciJ9KSxkPWZ1bmN0aW9uKGUpe3ZhciB0PXt9O2Zvcih2YXIgbiBpbiBlKXRbZVtuXV09InN3YWwyLSIrZVtuXTtyZXR1cm4gdH0sRD1kKFsiY29udGFpbmVyIiwic2hvd24iLCJoZWlnaHQtYXV0byIsImlvc2ZpeCIsInBvcHVwIiwibW9kYWwiLCJuby1iYWNrZHJvcCIsInRvYXN0IiwidG9hc3Qtc2hvd24iLCJ0b2FzdC1jb2x1bW4iLCJmYWRlIiwic2hvdyIsImhpZGUiLCJub2FuaW1hdGlvbiIsImNsb3NlIiwidGl0bGUiLCJoZWFkZXIiLCJjb250ZW50IiwiYWN0aW9ucyIsImNvbmZpcm0iLCJjYW5jZWwiLCJmb290ZXIiLCJpY29uIiwiaWNvbi10ZXh0IiwiaW1hZ2UiLCJpbnB1dCIsImZpbGUiLCJyYW5nZSIsInNlbGVjdCIsInJhZGlvIiwiY2hlY2tib3giLCJsYWJlbCIsInRleHRhcmVhIiwiaW5wdXRlcnJvciIsInZhbGlkYXRpb25lcnJvciIsInByb2dyZXNzc3RlcHMiLCJhY3RpdmVwcm9ncmVzc3N0ZXAiLCJwcm9ncmVzc2NpcmNsZSIsInByb2dyZXNzbGluZSIsImxvYWRpbmciLCJzdHlsZWQiLCJ0b3AiLCJ0b3Atc3RhcnQiLCJ0b3AtZW5kIiwidG9wLWxlZnQiLCJ0b3AtcmlnaHQiLCJjZW50ZXIiLCJjZW50ZXItc3RhcnQiLCJjZW50ZXItZW5kIiwiY2VudGVyLWxlZnQiLCJjZW50ZXItcmlnaHQiLCJib3R0b20iLCJib3R0b20tc3RhcnQiLCJib3R0b20tZW5kIiwiYm90dG9tLWxlZnQiLCJib3R0b20tcmlnaHQiLCJncm93LXJvdyIsImdyb3ctY29sdW1uIiwiZ3Jvdy1mdWxsc2NyZWVuIl0pLEI9ZChbInN1Y2Nlc3MiLCJ3YXJuaW5nIiwiaW5mbyIsInF1ZXN0aW9uIiwiZXJyb3IiXSkscD17cHJldmlvdXNCb2R5UGFkZGluZzpudWxsfSxmPWZ1bmN0aW9uKGUsdCl7cmV0dXJuISFlLmNsYXNzTGlzdCYmZS5jbGFzc0xpc3QuY29udGFpbnModCl9LE49ZnVuY3Rpb24oZSl7aWYoZS5mb2N1cygpLCJmaWxlIiE9PWUudHlwZSl7dmFyIHQ9ZS52YWx1ZTtlLnZhbHVlPSIiLGUudmFsdWU9dH19LG09ZnVuY3Rpb24oZSx0LG4pe2UmJnQmJigic3RyaW5nIj09dHlwZW9mIHQmJih0PXQuc3BsaXQoL1xzKy8pLmZpbHRlcihCb29sZWFuKSksdC5mb3JFYWNoKGZ1bmN0aW9uKHQpe2UuZm9yRWFjaD9lLmZvckVhY2goZnVuY3Rpb24oZSl7bj9lLmNsYXNzTGlzdC5hZGQodCk6ZS5jbGFzc0xpc3QucmVtb3ZlKHQpfSk6bj9lLmNsYXNzTGlzdC5hZGQodCk6ZS5jbGFzc0xpc3QucmVtb3ZlKHQpfSkpfSxXPWZ1bmN0aW9uKGUsdCl7bShlLHQsITApfSxBPWZ1bmN0aW9uKGUsdCl7bShlLHQsITEpfSx6PWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPTA7bjxlLmNoaWxkTm9kZXMubGVuZ3RoO24rKylpZihmKGUuY2hpbGROb2Rlc1tuXSx0KSlyZXR1cm4gZS5jaGlsZE5vZGVzW25dfSxVPWZ1bmN0aW9uKGUpe2Uuc3R5bGUub3BhY2l0eT0iIixlLnN0eWxlLmRpc3BsYXk9ZS5pZD09PUQuY29udGVudD8iYmxvY2siOiJmbGV4In0sRj1mdW5jdGlvbihlKXtlLnN0eWxlLm9wYWNpdHk9IiIsZS5zdHlsZS5kaXNwbGF5PSJub25lIn0sSz1mdW5jdGlvbihlKXtyZXR1cm4gZSYmKGUub2Zmc2V0V2lkdGh8fGUub2Zmc2V0SGVpZ2h0fHxlLmdldENsaWVudFJlY3RzKCkubGVuZ3RoKX0sUz1mdW5jdGlvbihlLHQpe2Uuc3R5bGUucmVtb3ZlUHJvcGVydHk/ZS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSh0KTplLnN0eWxlLnJlbW92ZUF0dHJpYnV0ZSh0KX0sUD1mdW5jdGlvbigpe3JldHVybiBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3IoIi4iK0QuY29udGFpbmVyKX0saD1mdW5jdGlvbihlKXt2YXIgdD1QKCk7cmV0dXJuIHQ/dC5xdWVyeVNlbGVjdG9yKCIuIitlKTpudWxsfSxFPWZ1bmN0aW9uKCl7cmV0dXJuIGgoRC5wb3B1cCl9LE89ZnVuY3Rpb24oKXt2YXIgZT1FKCk7cmV0dXJuIG4oZS5xdWVyeVNlbGVjdG9yQWxsKCIuIitELmljb24pKX0sTD1mdW5jdGlvbigpe3JldHVybiBoKEQudGl0bGUpfSxaPWZ1bmN0aW9uKCl7cmV0dXJuIGgoRC5jb250ZW50KX0sUT1mdW5jdGlvbigpe3JldHVybiBoKEQuaW1hZ2UpfSxnPWZ1bmN0aW9uKCl7cmV0dXJuIGgoRC5wcm9ncmVzc3N0ZXBzKX0sWT1mdW5jdGlvbigpe3JldHVybiBoKEQuY29uZmlybSl9LCQ9ZnVuY3Rpb24oKXtyZXR1cm4gaChELmNhbmNlbCl9LEo9ZnVuY3Rpb24oKXtyZXR1cm4gaChELmFjdGlvbnMpfSxYPWZ1bmN0aW9uKCl7cmV0dXJuIGgoRC5mb290ZXIpfSxHPWZ1bmN0aW9uKCl7cmV0dXJuIGgoRC5jbG9zZSl9LGVlPWZ1bmN0aW9uKCl7dmFyIGU9bihFKCkucXVlcnlTZWxlY3RvckFsbCgnW3RhYmluZGV4XTpub3QoW3RhYmluZGV4PSItMSJdKTpub3QoW3RhYmluZGV4PSIwIl0pJykpLnNvcnQoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZT1wYXJzZUludChlLmdldEF0dHJpYnV0ZSgidGFiaW5kZXgiKSksKHQ9cGFyc2VJbnQodC5nZXRBdHRyaWJ1dGUoInRhYmluZGV4IikpKTxlPzE6ZTx0Py0xOjB9KSx0PW4oRSgpLnF1ZXJ5U2VsZWN0b3JBbGwoJ2FbaHJlZl0sIGFyZWFbaHJlZl0sIGlucHV0Om5vdChbZGlzYWJsZWRdKSwgc2VsZWN0Om5vdChbZGlzYWJsZWRdKSwgdGV4dGFyZWE6bm90KFtkaXNhYmxlZF0pLCBidXR0b246bm90KFtkaXNhYmxlZF0pLCBpZnJhbWUsIG9iamVjdCwgZW1iZWQsIFt0YWJpbmRleD0iMCJdLCBbY29udGVudGVkaXRhYmxlXSwgYXVkaW9bY29udHJvbHNdLCB2aWRlb1tjb250cm9sc10nKSkuZmlsdGVyKGZ1bmN0aW9uKGUpe3JldHVybiItMSIhPT1lLmdldEF0dHJpYnV0ZSgidGFiaW5kZXgiKX0pO3JldHVybiBmdW5jdGlvbihlKXtmb3IodmFyIHQ9W10sbj0wO248ZS5sZW5ndGg7bisrKS0xPT09dC5pbmRleE9mKGVbbl0pJiZ0LnB1c2goZVtuXSk7cmV0dXJuIHR9KGUuY29uY2F0KHQpKS5maWx0ZXIoZnVuY3Rpb24oZSl7cmV0dXJuIEsoZSl9KX0sdj1mdW5jdGlvbigpe3JldHVybiFkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5jb250YWlucyhEWyJ0b2FzdC1zaG93biJdKX0seT1mdW5jdGlvbigpe3JldHVybiBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5jb250YWlucyhEWyJ0b2FzdC1zaG93biJdKX0sYj1mdW5jdGlvbigpe3JldHVybiJ1bmRlZmluZWQiPT10eXBlb2Ygd2luZG93fHwidW5kZWZpbmVkIj09dHlwZW9mIGRvY3VtZW50fSx3PSgnXG4gPGRpdiBhcmlhLWxhYmVsbGVkYnk9IicrRC50aXRsZSsnIiBhcmlhLWRlc2NyaWJlZGJ5PSInK0QuY29udGVudCsnIiBjbGFzcz0iJytELnBvcHVwKyciIHRhYmluZGV4PSItMSI+XG4gICA8ZGl2IGNsYXNzPSInK0QuaGVhZGVyKyciPlxuICAgICA8dWwgY2xhc3M9IicrRC5wcm9ncmVzc3N0ZXBzKyciPjwvdWw+XG4gICAgIDxkaXYgY2xhc3M9IicrRC5pY29uKyIgIitCLmVycm9yKyciPlxuICAgICAgIDxzcGFuIGNsYXNzPSJzd2FsMi14LW1hcmsiPjxzcGFuIGNsYXNzPSJzd2FsMi14LW1hcmstbGluZS1sZWZ0Ij48L3NwYW4+PHNwYW4gY2xhc3M9InN3YWwyLXgtbWFyay1saW5lLXJpZ2h0Ij48L3NwYW4+PC9zcGFuPlxuICAgICA8L2Rpdj5cbiAgICAgPGRpdiBjbGFzcz0iJytELmljb24rIiAiK0IucXVlc3Rpb24rJyI+XG4gICAgICAgPHNwYW4gY2xhc3M9IicrRFsiaWNvbi10ZXh0Il0rJyI+Pzwvc3Bhbj5cbiAgICAgIDwvZGl2PlxuICAgICA8ZGl2IGNsYXNzPSInK0QuaWNvbisiICIrQi53YXJuaW5nKyciPlxuICAgICAgIDxzcGFuIGNsYXNzPSInK0RbImljb24tdGV4dCJdKyciPiE8L3NwYW4+XG4gICAgICA8L2Rpdj5cbiAgICAgPGRpdiBjbGFzcz0iJytELmljb24rIiAiK0IuaW5mbysnIj5cbiAgICAgICA8c3BhbiBjbGFzcz0iJytEWyJpY29uLXRleHQiXSsnIj5pPC9zcGFuPlxuICAgICAgPC9kaXY+XG4gICAgIDxkaXYgY2xhc3M9IicrRC5pY29uKyIgIitCLnN1Y2Nlc3MrJyI+XG4gICAgICAgPGRpdiBjbGFzcz0ic3dhbDItc3VjY2Vzcy1jaXJjdWxhci1saW5lLWxlZnQiPjwvZGl2PlxuICAgICAgIDxzcGFuIGNsYXNzPSJzd2FsMi1zdWNjZXNzLWxpbmUtdGlwIj48L3NwYW4+IDxzcGFuIGNsYXNzPSJzd2FsMi1zdWNjZXNzLWxpbmUtbG9uZyI+PC9zcGFuPlxuICAgICAgIDxkaXYgY2xhc3M9InN3YWwyLXN1Y2Nlc3MtcmluZyI+PC9kaXY+IDxkaXYgY2xhc3M9InN3YWwyLXN1Y2Nlc3MtZml4Ij48L2Rpdj5cbiAgICAgICA8ZGl2IGNsYXNzPSJzd2FsMi1zdWNjZXNzLWNpcmN1bGFyLWxpbmUtcmlnaHQiPjwvZGl2PlxuICAgICA8L2Rpdj5cbiAgICAgPGltZyBjbGFzcz0iJytELmltYWdlKyciIC8+XG4gICAgIDxoMiBjbGFzcz0iJytELnRpdGxlKyciIGlkPSInK0QudGl0bGUrJyI+PC9oMj5cbiAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSInK0QuY2xvc2UrJyI+w5c8L2J1dHRvbj5cbiAgIDwvZGl2PlxuICAgPGRpdiBjbGFzcz0iJytELmNvbnRlbnQrJyI+XG4gICAgIDxkaXYgaWQ9IicrRC5jb250ZW50KyciPjwvZGl2PlxuICAgICA8aW5wdXQgY2xhc3M9IicrRC5pbnB1dCsnIiAvPlxuICAgICA8aW5wdXQgdHlwZT0iZmlsZSIgY2xhc3M9IicrRC5maWxlKyciIC8+XG4gICAgIDxkaXYgY2xhc3M9IicrRC5yYW5nZSsnIj5cbiAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIC8+XG4gICAgICAgPG91dHB1dD48L291dHB1dD5cbiAgICAgPC9kaXY+XG4gICAgIDxzZWxlY3QgY2xhc3M9IicrRC5zZWxlY3QrJyI+PC9zZWxlY3Q+XG4gICAgIDxkaXYgY2xhc3M9IicrRC5yYWRpbysnIj48L2Rpdj5cbiAgICAgPGxhYmVsIGZvcj0iJytELmNoZWNrYm94KyciIGNsYXNzPSInK0QuY2hlY2tib3grJyI+XG4gICAgICAgPGlucHV0IHR5cGU9ImNoZWNrYm94IiAvPlxuICAgICA8L2xhYmVsPlxuICAgICA8dGV4dGFyZWEgY2xhc3M9IicrRC50ZXh0YXJlYSsnIj48L3RleHRhcmVhPlxuICAgICA8ZGl2IGNsYXNzPSInK0QudmFsaWRhdGlvbmVycm9yKyciIGlkPSInK0QudmFsaWRhdGlvbmVycm9yKyciPjwvZGl2PlxuICAgPC9kaXY+XG4gICA8ZGl2IGNsYXNzPSInK0QuYWN0aW9ucysnIj5cbiAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSInK0QuY29uZmlybSsnIj5PSzwvYnV0dG9uPlxuICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9IicrRC5jYW5jZWwrJyI+Q2FuY2VsPC9idXR0b24+XG4gICA8L2Rpdj5cbiAgIDxkaXYgY2xhc3M9IicrRC5mb290ZXIrJyI+XG4gICA8L2Rpdj5cbiA8L2Rpdj5cbicpLnJlcGxhY2UoLyhefFxuKVxzKi9nLCIiKSx0ZT1mdW5jdGlvbihlKXt2YXIgdD1QKCk7aWYodCYmKHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0KSxBKFtkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsZG9jdW1lbnQuYm9keV0sW0RbIm5vLWJhY2tkcm9wIl0sRFsidG9hc3Qtc2hvd24iXSxEWyJoYXMtY29sdW1uIl1dKSksIWIoKSl7dmFyIG49ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7bi5jbGFzc05hbWU9RC5jb250YWluZXIsbi5pbm5lckhUTUw9dywoInN0cmluZyI9PXR5cGVvZiBlLnRhcmdldD9kb2N1bWVudC5xdWVyeVNlbGVjdG9yKGUudGFyZ2V0KTplLnRhcmdldCkuYXBwZW5kQ2hpbGQobik7dmFyIG89RSgpLHI9WigpLGk9eihyLEQuaW5wdXQpLGE9eihyLEQuZmlsZSkscz1yLnF1ZXJ5U2VsZWN0b3IoIi4iK0QucmFuZ2UrIiBpbnB1dCIpLHU9ci5xdWVyeVNlbGVjdG9yKCIuIitELnJhbmdlKyIgb3V0cHV0IiksYz16KHIsRC5zZWxlY3QpLGw9ci5xdWVyeVNlbGVjdG9yKCIuIitELmNoZWNrYm94KyIgaW5wdXQiKSxkPXoocixELnRleHRhcmVhKTtvLnNldEF0dHJpYnV0ZSgicm9sZSIsZS50b2FzdD8iYWxlcnQiOiJkaWFsb2ciKSxvLnNldEF0dHJpYnV0ZSgiYXJpYS1saXZlIixlLnRvYXN0PyJwb2xpdGUiOiJhc3NlcnRpdmUiKSxlLnRvYXN0fHxvLnNldEF0dHJpYnV0ZSgiYXJpYS1tb2RhbCIsInRydWUiKTt2YXIgcD12b2lkIDAsZj1mdW5jdGlvbihlKXtBZS5pc1Zpc2libGUoKSYmcCE9PWUudGFyZ2V0LnZhbHVlJiZBZS5yZXNldFZhbGlkYXRpb25FcnJvcigpLHA9ZS50YXJnZXQudmFsdWV9O3JldHVybiBpLm9uaW5wdXQ9ZixhLm9uY2hhbmdlPWYsYy5vbmNoYW5nZT1mLGwub25jaGFuZ2U9ZixkLm9uaW5wdXQ9ZixzLm9uaW5wdXQ9ZnVuY3Rpb24oZSl7ZihlKSx1LnZhbHVlPXMudmFsdWV9LHMub25jaGFuZ2U9ZnVuY3Rpb24oZSl7ZihlKSxzLm5leHRTaWJsaW5nLnZhbHVlPXMudmFsdWV9LG99SSgiU3dlZXRBbGVydDIgcmVxdWlyZXMgZG9jdW1lbnQgdG8gaW5pdGlhbGl6ZSIpfSxuZT1mdW5jdGlvbihlLHQpe2lmKCFlKXJldHVybiBGKHQpO2lmKCJvYmplY3QiPT09KHZvaWQgMD09PWU/InVuZGVmaW5lZCI6cShlKSkpaWYodC5pbm5lckhUTUw9IiIsMCBpbiBlKWZvcih2YXIgbj0wO24gaW4gZTtuKyspdC5hcHBlbmRDaGlsZChlW25dLmNsb25lTm9kZSghMCkpO2Vsc2UgdC5hcHBlbmRDaGlsZChlLmNsb25lTm9kZSghMCkpO2Vsc2UgZSYmKHQuaW5uZXJIVE1MPWUpO1UodCl9LEM9ZnVuY3Rpb24oKXtpZihiKCkpcmV0dXJuITE7dmFyIGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IiksdD17V2Via2l0QW5pbWF0aW9uOiJ3ZWJraXRBbmltYXRpb25FbmQiLE9BbmltYXRpb246Im9BbmltYXRpb25FbmQgb2FuaW1hdGlvbmVuZCIsYW5pbWF0aW9uOiJhbmltYXRpb25lbmQifTtmb3IodmFyIG4gaW4gdClpZih0Lmhhc093blByb3BlcnR5KG4pJiZ2b2lkIDAhPT1lLnN0eWxlW25dKXJldHVybiB0W25dO3JldHVybiExfSgpLG9lPWZ1bmN0aW9uKHIpe3ZhciBpPWcoKSxhPXBhcnNlSW50KG51bGw9PT1yLmN1cnJlbnRQcm9ncmVzc1N0ZXA/QWUuZ2V0UXVldWVTdGVwKCk6ci5jdXJyZW50UHJvZ3Jlc3NTdGVwLDEwKTtyLnByb2dyZXNzU3RlcHMmJnIucHJvZ3Jlc3NTdGVwcy5sZW5ndGg/KFUoaSksZnVuY3Rpb24oZSl7Zm9yKDtlLmZpcnN0Q2hpbGQ7KWUucmVtb3ZlQ2hpbGQoZS5maXJzdENoaWxkKX0oaSksYT49ci5wcm9ncmVzc1N0ZXBzLmxlbmd0aCYmeCgiSW52YWxpZCBjdXJyZW50UHJvZ3Jlc3NTdGVwIHBhcmFtZXRlciwgaXQgc2hvdWxkIGJlIGxlc3MgdGhhbiBwcm9ncmVzc1N0ZXBzLmxlbmd0aCAoY3VycmVudFByb2dyZXNzU3RlcCBsaWtlIEpTIGFycmF5cyBzdGFydHMgZnJvbSAwKSIpLHIucHJvZ3Jlc3NTdGVwcy5mb3JFYWNoKGZ1bmN0aW9uKGUsdCl7dmFyIG49ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgibGkiKTtpZihXKG4sRC5wcm9ncmVzc2NpcmNsZSksbi5pbm5lckhUTUw9ZSx0PT09YSYmVyhuLEQuYWN0aXZlcHJvZ3Jlc3NzdGVwKSxpLmFwcGVuZENoaWxkKG4pLHQhPT1yLnByb2dyZXNzU3RlcHMubGVuZ3RoLTEpe3ZhciBvPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImxpIik7VyhvLEQucHJvZ3Jlc3NsaW5lKSxyLnByb2dyZXNzU3RlcHNEaXN0YW5jZSYmKG8uc3R5bGUud2lkdGg9ci5wcm9ncmVzc1N0ZXBzRGlzdGFuY2UpLGkuYXBwZW5kQ2hpbGQobyl9fSkpOkYoaSl9LGs9ZnVuY3Rpb24oKXtudWxsPT09cC5wcmV2aW91c0JvZHlQYWRkaW5nJiZkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodD53aW5kb3cuaW5uZXJIZWlnaHQmJihwLnByZXZpb3VzQm9keVBhZGRpbmc9cGFyc2VJbnQod2luZG93LmdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZSgicGFkZGluZy1yaWdodCIpKSxkb2N1bWVudC5ib2R5LnN0eWxlLnBhZGRpbmdSaWdodD1wLnByZXZpb3VzQm9keVBhZGRpbmcrZnVuY3Rpb24oKXtpZigib250b3VjaHN0YXJ0ImluIHdpbmRvd3x8bmF2aWdhdG9yLm1zTWF4VG91Y2hQb2ludHMpcmV0dXJuIDA7dmFyIGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7ZS5zdHlsZS53aWR0aD0iNTBweCIsZS5zdHlsZS5oZWlnaHQ9IjUwcHgiLGUuc3R5bGUub3ZlcmZsb3c9InNjcm9sbCIsZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlKTt2YXIgdD1lLm9mZnNldFdpZHRoLWUuY2xpZW50V2lkdGg7cmV0dXJuIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZSksdH0oKSsicHgiKX0scmU9e30sVD1mdW5jdGlvbihlLG4pe3ZhciBvPVAoKSx0PUUoKTtpZih0KXtudWxsIT09ZSYmImZ1bmN0aW9uIj09dHlwZW9mIGUmJmUodCksQSh0LEQuc2hvdyksVyh0LEQuaGlkZSk7dmFyIHI9ZnVuY3Rpb24oKXt2YXIgZSx0O3koKXx8KGU9d2luZG93LnNjcm9sbFgsdD13aW5kb3cuc2Nyb2xsWSxyZS5yZXN0b3JlRm9jdXNUaW1lb3V0PXNldFRpbWVvdXQoZnVuY3Rpb24oKXtyZS5wcmV2aW91c0FjdGl2ZUVsZW1lbnQmJnJlLnByZXZpb3VzQWN0aXZlRWxlbWVudC5mb2N1cyYmKHJlLnByZXZpb3VzQWN0aXZlRWxlbWVudC5mb2N1cygpLHJlLnByZXZpb3VzQWN0aXZlRWxlbWVudD1udWxsKX0sMTAwKSx2b2lkIDAhPT1lJiZ2b2lkIDAhPT10JiZ3aW5kb3cuc2Nyb2xsVG8oZSx0KSxyZS5rZXlkb3duVGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoImtleWRvd24iLHJlLmtleWRvd25IYW5kbGVyLHtjYXB0dXJlOnJlLmtleWRvd25MaXN0ZW5lckNhcHR1cmV9KSxyZS5rZXlkb3duSGFuZGxlckFkZGVkPSExKSxvLnBhcmVudE5vZGUmJm8ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChvKSxBKFtkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsZG9jdW1lbnQuYm9keV0sW0Quc2hvd24sRFsiaGVpZ2h0LWF1dG8iXSxEWyJuby1iYWNrZHJvcCJdLERbInRvYXN0LXNob3duIl0sRFsidG9hc3QtY29sdW1uIl1dKSx2KCkmJihudWxsIT09cC5wcmV2aW91c0JvZHlQYWRkaW5nJiYoZG9jdW1lbnQuYm9keS5zdHlsZS5wYWRkaW5nUmlnaHQ9cC5wcmV2aW91c0JvZHlQYWRkaW5nLHAucHJldmlvdXNCb2R5UGFkZGluZz1udWxsKSxmdW5jdGlvbigpe2lmKGYoZG9jdW1lbnQuYm9keSxELmlvc2ZpeCkpe3ZhciBlPXBhcnNlSW50KGRvY3VtZW50LmJvZHkuc3R5bGUudG9wLDEwKTtBKGRvY3VtZW50LmJvZHksRC5pb3NmaXgpLGRvY3VtZW50LmJvZHkuc3R5bGUudG9wPSIiLGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wPS0xKmV9fSgpKSxudWxsIT09biYmImZ1bmN0aW9uIj09dHlwZW9mIG4mJnNldFRpbWVvdXQoZnVuY3Rpb24oKXtuKCl9KX07QyYmIWYodCxELm5vYW5pbWF0aW9uKT90LmFkZEV2ZW50TGlzdGVuZXIoQyxmdW5jdGlvbiBlKCl7dC5yZW1vdmVFdmVudExpc3RlbmVyKEMsZSksZih0LEQuaGlkZSkmJnIoKX0pOnIoKX19O2Z1bmN0aW9uIGooZSl7dmFyIHQ9ZnVuY3Rpb24gZSgpe2Zvcih2YXIgdD1hcmd1bWVudHMubGVuZ3RoLG49QXJyYXkodCksbz0wO288dDtvKyspbltvXT1hcmd1bWVudHNbb107aWYoISh0aGlzIGluc3RhbmNlb2YgZSkpcmV0dXJuIG5ldyhGdW5jdGlvbi5wcm90b3R5cGUuYmluZC5hcHBseShlLFtudWxsXS5jb25jYXQobikpKTtPYmplY3QuZ2V0UHJvdG90eXBlT2YoZSkuYXBwbHkodGhpcyxuKX07cmV0dXJuIHQucHJvdG90eXBlPXIoT2JqZWN0LmNyZWF0ZShlLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOnR9KSwiZnVuY3Rpb24iPT10eXBlb2YgT2JqZWN0LnNldFByb3RvdHlwZU9mP09iamVjdC5zZXRQcm90b3R5cGVPZih0LGUpOnQuX19wcm90b19fPWUsdH12YXIgaWU9e3RpdGxlOiIiLHRpdGxlVGV4dDoiIix0ZXh0OiIiLGh0bWw6IiIsZm9vdGVyOiIiLHR5cGU6bnVsbCx0b2FzdDohMSxjdXN0b21DbGFzczoiIix0YXJnZXQ6ImJvZHkiLGJhY2tkcm9wOiEwLGFuaW1hdGlvbjohMCxoZWlnaHRBdXRvOiEwLGFsbG93T3V0c2lkZUNsaWNrOiEwLGFsbG93RXNjYXBlS2V5OiEwLGFsbG93RW50ZXJLZXk6ITAsc3RvcEtleWRvd25Qcm9wYWdhdGlvbjohMCxrZXlkb3duTGlzdGVuZXJDYXB0dXJlOiExLHNob3dDb25maXJtQnV0dG9uOiEwLHNob3dDYW5jZWxCdXR0b246ITEscHJlQ29uZmlybTpudWxsLGNvbmZpcm1CdXR0b25UZXh0OiJPSyIsY29uZmlybUJ1dHRvbkFyaWFMYWJlbDoiIixjb25maXJtQnV0dG9uQ29sb3I6bnVsbCxjb25maXJtQnV0dG9uQ2xhc3M6bnVsbCxjYW5jZWxCdXR0b25UZXh0OiJDYW5jZWwiLGNhbmNlbEJ1dHRvbkFyaWFMYWJlbDoiIixjYW5jZWxCdXR0b25Db2xvcjpudWxsLGNhbmNlbEJ1dHRvbkNsYXNzOm51bGwsYnV0dG9uc1N0eWxpbmc6ITAscmV2ZXJzZUJ1dHRvbnM6ITEsZm9jdXNDb25maXJtOiEwLGZvY3VzQ2FuY2VsOiExLHNob3dDbG9zZUJ1dHRvbjohMSxjbG9zZUJ1dHRvbkFyaWFMYWJlbDoiQ2xvc2UgdGhpcyBkaWFsb2ciLHNob3dMb2FkZXJPbkNvbmZpcm06ITEsaW1hZ2VVcmw6bnVsbCxpbWFnZVdpZHRoOm51bGwsaW1hZ2VIZWlnaHQ6bnVsbCxpbWFnZUFsdDoiIixpbWFnZUNsYXNzOm51bGwsdGltZXI6bnVsbCx3aWR0aDpudWxsLHBhZGRpbmc6bnVsbCxiYWNrZ3JvdW5kOm51bGwsaW5wdXQ6bnVsbCxpbnB1dFBsYWNlaG9sZGVyOiIiLGlucHV0VmFsdWU6IiIsaW5wdXRPcHRpb25zOnt9LGlucHV0QXV0b1RyaW06ITAsaW5wdXRDbGFzczpudWxsLGlucHV0QXR0cmlidXRlczp7fSxpbnB1dFZhbGlkYXRvcjpudWxsLGdyb3c6ITEscG9zaXRpb246ImNlbnRlciIscHJvZ3Jlc3NTdGVwczpbXSxjdXJyZW50UHJvZ3Jlc3NTdGVwOm51bGwscHJvZ3Jlc3NTdGVwc0Rpc3RhbmNlOm51bGwsb25CZWZvcmVPcGVuOm51bGwsb25BZnRlckNsb3NlOm51bGwsb25PcGVuOm51bGwsb25DbG9zZTpudWxsLHVzZVJlamVjdGlvbnM6ITEsZXhwZWN0UmVqZWN0aW9uczohMX0sXz1bInVzZVJlamVjdGlvbnMiLCJleHBlY3RSZWplY3Rpb25zIl0sVj1mdW5jdGlvbihlKXtyZXR1cm4gaWUuaGFzT3duUHJvcGVydHkoZSl8fCJleHRyYVBhcmFtcyI9PT1lfSxhZT1mdW5jdGlvbihlKXtyZXR1cm4tMSE9PV8uaW5kZXhPZihlKX0sc2U9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0IGluIGUpVih0KXx8eCgnVW5rbm93biBwYXJhbWV0ZXIgIicrdCsnIicpLGFlKHQpJiZsKCdUaGUgcGFyYW1ldGVyICInK3QrJyIgaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIHRoZSBuZXh0IG1ham9yIHJlbGVhc2UuJyl9LHVlPScic2V0RGVmYXVsdHMiICYgInJlc2V0RGVmYXVsdHMiIG1ldGhvZHMgYXJlIGRlcHJlY2F0ZWQgaW4gZmF2b3Igb2YgIm1peGluIiBtZXRob2QgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiB0aGUgbmV4dCBtYWpvciByZWxlYXNlLiBGb3IgbmV3IHByb2plY3RzLCB1c2UgIm1peGluIi4gRm9yIHBhc3QgcHJvamVjdHMgYWxyZWFkeSB1c2luZyAic2V0RGVmYXVsdHMiLCBzdXBwb3J0IHdpbGwgYmUgcHJvdmlkZWQgdGhyb3VnaCBhbiBhZGRpdGlvbmFsIHBhY2thZ2UuJyxjZT17fTt2YXIgbGU9W10sZGU9ZnVuY3Rpb24oKXt2YXIgZT1FKCk7ZXx8QWUoIiIpLGU9RSgpO3ZhciB0PUooKSxuPVkoKSxvPSQoKTtVKHQpLFUobiksVyhbZSx0XSxELmxvYWRpbmcpLG4uZGlzYWJsZWQ9ITAsby5kaXNhYmxlZD0hMCxlLnNldEF0dHJpYnV0ZSgiZGF0YS1sb2FkaW5nIiwhMCksZS5zZXRBdHRyaWJ1dGUoImFyaWEtYnVzeSIsITApLGUuZm9jdXMoKX0scGU9T2JqZWN0LmZyZWV6ZSh7aXNWYWxpZFBhcmFtZXRlcjpWLGlzRGVwcmVjYXRlZFBhcmFtZXRlcjphZSxhcmdzVG9QYXJhbXM6ZnVuY3Rpb24obil7dmFyIG89e307c3dpdGNoKHEoblswXSkpe2Nhc2Uic3RyaW5nIjpbInRpdGxlIiwiaHRtbCIsInR5cGUiXS5mb3JFYWNoKGZ1bmN0aW9uKGUsdCl7c3dpdGNoKHEoblt0XSkpe2Nhc2Uic3RyaW5nIjpvW2VdPW5bdF07YnJlYWs7Y2FzZSJ1bmRlZmluZWQiOmJyZWFrO2RlZmF1bHQ6SSgiVW5leHBlY3RlZCB0eXBlIG9mICIrZSsnISBFeHBlY3RlZCAic3RyaW5nIiwgZ290ICcrcShuW3RdKSl9fSk7YnJlYWs7Y2FzZSJvYmplY3QiOnIobyxuWzBdKTticmVhaztkZWZhdWx0OnJldHVybiBJKCdVbmV4cGVjdGVkIHR5cGUgb2YgYXJndW1lbnQhIEV4cGVjdGVkICJzdHJpbmciIG9yICJvYmplY3QiLCBnb3QgJytxKG5bMF0pKSwhMX1yZXR1cm4gb30sYWRhcHRJbnB1dFZhbGlkYXRvcjpmdW5jdGlvbihuKXtyZXR1cm4gZnVuY3Rpb24oZSx0KXtyZXR1cm4gbi5jYWxsKHRoaXMsZSx0KS50aGVuKGZ1bmN0aW9uKCl7fSxmdW5jdGlvbihlKXtyZXR1cm4gZX0pfX0sY2xvc2U6VCxjbG9zZVBvcHVwOlQsY2xvc2VNb2RhbDpULGNsb3NlVG9hc3Q6VCxpc1Zpc2libGU6ZnVuY3Rpb24oKXtyZXR1cm4hIUUoKX0sY2xpY2tDb25maXJtOmZ1bmN0aW9uKCl7cmV0dXJuIFkoKS5jbGljaygpfSxjbGlja0NhbmNlbDpmdW5jdGlvbigpe3JldHVybiAkKCkuY2xpY2soKX0sZ2V0UG9wdXA6RSxnZXRUaXRsZTpMLGdldENvbnRlbnQ6WixnZXRJbWFnZTpRLGdldEljb25zOk8sZ2V0Q2xvc2VCdXR0b246RyxnZXRCdXR0b25zV3JhcHBlcjpmdW5jdGlvbigpe3JldHVybiBsKCJzd2FsLmdldEJ1dHRvbnNXcmFwcGVyKCkgaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIHRoZSBuZXh0IG1ham9yIHJlbGVhc2UsIHVzZSBzd2FsLmdldEFjdGlvbnMoKSBpbnN0ZWFkIiksaChELmFjdGlvbnMpfSxnZXRBY3Rpb25zOkosZ2V0Q29uZmlybUJ1dHRvbjpZLGdldENhbmNlbEJ1dHRvbjokLGdldEZvb3RlcjpYLGdldEZvY3VzYWJsZUVsZW1lbnRzOmVlLGlzTG9hZGluZzpmdW5jdGlvbigpe3JldHVybiBFKCkuaGFzQXR0cmlidXRlKCJkYXRhLWxvYWRpbmciKX0sZmlyZTpmdW5jdGlvbigpe2Zvcih2YXIgZT1hcmd1bWVudHMubGVuZ3RoLHQ9QXJyYXkoZSksbj0wO248ZTtuKyspdFtuXT1hcmd1bWVudHNbbl07cmV0dXJuIG5ldyhGdW5jdGlvbi5wcm90b3R5cGUuYmluZC5hcHBseSh0aGlzLFtudWxsXS5jb25jYXQodCkpKX0sbWl4aW46ZnVuY3Rpb24obil7cmV0dXJuIGooZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe3JldHVybiBzKHRoaXMsdCksdSh0aGlzLCh0Ll9fcHJvdG9fX3x8T2JqZWN0LmdldFByb3RvdHlwZU9mKHQpKS5hcHBseSh0aGlzLGFyZ3VtZW50cykpfXJldHVybiBhKHQsZSksbyh0LFt7a2V5OiJfbWFpbiIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGkodC5wcm90b3R5cGUuX19wcm90b19ffHxPYmplY3QuZ2V0UHJvdG90eXBlT2YodC5wcm90b3R5cGUpLCJfbWFpbiIsdGhpcykuY2FsbCh0aGlzLHIoe30sbixlKSl9fV0pLHR9KHRoaXMpKX0scXVldWU6ZnVuY3Rpb24oZSl7dmFyIGk9dGhpcztsZT1lO3ZhciBhPWZ1bmN0aW9uKCl7bGU9W10sZG9jdW1lbnQuYm9keS5yZW1vdmVBdHRyaWJ1dGUoImRhdGEtc3dhbDItcXVldWUtc3RlcCIpfSxzPVtdO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyKXshZnVuY3Rpb24gdChuLG8pe248bGUubGVuZ3RoPyhkb2N1bWVudC5ib2R5LnNldEF0dHJpYnV0ZSgiZGF0YS1zd2FsMi1xdWV1ZS1zdGVwIixuKSxpKGxlW25dKS50aGVuKGZ1bmN0aW9uKGUpe3ZvaWQgMCE9PWUudmFsdWU/KHMucHVzaChlLnZhbHVlKSx0KG4rMSxvKSk6KGEoKSxyKHtkaXNtaXNzOmUuZGlzbWlzc30pKX0pKTooYSgpLHIoe3ZhbHVlOnN9KSl9KDApfSl9LGdldFF1ZXVlU3RlcDpmdW5jdGlvbigpe3JldHVybiBkb2N1bWVudC5ib2R5LmdldEF0dHJpYnV0ZSgiZGF0YS1zd2FsMi1xdWV1ZS1zdGVwIil9LGluc2VydFF1ZXVlU3RlcDpmdW5jdGlvbihlLHQpe3JldHVybiB0JiZ0PGxlLmxlbmd0aD9sZS5zcGxpY2UodCwwLGUpOmxlLnB1c2goZSl9LGRlbGV0ZVF1ZXVlU3RlcDpmdW5jdGlvbihlKXt2b2lkIDAhPT1sZVtlXSYmbGUuc3BsaWNlKGUsMSl9LHNob3dMb2FkaW5nOmRlLGVuYWJsZUxvYWRpbmc6ZGUsZ2V0VGltZXJMZWZ0OmZ1bmN0aW9uKCl7cmV0dXJuIHJlLnRpbWVvdXQmJnJlLnRpbWVvdXQuZ2V0VGltZXJMZWZ0KCl9fSksZmU9ImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbD9TeW1ib2w6ZnVuY3Rpb24oKXt2YXIgdD0wO2Z1bmN0aW9uIGUoZSl7cmV0dXJuIl9fIitlKyJfIitNYXRoLmZsb29yKDFlOSpNYXRoLnJhbmRvbSgpKSsiXyIrICsrdCsiX18ifXJldHVybiBlLml0ZXJhdG9yPWUoIlN5bWJvbC5pdGVyYXRvciIpLGV9KCksbWU9ImZ1bmN0aW9uIj09dHlwZW9mIFdlYWtNYXA/V2Vha01hcDpmdW5jdGlvbihuLG8sdCl7ZnVuY3Rpb24gZSgpe28odGhpcyxuLHt2YWx1ZTpmZSgiV2Vha01hcCIpfSl9cmV0dXJuIGUucHJvdG90eXBlPXtkZWxldGU6ZnVuY3Rpb24oZSl7ZGVsZXRlIGVbdGhpc1tuXV19LGdldDpmdW5jdGlvbihlKXtyZXR1cm4gZVt0aGlzW25dXX0saGFzOmZ1bmN0aW9uKGUpe3JldHVybiB0LmNhbGwoZSx0aGlzW25dKX0sc2V0OmZ1bmN0aW9uKGUsdCl7byhlLHRoaXNbbl0se2NvbmZpZ3VyYWJsZTohMCx2YWx1ZTp0fSl9fSxlfShmZSgiV2Vha01hcCIpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSx7fS5oYXNPd25Qcm9wZXJ0eSksaGU9e3Byb21pc2U6bmV3IG1lLGlubmVyUGFyYW1zOm5ldyBtZSxkb21DYWNoZTpuZXcgbWV9O2Z1bmN0aW9uIGdlKCl7dmFyIGU9aGUuaW5uZXJQYXJhbXMuZ2V0KHRoaXMpLHQ9aGUuZG9tQ2FjaGUuZ2V0KHRoaXMpO2Uuc2hvd0NvbmZpcm1CdXR0b258fChGKHQuY29uZmlybUJ1dHRvbiksZS5zaG93Q2FuY2VsQnV0dG9ufHxGKHQuYWN0aW9ucykpLEEoW3QucG9wdXAsdC5hY3Rpb25zXSxELmxvYWRpbmcpLHQucG9wdXAucmVtb3ZlQXR0cmlidXRlKCJhcmlhLWJ1c3kiKSx0LnBvcHVwLnJlbW92ZUF0dHJpYnV0ZSgiZGF0YS1sb2FkaW5nIiksdC5jb25maXJtQnV0dG9uLmRpc2FibGVkPSExLHQuY2FuY2VsQnV0dG9uLmRpc2FibGVkPSExfXZhciB2ZT1mdW5jdGlvbiBlKHQsbil7cyh0aGlzLGUpO3ZhciBvPXZvaWQgMCxyPXZvaWQgMCxpPXZvaWQgMCxhPW47dGhpcy5zdGFydD1mdW5jdGlvbigpe2k9ITAscj1uZXcgRGF0ZSxvPXNldFRpbWVvdXQodCxhKX0sdGhpcy5zdG9wPWZ1bmN0aW9uKCl7aT0hMSxjbGVhclRpbWVvdXQobyksYS09bmV3IERhdGUtcn0sdGhpcy5nZXRUaW1lckxlZnQ9ZnVuY3Rpb24oKXtyZXR1cm4gaSYmKHRoaXMuc3RvcCgpLHRoaXMuc3RhcnQoKSksYX0sdGhpcy5nZXRTdGF0ZVJ1bm5pbmc9ZnVuY3Rpb24oKXtyZXR1cm4gaX0sdGhpcy5zdGFydCgpfSx5ZT17ZW1haWw6ZnVuY3Rpb24oZSx0KXtyZXR1cm4vXlthLXpBLVowLTkuK18tXStAW2EtekEtWjAtOS4tXStcLlthLXpBLVowLTktXXsyLDI0fSQvLnRlc3QoZSk/UHJvbWlzZS5yZXNvbHZlKCk6UHJvbWlzZS5yZWplY3QodCYmdC52YWxpZGF0aW9uTWVzc2FnZT90LnZhbGlkYXRpb25NZXNzYWdlOiJJbnZhbGlkIGVtYWlsIGFkZHJlc3MiKX0sdXJsOmZ1bmN0aW9uKGUsdCl7cmV0dXJuL15odHRwcz86XC9cLyh3d3dcLik/Wy1hLXpBLVowLTlAOiUuXyt+Iz1dezIsMjU2fVwuW2Etel17Miw2fVxiKFstYS16QS1aMC05QDolXysufiM/Ji8vPV0qKSQvLnRlc3QoZSk/UHJvbWlzZS5yZXNvbHZlKCk6UHJvbWlzZS5yZWplY3QodCYmdC52YWxpZGF0aW9uTWVzc2FnZT90LnZhbGlkYXRpb25NZXNzYWdlOiJJbnZhbGlkIFVSTCIpfX07dmFyIGJlPWZ1bmN0aW9uKGUpe3ZhciB0PVAoKSxuPUUoKTtudWxsIT09ZS5vbkJlZm9yZU9wZW4mJiJmdW5jdGlvbiI9PXR5cGVvZiBlLm9uQmVmb3JlT3BlbiYmZS5vbkJlZm9yZU9wZW4obiksZS5hbmltYXRpb24/KFcobixELnNob3cpLFcodCxELmZhZGUpLEEobixELmhpZGUpKTpBKG4sRC5mYWRlKSxVKG4pLHQuc3R5bGUub3ZlcmZsb3dZPSJoaWRkZW4iLEMmJiFmKG4sRC5ub2FuaW1hdGlvbik/bi5hZGRFdmVudExpc3RlbmVyKEMsZnVuY3Rpb24gZSgpe24ucmVtb3ZlRXZlbnRMaXN0ZW5lcihDLGUpLHQuc3R5bGUub3ZlcmZsb3dZPSJhdXRvIn0pOnQuc3R5bGUub3ZlcmZsb3dZPSJhdXRvIixXKFtkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsZG9jdW1lbnQuYm9keSx0XSxELnNob3duKSxlLmhlaWdodEF1dG8mJmUuYmFja2Ryb3AmJiFlLnRvYXN0JiZXKFtkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsZG9jdW1lbnQuYm9keV0sRFsiaGVpZ2h0LWF1dG8iXSksdigpJiYoaygpLGZ1bmN0aW9uKCl7aWYoL2lQYWR8aVBob25lfGlQb2QvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkmJiF3aW5kb3cuTVNTdHJlYW0mJiFmKGRvY3VtZW50LmJvZHksRC5pb3NmaXgpKXt2YXIgZT1kb2N1bWVudC5ib2R5LnNjcm9sbFRvcDtkb2N1bWVudC5ib2R5LnN0eWxlLnRvcD0tMSplKyJweCIsVyhkb2N1bWVudC5ib2R5LEQuaW9zZml4KX19KCkpLHkoKXx8cmUucHJldmlvdXNBY3RpdmVFbGVtZW50fHwocmUucHJldmlvdXNBY3RpdmVFbGVtZW50PWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpLG51bGwhPT1lLm9uT3BlbiYmImZ1bmN0aW9uIj09dHlwZW9mIGUub25PcGVuJiZzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZS5vbk9wZW4obil9KX07dmFyIHdlPU9iamVjdC5mcmVlemUoe2hpZGVMb2FkaW5nOmdlLGRpc2FibGVMb2FkaW5nOmdlLGdldElucHV0OmZ1bmN0aW9uKGUpe3ZhciB0PWhlLmlubmVyUGFyYW1zLmdldCh0aGlzKSxuPWhlLmRvbUNhY2hlLmdldCh0aGlzKTtpZighKGU9ZXx8dC5pbnB1dCkpcmV0dXJuIG51bGw7c3dpdGNoKGUpe2Nhc2Uic2VsZWN0IjpjYXNlInRleHRhcmVhIjpjYXNlImZpbGUiOnJldHVybiB6KG4uY29udGVudCxEW2VdKTtjYXNlImNoZWNrYm94IjpyZXR1cm4gbi5wb3B1cC5xdWVyeVNlbGVjdG9yKCIuIitELmNoZWNrYm94KyIgaW5wdXQiKTtjYXNlInJhZGlvIjpyZXR1cm4gbi5wb3B1cC5xdWVyeVNlbGVjdG9yKCIuIitELnJhZGlvKyIgaW5wdXQ6Y2hlY2tlZCIpfHxuLnBvcHVwLnF1ZXJ5U2VsZWN0b3IoIi4iK0QucmFkaW8rIiBpbnB1dDpmaXJzdC1jaGlsZCIpO2Nhc2UicmFuZ2UiOnJldHVybiBuLnBvcHVwLnF1ZXJ5U2VsZWN0b3IoIi4iK0QucmFuZ2UrIiBpbnB1dCIpO2RlZmF1bHQ6cmV0dXJuIHoobi5jb250ZW50LEQuaW5wdXQpfX0sZW5hYmxlQnV0dG9uczpmdW5jdGlvbigpe3ZhciBlPWhlLmRvbUNhY2hlLmdldCh0aGlzKTtlLmNvbmZpcm1CdXR0b24uZGlzYWJsZWQ9ITEsZS5jYW5jZWxCdXR0b24uZGlzYWJsZWQ9ITF9LGRpc2FibGVCdXR0b25zOmZ1bmN0aW9uKCl7dmFyIGU9aGUuZG9tQ2FjaGUuZ2V0KHRoaXMpO2UuY29uZmlybUJ1dHRvbi5kaXNhYmxlZD0hMCxlLmNhbmNlbEJ1dHRvbi5kaXNhYmxlZD0hMH0sZW5hYmxlQ29uZmlybUJ1dHRvbjpmdW5jdGlvbigpe2hlLmRvbUNhY2hlLmdldCh0aGlzKS5jb25maXJtQnV0dG9uLmRpc2FibGVkPSExfSxkaXNhYmxlQ29uZmlybUJ1dHRvbjpmdW5jdGlvbigpe2hlLmRvbUNhY2hlLmdldCh0aGlzKS5jb25maXJtQnV0dG9uLmRpc2FibGVkPSEwfSxlbmFibGVJbnB1dDpmdW5jdGlvbigpe3ZhciBlPXRoaXMuZ2V0SW5wdXQoKTtpZighZSlyZXR1cm4hMTtpZigicmFkaW8iPT09ZS50eXBlKWZvcih2YXIgdD1lLnBhcmVudE5vZGUucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yQWxsKCJpbnB1dCIpLG49MDtuPHQubGVuZ3RoO24rKyl0W25dLmRpc2FibGVkPSExO2Vsc2UgZS5kaXNhYmxlZD0hMX0sZGlzYWJsZUlucHV0OmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5nZXRJbnB1dCgpO2lmKCFlKXJldHVybiExO2lmKGUmJiJyYWRpbyI9PT1lLnR5cGUpZm9yKHZhciB0PWUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3JBbGwoImlucHV0Iiksbj0wO248dC5sZW5ndGg7bisrKXRbbl0uZGlzYWJsZWQ9ITA7ZWxzZSBlLmRpc2FibGVkPSEwfSxzaG93VmFsaWRhdGlvbkVycm9yOmZ1bmN0aW9uKGUpe3ZhciB0PWhlLmRvbUNhY2hlLmdldCh0aGlzKTt0LnZhbGlkYXRpb25FcnJvci5pbm5lckhUTUw9ZTt2YXIgbj13aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0LnBvcHVwKTt0LnZhbGlkYXRpb25FcnJvci5zdHlsZS5tYXJnaW5MZWZ0PSItIituLmdldFByb3BlcnR5VmFsdWUoInBhZGRpbmctbGVmdCIpLHQudmFsaWRhdGlvbkVycm9yLnN0eWxlLm1hcmdpblJpZ2h0PSItIituLmdldFByb3BlcnR5VmFsdWUoInBhZGRpbmctcmlnaHQiKSxVKHQudmFsaWRhdGlvbkVycm9yKTt2YXIgbz10aGlzLmdldElucHV0KCk7byYmKG8uc2V0QXR0cmlidXRlKCJhcmlhLWludmFsaWQiLCEwKSxvLnNldEF0dHJpYnV0ZSgiYXJpYS1kZXNjcmliZWRCeSIsRC52YWxpZGF0aW9uZXJyb3IpLE4obyksVyhvLEQuaW5wdXRlcnJvcikpfSxyZXNldFZhbGlkYXRpb25FcnJvcjpmdW5jdGlvbigpe3ZhciBlPWhlLmRvbUNhY2hlLmdldCh0aGlzKTtlLnZhbGlkYXRpb25FcnJvciYmRihlLnZhbGlkYXRpb25FcnJvcik7dmFyIHQ9dGhpcy5nZXRJbnB1dCgpO3QmJih0LnJlbW92ZUF0dHJpYnV0ZSgiYXJpYS1pbnZhbGlkIiksdC5yZW1vdmVBdHRyaWJ1dGUoImFyaWEtZGVzY3JpYmVkQnkiKSxBKHQsRC5pbnB1dGVycm9yKSl9LGdldFByb2dyZXNzU3RlcHM6ZnVuY3Rpb24oKXtyZXR1cm4gaGUuaW5uZXJQYXJhbXMuZ2V0KHRoaXMpLnByb2dyZXNzU3RlcHN9LHNldFByb2dyZXNzU3RlcHM6ZnVuY3Rpb24oZSl7dmFyIHQ9aGUuaW5uZXJQYXJhbXMuZ2V0KHRoaXMpLG49cih7fSx0LHtwcm9ncmVzc1N0ZXBzOmV9KTtoZS5pbm5lclBhcmFtcy5zZXQodGhpcyxuKSxvZShuKX0sc2hvd1Byb2dyZXNzU3RlcHM6ZnVuY3Rpb24oKXt2YXIgZT1oZS5kb21DYWNoZS5nZXQodGhpcyk7VShlLnByb2dyZXNzU3RlcHMpfSxoaWRlUHJvZ3Jlc3NTdGVwczpmdW5jdGlvbigpe3ZhciBlPWhlLmRvbUNhY2hlLmdldCh0aGlzKTtGKGUucHJvZ3Jlc3NTdGVwcyl9LF9tYWluOmZ1bmN0aW9uKGUpe3ZhciBUPXRoaXM7c2UoZSk7dmFyIGo9cih7fSxpZSxlKTshZnVuY3Rpb24odCl7dC5pbnB1dFZhbGlkYXRvcnx8T2JqZWN0LmtleXMoeWUpLmZvckVhY2goZnVuY3Rpb24oZSl7dC5pbnB1dD09PWUmJih0LmlucHV0VmFsaWRhdG9yPXQuZXhwZWN0UmVqZWN0aW9ucz95ZVtlXTpBZS5hZGFwdElucHV0VmFsaWRhdG9yKHllW2VdKSl9KSwoIXQudGFyZ2V0fHwic3RyaW5nIj09dHlwZW9mIHQudGFyZ2V0JiYhZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0LnRhcmdldCl8fCJzdHJpbmciIT10eXBlb2YgdC50YXJnZXQmJiF0LnRhcmdldC5hcHBlbmRDaGlsZCkmJih4KCdUYXJnZXQgcGFyYW1ldGVyIGlzIG5vdCB2YWxpZCwgZGVmYXVsdGluZyB0byAiYm9keSInKSx0LnRhcmdldD0iYm9keSIpO3ZhciBlPXZvaWQgMCxuPUUoKSxvPSJzdHJpbmciPT10eXBlb2YgdC50YXJnZXQ/ZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0LnRhcmdldCk6dC50YXJnZXQ7ZT1uJiZvJiZuLnBhcmVudE5vZGUhPT1vLnBhcmVudE5vZGU/dGUodCk6bnx8dGUodCksdC53aWR0aCYmKGUuc3R5bGUud2lkdGg9Im51bWJlciI9PXR5cGVvZiB0LndpZHRoP3Qud2lkdGgrInB4Ijp0LndpZHRoKSx0LnBhZGRpbmcmJihlLnN0eWxlLnBhZGRpbmc9Im51bWJlciI9PXR5cGVvZiB0LnBhZGRpbmc/dC5wYWRkaW5nKyJweCI6dC5wYWRkaW5nKSx0LmJhY2tncm91bmQmJihlLnN0eWxlLmJhY2tncm91bmQ9dC5iYWNrZ3JvdW5kKTtmb3IodmFyIHI9d2luZG93LmdldENvbXB1dGVkU3R5bGUoZSkuZ2V0UHJvcGVydHlWYWx1ZSgiYmFja2dyb3VuZC1jb2xvciIpLGk9ZS5xdWVyeVNlbGVjdG9yQWxsKCJbY2xhc3NePXN3YWwyLXN1Y2Nlc3MtY2lyY3VsYXItbGluZV0sIC5zd2FsMi1zdWNjZXNzLWZpeCIpLGE9MDthPGkubGVuZ3RoO2ErKylpW2FdLnN0eWxlLmJhY2tncm91bmRDb2xvcj1yO3ZhciBzPVAoKSx1PUwoKSxjPVooKS5xdWVyeVNlbGVjdG9yKCIjIitELmNvbnRlbnQpLGw9SigpLGQ9WSgpLHA9JCgpLGY9RygpLG09WCgpO2lmKHQudGl0bGVUZXh0P3UuaW5uZXJUZXh0PXQudGl0bGVUZXh0OnQudGl0bGUmJigic3RyaW5nIj09dHlwZW9mIHQudGl0bGUmJih0LnRpdGxlPXQudGl0bGUuc3BsaXQoIlxuIikuam9pbigiPGJyIC8+IikpLG5lKHQudGl0bGUsdSkpLCJzdHJpbmciPT10eXBlb2YgdC5iYWNrZHJvcD9QKCkuc3R5bGUuYmFja2dyb3VuZD10LmJhY2tkcm9wOnQuYmFja2Ryb3B8fFcoW2RvY3VtZW50LmRvY3VtZW50RWxlbWVudCxkb2N1bWVudC5ib2R5XSxEWyJuby1iYWNrZHJvcCJdKSx0Lmh0bWw/bmUodC5odG1sLGMpOnQudGV4dD8oYy50ZXh0Q29udGVudD10LnRleHQsVShjKSk6RihjKSx0LnBvc2l0aW9uIGluIEQ/VyhzLERbdC5wb3NpdGlvbl0pOih4KCdUaGUgInBvc2l0aW9uIiBwYXJhbWV0ZXIgaXMgbm90IHZhbGlkLCBkZWZhdWx0aW5nIHRvICJjZW50ZXIiJyksVyhzLEQuY2VudGVyKSksdC5ncm93JiYic3RyaW5nIj09dHlwZW9mIHQuZ3Jvdyl7dmFyIGg9Imdyb3ctIit0Lmdyb3c7aCBpbiBEJiZXKHMsRFtoXSl9ImZ1bmN0aW9uIj09dHlwZW9mIHQuYW5pbWF0aW9uJiYodC5hbmltYXRpb249dC5hbmltYXRpb24uY2FsbCgpKSx0LnNob3dDbG9zZUJ1dHRvbj8oZi5zZXRBdHRyaWJ1dGUoImFyaWEtbGFiZWwiLHQuY2xvc2VCdXR0b25BcmlhTGFiZWwpLFUoZikpOkYoZiksZS5jbGFzc05hbWU9RC5wb3B1cCx0LnRvYXN0PyhXKFtkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsZG9jdW1lbnQuYm9keV0sRFsidG9hc3Qtc2hvd24iXSksVyhlLEQudG9hc3QpKTpXKGUsRC5tb2RhbCksdC5jdXN0b21DbGFzcyYmVyhlLHQuY3VzdG9tQ2xhc3MpLG9lKHQpO2Zvcih2YXIgZz1PKCksdj0wO3Y8Zy5sZW5ndGg7disrKUYoZ1t2XSk7aWYodC50eXBlKXt2YXIgeT0hMTtmb3IodmFyIGIgaW4gQilpZih0LnR5cGU9PT1iKXt5PSEwO2JyZWFrfWlmKCF5KXJldHVybiBJKCJVbmtub3duIGFsZXJ0IHR5cGU6ICIrdC50eXBlKTt2YXIgdz1lLnF1ZXJ5U2VsZWN0b3IoIi4iK0QuaWNvbisiLiIrQlt0LnR5cGVdKTtVKHcpLHQuYW5pbWF0aW9uJiZXKHcsInN3YWwyLWFuaW1hdGUtIit0LnR5cGUrIi1pY29uIil9dmFyIEM9USgpO2lmKHQuaW1hZ2VVcmw/KEMuc2V0QXR0cmlidXRlKCJzcmMiLHQuaW1hZ2VVcmwpLEMuc2V0QXR0cmlidXRlKCJhbHQiLHQuaW1hZ2VBbHQpLFUoQyksdC5pbWFnZVdpZHRoP0Muc2V0QXR0cmlidXRlKCJ3aWR0aCIsdC5pbWFnZVdpZHRoKTpDLnJlbW92ZUF0dHJpYnV0ZSgid2lkdGgiKSx0LmltYWdlSGVpZ2h0P0Muc2V0QXR0cmlidXRlKCJoZWlnaHQiLHQuaW1hZ2VIZWlnaHQpOkMucmVtb3ZlQXR0cmlidXRlKCJoZWlnaHQiKSxDLmNsYXNzTmFtZT1ELmltYWdlLHQuaW1hZ2VDbGFzcyYmVyhDLHQuaW1hZ2VDbGFzcykpOkYoQyksdC5zaG93Q2FuY2VsQnV0dG9uP3Auc3R5bGUuZGlzcGxheT0iaW5saW5lLWJsb2NrIjpGKHApLHQuc2hvd0NvbmZpcm1CdXR0b24/UyhkLCJkaXNwbGF5Iik6RihkKSx0LnNob3dDb25maXJtQnV0dG9ufHx0LnNob3dDYW5jZWxCdXR0b24/VShsKTpGKGwpLGQuaW5uZXJIVE1MPXQuY29uZmlybUJ1dHRvblRleHQscC5pbm5lckhUTUw9dC5jYW5jZWxCdXR0b25UZXh0LGQuc2V0QXR0cmlidXRlKCJhcmlhLWxhYmVsIix0LmNvbmZpcm1CdXR0b25BcmlhTGFiZWwpLHAuc2V0QXR0cmlidXRlKCJhcmlhLWxhYmVsIix0LmNhbmNlbEJ1dHRvbkFyaWFMYWJlbCksZC5jbGFzc05hbWU9RC5jb25maXJtLFcoZCx0LmNvbmZpcm1CdXR0b25DbGFzcykscC5jbGFzc05hbWU9RC5jYW5jZWwsVyhwLHQuY2FuY2VsQnV0dG9uQ2xhc3MpLHQuYnV0dG9uc1N0eWxpbmcpe1coW2QscF0sRC5zdHlsZWQpLHQuY29uZmlybUJ1dHRvbkNvbG9yJiYoZC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I9dC5jb25maXJtQnV0dG9uQ29sb3IpLHQuY2FuY2VsQnV0dG9uQ29sb3ImJihwLnN0eWxlLmJhY2tncm91bmRDb2xvcj10LmNhbmNlbEJ1dHRvbkNvbG9yKTt2YXIgaz13aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShkKS5nZXRQcm9wZXJ0eVZhbHVlKCJiYWNrZ3JvdW5kLWNvbG9yIik7ZC5zdHlsZS5ib3JkZXJMZWZ0Q29sb3I9ayxkLnN0eWxlLmJvcmRlclJpZ2h0Q29sb3I9a31lbHNlIEEoW2QscF0sRC5zdHlsZWQpLGQuc3R5bGUuYmFja2dyb3VuZENvbG9yPWQuc3R5bGUuYm9yZGVyTGVmdENvbG9yPWQuc3R5bGUuYm9yZGVyUmlnaHRDb2xvcj0iIixwLnN0eWxlLmJhY2tncm91bmRDb2xvcj1wLnN0eWxlLmJvcmRlckxlZnRDb2xvcj1wLnN0eWxlLmJvcmRlclJpZ2h0Q29sb3I9IiI7bmUodC5mb290ZXIsbSksITA9PT10LmFuaW1hdGlvbj9BKGUsRC5ub2FuaW1hdGlvbik6VyhlLEQubm9hbmltYXRpb24pLHQuc2hvd0xvYWRlck9uQ29uZmlybSYmIXQucHJlQ29uZmlybSYmeCgic2hvd0xvYWRlck9uQ29uZmlybSBpcyBzZXQgdG8gdHJ1ZSwgYnV0IHByZUNvbmZpcm0gaXMgbm90IGRlZmluZWQuXG5zaG93TG9hZGVyT25Db25maXJtIHNob3VsZCBiZSB1c2VkIHRvZ2V0aGVyIHdpdGggcHJlQ29uZmlybSwgc2VlIHVzYWdlIGV4YW1wbGU6XG5odHRwczovL3N3ZWV0YWxlcnQyLmdpdGh1Yi5pby8jYWpheC1yZXF1ZXN0Iil9KGopLE9iamVjdC5mcmVlemUoaiksaGUuaW5uZXJQYXJhbXMuc2V0KHRoaXMsaikscmUudGltZW91dCYmKHJlLnRpbWVvdXQuc3RvcCgpLGRlbGV0ZSByZS50aW1lb3V0KSxjbGVhclRpbWVvdXQocmUucmVzdG9yZUZvY3VzVGltZW91dCk7dmFyIF89e3BvcHVwOkUoKSxjb250YWluZXI6UCgpLGNvbnRlbnQ6WigpLGFjdGlvbnM6SigpLGNvbmZpcm1CdXR0b246WSgpLGNhbmNlbEJ1dHRvbjokKCksY2xvc2VCdXR0b246RygpLHZhbGlkYXRpb25FcnJvcjpoKEQudmFsaWRhdGlvbmVycm9yKSxwcm9ncmVzc1N0ZXBzOmcoKX07aGUuZG9tQ2FjaGUuc2V0KHRoaXMsXyk7dmFyIFY9dGhpcy5jb25zdHJ1Y3RvcjtyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24odCxuKXt2YXIgbz1mdW5jdGlvbihlKXtWLmNsb3NlUG9wdXAoai5vbkNsb3NlLGoub25BZnRlckNsb3NlKSxqLnVzZVJlamVjdGlvbnM/dChlKTp0KHt2YWx1ZTplfSl9LGM9ZnVuY3Rpb24oZSl7Vi5jbG9zZVBvcHVwKGoub25DbG9zZSxqLm9uQWZ0ZXJDbG9zZSksai51c2VSZWplY3Rpb25zP24oZSk6dCh7ZGlzbWlzczplfSl9LGw9ZnVuY3Rpb24oZSl7Vi5jbG9zZVBvcHVwKGoub25DbG9zZSxqLm9uQWZ0ZXJDbG9zZSksbihlKX07ai50aW1lciYmKHJlLnRpbWVvdXQ9bmV3IHZlKGZ1bmN0aW9uKCl7YygidGltZXIiKSxkZWxldGUgcmUudGltZW91dH0sai50aW1lcikpLGouaW5wdXQmJnNldFRpbWVvdXQoZnVuY3Rpb24oKXt2YXIgZT1ULmdldElucHV0KCk7ZSYmTihlKX0sMCk7Zm9yKHZhciBkPWZ1bmN0aW9uKHQpe2lmKGouc2hvd0xvYWRlck9uQ29uZmlybSYmVi5zaG93TG9hZGluZygpLGoucHJlQ29uZmlybSl7VC5yZXNldFZhbGlkYXRpb25FcnJvcigpO3ZhciBlPVByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gai5wcmVDb25maXJtKHQsai5leHRyYVBhcmFtcyl9KTtqLmV4cGVjdFJlamVjdGlvbnM/ZS50aGVuKGZ1bmN0aW9uKGUpe3JldHVybiBvKGV8fHQpfSxmdW5jdGlvbihlKXtULmhpZGVMb2FkaW5nKCksZSYmVC5zaG93VmFsaWRhdGlvbkVycm9yKGUpfSk6ZS50aGVuKGZ1bmN0aW9uKGUpe0soXy52YWxpZGF0aW9uRXJyb3IpfHwhMT09PWU/VC5oaWRlTG9hZGluZygpOm8oZXx8dCl9LGZ1bmN0aW9uKGUpe3JldHVybiBsKGUpfSl9ZWxzZSBvKHQpfSxlPWZ1bmN0aW9uKGUpe3ZhciB0PWV8fHdpbmRvdy5ldmVudCxuPXQudGFyZ2V0fHx0LnNyY0VsZW1lbnQsbz1fLmNvbmZpcm1CdXR0b24scj1fLmNhbmNlbEJ1dHRvbixpPW8mJihvPT09bnx8by5jb250YWlucyhuKSksYT1yJiYocj09PW58fHIuY29udGFpbnMobikpO3N3aXRjaCh0LnR5cGUpe2Nhc2UiY2xpY2siOmlmKGkmJlYuaXNWaXNpYmxlKCkpaWYoVC5kaXNhYmxlQnV0dG9ucygpLGouaW5wdXQpe3ZhciBzPWZ1bmN0aW9uKCl7dmFyIGU9VC5nZXRJbnB1dCgpO2lmKCFlKXJldHVybiBudWxsO3N3aXRjaChqLmlucHV0KXtjYXNlImNoZWNrYm94IjpyZXR1cm4gZS5jaGVja2VkPzE6MDtjYXNlInJhZGlvIjpyZXR1cm4gZS5jaGVja2VkP2UudmFsdWU6bnVsbDtjYXNlImZpbGUiOnJldHVybiBlLmZpbGVzLmxlbmd0aD9lLmZpbGVzWzBdOm51bGw7ZGVmYXVsdDpyZXR1cm4gai5pbnB1dEF1dG9UcmltP2UudmFsdWUudHJpbSgpOmUudmFsdWV9fSgpO2lmKGouaW5wdXRWYWxpZGF0b3Ipe1QuZGlzYWJsZUlucHV0KCk7dmFyIHU9UHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbigpe3JldHVybiBqLmlucHV0VmFsaWRhdG9yKHMsai5leHRyYVBhcmFtcyl9KTtqLmV4cGVjdFJlamVjdGlvbnM/dS50aGVuKGZ1bmN0aW9uKCl7VC5lbmFibGVCdXR0b25zKCksVC5lbmFibGVJbnB1dCgpLGQocyl9LGZ1bmN0aW9uKGUpe1QuZW5hYmxlQnV0dG9ucygpLFQuZW5hYmxlSW5wdXQoKSxlJiZULnNob3dWYWxpZGF0aW9uRXJyb3IoZSl9KTp1LnRoZW4oZnVuY3Rpb24oZSl7VC5lbmFibGVCdXR0b25zKCksVC5lbmFibGVJbnB1dCgpLGU/VC5zaG93VmFsaWRhdGlvbkVycm9yKGUpOmQocyl9LGZ1bmN0aW9uKGUpe3JldHVybiBsKGUpfSl9ZWxzZSBkKHMpfWVsc2UgZCghMCk7ZWxzZSBhJiZWLmlzVmlzaWJsZSgpJiYoVC5kaXNhYmxlQnV0dG9ucygpLGMoVi5EaXNtaXNzUmVhc29uLmNhbmNlbCkpfX0scj1fLnBvcHVwLnF1ZXJ5U2VsZWN0b3JBbGwoImJ1dHRvbiIpLGk9MDtpPHIubGVuZ3RoO2krKylyW2ldLm9uY2xpY2s9ZSxyW2ldLm9ubW91c2VvdmVyPWUscltpXS5vbm1vdXNlb3V0PWUscltpXS5vbm1vdXNlZG93bj1lO2lmKF8uY2xvc2VCdXR0b24ub25jbGljaz1mdW5jdGlvbigpe2MoVi5EaXNtaXNzUmVhc29uLmNsb3NlKX0sai50b2FzdClfLnBvcHVwLm9uY2xpY2s9ZnVuY3Rpb24oKXtqLnNob3dDb25maXJtQnV0dG9ufHxqLnNob3dDYW5jZWxCdXR0b258fGouc2hvd0Nsb3NlQnV0dG9ufHxqLmlucHV0fHxjKFYuRGlzbWlzc1JlYXNvbi5jbG9zZSl9O2Vsc2V7dmFyIGE9ITE7Xy5wb3B1cC5vbm1vdXNlZG93bj1mdW5jdGlvbigpe18uY29udGFpbmVyLm9ubW91c2V1cD1mdW5jdGlvbihlKXtfLmNvbnRhaW5lci5vbm1vdXNldXA9dm9pZCAwLGUudGFyZ2V0PT09Xy5jb250YWluZXImJihhPSEwKX19LF8uY29udGFpbmVyLm9ubW91c2Vkb3duPWZ1bmN0aW9uKCl7Xy5wb3B1cC5vbm1vdXNldXA9ZnVuY3Rpb24oZSl7Xy5wb3B1cC5vbm1vdXNldXA9dm9pZCAwLChlLnRhcmdldD09PV8ucG9wdXB8fF8ucG9wdXAuY29udGFpbnMoZS50YXJnZXQpKSYmKGE9ITApfX0sXy5jb250YWluZXIub25jbGljaz1mdW5jdGlvbihlKXthP2E9ITE6ZS50YXJnZXQ9PT1fLmNvbnRhaW5lciYmSChqLmFsbG93T3V0c2lkZUNsaWNrKSYmYyhWLkRpc21pc3NSZWFzb24uYmFja2Ryb3ApfX1qLnJldmVyc2VCdXR0b25zP18uY29uZmlybUJ1dHRvbi5wYXJlbnROb2RlLmluc2VydEJlZm9yZShfLmNhbmNlbEJ1dHRvbixfLmNvbmZpcm1CdXR0b24pOl8uY29uZmlybUJ1dHRvbi5wYXJlbnROb2RlLmluc2VydEJlZm9yZShfLmNvbmZpcm1CdXR0b24sXy5jYW5jZWxCdXR0b24pO3ZhciBzPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPWVlKGouZm9jdXNDYW5jZWwpLG89MDtvPG4ubGVuZ3RoO28rKylyZXR1cm4oZSs9dCk9PT1uLmxlbmd0aD9lPTA6LTE9PT1lJiYoZT1uLmxlbmd0aC0xKSxuW2VdLmZvY3VzKCk7Xy5wb3B1cC5mb2N1cygpfTtyZS5rZXlkb3duSGFuZGxlckFkZGVkJiYocmUua2V5ZG93blRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKCJrZXlkb3duIixyZS5rZXlkb3duSGFuZGxlcix7Y2FwdHVyZTpyZS5rZXlkb3duTGlzdGVuZXJDYXB0dXJlfSkscmUua2V5ZG93bkhhbmRsZXJBZGRlZD0hMSksai50b2FzdHx8KHJlLmtleWRvd25IYW5kbGVyPWZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbihlLHQpe2lmKHQuc3RvcEtleWRvd25Qcm9wYWdhdGlvbiYmZS5zdG9wUHJvcGFnYXRpb24oKSwiRW50ZXIiIT09ZS5rZXl8fGUuaXNDb21wb3NpbmcpaWYoIlRhYiI9PT1lLmtleSl7Zm9yKHZhciBuPWUudGFyZ2V0fHxlLnNyY0VsZW1lbnQsbz1lZSh0LmZvY3VzQ2FuY2VsKSxyPS0xLGk9MDtpPG8ubGVuZ3RoO2krKylpZihuPT09b1tpXSl7cj1pO2JyZWFrfWUuc2hpZnRLZXk/cyhyLC0xKTpzKHIsMSksZS5zdG9wUHJvcGFnYXRpb24oKSxlLnByZXZlbnREZWZhdWx0KCl9ZWxzZS0xIT09WyJBcnJvd0xlZnQiLCJBcnJvd1JpZ2h0IiwiQXJyb3dVcCIsIkFycm93RG93biIsIkxlZnQiLCJSaWdodCIsIlVwIiwiRG93biJdLmluZGV4T2YoZS5rZXkpP2RvY3VtZW50LmFjdGl2ZUVsZW1lbnQ9PT1fLmNvbmZpcm1CdXR0b24mJksoXy5jYW5jZWxCdXR0b24pP18uY2FuY2VsQnV0dG9uLmZvY3VzKCk6ZG9jdW1lbnQuYWN0aXZlRWxlbWVudD09PV8uY2FuY2VsQnV0dG9uJiZLKF8uY29uZmlybUJ1dHRvbikmJl8uY29uZmlybUJ1dHRvbi5mb2N1cygpOiJFc2NhcGUiIT09ZS5rZXkmJiJFc2MiIT09ZS5rZXl8fCEwIT09SCh0LmFsbG93RXNjYXBlS2V5KXx8YyhWLkRpc21pc3NSZWFzb24uZXNjKTtlbHNlIGlmKGUudGFyZ2V0JiZULmdldElucHV0KCkmJmUudGFyZ2V0Lm91dGVySFRNTD09PVQuZ2V0SW5wdXQoKS5vdXRlckhUTUwpe2lmKC0xIT09WyJ0ZXh0YXJlYSIsImZpbGUiXS5pbmRleE9mKHQuaW5wdXQpKXJldHVybjtWLmNsaWNrQ29uZmlybSgpLGUucHJldmVudERlZmF1bHQoKX19KGUsail9LHJlLmtleWRvd25UYXJnZXQ9ai5rZXlkb3duTGlzdGVuZXJDYXB0dXJlP3dpbmRvdzpfLnBvcHVwLHJlLmtleWRvd25MaXN0ZW5lckNhcHR1cmU9ai5rZXlkb3duTGlzdGVuZXJDYXB0dXJlLHJlLmtleWRvd25UYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcigia2V5ZG93biIscmUua2V5ZG93bkhhbmRsZXIse2NhcHR1cmU6cmUua2V5ZG93bkxpc3RlbmVyQ2FwdHVyZX0pLHJlLmtleWRvd25IYW5kbGVyQWRkZWQ9ITApLFQuZW5hYmxlQnV0dG9ucygpLFQuaGlkZUxvYWRpbmcoKSxULnJlc2V0VmFsaWRhdGlvbkVycm9yKCksKGouaW5wdXR8fGouZm9vdGVyfHxqLnNob3dDbG9zZUJ1dHRvbikmJlcoZG9jdW1lbnQuYm9keSxEWyJ0b2FzdC1jb2x1bW4iXSk7Zm9yKHZhciB1PVsiaW5wdXQiLCJmaWxlIiwicmFuZ2UiLCJzZWxlY3QiLCJyYWRpbyIsImNoZWNrYm94IiwidGV4dGFyZWEiXSxwPXZvaWQgMCxmPTA7Zjx1Lmxlbmd0aDtmKyspe3ZhciBtPURbdVtmXV0saD16KF8uY29udGVudCxtKTtpZihwPVQuZ2V0SW5wdXQodVtmXSkpe2Zvcih2YXIgZyBpbiBwLmF0dHJpYnV0ZXMpaWYocC5hdHRyaWJ1dGVzLmhhc093blByb3BlcnR5KGcpKXt2YXIgdj1wLmF0dHJpYnV0ZXNbZ10ubmFtZTsidHlwZSIhPT12JiYidmFsdWUiIT09diYmcC5yZW1vdmVBdHRyaWJ1dGUodil9Zm9yKHZhciB5IGluIGouaW5wdXRBdHRyaWJ1dGVzKXAuc2V0QXR0cmlidXRlKHksai5pbnB1dEF0dHJpYnV0ZXNbeV0pfWguY2xhc3NOYW1lPW0sai5pbnB1dENsYXNzJiZXKGgsai5pbnB1dENsYXNzKSxGKGgpfXZhciBiPXZvaWQgMDtzd2l0Y2goai5pbnB1dCl7Y2FzZSJ0ZXh0IjpjYXNlImVtYWlsIjpjYXNlInBhc3N3b3JkIjpjYXNlIm51bWJlciI6Y2FzZSJ0ZWwiOmNhc2UidXJsIjoocD16KF8uY29udGVudCxELmlucHV0KSkudmFsdWU9ai5pbnB1dFZhbHVlLHAucGxhY2Vob2xkZXI9ai5pbnB1dFBsYWNlaG9sZGVyLHAudHlwZT1qLmlucHV0LFUocCk7YnJlYWs7Y2FzZSJmaWxlIjoocD16KF8uY29udGVudCxELmZpbGUpKS5wbGFjZWhvbGRlcj1qLmlucHV0UGxhY2Vob2xkZXIscC50eXBlPWouaW5wdXQsVShwKTticmVhaztjYXNlInJhbmdlIjp2YXIgdz16KF8uY29udGVudCxELnJhbmdlKSxDPXcucXVlcnlTZWxlY3RvcigiaW5wdXQiKSxrPXcucXVlcnlTZWxlY3Rvcigib3V0cHV0Iik7Qy52YWx1ZT1qLmlucHV0VmFsdWUsQy50eXBlPWouaW5wdXQsay52YWx1ZT1qLmlucHV0VmFsdWUsVSh3KTticmVhaztjYXNlInNlbGVjdCI6dmFyIHg9eihfLmNvbnRlbnQsRC5zZWxlY3QpO2lmKHguaW5uZXJIVE1MPSIiLGouaW5wdXRQbGFjZWhvbGRlcil7dmFyIEI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgib3B0aW9uIik7Qi5pbm5lckhUTUw9ai5pbnB1dFBsYWNlaG9sZGVyLEIudmFsdWU9IiIsQi5kaXNhYmxlZD0hMCxCLnNlbGVjdGVkPSEwLHguYXBwZW5kQ2hpbGQoQil9Yj1mdW5jdGlvbihlKXtlLmZvckVhY2goZnVuY3Rpb24oZSl7dmFyIHQ9TShlLDIpLG49dFswXSxvPXRbMV0scj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKTtyLnZhbHVlPW4sci5pbm5lckhUTUw9byxqLmlucHV0VmFsdWUudG9TdHJpbmcoKT09PW4udG9TdHJpbmcoKSYmKHIuc2VsZWN0ZWQ9ITApLHguYXBwZW5kQ2hpbGQocil9KSxVKHgpLHguZm9jdXMoKX07YnJlYWs7Y2FzZSJyYWRpbyI6dmFyIEE9eihfLmNvbnRlbnQsRC5yYWRpbyk7QS5pbm5lckhUTUw9IiIsYj1mdW5jdGlvbihlKXtlLmZvckVhY2goZnVuY3Rpb24oZSl7dmFyIHQ9TShlLDIpLG49dFswXSxvPXRbMV0scj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpLGk9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgibGFiZWwiKTtyLnR5cGU9InJhZGlvIixyLm5hbWU9RC5yYWRpbyxyLnZhbHVlPW4sai5pbnB1dFZhbHVlLnRvU3RyaW5nKCk9PT1uLnRvU3RyaW5nKCkmJihyLmNoZWNrZWQ9ITApO3ZhciBhPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNwYW4iKTthLmlubmVySFRNTD1vLGEuY2xhc3NOYW1lPUQubGFiZWwsaS5hcHBlbmRDaGlsZChyKSxpLmFwcGVuZENoaWxkKGEpLEEuYXBwZW5kQ2hpbGQoaSl9KSxVKEEpO3ZhciB0PUEucXVlcnlTZWxlY3RvckFsbCgiaW5wdXQiKTt0Lmxlbmd0aCYmdFswXS5mb2N1cygpfTticmVhaztjYXNlImNoZWNrYm94Ijp2YXIgUz16KF8uY29udGVudCxELmNoZWNrYm94KSxQPVQuZ2V0SW5wdXQoImNoZWNrYm94Iik7UC50eXBlPSJjaGVja2JveCIsUC52YWx1ZT0xLFAuaWQ9RC5jaGVja2JveCxQLmNoZWNrZWQ9Qm9vbGVhbihqLmlucHV0VmFsdWUpO3ZhciBFPVMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInNwYW4iKTtFLmxlbmd0aCYmUy5yZW1vdmVDaGlsZChFWzBdKSwoRT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzcGFuIikpLmNsYXNzTmFtZT1ELmxhYmVsLEUuaW5uZXJIVE1MPWouaW5wdXRQbGFjZWhvbGRlcixTLmFwcGVuZENoaWxkKEUpLFUoUyk7YnJlYWs7Y2FzZSJ0ZXh0YXJlYSI6dmFyIE89eihfLmNvbnRlbnQsRC50ZXh0YXJlYSk7Ty52YWx1ZT1qLmlucHV0VmFsdWUsTy5wbGFjZWhvbGRlcj1qLmlucHV0UGxhY2Vob2xkZXIsVShPKTticmVhaztjYXNlIG51bGw6YnJlYWs7ZGVmYXVsdDpJKCdVbmV4cGVjdGVkIHR5cGUgb2YgaW5wdXQhIEV4cGVjdGVkICJ0ZXh0IiwgImVtYWlsIiwgInBhc3N3b3JkIiwgIm51bWJlciIsICJ0ZWwiLCAic2VsZWN0IiwgInJhZGlvIiwgImNoZWNrYm94IiwgInRleHRhcmVhIiwgImZpbGUiIG9yICJ1cmwiLCBnb3QgIicrai5pbnB1dCsnIicpfWlmKCJzZWxlY3QiPT09ai5pbnB1dHx8InJhZGlvIj09PWouaW5wdXQpe3ZhciBMPWZ1bmN0aW9uKGUpe3JldHVybiBiKCh0PWUsbj1bXSwidW5kZWZpbmVkIiE9dHlwZW9mIE1hcCYmdCBpbnN0YW5jZW9mIE1hcD90LmZvckVhY2goZnVuY3Rpb24oZSx0KXtuLnB1c2goW3QsZV0pfSk6T2JqZWN0LmtleXModCkuZm9yRWFjaChmdW5jdGlvbihlKXtuLnB1c2goW2UsdFtlXV0pfSksbikpO3ZhciB0LG59O1Ioai5pbnB1dE9wdGlvbnMpPyhWLnNob3dMb2FkaW5nKCksai5pbnB1dE9wdGlvbnMudGhlbihmdW5jdGlvbihlKXtULmhpZGVMb2FkaW5nKCksTChlKX0pKToib2JqZWN0Ij09PXEoai5pbnB1dE9wdGlvbnMpP0woai5pbnB1dE9wdGlvbnMpOkkoIlVuZXhwZWN0ZWQgdHlwZSBvZiBpbnB1dE9wdGlvbnMhIEV4cGVjdGVkIG9iamVjdCwgTWFwIG9yIFByb21pc2UsIGdvdCAiK3Eoai5pbnB1dE9wdGlvbnMpKX1lbHNlLTEhPT1bInRleHQiLCJlbWFpbCIsIm51bWJlciIsInRlbCIsInRleHRhcmVhIl0uaW5kZXhPZihqLmlucHV0KSYmUihqLmlucHV0VmFsdWUpJiYoVi5zaG93TG9hZGluZygpLEYocCksai5pbnB1dFZhbHVlLnRoZW4oZnVuY3Rpb24oZSl7cC52YWx1ZT0ibnVtYmVyIj09PWouaW5wdXQ/cGFyc2VGbG9hdChlKXx8MDplKyIiLFUocCkscC5mb2N1cygpLFQuaGlkZUxvYWRpbmcoKX0pLmNhdGNoKGZ1bmN0aW9uKGUpe0koIkVycm9yIGluIGlucHV0VmFsdWUgcHJvbWlzZTogIitlKSxwLnZhbHVlPSIiLFUocCkscC5mb2N1cygpLFQuaGlkZUxvYWRpbmcoKX0pKTtiZShqKSxqLnRvYXN0fHwoSChqLmFsbG93RW50ZXJLZXkpP2ouZm9jdXNDYW5jZWwmJksoXy5jYW5jZWxCdXR0b24pP18uY2FuY2VsQnV0dG9uLmZvY3VzKCk6ai5mb2N1c0NvbmZpcm0mJksoXy5jb25maXJtQnV0dG9uKT9fLmNvbmZpcm1CdXR0b24uZm9jdXMoKTpzKC0xLDEpOmRvY3VtZW50LmFjdGl2ZUVsZW1lbnQmJmRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuYmx1cigpKSxfLmNvbnRhaW5lci5zY3JvbGxUb3A9MH0pfX0pLENlPXZvaWQgMDtmdW5jdGlvbiBrZSgpe2lmKCJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93KXsidW5kZWZpbmVkIj09dHlwZW9mIFByb21pc2UmJkkoIlRoaXMgcGFja2FnZSByZXF1aXJlcyBhIFByb21pc2UgbGlicmFyeSwgcGxlYXNlIGluY2x1ZGUgYSBzaGltIHRvIGVuYWJsZSBpdCBpbiB0aGlzIGJyb3dzZXIgKFNlZTogaHR0cHM6Ly9naXRodWIuY29tL3N3ZWV0YWxlcnQyL3N3ZWV0YWxlcnQyL3dpa2kvTWlncmF0aW9uLWZyb20tU3dlZXRBbGVydC10by1Td2VldEFsZXJ0MiMxLWllLXN1cHBvcnQpIik7Zm9yKHZhciBlPWFyZ3VtZW50cy5sZW5ndGgsdD1BcnJheShlKSxuPTA7bjxlO24rKyl0W25dPWFyZ3VtZW50c1tuXTtpZih2b2lkIDA9PT10WzBdKXJldHVybiBJKCJBdCBsZWFzdCAxIGFyZ3VtZW50IGlzIGV4cGVjdGVkISIpLCExO0NlPXRoaXM7dmFyIG89T2JqZWN0LmZyZWV6ZSh0aGlzLmNvbnN0cnVjdG9yLmFyZ3NUb1BhcmFtcyh0KSk7T2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcyx7cGFyYW1zOnt2YWx1ZTpvLHdyaXRhYmxlOiExLGVudW1lcmFibGU6ITB9fSk7dmFyIHI9dGhpcy5fbWFpbih0aGlzLnBhcmFtcyk7aGUucHJvbWlzZS5zZXQodGhpcyxyKX19a2UucHJvdG90eXBlLnRoZW49ZnVuY3Rpb24oZSx0KXtyZXR1cm4gaGUucHJvbWlzZS5nZXQodGhpcykudGhlbihlLHQpfSxrZS5wcm90b3R5cGUuY2F0Y2g9ZnVuY3Rpb24oZSl7cmV0dXJuIGhlLnByb21pc2UuZ2V0KHRoaXMpLmNhdGNoKGUpfSxrZS5wcm90b3R5cGUuZmluYWxseT1mdW5jdGlvbihlKXtyZXR1cm4gaGUucHJvbWlzZS5nZXQodGhpcykuZmluYWxseShlKX0scihrZS5wcm90b3R5cGUsd2UpLHIoa2UscGUpLE9iamVjdC5rZXlzKHdlKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe2tlW3RdPWZ1bmN0aW9uKCl7dmFyIGU7aWYoQ2UpcmV0dXJuKGU9Q2UpW3RdLmFwcGx5KGUsYXJndW1lbnRzKX19KSxrZS5EaXNtaXNzUmVhc29uPWUsa2Uubm9vcD1mdW5jdGlvbigpe30sa2UudmVyc2lvbj0iNy4yNi4wIjt2YXIgeGUsQmUsQWU9aigoeGU9a2UsQmU9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe3JldHVybiBzKHRoaXMsdCksdSh0aGlzLCh0Ll9fcHJvdG9fX3x8T2JqZWN0LmdldFByb3RvdHlwZU9mKHQpKS5hcHBseSh0aGlzLGFyZ3VtZW50cykpfXJldHVybiBhKHQseGUpLG8odCxbe2tleToiX21haW4iLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBpKHQucHJvdG90eXBlLl9fcHJvdG9fX3x8T2JqZWN0LmdldFByb3RvdHlwZU9mKHQucHJvdG90eXBlKSwiX21haW4iLHRoaXMpLmNhbGwodGhpcyxyKHt9LGNlLGUpKX19XSxbe2tleToic2V0RGVmYXVsdHMiLHZhbHVlOmZ1bmN0aW9uKHQpe2lmKGwodWUpLCF0fHwib2JqZWN0IiE9PSh2b2lkIDA9PT10PyJ1bmRlZmluZWQiOnEodCkpKXRocm93IG5ldyBUeXBlRXJyb3IoIlN3ZWV0QWxlcnQyOiBUaGUgYXJndW1lbnQgZm9yIHNldERlZmF1bHRzKCkgaXMgcmVxdWlyZWQgYW5kIGhhcyB0byBiZSBhIG9iamVjdCIpO3NlKHQpLE9iamVjdC5rZXlzKHQpLmZvckVhY2goZnVuY3Rpb24oZSl7eGUuaXNWYWxpZFBhcmFtZXRlcihlKSYmKGNlW2VdPXRbZV0pfSl9fSx7a2V5OiJyZXNldERlZmF1bHRzIix2YWx1ZTpmdW5jdGlvbigpe2wodWUpLGNlPXt9fX1dKSx0fSgpLCJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93JiYib2JqZWN0Ij09PXEod2luZG93Ll9zd2FsRGVmYXVsdHMpJiZCZS5zZXREZWZhdWx0cyh3aW5kb3cuX3N3YWxEZWZhdWx0cyksQmUpKTtyZXR1cm4gQWUuZGVmYXVsdD1BZX0pLCJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93JiZ3aW5kb3cuU3dlZXRhbGVydDImJih3aW5kb3cuc3dhbD13aW5kb3cuc3dlZXRBbGVydD13aW5kb3cuU3dhbD13aW5kb3cuU3dlZXRBbGVydD13aW5kb3cuU3dlZXRhbGVydDIpOw0KLyohDQogKiBCb290c3RyYXAtc2VsZWN0IHYxLjEzLjEgKGh0dHBzOi8vZGV2ZWxvcGVyLnNuYXBhcHBvaW50bWVudHMuY29tL2Jvb3RzdHJhcC1zZWxlY3QpDQogKg0KICogQ29weXJpZ2h0IDIwMTItMjAxOCBTbmFwQXBwb2ludG1lbnRzLCBMTEMNCiAqIExpY2Vuc2VkIHVuZGVyIE1JVCAoaHR0cHM6Ly9naXRodWIuY29tL3NuYXBhcHBvaW50bWVudHMvYm9vdHN0cmFwLXNlbGVjdC9ibG9iL21hc3Rlci9MSUNFTlNFKQ0KICovDQoNCihmdW5jdGlvbiAocm9vdCwgZmFjdG9yeSkgewogIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHsKICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZSB1bmxlc3MgYW1kTW9kdWxlSWQgaXMgc2V0CiAgICBkZWZpbmUoWyJqcXVlcnkiXSwgZnVuY3Rpb24gKGEwKSB7CiAgICAgIHJldHVybiAoZmFjdG9yeShhMCkpOwogICAgfSk7CiAgfSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cykgewogICAgLy8gTm9kZS4gRG9lcyBub3Qgd29yayB3aXRoIHN0cmljdCBDb21tb25KUywgYnV0CiAgICAvLyBvbmx5IENvbW1vbkpTLWxpa2UgZW52aXJvbm1lbnRzIHRoYXQgc3VwcG9ydCBtb2R1bGUuZXhwb3J0cywKICAgIC8vIGxpa2UgTm9kZS4KICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShyZXF1aXJlKCJqcXVlcnkiKSk7CiAgfSBlbHNlIHsKICAgIGZhY3Rvcnkocm9vdFsialF1ZXJ5Il0pOwogIH0KfSh0aGlzLCBmdW5jdGlvbiAoalF1ZXJ5KSB7CgooZnVuY3Rpb24gKCQpIHsNCiAgJ3VzZSBzdHJpY3QnOw0KDQogIHZhciB0ZXN0RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ18nKTsNCg0KICB0ZXN0RWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCdjMycsIGZhbHNlKTsNCg0KICAvLyBQb2x5ZmlsbCBmb3IgSUUgMTAgYW5kIEZpcmVmb3ggPDI0LCB3aGVyZSBjbGFzc0xpc3QudG9nZ2xlIGRvZXMgbm90DQogIC8vIHN1cHBvcnQgdGhlIHNlY29uZCBhcmd1bWVudC4NCiAgaWYgKHRlc3RFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnYzMnKSkgew0KICAgIHZhciBfdG9nZ2xlID0gRE9NVG9rZW5MaXN0LnByb3RvdHlwZS50b2dnbGU7DQoNCiAgICBET01Ub2tlbkxpc3QucHJvdG90eXBlLnRvZ2dsZSA9IGZ1bmN0aW9uKHRva2VuLCBmb3JjZSkgew0KICAgICAgaWYgKDEgaW4gYXJndW1lbnRzICYmICF0aGlzLmNvbnRhaW5zKHRva2VuKSA9PT0gIWZvcmNlKSB7DQogICAgICAgIHJldHVybiBmb3JjZTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiBfdG9nZ2xlLmNhbGwodGhpcywgdG9rZW4pOw0KICAgICAgfQ0KICAgIH07DQogIH0NCg0KICAvLyBzaGFsbG93IGFycmF5IGNvbXBhcmlzb24NCiAgZnVuY3Rpb24gaXNFcXVhbCAoYXJyYXkxLCBhcnJheTIpIHsNCiAgICByZXR1cm4gYXJyYXkxLmxlbmd0aCA9PT0gYXJyYXkyLmxlbmd0aCAmJiBhcnJheTEuZXZlcnkoZnVuY3Rpb24oZWxlbWVudCwgaW5kZXgpIHsNCiAgICAgIHJldHVybiBlbGVtZW50ID09PSBhcnJheTJbaW5kZXhdOyANCiAgICB9KTsNCiAgfTsNCg0KICAvLzxlZGl0b3ItZm9sZCBkZXNjPSJTaGltcyI+DQogIGlmICghU3RyaW5nLnByb3RvdHlwZS5zdGFydHNXaXRoKSB7DQogICAgKGZ1bmN0aW9uICgpIHsNCiAgICAgICd1c2Ugc3RyaWN0JzsgLy8gbmVlZGVkIHRvIHN1cHBvcnQgYGFwcGx5YC9gY2FsbGAgd2l0aCBgdW5kZWZpbmVkYC9gbnVsbGANCiAgICAgIHZhciBkZWZpbmVQcm9wZXJ0eSA9IChmdW5jdGlvbiAoKSB7DQogICAgICAgIC8vIElFIDggb25seSBzdXBwb3J0cyBgT2JqZWN0LmRlZmluZVByb3BlcnR5YCBvbiBET00gZWxlbWVudHMNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICB2YXIgb2JqZWN0ID0ge307DQogICAgICAgICAgdmFyICRkZWZpbmVQcm9wZXJ0eSA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTsNCiAgICAgICAgICB2YXIgcmVzdWx0ID0gJGRlZmluZVByb3BlcnR5KG9iamVjdCwgb2JqZWN0LCBvYmplY3QpICYmICRkZWZpbmVQcm9wZXJ0eTsNCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gcmVzdWx0Ow0KICAgICAgfSgpKTsNCiAgICAgIHZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nOw0KICAgICAgdmFyIHN0YXJ0c1dpdGggPSBmdW5jdGlvbiAoc2VhcmNoKSB7DQogICAgICAgIGlmICh0aGlzID09IG51bGwpIHsNCiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7DQogICAgICAgIH0NCiAgICAgICAgdmFyIHN0cmluZyA9IFN0cmluZyh0aGlzKTsNCiAgICAgICAgaWYgKHNlYXJjaCAmJiB0b1N0cmluZy5jYWxsKHNlYXJjaCkgPT0gJ1tvYmplY3QgUmVnRXhwXScpIHsNCiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7DQogICAgICAgIH0NCiAgICAgICAgdmFyIHN0cmluZ0xlbmd0aCA9IHN0cmluZy5sZW5ndGg7DQogICAgICAgIHZhciBzZWFyY2hTdHJpbmcgPSBTdHJpbmcoc2VhcmNoKTsNCiAgICAgICAgdmFyIHNlYXJjaExlbmd0aCA9IHNlYXJjaFN0cmluZy5sZW5ndGg7DQogICAgICAgIHZhciBwb3NpdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkOw0KICAgICAgICAvLyBgVG9JbnRlZ2VyYA0KICAgICAgICB2YXIgcG9zID0gcG9zaXRpb24gPyBOdW1iZXIocG9zaXRpb24pIDogMDsNCiAgICAgICAgaWYgKHBvcyAhPSBwb3MpIHsgLy8gYmV0dGVyIGBpc05hTmANCiAgICAgICAgICBwb3MgPSAwOw0KICAgICAgICB9DQogICAgICAgIHZhciBzdGFydCA9IE1hdGgubWluKE1hdGgubWF4KHBvcywgMCksIHN0cmluZ0xlbmd0aCk7DQogICAgICAgIC8vIEF2b2lkIHRoZSBgaW5kZXhPZmAgY2FsbCBpZiBubyBtYXRjaCBpcyBwb3NzaWJsZQ0KICAgICAgICBpZiAoc2VhcmNoTGVuZ3RoICsgc3RhcnQgPiBzdHJpbmdMZW5ndGgpIHsNCiAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgdmFyIGluZGV4ID0gLTE7DQogICAgICAgIHdoaWxlICgrK2luZGV4IDwgc2VhcmNoTGVuZ3RoKSB7DQogICAgICAgICAgaWYgKHN0cmluZy5jaGFyQ29kZUF0KHN0YXJ0ICsgaW5kZXgpICE9IHNlYXJjaFN0cmluZy5jaGFyQ29kZUF0KGluZGV4KSkgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgIH07DQogICAgICBpZiAoZGVmaW5lUHJvcGVydHkpIHsNCiAgICAgICAgZGVmaW5lUHJvcGVydHkoU3RyaW5nLnByb3RvdHlwZSwgJ3N0YXJ0c1dpdGgnLCB7DQogICAgICAgICAgJ3ZhbHVlJzogc3RhcnRzV2l0aCwNCiAgICAgICAgICAnY29uZmlndXJhYmxlJzogdHJ1ZSwNCiAgICAgICAgICAnd3JpdGFibGUnOiB0cnVlDQogICAgICAgIH0pOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgU3RyaW5nLnByb3RvdHlwZS5zdGFydHNXaXRoID0gc3RhcnRzV2l0aDsNCiAgICAgIH0NCiAgICB9KCkpOw0KICB9DQoNCiAgaWYgKCFPYmplY3Qua2V5cykgew0KICAgIE9iamVjdC5rZXlzID0gZnVuY3Rpb24gKA0KICAgICAgbywgLy8gb2JqZWN0DQogICAgICBrLCAvLyBrZXkNCiAgICAgIHIgIC8vIHJlc3VsdCBhcnJheQ0KICAgICAgKXsNCiAgICAgIC8vIGluaXRpYWxpemUgb2JqZWN0IGFuZCByZXN1bHQNCiAgICAgIHI9W107DQogICAgICAvLyBpdGVyYXRlIG92ZXIgb2JqZWN0IGtleXMNCiAgICAgIGZvciAoayBpbiBvKQ0KICAgICAgICAgIC8vIGZpbGwgcmVzdWx0IGFycmF5IHdpdGggbm9uLXByb3RvdHlwaWNhbCBrZXlzDQogICAgICAgIHIuaGFzT3duUHJvcGVydHkuY2FsbChvLCBrKSAmJiByLnB1c2goayk7DQogICAgICAvLyByZXR1cm4gcmVzdWx0DQogICAgICByZXR1cm4gcjsNCiAgICB9Ow0KICB9DQoNCiAgLy8gbXVjaCBmYXN0ZXIgdGhhbiAkLnZhbCgpDQogIGZ1bmN0aW9uIGdldFNlbGVjdFZhbHVlcyhzZWxlY3QpIHsNCiAgICB2YXIgcmVzdWx0ID0gW107DQogICAgdmFyIG9wdGlvbnMgPSBzZWxlY3QgJiYgc2VsZWN0Lm9wdGlvbnM7DQogICAgdmFyIG9wdDsNCg0KICAgIGlmIChzZWxlY3QubXVsdGlwbGUpIHsNCiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBvcHRpb25zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7DQogICAgICAgIG9wdCA9IG9wdGlvbnNbaV07DQoNCiAgICAgICAgaWYgKG9wdC5zZWxlY3RlZCkgew0KICAgICAgICAgIHJlc3VsdC5wdXNoKG9wdC52YWx1ZSB8fCBvcHQudGV4dCk7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgcmVzdWx0ID0gc2VsZWN0LnZhbHVlOw0KICAgIH0NCg0KICAgIHJldHVybiByZXN1bHQ7DQogIH0NCg0KICAvLyBzZXQgZGF0YS1zZWxlY3RlZCBvbiBzZWxlY3QgZWxlbWVudCBpZiB0aGUgdmFsdWUgaGFzIGJlZW4gcHJvZ3JhbW1hdGljYWxseSBzZWxlY3RlZA0KICAvLyBwcmlvciB0byBpbml0aWFsaXphdGlvbiBvZiBib290c3RyYXAtc2VsZWN0DQogIC8vICogY29uc2lkZXIgcmVtb3Zpbmcgb3IgcmVwbGFjaW5nIGFuIGFsdGVybmF0aXZlIG1ldGhvZCAqDQogIHZhciB2YWxIb29rcyA9IHsNCiAgICB1c2VEZWZhdWx0OiBmYWxzZSwNCiAgICBfc2V0OiAkLnZhbEhvb2tzLnNlbGVjdC5zZXQNCiAgfTsNCg0KICAkLnZhbEhvb2tzLnNlbGVjdC5zZXQgPSBmdW5jdGlvbiAoZWxlbSwgdmFsdWUpIHsNCiAgICBpZiAodmFsdWUgJiYgIXZhbEhvb2tzLnVzZURlZmF1bHQpICQoZWxlbSkuZGF0YSgnc2VsZWN0ZWQnLCB0cnVlKTsNCg0KICAgIHJldHVybiB2YWxIb29rcy5fc2V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7DQogIH07DQoNCiAgdmFyIGNoYW5nZWRfYXJndW1lbnRzID0gbnVsbDsNCg0KICB2YXIgRXZlbnRJc1N1cHBvcnRlZCA9IChmdW5jdGlvbiAoKSB7DQogICAgdHJ5IHsNCiAgICAgIG5ldyBFdmVudCgnY2hhbmdlJyk7DQogICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9IGNhdGNoIChlKSB7DQogICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KICB9KSgpOw0KDQogICQuZm4udHJpZ2dlck5hdGl2ZSA9IGZ1bmN0aW9uIChldmVudE5hbWUpIHsNCiAgICB2YXIgZWwgPSB0aGlzWzBdLA0KICAgICAgICBldmVudDsNCg0KICAgIGlmIChlbC5kaXNwYXRjaEV2ZW50KSB7IC8vIGZvciBtb2Rlcm4gYnJvd3NlcnMgJiBJRTkrDQogICAgICBpZiAoRXZlbnRJc1N1cHBvcnRlZCkgew0KICAgICAgICAvLyBGb3IgbW9kZXJuIGJyb3dzZXJzDQogICAgICAgIGV2ZW50ID0gbmV3IEV2ZW50KGV2ZW50TmFtZSwgew0KICAgICAgICAgIGJ1YmJsZXM6IHRydWUNCiAgICAgICAgfSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICAvLyBGb3IgSUUgc2luY2UgaXQgZG9lc24ndCBzdXBwb3J0IEV2ZW50IGNvbnN0cnVjdG9yDQogICAgICAgIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0V2ZW50Jyk7DQogICAgICAgIGV2ZW50LmluaXRFdmVudChldmVudE5hbWUsIHRydWUsIGZhbHNlKTsNCiAgICAgIH0NCg0KICAgICAgZWwuZGlzcGF0Y2hFdmVudChldmVudCk7DQogICAgfSBlbHNlIGlmIChlbC5maXJlRXZlbnQpIHsgLy8gZm9yIElFOA0KICAgICAgZXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudE9iamVjdCgpOw0KICAgICAgZXZlbnQuZXZlbnRUeXBlID0gZXZlbnROYW1lOw0KICAgICAgZWwuZmlyZUV2ZW50KCdvbicgKyBldmVudE5hbWUsIGV2ZW50KTsNCiAgICB9IGVsc2Ugew0KICAgICAgLy8gZmFsbCBiYWNrIHRvIGpRdWVyeS50cmlnZ2VyDQogICAgICB0aGlzLnRyaWdnZXIoZXZlbnROYW1lKTsNCiAgICB9DQogIH07DQogIC8vPC9lZGl0b3ItZm9sZD4NCg0KICBmdW5jdGlvbiBzdHJpbmdTZWFyY2gobGksIHNlYXJjaFN0cmluZywgbWV0aG9kLCBub3JtYWxpemUpIHsNCiAgICB2YXIgc3RyaW5nVHlwZXMgPSBbDQogICAgICAgICdjb250ZW50JywNCiAgICAgICAgJ3N1YnRleHQnLA0KICAgICAgICAndG9rZW5zJw0KICAgICAgXSwNCiAgICAgIHNlYXJjaFN1Y2Nlc3MgPSBmYWxzZTsNCg0KICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyaW5nVHlwZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgIHZhciBzdHJpbmdUeXBlID0gc3RyaW5nVHlwZXNbaV0sDQogICAgICAgICAgc3RyaW5nID0gbGlbc3RyaW5nVHlwZV07DQoNCiAgICAgIGlmIChzdHJpbmcpIHsNCiAgICAgICAgc3RyaW5nID0gc3RyaW5nLnRvU3RyaW5nKCk7DQoNCiAgICAgICAgLy8gU3RyaXAgSFRNTCB0YWdzLiBUaGlzIGlzbid0IHBlcmZlY3QsIGJ1dCBpdCdzIG11Y2ggZmFzdGVyIHRoYW4gYW55IG90aGVyIG1ldGhvZA0KICAgICAgICBpZiAoc3RyaW5nVHlwZSA9PT0gJ2NvbnRlbnQnKSB7DQogICAgICAgICAgc3RyaW5nID0gc3RyaW5nLnJlcGxhY2UoLzxbXj5dKz4vZywgJycpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKG5vcm1hbGl6ZSkgc3RyaW5nID0gbm9ybWFsaXplVG9CYXNlKHN0cmluZyk7DQogICAgICAgIHN0cmluZyA9IHN0cmluZy50b1VwcGVyQ2FzZSgpOw0KDQogICAgICAgIGlmIChtZXRob2QgPT09ICdjb250YWlucycpIHsNCiAgICAgICAgICBzZWFyY2hTdWNjZXNzID0gc3RyaW5nLmluZGV4T2Yoc2VhcmNoU3RyaW5nKSA+PSAwOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHNlYXJjaFN1Y2Nlc3MgPSBzdHJpbmcuc3RhcnRzV2l0aChzZWFyY2hTdHJpbmcpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKHNlYXJjaFN1Y2Nlc3MpIGJyZWFrOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIHJldHVybiBzZWFyY2hTdWNjZXNzOw0KICB9DQoNCiAgZnVuY3Rpb24gdG9JbnRlZ2VyKHZhbHVlKSB7DQogICAgcmV0dXJuIHBhcnNlSW50KHZhbHVlLCAxMCkgfHwgMDsNCiAgfQ0KDQogIC8qKg0KICAgKiBSZW1vdmUgYWxsIGRpYXRyaWNzIGZyb20gdGhlIGdpdmVuIHRleHQuDQogICAqIEBhY2Nlc3MgcHJpdmF0ZQ0KICAgKiBAcGFyYW0ge1N0cmluZ30gdGV4dA0KICAgKiBAcmV0dXJucyB7U3RyaW5nfQ0KICAgKi8NCiAgZnVuY3Rpb24gbm9ybWFsaXplVG9CYXNlKHRleHQpIHsNCiAgICB2YXIgckV4cHMgPSBbDQogICAgICB7cmU6IC9bXHhDMC1ceEM2XS9nLCBjaDogIkEifSwNCiAgICAgIHtyZTogL1tceEUwLVx4RTZdL2csIGNoOiAiYSJ9LA0KICAgICAge3JlOiAvW1x4QzgtXHhDQl0vZywgY2g6ICJFIn0sDQogICAgICB7cmU6IC9bXHhFOC1ceEVCXS9nLCBjaDogImUifSwNCiAgICAgIHtyZTogL1tceENDLVx4Q0ZdL2csIGNoOiAiSSJ9LA0KICAgICAge3JlOiAvW1x4RUMtXHhFRl0vZywgY2g6ICJpIn0sDQogICAgICB7cmU6IC9bXHhEMi1ceEQ2XS9nLCBjaDogIk8ifSwNCiAgICAgIHtyZTogL1tceEYyLVx4RjZdL2csIGNoOiAibyJ9LA0KICAgICAge3JlOiAvW1x4RDktXHhEQ10vZywgY2g6ICJVIn0sDQogICAgICB7cmU6IC9bXHhGOS1ceEZDXS9nLCBjaDogInUifSwNCiAgICAgIHtyZTogL1tceEM3LVx4RTddL2csIGNoOiAiYyJ9LA0KICAgICAge3JlOiAvW1x4RDFdL2csIGNoOiAiTiJ9LA0KICAgICAge3JlOiAvW1x4RjFdL2csIGNoOiAibiJ9DQogICAgXTsNCiAgICAkLmVhY2gockV4cHMsIGZ1bmN0aW9uICgpIHsNCiAgICAgIHRleHQgPSB0ZXh0ID8gdGV4dC5yZXBsYWNlKHRoaXMucmUsIHRoaXMuY2gpIDogJyc7DQogICAgfSk7DQogICAgcmV0dXJuIHRleHQ7DQogIH0NCg0KDQogIC8vIExpc3Qgb2YgSFRNTCBlbnRpdGllcyBmb3IgZXNjYXBpbmcuDQogIHZhciBlc2NhcGVNYXAgPSB7DQogICAgJyYnOiAnJmFtcDsnLA0KICAgICc8JzogJyZsdDsnLA0KICAgICc+JzogJyZndDsnLA0KICAgICciJzogJyZxdW90OycsDQogICAgIiciOiAnJiN4Mjc7JywNCiAgICAnYCc6ICcmI3g2MDsnDQogIH07DQogIA0KICB2YXIgdW5lc2NhcGVNYXAgPSB7DQogICAgJyZhbXA7JzogJyYnLA0KICAgICcmbHQ7JzogJzwnLA0KICAgICcmZ3Q7JzogJz4nLA0KICAgICcmcXVvdDsnOiAnIicsDQogICAgJyYjeDI3Oyc6ICInIiwNCiAgICAnJiN4NjA7JzogJ2AnDQogIH07DQoNCiAgLy8gRnVuY3Rpb25zIGZvciBlc2NhcGluZyBhbmQgdW5lc2NhcGluZyBzdHJpbmdzIHRvL2Zyb20gSFRNTCBpbnRlcnBvbGF0aW9uLg0KICB2YXIgY3JlYXRlRXNjYXBlciA9IGZ1bmN0aW9uIChtYXApIHsNCiAgICB2YXIgZXNjYXBlciA9IGZ1bmN0aW9uIChtYXRjaCkgew0KICAgICAgcmV0dXJuIG1hcFttYXRjaF07DQogICAgfTsNCiAgICAvLyBSZWdleGVzIGZvciBpZGVudGlmeWluZyBhIGtleSB0aGF0IG5lZWRzIHRvIGJlIGVzY2FwZWQuDQogICAgdmFyIHNvdXJjZSA9ICcoPzonICsgT2JqZWN0LmtleXMobWFwKS5qb2luKCd8JykgKyAnKSc7DQogICAgdmFyIHRlc3RSZWdleHAgPSBSZWdFeHAoc291cmNlKTsNCiAgICB2YXIgcmVwbGFjZVJlZ2V4cCA9IFJlZ0V4cChzb3VyY2UsICdnJyk7DQogICAgcmV0dXJuIGZ1bmN0aW9uIChzdHJpbmcpIHsNCiAgICAgIHN0cmluZyA9IHN0cmluZyA9PSBudWxsID8gJycgOiAnJyArIHN0cmluZzsNCiAgICAgIHJldHVybiB0ZXN0UmVnZXhwLnRlc3Qoc3RyaW5nKSA/IHN0cmluZy5yZXBsYWNlKHJlcGxhY2VSZWdleHAsIGVzY2FwZXIpIDogc3RyaW5nOw0KICAgIH07DQogIH07DQoNCiAgdmFyIGh0bWxFc2NhcGUgPSBjcmVhdGVFc2NhcGVyKGVzY2FwZU1hcCk7DQogIHZhciBodG1sVW5lc2NhcGUgPSBjcmVhdGVFc2NhcGVyKHVuZXNjYXBlTWFwKTsNCg0KICAvKioNCiAgICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAqIENvbnN0YW50cw0KICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgICovDQoNCiAgdmFyIGtleUNvZGVNYXAgPSB7DQogICAgMzI6ICcgJywNCiAgICA0ODogJzAnLA0KICAgIDQ5OiAnMScsDQogICAgNTA6ICcyJywNCiAgICA1MTogJzMnLA0KICAgIDUyOiAnNCcsDQogICAgNTM6ICc1JywNCiAgICA1NDogJzYnLA0KICAgIDU1OiAnNycsDQogICAgNTY6ICc4JywNCiAgICA1NzogJzknLA0KICAgIDU5OiAnOycsDQogICAgNjU6ICdBJywNCiAgICA2NjogJ0InLA0KICAgIDY3OiAnQycsDQogICAgNjg6ICdEJywNCiAgICA2OTogJ0UnLA0KICAgIDcwOiAnRicsDQogICAgNzE6ICdHJywNCiAgICA3MjogJ0gnLA0KICAgIDczOiAnSScsDQogICAgNzQ6ICdKJywNCiAgICA3NTogJ0snLA0KICAgIDc2OiAnTCcsDQogICAgNzc6ICdNJywNCiAgICA3ODogJ04nLA0KICAgIDc5OiAnTycsDQogICAgODA6ICdQJywNCiAgICA4MTogJ1EnLA0KICAgIDgyOiAnUicsDQogICAgODM6ICdTJywNCiAgICA4NDogJ1QnLA0KICAgIDg1OiAnVScsDQogICAgODY6ICdWJywNCiAgICA4NzogJ1cnLA0KICAgIDg4OiAnWCcsDQogICAgODk6ICdZJywNCiAgICA5MDogJ1onLA0KICAgIDk2OiAnMCcsDQogICAgOTc6ICcxJywNCiAgICA5ODogJzInLA0KICAgIDk5OiAnMycsDQogICAgMTAwOiAnNCcsDQogICAgMTAxOiAnNScsDQogICAgMTAyOiAnNicsDQogICAgMTAzOiAnNycsDQogICAgMTA0OiAnOCcsDQogICAgMTA1OiAnOScNCiAgfTsNCg0KICB2YXIga2V5Q29kZXMgPSB7DQogICAgRVNDQVBFOiAyNywgLy8gS2V5Ym9hcmRFdmVudC53aGljaCB2YWx1ZSBmb3IgRXNjYXBlIChFc2MpIGtleQ0KICAgIEVOVEVSOiAxMywgLy8gS2V5Ym9hcmRFdmVudC53aGljaCB2YWx1ZSBmb3IgRW50ZXIga2V5DQogICAgU1BBQ0U6IDMyLCAvLyBLZXlib2FyZEV2ZW50LndoaWNoIHZhbHVlIGZvciBzcGFjZSBrZXkNCiAgICBUQUI6IDksIC8vIEtleWJvYXJkRXZlbnQud2hpY2ggdmFsdWUgZm9yIHRhYiBrZXkNCiAgICBBUlJPV19VUDogMzgsIC8vIEtleWJvYXJkRXZlbnQud2hpY2ggdmFsdWUgZm9yIHVwIGFycm93IGtleQ0KICAgIEFSUk9XX0RPV046IDQwIC8vIEtleWJvYXJkRXZlbnQud2hpY2ggdmFsdWUgZm9yIGRvd24gYXJyb3cga2V5DQogIH0NCg0KICB2YXIgdmVyc2lvbiA9IHt9Ow0KDQogIHRyeSB7DQogICAgdmVyc2lvbi5mdWxsID0gKCQuZm4uZHJvcGRvd24uQ29uc3RydWN0b3IuVkVSU0lPTiB8fCAnJykuc3BsaXQoJyAnKVswXS5zcGxpdCgnLicpOw0KICAgIHZlcnNpb24ubWFqb3IgPSB2ZXJzaW9uLmZ1bGxbMF07DQogIH0NCiAgY2F0Y2goZXJyKSB7DQogICAgY29uc29sZS5lcnJvcignVGhlcmUgd2FzIGFuIGlzc3VlIHJldHJpZXZpbmcgQm9vdHN0cmFwXCdzIHZlcnNpb24uIEVuc3VyZSBCb290c3RyYXAgaXMgYmVpbmcgbG9hZGVkIGJlZm9yZSBib290c3RyYXAtc2VsZWN0IGFuZCB0aGVyZSBpcyBubyBuYW1lc3BhY2UgY29sbGlzaW9uLicsIGVycik7DQogICAgdmVyc2lvbi5tYWpvciA9ICczJzsNCiAgfQ0KDQogIHZhciBjbGFzc05hbWVzID0gew0KICAgIERJU0FCTEVEOiAnZGlzYWJsZWQnLA0KICAgIERJVklERVI6IHZlcnNpb24ubWFqb3IgPT09ICc0JyA/ICdkcm9wZG93bi1kaXZpZGVyJyA6ICdkaXZpZGVyJywNCiAgICBTSE9XOiB2ZXJzaW9uLm1ham9yID09PSAnNCcgPyAnc2hvdycgOiAnb3BlbicsDQogICAgRFJPUFVQOiAnZHJvcHVwJywNCiAgICBNRU5VUklHSFQ6ICdkcm9wZG93bi1tZW51LXJpZ2h0JywNCiAgICBNRU5VTEVGVDogJ2Ryb3Bkb3duLW1lbnUtbGVmdCcsDQogICAgLy8gdG8tZG86IHJlcGxhY2Ugd2l0aCBtb3JlIGFkdmFuY2VkIHRlbXBsYXRlL2N1c3RvbWl6YXRpb24gb3B0aW9ucw0KICAgIEJVVFRPTkNMQVNTOiB2ZXJzaW9uLm1ham9yID09PSAnNCcgPyAnYnRuLWxpZ2h0JyA6ICdidG4tZGVmYXVsdCcsDQogICAgUE9QT1ZFUkhFQURFUjogdmVyc2lvbi5tYWpvciA9PT0gJzQnID8gJ3BvcG92ZXItaGVhZGVyJyA6ICdwb3BvdmVyLXRpdGxlJw0KICB9DQoNCiAgdmFyIFJFR0VYUF9BUlJPVyA9IG5ldyBSZWdFeHAoa2V5Q29kZXMuQVJST1dfVVAgKyAnfCcgKyBrZXlDb2Rlcy5BUlJPV19ET1dOKTsNCiAgdmFyIFJFR0VYUF9UQUJfT1JfRVNDQVBFID0gbmV3IFJlZ0V4cCgnXicgKyBrZXlDb2Rlcy5UQUIgKyAnJHwnICsga2V5Q29kZXMuRVNDQVBFKTsNCiAgdmFyIFJFR0VYUF9FTlRFUl9PUl9TUEFDRSA9IG5ldyBSZWdFeHAoa2V5Q29kZXMuRU5URVIgKyAnfCcgKyBrZXlDb2Rlcy5TUEFDRSk7DQoNCiAgdmFyIFNlbGVjdHBpY2tlciA9IGZ1bmN0aW9uIChlbGVtZW50LCBvcHRpb25zKSB7DQogICAgdmFyIHRoYXQgPSB0aGlzOw0KDQogICAgLy8gYm9vdHN0cmFwLXNlbGVjdCBoYXMgYmVlbiBpbml0aWFsaXplZCAtIHJldmVydCB2YWxIb29rcy5zZWxlY3Quc2V0IGJhY2sgdG8gaXRzIG9yaWdpbmFsIGZ1bmN0aW9uDQogICAgaWYgKCF2YWxIb29rcy51c2VEZWZhdWx0KSB7DQogICAgICAkLnZhbEhvb2tzLnNlbGVjdC5zZXQgPSB2YWxIb29rcy5fc2V0Ow0KICAgICAgdmFsSG9va3MudXNlRGVmYXVsdCA9IHRydWU7DQogICAgfQ0KDQogICAgdGhpcy4kZWxlbWVudCA9ICQoZWxlbWVudCk7DQogICAgdGhpcy4kbmV3RWxlbWVudCA9IG51bGw7DQogICAgdGhpcy4kYnV0dG9uID0gbnVsbDsNCiAgICB0aGlzLiRtZW51ID0gbnVsbDsNCiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zOw0KICAgIHRoaXMuc2VsZWN0cGlja2VyID0gew0KICAgICAgbWFpbjogew0KICAgICAgICAvLyBzdG9yZSBvcmlnaW5hbEluZGV4IChrZXkpIGFuZCBuZXdJbmRleCAodmFsdWUpIGluIHRoaXMuc2VsZWN0cGlja2VyLm1haW4ubWFwLm5ld0luZGV4IGZvciBmYXN0IGFjY2Vzc2liaWxpdHkNCiAgICAgICAgLy8gYWxsb3dzIHVzIHRvIGRvIHRoaXMubWFpbi5lbGVtZW50c1t0aGlzLnNlbGVjdHBpY2tlci5tYWluLm1hcC5uZXdJbmRleFtpbmRleF1dIHRvIHNlbGVjdCBhbiBlbGVtZW50IGJhc2VkIG9uIHRoZSBvcmlnaW5hbEluZGV4DQogICAgICAgIG1hcDogew0KICAgICAgICAgIG5ld0luZGV4OiB7fSwNCiAgICAgICAgICBvcmlnaW5hbEluZGV4OiB7fQ0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgY3VycmVudDogew0KICAgICAgICBtYXA6IHt9DQogICAgICB9LCAvLyBjdXJyZW50IGNoYW5nZXMgaWYgYSBzZWFyY2ggaXMgaW4gcHJvZ3Jlc3MNCiAgICAgIHNlYXJjaDogew0KICAgICAgICBtYXA6IHt9DQogICAgICB9LA0KICAgICAgdmlldzoge30sDQogICAgICBrZXlkb3duOiB7DQogICAgICAgIGtleUhpc3Rvcnk6ICcnLA0KICAgICAgICByZXNldEtleUhpc3Rvcnk6IHsNCiAgICAgICAgICBzdGFydDogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICB0aGF0LnNlbGVjdHBpY2tlci5rZXlkb3duLmtleUhpc3RvcnkgPSAnJzsNCiAgICAgICAgICAgIH0sIDgwMCk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9DQogICAgfTsNCiAgICAvLyBJZiB3ZSBoYXZlIG5vIHRpdGxlIHlldCwgdHJ5IHRvIHB1bGwgaXQgZnJvbSB0aGUgaHRtbCB0aXRsZSBhdHRyaWJ1dGUgKGpRdWVyeSBkb2VzbnQnIHBpY2sgaXQgdXAgYXMgaXQncyBub3QgYQ0KICAgIC8vIGRhdGEtYXR0cmlidXRlKQ0KICAgIGlmICh0aGlzLm9wdGlvbnMudGl0bGUgPT09IG51bGwpIHsNCiAgICAgIHRoaXMub3B0aW9ucy50aXRsZSA9IHRoaXMuJGVsZW1lbnQuYXR0cigndGl0bGUnKTsNCiAgICB9DQoNCiAgICAvLyBGb3JtYXQgd2luZG93IHBhZGRpbmcNCiAgICB2YXIgd2luUGFkID0gdGhpcy5vcHRpb25zLndpbmRvd1BhZGRpbmc7DQogICAgaWYgKHR5cGVvZiB3aW5QYWQgPT09ICdudW1iZXInKSB7DQogICAgICB0aGlzLm9wdGlvbnMud2luZG93UGFkZGluZyA9IFt3aW5QYWQsIHdpblBhZCwgd2luUGFkLCB3aW5QYWRdOw0KICAgIH0NCg0KICAgIC8vRXhwb3NlIHB1YmxpYyBtZXRob2RzDQogICAgdGhpcy52YWwgPSBTZWxlY3RwaWNrZXIucHJvdG90eXBlLnZhbDsNCiAgICB0aGlzLnJlbmRlciA9IFNlbGVjdHBpY2tlci5wcm90b3R5cGUucmVuZGVyOw0KICAgIHRoaXMucmVmcmVzaCA9IFNlbGVjdHBpY2tlci5wcm90b3R5cGUucmVmcmVzaDsNCiAgICB0aGlzLnNldFN0eWxlID0gU2VsZWN0cGlja2VyLnByb3RvdHlwZS5zZXRTdHlsZTsNCiAgICB0aGlzLnNlbGVjdEFsbCA9IFNlbGVjdHBpY2tlci5wcm90b3R5cGUuc2VsZWN0QWxsOw0KICAgIHRoaXMuZGVzZWxlY3RBbGwgPSBTZWxlY3RwaWNrZXIucHJvdG90eXBlLmRlc2VsZWN0QWxsOw0KICAgIHRoaXMuZGVzdHJveSA9IFNlbGVjdHBpY2tlci5wcm90b3R5cGUuZGVzdHJveTsNCiAgICB0aGlzLnJlbW92ZSA9IFNlbGVjdHBpY2tlci5wcm90b3R5cGUucmVtb3ZlOw0KICAgIHRoaXMuc2hvdyA9IFNlbGVjdHBpY2tlci5wcm90b3R5cGUuc2hvdzsNCiAgICB0aGlzLmhpZGUgPSBTZWxlY3RwaWNrZXIucHJvdG90eXBlLmhpZGU7DQoNCiAgICB0aGlzLmluaXQoKTsNCiAgfTsNCg0KICBTZWxlY3RwaWNrZXIuVkVSU0lPTiA9ICcxLjEzLjEnOw0KDQogIC8vIHBhcnQgb2YgdGhpcyBpcyBkdXBsaWNhdGVkIGluIGkxOG4vZGVmYXVsdHMtZW5fVVMuanMuIE1ha2Ugc3VyZSB0byB1cGRhdGUgYm90aC4NCiAgU2VsZWN0cGlja2VyLkRFRkFVTFRTID0gew0KICAgIG5vbmVTZWxlY3RlZFRleHQ6ICdOb3RoaW5nIHNlbGVjdGVkJywNCiAgICBub25lUmVzdWx0c1RleHQ6ICdObyByZXN1bHRzIG1hdGNoZWQgezB9JywNCiAgICBjb3VudFNlbGVjdGVkVGV4dDogZnVuY3Rpb24gKG51bVNlbGVjdGVkLCBudW1Ub3RhbCkgew0KICAgICAgcmV0dXJuIChudW1TZWxlY3RlZCA9PSAxKSA/ICJ7MH0gaXRlbSBzZWxlY3RlZCIgOiAiezB9IGl0ZW1zIHNlbGVjdGVkIjsNCiAgICB9LA0KICAgIG1heE9wdGlvbnNUZXh0OiBmdW5jdGlvbiAobnVtQWxsLCBudW1Hcm91cCkgew0KICAgICAgcmV0dXJuIFsNCiAgICAgICAgKG51bUFsbCA9PSAxKSA/ICdMaW1pdCByZWFjaGVkICh7bn0gaXRlbSBtYXgpJyA6ICdMaW1pdCByZWFjaGVkICh7bn0gaXRlbXMgbWF4KScsDQogICAgICAgIChudW1Hcm91cCA9PSAxKSA/ICdHcm91cCBsaW1pdCByZWFjaGVkICh7bn0gaXRlbSBtYXgpJyA6ICdHcm91cCBsaW1pdCByZWFjaGVkICh7bn0gaXRlbXMgbWF4KScNCiAgICAgIF07DQogICAgfSwNCiAgICBzZWxlY3RBbGxUZXh0OiAnU2VsZWN0IEFsbCcsDQogICAgZGVzZWxlY3RBbGxUZXh0OiAnRGVzZWxlY3QgQWxsJywNCiAgICBkb25lQnV0dG9uOiBmYWxzZSwNCiAgICBkb25lQnV0dG9uVGV4dDogJ0Nsb3NlJywNCiAgICBtdWx0aXBsZVNlcGFyYXRvcjogJywgJywNCiAgICBzdHlsZUJhc2U6ICdidG4nLA0KICAgIHN0eWxlOiAnYnRuLWRlZmF1bHQnLA0KICAgIHNpemU6ICdhdXRvJywNCiAgICB0aXRsZTogbnVsbCwNCiAgICBzZWxlY3RlZFRleHRGb3JtYXQ6ICd2YWx1ZXMnLA0KICAgIHdpZHRoOiBmYWxzZSwNCiAgICBjb250YWluZXI6IGZhbHNlLA0KICAgIGhpZGVEaXNhYmxlZDogZmFsc2UsDQogICAgc2hvd1N1YnRleHQ6IGZhbHNlLA0KICAgIHNob3dJY29uOiB0cnVlLA0KICAgIHNob3dDb250ZW50OiB0cnVlLA0KICAgIGRyb3B1cEF1dG86IHRydWUsDQogICAgaGVhZGVyOiBmYWxzZSwNCiAgICBsaXZlU2VhcmNoOiBmYWxzZSwNCiAgICBsaXZlU2VhcmNoUGxhY2Vob2xkZXI6IG51bGwsDQogICAgbGl2ZVNlYXJjaE5vcm1hbGl6ZTogZmFsc2UsDQogICAgbGl2ZVNlYXJjaFN0eWxlOiAnY29udGFpbnMnLA0KICAgIGFjdGlvbnNCb3g6IGZhbHNlLA0KICAgIGljb25CYXNlOiAnZ2x5cGhpY29uJywNCiAgICB0aWNrSWNvbjogJ2dseXBoaWNvbi1vaycsDQogICAgc2hvd1RpY2s6IGZhbHNlLA0KICAgIHRlbXBsYXRlOiB7DQogICAgICBjYXJldDogJzxzcGFuIGNsYXNzPSJjYXJldCI+PC9zcGFuPicNCiAgICB9LA0KICAgIG1heE9wdGlvbnM6IGZhbHNlLA0KICAgIG1vYmlsZTogZmFsc2UsDQogICAgc2VsZWN0T25UYWI6IGZhbHNlLA0KICAgIGRyb3Bkb3duQWxpZ25SaWdodDogZmFsc2UsDQogICAgd2luZG93UGFkZGluZzogMCwNCiAgICB2aXJ0dWFsU2Nyb2xsOiA2MDANCiAgfTsNCg0KICBpZiAodmVyc2lvbi5tYWpvciA9PT0gJzQnKSB7DQogICAgU2VsZWN0cGlja2VyLkRFRkFVTFRTLnN0eWxlID0gJ2J0bi1saWdodCc7DQogICAgU2VsZWN0cGlja2VyLkRFRkFVTFRTLmljb25CYXNlID0gJyc7DQogICAgU2VsZWN0cGlja2VyLkRFRkFVTFRTLnRpY2tJY29uID0gJ2JzLW9rLWRlZmF1bHQnOw0KICB9DQoNCiAgU2VsZWN0cGlja2VyLnByb3RvdHlwZSA9IHsNCg0KICAgIGNvbnN0cnVjdG9yOiBTZWxlY3RwaWNrZXIsDQoNCiAgICBpbml0OiBmdW5jdGlvbiAoKSB7DQogICAgICB2YXIgdGhhdCA9IHRoaXMsDQogICAgICAgICAgaWQgPSB0aGlzLiRlbGVtZW50LmF0dHIoJ2lkJyk7DQoNCiAgICAgIHRoaXMuJGVsZW1lbnQuYWRkQ2xhc3MoJ2JzLXNlbGVjdC1oaWRkZW4nKTsNCg0KICAgICAgdGhpcy5tdWx0aXBsZSA9IHRoaXMuJGVsZW1lbnQucHJvcCgnbXVsdGlwbGUnKTsNCiAgICAgIHRoaXMuYXV0b2ZvY3VzID0gdGhpcy4kZWxlbWVudC5wcm9wKCdhdXRvZm9jdXMnKTsNCiAgICAgIHRoaXMuJG5ld0VsZW1lbnQgPSB0aGlzLmNyZWF0ZURyb3Bkb3duKCk7DQogICAgICB0aGlzLmNyZWF0ZUxpKCk7DQogICAgICB0aGlzLiRlbGVtZW50DQogICAgICAgIC5hZnRlcih0aGlzLiRuZXdFbGVtZW50KQ0KICAgICAgICAucHJlcGVuZFRvKHRoaXMuJG5ld0VsZW1lbnQpOw0KICAgICAgdGhpcy4kYnV0dG9uID0gdGhpcy4kbmV3RWxlbWVudC5jaGlsZHJlbignYnV0dG9uJyk7DQogICAgICB0aGlzLiRtZW51ID0gdGhpcy4kbmV3RWxlbWVudC5jaGlsZHJlbignLmRyb3Bkb3duLW1lbnUnKTsNCiAgICAgIHRoaXMuJG1lbnVJbm5lciA9IHRoaXMuJG1lbnUuY2hpbGRyZW4oJy5pbm5lcicpOw0KICAgICAgdGhpcy4kc2VhcmNoYm94ID0gdGhpcy4kbWVudS5maW5kKCdpbnB1dCcpOw0KDQogICAgICB0aGlzLiRlbGVtZW50LnJlbW92ZUNsYXNzKCdicy1zZWxlY3QtaGlkZGVuJyk7DQoNCiAgICAgIGlmICh0aGlzLm9wdGlvbnMuZHJvcGRvd25BbGlnblJpZ2h0ID09PSB0cnVlKSB0aGlzLiRtZW51LmFkZENsYXNzKGNsYXNzTmFtZXMuTUVOVVJJR0hUKTsNCg0KICAgICAgaWYgKHR5cGVvZiBpZCAhPT0gJ3VuZGVmaW5lZCcpIHsNCiAgICAgICAgdGhpcy4kYnV0dG9uLmF0dHIoJ2RhdGEtaWQnLCBpZCk7DQogICAgICB9DQoNCiAgICAgIHRoaXMuY2hlY2tEaXNhYmxlZCgpOw0KICAgICAgdGhpcy5jbGlja0xpc3RlbmVyKCk7DQogICAgICBpZiAodGhpcy5vcHRpb25zLmxpdmVTZWFyY2gpIHRoaXMubGl2ZVNlYXJjaExpc3RlbmVyKCk7DQogICAgICB0aGlzLnJlbmRlcigpOw0KICAgICAgdGhpcy5zZXRTdHlsZSgpOw0KICAgICAgdGhpcy5zZXRXaWR0aCgpOw0KICAgICAgaWYgKHRoaXMub3B0aW9ucy5jb250YWluZXIpIHsNCiAgICAgICAgdGhpcy5zZWxlY3RQb3NpdGlvbigpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy4kZWxlbWVudC5vbignaGlkZS5icy5zZWxlY3QnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgaWYgKHRoYXQuaXNWaXJ0dWFsKCkpIHsNCiAgICAgICAgICAgIC8vIGVtcHR5IG1lbnUgb24gY2xvc2UNCiAgICAgICAgICAgIHZhciBtZW51SW5uZXIgPSB0aGF0LiRtZW51SW5uZXJbMF0sDQogICAgICAgICAgICAgICAgZW1wdHlNZW51ID0gbWVudUlubmVyLmZpcnN0Q2hpbGQuY2xvbmVOb2RlKGZhbHNlKTsNCg0KICAgICAgICAgICAgLy8gcmVwbGFjZSB0aGUgZXhpc3RpbmcgVUwgd2l0aCBhbiBlbXB0eSBvbmUgLSB0aGlzIGlzIGZhc3RlciB0aGFuICQuZW1wdHkoKSBvciBpbm5lckhUTUwgPSAnJw0KICAgICAgICAgICAgbWVudUlubmVyLnJlcGxhY2VDaGlsZChlbXB0eU1lbnUsIG1lbnVJbm5lci5maXJzdENoaWxkKTsNCiAgICAgICAgICAgIG1lbnVJbm5lci5zY3JvbGxUb3AgPSAwOw0KICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICB9DQogICAgICB0aGlzLiRtZW51LmRhdGEoJ3RoaXMnLCB0aGlzKTsNCiAgICAgIHRoaXMuJG5ld0VsZW1lbnQuZGF0YSgndGhpcycsIHRoaXMpOw0KICAgICAgaWYgKHRoaXMub3B0aW9ucy5tb2JpbGUpIHRoaXMubW9iaWxlKCk7DQoNCiAgICAgIHRoaXMuJG5ld0VsZW1lbnQub24oew0KICAgICAgICAnaGlkZS5icy5kcm9wZG93bic6IGZ1bmN0aW9uIChlKSB7DQogICAgICAgICAgdGhhdC4kbWVudUlubmVyLmF0dHIoJ2FyaWEtZXhwYW5kZWQnLCBmYWxzZSk7DQogICAgICAgICAgdGhhdC4kZWxlbWVudC50cmlnZ2VyKCdoaWRlLmJzLnNlbGVjdCcsIGUpOw0KICAgICAgICB9LA0KICAgICAgICAnaGlkZGVuLmJzLmRyb3Bkb3duJzogZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgICB0aGF0LiRlbGVtZW50LnRyaWdnZXIoJ2hpZGRlbi5icy5zZWxlY3QnLCBlKTsNCiAgICAgICAgfSwNCiAgICAgICAgJ3Nob3cuYnMuZHJvcGRvd24nOiBmdW5jdGlvbiAoZSkgew0KICAgICAgICAgIHRoYXQuJG1lbnVJbm5lci5hdHRyKCdhcmlhLWV4cGFuZGVkJywgdHJ1ZSk7DQogICAgICAgICAgdGhhdC4kZWxlbWVudC50cmlnZ2VyKCdzaG93LmJzLnNlbGVjdCcsIGUpOw0KICAgICAgICB9LA0KICAgICAgICAnc2hvd24uYnMuZHJvcGRvd24nOiBmdW5jdGlvbiAoZSkgew0KICAgICAgICAgIHRoYXQuJGVsZW1lbnQudHJpZ2dlcignc2hvd24uYnMuc2VsZWN0JywgZSk7DQogICAgICAgIH0NCiAgICAgIH0pOw0KDQogICAgICBpZiAodGhhdC4kZWxlbWVudFswXS5oYXNBdHRyaWJ1dGUoJ3JlcXVpcmVkJykpIHsNCiAgICAgICAgdGhpcy4kZWxlbWVudC5vbignaW52YWxpZCcsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICB0aGF0LiRidXR0b24uYWRkQ2xhc3MoJ2JzLWludmFsaWQnKTsNCg0KICAgICAgICAgIHRoYXQuJGVsZW1lbnQub24oew0KICAgICAgICAgICAgJ3Nob3duLmJzLnNlbGVjdCc6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgdGhhdC4kZWxlbWVudA0KICAgICAgICAgICAgICAgIC52YWwodGhhdC4kZWxlbWVudC52YWwoKSkgLy8gc2V0IHRoZSB2YWx1ZSB0byBoaWRlIHRoZSB2YWxpZGF0aW9uIG1lc3NhZ2UgaW4gQ2hyb21lIHdoZW4gbWVudSBpcyBvcGVuZWQNCiAgICAgICAgICAgICAgICAub2ZmKCdzaG93bi5icy5zZWxlY3QnKTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAncmVuZGVyZWQuYnMuc2VsZWN0JzogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAvLyBpZiBzZWxlY3QgaXMgbm8gbG9uZ2VyIGludmFsaWQsIHJlbW92ZSB0aGUgYnMtaW52YWxpZCBjbGFzcw0KICAgICAgICAgICAgICBpZiAodGhpcy52YWxpZGl0eS52YWxpZCkgdGhhdC4kYnV0dG9uLnJlbW92ZUNsYXNzKCdicy1pbnZhbGlkJyk7DQogICAgICAgICAgICAgIHRoYXQuJGVsZW1lbnQub2ZmKCdyZW5kZXJlZC5icy5zZWxlY3QnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9KTsNCg0KICAgICAgICAgIHRoYXQuJGJ1dHRvbi5vbignYmx1ci5icy5zZWxlY3QnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB0aGF0LiRlbGVtZW50LmZvY3VzKCkuYmx1cigpOw0KICAgICAgICAgICAgdGhhdC4kYnV0dG9uLm9mZignYmx1ci5icy5zZWxlY3QnKTsNCiAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgICB9DQoNCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgew0KICAgICAgICB0aGF0LiRlbGVtZW50LnRyaWdnZXIoJ2xvYWRlZC5icy5zZWxlY3QnKTsNCiAgICAgIH0pOw0KICAgIH0sDQoNCiAgICBjcmVhdGVEcm9wZG93bjogZnVuY3Rpb24gKCkgew0KICAgICAgLy8gT3B0aW9ucw0KICAgICAgLy8gSWYgd2UgYXJlIG11bHRpcGxlIG9yIHNob3dUaWNrIG9wdGlvbiBpcyBzZXQsIHRoZW4gYWRkIHRoZSBzaG93LXRpY2sgY2xhc3MNCiAgICAgIHZhciBzaG93VGljayA9ICh0aGlzLm11bHRpcGxlIHx8IHRoaXMub3B0aW9ucy5zaG93VGljaykgPyAnIHNob3ctdGljaycgOiAnJywNCiAgICAgICAgICBhdXRvZm9jdXMgPSB0aGlzLmF1dG9mb2N1cyA/ICcgYXV0b2ZvY3VzJyA6ICcnOw0KICAgICAgLy8gRWxlbWVudHMNCiAgICAgIHZhciBoZWFkZXIgPSB0aGlzLm9wdGlvbnMuaGVhZGVyID8gJzxkaXYgY2xhc3M9IicgKyBjbGFzc05hbWVzLlBPUE9WRVJIRUFERVIgKyAnIj48YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImNsb3NlIiBhcmlhLWhpZGRlbj0idHJ1ZSI+JnRpbWVzOzwvYnV0dG9uPicgKyB0aGlzLm9wdGlvbnMuaGVhZGVyICsgJzwvZGl2PicgOiAnJzsNCiAgICAgIHZhciBzZWFyY2hib3ggPSB0aGlzLm9wdGlvbnMubGl2ZVNlYXJjaCA/DQogICAgICAnPGRpdiBjbGFzcz0iYnMtc2VhcmNoYm94Ij4nICsNCiAgICAgICc8aW5wdXQgdHlwZT0idGV4dCIgY2xhc3M9ImZvcm0tY29udHJvbCIgYXV0b2NvbXBsZXRlPSJvZmYiJyArDQogICAgICAobnVsbCA9PT0gdGhpcy5vcHRpb25zLmxpdmVTZWFyY2hQbGFjZWhvbGRlciA/ICcnIDogJyBwbGFjZWhvbGRlcj0iJyArIGh0bWxFc2NhcGUodGhpcy5vcHRpb25zLmxpdmVTZWFyY2hQbGFjZWhvbGRlcikgKyAnIicpICsgJyByb2xlPSJ0ZXh0Ym94IiBhcmlhLWxhYmVsPSJTZWFyY2giPicgKw0KICAgICAgJzwvZGl2PicNCiAgICAgICAgICA6ICcnOw0KICAgICAgdmFyIGFjdGlvbnNib3ggPSB0aGlzLm11bHRpcGxlICYmIHRoaXMub3B0aW9ucy5hY3Rpb25zQm94ID8NCiAgICAgICc8ZGl2IGNsYXNzPSJicy1hY3Rpb25zYm94Ij4nICsNCiAgICAgICc8ZGl2IGNsYXNzPSJidG4tZ3JvdXAgYnRuLWdyb3VwLXNtIGJ0bi1ibG9jayI+JyArDQogICAgICAnPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJhY3Rpb25zLWJ0biBicy1zZWxlY3QtYWxsIGJ0biAnICsgY2xhc3NOYW1lcy5CVVRUT05DTEFTUyArICciPicgKw0KICAgICAgdGhpcy5vcHRpb25zLnNlbGVjdEFsbFRleHQgKw0KICAgICAgJzwvYnV0dG9uPicgKw0KICAgICAgJzxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iYWN0aW9ucy1idG4gYnMtZGVzZWxlY3QtYWxsIGJ0biAnICsgY2xhc3NOYW1lcy5CVVRUT05DTEFTUyArICciPicgKw0KICAgICAgdGhpcy5vcHRpb25zLmRlc2VsZWN0QWxsVGV4dCArDQogICAgICAnPC9idXR0b24+JyArDQogICAgICAnPC9kaXY+JyArDQogICAgICAnPC9kaXY+Jw0KICAgICAgICAgIDogJyc7DQogICAgICB2YXIgZG9uZWJ1dHRvbiA9IHRoaXMubXVsdGlwbGUgJiYgdGhpcy5vcHRpb25zLmRvbmVCdXR0b24gPw0KICAgICAgJzxkaXYgY2xhc3M9ImJzLWRvbmVidXR0b24iPicgKw0KICAgICAgJzxkaXYgY2xhc3M9ImJ0bi1ncm91cCBidG4tYmxvY2siPicgKw0KICAgICAgJzxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuIGJ0bi1zbSAnICsgY2xhc3NOYW1lcy5CVVRUT05DTEFTUyArICciPicgKw0KICAgICAgdGhpcy5vcHRpb25zLmRvbmVCdXR0b25UZXh0ICsNCiAgICAgICc8L2J1dHRvbj4nICsNCiAgICAgICc8L2Rpdj4nICsNCiAgICAgICc8L2Rpdj4nDQogICAgICAgICAgOiAnJzsNCiAgICAgIHZhciBkcm9wID0NCiAgICAgICAgICAnPGRpdiBjbGFzcz0iZHJvcGRvd24gYm9vdHN0cmFwLXNlbGVjdCcgKyBzaG93VGljayArICciPicgKw0KICAgICAgICAgICc8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9IicgKyB0aGlzLm9wdGlvbnMuc3R5bGVCYXNlICsgJyBkcm9wZG93bi10b2dnbGUiIGRhdGEtdG9nZ2xlPSJkcm9wZG93biInICsgYXV0b2ZvY3VzICsgJyByb2xlPSJidXR0b24iPicgKw0KICAgICAgICAgICc8ZGl2IGNsYXNzPSJmaWx0ZXItb3B0aW9uIj4nICsNCiAgICAgICAgICAgICc8ZGl2IGNsYXNzPSJmaWx0ZXItb3B0aW9uLWlubmVyIj4nICsNCiAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9ImZpbHRlci1vcHRpb24taW5uZXItaW5uZXIiPjwvZGl2PicgKw0KICAgICAgICAgICAgJzwvZGl2PiAnICsNCiAgICAgICAgICAnPC9kaXY+JyArDQogICAgICAgICAgKHZlcnNpb24ubWFqb3IgPT09ICc0JyA/DQogICAgICAgICAgICAnJyA6DQogICAgICAgICAgJzxzcGFuIGNsYXNzPSJicy1jYXJldCI+JyArDQogICAgICAgICAgdGhpcy5vcHRpb25zLnRlbXBsYXRlLmNhcmV0ICsNCiAgICAgICAgICAnPC9zcGFuPicNCiAgICAgICAgICApICsNCiAgICAgICAgICAnPC9idXR0b24+JyArDQogICAgICAgICAgJzxkaXYgY2xhc3M9ImRyb3Bkb3duLW1lbnUgJyArICh2ZXJzaW9uLm1ham9yID09PSAnNCcgPyAnJyA6IGNsYXNzTmFtZXMuU0hPVykgKyAnIiByb2xlPSJjb21ib2JveCI+JyArDQogICAgICAgICAgaGVhZGVyICsNCiAgICAgICAgICBzZWFyY2hib3ggKw0KICAgICAgICAgIGFjdGlvbnNib3ggKw0KICAgICAgICAgICc8ZGl2IGNsYXNzPSJpbm5lciAnICsgY2xhc3NOYW1lcy5TSE9XICsgJyIgcm9sZT0ibGlzdGJveCIgYXJpYS1leHBhbmRlZD0iZmFsc2UiIHRhYmluZGV4PSItMSI+JyArDQogICAgICAgICAgICAgICc8dWwgY2xhc3M9ImRyb3Bkb3duLW1lbnUgaW5uZXIgJyArICh2ZXJzaW9uLm1ham9yID09PSAnNCcgPyBjbGFzc05hbWVzLlNIT1cgOiAnJykgKyAnIj4nICsNCiAgICAgICAgICAgICAgJzwvdWw+JyArDQogICAgICAgICAgJzwvZGl2PicgKw0KICAgICAgICAgIGRvbmVidXR0b24gKw0KICAgICAgICAgICc8L2Rpdj4nICsNCiAgICAgICAgICAnPC9kaXY+JzsNCg0KICAgICAgcmV0dXJuICQoZHJvcCk7DQogICAgfSwNCg0KICAgIHNldFBvc2l0aW9uRGF0YTogZnVuY3Rpb24gKCkgew0KICAgICAgdGhpcy5zZWxlY3RwaWNrZXIudmlldy5jYW5IaWdobGlnaHQgPSBbXTsNCg0KICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnNlbGVjdHBpY2tlci5jdXJyZW50LmRhdGEubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgdmFyIGxpID0gdGhpcy5zZWxlY3RwaWNrZXIuY3VycmVudC5kYXRhW2ldLA0KICAgICAgICAgICAgY2FuSGlnaGxpZ2h0ID0gdHJ1ZTsNCg0KICAgICAgICBpZiAobGkudHlwZSA9PT0gJ2RpdmlkZXInKSB7DQogICAgICAgICAgY2FuSGlnaGxpZ2h0ID0gZmFsc2U7DQogICAgICAgICAgbGkuaGVpZ2h0ID0gdGhpcy5zaXplSW5mby5kaXZpZGVySGVpZ2h0Ow0KICAgICAgICB9IGVsc2UgaWYgKGxpLnR5cGUgPT09ICdvcHRncm91cC1sYWJlbCcpIHsNCiAgICAgICAgICBjYW5IaWdobGlnaHQgPSBmYWxzZTsNCiAgICAgICAgICBsaS5oZWlnaHQgPSB0aGlzLnNpemVJbmZvLmRyb3Bkb3duSGVhZGVySGVpZ2h0Ow0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIGxpLmhlaWdodCA9IHRoaXMuc2l6ZUluZm8ubGlIZWlnaHQ7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAobGkuZGlzYWJsZWQpIGNhbkhpZ2hsaWdodCA9IGZhbHNlOw0KDQogICAgICAgIHRoaXMuc2VsZWN0cGlja2VyLnZpZXcuY2FuSGlnaGxpZ2h0LnB1c2goY2FuSGlnaGxpZ2h0KTsNCg0KICAgICAgICBsaS5wb3NpdGlvbiA9IChpID09PSAwID8gMCA6IHRoaXMuc2VsZWN0cGlja2VyLmN1cnJlbnQuZGF0YVtpIC0gMV0ucG9zaXRpb24pICsgbGkuaGVpZ2h0Ow0KICAgICAgfQ0KICAgIH0sDQoNCiAgICBpc1ZpcnR1YWw6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHJldHVybiAodGhpcy5vcHRpb25zLnZpcnR1YWxTY3JvbGwgIT09IGZhbHNlKSAmJiB0aGlzLnNlbGVjdHBpY2tlci5tYWluLmVsZW1lbnRzLmxlbmd0aCA+PSB0aGlzLm9wdGlvbnMudmlydHVhbFNjcm9sbCB8fCB0aGlzLm9wdGlvbnMudmlydHVhbFNjcm9sbCA9PT0gdHJ1ZTsNCiAgICB9LA0KDQogICAgY3JlYXRlVmlldzogZnVuY3Rpb24gKGlzU2VhcmNoaW5nLCBzY3JvbGxUb3ApIHsNCiAgICAgIHNjcm9sbFRvcCA9IHNjcm9sbFRvcCB8fCAwOw0KDQogICAgICB2YXIgdGhhdCA9IHRoaXM7DQoNCiAgICAgIHRoaXMuc2VsZWN0cGlja2VyLmN1cnJlbnQgPSBpc1NlYXJjaGluZyA/IHRoaXMuc2VsZWN0cGlja2VyLnNlYXJjaCA6IHRoaXMuc2VsZWN0cGlja2VyLm1haW47DQoNCiAgICAgIHZhciAkbGlzOw0KICAgICAgdmFyIGFjdGl2ZSA9IFtdOw0KICAgICAgdmFyIHNlbGVjdGVkOw0KICAgICAgdmFyIHByZXZBY3RpdmU7DQogICAgICB2YXIgYWN0aXZlSW5kZXg7DQogICAgICB2YXIgcHJldkFjdGl2ZUluZGV4Ow0KDQogICAgICB0aGlzLnNldFBvc2l0aW9uRGF0YSgpOw0KDQogICAgICBzY3JvbGwoc2Nyb2xsVG9wLCB0cnVlKTsNCg0KICAgICAgdGhpcy4kbWVudUlubmVyLm9mZignc2Nyb2xsLmNyZWF0ZVZpZXcnKS5vbignc2Nyb2xsLmNyZWF0ZVZpZXcnLCBmdW5jdGlvbiAoZSwgdXBkYXRlVmFsdWUpIHsNCiAgICAgICAgaWYgKCF0aGF0Lm5vU2Nyb2xsKSBzY3JvbGwodGhpcy5zY3JvbGxUb3AsIHVwZGF0ZVZhbHVlKTsNCiAgICAgICAgdGhhdC5ub1Njcm9sbCA9IGZhbHNlOw0KICAgICAgfSk7DQoNCiAgICAgIGZ1bmN0aW9uIHNjcm9sbChzY3JvbGxUb3AsIGluaXQpIHsNCiAgICAgICAgdmFyIHNpemUgPSB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50LmVsZW1lbnRzLmxlbmd0aCwNCiAgICAgICAgICAgIGNodW5rcyA9IFtdLA0KICAgICAgICAgICAgY2h1bmtTaXplLA0KICAgICAgICAgICAgY2h1bmtDb3VudCwNCiAgICAgICAgICAgIGZpcnN0Q2h1bmssDQogICAgICAgICAgICBsYXN0Q2h1bmssDQogICAgICAgICAgICBjdXJyZW50Q2h1bmsgPSB1bmRlZmluZWQsDQogICAgICAgICAgICBwcmV2UG9zaXRpb25zLA0KICAgICAgICAgICAgcG9zaXRpb25Jc0RpZmZlcmVudCwNCiAgICAgICAgICAgIHByZXZpb3VzRWxlbWVudHMsDQogICAgICAgICAgICBtZW51SXNEaWZmZXJlbnQgPSB0cnVlLA0KICAgICAgICAgICAgaXNWaXJ0dWFsID0gdGhhdC5pc1ZpcnR1YWwoKTsNCg0KICAgICAgICB0aGF0LnNlbGVjdHBpY2tlci52aWV3LnNjcm9sbFRvcCA9IHNjcm9sbFRvcDsNCg0KICAgICAgICBpZiAoaXNWaXJ0dWFsID09PSB0cnVlKSB7DQogICAgICAgICAgLy8gaWYgYW4gb3B0aW9uIHRoYXQgaXMgZW5jb3VudGVyZWQgdGhhdCBpcyB3aWRlciB0aGFuIHRoZSBjdXJyZW50IG1lbnUgd2lkdGgsIHVwZGF0ZSB0aGUgbWVudSB3aWR0aCBhY2NvcmRpbmdseQ0KICAgICAgICAgIGlmICh0aGF0LnNpemVJbmZvLmhhc1Njcm9sbEJhciAmJiB0aGF0LiRtZW51WzBdLm9mZnNldFdpZHRoID4gdGhhdC5zaXplSW5mby50b3RhbE1lbnVXaWR0aCkgew0KICAgICAgICAgICAgdGhhdC5zaXplSW5mby5tZW51V2lkdGggPSB0aGF0LiRtZW51WzBdLm9mZnNldFdpZHRoOw0KICAgICAgICAgICAgdGhhdC5zaXplSW5mby50b3RhbE1lbnVXaWR0aCA9IHRoYXQuc2l6ZUluZm8ubWVudVdpZHRoICsgdGhhdC5zaXplSW5mby5zY3JvbGxCYXJXaWR0aDsNCiAgICAgICAgICAgIHRoYXQuJG1lbnUuY3NzKCdtaW4td2lkdGgnLCB0aGF0LnNpemVJbmZvLm1lbnVXaWR0aCk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgY2h1bmtTaXplID0gTWF0aC5jZWlsKHRoYXQuc2l6ZUluZm8ubWVudUlubmVySGVpZ2h0IC8gdGhhdC5zaXplSW5mby5saUhlaWdodCAqIDEuNSk7IC8vIG51bWJlciBvZiBvcHRpb25zIGluIGEgY2h1bmsNCiAgICAgICAgY2h1bmtDb3VudCA9IE1hdGgucm91bmQoc2l6ZSAvIGNodW5rU2l6ZSkgfHwgMTsgLy8gbnVtYmVyIG9mIGNodW5rcw0KDQogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2h1bmtDb3VudDsgaSsrKSB7DQogICAgICAgICAgdmFyIGVuZF9vZl9jaHVuayA9IChpICsgMSkgKiBjaHVua1NpemU7DQoNCiAgICAgICAgICBpZiAoaSA9PT0gY2h1bmtDb3VudCAtIDEpIHsNCiAgICAgICAgICAgIGVuZF9vZl9jaHVuayA9IHNpemU7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgY2h1bmtzW2ldID0gWw0KICAgICAgICAgICAgKGkpICogY2h1bmtTaXplICsgKCFpID8gMCA6IDEpLA0KICAgICAgICAgICAgZW5kX29mX2NodW5rDQogICAgICAgICAgXTsNCg0KICAgICAgICAgIGlmICghc2l6ZSkgYnJlYWs7DQoNCiAgICAgICAgICBpZiAoY3VycmVudENodW5rID09PSB1bmRlZmluZWQgJiYgc2Nyb2xsVG9wIDw9IHRoYXQuc2VsZWN0cGlja2VyLmN1cnJlbnQuZGF0YVtlbmRfb2ZfY2h1bmsgLSAxXS5wb3NpdGlvbiAtIHRoYXQuc2l6ZUluZm8ubWVudUlubmVySGVpZ2h0KSB7DQogICAgICAgICAgICBjdXJyZW50Q2h1bmsgPSBpOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChjdXJyZW50Q2h1bmsgPT09IHVuZGVmaW5lZCkgY3VycmVudENodW5rID0gMDsNCg0KICAgICAgICBwcmV2UG9zaXRpb25zID0gW3RoYXQuc2VsZWN0cGlja2VyLnZpZXcucG9zaXRpb24wLCB0aGF0LnNlbGVjdHBpY2tlci52aWV3LnBvc2l0aW9uMV07DQoNCiAgICAgICAgLy8gYWx3YXlzIGRpc3BsYXkgcHJldmlvdXMsIGN1cnJlbnQsIGFuZCBuZXh0IGNodW5rcw0KICAgICAgICBmaXJzdENodW5rID0gTWF0aC5tYXgoMCwgY3VycmVudENodW5rIC0gMSk7DQogICAgICAgIGxhc3RDaHVuayA9IE1hdGgubWluKGNodW5rQ291bnQgLSAxLCBjdXJyZW50Q2h1bmsgKyAxKTsNCg0KICAgICAgICB0aGF0LnNlbGVjdHBpY2tlci52aWV3LnBvc2l0aW9uMCA9IE1hdGgubWF4KDAsIGNodW5rc1tmaXJzdENodW5rXVswXSkgfHwgMDsNCiAgICAgICAgdGhhdC5zZWxlY3RwaWNrZXIudmlldy5wb3NpdGlvbjEgPSBNYXRoLm1pbihzaXplLCBjaHVua3NbbGFzdENodW5rXVsxXSkgfHwgMDsNCg0KICAgICAgICBwb3NpdGlvbklzRGlmZmVyZW50ID0gcHJldlBvc2l0aW9uc1swXSAhPT0gdGhhdC5zZWxlY3RwaWNrZXIudmlldy5wb3NpdGlvbjAgfHwgcHJldlBvc2l0aW9uc1sxXSAhPT0gdGhhdC5zZWxlY3RwaWNrZXIudmlldy5wb3NpdGlvbjE7DQoNCiAgICAgICAgaWYgKHRoYXQuYWN0aXZlSW5kZXggIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgIHByZXZBY3RpdmUgPSB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50LmVsZW1lbnRzW3RoYXQuc2VsZWN0cGlja2VyLmN1cnJlbnQubWFwLm5ld0luZGV4W3RoYXQucHJldkFjdGl2ZUluZGV4XV07DQogICAgICAgICAgYWN0aXZlID0gdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5lbGVtZW50c1t0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50Lm1hcC5uZXdJbmRleFt0aGF0LmFjdGl2ZUluZGV4XV07DQogICAgICAgICAgc2VsZWN0ZWQgPSB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50LmVsZW1lbnRzW3RoYXQuc2VsZWN0cGlja2VyLmN1cnJlbnQubWFwLm5ld0luZGV4W3RoYXQuc2VsZWN0ZWRJbmRleF1dOw0KDQogICAgICAgICAgaWYgKGluaXQpIHsNCiAgICAgICAgICAgIGlmICh0aGF0LmFjdGl2ZUluZGV4ICE9PSB0aGF0LnNlbGVjdGVkSW5kZXgpIHsNCiAgICAgICAgICAgICAgYWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOw0KICAgICAgICAgICAgICBpZiAoYWN0aXZlLmZpcnN0Q2hpbGQpIGFjdGl2ZS5maXJzdENoaWxkLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhhdC5hY3RpdmVJbmRleCA9IHVuZGVmaW5lZDsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICBpZiAodGhhdC5hY3RpdmVJbmRleCAmJiB0aGF0LmFjdGl2ZUluZGV4ICE9PSB0aGF0LnNlbGVjdGVkSW5kZXggJiYgc2VsZWN0ZWQgJiYgc2VsZWN0ZWQubGVuZ3RoKSB7DQogICAgICAgICAgICBzZWxlY3RlZC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsNCiAgICAgICAgICAgIGlmIChzZWxlY3RlZC5maXJzdENoaWxkKSBzZWxlY3RlZC5maXJzdENoaWxkLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmICh0aGF0LnByZXZBY3RpdmVJbmRleCAhPT0gdW5kZWZpbmVkICYmIHRoYXQucHJldkFjdGl2ZUluZGV4ICE9PSB0aGF0LmFjdGl2ZUluZGV4ICYmIHRoYXQucHJldkFjdGl2ZUluZGV4ICE9PSB0aGF0LnNlbGVjdGVkSW5kZXggJiYgcHJldkFjdGl2ZSAmJiBwcmV2QWN0aXZlLmxlbmd0aCkgew0KICAgICAgICAgIHByZXZBY3RpdmUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7DQogICAgICAgICAgaWYgKHByZXZBY3RpdmUuZmlyc3RDaGlsZCkgcHJldkFjdGl2ZS5maXJzdENoaWxkLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGluaXQgfHwgcG9zaXRpb25Jc0RpZmZlcmVudCkgew0KICAgICAgICAgIHByZXZpb3VzRWxlbWVudHMgPSB0aGF0LnNlbGVjdHBpY2tlci52aWV3LnZpc2libGVFbGVtZW50cyA/IHRoYXQuc2VsZWN0cGlja2VyLnZpZXcudmlzaWJsZUVsZW1lbnRzLnNsaWNlKCkgOiBbXTsNCg0KICAgICAgICAgIHRoYXQuc2VsZWN0cGlja2VyLnZpZXcudmlzaWJsZUVsZW1lbnRzID0gdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5lbGVtZW50cy5zbGljZSh0aGF0LnNlbGVjdHBpY2tlci52aWV3LnBvc2l0aW9uMCwgdGhhdC5zZWxlY3RwaWNrZXIudmlldy5wb3NpdGlvbjEpOw0KDQogICAgICAgICAgdGhhdC5zZXRPcHRpb25TdGF0dXMoKTsNCg0KICAgICAgICAgIC8vIGlmIHNlYXJjaGluZywgY2hlY2sgdG8gbWFrZSBzdXJlIHRoZSBsaXN0IGhhcyBhY3R1YWxseSBiZWVuIHVwZGF0ZWQgYmVmb3JlIHVwZGF0aW5nIERPTQ0KICAgICAgICAgIC8vIHRoaXMgcHJldmVudHMgdW5uZWNlc3NhcnkgcmVwYWludHMNCiAgICAgICAgICBpZiAoIGlzU2VhcmNoaW5nIHx8IChpc1ZpcnR1YWwgPT09IGZhbHNlICYmIGluaXQpICkgbWVudUlzRGlmZmVyZW50ID0gIWlzRXF1YWwocHJldmlvdXNFbGVtZW50cywgdGhhdC5zZWxlY3RwaWNrZXIudmlldy52aXNpYmxlRWxlbWVudHMpOw0KDQogICAgICAgICAgLy8gaWYgdmlydHVhbCBzY3JvbGwgaXMgZGlzYWJsZWQgYW5kIG5vdCBzZWFyY2hpbmcsDQogICAgICAgICAgLy8gbWVudSBzaG91bGQgbmV2ZXIgbmVlZCB0byBiZSB1cGRhdGVkIG1vcmUgdGhhbiBvbmNlDQogICAgICAgICAgaWYgKCAoaW5pdCB8fCBpc1ZpcnR1YWwgPT09IHRydWUpICYmIG1lbnVJc0RpZmZlcmVudCApIHsNCiAgICAgICAgICAgIHZhciBtZW51SW5uZXIgPSB0aGF0LiRtZW51SW5uZXJbMF0sDQogICAgICAgICAgICAgICAgbWVudUZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLA0KICAgICAgICAgICAgICAgIGVtcHR5TWVudSA9IG1lbnVJbm5lci5maXJzdENoaWxkLmNsb25lTm9kZShmYWxzZSksDQogICAgICAgICAgICAgICAgbWFyZ2luVG9wLA0KICAgICAgICAgICAgICAgIG1hcmdpbkJvdHRvbSwNCiAgICAgICAgICAgICAgICBlbGVtZW50cyA9IGlzVmlydHVhbCA9PT0gdHJ1ZSA/IHRoYXQuc2VsZWN0cGlja2VyLnZpZXcudmlzaWJsZUVsZW1lbnRzIDogdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5lbGVtZW50czsNCg0KICAgICAgICAgICAgLy8gcmVwbGFjZSB0aGUgZXhpc3RpbmcgVUwgd2l0aCBhbiBlbXB0eSBvbmUgLSB0aGlzIGlzIGZhc3RlciB0aGFuICQuZW1wdHkoKQ0KICAgICAgICAgICAgbWVudUlubmVyLnJlcGxhY2VDaGlsZChlbXB0eU1lbnUsIG1lbnVJbm5lci5maXJzdENoaWxkKTsNCg0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIHZpc2libGVFbGVtZW50c0xlbiA9IGVsZW1lbnRzLmxlbmd0aDsgaSA8IHZpc2libGVFbGVtZW50c0xlbjsgaSsrKSB7DQogICAgICAgICAgICAgIG1lbnVGcmFnbWVudC5hcHBlbmRDaGlsZChlbGVtZW50c1tpXSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChpc1ZpcnR1YWwgPT09IHRydWUpIHsNCiAgICAgICAgICAgICAgbWFyZ2luVG9wID0gKHRoYXQuc2VsZWN0cGlja2VyLnZpZXcucG9zaXRpb24wID09PSAwID8gMCA6IHRoYXQuc2VsZWN0cGlja2VyLmN1cnJlbnQuZGF0YVt0aGF0LnNlbGVjdHBpY2tlci52aWV3LnBvc2l0aW9uMCAtIDFdLnBvc2l0aW9uKSwNCiAgICAgICAgICAgICAgbWFyZ2luQm90dG9tID0gKHRoYXQuc2VsZWN0cGlja2VyLnZpZXcucG9zaXRpb24xID4gc2l6ZSAtIDEgPyAwIDogdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5kYXRhW3NpemUgLSAxXS5wb3NpdGlvbiAtIHRoYXQuc2VsZWN0cGlja2VyLmN1cnJlbnQuZGF0YVt0aGF0LnNlbGVjdHBpY2tlci52aWV3LnBvc2l0aW9uMSAtIDFdLnBvc2l0aW9uKTsNCg0KICAgICAgICAgICAgICBtZW51SW5uZXIuZmlyc3RDaGlsZC5zdHlsZS5tYXJnaW5Ub3AgPSBtYXJnaW5Ub3AgKyAncHgnOw0KICAgICAgICAgICAgICBtZW51SW5uZXIuZmlyc3RDaGlsZC5zdHlsZS5tYXJnaW5Cb3R0b20gPSBtYXJnaW5Cb3R0b20gKyAncHgnOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBtZW51SW5uZXIuZmlyc3RDaGlsZC5hcHBlbmRDaGlsZChtZW51RnJhZ21lbnQpOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHRoYXQucHJldkFjdGl2ZUluZGV4ID0gdGhhdC5hY3RpdmVJbmRleDsNCg0KICAgICAgICBpZiAoIXRoYXQub3B0aW9ucy5saXZlU2VhcmNoKSB7DQogICAgICAgICAgdGhhdC4kbWVudUlubmVyLmZvY3VzKCk7DQogICAgICAgIH0gZWxzZSBpZiAoaXNTZWFyY2hpbmcgJiYgaW5pdCkgew0KICAgICAgICAgIHZhciBpbmRleCA9IDAsDQogICAgICAgICAgICAgIG5ld0FjdGl2ZTsNCg0KICAgICAgICAgIGlmICghdGhhdC5zZWxlY3RwaWNrZXIudmlldy5jYW5IaWdobGlnaHRbaW5kZXhdKSB7DQogICAgICAgICAgICBpbmRleCA9IDEgKyB0aGF0LnNlbGVjdHBpY2tlci52aWV3LmNhbkhpZ2hsaWdodC5zbGljZSgxKS5pbmRleE9mKHRydWUpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIG5ld0FjdGl2ZSA9IHRoYXQuc2VsZWN0cGlja2VyLnZpZXcudmlzaWJsZUVsZW1lbnRzW2luZGV4XTsNCg0KICAgICAgICAgIGlmICh0aGF0LnNlbGVjdHBpY2tlci52aWV3LmN1cnJlbnRBY3RpdmUpIHsNCiAgICAgICAgICAgIHRoYXQuc2VsZWN0cGlja2VyLnZpZXcuY3VycmVudEFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsNCiAgICAgICAgICAgIGlmICh0aGF0LnNlbGVjdHBpY2tlci52aWV3LmN1cnJlbnRBY3RpdmUuZmlyc3RDaGlsZCkgdGhhdC5zZWxlY3RwaWNrZXIudmlldy5jdXJyZW50QWN0aXZlLmZpcnN0Q2hpbGQuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgaWYgKG5ld0FjdGl2ZSkgew0KICAgICAgICAgICAgbmV3QWN0aXZlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOw0KICAgICAgICAgICAgaWYgKG5ld0FjdGl2ZS5maXJzdENoaWxkKSBuZXdBY3RpdmUuZmlyc3RDaGlsZC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICB0aGF0LmFjdGl2ZUluZGV4ID0gdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5tYXAub3JpZ2luYWxJbmRleFtpbmRleF07DQogICAgICAgIH0NCiAgICAgIH0NCg0KICAgICAgJCh3aW5kb3cpLm9mZigncmVzaXplLmNyZWF0ZVZpZXcnKS5vbigncmVzaXplLmNyZWF0ZVZpZXcnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgIHNjcm9sbCh0aGF0LiRtZW51SW5uZXJbMF0uc2Nyb2xsVG9wKTsNCiAgICAgIH0pOw0KICAgIH0sDQoNCiAgICBjcmVhdGVMaTogZnVuY3Rpb24gKCkgew0KICAgICAgdmFyIHRoYXQgPSB0aGlzLA0KICAgICAgICAgIG1haW5FbGVtZW50cyA9IFtdLA0KICAgICAgICAgIHdpZGVzdE9wdGlvbiwNCiAgICAgICAgICBhdmFpbGFibGVPcHRpb25zQ291bnQgPSAwLA0KICAgICAgICAgIHdpZGVzdE9wdGlvbkxlbmd0aCA9IDAsDQogICAgICAgICAgbWFpbkRhdGEgPSBbXSwNCiAgICAgICAgICBvcHRJRCA9IDAsDQogICAgICAgICAgaGVhZGVySW5kZXggPSAwLA0KICAgICAgICAgIGxpSW5kZXggPSAtMTsgLy8gaW5jcmVtZW50IGxpSW5kZXggd2hlbmV2ZXIgYSBuZXcgPGxpPiBlbGVtZW50IGlzIGNyZWF0ZWQgdG8gZW5zdXJlIG5ld0luZGV4IGlzIGNvcnJlY3QNCg0KICAgICAgaWYgKCF0aGlzLnNlbGVjdHBpY2tlci52aWV3LnRpdGxlT3B0aW9uKSB0aGlzLnNlbGVjdHBpY2tlci52aWV3LnRpdGxlT3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7DQoNCiAgICAgIHZhciBlbGVtZW50VGVtcGxhdGVzID0gew0KICAgICAgICAgIHNwYW46IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKSwNCiAgICAgICAgICBzdWJ0ZXh0OiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzbWFsbCcpLA0KICAgICAgICAgIGE6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKSwNCiAgICAgICAgICBsaTogZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKSwNCiAgICAgICAgICB3aGl0ZXNwYWNlOiBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgiXHUwMEEwIikNCiAgICAgICAgfSwNCiAgICAgICAgY2hlY2tNYXJrID0gZWxlbWVudFRlbXBsYXRlcy5zcGFuLmNsb25lTm9kZShmYWxzZSksDQogICAgICAgIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpOw0KDQogICAgICBjaGVja01hcmsuY2xhc3NOYW1lID0gdGhhdC5vcHRpb25zLmljb25CYXNlICsgJyAnICsgdGhhdC5vcHRpb25zLnRpY2tJY29uICsgJyBjaGVjay1tYXJrJzsNCiAgICAgIGVsZW1lbnRUZW1wbGF0ZXMuYS5hcHBlbmRDaGlsZChjaGVja01hcmspOw0KICAgICAgZWxlbWVudFRlbXBsYXRlcy5hLnNldEF0dHJpYnV0ZSgncm9sZScsICdvcHRpb24nKTsNCg0KICAgICAgZWxlbWVudFRlbXBsYXRlcy5zdWJ0ZXh0LmNsYXNzTmFtZSA9ICd0ZXh0LW11dGVkJzsNCg0KICAgICAgZWxlbWVudFRlbXBsYXRlcy50ZXh0ID0gZWxlbWVudFRlbXBsYXRlcy5zcGFuLmNsb25lTm9kZShmYWxzZSk7DQogICAgICBlbGVtZW50VGVtcGxhdGVzLnRleHQuY2xhc3NOYW1lID0gJ3RleHQnOw0KDQogICAgICAvLyBIZWxwZXIgZnVuY3Rpb25zDQogICAgICAvKioNCiAgICAgICAqIEBwYXJhbSBjb250ZW50DQogICAgICAgKiBAcGFyYW0gW2luZGV4XQ0KICAgICAgICogQHBhcmFtIFtjbGFzc2VzXQ0KICAgICAgICogQHBhcmFtIFtvcHRncm91cF0NCiAgICAgICAqIEByZXR1cm5zIHtIVE1MRWxlbWVudH0NCiAgICAgICAqLw0KICAgICAgdmFyIGdlbmVyYXRlTEkgPSBmdW5jdGlvbiAoY29udGVudCwgaW5kZXgsIGNsYXNzZXMsIG9wdGdyb3VwKSB7DQogICAgICAgIHZhciBsaSA9IGVsZW1lbnRUZW1wbGF0ZXMubGkuY2xvbmVOb2RlKGZhbHNlKTsNCg0KICAgICAgICBpZiAoY29udGVudCkgew0KICAgICAgICAgIGlmIChjb250ZW50Lm5vZGVUeXBlID09PSAxIHx8IGNvbnRlbnQubm9kZVR5cGUgPT09IDExKSB7DQogICAgICAgICAgICBsaS5hcHBlbmRDaGlsZChjb250ZW50KTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgbGkuaW5uZXJIVE1MID0gY29udGVudDsNCiAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBpZiAodHlwZW9mIGNsYXNzZXMgIT09ICd1bmRlZmluZWQnICYmICcnICE9PSBjbGFzc2VzKSBsaS5jbGFzc05hbWUgPSBjbGFzc2VzOw0KICAgICAgICBpZiAodHlwZW9mIG9wdGdyb3VwICE9PSAndW5kZWZpbmVkJyAmJiBudWxsICE9PSBvcHRncm91cCkgbGkuY2xhc3NMaXN0LmFkZCgnb3B0Z3JvdXAtJyArIG9wdGdyb3VwKTsNCg0KICAgICAgICByZXR1cm4gbGk7DQogICAgICB9Ow0KDQogICAgICAvKioNCiAgICAgICAqIEBwYXJhbSB0ZXh0DQogICAgICAgKiBAcGFyYW0gW2NsYXNzZXNdDQogICAgICAgKiBAcGFyYW0gW2lubGluZV0NCiAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9DQogICAgICAgKi8NCiAgICAgIHZhciBnZW5lcmF0ZUEgPSBmdW5jdGlvbiAodGV4dCwgY2xhc3NlcywgaW5saW5lKSB7DQogICAgICAgIHZhciBhID0gZWxlbWVudFRlbXBsYXRlcy5hLmNsb25lTm9kZSh0cnVlKTsNCg0KICAgICAgICBpZiAodGV4dCkgew0KICAgICAgICAgIGlmICh0ZXh0Lm5vZGVUeXBlID09PSAxMSkgew0KICAgICAgICAgICAgYS5hcHBlbmRDaGlsZCh0ZXh0KTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgYS5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsIHRleHQpOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmICh0eXBlb2YgY2xhc3NlcyAhPT0gJ3VuZGVmaW5lZCcgJiAnJyAhPT0gY2xhc3NlcykgYS5jbGFzc05hbWUgPSBjbGFzc2VzOw0KICAgICAgICBpZiAodmVyc2lvbi5tYWpvciA9PT0gJzQnKSBhLmNsYXNzTGlzdC5hZGQoJ2Ryb3Bkb3duLWl0ZW0nKTsNCiAgICAgICAgaWYgKGlubGluZSkgYS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgaW5saW5lKTsNCg0KICAgICAgICByZXR1cm4gYTsNCiAgICAgIH07DQoNCiAgICAgIHZhciBnZW5lcmF0ZVRleHQgPSBmdW5jdGlvbiAob3B0aW9ucykgew0KICAgICAgICB2YXIgdGV4dEVsZW1lbnQgPSBlbGVtZW50VGVtcGxhdGVzLnRleHQuY2xvbmVOb2RlKGZhbHNlKSwNCiAgICAgICAgICAgIG9wdGlvblN1YnRleHRFbGVtZW50LA0KICAgICAgICAgICAgb3B0aW9uSWNvbkVsZW1lbnQ7DQoNCiAgICAgICAgaWYgKG9wdGlvbnMub3B0aW9uQ29udGVudCkgew0KICAgICAgICAgIHRleHRFbGVtZW50LmlubmVySFRNTCA9IG9wdGlvbnMub3B0aW9uQ29udGVudDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0ZXh0RWxlbWVudC50ZXh0Q29udGVudCA9IG9wdGlvbnMudGV4dDsNCg0KICAgICAgICAgIGlmIChvcHRpb25zLm9wdGlvbkljb24pIHsNCiAgICAgICAgICAgIHZhciB3aGl0ZXNwYWNlID0gZWxlbWVudFRlbXBsYXRlcy53aGl0ZXNwYWNlLmNsb25lTm9kZShmYWxzZSk7DQoNCiAgICAgICAgICAgIG9wdGlvbkljb25FbGVtZW50ID0gZWxlbWVudFRlbXBsYXRlcy5zcGFuLmNsb25lTm9kZShmYWxzZSk7DQogICAgICAgICAgICBvcHRpb25JY29uRWxlbWVudC5jbGFzc05hbWUgPSB0aGF0Lm9wdGlvbnMuaWNvbkJhc2UgKyAnICcgKyBvcHRpb25zLm9wdGlvbkljb247DQoNCiAgICAgICAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKG9wdGlvbkljb25FbGVtZW50KTsNCiAgICAgICAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKHdoaXRlc3BhY2UpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIGlmIChvcHRpb25zLm9wdGlvblN1YnRleHQpIHsNCiAgICAgICAgICAgIG9wdGlvblN1YnRleHRFbGVtZW50ID0gZWxlbWVudFRlbXBsYXRlcy5zdWJ0ZXh0LmNsb25lTm9kZShmYWxzZSk7DQogICAgICAgICAgICBvcHRpb25TdWJ0ZXh0RWxlbWVudC5pbm5lckhUTUwgPSBvcHRpb25zLm9wdGlvblN1YnRleHQ7DQogICAgICAgICAgICB0ZXh0RWxlbWVudC5hcHBlbmRDaGlsZChvcHRpb25TdWJ0ZXh0RWxlbWVudCk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQodGV4dEVsZW1lbnQpOw0KDQogICAgICAgIHJldHVybiBmcmFnbWVudDsNCiAgICAgIH07DQoNCiAgICAgIHZhciBnZW5lcmF0ZUxhYmVsID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsNCiAgICAgICAgdmFyIGxhYmVsVGV4dEVsZW1lbnQgPSBlbGVtZW50VGVtcGxhdGVzLnRleHQuY2xvbmVOb2RlKGZhbHNlKSwNCiAgICAgICAgICAgIGxhYmVsU3VidGV4dEVsZW1lbnQsDQogICAgICAgICAgICBsYWJlbEljb25FbGVtZW50Ow0KDQogICAgICAgIGxhYmVsVGV4dEVsZW1lbnQudGV4dENvbnRlbnQgPSBvcHRpb25zLmxhYmVsRXNjYXBlZDsNCg0KICAgICAgICBpZiAob3B0aW9ucy5sYWJlbEljb24pIHsNCiAgICAgICAgICB2YXIgd2hpdGVzcGFjZSA9IGVsZW1lbnRUZW1wbGF0ZXMud2hpdGVzcGFjZS5jbG9uZU5vZGUoZmFsc2UpOw0KDQogICAgICAgICAgbGFiZWxJY29uRWxlbWVudCA9IGVsZW1lbnRUZW1wbGF0ZXMuc3Bhbi5jbG9uZU5vZGUoZmFsc2UpOw0KICAgICAgICAgIGxhYmVsSWNvbkVsZW1lbnQuY2xhc3NOYW1lID0gdGhhdC5vcHRpb25zLmljb25CYXNlICsgJyAnICsgb3B0aW9ucy5sYWJlbEljb247DQoNCiAgICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChsYWJlbEljb25FbGVtZW50KTsNCiAgICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZCh3aGl0ZXNwYWNlKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChvcHRpb25zLmxhYmVsU3VidGV4dCkgew0KICAgICAgICAgIGxhYmVsU3VidGV4dEVsZW1lbnQgPSBlbGVtZW50VGVtcGxhdGVzLnN1YnRleHQuY2xvbmVOb2RlKGZhbHNlKTsNCiAgICAgICAgICBsYWJlbFN1YnRleHRFbGVtZW50LnRleHRDb250ZW50ID0gb3B0aW9ucy5sYWJlbFN1YnRleHQ7DQogICAgICAgICAgbGFiZWxUZXh0RWxlbWVudC5hcHBlbmRDaGlsZChsYWJlbFN1YnRleHRFbGVtZW50KTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKGxhYmVsVGV4dEVsZW1lbnQpOw0KDQogICAgICAgIHJldHVybiBmcmFnbWVudDsNCiAgICAgIH0NCg0KICAgICAgaWYgKHRoaXMub3B0aW9ucy50aXRsZSAmJiAhdGhpcy5tdWx0aXBsZSkgew0KICAgICAgICAvLyB0aGlzIG9wdGlvbiBkb2Vzbid0IGNyZWF0ZSBhIG5ldyA8bGk+IGVsZW1lbnQsIGJ1dCBkb2VzIGFkZCBhIG5ldyBvcHRpb24sIHNvIGxpSW5kZXggaXMgZGVjcmVhc2VkDQogICAgICAgIC8vIHNpbmNlIG5ld0luZGV4IGlzIHJlY2FsY3VsYXRlZCBvbiBldmVyeSByZWZyZXNoLCBsaUluZGV4IG5lZWRzIHRvIGJlIGRlY3JlYXNlZCBldmVuIGlmIHRoZSB0aXRsZU9wdGlvbiBpcyBhbHJlYWR5IGFwcGVuZGVkDQogICAgICAgIGxpSW5kZXgtLTsNCg0KICAgICAgICB2YXIgZWxlbWVudCA9IHRoaXMuJGVsZW1lbnRbMF0sDQogICAgICAgICAgICBpc1NlbGVjdGVkID0gZmFsc2UsDQogICAgICAgICAgICB0aXRsZU5vdEFwcGVuZGVkID0gIXRoaXMuc2VsZWN0cGlja2VyLnZpZXcudGl0bGVPcHRpb24ucGFyZW50Tm9kZTsNCg0KICAgICAgICBpZiAodGl0bGVOb3RBcHBlbmRlZCkgew0KICAgICAgICAgIC8vIFVzZSBuYXRpdmUgSlMgdG8gcHJlcGVuZCBvcHRpb24gKGZhc3RlcikNCiAgICAgICAgICB0aGlzLnNlbGVjdHBpY2tlci52aWV3LnRpdGxlT3B0aW9uLmNsYXNzTmFtZSA9ICdicy10aXRsZS1vcHRpb24nOw0KICAgICAgICAgIHRoaXMuc2VsZWN0cGlja2VyLnZpZXcudGl0bGVPcHRpb24udmFsdWUgPSAnJzsNCg0KICAgICAgICAgIC8vIENoZWNrIGlmIHNlbGVjdGVkIG9yIGRhdGEtc2VsZWN0ZWQgYXR0cmlidXRlIGlzIGFscmVhZHkgc2V0IG9uIGFuIG9wdGlvbi4gSWYgbm90LCBzZWxlY3QgdGhlIHRpdGxlT3B0aW9uIG9wdGlvbi4NCiAgICAgICAgICAvLyB0aGUgc2VsZWN0ZWQgaXRlbSBtYXkgaGF2ZSBiZWVuIGNoYW5nZWQgYnkgdXNlciBvciBwcm9ncmFtbWF0aWNhbGx5IGJlZm9yZSB0aGUgYm9vdHN0cmFwIHNlbGVjdCBwbHVnaW4gcnVucywNCiAgICAgICAgICAvLyBpZiBzbywgdGhlIHNlbGVjdCB3aWxsIGhhdmUgdGhlIGRhdGEtc2VsZWN0ZWQgYXR0cmlidXRlDQogICAgICAgICAgdmFyICRvcHQgPSAkKGVsZW1lbnQub3B0aW9uc1tlbGVtZW50LnNlbGVjdGVkSW5kZXhdKTsNCiAgICAgICAgICBpc1NlbGVjdGVkID0gJG9wdC5hdHRyKCdzZWxlY3RlZCcpID09PSB1bmRlZmluZWQgJiYgdGhpcy4kZWxlbWVudC5kYXRhKCdzZWxlY3RlZCcpID09PSB1bmRlZmluZWQ7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAodGl0bGVOb3RBcHBlbmRlZCB8fCB0aGlzLnNlbGVjdHBpY2tlci52aWV3LnRpdGxlT3B0aW9uLmluZGV4ICE9PSAwKSB7DQogICAgICAgICAgZWxlbWVudC5pbnNlcnRCZWZvcmUodGhpcy5zZWxlY3RwaWNrZXIudmlldy50aXRsZU9wdGlvbiwgZWxlbWVudC5maXJzdENoaWxkKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIFNldCBzZWxlY3RlZCAqYWZ0ZXIqIGFwcGVuZGluZyB0byBzZWxlY3QsDQogICAgICAgIC8vIG90aGVyd2lzZSB0aGUgb3B0aW9uIGRvZXNuJ3QgZ2V0IHNlbGVjdGVkIGluIElFDQogICAgICAgIC8vIHNldCB1c2luZyBzZWxlY3RlZEluZGV4LCBhcyBzZXR0aW5nIHRoZSBzZWxlY3RlZCBhdHRyIHRvIHRydWUgaGVyZSBkb2Vzbid0IHdvcmsgaW4gSUUxMQ0KICAgICAgICBpZiAoaXNTZWxlY3RlZCkgZWxlbWVudC5zZWxlY3RlZEluZGV4ID0gMDsNCiAgICAgIH0NCg0KICAgICAgdmFyICRzZWxlY3RPcHRpb25zID0gdGhpcy4kZWxlbWVudC5maW5kKCdvcHRpb24nKTsNCg0KICAgICAgJHNlbGVjdE9wdGlvbnMuZWFjaChmdW5jdGlvbiAoaW5kZXgpIHsNCiAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKTsNCg0KICAgICAgICBsaUluZGV4Kys7DQoNCiAgICAgICAgaWYgKCR0aGlzLmhhc0NsYXNzKCdicy10aXRsZS1vcHRpb24nKSkgcmV0dXJuOw0KDQogICAgICAgIHZhciB0aGlzRGF0YSA9ICR0aGlzLmRhdGEoKTsNCg0KICAgICAgICAvLyBHZXQgdGhlIGNsYXNzIGFuZCB0ZXh0IGZvciB0aGUgb3B0aW9uDQogICAgICAgIHZhciBvcHRpb25DbGFzcyA9IHRoaXMuY2xhc3NOYW1lIHx8ICcnLA0KICAgICAgICAgICAgaW5saW5lID0gaHRtbEVzY2FwZSh0aGlzLnN0eWxlLmNzc1RleHQpLA0KICAgICAgICAgICAgb3B0aW9uQ29udGVudCA9IHRoaXNEYXRhLmNvbnRlbnQsDQogICAgICAgICAgICB0ZXh0ID0gdGhpcy50ZXh0Q29udGVudCwNCiAgICAgICAgICAgIHRva2VucyA9IHRoaXNEYXRhLnRva2VucywNCiAgICAgICAgICAgIHN1YnRleHQgPSB0aGlzRGF0YS5zdWJ0ZXh0LA0KICAgICAgICAgICAgaWNvbiA9IHRoaXNEYXRhLmljb24sDQogICAgICAgICAgICAkcGFyZW50ID0gJHRoaXMucGFyZW50KCksDQogICAgICAgICAgICBwYXJlbnQgPSAkcGFyZW50WzBdLA0KICAgICAgICAgICAgaXNPcHRncm91cCA9IHBhcmVudC50YWdOYW1lID09PSAnT1BUR1JPVVAnLA0KICAgICAgICAgICAgaXNPcHRncm91cERpc2FibGVkID0gaXNPcHRncm91cCAmJiBwYXJlbnQuZGlzYWJsZWQsDQogICAgICAgICAgICBpc0Rpc2FibGVkID0gdGhpcy5kaXNhYmxlZCB8fCBpc09wdGdyb3VwRGlzYWJsZWQsDQogICAgICAgICAgICBwcmV2SGlkZGVuSW5kZXgsDQogICAgICAgICAgICBzaG93RGl2aWRlciA9IHRoaXMucHJldmlvdXNFbGVtZW50U2libGluZyAmJiB0aGlzLnByZXZpb3VzRWxlbWVudFNpYmxpbmcudGFnTmFtZSA9PT0gJ09QVEdST1VQJywNCiAgICAgICAgICAgIHRleHRFbGVtZW50Ow0KDQogICAgICAgIHZhciBwYXJlbnREYXRhID0gJHBhcmVudC5kYXRhKCk7DQoNCiAgICAgICAgaWYgKHRoaXNEYXRhLmhpZGRlbiA9PT0gdHJ1ZSB8fCB0aGF0Lm9wdGlvbnMuaGlkZURpc2FibGVkICYmIChpc0Rpc2FibGVkICYmICFpc09wdGdyb3VwIHx8IGlzT3B0Z3JvdXBEaXNhYmxlZCkpIHsNCiAgICAgICAgICAvLyBzZXQgcHJldkhpZGRlbkluZGV4IC0gdGhlIGluZGV4IG9mIHRoZSBmaXJzdCBoaWRkZW4gb3B0aW9uIGluIGEgZ3JvdXAgb2YgaGlkZGVuIG9wdGlvbnMNCiAgICAgICAgICAvLyB1c2VkIHRvIGRldGVybWluZSB3aGV0aGVyIG9yIG5vdCBhIGRpdmlkZXIgc2hvdWxkIGJlIHBsYWNlZCBhZnRlciBhbiBvcHRncm91cCBpZiB0aGVyZSBhcmUNCiAgICAgICAgICAvLyBoaWRkZW4gb3B0aW9ucyBiZXR3ZWVuIHRoZSBvcHRncm91cCBhbmQgdGhlIGZpcnN0IHZpc2libGUgb3B0aW9uDQogICAgICAgICAgcHJldkhpZGRlbkluZGV4ID0gdGhpc0RhdGEucHJldkhpZGRlbkluZGV4Ow0KICAgICAgICAgICR0aGlzLm5leHQoKS5kYXRhKCdwcmV2SGlkZGVuSW5kZXgnLCAocHJldkhpZGRlbkluZGV4ICE9PSB1bmRlZmluZWQgPyBwcmV2SGlkZGVuSW5kZXggOiBpbmRleCkpOw0KDQogICAgICAgICAgbGlJbmRleC0tOw0KDQogICAgICAgICAgLy8gaWYgcHJldmlvdXMgZWxlbWVudCBpcyBub3QgYW4gb3B0Z3JvdXANCiAgICAgICAgICBpZiAoIXNob3dEaXZpZGVyKSB7DQogICAgICAgICAgICBpZiAocHJldkhpZGRlbkluZGV4ICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgLy8gc2VsZWN0IHRoZSBlbGVtZW50ICoqYmVmb3JlKiogdGhlIGZpcnN0IGhpZGRlbiBlbGVtZW50IGluIHRoZSBncm91cA0KICAgICAgICAgICAgICB2YXIgcHJldkhpZGRlbiA9ICRzZWxlY3RPcHRpb25zW3ByZXZIaWRkZW5JbmRleF0ucHJldmlvdXNFbGVtZW50U2libGluZzsNCiAgICAgICAgICAgICAgDQogICAgICAgICAgICAgIGlmIChwcmV2SGlkZGVuICYmIHByZXZIaWRkZW4udGFnTmFtZSA9PT0gJ09QVEdST1VQJyAmJiAhcHJldkhpZGRlbi5kaXNhYmxlZCkgew0KICAgICAgICAgICAgICAgIHNob3dEaXZpZGVyID0gdHJ1ZTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KICAgICAgICAgIGlmIChzaG93RGl2aWRlciAmJiBtYWluRGF0YVttYWluRGF0YS5sZW5ndGggLSAxXS50eXBlICE9PSAnZGl2aWRlcicpIHsNCiAgICAgICAgICAgIGxpSW5kZXgrKzsNCiAgICAgICAgICAgIG1haW5FbGVtZW50cy5wdXNoKA0KICAgICAgICAgICAgICBnZW5lcmF0ZUxJKA0KICAgICAgICAgICAgICAgIGZhbHNlLA0KICAgICAgICAgICAgICAgIG51bGwsDQogICAgICAgICAgICAgICAgY2xhc3NOYW1lcy5ESVZJREVSLA0KICAgICAgICAgICAgICAgIG9wdElEICsgJ2RpdicNCiAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgKTsNCiAgICAgICAgICAgIG1haW5EYXRhLnB1c2goew0KICAgICAgICAgICAgICB0eXBlOiAnZGl2aWRlcicsDQogICAgICAgICAgICAgIG9wdElEOiBvcHRJRCwNCiAgICAgICAgICAgICAgb3JpZ2luYWxJbmRleDogaW5kZXgNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChpc09wdGdyb3VwICYmIHRoaXNEYXRhLmRpdmlkZXIgIT09IHRydWUpIHsNCiAgICAgICAgICBpZiAodGhhdC5vcHRpb25zLmhpZGVEaXNhYmxlZCAmJiBpc0Rpc2FibGVkKSB7DQogICAgICAgICAgICBpZiAocGFyZW50RGF0YS5hbGxPcHRpb25zRGlzYWJsZWQgPT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICB2YXIgJG9wdGlvbnMgPSAkcGFyZW50LmNoaWxkcmVuKCk7DQogICAgICAgICAgICAgICRwYXJlbnQuZGF0YSgnYWxsT3B0aW9uc0Rpc2FibGVkJywgJG9wdGlvbnMuZmlsdGVyKCc6ZGlzYWJsZWQnKS5sZW5ndGggPT09ICRvcHRpb25zLmxlbmd0aCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICgkcGFyZW50LmRhdGEoJ2FsbE9wdGlvbnNEaXNhYmxlZCcpKSB7DQogICAgICAgICAgICAgIGxpSW5kZXgtLTsNCiAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KICAgICAgICAgIHZhciBvcHRHcm91cENsYXNzID0gJyAnICsgcGFyZW50LmNsYXNzTmFtZSB8fCAnJzsNCg0KICAgICAgICAgIGlmICghdGhpcy5wcmV2aW91c0VsZW1lbnRTaWJsaW5nKSB7IC8vIElzIGl0IHRoZSBmaXJzdCBvcHRpb24gb2YgdGhlIG9wdGdyb3VwPw0KICAgICAgICAgICAgb3B0SUQgKz0gMTsNCg0KICAgICAgICAgICAgLy8gR2V0IHRoZSBvcHQgZ3JvdXAgbGFiZWwNCiAgICAgICAgICAgIHZhciBsYWJlbCA9IHBhcmVudC5sYWJlbCwNCiAgICAgICAgICAgICAgICBsYWJlbEVzY2FwZWQgPSBodG1sRXNjYXBlKGxhYmVsKSwNCiAgICAgICAgICAgICAgICBsYWJlbFN1YnRleHQgPSBwYXJlbnREYXRhLnN1YnRleHQsDQogICAgICAgICAgICAgICAgbGFiZWxJY29uID0gcGFyZW50RGF0YS5pY29uOw0KDQogICAgICAgICAgICBpZiAoaW5kZXggIT09IDAgJiYgbWFpbkVsZW1lbnRzLmxlbmd0aCA+IDApIHsgLy8gSXMgaXQgTk9UIHRoZSBmaXJzdCBvcHRpb24gb2YgdGhlIHNlbGVjdCAmJiBhcmUgdGhlcmUgZWxlbWVudHMgaW4gdGhlIGRyb3Bkb3duPw0KICAgICAgICAgICAgICBsaUluZGV4Kys7DQogICAgICAgICAgICAgIG1haW5FbGVtZW50cy5wdXNoKA0KICAgICAgICAgICAgICAgIGdlbmVyYXRlTEkoDQogICAgICAgICAgICAgICAgICBmYWxzZSwNCiAgICAgICAgICAgICAgICAgIG51bGwsDQogICAgICAgICAgICAgICAgICBjbGFzc05hbWVzLkRJVklERVIsDQogICAgICAgICAgICAgICAgICBvcHRJRCArICdkaXYnDQogICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICBtYWluRGF0YS5wdXNoKHsNCiAgICAgICAgICAgICAgICB0eXBlOiAnZGl2aWRlcicsDQogICAgICAgICAgICAgICAgb3B0SUQ6IG9wdElELA0KICAgICAgICAgICAgICAgIG9yaWdpbmFsSW5kZXg6IGluZGV4DQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgbGlJbmRleCsrOw0KDQogICAgICAgICAgICB2YXIgbGFiZWxFbGVtZW50ID0gZ2VuZXJhdGVMYWJlbCh7DQogICAgICAgICAgICAgICAgICBsYWJlbEVzY2FwZWQ6IGxhYmVsRXNjYXBlZCwNCiAgICAgICAgICAgICAgICAgIGxhYmVsU3VidGV4dDogbGFiZWxTdWJ0ZXh0LA0KICAgICAgICAgICAgICAgICAgbGFiZWxJY29uOiBsYWJlbEljb24NCiAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgbWFpbkVsZW1lbnRzLnB1c2goZ2VuZXJhdGVMSShsYWJlbEVsZW1lbnQsIG51bGwsICdkcm9wZG93bi1oZWFkZXInICsgb3B0R3JvdXBDbGFzcywgb3B0SUQpKTsNCiAgICAgICAgICAgIG1haW5EYXRhLnB1c2goew0KICAgICAgICAgICAgICBjb250ZW50OiBsYWJlbEVzY2FwZWQsDQogICAgICAgICAgICAgIHN1YnRleHQ6IGxhYmVsU3VidGV4dCwNCiAgICAgICAgICAgICAgdHlwZTogJ29wdGdyb3VwLWxhYmVsJywNCiAgICAgICAgICAgICAgb3B0SUQ6IG9wdElELA0KICAgICAgICAgICAgICBvcmlnaW5hbEluZGV4OiBpbmRleA0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGhlYWRlckluZGV4ID0gbGlJbmRleCAtIDE7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5oaWRlRGlzYWJsZWQgJiYgaXNEaXNhYmxlZCB8fCB0aGlzRGF0YS5oaWRkZW4gPT09IHRydWUpIHsNCiAgICAgICAgICAgIGxpSW5kZXgtLTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICB0ZXh0RWxlbWVudCA9IGdlbmVyYXRlVGV4dCh7DQogICAgICAgICAgICB0ZXh0OiB0ZXh0LA0KICAgICAgICAgICAgb3B0aW9uQ29udGVudDogb3B0aW9uQ29udGVudCwNCiAgICAgICAgICAgIG9wdGlvblN1YnRleHQ6IHN1YnRleHQsDQogICAgICAgICAgICBvcHRpb25JY29uOiBpY29uDQogICAgICAgICAgfSk7DQoNCiAgICAgICAgICBtYWluRWxlbWVudHMucHVzaChnZW5lcmF0ZUxJKGdlbmVyYXRlQSh0ZXh0RWxlbWVudCwgJ29wdCAnICsgb3B0aW9uQ2xhc3MgKyBvcHRHcm91cENsYXNzLCBpbmxpbmUpLCBpbmRleCwgJycsIG9wdElEKSk7DQogICAgICAgICAgbWFpbkRhdGEucHVzaCh7DQogICAgICAgICAgICBjb250ZW50OiBvcHRpb25Db250ZW50IHx8IHRleHQsDQogICAgICAgICAgICBzdWJ0ZXh0OiBzdWJ0ZXh0LA0KICAgICAgICAgICAgdG9rZW5zOiB0b2tlbnMsDQogICAgICAgICAgICB0eXBlOiAnb3B0aW9uJywNCiAgICAgICAgICAgIG9wdElEOiBvcHRJRCwNCiAgICAgICAgICAgIGhlYWRlckluZGV4OiBoZWFkZXJJbmRleCwNCiAgICAgICAgICAgIGxhc3RJbmRleDogaGVhZGVySW5kZXggKyBwYXJlbnQuY2hpbGRFbGVtZW50Q291bnQsDQogICAgICAgICAgICBvcmlnaW5hbEluZGV4OiBpbmRleCwNCiAgICAgICAgICAgIGRhdGE6IHRoaXNEYXRhDQogICAgICAgICAgfSk7DQoNCiAgICAgICAgICBhdmFpbGFibGVPcHRpb25zQ291bnQrKzsNCiAgICAgICAgfSBlbHNlIGlmICh0aGlzRGF0YS5kaXZpZGVyID09PSB0cnVlKSB7DQogICAgICAgICAgbWFpbkVsZW1lbnRzLnB1c2goZ2VuZXJhdGVMSShmYWxzZSwgaW5kZXgsICdkaXZpZGVyJykpOw0KICAgICAgICAgIG1haW5EYXRhLnB1c2goew0KICAgICAgICAgICAgdHlwZTogJ2RpdmlkZXInLA0KICAgICAgICAgICAgb3JpZ2luYWxJbmRleDogaW5kZXgNCiAgICAgICAgICB9KTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAvLyBpZiBwcmV2aW91cyBlbGVtZW50IGlzIG5vdCBhbiBvcHRncm91cCBhbmQgaGlkZURpc2FibGVkIGlzIHRydWUNCiAgICAgICAgICBpZiAoIXNob3dEaXZpZGVyICYmIHRoYXQub3B0aW9ucy5oaWRlRGlzYWJsZWQpIHsNCiAgICAgICAgICAgIHByZXZIaWRkZW5JbmRleCA9IHRoaXNEYXRhLnByZXZIaWRkZW5JbmRleDsNCg0KICAgICAgICAgICAgaWYgKHByZXZIaWRkZW5JbmRleCAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgIC8vIHNlbGVjdCB0aGUgZWxlbWVudCAqKmJlZm9yZSoqIHRoZSBmaXJzdCBoaWRkZW4gZWxlbWVudCBpbiB0aGUgZ3JvdXANCiAgICAgICAgICAgICAgdmFyIHByZXZIaWRkZW4gPSAkc2VsZWN0T3B0aW9uc1twcmV2SGlkZGVuSW5kZXhdLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7DQogICAgICAgICAgICAgIA0KICAgICAgICAgICAgICBpZiAocHJldkhpZGRlbiAmJiBwcmV2SGlkZGVuLnRhZ05hbWUgPT09ICdPUFRHUk9VUCcgJiYgIXByZXZIaWRkZW4uZGlzYWJsZWQpIHsNCiAgICAgICAgICAgICAgICBzaG93RGl2aWRlciA9IHRydWU7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQoNCiAgICAgICAgICBpZiAoc2hvd0RpdmlkZXIgJiYgbWFpbkRhdGFbbWFpbkRhdGEubGVuZ3RoIC0gMV0udHlwZSAhPT0gJ2RpdmlkZXInKSB7DQogICAgICAgICAgICBsaUluZGV4Kys7DQogICAgICAgICAgICBtYWluRWxlbWVudHMucHVzaCgNCiAgICAgICAgICAgICAgZ2VuZXJhdGVMSSgNCiAgICAgICAgICAgICAgICBmYWxzZSwNCiAgICAgICAgICAgICAgICBudWxsLA0KICAgICAgICAgICAgICAgIGNsYXNzTmFtZXMuRElWSURFUiwNCiAgICAgICAgICAgICAgICBvcHRJRCArICdkaXYnDQogICAgICAgICAgICAgICkNCiAgICAgICAgICAgICk7DQogICAgICAgICAgICBtYWluRGF0YS5wdXNoKHsNCiAgICAgICAgICAgICAgdHlwZTogJ2RpdmlkZXInLA0KICAgICAgICAgICAgICBvcHRJRDogb3B0SUQsDQogICAgICAgICAgICAgIG9yaWdpbmFsSW5kZXg6IGluZGV4DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICB0ZXh0RWxlbWVudCA9IGdlbmVyYXRlVGV4dCh7DQogICAgICAgICAgICB0ZXh0OiB0ZXh0LA0KICAgICAgICAgICAgb3B0aW9uQ29udGVudDogb3B0aW9uQ29udGVudCwNCiAgICAgICAgICAgIG9wdGlvblN1YnRleHQ6IHN1YnRleHQsDQogICAgICAgICAgICBvcHRpb25JY29uOiBpY29uDQogICAgICAgICAgfSk7DQoNCiAgICAgICAgICBtYWluRWxlbWVudHMucHVzaChnZW5lcmF0ZUxJKGdlbmVyYXRlQSh0ZXh0RWxlbWVudCwgb3B0aW9uQ2xhc3MsIGlubGluZSksIGluZGV4KSk7DQogICAgICAgICAgbWFpbkRhdGEucHVzaCh7DQogICAgICAgICAgICBjb250ZW50OiBvcHRpb25Db250ZW50IHx8IHRleHQsDQogICAgICAgICAgICBzdWJ0ZXh0OiBzdWJ0ZXh0LA0KICAgICAgICAgICAgdG9rZW5zOiB0b2tlbnMsDQogICAgICAgICAgICB0eXBlOiAnb3B0aW9uJywNCiAgICAgICAgICAgIG9yaWdpbmFsSW5kZXg6IGluZGV4LA0KICAgICAgICAgICAgZGF0YTogdGhpc0RhdGENCiAgICAgICAgICB9KTsNCg0KICAgICAgICAgIGF2YWlsYWJsZU9wdGlvbnNDb3VudCsrOw0KICAgICAgICB9DQoNCiAgICAgICAgdGhhdC5zZWxlY3RwaWNrZXIubWFpbi5tYXAubmV3SW5kZXhbaW5kZXhdID0gbGlJbmRleDsNCiAgICAgICAgdGhhdC5zZWxlY3RwaWNrZXIubWFpbi5tYXAub3JpZ2luYWxJbmRleFtsaUluZGV4XSA9IGluZGV4Ow0KDQogICAgICAgIC8vIGdldCB0aGUgbW9zdCByZWNlbnQgb3B0aW9uIGluZm8gYWRkZWQgdG8gbWFpbkRhdGENCiAgICAgICAgdmFyIF9tYWluRGF0YUxhc3QgPSBtYWluRGF0YVttYWluRGF0YS5sZW5ndGggLSAxXTsNCg0KICAgICAgICBfbWFpbkRhdGFMYXN0LmRpc2FibGVkID0gaXNEaXNhYmxlZDsNCg0KICAgICAgICB2YXIgY29tYmluZWRMZW5ndGggPSAwOw0KDQogICAgICAgIC8vIGNvdW50IHRoZSBudW1iZXIgb2YgY2hhcmFjdGVycyBpbiB0aGUgb3B0aW9uIC0gbm90IHBlcmZlY3QsIGJ1dCBzaG91bGQgd29yayBpbiBtb3N0IGNhc2VzDQogICAgICAgIGlmIChfbWFpbkRhdGFMYXN0LmNvbnRlbnQpIGNvbWJpbmVkTGVuZ3RoICs9IF9tYWluRGF0YUxhc3QuY29udGVudC5sZW5ndGg7DQogICAgICAgIGlmIChfbWFpbkRhdGFMYXN0LnN1YnRleHQpIGNvbWJpbmVkTGVuZ3RoICs9IF9tYWluRGF0YUxhc3Quc3VidGV4dC5sZW5ndGg7DQogICAgICAgIC8vIGlmIHRoZXJlIGlzIGFuIGljb24sIGVuc3VyZSB0aGlzIG9wdGlvbidzIHdpZHRoIGlzIGNoZWNrZWQNCiAgICAgICAgaWYgKGljb24pIGNvbWJpbmVkTGVuZ3RoICs9IDE7DQoNCiAgICAgICAgaWYgKGNvbWJpbmVkTGVuZ3RoID4gd2lkZXN0T3B0aW9uTGVuZ3RoKSB7DQogICAgICAgICAgd2lkZXN0T3B0aW9uTGVuZ3RoID0gY29tYmluZWRMZW5ndGg7DQoNCiAgICAgICAgICAvLyBndWVzcyB3aGljaCBvcHRpb24gaXMgdGhlIHdpZGVzdA0KICAgICAgICAgIC8vIHVzZSB0aGlzIHdoZW4gY2FsY3VsYXRpbmcgbWVudSB3aWR0aA0KICAgICAgICAgIC8vIG5vdCBwZXJmZWN0LCBidXQgaXQncyBmYXN0LCBhbmQgdGhlIHdpZHRoIHdpbGwgYmUgdXBkYXRpbmcgYWNjb3JkaW5nbHkgd2hlbiBzY3JvbGxpbmcNCiAgICAgICAgICB3aWRlc3RPcHRpb24gPSBtYWluRWxlbWVudHNbbWFpbkVsZW1lbnRzLmxlbmd0aCAtIDFdOw0KICAgICAgICB9DQogICAgICB9KTsNCg0KICAgICAgdGhpcy5zZWxlY3RwaWNrZXIubWFpbi5lbGVtZW50cyA9IG1haW5FbGVtZW50czsNCiAgICAgIHRoaXMuc2VsZWN0cGlja2VyLm1haW4uZGF0YSA9IG1haW5EYXRhOw0KDQogICAgICB0aGlzLnNlbGVjdHBpY2tlci5jdXJyZW50ID0gdGhpcy5zZWxlY3RwaWNrZXIubWFpbjsNCg0KICAgICAgdGhpcy5zZWxlY3RwaWNrZXIudmlldy53aWRlc3RPcHRpb24gPSB3aWRlc3RPcHRpb247DQogICAgICB0aGlzLnNlbGVjdHBpY2tlci52aWV3LmF2YWlsYWJsZU9wdGlvbnNDb3VudCA9IGF2YWlsYWJsZU9wdGlvbnNDb3VudDsgLy8gZmFzdGVyIHdheSB0byBnZXQgIyBvZiBhdmFpbGFibGUgb3B0aW9ucyB3aXRob3V0IGZpbHRlcg0KICAgIH0sDQoNCiAgICBmaW5kTGlzOiBmdW5jdGlvbiAoKSB7DQogICAgICByZXR1cm4gdGhpcy4kbWVudUlubmVyLmZpbmQoJy5pbm5lciA+IGxpJyk7DQogICAgfSwNCg0KICAgIHJlbmRlcjogZnVuY3Rpb24gKCkgew0KICAgICAgdmFyIHRoYXQgPSB0aGlzLA0KICAgICAgICAgICRzZWxlY3RPcHRpb25zID0gdGhpcy4kZWxlbWVudC5maW5kKCdvcHRpb24nKSwNCiAgICAgICAgICBzZWxlY3RlZEl0ZW1zID0gW10sDQogICAgICAgICAgc2VsZWN0ZWRJdGVtc0luVGl0bGUgPSBbXTsNCg0KICAgICAgdGhpcy50b2dnbGVQbGFjZWhvbGRlcigpOw0KDQogICAgICB0aGlzLnRhYkluZGV4KCk7DQoNCiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLnNlbGVjdHBpY2tlci5tYWluLmVsZW1lbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7DQogICAgICAgIHZhciBpbmRleCA9IHRoaXMuc2VsZWN0cGlja2VyLm1haW4ubWFwLm9yaWdpbmFsSW5kZXhbaV0sDQogICAgICAgICAgICBvcHRpb24gPSAkc2VsZWN0T3B0aW9uc1tpbmRleF07DQoNCiAgICAgICAgaWYgKG9wdGlvbiAmJiBvcHRpb24uc2VsZWN0ZWQpIHsNCiAgICAgICAgICBzZWxlY3RlZEl0ZW1zLnB1c2gob3B0aW9uKTsNCg0KICAgICAgICAgIGlmIChzZWxlY3RlZEl0ZW1zSW5UaXRsZS5sZW5ndGggPCAxMDAgJiYgdGhhdC5vcHRpb25zLnNlbGVjdGVkVGV4dEZvcm1hdCAhPT0gJ2NvdW50JyB8fCBzZWxlY3RlZEl0ZW1zLmxlbmd0aCA9PT0gMSkgew0KICAgICAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5oaWRlRGlzYWJsZWQgJiYgKG9wdGlvbi5kaXNhYmxlZCB8fCBvcHRpb24ucGFyZW50Tm9kZS50YWdOYW1lID09PSAnT1BUR1JPVVAnICYmIG9wdGlvbi5wYXJlbnROb2RlLmRpc2FibGVkKSkgcmV0dXJuOw0KDQogICAgICAgICAgICB2YXIgdGhpc0RhdGEgPSB0aGlzLnNlbGVjdHBpY2tlci5tYWluLmRhdGFbaV0uZGF0YSwNCiAgICAgICAgICAgICAgICBpY29uID0gdGhpc0RhdGEuaWNvbiAmJiB0aGF0Lm9wdGlvbnMuc2hvd0ljb24gPyAnPGkgY2xhc3M9IicgKyB0aGF0Lm9wdGlvbnMuaWNvbkJhc2UgKyAnICcgKyB0aGlzRGF0YS5pY29uICsgJyI+PC9pPiAnIDogJycsDQogICAgICAgICAgICAgICAgc3VidGV4dCwNCiAgICAgICAgICAgICAgICB0aXRsZUl0ZW07DQoNCiAgICAgICAgICAgIGlmICh0aGF0Lm9wdGlvbnMuc2hvd1N1YnRleHQgJiYgdGhpc0RhdGEuc3VidGV4dCAmJiAhdGhhdC5tdWx0aXBsZSkgew0KICAgICAgICAgICAgICBzdWJ0ZXh0ID0gJyA8c21hbGwgY2xhc3M9InRleHQtbXV0ZWQiPicgKyB0aGlzRGF0YS5zdWJ0ZXh0ICsgJzwvc21hbGw+JzsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgIHN1YnRleHQgPSAnJzsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKG9wdGlvbi50aXRsZSkgew0KICAgICAgICAgICAgICB0aXRsZUl0ZW0gPSBvcHRpb24udGl0bGU7DQogICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXNEYXRhLmNvbnRlbnQgJiYgdGhhdC5vcHRpb25zLnNob3dDb250ZW50KSB7DQogICAgICAgICAgICAgIHRpdGxlSXRlbSA9IHRoaXNEYXRhLmNvbnRlbnQudG9TdHJpbmcoKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgIHRpdGxlSXRlbSA9IGljb24gKyBvcHRpb24uaW5uZXJIVE1MLnRyaW0oKSArIHN1YnRleHQ7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHNlbGVjdGVkSXRlbXNJblRpdGxlLnB1c2godGl0bGVJdGVtKTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0NCg0KICAgICAgLy9GaXhlcyBpc3N1ZSBpbiBJRTEwIG9jY3VycmluZyB3aGVuIG5vIGRlZmF1bHQgb3B0aW9uIGlzIHNlbGVjdGVkIGFuZCBhdCBsZWFzdCBvbmUgb3B0aW9uIGlzIGRpc2FibGVkDQogICAgICAvL0NvbnZlcnQgYWxsIHRoZSB2YWx1ZXMgaW50byBhIGNvbW1hIGRlbGltaXRlZCBzdHJpbmcNCiAgICAgIHZhciB0aXRsZSA9ICF0aGlzLm11bHRpcGxlID8gc2VsZWN0ZWRJdGVtc0luVGl0bGVbMF0gOiBzZWxlY3RlZEl0ZW1zSW5UaXRsZS5qb2luKHRoaXMub3B0aW9ucy5tdWx0aXBsZVNlcGFyYXRvcik7DQoNCiAgICAgIC8vIGFkZCBlbGxpcHNpcw0KICAgICAgaWYgKHNlbGVjdGVkSXRlbXMubGVuZ3RoID4gNTApIHRpdGxlICs9ICcuLi4nOw0KDQogICAgICAvLyBJZiB0aGlzIGlzIGEgbXVsdGlzZWxlY3QsIGFuZCBzZWxlY3RlZFRleHRGb3JtYXQgaXMgY291bnQsIHRoZW4gc2hvdyAxIG9mIDIgc2VsZWN0ZWQgZXRjLi4NCiAgICAgIGlmICh0aGlzLm11bHRpcGxlICYmIHRoaXMub3B0aW9ucy5zZWxlY3RlZFRleHRGb3JtYXQuaW5kZXhPZignY291bnQnKSAhPT0gLTEpIHsNCiAgICAgICAgdmFyIG1heCA9IHRoaXMub3B0aW9ucy5zZWxlY3RlZFRleHRGb3JtYXQuc3BsaXQoJz4nKTsNCg0KICAgICAgICBpZiAoKG1heC5sZW5ndGggPiAxICYmIHNlbGVjdGVkSXRlbXMubGVuZ3RoID4gbWF4WzFdKSB8fCAobWF4Lmxlbmd0aCA9PT0gMSAmJiBzZWxlY3RlZEl0ZW1zLmxlbmd0aCA+PSAyKSkgew0KICAgICAgICAgIHZhciB0b3RhbENvdW50ID0gdGhpcy5zZWxlY3RwaWNrZXIudmlldy5hdmFpbGFibGVPcHRpb25zQ291bnQsDQogICAgICAgICAgICAgIHRyOG5UZXh0ID0gKHR5cGVvZiB0aGlzLm9wdGlvbnMuY291bnRTZWxlY3RlZFRleHQgPT09ICdmdW5jdGlvbicpID8gdGhpcy5vcHRpb25zLmNvdW50U2VsZWN0ZWRUZXh0KHNlbGVjdGVkSXRlbXMubGVuZ3RoLCB0b3RhbENvdW50KSA6IHRoaXMub3B0aW9ucy5jb3VudFNlbGVjdGVkVGV4dDsNCg0KICAgICAgICAgIHRpdGxlID0gdHI4blRleHQucmVwbGFjZSgnezB9Jywgc2VsZWN0ZWRJdGVtcy5sZW5ndGgudG9TdHJpbmcoKSkucmVwbGFjZSgnezF9JywgdG90YWxDb3VudC50b1N0cmluZygpKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KDQogICAgICBpZiAodGhpcy5vcHRpb25zLnRpdGxlID09IHVuZGVmaW5lZCkgew0KICAgICAgICAvLyB1c2UgLmF0dHIgdG8gZW5zdXJlIHVuZGVmaW5lZCBpcyByZXR1cm5lZCBpZiB0aXRsZSBhdHRyaWJ1dGUgaXMgbm90IHNldA0KICAgICAgICB0aGlzLm9wdGlvbnMudGl0bGUgPSB0aGlzLiRlbGVtZW50LmF0dHIoJ3RpdGxlJyk7DQogICAgICB9DQoNCiAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2VsZWN0ZWRUZXh0Rm9ybWF0ID09ICdzdGF0aWMnKSB7DQogICAgICAgIHRpdGxlID0gdGhpcy5vcHRpb25zLnRpdGxlOw0KICAgICAgfQ0KDQogICAgICAvL0lmIHdlIGRvbnQgaGF2ZSBhIHRpdGxlLCB0aGVuIHVzZSB0aGUgZGVmYXVsdCwgb3IgaWYgbm90aGluZyBpcyBzZXQgYXQgYWxsLCB1c2UgdGhlIG5vdCBzZWxlY3RlZCB0ZXh0DQogICAgICBpZiAoIXRpdGxlKSB7DQogICAgICAgIHRpdGxlID0gdHlwZW9mIHRoaXMub3B0aW9ucy50aXRsZSAhPT0gJ3VuZGVmaW5lZCcgPyB0aGlzLm9wdGlvbnMudGl0bGUgOiB0aGlzLm9wdGlvbnMubm9uZVNlbGVjdGVkVGV4dDsNCiAgICAgIH0NCg0KICAgICAgLy9zdHJpcCBhbGwgSFRNTCB0YWdzIGFuZCB0cmltIHRoZSByZXN1bHQsIHRoZW4gdW5lc2NhcGUgYW55IGVzY2FwZWQgdGFncw0KICAgICAgdGhpcy4kYnV0dG9uWzBdLnRpdGxlID0gaHRtbFVuZXNjYXBlKHRpdGxlLnJlcGxhY2UoLzxbXj5dKj4/L2csICcnKS50cmltKCkpOw0KICAgICAgdGhpcy4kYnV0dG9uLmZpbmQoJy5maWx0ZXItb3B0aW9uLWlubmVyLWlubmVyJylbMF0uaW5uZXJIVE1MID0gdGl0bGU7DQoNCiAgICAgIHRoaXMuJGVsZW1lbnQudHJpZ2dlcigncmVuZGVyZWQuYnMuc2VsZWN0Jyk7DQogICAgfSwNCg0KICAgIC8qKg0KICAgICAqIEBwYXJhbSBbc3R5bGVdDQogICAgICogQHBhcmFtIFtzdGF0dXNdDQogICAgICovDQogICAgc2V0U3R5bGU6IGZ1bmN0aW9uIChzdHlsZSwgc3RhdHVzKSB7DQogICAgICBpZiAodGhpcy4kZWxlbWVudC5hdHRyKCdjbGFzcycpKSB7DQogICAgICAgIHRoaXMuJG5ld0VsZW1lbnQuYWRkQ2xhc3ModGhpcy4kZWxlbWVudC5hdHRyKCdjbGFzcycpLnJlcGxhY2UoL3NlbGVjdHBpY2tlcnxtb2JpbGUtZGV2aWNlfGJzLXNlbGVjdC1oaWRkZW58dmFsaWRhdGVcWy4qXF0vZ2ksICcnKSk7DQogICAgICB9DQoNCiAgICAgIHZhciBidXR0b25DbGFzcyA9IHN0eWxlID8gc3R5bGUgOiB0aGlzLm9wdGlvbnMuc3R5bGU7DQoNCiAgICAgIGlmIChzdGF0dXMgPT0gJ2FkZCcpIHsNCiAgICAgICAgdGhpcy4kYnV0dG9uLmFkZENsYXNzKGJ1dHRvbkNsYXNzKTsNCiAgICAgIH0gZWxzZSBpZiAoc3RhdHVzID09ICdyZW1vdmUnKSB7DQogICAgICAgIHRoaXMuJGJ1dHRvbi5yZW1vdmVDbGFzcyhidXR0b25DbGFzcyk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLiRidXR0b24ucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLnN0eWxlKTsNCiAgICAgICAgdGhpcy4kYnV0dG9uLmFkZENsYXNzKGJ1dHRvbkNsYXNzKTsNCiAgICAgIH0NCiAgICB9LA0KDQogICAgbGlIZWlnaHQ6IGZ1bmN0aW9uIChyZWZyZXNoKSB7DQogICAgICBpZiAoIXJlZnJlc2ggJiYgKHRoaXMub3B0aW9ucy5zaXplID09PSBmYWxzZSB8fCB0aGlzLnNpemVJbmZvKSkgcmV0dXJuOw0KDQogICAgICBpZiAoIXRoaXMuc2l6ZUluZm8pIHRoaXMuc2l6ZUluZm8gPSB7fTsNCg0KICAgICAgdmFyIG5ld0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSwNCiAgICAgICAgICBtZW51ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksDQogICAgICAgICAgbWVudUlubmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksDQogICAgICAgICAgbWVudUlubmVySW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpLA0KICAgICAgICAgIGRpdmlkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpLA0KICAgICAgICAgIGRyb3Bkb3duSGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKSwNCiAgICAgICAgICBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyksDQogICAgICAgICAgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKSwNCiAgICAgICAgICB0ZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpLA0KICAgICAgICAgIGhlYWRlciA9IHRoaXMub3B0aW9ucy5oZWFkZXIgJiYgdGhpcy4kbWVudS5maW5kKCcuJyArIGNsYXNzTmFtZXMuUE9QT1ZFUkhFQURFUikubGVuZ3RoID4gMCA/IHRoaXMuJG1lbnUuZmluZCgnLicgKyBjbGFzc05hbWVzLlBPUE9WRVJIRUFERVIpWzBdLmNsb25lTm9kZSh0cnVlKSA6IG51bGwsDQogICAgICAgICAgc2VhcmNoID0gdGhpcy5vcHRpb25zLmxpdmVTZWFyY2ggPyBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSA6IG51bGwsDQogICAgICAgICAgYWN0aW9ucyA9IHRoaXMub3B0aW9ucy5hY3Rpb25zQm94ICYmIHRoaXMubXVsdGlwbGUgJiYgdGhpcy4kbWVudS5maW5kKCcuYnMtYWN0aW9uc2JveCcpLmxlbmd0aCA+IDAgPyB0aGlzLiRtZW51LmZpbmQoJy5icy1hY3Rpb25zYm94JylbMF0uY2xvbmVOb2RlKHRydWUpIDogbnVsbCwNCiAgICAgICAgICBkb25lQnV0dG9uID0gdGhpcy5vcHRpb25zLmRvbmVCdXR0b24gJiYgdGhpcy5tdWx0aXBsZSAmJiB0aGlzLiRtZW51LmZpbmQoJy5icy1kb25lYnV0dG9uJykubGVuZ3RoID4gMCA/IHRoaXMuJG1lbnUuZmluZCgnLmJzLWRvbmVidXR0b24nKVswXS5jbG9uZU5vZGUodHJ1ZSkgOiBudWxsOw0KDQogICAgICB0aGlzLnNpemVJbmZvLnNlbGVjdFdpZHRoID0gdGhpcy4kbmV3RWxlbWVudFswXS5vZmZzZXRXaWR0aDsNCg0KICAgICAgdGV4dC5jbGFzc05hbWUgPSAndGV4dCc7DQogICAgICBhLmNsYXNzTmFtZSA9ICdkcm9wZG93bi1pdGVtJzsNCiAgICAgIG5ld0VsZW1lbnQuY2xhc3NOYW1lID0gdGhpcy4kbWVudVswXS5wYXJlbnROb2RlLmNsYXNzTmFtZSArICcgJyArIGNsYXNzTmFtZXMuU0hPVzsNCiAgICAgIG5ld0VsZW1lbnQuc3R5bGUud2lkdGggPSB0aGlzLnNpemVJbmZvLnNlbGVjdFdpZHRoICsgJ3B4JzsNCiAgICAgIG1lbnUuY2xhc3NOYW1lID0gJ2Ryb3Bkb3duLW1lbnUgJyArIGNsYXNzTmFtZXMuU0hPVzsNCiAgICAgIG1lbnVJbm5lci5jbGFzc05hbWUgPSAnaW5uZXIgJyArIGNsYXNzTmFtZXMuU0hPVzsNCiAgICAgIG1lbnVJbm5lcklubmVyLmNsYXNzTmFtZSA9ICdkcm9wZG93bi1tZW51IGlubmVyICcgKyAodmVyc2lvbi5tYWpvciA9PT0gJzQnID8gY2xhc3NOYW1lcy5TSE9XIDogJycpOw0KICAgICAgZGl2aWRlci5jbGFzc05hbWUgPSBjbGFzc05hbWVzLkRJVklERVI7DQogICAgICBkcm9wZG93bkhlYWRlci5jbGFzc05hbWUgPSAnZHJvcGRvd24taGVhZGVyJzsNCg0KICAgICAgdGV4dC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnSW5uZXIgdGV4dCcpKTsNCiAgICAgIGEuYXBwZW5kQ2hpbGQodGV4dCk7DQogICAgICBsaS5hcHBlbmRDaGlsZChhKTsNCiAgICAgIGRyb3Bkb3duSGVhZGVyLmFwcGVuZENoaWxkKHRleHQuY2xvbmVOb2RlKHRydWUpKTsNCg0KICAgICAgaWYgKHRoaXMuc2VsZWN0cGlja2VyLnZpZXcud2lkZXN0T3B0aW9uKSB7DQogICAgICAgIG1lbnVJbm5lcklubmVyLmFwcGVuZENoaWxkKHRoaXMuc2VsZWN0cGlja2VyLnZpZXcud2lkZXN0T3B0aW9uLmNsb25lTm9kZSh0cnVlKSk7DQogICAgICB9DQoNCiAgICAgIG1lbnVJbm5lcklubmVyLmFwcGVuZENoaWxkKGxpKTsNCiAgICAgIG1lbnVJbm5lcklubmVyLmFwcGVuZENoaWxkKGRpdmlkZXIpOw0KICAgICAgbWVudUlubmVySW5uZXIuYXBwZW5kQ2hpbGQoZHJvcGRvd25IZWFkZXIpOw0KICAgICAgaWYgKGhlYWRlcikgbWVudS5hcHBlbmRDaGlsZChoZWFkZXIpOw0KICAgICAgaWYgKHNlYXJjaCkgew0KICAgICAgICB2YXIgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOw0KICAgICAgICBzZWFyY2guY2xhc3NOYW1lID0gJ2JzLXNlYXJjaGJveCc7DQogICAgICAgIGlucHV0LmNsYXNzTmFtZSA9ICdmb3JtLWNvbnRyb2wnOw0KICAgICAgICBzZWFyY2guYXBwZW5kQ2hpbGQoaW5wdXQpOw0KICAgICAgICBtZW51LmFwcGVuZENoaWxkKHNlYXJjaCk7DQogICAgICB9DQogICAgICBpZiAoYWN0aW9ucykgbWVudS5hcHBlbmRDaGlsZChhY3Rpb25zKTsNCiAgICAgIG1lbnVJbm5lci5hcHBlbmRDaGlsZChtZW51SW5uZXJJbm5lcik7DQogICAgICBtZW51LmFwcGVuZENoaWxkKG1lbnVJbm5lcik7DQogICAgICBpZiAoZG9uZUJ1dHRvbikgbWVudS5hcHBlbmRDaGlsZChkb25lQnV0dG9uKTsNCiAgICAgIG5ld0VsZW1lbnQuYXBwZW5kQ2hpbGQobWVudSk7DQoNCiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobmV3RWxlbWVudCk7DQoNCiAgICAgIHZhciBsaUhlaWdodCA9IGEub2Zmc2V0SGVpZ2h0LA0KICAgICAgICAgIGRyb3Bkb3duSGVhZGVySGVpZ2h0ID0gZHJvcGRvd25IZWFkZXIgPyBkcm9wZG93bkhlYWRlci5vZmZzZXRIZWlnaHQgOiAwLA0KICAgICAgICAgIGhlYWRlckhlaWdodCA9IGhlYWRlciA/IGhlYWRlci5vZmZzZXRIZWlnaHQgOiAwLA0KICAgICAgICAgIHNlYXJjaEhlaWdodCA9IHNlYXJjaCA/IHNlYXJjaC5vZmZzZXRIZWlnaHQgOiAwLA0KICAgICAgICAgIGFjdGlvbnNIZWlnaHQgPSBhY3Rpb25zID8gYWN0aW9ucy5vZmZzZXRIZWlnaHQgOiAwLA0KICAgICAgICAgIGRvbmVCdXR0b25IZWlnaHQgPSBkb25lQnV0dG9uID8gZG9uZUJ1dHRvbi5vZmZzZXRIZWlnaHQgOiAwLA0KICAgICAgICAgIGRpdmlkZXJIZWlnaHQgPSAkKGRpdmlkZXIpLm91dGVySGVpZ2h0KHRydWUpLA0KICAgICAgICAgIC8vIGZhbGwgYmFjayB0byBqUXVlcnkgaWYgZ2V0Q29tcHV0ZWRTdHlsZSBpcyBub3Qgc3VwcG9ydGVkDQogICAgICAgICAgbWVudVN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUgPyB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShtZW51KSA6IGZhbHNlLA0KICAgICAgICAgIG1lbnVXaWR0aCA9IG1lbnUub2Zmc2V0V2lkdGgsDQogICAgICAgICAgJG1lbnUgPSBtZW51U3R5bGUgPyBudWxsIDogJChtZW51KSwNCiAgICAgICAgICBtZW51UGFkZGluZyA9IHsNCiAgICAgICAgICAgIHZlcnQ6IHRvSW50ZWdlcihtZW51U3R5bGUgPyBtZW51U3R5bGUucGFkZGluZ1RvcCA6ICRtZW51LmNzcygncGFkZGluZ1RvcCcpKSArDQogICAgICAgICAgICAgICAgICB0b0ludGVnZXIobWVudVN0eWxlID8gbWVudVN0eWxlLnBhZGRpbmdCb3R0b20gOiAkbWVudS5jc3MoJ3BhZGRpbmdCb3R0b20nKSkgKw0KICAgICAgICAgICAgICAgICAgdG9JbnRlZ2VyKG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5ib3JkZXJUb3BXaWR0aCA6ICRtZW51LmNzcygnYm9yZGVyVG9wV2lkdGgnKSkgKw0KICAgICAgICAgICAgICAgICAgdG9JbnRlZ2VyKG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5ib3JkZXJCb3R0b21XaWR0aCA6ICRtZW51LmNzcygnYm9yZGVyQm90dG9tV2lkdGgnKSksDQogICAgICAgICAgICBob3JpejogdG9JbnRlZ2VyKG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5wYWRkaW5nTGVmdCA6ICRtZW51LmNzcygncGFkZGluZ0xlZnQnKSkgKw0KICAgICAgICAgICAgICAgICAgdG9JbnRlZ2VyKG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5wYWRkaW5nUmlnaHQgOiAkbWVudS5jc3MoJ3BhZGRpbmdSaWdodCcpKSArDQogICAgICAgICAgICAgICAgICB0b0ludGVnZXIobWVudVN0eWxlID8gbWVudVN0eWxlLmJvcmRlckxlZnRXaWR0aCA6ICRtZW51LmNzcygnYm9yZGVyTGVmdFdpZHRoJykpICsNCiAgICAgICAgICAgICAgICAgIHRvSW50ZWdlcihtZW51U3R5bGUgPyBtZW51U3R5bGUuYm9yZGVyUmlnaHRXaWR0aCA6ICRtZW51LmNzcygnYm9yZGVyUmlnaHRXaWR0aCcpKQ0KICAgICAgICAgIH0sDQogICAgICAgICAgbWVudUV4dHJhcyA9ICB7DQogICAgICAgICAgICB2ZXJ0OiBtZW51UGFkZGluZy52ZXJ0ICsNCiAgICAgICAgICAgICAgICAgIHRvSW50ZWdlcihtZW51U3R5bGUgPyBtZW51U3R5bGUubWFyZ2luVG9wIDogJG1lbnUuY3NzKCdtYXJnaW5Ub3AnKSkgKw0KICAgICAgICAgICAgICAgICAgdG9JbnRlZ2VyKG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5tYXJnaW5Cb3R0b20gOiAkbWVudS5jc3MoJ21hcmdpbkJvdHRvbScpKSArIDIsDQogICAgICAgICAgICBob3JpejogbWVudVBhZGRpbmcuaG9yaXogKw0KICAgICAgICAgICAgICAgICAgdG9JbnRlZ2VyKG1lbnVTdHlsZSA/IG1lbnVTdHlsZS5tYXJnaW5MZWZ0IDogJG1lbnUuY3NzKCdtYXJnaW5MZWZ0JykpICsNCiAgICAgICAgICAgICAgICAgIHRvSW50ZWdlcihtZW51U3R5bGUgPyBtZW51U3R5bGUubWFyZ2luUmlnaHQgOiAkbWVudS5jc3MoJ21hcmdpblJpZ2h0JykpICsgMg0KICAgICAgICAgIH0sDQogICAgICAgICAgc2Nyb2xsQmFyV2lkdGg7DQoNCiAgICAgIG1lbnVJbm5lci5zdHlsZS5vdmVyZmxvd1kgPSAnc2Nyb2xsJzsNCg0KICAgICAgc2Nyb2xsQmFyV2lkdGggPSBtZW51Lm9mZnNldFdpZHRoIC0gbWVudVdpZHRoOw0KDQogICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG5ld0VsZW1lbnQpOw0KDQogICAgICB0aGlzLnNpemVJbmZvLmxpSGVpZ2h0ID0gbGlIZWlnaHQ7DQogICAgICB0aGlzLnNpemVJbmZvLmRyb3Bkb3duSGVhZGVySGVpZ2h0ID0gZHJvcGRvd25IZWFkZXJIZWlnaHQ7DQogICAgICB0aGlzLnNpemVJbmZvLmhlYWRlckhlaWdodCA9IGhlYWRlckhlaWdodDsNCiAgICAgIHRoaXMuc2l6ZUluZm8uc2VhcmNoSGVpZ2h0ID0gc2VhcmNoSGVpZ2h0Ow0KICAgICAgdGhpcy5zaXplSW5mby5hY3Rpb25zSGVpZ2h0ID0gYWN0aW9uc0hlaWdodDsNCiAgICAgIHRoaXMuc2l6ZUluZm8uZG9uZUJ1dHRvbkhlaWdodCA9IGRvbmVCdXR0b25IZWlnaHQ7DQogICAgICB0aGlzLnNpemVJbmZvLmRpdmlkZXJIZWlnaHQgPSBkaXZpZGVySGVpZ2h0Ow0KICAgICAgdGhpcy5zaXplSW5mby5tZW51UGFkZGluZyA9IG1lbnVQYWRkaW5nOw0KICAgICAgdGhpcy5zaXplSW5mby5tZW51RXh0cmFzID0gbWVudUV4dHJhczsNCiAgICAgIHRoaXMuc2l6ZUluZm8ubWVudVdpZHRoID0gbWVudVdpZHRoOw0KICAgICAgdGhpcy5zaXplSW5mby50b3RhbE1lbnVXaWR0aCA9IHRoaXMuc2l6ZUluZm8ubWVudVdpZHRoOw0KICAgICAgdGhpcy5zaXplSW5mby5zY3JvbGxCYXJXaWR0aCA9IHNjcm9sbEJhcldpZHRoOw0KICAgICAgdGhpcy5zaXplSW5mby5zZWxlY3RIZWlnaHQgPSB0aGlzLiRuZXdFbGVtZW50WzBdLm9mZnNldEhlaWdodDsNCg0KICAgICAgdGhpcy5zZXRQb3NpdGlvbkRhdGEoKTsNCiAgICB9LA0KDQogICAgZ2V0U2VsZWN0UG9zaXRpb246IGZ1bmN0aW9uICgpIHsNCiAgICAgIHZhciB0aGF0ID0gdGhpcywNCiAgICAgICAgICAkd2luZG93ID0gJCh3aW5kb3cpLA0KICAgICAgICAgIHBvcyA9IHRoYXQuJG5ld0VsZW1lbnQub2Zmc2V0KCksDQogICAgICAgICAgJGNvbnRhaW5lciA9ICQodGhhdC5vcHRpb25zLmNvbnRhaW5lciksDQogICAgICAgICAgY29udGFpbmVyUG9zOw0KDQogICAgICBpZiAodGhhdC5vcHRpb25zLmNvbnRhaW5lciAmJiAhJGNvbnRhaW5lci5pcygnYm9keScpKSB7DQogICAgICAgIGNvbnRhaW5lclBvcyA9ICRjb250YWluZXIub2Zmc2V0KCk7DQogICAgICAgIGNvbnRhaW5lclBvcy50b3AgKz0gcGFyc2VJbnQoJGNvbnRhaW5lci5jc3MoJ2JvcmRlclRvcFdpZHRoJykpOw0KICAgICAgICBjb250YWluZXJQb3MubGVmdCArPSBwYXJzZUludCgkY29udGFpbmVyLmNzcygnYm9yZGVyTGVmdFdpZHRoJykpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgY29udGFpbmVyUG9zID0geyB0b3A6IDAsIGxlZnQ6IDAgfTsNCiAgICAgIH0NCg0KICAgICAgdmFyIHdpblBhZCA9IHRoYXQub3B0aW9ucy53aW5kb3dQYWRkaW5nOw0KDQogICAgICB0aGlzLnNpemVJbmZvLnNlbGVjdE9mZnNldFRvcCA9IHBvcy50b3AgLSBjb250YWluZXJQb3MudG9wIC0gJHdpbmRvdy5zY3JvbGxUb3AoKTsNCiAgICAgIHRoaXMuc2l6ZUluZm8uc2VsZWN0T2Zmc2V0Qm90ID0gJHdpbmRvdy5oZWlnaHQoKSAtIHRoaXMuc2l6ZUluZm8uc2VsZWN0T2Zmc2V0VG9wIC0gdGhpcy5zaXplSW5mb1snc2VsZWN0SGVpZ2h0J10gLSBjb250YWluZXJQb3MudG9wIC0gd2luUGFkWzJdOw0KICAgICAgdGhpcy5zaXplSW5mby5zZWxlY3RPZmZzZXRMZWZ0ID0gcG9zLmxlZnQgLSBjb250YWluZXJQb3MubGVmdCAtICR3aW5kb3cuc2Nyb2xsTGVmdCgpOw0KICAgICAgdGhpcy5zaXplSW5mby5zZWxlY3RPZmZzZXRSaWdodCA9ICR3aW5kb3cud2lkdGgoKSAtIHRoaXMuc2l6ZUluZm8uc2VsZWN0T2Zmc2V0TGVmdCAtIHRoaXMuc2l6ZUluZm9bJ3NlbGVjdFdpZHRoJ10gLSBjb250YWluZXJQb3MubGVmdCAtIHdpblBhZFsxXTsNCiAgICAgIHRoaXMuc2l6ZUluZm8uc2VsZWN0T2Zmc2V0VG9wIC09IHdpblBhZFswXTsNCiAgICAgIHRoaXMuc2l6ZUluZm8uc2VsZWN0T2Zmc2V0TGVmdCAtPSB3aW5QYWRbM107DQogICAgfSwNCg0KICAgIHNldE1lbnVTaXplOiBmdW5jdGlvbiAoaXNBdXRvKSB7DQogICAgICB0aGlzLmdldFNlbGVjdFBvc2l0aW9uKCk7DQoNCiAgICAgIHZhciBzZWxlY3RXaWR0aCA9IHRoaXMuc2l6ZUluZm9bJ3NlbGVjdFdpZHRoJ10sDQogICAgICAgICAgbGlIZWlnaHQgPSB0aGlzLnNpemVJbmZvWydsaUhlaWdodCddLA0KICAgICAgICAgIGhlYWRlckhlaWdodCA9IHRoaXMuc2l6ZUluZm9bJ2hlYWRlckhlaWdodCddLA0KICAgICAgICAgIHNlYXJjaEhlaWdodCA9IHRoaXMuc2l6ZUluZm9bJ3NlYXJjaEhlaWdodCddLA0KICAgICAgICAgIGFjdGlvbnNIZWlnaHQgPSB0aGlzLnNpemVJbmZvWydhY3Rpb25zSGVpZ2h0J10sDQogICAgICAgICAgZG9uZUJ1dHRvbkhlaWdodCA9IHRoaXMuc2l6ZUluZm9bJ2RvbmVCdXR0b25IZWlnaHQnXSwNCiAgICAgICAgICBkaXZIZWlnaHQgPSB0aGlzLnNpemVJbmZvWydkaXZpZGVySGVpZ2h0J10sDQogICAgICAgICAgbWVudVBhZGRpbmcgPSB0aGlzLnNpemVJbmZvWydtZW51UGFkZGluZyddLA0KICAgICAgICAgIG1lbnVJbm5lckhlaWdodCwNCiAgICAgICAgICBtZW51SGVpZ2h0LA0KICAgICAgICAgIGRpdkxlbmd0aCA9IDAsDQogICAgICAgICAgbWluSGVpZ2h0LA0KICAgICAgICAgIF9taW5IZWlnaHQsDQogICAgICAgICAgbWF4SGVpZ2h0LA0KICAgICAgICAgIG1lbnVJbm5lck1pbkhlaWdodCwNCiAgICAgICAgICBlc3RpbWF0ZTsNCg0KICAgICAgaWYgKHRoaXMub3B0aW9ucy5kcm9wdXBBdXRvKSB7DQogICAgICAgIC8vIEdldCB0aGUgZXN0aW1hdGVkIGhlaWdodCBvZiB0aGUgbWVudSB3aXRob3V0IHNjcm9sbGJhcnMuDQogICAgICAgIC8vIFRoaXMgaXMgdXNlZnVsIGZvciBzbWFsbGVyIG1lbnVzLCB3aGVyZSB0aGVyZSBtaWdodCBiZSBwbGVudHkgb2Ygcm9vbQ0KICAgICAgICAvLyBiZWxvdyB0aGUgYnV0dG9uIHdpdGhvdXQgc2V0dGluZyBkcm9wdXAsIGJ1dCB3ZSBjYW4ndCBrbm93DQogICAgICAgIC8vIHRoZSBleGFjdCBoZWlnaHQgb2YgdGhlIG1lbnUgdW50aWwgY3JlYXRlVmlldyBpcyBjYWxsZWQgbGF0ZXINCiAgICAgICAgZXN0aW1hdGUgPSBsaUhlaWdodCAqIHRoaXMuc2VsZWN0cGlja2VyLmN1cnJlbnQuZWxlbWVudHMubGVuZ3RoICsgbWVudVBhZGRpbmcudmVydDsNCiAgICAgICAgdGhpcy4kbmV3RWxlbWVudC50b2dnbGVDbGFzcyhjbGFzc05hbWVzLkRST1BVUCwgdGhpcy5zaXplSW5mby5zZWxlY3RPZmZzZXRUb3AgLSB0aGlzLnNpemVJbmZvLnNlbGVjdE9mZnNldEJvdCA+IHRoaXMuc2l6ZUluZm8ubWVudUV4dHJhcy52ZXJ0ICYmIGVzdGltYXRlICsgdGhpcy5zaXplSW5mby5tZW51RXh0cmFzLnZlcnQgKyA1MCA+IHRoaXMuc2l6ZUluZm8uc2VsZWN0T2Zmc2V0Qm90KTsNCiAgICAgIH0NCg0KICAgICAgaWYgKHRoaXMub3B0aW9ucy5zaXplID09PSAnYXV0bycpIHsNCiAgICAgICAgX21pbkhlaWdodCA9IHRoaXMuc2VsZWN0cGlja2VyLmN1cnJlbnQuZWxlbWVudHMubGVuZ3RoID4gMyA/IHRoaXMuc2l6ZUluZm8ubGlIZWlnaHQgKiAzICsgdGhpcy5zaXplSW5mby5tZW51RXh0cmFzLnZlcnQgLSAyIDogMDsNCiAgICAgICAgbWVudUhlaWdodCA9IHRoaXMuc2l6ZUluZm8uc2VsZWN0T2Zmc2V0Qm90IC0gdGhpcy5zaXplSW5mby5tZW51RXh0cmFzLnZlcnQ7DQogICAgICAgIG1pbkhlaWdodCA9IF9taW5IZWlnaHQgKyBoZWFkZXJIZWlnaHQgKyBzZWFyY2hIZWlnaHQgKyBhY3Rpb25zSGVpZ2h0ICsgZG9uZUJ1dHRvbkhlaWdodDsNCiAgICAgICAgbWVudUlubmVyTWluSGVpZ2h0ID0gTWF0aC5tYXgoX21pbkhlaWdodCAtIG1lbnVQYWRkaW5nLnZlcnQsIDApOw0KDQogICAgICAgIGlmICh0aGlzLiRuZXdFbGVtZW50Lmhhc0NsYXNzKGNsYXNzTmFtZXMuRFJPUFVQKSkgew0KICAgICAgICAgIG1lbnVIZWlnaHQgPSB0aGlzLnNpemVJbmZvLnNlbGVjdE9mZnNldFRvcCAtIHRoaXMuc2l6ZUluZm8ubWVudUV4dHJhcy52ZXJ0Ow0KICAgICAgICB9DQoNCiAgICAgICAgbWF4SGVpZ2h0ID0gbWVudUhlaWdodDsNCiAgICAgICAgbWVudUlubmVySGVpZ2h0ID0gbWVudUhlaWdodCAtIGhlYWRlckhlaWdodCAtIHNlYXJjaEhlaWdodCAtIGFjdGlvbnNIZWlnaHQgLSBkb25lQnV0dG9uSGVpZ2h0IC0gbWVudVBhZGRpbmcudmVydDsNCiAgICAgIH0gZWxzZSBpZiAodGhpcy5vcHRpb25zLnNpemUgJiYgdGhpcy5vcHRpb25zLnNpemUgIT0gJ2F1dG8nICYmIHRoaXMuc2VsZWN0cGlja2VyLmN1cnJlbnQuZWxlbWVudHMubGVuZ3RoID4gdGhpcy5vcHRpb25zLnNpemUpIHsNCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm9wdGlvbnMuc2l6ZTsgaSsrKSB7DQogICAgICAgICAgaWYgKHRoaXMuc2VsZWN0cGlja2VyLmN1cnJlbnQuZGF0YVtpXS50eXBlID09PSAnZGl2aWRlcicpIGRpdkxlbmd0aCsrOw0KICAgICAgICB9DQoNCiAgICAgICAgbWVudUhlaWdodCA9IGxpSGVpZ2h0ICogdGhpcy5vcHRpb25zLnNpemUgKyBkaXZMZW5ndGggKiBkaXZIZWlnaHQgKyBtZW51UGFkZGluZy52ZXJ0Ow0KICAgICAgICBtZW51SW5uZXJIZWlnaHQgPSBtZW51SGVpZ2h0IC0gbWVudVBhZGRpbmcudmVydDsNCiAgICAgICAgbWF4SGVpZ2h0ID0gbWVudUhlaWdodCArIGhlYWRlckhlaWdodCArIHNlYXJjaEhlaWdodCArIGFjdGlvbnNIZWlnaHQgKyBkb25lQnV0dG9uSGVpZ2h0Ow0KICAgICAgICBtaW5IZWlnaHQgPSBtZW51SW5uZXJNaW5IZWlnaHQgPSAnJzsNCiAgICAgIH0NCg0KICAgICAgaWYgKHRoaXMub3B0aW9ucy5kcm9wZG93bkFsaWduUmlnaHQgPT09ICdhdXRvJykgew0KICAgICAgICB0aGlzLiRtZW51LnRvZ2dsZUNsYXNzKGNsYXNzTmFtZXMuTUVOVVJJR0hULCB0aGlzLnNpemVJbmZvLnNlbGVjdE9mZnNldExlZnQgPiB0aGlzLnNpemVJbmZvLnNlbGVjdE9mZnNldFJpZ2h0ICYmIHRoaXMuc2l6ZUluZm8uc2VsZWN0T2Zmc2V0UmlnaHQgPCAodGhpcy4kbWVudVswXS5vZmZzZXRXaWR0aCAtIHNlbGVjdFdpZHRoKSk7DQogICAgICB9DQoNCiAgICAgIHRoaXMuJG1lbnUuY3NzKHsNCiAgICAgICAgJ21heC1oZWlnaHQnOiBtYXhIZWlnaHQgKyAncHgnLA0KICAgICAgICAnb3ZlcmZsb3cnOiAnaGlkZGVuJywNCiAgICAgICAgJ21pbi1oZWlnaHQnOiBtaW5IZWlnaHQgKyAncHgnDQogICAgICB9KTsNCg0KICAgICAgdGhpcy4kbWVudUlubmVyLmNzcyh7DQogICAgICAgICdtYXgtaGVpZ2h0JzogbWVudUlubmVySGVpZ2h0ICsgJ3B4JywNCiAgICAgICAgJ292ZXJmbG93LXknOiAnYXV0bycsDQogICAgICAgICdtaW4taGVpZ2h0JzogbWVudUlubmVyTWluSGVpZ2h0ICsgJ3B4Jw0KICAgICAgfSk7DQoNCiAgICAgIHRoaXMuc2l6ZUluZm9bJ21lbnVJbm5lckhlaWdodCddID0gbWVudUlubmVySGVpZ2h0Ow0KDQogICAgICBpZiAodGhpcy5zZWxlY3RwaWNrZXIuY3VycmVudC5kYXRhLmxlbmd0aCAmJiB0aGlzLnNlbGVjdHBpY2tlci5jdXJyZW50LmRhdGFbdGhpcy5zZWxlY3RwaWNrZXIuY3VycmVudC5kYXRhLmxlbmd0aCAtIDFdLnBvc2l0aW9uID4gdGhpcy5zaXplSW5mby5tZW51SW5uZXJIZWlnaHQpIHsNCiAgICAgICAgdGhpcy5zaXplSW5mby5oYXNTY3JvbGxCYXIgPSB0cnVlOw0KICAgICAgICB0aGlzLnNpemVJbmZvLnRvdGFsTWVudVdpZHRoID0gdGhpcy5zaXplSW5mby5tZW51V2lkdGggKyB0aGlzLnNpemVJbmZvLnNjcm9sbEJhcldpZHRoOw0KDQogICAgICAgIHRoaXMuJG1lbnUuY3NzKCdtaW4td2lkdGgnLCB0aGlzLnNpemVJbmZvLnRvdGFsTWVudVdpZHRoKTsNCiAgICAgIH0NCg0KICAgICAgaWYgKHRoaXMuZHJvcGRvd24gJiYgdGhpcy5kcm9wZG93bi5fcG9wcGVyKSB0aGlzLmRyb3Bkb3duLl9wb3BwZXIudXBkYXRlKCk7DQogICAgfSwNCg0KICAgIHNldFNpemU6IGZ1bmN0aW9uIChyZWZyZXNoKSB7DQogICAgICB0aGlzLmxpSGVpZ2h0KHJlZnJlc2gpOw0KDQogICAgICBpZiAodGhpcy5vcHRpb25zLmhlYWRlcikgdGhpcy4kbWVudS5jc3MoJ3BhZGRpbmctdG9wJywgMCk7DQogICAgICBpZiAodGhpcy5vcHRpb25zLnNpemUgPT09IGZhbHNlKSByZXR1cm47DQoNCiAgICAgIHZhciB0aGF0ID0gdGhpcywNCiAgICAgICAgICAkd2luZG93ID0gJCh3aW5kb3cpLA0KICAgICAgICAgIHNlbGVjdGVkSW5kZXgsDQogICAgICAgICAgb2Zmc2V0ID0gMDsNCg0KICAgICAgdGhpcy5zZXRNZW51U2l6ZSgpOw0KDQogICAgICBpZiAodGhpcy5vcHRpb25zLnNpemUgPT09ICdhdXRvJykgew0KICAgICAgICB0aGlzLiRzZWFyY2hib3gub2ZmKCdpbnB1dC5zZXRNZW51U2l6ZSBwcm9wZXJ0eWNoYW5nZS5zZXRNZW51U2l6ZScpLm9uKCdpbnB1dC5zZXRNZW51U2l6ZSBwcm9wZXJ0eWNoYW5nZS5zZXRNZW51U2l6ZScsIGZ1bmN0aW9uKCkgew0KICAgICAgICAgIHJldHVybiB0aGF0LnNldE1lbnVTaXplKCk7DQogICAgICAgIH0pOw0KICAgICAgICAkd2luZG93Lm9mZigncmVzaXplLnNldE1lbnVTaXplIHNjcm9sbC5zZXRNZW51U2l6ZScpLm9uKCdyZXNpemUuc2V0TWVudVNpemUgc2Nyb2xsLnNldE1lbnVTaXplJywgZnVuY3Rpb24oKSB7DQogICAgICAgICAgcmV0dXJuIHRoYXQuc2V0TWVudVNpemUoKTsNCiAgICAgICAgfSk7DQogICAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy5zaXplICYmIHRoaXMub3B0aW9ucy5zaXplICE9ICdhdXRvJyAmJiB0aGlzLnNlbGVjdHBpY2tlci5jdXJyZW50LmVsZW1lbnRzLmxlbmd0aCA+IHRoaXMub3B0aW9ucy5zaXplKSB7DQogICAgICAgIHRoaXMuJHNlYXJjaGJveC5vZmYoJ2lucHV0LnNldE1lbnVTaXplIHByb3BlcnR5Y2hhbmdlLnNldE1lbnVTaXplJyk7DQogICAgICAgICR3aW5kb3cub2ZmKCdyZXNpemUuc2V0TWVudVNpemUgc2Nyb2xsLnNldE1lbnVTaXplJyk7DQogICAgICB9DQoNCiAgICAgIGlmIChyZWZyZXNoKSB7DQogICAgICAgIG9mZnNldCA9IHRoaXMuJG1lbnVJbm5lclswXS5zY3JvbGxUb3A7DQogICAgICB9IGVsc2UgaWYgKCF0aGF0Lm11bHRpcGxlKSB7DQogICAgICAgIHNlbGVjdGVkSW5kZXggPSB0aGF0LnNlbGVjdHBpY2tlci5tYWluLm1hcC5uZXdJbmRleFt0aGF0LiRlbGVtZW50WzBdLnNlbGVjdGVkSW5kZXhdOw0KDQogICAgICAgIGlmICh0eXBlb2Ygc2VsZWN0ZWRJbmRleCA9PT0gJ251bWJlcicgJiYgdGhhdC5vcHRpb25zLnNpemUgIT09IGZhbHNlKSB7DQogICAgICAgICAgb2Zmc2V0ID0gdGhhdC5zaXplSW5mby5saUhlaWdodCAqIHNlbGVjdGVkSW5kZXg7DQogICAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0IC0gKHRoYXQuc2l6ZUluZm8ubWVudUlubmVySGVpZ2h0IC8gMikgKyAodGhhdC5zaXplSW5mby5saUhlaWdodCAvIDIpOw0KICAgICAgICB9DQogICAgICB9DQoNCiAgICAgIHRoYXQuY3JlYXRlVmlldyhmYWxzZSwgb2Zmc2V0KTsNCiAgICB9LA0KDQogICAgc2V0V2lkdGg6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHZhciB0aGF0ID0gdGhpczsNCg0KICAgICAgaWYgKHRoaXMub3B0aW9ucy53aWR0aCA9PT0gJ2F1dG8nKSB7DQogICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpIHsNCiAgICAgICAgICB0aGF0LiRtZW51LmNzcygnbWluLXdpZHRoJywgJzAnKTsNCiAgICAgICAgICB0aGF0LmxpSGVpZ2h0KCk7DQogICAgICAgICAgdGhhdC5zZXRNZW51U2l6ZSgpOw0KDQogICAgICAgICAgLy8gR2V0IGNvcnJlY3Qgd2lkdGggaWYgZWxlbWVudCBpcyBoaWRkZW4NCiAgICAgICAgICB2YXIgJHNlbGVjdENsb25lID0gdGhhdC4kbmV3RWxlbWVudC5jbG9uZSgpLmFwcGVuZFRvKCdib2R5JyksDQogICAgICAgICAgICAgIGJ0bldpZHRoID0gJHNlbGVjdENsb25lLmNzcygnd2lkdGgnLCAnYXV0bycpLmNoaWxkcmVuKCdidXR0b24nKS5vdXRlcldpZHRoKCk7DQoNCiAgICAgICAgICAkc2VsZWN0Q2xvbmUucmVtb3ZlKCk7DQoNCiAgICAgICAgICAvLyBTZXQgd2lkdGggdG8gd2hhdGV2ZXIncyBsYXJnZXIsIGJ1dHRvbiB0aXRsZSBvciBsb25nZXN0IG9wdGlvbg0KICAgICAgICAgIHRoYXQuc2l6ZUluZm8uc2VsZWN0V2lkdGggPSBNYXRoLm1heCh0aGF0LnNpemVJbmZvLnRvdGFsTWVudVdpZHRoLCBidG5XaWR0aCk7DQogICAgICAgICAgdGhhdC4kbmV3RWxlbWVudC5jc3MoJ3dpZHRoJywgdGhhdC5zaXplSW5mby5zZWxlY3RXaWR0aCArICdweCcpOw0KICAgICAgICB9KTsNCiAgICAgIH0gZWxzZSBpZiAodGhpcy5vcHRpb25zLndpZHRoID09PSAnZml0Jykgew0KICAgICAgICAvLyBSZW1vdmUgaW5saW5lIG1pbi13aWR0aCBzbyB3aWR0aCBjYW4gYmUgY2hhbmdlZCBmcm9tICdhdXRvJw0KICAgICAgICB0aGlzLiRtZW51LmNzcygnbWluLXdpZHRoJywgJycpOw0KICAgICAgICB0aGlzLiRuZXdFbGVtZW50LmNzcygnd2lkdGgnLCAnJykuYWRkQ2xhc3MoJ2ZpdC13aWR0aCcpOw0KICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbnMud2lkdGgpIHsNCiAgICAgICAgLy8gUmVtb3ZlIGlubGluZSBtaW4td2lkdGggc28gd2lkdGggY2FuIGJlIGNoYW5nZWQgZnJvbSAnYXV0bycNCiAgICAgICAgdGhpcy4kbWVudS5jc3MoJ21pbi13aWR0aCcsICcnKTsNCiAgICAgICAgdGhpcy4kbmV3RWxlbWVudC5jc3MoJ3dpZHRoJywgdGhpcy5vcHRpb25zLndpZHRoKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIC8vIFJlbW92ZSBpbmxpbmUgbWluLXdpZHRoL3dpZHRoIHNvIHdpZHRoIGNhbiBiZSBjaGFuZ2VkDQogICAgICAgIHRoaXMuJG1lbnUuY3NzKCdtaW4td2lkdGgnLCAnJyk7DQogICAgICAgIHRoaXMuJG5ld0VsZW1lbnQuY3NzKCd3aWR0aCcsICcnKTsNCiAgICAgIH0NCiAgICAgIC8vIFJlbW92ZSBmaXQtd2lkdGggY2xhc3MgaWYgd2lkdGggaXMgY2hhbmdlZCBwcm9ncmFtbWF0aWNhbGx5DQogICAgICBpZiAodGhpcy4kbmV3RWxlbWVudC5oYXNDbGFzcygnZml0LXdpZHRoJykgJiYgdGhpcy5vcHRpb25zLndpZHRoICE9PSAnZml0Jykgew0KICAgICAgICB0aGlzLiRuZXdFbGVtZW50LnJlbW92ZUNsYXNzKCdmaXQtd2lkdGgnKTsNCiAgICAgIH0NCiAgICB9LA0KDQogICAgc2VsZWN0UG9zaXRpb246IGZ1bmN0aW9uICgpIHsNCiAgICAgIHRoaXMuJGJzQ29udGFpbmVyID0gJCgnPGRpdiBjbGFzcz0iYnMtY29udGFpbmVyIiAvPicpOw0KDQogICAgICB2YXIgdGhhdCA9IHRoaXMsDQogICAgICAgICAgJGNvbnRhaW5lciA9ICQodGhpcy5vcHRpb25zLmNvbnRhaW5lciksDQogICAgICAgICAgcG9zLA0KICAgICAgICAgIGNvbnRhaW5lclBvcywNCiAgICAgICAgICBhY3R1YWxIZWlnaHQsDQogICAgICAgICAgZ2V0UGxhY2VtZW50ID0gZnVuY3Rpb24gKCRlbGVtZW50KSB7DQogICAgICAgICAgICB2YXIgY29udGFpbmVyUG9zaXRpb24gPSB7fTsNCg0KICAgICAgICAgICAgdGhhdC4kYnNDb250YWluZXIuYWRkQ2xhc3MoJGVsZW1lbnQuYXR0cignY2xhc3MnKS5yZXBsYWNlKC9mb3JtLWNvbnRyb2x8Zml0LXdpZHRoL2dpLCAnJykpLnRvZ2dsZUNsYXNzKGNsYXNzTmFtZXMuRFJPUFVQLCAkZWxlbWVudC5oYXNDbGFzcyhjbGFzc05hbWVzLkRST1BVUCkpOw0KICAgICAgICAgICAgcG9zID0gJGVsZW1lbnQub2Zmc2V0KCk7DQoNCiAgICAgICAgICAgIGlmICghJGNvbnRhaW5lci5pcygnYm9keScpKSB7DQogICAgICAgICAgICAgIGNvbnRhaW5lclBvcyA9ICRjb250YWluZXIub2Zmc2V0KCk7DQogICAgICAgICAgICAgIGNvbnRhaW5lclBvcy50b3AgKz0gcGFyc2VJbnQoJGNvbnRhaW5lci5jc3MoJ2JvcmRlclRvcFdpZHRoJykpIC0gJGNvbnRhaW5lci5zY3JvbGxUb3AoKTsNCiAgICAgICAgICAgICAgY29udGFpbmVyUG9zLmxlZnQgKz0gcGFyc2VJbnQoJGNvbnRhaW5lci5jc3MoJ2JvcmRlckxlZnRXaWR0aCcpKSAtICRjb250YWluZXIuc2Nyb2xsTGVmdCgpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgY29udGFpbmVyUG9zID0geyB0b3A6IDAsIGxlZnQ6IDAgfTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgYWN0dWFsSGVpZ2h0ID0gJGVsZW1lbnQuaGFzQ2xhc3MoY2xhc3NOYW1lcy5EUk9QVVApID8gMCA6ICRlbGVtZW50WzBdLm9mZnNldEhlaWdodDsNCg0KICAgICAgICAgICAgLy8gQm9vdHN0cmFwIDQrIHVzZXMgUG9wcGVyIGZvciBtZW51IHBvc2l0aW9uaW5nDQogICAgICAgICAgICBpZiAodmVyc2lvbi5tYWpvciA8IDQpIHsNCiAgICAgICAgICAgICAgY29udGFpbmVyUG9zaXRpb25bJ3RvcCddID0gcG9zLnRvcCAtIGNvbnRhaW5lclBvcy50b3AgKyBhY3R1YWxIZWlnaHQ7DQogICAgICAgICAgICAgIGNvbnRhaW5lclBvc2l0aW9uWydsZWZ0J10gPSBwb3MubGVmdCAtIGNvbnRhaW5lclBvcy5sZWZ0Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBjb250YWluZXJQb3NpdGlvblsnd2lkdGgnXSA9ICRlbGVtZW50WzBdLm9mZnNldFdpZHRoOw0KDQogICAgICAgICAgICB0aGF0LiRic0NvbnRhaW5lci5jc3MoY29udGFpbmVyUG9zaXRpb24pOw0KICAgICAgICAgIH07DQoNCiAgICAgIHRoaXMuJGJ1dHRvbi5vbignY2xpY2suYnMuZHJvcGRvd24uZGF0YS1hcGknLCBmdW5jdGlvbiAoKSB7DQogICAgICAgIGlmICh0aGF0LmlzRGlzYWJsZWQoKSkgew0KICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgIGdldFBsYWNlbWVudCh0aGF0LiRuZXdFbGVtZW50KTsNCg0KICAgICAgICB0aGF0LiRic0NvbnRhaW5lcg0KICAgICAgICAgIC5hcHBlbmRUbyh0aGF0Lm9wdGlvbnMuY29udGFpbmVyKQ0KICAgICAgICAgIC50b2dnbGVDbGFzcyhjbGFzc05hbWVzLlNIT1csICF0aGF0LiRidXR0b24uaGFzQ2xhc3MoY2xhc3NOYW1lcy5TSE9XKSkNCiAgICAgICAgICAuYXBwZW5kKHRoYXQuJG1lbnUpOw0KICAgICAgfSk7DQoNCiAgICAgICQod2luZG93KS5vbigncmVzaXplIHNjcm9sbCcsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgZ2V0UGxhY2VtZW50KHRoYXQuJG5ld0VsZW1lbnQpOw0KICAgICAgfSk7DQoNCiAgICAgIHRoaXMuJGVsZW1lbnQub24oJ2hpZGUuYnMuc2VsZWN0JywgZnVuY3Rpb24gKCkgew0KICAgICAgICB0aGF0LiRtZW51LmRhdGEoJ2hlaWdodCcsIHRoYXQuJG1lbnUuaGVpZ2h0KCkpOw0KICAgICAgICB0aGF0LiRic0NvbnRhaW5lci5kZXRhY2goKTsNCiAgICAgIH0pOw0KICAgIH0sDQoNCiAgICBzZXRPcHRpb25TdGF0dXM6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHZhciB0aGF0ID0gdGhpcywNCiAgICAgICAgICAkc2VsZWN0T3B0aW9ucyA9IHRoaXMuJGVsZW1lbnQuZmluZCgnb3B0aW9uJyk7DQoNCiAgICAgIHRoYXQubm9TY3JvbGwgPSBmYWxzZTsNCg0KICAgICAgaWYgKHRoYXQuc2VsZWN0cGlja2VyLnZpZXcudmlzaWJsZUVsZW1lbnRzICYmIHRoYXQuc2VsZWN0cGlja2VyLnZpZXcudmlzaWJsZUVsZW1lbnRzLmxlbmd0aCkgew0KICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoYXQuc2VsZWN0cGlja2VyLnZpZXcudmlzaWJsZUVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgdmFyIGluZGV4ID0gdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5tYXAub3JpZ2luYWxJbmRleFtpICsgdGhhdC5zZWxlY3RwaWNrZXIudmlldy5wb3NpdGlvbjBdLCAvLyBmYXN0ZXIgdGhhbiAkKGxpKS5kYXRhKCdvcmlnaW5hbEluZGV4JykNCiAgICAgICAgICAgICAgb3B0aW9uID0gJHNlbGVjdE9wdGlvbnNbaW5kZXhdOw0KDQogICAgICAgICAgaWYgKG9wdGlvbikgew0KICAgICAgICAgICAgdmFyIGxpSW5kZXggPSB0aGlzLnNlbGVjdHBpY2tlci5tYWluLm1hcC5uZXdJbmRleFtpbmRleF0sDQogICAgICAgICAgICAgICAgbGkgPSB0aGlzLnNlbGVjdHBpY2tlci5tYWluLmVsZW1lbnRzW2xpSW5kZXhdOw0KDQogICAgICAgICAgICB0aGF0LnNldERpc2FibGVkKA0KICAgICAgICAgICAgICBpbmRleCwNCiAgICAgICAgICAgICAgb3B0aW9uLmRpc2FibGVkIHx8IG9wdGlvbi5wYXJlbnROb2RlLnRhZ05hbWUgPT09ICdPUFRHUk9VUCcgJiYgb3B0aW9uLnBhcmVudE5vZGUuZGlzYWJsZWQsDQogICAgICAgICAgICAgIGxpSW5kZXgsDQogICAgICAgICAgICAgIGxpDQogICAgICAgICAgICApOw0KDQogICAgICAgICAgICB0aGF0LnNldFNlbGVjdGVkKA0KICAgICAgICAgICAgICBpbmRleCwNCiAgICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkLA0KICAgICAgICAgICAgICBsaUluZGV4LA0KICAgICAgICAgICAgICBsaQ0KICAgICAgICAgICAgKTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9LA0KDQogICAgLyoqDQogICAgICogQHBhcmFtIHtudW1iZXJ9IGluZGV4IC0gdGhlIGluZGV4IG9mIHRoZSBvcHRpb24gdGhhdCBpcyBiZWluZyBjaGFuZ2VkDQogICAgICogQHBhcmFtIHtib29sZWFufSBzZWxlY3RlZCAtIHRydWUgaWYgdGhlIG9wdGlvbiBpcyBiZWluZyBzZWxlY3RlZCwgZmFsc2UgaWYgYmVpbmcgZGVzZWxlY3RlZA0KICAgICAqLw0KICAgIHNldFNlbGVjdGVkOiBmdW5jdGlvbiAoaW5kZXgsIHNlbGVjdGVkLCBsaUluZGV4LCBsaSkgew0KICAgICAgdmFyIGFjdGl2ZUluZGV4SXNTZXQgPSB0aGlzLmFjdGl2ZUluZGV4ICE9PSB1bmRlZmluZWQsDQogICAgICAgICAgdGhpc0lzQWN0aXZlID0gdGhpcy5hY3RpdmVJbmRleCA9PT0gaW5kZXgsDQogICAgICAgICAgcHJldkFjdGl2ZUluZGV4LA0KICAgICAgICAgIHByZXZBY3RpdmUsDQogICAgICAgICAgYSwNCiAgICAgICAgICAvLyBpZiBjdXJyZW50IG9wdGlvbiBpcyBhbHJlYWR5IGFjdGl2ZQ0KICAgICAgICAgIC8vIE9SDQogICAgICAgICAgLy8gaWYgdGhlIGN1cnJlbnQgb3B0aW9uIGlzIGJlaW5nIHNlbGVjdGVkLCBpdCdzIE5PVCBtdWx0aXBsZSwgYW5kDQogICAgICAgICAgLy8gYWN0aXZlSW5kZXggaXMgdW5kZWZpbmVkOg0KICAgICAgICAgIC8vICAtIHdoZW4gdGhlIG1lbnUgaXMgZmlyc3QgYmVpbmcgb3BlbmVkLCBPUg0KICAgICAgICAgIC8vICAtIGFmdGVyIGEgc2VhcmNoIGhhcyBiZWVuIHBlcmZvcm1lZCwgT1INCiAgICAgICAgICAvLyAgLSB3aGVuIHJldGFpbkFjdGl2ZSBpcyBmYWxzZSB3aGVuIHNlbGVjdGluZyBhIG5ldyBvcHRpb24gKGkuZS4gaW5kZXggb2YgdGhlIG5ld2x5IHNlbGVjdGVkIG9wdGlvbiBpcyBub3QgdGhlIHNhbWUgYXMgdGhlIGN1cnJlbnQgYWN0aXZlSW5kZXgpDQogICAgICAgICAga2VlcEFjdGl2ZSA9IHRoaXNJc0FjdGl2ZSB8fCBzZWxlY3RlZCAmJiAhdGhpcy5tdWx0aXBsZSAmJiAhYWN0aXZlSW5kZXhJc1NldDsNCg0KICAgICAgaWYgKCFsaUluZGV4KSBsaUluZGV4ID0gdGhpcy5zZWxlY3RwaWNrZXIubWFpbi5tYXAubmV3SW5kZXhbaW5kZXhdOw0KICAgICAgaWYgKCFsaSkgbGkgPSB0aGlzLnNlbGVjdHBpY2tlci5tYWluLmVsZW1lbnRzW2xpSW5kZXhdOw0KDQogICAgICBhID0gbGkuZmlyc3RDaGlsZDsNCg0KICAgICAgaWYgKHNlbGVjdGVkKSB7DQogICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IGluZGV4Ow0KICAgICAgfQ0KDQogICAgICBsaS5jbGFzc0xpc3QudG9nZ2xlKCdzZWxlY3RlZCcsIHNlbGVjdGVkKTsNCiAgICAgIGxpLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScsIGtlZXBBY3RpdmUpOw0KDQogICAgICBpZiAoa2VlcEFjdGl2ZSkgew0KICAgICAgICB0aGlzLnNlbGVjdHBpY2tlci52aWV3LmN1cnJlbnRBY3RpdmUgPSBsaTsNCiAgICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IGluZGV4Ow0KICAgICAgfQ0KDQogICAgICBpZiAoYSkgew0KICAgICAgICBhLmNsYXNzTGlzdC50b2dnbGUoJ3NlbGVjdGVkJywgc2VsZWN0ZWQpOw0KICAgICAgICBhLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScsIGtlZXBBY3RpdmUpOw0KICAgICAgICBhLnNldEF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsIHNlbGVjdGVkKTsNCiAgICAgIH0NCg0KICAgICAgaWYgKCFrZWVwQWN0aXZlKSB7DQogICAgICAgIGlmICghYWN0aXZlSW5kZXhJc1NldCAmJiBzZWxlY3RlZCAmJiB0aGlzLnByZXZBY3RpdmVJbmRleCAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgcHJldkFjdGl2ZUluZGV4ID0gdGhpcy5zZWxlY3RwaWNrZXIubWFpbi5tYXAubmV3SW5kZXhbdGhpcy5wcmV2QWN0aXZlSW5kZXhdOw0KICAgICAgICAgIHByZXZBY3RpdmUgPSB0aGlzLnNlbGVjdHBpY2tlci5tYWluLmVsZW1lbnRzW3ByZXZBY3RpdmVJbmRleF07DQoNCiAgICAgICAgICBwcmV2QWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7DQogICAgICAgICAgcHJldkFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsNCiAgICAgICAgICBpZiAocHJldkFjdGl2ZS5maXJzdENoaWxkKSB7DQogICAgICAgICAgICBwcmV2QWN0aXZlLmZpcnN0Q2hpbGQuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTsNCiAgICAgICAgICAgIHByZXZBY3RpdmUuZmlyc3RDaGlsZC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9LA0KDQogICAgLyoqDQogICAgICogQHBhcmFtIHtudW1iZXJ9IGluZGV4IC0gdGhlIGluZGV4IG9mIHRoZSBvcHRpb24gdGhhdCBpcyBiZWluZyBkaXNhYmxlZA0KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gZGlzYWJsZWQgLSB0cnVlIGlmIHRoZSBvcHRpb24gaXMgYmVpbmcgZGlzYWJsZWQsIGZhbHNlIGlmIGJlaW5nIGVuYWJsZWQNCiAgICAgKi8NCiAgICBzZXREaXNhYmxlZDogZnVuY3Rpb24gKGluZGV4LCBkaXNhYmxlZCwgbGlJbmRleCwgbGkpIHsNCiAgICAgIHZhciBhOw0KDQogICAgICBpZiAoIWxpSW5kZXgpIGxpSW5kZXggPSB0aGlzLnNlbGVjdHBpY2tlci5tYWluLm1hcC5uZXdJbmRleFtpbmRleF07DQogICAgICBpZiAoIWxpKSBsaSA9IHRoaXMuc2VsZWN0cGlja2VyLm1haW4uZWxlbWVudHNbbGlJbmRleF07DQoNCiAgICAgIGEgPSBsaS5maXJzdENoaWxkOw0KDQogICAgICBsaS5jbGFzc0xpc3QudG9nZ2xlKGNsYXNzTmFtZXMuRElTQUJMRUQsIGRpc2FibGVkKTsNCg0KICAgICAgaWYgKGEpIHsNCiAgICAgICAgaWYgKHZlcnNpb24ubWFqb3IgPT09ICc0JykgYS5jbGFzc0xpc3QudG9nZ2xlKGNsYXNzTmFtZXMuRElTQUJMRUQsIGRpc2FibGVkKTsNCg0KICAgICAgICBhLnNldEF0dHJpYnV0ZSgnYXJpYS1kaXNhYmxlZCcsIGRpc2FibGVkKTsNCg0KICAgICAgICBpZiAoZGlzYWJsZWQpIHsNCiAgICAgICAgICBhLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAtMSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgYS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgMCk7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9LA0KDQogICAgaXNEaXNhYmxlZDogZnVuY3Rpb24gKCkgew0KICAgICAgcmV0dXJuIHRoaXMuJGVsZW1lbnRbMF0uZGlzYWJsZWQ7DQogICAgfSwNCg0KICAgIGNoZWNrRGlzYWJsZWQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHZhciB0aGF0ID0gdGhpczsNCg0KICAgICAgaWYgKHRoaXMuaXNEaXNhYmxlZCgpKSB7DQogICAgICAgIHRoaXMuJG5ld0VsZW1lbnQuYWRkQ2xhc3MoY2xhc3NOYW1lcy5ESVNBQkxFRCk7DQogICAgICAgIHRoaXMuJGJ1dHRvbi5hZGRDbGFzcyhjbGFzc05hbWVzLkRJU0FCTEVEKS5hdHRyKCd0YWJpbmRleCcsIC0xKS5hdHRyKCdhcmlhLWRpc2FibGVkJywgdHJ1ZSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBpZiAodGhpcy4kYnV0dG9uLmhhc0NsYXNzKGNsYXNzTmFtZXMuRElTQUJMRUQpKSB7DQogICAgICAgICAgdGhpcy4kbmV3RWxlbWVudC5yZW1vdmVDbGFzcyhjbGFzc05hbWVzLkRJU0FCTEVEKTsNCiAgICAgICAgICB0aGlzLiRidXR0b24ucmVtb3ZlQ2xhc3MoY2xhc3NOYW1lcy5ESVNBQkxFRCkuYXR0cignYXJpYS1kaXNhYmxlZCcsIGZhbHNlKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICh0aGlzLiRidXR0b24uYXR0cigndGFiaW5kZXgnKSA9PSAtMSAmJiAhdGhpcy4kZWxlbWVudC5kYXRhKCd0YWJpbmRleCcpKSB7DQogICAgICAgICAgdGhpcy4kYnV0dG9uLnJlbW92ZUF0dHIoJ3RhYmluZGV4Jyk7DQogICAgICAgIH0NCiAgICAgIH0NCg0KICAgICAgdGhpcy4kYnV0dG9uLmNsaWNrKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgcmV0dXJuICF0aGF0LmlzRGlzYWJsZWQoKTsNCiAgICAgIH0pOw0KICAgIH0sDQoNCiAgICB0b2dnbGVQbGFjZWhvbGRlcjogZnVuY3Rpb24gKCkgew0KICAgICAgLy8gbXVjaCBmYXN0ZXIgdGhhbiBjYWxsaW5nICQudmFsKCkNCiAgICAgIHZhciBlbGVtZW50ID0gdGhpcy4kZWxlbWVudFswXSwNCiAgICAgICAgICBzZWxlY3RlZEluZGV4ID0gZWxlbWVudC5zZWxlY3RlZEluZGV4LA0KICAgICAgICAgIG5vdGhpbmdTZWxlY3RlZCA9IHNlbGVjdGVkSW5kZXggPT09IC0xOw0KDQogICAgICBpZiAoIW5vdGhpbmdTZWxlY3RlZCAmJiAhZWxlbWVudC5vcHRpb25zW3NlbGVjdGVkSW5kZXhdLnZhbHVlKSBub3RoaW5nU2VsZWN0ZWQgPSB0cnVlOw0KDQogICAgICB0aGlzLiRidXR0b24udG9nZ2xlQ2xhc3MoJ2JzLXBsYWNlaG9sZGVyJywgbm90aGluZ1NlbGVjdGVkKTsNCiAgICB9LA0KDQogICAgdGFiSW5kZXg6IGZ1bmN0aW9uICgpIHsNCiAgICAgIGlmICh0aGlzLiRlbGVtZW50LmRhdGEoJ3RhYmluZGV4JykgIT09IHRoaXMuJGVsZW1lbnQuYXR0cigndGFiaW5kZXgnKSAmJiANCiAgICAgICAgKHRoaXMuJGVsZW1lbnQuYXR0cigndGFiaW5kZXgnKSAhPT0gLTk4ICYmIHRoaXMuJGVsZW1lbnQuYXR0cigndGFiaW5kZXgnKSAhPT0gJy05OCcpKSB7DQogICAgICAgIHRoaXMuJGVsZW1lbnQuZGF0YSgndGFiaW5kZXgnLCB0aGlzLiRlbGVtZW50LmF0dHIoJ3RhYmluZGV4JykpOw0KICAgICAgICB0aGlzLiRidXR0b24uYXR0cigndGFiaW5kZXgnLCB0aGlzLiRlbGVtZW50LmRhdGEoJ3RhYmluZGV4JykpOw0KICAgICAgfQ0KDQogICAgICB0aGlzLiRlbGVtZW50LmF0dHIoJ3RhYmluZGV4JywgLTk4KTsNCiAgICB9LA0KDQogICAgY2xpY2tMaXN0ZW5lcjogZnVuY3Rpb24gKCkgew0KICAgICAgdmFyIHRoYXQgPSB0aGlzLA0KICAgICAgICAgICRkb2N1bWVudCA9ICQoZG9jdW1lbnQpOw0KDQogICAgICAkZG9jdW1lbnQuZGF0YSgnc3BhY2VTZWxlY3QnLCBmYWxzZSk7DQoNCiAgICAgIHRoaXMuJGJ1dHRvbi5vbigna2V5dXAnLCBmdW5jdGlvbiAoZSkgew0KICAgICAgICBpZiAoLygzMikvLnRlc3QoZS5rZXlDb2RlLnRvU3RyaW5nKDEwKSkgJiYgJGRvY3VtZW50LmRhdGEoJ3NwYWNlU2VsZWN0JykpIHsNCiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICRkb2N1bWVudC5kYXRhKCdzcGFjZVNlbGVjdCcsIGZhbHNlKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQoNCiAgICAgIHRoaXMuJG5ld0VsZW1lbnQub24oJ3Nob3cuYnMuZHJvcGRvd24nLCBmdW5jdGlvbigpIHsNCiAgICAgICAgaWYgKHZlcnNpb24ubWFqb3IgPiAzICYmICF0aGF0LmRyb3Bkb3duKSB7DQogICAgICAgICAgdGhhdC5kcm9wZG93biA9IHRoYXQuJGJ1dHRvbi5kYXRhKCdicy5kcm9wZG93bicpOw0KICAgICAgICAgIHRoYXQuZHJvcGRvd24uX21lbnUgPSB0aGF0LiRtZW51WzBdOw0KICAgICAgICB9DQogICAgICB9KTsNCg0KICAgICAgdGhpcy4kYnV0dG9uLm9uKCdjbGljay5icy5kcm9wZG93bi5kYXRhLWFwaScsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgaWYgKCF0aGF0LiRuZXdFbGVtZW50Lmhhc0NsYXNzKGNsYXNzTmFtZXMuU0hPVykpIHsNCiAgICAgICAgICB0aGF0LnNldFNpemUoKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQoNCiAgICAgIHRoaXMuJGVsZW1lbnQub24oJ3Nob3duLmJzLnNlbGVjdCcsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgaWYgKHRoYXQuJG1lbnVJbm5lclswXS5zY3JvbGxUb3AgIT09IHRoYXQuc2VsZWN0cGlja2VyLnZpZXcuc2Nyb2xsVG9wKSB7DQogICAgICAgICAgdGhhdC4kbWVudUlubmVyWzBdLnNjcm9sbFRvcCA9IHRoYXQuc2VsZWN0cGlja2VyLnZpZXcuc2Nyb2xsVG9wOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5saXZlU2VhcmNoKSB7DQogICAgICAgICAgdGhhdC4kc2VhcmNoYm94LmZvY3VzKCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdGhhdC4kbWVudUlubmVyLmZvY3VzKCk7DQogICAgICAgIH0NCiAgICAgIH0pOw0KDQogICAgICB0aGlzLiRtZW51SW5uZXIub24oJ2NsaWNrJywgJ2xpIGEnLCBmdW5jdGlvbiAoZSwgcmV0YWluQWN0aXZlKSB7DQogICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyksDQogICAgICAgICAgICBwb3NpdGlvbjAgPSB0aGF0LmlzVmlydHVhbCgpID8gdGhhdC5zZWxlY3RwaWNrZXIudmlldy5wb3NpdGlvbjAgOiAwLA0KICAgICAgICAgICAgY2xpY2tlZEluZGV4ID0gdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5tYXAub3JpZ2luYWxJbmRleFskdGhpcy5wYXJlbnQoKS5pbmRleCgpICsgcG9zaXRpb24wXSwNCiAgICAgICAgICAgIHByZXZWYWx1ZSA9IGdldFNlbGVjdFZhbHVlcyh0aGF0LiRlbGVtZW50WzBdKSwNCiAgICAgICAgICAgIHByZXZJbmRleCA9IHRoYXQuJGVsZW1lbnQucHJvcCgnc2VsZWN0ZWRJbmRleCcpLA0KICAgICAgICAgICAgdHJpZ2dlckNoYW5nZSA9IHRydWU7DQoNCiAgICAgICAgLy8gRG9uJ3QgY2xvc2Ugb24gbXVsdGkgY2hvaWNlIG1lbnUNCiAgICAgICAgaWYgKHRoYXQubXVsdGlwbGUgJiYgdGhhdC5vcHRpb25zLm1heE9wdGlvbnMgIT09IDEpIHsNCiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICB9DQoNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KDQogICAgICAgIC8vRG9uJ3QgcnVuIGlmIHdlIGhhdmUgYmVlbiBkaXNhYmxlZA0KICAgICAgICBpZiAoIXRoYXQuaXNEaXNhYmxlZCgpICYmICEkdGhpcy5wYXJlbnQoKS5oYXNDbGFzcyhjbGFzc05hbWVzLkRJU0FCTEVEKSkgew0KICAgICAgICAgIHZhciAkb3B0aW9ucyA9IHRoYXQuJGVsZW1lbnQuZmluZCgnb3B0aW9uJyksDQogICAgICAgICAgICAgICRvcHRpb24gPSAkb3B0aW9ucy5lcShjbGlja2VkSW5kZXgpLA0KICAgICAgICAgICAgICBzdGF0ZSA9ICRvcHRpb24ucHJvcCgnc2VsZWN0ZWQnKSwNCiAgICAgICAgICAgICAgJG9wdGdyb3VwID0gJG9wdGlvbi5wYXJlbnQoJ29wdGdyb3VwJyksDQogICAgICAgICAgICAgIG1heE9wdGlvbnMgPSB0aGF0Lm9wdGlvbnMubWF4T3B0aW9ucywNCiAgICAgICAgICAgICAgbWF4T3B0aW9uc0dycCA9ICRvcHRncm91cC5kYXRhKCdtYXhPcHRpb25zJykgfHwgZmFsc2U7DQogICAgICAgICAgICAgIA0KICAgICAgICAgIGlmIChjbGlja2VkSW5kZXggPT09IHRoYXQuYWN0aXZlSW5kZXgpIHJldGFpbkFjdGl2ZSA9IHRydWU7DQoNCiAgICAgICAgICBpZiAoIXJldGFpbkFjdGl2ZSkgew0KICAgICAgICAgICAgdGhhdC5wcmV2QWN0aXZlSW5kZXggPSB0aGF0LmFjdGl2ZUluZGV4Ow0KICAgICAgICAgICAgdGhhdC5hY3RpdmVJbmRleCA9IHVuZGVmaW5lZDsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICBpZiAoIXRoYXQubXVsdGlwbGUpIHsgLy8gRGVzZWxlY3QgYWxsIG90aGVycyBpZiBub3QgbXVsdGkgc2VsZWN0IGJveA0KICAgICAgICAgICAgJG9wdGlvbnMucHJvcCgnc2VsZWN0ZWQnLCBmYWxzZSk7DQogICAgICAgICAgICAkb3B0aW9uLnByb3AoJ3NlbGVjdGVkJywgdHJ1ZSk7DQogICAgICAgICAgICB0aGF0LnNldFNlbGVjdGVkKGNsaWNrZWRJbmRleCwgdHJ1ZSk7DQogICAgICAgICAgfSBlbHNlIHsgLy8gVG9nZ2xlIHRoZSBvbmUgd2UgaGF2ZSBjaG9zZW4gaWYgd2UgYXJlIG11bHRpIHNlbGVjdC4NCiAgICAgICAgICAgICRvcHRpb24ucHJvcCgnc2VsZWN0ZWQnLCAhc3RhdGUpOw0KDQogICAgICAgICAgICB0aGF0LnNldFNlbGVjdGVkKGNsaWNrZWRJbmRleCwgIXN0YXRlKTsNCiAgICAgICAgICAgICR0aGlzLmJsdXIoKTsNCg0KICAgICAgICAgICAgaWYgKG1heE9wdGlvbnMgIT09IGZhbHNlIHx8IG1heE9wdGlvbnNHcnAgIT09IGZhbHNlKSB7DQogICAgICAgICAgICAgIHZhciBtYXhSZWFjaGVkID0gbWF4T3B0aW9ucyA8ICRvcHRpb25zLmZpbHRlcignOnNlbGVjdGVkJykubGVuZ3RoLA0KICAgICAgICAgICAgICAgICAgbWF4UmVhY2hlZEdycCA9IG1heE9wdGlvbnNHcnAgPCAkb3B0Z3JvdXAuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykubGVuZ3RoOw0KDQogICAgICAgICAgICAgIGlmICgobWF4T3B0aW9ucyAmJiBtYXhSZWFjaGVkKSB8fCAobWF4T3B0aW9uc0dycCAmJiBtYXhSZWFjaGVkR3JwKSkgew0KICAgICAgICAgICAgICAgIGlmIChtYXhPcHRpb25zICYmIG1heE9wdGlvbnMgPT0gMSkgew0KICAgICAgICAgICAgICAgICAgJG9wdGlvbnMucHJvcCgnc2VsZWN0ZWQnLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgICAkb3B0aW9uLnByb3AoJ3NlbGVjdGVkJywgdHJ1ZSk7DQogICAgICAgICAgICAgICAgICB0aGF0LiRtZW51SW5uZXIuZmluZCgnLnNlbGVjdGVkJykucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7DQogICAgICAgICAgICAgICAgICB0aGF0LnNldFNlbGVjdGVkKGNsaWNrZWRJbmRleCwgdHJ1ZSk7DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtYXhPcHRpb25zR3JwICYmIG1heE9wdGlvbnNHcnAgPT0gMSkgew0KICAgICAgICAgICAgICAgICAgJG9wdGdyb3VwLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpLnByb3AoJ3NlbGVjdGVkJywgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgJG9wdGlvbi5wcm9wKCdzZWxlY3RlZCcsIHRydWUpOw0KICAgICAgICAgICAgICAgICAgdmFyIG9wdGdyb3VwSUQgPSB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50LmRhdGFbJHRoaXMucGFyZW50KCkuaW5kZXgoKSArIHRoYXQuc2VsZWN0cGlja2VyLnZpZXcucG9zaXRpb24wXS5vcHRJRDsNCiAgICAgICAgICAgICAgICAgIHRoYXQuJG1lbnVJbm5lci5maW5kKCcub3B0Z3JvdXAtJyArIG9wdGdyb3VwSUQpLnJlbW92ZUNsYXNzKCdzZWxlY3RlZCcpOw0KICAgICAgICAgICAgICAgICAgdGhhdC5zZXRTZWxlY3RlZChjbGlja2VkSW5kZXgsIHRydWUpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICB2YXIgbWF4T3B0aW9uc1RleHQgPSB0eXBlb2YgdGhhdC5vcHRpb25zLm1heE9wdGlvbnNUZXh0ID09PSAnc3RyaW5nJyA/IFt0aGF0Lm9wdGlvbnMubWF4T3B0aW9uc1RleHQsIHRoYXQub3B0aW9ucy5tYXhPcHRpb25zVGV4dF0gOiB0aGF0Lm9wdGlvbnMubWF4T3B0aW9uc1RleHQsDQogICAgICAgICAgICAgICAgICAgICAgbWF4T3B0aW9uc0FyciA9IHR5cGVvZiBtYXhPcHRpb25zVGV4dCA9PT0gJ2Z1bmN0aW9uJyA/IG1heE9wdGlvbnNUZXh0KG1heE9wdGlvbnMsIG1heE9wdGlvbnNHcnApIDogbWF4T3B0aW9uc1RleHQsDQogICAgICAgICAgICAgICAgICAgICAgbWF4VHh0ID0gbWF4T3B0aW9uc0FyclswXS5yZXBsYWNlKCd7bn0nLCBtYXhPcHRpb25zKSwNCiAgICAgICAgICAgICAgICAgICAgICBtYXhUeHRHcnAgPSBtYXhPcHRpb25zQXJyWzFdLnJlcGxhY2UoJ3tufScsIG1heE9wdGlvbnNHcnApLA0KICAgICAgICAgICAgICAgICAgICAgICRub3RpZnkgPSAkKCc8ZGl2IGNsYXNzPSJub3RpZnkiPjwvZGl2PicpOw0KICAgICAgICAgICAgICAgICAgLy8gSWYge3Zhcn0gaXMgc2V0IGluIGFycmF5LCByZXBsYWNlIGl0DQogICAgICAgICAgICAgICAgICAvKiogQGRlcHJlY2F0ZWQgKi8NCiAgICAgICAgICAgICAgICAgIGlmIChtYXhPcHRpb25zQXJyWzJdKSB7DQogICAgICAgICAgICAgICAgICAgIG1heFR4dCA9IG1heFR4dC5yZXBsYWNlKCd7dmFyfScsIG1heE9wdGlvbnNBcnJbMl1bbWF4T3B0aW9ucyA+IDEgPyAwIDogMV0pOw0KICAgICAgICAgICAgICAgICAgICBtYXhUeHRHcnAgPSBtYXhUeHRHcnAucmVwbGFjZSgne3Zhcn0nLCBtYXhPcHRpb25zQXJyWzJdW21heE9wdGlvbnNHcnAgPiAxID8gMCA6IDFdKTsNCiAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgJG9wdGlvbi5wcm9wKCdzZWxlY3RlZCcsIGZhbHNlKTsNCg0KICAgICAgICAgICAgICAgICAgdGhhdC4kbWVudS5hcHBlbmQoJG5vdGlmeSk7DQoNCiAgICAgICAgICAgICAgICAgIGlmIChtYXhPcHRpb25zICYmIG1heFJlYWNoZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgJG5vdGlmeS5hcHBlbmQoJCgnPGRpdj4nICsgbWF4VHh0ICsgJzwvZGl2PicpKTsNCiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlckNoYW5nZSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB0aGF0LiRlbGVtZW50LnRyaWdnZXIoJ21heFJlYWNoZWQuYnMuc2VsZWN0Jyk7DQogICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgIGlmIChtYXhPcHRpb25zR3JwICYmIG1heFJlYWNoZWRHcnApIHsNCiAgICAgICAgICAgICAgICAgICAgJG5vdGlmeS5hcHBlbmQoJCgnPGRpdj4nICsgbWF4VHh0R3JwICsgJzwvZGl2PicpKTsNCiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlckNoYW5nZSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB0aGF0LiRlbGVtZW50LnRyaWdnZXIoJ21heFJlYWNoZWRHcnAuYnMuc2VsZWN0Jyk7DQogICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICB0aGF0LnNldFNlbGVjdGVkKGNsaWNrZWRJbmRleCwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgfSwgMTApOw0KDQogICAgICAgICAgICAgICAgICAkbm90aWZ5LmRlbGF5KDc1MCkuZmFkZU91dCgzMDAsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmUoKTsNCiAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KICAgICAgICAgIGlmICghdGhhdC5tdWx0aXBsZSB8fCAodGhhdC5tdWx0aXBsZSAmJiB0aGF0Lm9wdGlvbnMubWF4T3B0aW9ucyA9PT0gMSkpIHsNCiAgICAgICAgICAgIHRoYXQuJGJ1dHRvbi5mb2N1cygpOw0KICAgICAgICAgIH0gZWxzZSBpZiAodGhhdC5vcHRpb25zLmxpdmVTZWFyY2gpIHsNCiAgICAgICAgICAgIHRoYXQuJHNlYXJjaGJveC5mb2N1cygpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8vIFRyaWdnZXIgc2VsZWN0ICdjaGFuZ2UnDQogICAgICAgICAgaWYgKHRyaWdnZXJDaGFuZ2UpIHsNCiAgICAgICAgICAgIGlmICgocHJldlZhbHVlICE9IGdldFNlbGVjdFZhbHVlcyh0aGF0LiRlbGVtZW50WzBdKSAmJiB0aGF0Lm11bHRpcGxlKSB8fCAocHJldkluZGV4ICE9IHRoYXQuJGVsZW1lbnQucHJvcCgnc2VsZWN0ZWRJbmRleCcpICYmICF0aGF0Lm11bHRpcGxlKSkgew0KICAgICAgICAgICAgICAvLyAkb3B0aW9uLnByb3AoJ3NlbGVjdGVkJykgaXMgY3VycmVudCBvcHRpb24gc3RhdGUgKHNlbGVjdGVkL3Vuc2VsZWN0ZWQpLiBwcmV2VmFsdWUgaXMgdGhlIHZhbHVlIG9mIHRoZSBzZWxlY3QgcHJpb3IgdG8gYmVpbmcgY2hhbmdlZC4NCiAgICAgICAgICAgICAgY2hhbmdlZF9hcmd1bWVudHMgPSBbY2xpY2tlZEluZGV4LCAkb3B0aW9uLnByb3AoJ3NlbGVjdGVkJyksIHByZXZWYWx1ZV07DQogICAgICAgICAgICAgIHRoYXQuJGVsZW1lbnQNCiAgICAgICAgICAgICAgICAudHJpZ2dlck5hdGl2ZSgnY2hhbmdlJyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9KTsNCg0KICAgICAgdGhpcy4kbWVudS5vbignY2xpY2snLCAnbGkuJyArIGNsYXNzTmFtZXMuRElTQUJMRUQgKyAnIGEsIC4nICsgY2xhc3NOYW1lcy5QT1BPVkVSSEVBREVSICsgJywgLicgKyBjbGFzc05hbWVzLlBPUE9WRVJIRUFERVIgKyAnIDpub3QoLmNsb3NlKScsIGZ1bmN0aW9uIChlKSB7DQogICAgICAgIGlmIChlLmN1cnJlbnRUYXJnZXQgPT0gdGhpcykgew0KICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgIGlmICh0aGF0Lm9wdGlvbnMubGl2ZVNlYXJjaCAmJiAhJChlLnRhcmdldCkuaGFzQ2xhc3MoJ2Nsb3NlJykpIHsNCiAgICAgICAgICAgIHRoYXQuJHNlYXJjaGJveC5mb2N1cygpOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0aGF0LiRidXR0b24uZm9jdXMoKTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0pOw0KDQogICAgICB0aGlzLiRtZW51SW5uZXIub24oJ2NsaWNrJywgJy5kaXZpZGVyLCAuZHJvcGRvd24taGVhZGVyJywgZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICBpZiAodGhhdC5vcHRpb25zLmxpdmVTZWFyY2gpIHsNCiAgICAgICAgICB0aGF0LiRzZWFyY2hib3guZm9jdXMoKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGF0LiRidXR0b24uZm9jdXMoKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQoNCiAgICAgIHRoaXMuJG1lbnUub24oJ2NsaWNrJywgJy4nICsgY2xhc3NOYW1lcy5QT1BPVkVSSEVBREVSICsgJyAuY2xvc2UnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgIHRoYXQuJGJ1dHRvbi5jbGljaygpOw0KICAgICAgfSk7DQoNCiAgICAgIHRoaXMuJHNlYXJjaGJveC5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkgew0KICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgfSk7DQoNCiAgICAgIHRoaXMuJG1lbnUub24oJ2NsaWNrJywgJy5hY3Rpb25zLWJ0bicsIGZ1bmN0aW9uIChlKSB7DQogICAgICAgIGlmICh0aGF0Lm9wdGlvbnMubGl2ZVNlYXJjaCkgew0KICAgICAgICAgIHRoYXQuJHNlYXJjaGJveC5mb2N1cygpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRoYXQuJGJ1dHRvbi5mb2N1cygpOw0KICAgICAgICB9DQoNCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KDQogICAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKCdicy1zZWxlY3QtYWxsJykpIHsNCiAgICAgICAgICB0aGF0LnNlbGVjdEFsbCgpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRoYXQuZGVzZWxlY3RBbGwoKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQoNCiAgICAgIHRoaXMuJGVsZW1lbnQub24oew0KICAgICAgICAnY2hhbmdlJzogZnVuY3Rpb24gKCkgew0KICAgICAgICAgIHRoYXQucmVuZGVyKCk7DQogICAgICAgICAgdGhhdC4kZWxlbWVudC50cmlnZ2VyKCdjaGFuZ2VkLmJzLnNlbGVjdCcsIGNoYW5nZWRfYXJndW1lbnRzKTsNCiAgICAgICAgICBjaGFuZ2VkX2FyZ3VtZW50cyA9IG51bGw7DQogICAgICAgIH0sDQogICAgICAgICdmb2N1cyc6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICB0aGF0LiRidXR0b24uZm9jdXMoKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCg0KICAgIGxpdmVTZWFyY2hMaXN0ZW5lcjogZnVuY3Rpb24gKCkgew0KICAgICAgdmFyIHRoYXQgPSB0aGlzLA0KICAgICAgICAgIG5vX3Jlc3VsdHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpOw0KDQogICAgICB0aGlzLiRidXR0b24ub24oJ2NsaWNrLmJzLmRyb3Bkb3duLmRhdGEtYXBpJywgZnVuY3Rpb24gKCkgew0KICAgICAgICBpZiAoISF0aGF0LiRzZWFyY2hib3gudmFsKCkpIHsNCiAgICAgICAgICB0aGF0LiRzZWFyY2hib3gudmFsKCcnKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQoNCiAgICAgIHRoaXMuJHNlYXJjaGJveC5vbignY2xpY2suYnMuZHJvcGRvd24uZGF0YS1hcGkgZm9jdXMuYnMuZHJvcGRvd24uZGF0YS1hcGkgdG91Y2hlbmQuYnMuZHJvcGRvd24uZGF0YS1hcGknLCBmdW5jdGlvbiAoZSkgew0KICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgfSk7DQoNCiAgICAgIHRoaXMuJHNlYXJjaGJveC5vbignaW5wdXQgcHJvcGVydHljaGFuZ2UnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciBzZWFyY2hWYWx1ZSA9IHRoYXQuJHNlYXJjaGJveC52YWwoKTsNCiAgICAgICAgDQogICAgICAgIHRoYXQuc2VsZWN0cGlja2VyLnNlYXJjaC5tYXAubmV3SW5kZXggPSB7fTsNCiAgICAgICAgdGhhdC5zZWxlY3RwaWNrZXIuc2VhcmNoLm1hcC5vcmlnaW5hbEluZGV4ID0ge307DQogICAgICAgIHRoYXQuc2VsZWN0cGlja2VyLnNlYXJjaC5lbGVtZW50cyA9IFtdOw0KICAgICAgICB0aGF0LnNlbGVjdHBpY2tlci5zZWFyY2guZGF0YSA9IFtdOw0KDQogICAgICAgIGlmIChzZWFyY2hWYWx1ZSkgew0KICAgICAgICAgIHZhciBpLA0KICAgICAgICAgICAgICBzZWFyY2hNYXRjaCA9IFtdLA0KICAgICAgICAgICAgICBxID0gc2VhcmNoVmFsdWUudG9VcHBlckNhc2UoKSwNCiAgICAgICAgICAgICAgY2FjaGUgPSB7fSwNCiAgICAgICAgICAgICAgY2FjaGVBcnIgPSBbXSwNCiAgICAgICAgICAgICAgc2VhcmNoU3R5bGUgPSB0aGF0Ll9zZWFyY2hTdHlsZSgpLA0KICAgICAgICAgICAgICBub3JtYWxpemVTZWFyY2ggPSB0aGF0Lm9wdGlvbnMubGl2ZVNlYXJjaE5vcm1hbGl6ZTsNCg0KICAgICAgICAgIHRoYXQuXyRsaXNTZWxlY3RlZCA9IHRoYXQuJG1lbnVJbm5lci5maW5kKCcuc2VsZWN0ZWQnKTsNCg0KICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhhdC5zZWxlY3RwaWNrZXIubWFpbi5kYXRhLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICB2YXIgbGkgPSB0aGF0LnNlbGVjdHBpY2tlci5tYWluLmRhdGFbaV07DQoNCiAgICAgICAgICAgIGlmICghY2FjaGVbaV0pIHsNCiAgICAgICAgICAgICAgY2FjaGVbaV0gPSBzdHJpbmdTZWFyY2gobGksIHEsIHNlYXJjaFN0eWxlLCBub3JtYWxpemVTZWFyY2gpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoY2FjaGVbaV0gJiYgbGkuaGVhZGVySW5kZXggIT09IHVuZGVmaW5lZCAmJiBjYWNoZUFyci5pbmRleE9mKGxpLmhlYWRlckluZGV4KSA9PT0gLTEpIHsNCiAgICAgICAgICAgICAgaWYgKGxpLmhlYWRlckluZGV4ID4gMCkgew0KICAgICAgICAgICAgICAgIGNhY2hlW2xpLmhlYWRlckluZGV4IC0gMV0gPSB0cnVlOw0KICAgICAgICAgICAgICAgIGNhY2hlQXJyLnB1c2gobGkuaGVhZGVySW5kZXggLSAxKTsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIGNhY2hlW2xpLmhlYWRlckluZGV4XSA9IHRydWU7DQogICAgICAgICAgICAgIGNhY2hlQXJyLnB1c2gobGkuaGVhZGVySW5kZXgpOw0KICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgY2FjaGVbbGkubGFzdEluZGV4ICsgMV0gPSB0cnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoY2FjaGVbaV0gJiYgbGkudHlwZSAhPT0gJ29wdGdyb3VwLWxhYmVsJykgY2FjaGVBcnIucHVzaChpKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgY2FjaGVMZW4gPSBjYWNoZUFyci5sZW5ndGg7IGkgPCBjYWNoZUxlbjsgaSsrKSB7DQogICAgICAgICAgICB2YXIgaW5kZXggPSBjYWNoZUFycltpXSwNCiAgICAgICAgICAgICAgICBwcmV2SW5kZXggPSBjYWNoZUFycltpIC0gMV0sDQogICAgICAgICAgICAgICAgbGkgPSB0aGF0LnNlbGVjdHBpY2tlci5tYWluLmRhdGFbaW5kZXhdLA0KICAgICAgICAgICAgICAgIGxpUHJldiA9IHRoYXQuc2VsZWN0cGlja2VyLm1haW4uZGF0YVtwcmV2SW5kZXhdOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKCBsaS50eXBlICE9PSAnZGl2aWRlcicgfHwgKCBsaS50eXBlID09PSAnZGl2aWRlcicgJiYgbGlQcmV2ICYmIGxpUHJldi50eXBlICE9PSAnZGl2aWRlcicgJiYgY2FjaGVMZW4gLSAxICE9PSBpICkgKSB7DQogICAgICAgICAgICAgIHRoYXQuc2VsZWN0cGlja2VyLnNlYXJjaC5kYXRhLnB1c2gobGkpOw0KICAgICAgICAgICAgICBzZWFyY2hNYXRjaC5wdXNoKHRoYXQuc2VsZWN0cGlja2VyLm1haW4uZWxlbWVudHNbaW5kZXhdKTsNCiAgICAgICAgICAgICAgdGhhdC5zZWxlY3RwaWNrZXIuc2VhcmNoLm1hcC5uZXdJbmRleFtsaS5vcmlnaW5hbEluZGV4XSA9IHNlYXJjaE1hdGNoLmxlbmd0aCAtIDE7DQogICAgICAgICAgICAgIHRoYXQuc2VsZWN0cGlja2VyLnNlYXJjaC5tYXAub3JpZ2luYWxJbmRleFtzZWFyY2hNYXRjaC5sZW5ndGggLSAxXSA9IGxpLm9yaWdpbmFsSW5kZXg7DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KDQogICAgICAgICAgdGhhdC5hY3RpdmVJbmRleCA9IHVuZGVmaW5lZDsNCiAgICAgICAgICB0aGF0Lm5vU2Nyb2xsID0gdHJ1ZTsNCiAgICAgICAgICB0aGF0LiRtZW51SW5uZXIuc2Nyb2xsVG9wKDApOw0KICAgICAgICAgIHRoYXQuc2VsZWN0cGlja2VyLnNlYXJjaC5lbGVtZW50cyA9IHNlYXJjaE1hdGNoOw0KICAgICAgICAgIHRoYXQuY3JlYXRlVmlldyh0cnVlKTsNCg0KICAgICAgICAgIGlmICghc2VhcmNoTWF0Y2gubGVuZ3RoKSB7DQogICAgICAgICAgICBub19yZXN1bHRzLmNsYXNzTmFtZSA9ICduby1yZXN1bHRzJzsNCiAgICAgICAgICAgIG5vX3Jlc3VsdHMuaW5uZXJIVE1MID0gdGhhdC5vcHRpb25zLm5vbmVSZXN1bHRzVGV4dC5yZXBsYWNlKCd7MH0nLCAnIicgKyBodG1sRXNjYXBlKHNlYXJjaFZhbHVlKSArICciJyk7DQogICAgICAgICAgICB0aGF0LiRtZW51SW5uZXJbMF0uZmlyc3RDaGlsZC5hcHBlbmRDaGlsZChub19yZXN1bHRzKTsNCiAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdGhhdC4kbWVudUlubmVyLnNjcm9sbFRvcCgwKTsNCiAgICAgICAgICB0aGF0LmNyZWF0ZVZpZXcoZmFsc2UpOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9LA0KDQogICAgX3NlYXJjaFN0eWxlOiBmdW5jdGlvbiAoKSB7DQogICAgICByZXR1cm4gdGhpcy5vcHRpb25zLmxpdmVTZWFyY2hTdHlsZSB8fCAnY29udGFpbnMnOw0KICAgIH0sDQoNCiAgICB2YWw6IGZ1bmN0aW9uICh2YWx1ZSkgew0KICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3VuZGVmaW5lZCcpIHsNCiAgICAgICAgdGhpcy4kZWxlbWVudA0KICAgICAgICAgIC52YWwodmFsdWUpDQogICAgICAgICAgLnRyaWdnZXJOYXRpdmUoJ2NoYW5nZScpOw0KDQogICAgICAgIHJldHVybiB0aGlzLiRlbGVtZW50Ow0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuJGVsZW1lbnQudmFsKCk7DQogICAgICB9DQogICAgfSwNCg0KICAgIGNoYW5nZUFsbDogZnVuY3Rpb24gKHN0YXR1cykgew0KICAgICAgaWYgKCF0aGlzLm11bHRpcGxlKSByZXR1cm47DQogICAgICBpZiAodHlwZW9mIHN0YXR1cyA9PT0gJ3VuZGVmaW5lZCcpIHN0YXR1cyA9IHRydWU7DQoNCiAgICAgIHZhciAkc2VsZWN0T3B0aW9ucyA9IHRoaXMuJGVsZW1lbnQuZmluZCgnb3B0aW9uJyksDQogICAgICAgICAgcHJldmlvdXNTZWxlY3RlZCA9IDAsDQogICAgICAgICAgY3VycmVudFNlbGVjdGVkID0gMCwNCiAgICAgICAgICBwcmV2VmFsdWUgPSBnZXRTZWxlY3RWYWx1ZXModGhpcy4kZWxlbWVudFswXSk7DQoNCiAgICAgIHRoaXMuJGVsZW1lbnQuYWRkQ2xhc3MoJ2JzLXNlbGVjdC1oaWRkZW4nKTsNCg0KICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnNlbGVjdHBpY2tlci5jdXJyZW50LmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgIHZhciBpbmRleCA9IHRoaXMuc2VsZWN0cGlja2VyLmN1cnJlbnQubWFwLm9yaWdpbmFsSW5kZXhbaV0sIC8vIGZhc3RlciB0aGFuICQobGkpLmRhdGEoJ29yaWdpbmFsSW5kZXgnKQ0KICAgICAgICAgICAgb3B0aW9uID0gJHNlbGVjdE9wdGlvbnNbaW5kZXhdOw0KDQogICAgICAgIGlmIChvcHRpb24pIHsNCiAgICAgICAgICBpZiAob3B0aW9uLnNlbGVjdGVkKSBwcmV2aW91c1NlbGVjdGVkKys7DQogICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gc3RhdHVzOw0KICAgICAgICAgIGlmIChvcHRpb24uc2VsZWN0ZWQpIGN1cnJlbnRTZWxlY3RlZCsrOw0KICAgICAgICB9DQogICAgICB9DQoNCiAgICAgIHRoaXMuJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ2JzLXNlbGVjdC1oaWRkZW4nKTsNCg0KICAgICAgaWYgKHByZXZpb3VzU2VsZWN0ZWQgPT09IGN1cnJlbnRTZWxlY3RlZCkgcmV0dXJuOw0KDQogICAgICB0aGlzLnNldE9wdGlvblN0YXR1cygpOw0KDQogICAgICB0aGlzLnRvZ2dsZVBsYWNlaG9sZGVyKCk7DQoNCiAgICAgIGNoYW5nZWRfYXJndW1lbnRzID0gW251bGwsIG51bGwsIHByZXZWYWx1ZV07DQoNCiAgICAgIHRoaXMuJGVsZW1lbnQNCiAgICAgICAgLnRyaWdnZXJOYXRpdmUoJ2NoYW5nZScpOw0KICAgIH0sDQoNCiAgICBzZWxlY3RBbGw6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHJldHVybiB0aGlzLmNoYW5nZUFsbCh0cnVlKTsNCiAgICB9LA0KDQogICAgZGVzZWxlY3RBbGw6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHJldHVybiB0aGlzLmNoYW5nZUFsbChmYWxzZSk7DQogICAgfSwNCg0KICAgIHRvZ2dsZTogZnVuY3Rpb24gKGUpIHsNCiAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsNCg0KICAgICAgaWYgKGUpIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQoNCiAgICAgIHRoaXMuJGJ1dHRvbi50cmlnZ2VyKCdjbGljay5icy5kcm9wZG93bi5kYXRhLWFwaScpOw0KICAgIH0sDQoNCiAgICBrZXlkb3duOiBmdW5jdGlvbiAoZSkgew0KICAgICAgdmFyICR0aGlzID0gJCh0aGlzKSwNCiAgICAgICAgICAkcGFyZW50ID0gJHRoaXMuaXMoJ2lucHV0JykgPyAkdGhpcy5wYXJlbnQoKS5wYXJlbnQoKSA6ICR0aGlzLnBhcmVudCgpLA0KICAgICAgICAgIHRoYXQgPSAkcGFyZW50LmRhdGEoJ3RoaXMnKSwNCiAgICAgICAgICAkaXRlbXMgPSB0aGF0LmZpbmRMaXMoKSwNCiAgICAgICAgICBpbmRleCwNCiAgICAgICAgICBpc0FjdGl2ZSwNCiAgICAgICAgICBsaUFjdGl2ZSwNCiAgICAgICAgICBhY3RpdmVMaSwNCiAgICAgICAgICBvZmZzZXQsDQogICAgICAgICAgdXBkYXRlU2Nyb2xsID0gZmFsc2UsDQogICAgICAgICAgZG93bk9uVGFiID0gZS53aGljaCA9PT0ga2V5Q29kZXMuVEFCICYmICEkdGhpcy5oYXNDbGFzcygnZHJvcGRvd24tdG9nZ2xlJykgJiYgIXRoYXQub3B0aW9ucy5zZWxlY3RPblRhYiwNCiAgICAgICAgICBpc0Fycm93S2V5ID0gUkVHRVhQX0FSUk9XLnRlc3QoZS53aGljaCkgfHwgZG93bk9uVGFiLA0KICAgICAgICAgIHNjcm9sbFRvcCA9IHRoYXQuJG1lbnVJbm5lclswXS5zY3JvbGxUb3AsDQogICAgICAgICAgaXNWaXJ0dWFsID0gdGhhdC5pc1ZpcnR1YWwoKSwNCiAgICAgICAgICBwb3NpdGlvbjAgPSBpc1ZpcnR1YWwgPT09IHRydWUgPyB0aGF0LnNlbGVjdHBpY2tlci52aWV3LnBvc2l0aW9uMCA6IDA7DQoNCiAgICAgIGlzQWN0aXZlID0gdGhhdC4kbmV3RWxlbWVudC5oYXNDbGFzcyhjbGFzc05hbWVzLlNIT1cpOw0KDQogICAgICBpZiAoDQogICAgICAgICFpc0FjdGl2ZSAmJg0KICAgICAgICAoDQogICAgICAgICAgaXNBcnJvd0tleSB8fA0KICAgICAgICAgIGUud2hpY2ggPj0gNDggJiYgZS53aGljaCA8PSA1NyB8fA0KICAgICAgICAgIGUud2hpY2ggPj0gOTYgJiYgZS53aGljaCA8PSAxMDUgfHwNCiAgICAgICAgICBlLndoaWNoID49IDY1ICYmIGUud2hpY2ggPD0gOTANCiAgICAgICAgKQ0KICAgICAgKSB7DQogICAgICAgIHRoYXQuJGJ1dHRvbi50cmlnZ2VyKCdjbGljay5icy5kcm9wZG93bi5kYXRhLWFwaScpOw0KICAgICAgfQ0KDQogICAgICBpZiAoZS53aGljaCA9PT0ga2V5Q29kZXMuRVNDQVBFICYmIGlzQWN0aXZlKSB7DQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgdGhhdC4kYnV0dG9uLnRyaWdnZXIoJ2NsaWNrLmJzLmRyb3Bkb3duLmRhdGEtYXBpJykuZm9jdXMoKTsNCiAgICAgIH0NCg0KICAgICAgaWYgKGlzQXJyb3dLZXkpIHsgLy8gaWYgdXAgb3IgZG93bg0KICAgICAgICBpZiAoISRpdGVtcy5sZW5ndGgpIHJldHVybjsNCg0KICAgICAgICAvLyAkaXRlbXMuaW5kZXgvLmZpbHRlciBpcyB0b28gc2xvdyB3aXRoIGEgbGFyZ2UgbGlzdCBhbmQgbm8gdmlydHVhbCBzY3JvbGwNCiAgICAgICAgaW5kZXggPSBpc1ZpcnR1YWwgPT09IHRydWUgPyAkaXRlbXMuaW5kZXgoJGl0ZW1zLmZpbHRlcignLmFjdGl2ZScpKSA6IHRoYXQuc2VsZWN0cGlja2VyLmN1cnJlbnQubWFwLm5ld0luZGV4W3RoYXQuYWN0aXZlSW5kZXhdOw0KDQogICAgICAgIGlmIChpbmRleCA9PT0gdW5kZWZpbmVkKSBpbmRleCA9IC0xOw0KDQogICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsNCiAgICAgICAgICBsaUFjdGl2ZSA9IHRoYXQuc2VsZWN0cGlja2VyLmN1cnJlbnQuZWxlbWVudHNbaW5kZXggKyBwb3NpdGlvbjBdOw0KICAgICAgICAgIGxpQWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOw0KICAgICAgICAgIGlmIChsaUFjdGl2ZS5maXJzdENoaWxkKSBsaUFjdGl2ZS5maXJzdENoaWxkLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGUud2hpY2ggPT09IGtleUNvZGVzLkFSUk9XX1VQKSB7IC8vIHVwDQogICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkgaW5kZXgtLTsNCiAgICAgICAgICBpZiAoaW5kZXggKyBwb3NpdGlvbjAgPCAwKSBpbmRleCArPSAkaXRlbXMubGVuZ3RoOw0KDQogICAgICAgICAgaWYgKCF0aGF0LnNlbGVjdHBpY2tlci52aWV3LmNhbkhpZ2hsaWdodFtpbmRleCArIHBvc2l0aW9uMF0pIHsNCiAgICAgICAgICAgIGluZGV4ID0gdGhhdC5zZWxlY3RwaWNrZXIudmlldy5jYW5IaWdobGlnaHQuc2xpY2UoMCwgaW5kZXggKyBwb3NpdGlvbjApLmxhc3RJbmRleE9mKHRydWUpIC0gcG9zaXRpb24wOw0KICAgICAgICAgICAgaWYgKGluZGV4ID09PSAtMSkgaW5kZXggPSAkaXRlbXMubGVuZ3RoIC0gMTsNCiAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSBpZiAoZS53aGljaCA9PT0ga2V5Q29kZXMuQVJST1dfRE9XTiB8fCBkb3duT25UYWIpIHsgLy8gZG93bg0KICAgICAgICAgIGluZGV4Kys7DQogICAgICAgICAgaWYgKGluZGV4ICsgcG9zaXRpb24wID49IHRoYXQuc2VsZWN0cGlja2VyLnZpZXcuY2FuSGlnaGxpZ2h0Lmxlbmd0aCkgaW5kZXggPSAwOw0KDQogICAgICAgICAgaWYgKCF0aGF0LnNlbGVjdHBpY2tlci52aWV3LmNhbkhpZ2hsaWdodFtpbmRleCArIHBvc2l0aW9uMF0pIHsNCiAgICAgICAgICAgIGluZGV4ID0gaW5kZXggKyAxICsgdGhhdC5zZWxlY3RwaWNrZXIudmlldy5jYW5IaWdobGlnaHQuc2xpY2UoaW5kZXggKyBwb3NpdGlvbjAgKyAxKS5pbmRleE9mKHRydWUpOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCg0KICAgICAgICB2YXIgbGlBY3RpdmVJbmRleCA9IHBvc2l0aW9uMCArIGluZGV4Ow0KDQogICAgICAgIGlmIChlLndoaWNoID09PSBrZXlDb2Rlcy5BUlJPV19VUCkgeyAvLyB1cA0KICAgICAgICAgIC8vIHNjcm9sbCB0byBib3R0b20gYW5kIGhpZ2hsaWdodCBsYXN0IG9wdGlvbg0KICAgICAgICAgIGlmIChwb3NpdGlvbjAgPT09IDAgJiYgaW5kZXggPT09ICRpdGVtcy5sZW5ndGggLSAxKSB7DQogICAgICAgICAgICB0aGF0LiRtZW51SW5uZXJbMF0uc2Nyb2xsVG9wID0gdGhhdC4kbWVudUlubmVyWzBdLnNjcm9sbEhlaWdodDsNCg0KICAgICAgICAgICAgbGlBY3RpdmVJbmRleCA9IHRoYXQuc2VsZWN0cGlja2VyLmN1cnJlbnQuZWxlbWVudHMubGVuZ3RoIC0gMTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgYWN0aXZlTGkgPSB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50LmRhdGFbbGlBY3RpdmVJbmRleF07DQogICAgICAgICAgICBvZmZzZXQgPSBhY3RpdmVMaS5wb3NpdGlvbiAtIGFjdGl2ZUxpLmhlaWdodDsNCg0KICAgICAgICAgICAgdXBkYXRlU2Nyb2xsID0gb2Zmc2V0IDwgc2Nyb2xsVG9wOw0KICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIGlmIChlLndoaWNoID09PSBrZXlDb2Rlcy5BUlJPV19ET1dOIHx8IGRvd25PblRhYikgeyAvLyBkb3duDQogICAgICAgICAgLy8gc2Nyb2xsIHRvIHRvcCBhbmQgaGlnaGxpZ2h0IGZpcnN0IG9wdGlvbg0KICAgICAgICAgIGlmIChwb3NpdGlvbjAgIT09IDAgJiYgaW5kZXggPT09IDApIHsNCiAgICAgICAgICAgIHRoYXQuJG1lbnVJbm5lclswXS5zY3JvbGxUb3AgPSAwOw0KDQogICAgICAgICAgICBsaUFjdGl2ZUluZGV4ID0gMDsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgYWN0aXZlTGkgPSB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50LmRhdGFbbGlBY3RpdmVJbmRleF07DQogICAgICAgICAgICBvZmZzZXQgPSBhY3RpdmVMaS5wb3NpdGlvbiAtIHRoYXQuc2l6ZUluZm8ubWVudUlubmVySGVpZ2h0Ow0KDQogICAgICAgICAgICB1cGRhdGVTY3JvbGwgPSBvZmZzZXQgPiBzY3JvbGxUb3A7DQogICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgbGlBY3RpdmUgPSB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50LmVsZW1lbnRzW2xpQWN0aXZlSW5kZXhdOw0KICAgICAgICBsaUFjdGl2ZS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsNCiAgICAgICAgaWYgKGxpQWN0aXZlLmZpcnN0Q2hpbGQpIGxpQWN0aXZlLmZpcnN0Q2hpbGQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7DQogICAgICAgIHRoYXQuYWN0aXZlSW5kZXggPSB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50Lm1hcC5vcmlnaW5hbEluZGV4W2xpQWN0aXZlSW5kZXhdOw0KDQogICAgICAgIHRoYXQuc2VsZWN0cGlja2VyLnZpZXcuY3VycmVudEFjdGl2ZSA9IGxpQWN0aXZlOw0KDQogICAgICAgIGlmICh1cGRhdGVTY3JvbGwpIHRoYXQuJG1lbnVJbm5lclswXS5zY3JvbGxUb3AgPSBvZmZzZXQ7DQoNCiAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5saXZlU2VhcmNoKSB7DQogICAgICAgICAgdGhhdC4kc2VhcmNoYm94LmZvY3VzKCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgJHRoaXMuZm9jdXMoKTsNCiAgICAgICAgfQ0KICAgICAgfSBlbHNlIGlmICgNCiAgICAgICAgISR0aGlzLmlzKCdpbnB1dCcpICYmDQogICAgICAgICFSRUdFWFBfVEFCX09SX0VTQ0FQRS50ZXN0KGUud2hpY2gpIHx8DQogICAgICAgIChlLndoaWNoID09PSBrZXlDb2Rlcy5TUEFDRSAmJiB0aGF0LnNlbGVjdHBpY2tlci5rZXlkb3duLmtleUhpc3RvcnkpDQogICAgICApIHsNCiAgICAgICAgdmFyIHNlYXJjaE1hdGNoLA0KICAgICAgICAgICAgbWF0Y2hlcyA9IFtdLA0KICAgICAgICAgICAga2V5SGlzdG9yeTsNCg0KICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQoNCiAgICAgICAgdGhhdC5zZWxlY3RwaWNrZXIua2V5ZG93bi5rZXlIaXN0b3J5ICs9IGtleUNvZGVNYXBbZS53aGljaF07DQoNCiAgICAgICAgaWYgKHRoYXQuc2VsZWN0cGlja2VyLmtleWRvd24ucmVzZXRLZXlIaXN0b3J5LmNhbmNlbCkgY2xlYXJUaW1lb3V0KHRoYXQuc2VsZWN0cGlja2VyLmtleWRvd24ucmVzZXRLZXlIaXN0b3J5LmNhbmNlbCk7DQogICAgICAgIHRoYXQuc2VsZWN0cGlja2VyLmtleWRvd24ucmVzZXRLZXlIaXN0b3J5LmNhbmNlbCA9IHRoYXQuc2VsZWN0cGlja2VyLmtleWRvd24ucmVzZXRLZXlIaXN0b3J5LnN0YXJ0KCk7DQoNCiAgICAgICAga2V5SGlzdG9yeSA9IHRoYXQuc2VsZWN0cGlja2VyLmtleWRvd24ua2V5SGlzdG9yeTsNCg0KICAgICAgICAvLyBpZiBhbGwgbGV0dGVycyBhcmUgdGhlIHNhbWUsIHNldCBrZXlIaXN0b3J5IHRvIGp1c3QgdGhlIGZpcnN0IGNoYXJhY3RlciB3aGVuIHNlYXJjaGluZw0KICAgICAgICBpZiAoL14oLilcMSskLy50ZXN0KGtleUhpc3RvcnkpKSB7DQogICAgICAgICAga2V5SGlzdG9yeSA9IGtleUhpc3RvcnkuY2hhckF0KDApOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gZmluZCBtYXRjaGVzDQogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5kYXRhLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgdmFyIGxpID0gdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5kYXRhW2ldLA0KICAgICAgICAgICAgICBoYXNNYXRjaDsNCg0KICAgICAgICAgIGhhc01hdGNoID0gc3RyaW5nU2VhcmNoKGxpLCBrZXlIaXN0b3J5LCAnc3RhcnRzV2l0aCcsIHRydWUpOw0KDQogICAgICAgICAgaWYgKGhhc01hdGNoICYmIHRoYXQuc2VsZWN0cGlja2VyLnZpZXcuY2FuSGlnaGxpZ2h0W2ldKSB7DQogICAgICAgICAgICBsaS5pbmRleCA9IGk7DQogICAgICAgICAgICBtYXRjaGVzLnB1c2gobGkub3JpZ2luYWxJbmRleCk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKG1hdGNoZXMubGVuZ3RoKSB7DQogICAgICAgICAgdmFyIG1hdGNoSW5kZXggPSAwOw0KDQogICAgICAgICAgJGl0ZW1zLnJlbW92ZUNsYXNzKCdhY3RpdmUnKS5maW5kKCdhJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpOw0KDQogICAgICAgICAgLy8gZWl0aGVyIG9ubHkgb25lIGtleSBoYXMgYmVlbiBwcmVzc2VkIG9yIHRoZXkgYXJlIGFsbCB0aGUgc2FtZSBrZXkNCiAgICAgICAgICBpZiAoa2V5SGlzdG9yeS5sZW5ndGggPT09IDEpIHsNCiAgICAgICAgICAgIG1hdGNoSW5kZXggPSBtYXRjaGVzLmluZGV4T2YodGhhdC5hY3RpdmVJbmRleCk7DQoNCiAgICAgICAgICAgIGlmIChtYXRjaEluZGV4ID09PSAtMSB8fCBtYXRjaEluZGV4ID09PSBtYXRjaGVzLmxlbmd0aCAtIDEpIHsNCiAgICAgICAgICAgICAgbWF0Y2hJbmRleCA9IDA7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICBtYXRjaEluZGV4Kys7DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KDQogICAgICAgICAgc2VhcmNoTWF0Y2ggPSB0aGF0LnNlbGVjdHBpY2tlci5jdXJyZW50Lm1hcC5uZXdJbmRleFttYXRjaGVzW21hdGNoSW5kZXhdXTsNCg0KICAgICAgICAgIGFjdGl2ZUxpID0gdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5kYXRhW3NlYXJjaE1hdGNoXTsNCg0KICAgICAgICAgIGlmIChzY3JvbGxUb3AgLSBhY3RpdmVMaS5wb3NpdGlvbiA+IDApIHsNCiAgICAgICAgICAgIG9mZnNldCA9IGFjdGl2ZUxpLnBvc2l0aW9uIC0gYWN0aXZlTGkuaGVpZ2h0Ow0KICAgICAgICAgICAgdXBkYXRlU2Nyb2xsID0gdHJ1ZTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgb2Zmc2V0ID0gYWN0aXZlTGkucG9zaXRpb24gLSB0aGF0LnNpemVJbmZvLm1lbnVJbm5lckhlaWdodDsNCiAgICAgICAgICAgIC8vIGlmIHRoZSBvcHRpb24gaXMgYWxyZWFkeSB2aXNpYmxlIGF0IHRoZSBjdXJyZW50IHNjcm9sbCBwb3NpdGlvbiwganVzdCBrZWVwIGl0IHRoZSBzYW1lDQogICAgICAgICAgICB1cGRhdGVTY3JvbGwgPSBhY3RpdmVMaS5wb3NpdGlvbiA+IHNjcm9sbFRvcCArIHRoYXQuc2l6ZUluZm8ubWVudUlubmVySGVpZ2h0OyAgICAgICAgIA0KICAgICAgICAgIH0NCg0KICAgICAgICAgIGxpQWN0aXZlID0gdGhhdC5zZWxlY3RwaWNrZXIuY3VycmVudC5lbGVtZW50c1tzZWFyY2hNYXRjaF07DQogICAgICAgICAgbGlBY3RpdmUuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7DQogICAgICAgICAgaWYgKGxpQWN0aXZlLmZpcnN0Q2hpbGQpIGxpQWN0aXZlLmZpcnN0Q2hpbGQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7DQogICAgICAgICAgdGhhdC5hY3RpdmVJbmRleCA9IG1hdGNoZXNbbWF0Y2hJbmRleF07DQoNCiAgICAgICAgICBsaUFjdGl2ZS5maXJzdENoaWxkLmZvY3VzKCk7DQoNCiAgICAgICAgICBpZiAodXBkYXRlU2Nyb2xsKSB0aGF0LiRtZW51SW5uZXJbMF0uc2Nyb2xsVG9wID0gb2Zmc2V0Ow0KDQogICAgICAgICAgJHRoaXMuZm9jdXMoKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KDQogICAgICAvLyBTZWxlY3QgZm9jdXNlZCBvcHRpb24gaWYgIkVudGVyIiwgIlNwYWNlYmFyIiBvciAiVGFiIiAod2hlbiBzZWxlY3RPblRhYiBpcyB0cnVlKSBhcmUgcHJlc3NlZCBpbnNpZGUgdGhlIG1lbnUuDQogICAgICBpZiAoDQogICAgICAgIGlzQWN0aXZlICYmDQogICAgICAgICgNCiAgICAgICAgICAoZS53aGljaCA9PT0ga2V5Q29kZXMuU1BBQ0UgJiYgIXRoYXQuc2VsZWN0cGlja2VyLmtleWRvd24ua2V5SGlzdG9yeSkgfHwNCiAgICAgICAgICBlLndoaWNoID09PSBrZXlDb2Rlcy5FTlRFUiB8fA0KICAgICAgICAgIChlLndoaWNoID09PSBrZXlDb2Rlcy5UQUIgJiYgdGhhdC5vcHRpb25zLnNlbGVjdE9uVGFiKQ0KICAgICAgICApDQogICAgICApIHsNCiAgICAgICAgaWYgKGUud2hpY2ggIT09IGtleUNvZGVzLlNQQUNFKSBlLnByZXZlbnREZWZhdWx0KCk7DQoNCiAgICAgICAgaWYgKCF0aGF0Lm9wdGlvbnMubGl2ZVNlYXJjaCB8fCBlLndoaWNoICE9PSBrZXlDb2Rlcy5TUEFDRSkgew0KICAgICAgICAgIHRoYXQuJG1lbnVJbm5lci5maW5kKCcuYWN0aXZlIGEnKS50cmlnZ2VyKCdjbGljaycsIHRydWUpOyAvLyByZXRhaW4gYWN0aXZlIGNsYXNzDQogICAgICAgICAgJHRoaXMuZm9jdXMoKTsNCg0KICAgICAgICAgIGlmICghdGhhdC5vcHRpb25zLmxpdmVTZWFyY2gpIHsNCiAgICAgICAgICAgIC8vIFByZXZlbnQgc2NyZWVuIGZyb20gc2Nyb2xsaW5nIGlmIHRoZSB1c2VyIGhpdHMgdGhlIHNwYWNlYmFyDQogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAvLyBGaXhlcyBzcGFjZWJhciBzZWxlY3Rpb24gb2YgZHJvcGRvd24gaXRlbXMgaW4gRkYgJiBJRQ0KICAgICAgICAgICAgJChkb2N1bWVudCkuZGF0YSgnc3BhY2VTZWxlY3QnLCB0cnVlKTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9LA0KDQogICAgbW9iaWxlOiBmdW5jdGlvbiAoKSB7DQogICAgICB0aGlzLiRlbGVtZW50LmFkZENsYXNzKCdtb2JpbGUtZGV2aWNlJyk7DQogICAgfSwNCg0KICAgIHJlZnJlc2g6IGZ1bmN0aW9uICgpIHsNCiAgICAgIC8vIHVwZGF0ZSBvcHRpb25zIGlmIGRhdGEgYXR0cmlidXRlcyBoYXZlIGJlZW4gY2hhbmdlZA0KICAgICAgdmFyIGNvbmZpZyA9ICQuZXh0ZW5kKHt9LCB0aGlzLm9wdGlvbnMsIHRoaXMuJGVsZW1lbnQuZGF0YSgpKTsNCiAgICAgIHRoaXMub3B0aW9ucyA9IGNvbmZpZzsNCg0KICAgICAgdGhpcy5zZWxlY3RwaWNrZXIubWFpbi5tYXAubmV3SW5kZXggPSB7fTsNCiAgICAgIHRoaXMuc2VsZWN0cGlja2VyLm1haW4ubWFwLm9yaWdpbmFsSW5kZXggPSB7fTsNCiAgICAgIHRoaXMuY3JlYXRlTGkoKTsNCiAgICAgIHRoaXMuY2hlY2tEaXNhYmxlZCgpOw0KICAgICAgdGhpcy5yZW5kZXIoKTsNCiAgICAgIHRoaXMuc2V0U3R5bGUoKTsNCiAgICAgIHRoaXMuc2V0V2lkdGgoKTsNCg0KICAgICAgdGhpcy5zZXRTaXplKHRydWUpOw0KDQogICAgICB0aGlzLiRlbGVtZW50LnRyaWdnZXIoJ3JlZnJlc2hlZC5icy5zZWxlY3QnKTsNCiAgICB9LA0KDQogICAgaGlkZTogZnVuY3Rpb24gKCkgew0KICAgICAgdGhpcy4kbmV3RWxlbWVudC5oaWRlKCk7DQogICAgfSwNCg0KICAgIHNob3c6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHRoaXMuJG5ld0VsZW1lbnQuc2hvdygpOw0KICAgIH0sDQoNCiAgICByZW1vdmU6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHRoaXMuJG5ld0VsZW1lbnQucmVtb3ZlKCk7DQogICAgICB0aGlzLiRlbGVtZW50LnJlbW92ZSgpOw0KICAgIH0sDQoNCiAgICBkZXN0cm95OiBmdW5jdGlvbiAoKSB7DQogICAgICB0aGlzLiRuZXdFbGVtZW50LmJlZm9yZSh0aGlzLiRlbGVtZW50KS5yZW1vdmUoKTsNCg0KICAgICAgaWYgKHRoaXMuJGJzQ29udGFpbmVyKSB7DQogICAgICAgIHRoaXMuJGJzQ29udGFpbmVyLnJlbW92ZSgpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy4kbWVudS5yZW1vdmUoKTsNCiAgICAgIH0NCg0KICAgICAgdGhpcy4kZWxlbWVudA0KICAgICAgICAub2ZmKCcuYnMuc2VsZWN0JykNCiAgICAgICAgLnJlbW92ZURhdGEoJ3NlbGVjdHBpY2tlcicpDQogICAgICAgIC5yZW1vdmVDbGFzcygnYnMtc2VsZWN0LWhpZGRlbiBzZWxlY3RwaWNrZXInKTsNCiAgICB9DQogIH07DQoNCiAgLy8gU0VMRUNUUElDS0VSIFBMVUdJTiBERUZJTklUSU9ODQogIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KICBmdW5jdGlvbiBQbHVnaW4ob3B0aW9uKSB7DQogICAgLy8gZ2V0IHRoZSBhcmdzIG9mIHRoZSBvdXRlciBmdW5jdGlvbi4uDQogICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7DQogICAgLy8gVGhlIGFyZ3VtZW50cyBvZiB0aGUgZnVuY3Rpb24gYXJlIGV4cGxpY2l0bHkgcmUtZGVmaW5lZCBmcm9tIHRoZSBhcmd1bWVudCBsaXN0LCBiZWNhdXNlIHRoZSBzaGlmdCBjYXVzZXMgdGhlbQ0KICAgIC8vIHRvIGdldCBsb3N0L2NvcnJ1cHRlZCBpbiBhbmRyb2lkIDIuMyBhbmQgSUU5ICM3MTUgIzc3NQ0KICAgIHZhciBfb3B0aW9uID0gb3B0aW9uOw0KDQogICAgW10uc2hpZnQuYXBwbHkoYXJncyk7DQoNCiAgICB2YXIgdmFsdWU7DQogICAgdmFyIGNoYWluID0gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsNCiAgICAgIHZhciAkdGhpcyA9ICQodGhpcyk7DQogICAgICBpZiAoJHRoaXMuaXMoJ3NlbGVjdCcpKSB7DQogICAgICAgIHZhciBkYXRhID0gJHRoaXMuZGF0YSgnc2VsZWN0cGlja2VyJyksDQogICAgICAgICAgICBvcHRpb25zID0gdHlwZW9mIF9vcHRpb24gPT0gJ29iamVjdCcgJiYgX29wdGlvbjsNCg0KICAgICAgICBpZiAoIWRhdGEpIHsNCiAgICAgICAgICB2YXIgY29uZmlnID0gJC5leHRlbmQoe30sIFNlbGVjdHBpY2tlci5ERUZBVUxUUywgJC5mbi5zZWxlY3RwaWNrZXIuZGVmYXVsdHMgfHwge30sICR0aGlzLmRhdGEoKSwgb3B0aW9ucyk7DQogICAgICAgICAgY29uZmlnLnRlbXBsYXRlID0gJC5leHRlbmQoe30sIFNlbGVjdHBpY2tlci5ERUZBVUxUUy50ZW1wbGF0ZSwgKCQuZm4uc2VsZWN0cGlja2VyLmRlZmF1bHRzID8gJC5mbi5zZWxlY3RwaWNrZXIuZGVmYXVsdHMudGVtcGxhdGUgOiB7fSksICR0aGlzLmRhdGEoKS50ZW1wbGF0ZSwgb3B0aW9ucy50ZW1wbGF0ZSk7DQogICAgICAgICAgJHRoaXMuZGF0YSgnc2VsZWN0cGlja2VyJywgKGRhdGEgPSBuZXcgU2VsZWN0cGlja2VyKHRoaXMsIGNvbmZpZykpKTsNCiAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zKSB7DQogICAgICAgICAgZm9yICh2YXIgaSBpbiBvcHRpb25zKSB7DQogICAgICAgICAgICBpZiAob3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShpKSkgew0KICAgICAgICAgICAgICBkYXRhLm9wdGlvbnNbaV0gPSBvcHRpb25zW2ldOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmICh0eXBlb2YgX29wdGlvbiA9PSAnc3RyaW5nJykgew0KICAgICAgICAgIGlmIChkYXRhW19vcHRpb25dIGluc3RhbmNlb2YgRnVuY3Rpb24pIHsNCiAgICAgICAgICAgIHZhbHVlID0gZGF0YVtfb3B0aW9uXS5hcHBseShkYXRhLCBhcmdzKTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdmFsdWUgPSBkYXRhLm9wdGlvbnNbX29wdGlvbl07DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9DQogICAgfSk7DQoNCiAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAndW5kZWZpbmVkJykgew0KICAgICAgLy9ub2luc3BlY3Rpb24gSlNVbnVzZWRBc3NpZ25tZW50DQogICAgICByZXR1cm4gdmFsdWU7DQogICAgfSBlbHNlIHsNCiAgICAgIHJldHVybiBjaGFpbjsNCiAgICB9DQogIH0NCg0KICB2YXIgb2xkID0gJC5mbi5zZWxlY3RwaWNrZXI7DQogICQuZm4uc2VsZWN0cGlja2VyID0gUGx1Z2luOw0KICAkLmZuLnNlbGVjdHBpY2tlci5Db25zdHJ1Y3RvciA9IFNlbGVjdHBpY2tlcjsNCg0KICAvLyBTRUxFQ1RQSUNLRVIgTk8gQ09ORkxJQ1QNCiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09DQogICQuZm4uc2VsZWN0cGlja2VyLm5vQ29uZmxpY3QgPSBmdW5jdGlvbiAoKSB7DQogICAgJC5mbi5zZWxlY3RwaWNrZXIgPSBvbGQ7DQogICAgcmV0dXJuIHRoaXM7DQogIH07DQoNCiAgJChkb2N1bWVudCkNCiAgICAgIC5vZmYoJ2tleWRvd24uYnMuZHJvcGRvd24uZGF0YS1hcGknKQ0KICAgICAgLm9uKCdrZXlkb3duLmJzLnNlbGVjdCcsICcuYm9vdHN0cmFwLXNlbGVjdCBbZGF0YS10b2dnbGU9ImRyb3Bkb3duIl0sIC5ib290c3RyYXAtc2VsZWN0IFtyb2xlPSJsaXN0Ym94Il0sIC5icy1zZWFyY2hib3ggaW5wdXQnLCBTZWxlY3RwaWNrZXIucHJvdG90eXBlLmtleWRvd24pDQogICAgICAub24oJ2ZvY3VzaW4ubW9kYWwnLCAnLmJvb3RzdHJhcC1zZWxlY3QgW2RhdGEtdG9nZ2xlPSJkcm9wZG93biJdLCAuYm9vdHN0cmFwLXNlbGVjdCBbcm9sZT0ibGlzdGJveCJdLCAuYnMtc2VhcmNoYm94IGlucHV0JywgZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgIH0pOw0KDQogIC8vIFNFTEVDVFBJQ0tFUiBEQVRBLUFQSQ0KICAvLyA9PT09PT09PT09PT09PT09PT09PT0NCiAgJCh3aW5kb3cpLm9uKCdsb2FkLmJzLnNlbGVjdC5kYXRhLWFwaScsIGZ1bmN0aW9uICgpIHsNCiAgICAkKCcuc2VsZWN0cGlja2VyJykuZWFjaChmdW5jdGlvbiAoKSB7DQogICAgICB2YXIgJHNlbGVjdHBpY2tlciA9ICQodGhpcyk7DQogICAgICBQbHVnaW4uY2FsbCgkc2VsZWN0cGlja2VyLCAkc2VsZWN0cGlja2VyLmRhdGEoKSk7DQogICAgfSkNCiAgfSk7DQp9KShqUXVlcnkpOw0KCgp9KSk7Cg0KLyoKICogYm9vdHN0cmFwLWZpbGVzdHlsZQogKiBkb2M6IGh0dHA6Ly9tYXJrdXNzbGltYS5naXRodWIuaW8vYm9vdHN0cmFwLWZpbGVzdHlsZS8KICogZ2l0aHViOiBodHRwczovL2dpdGh1Yi5jb20vbWFya3Vzc2xpbWEvYm9vdHN0cmFwLWZpbGVzdHlsZQogKgogKiBDb3B5cmlnaHQgKGMpIDIwMTcgTWFya3VzIFZpbmljaXVzIGRhIFNpbHZhIExpbWEKICogVmVyc2lvbiAyLjEuMAogKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuCiAqLwohZnVuY3Rpb24oZSl7InVzZSBzdHJpY3QiO3ZhciB0PTAsaT1mdW5jdGlvbih0LGkpe3RoaXMub3B0aW9ucz1pLHRoaXMuJGVsZW1lbnRGaWxlc3R5bGU9W10sdGhpcy4kZWxlbWVudD1lKHQpfTtpLnByb3RvdHlwZT17Y2xlYXI6ZnVuY3Rpb24oKXt0aGlzLiRlbGVtZW50LnZhbCgiIiksdGhpcy4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCI6dGV4dCIpLnZhbCgiIiksdGhpcy4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCIuYmFkZ2UiKS5yZW1vdmUoKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuJGVsZW1lbnQucmVtb3ZlQXR0cigic3R5bGUiKS5yZW1vdmVEYXRhKCJmaWxlc3R5bGUiKSx0aGlzLiRlbGVtZW50RmlsZXN0eWxlLnJlbW92ZSgpfSxkaXNhYmxlZDpmdW5jdGlvbihlKXtyZXR1cm4gZSE9PSEwJiZlIT09ITE/dGhpcy5vcHRpb25zLmRpc2FibGVkOih0aGlzLm9wdGlvbnMuZGlzYWJsZWQ9ZSx0aGlzLiRlbGVtZW50LnByb3AoImRpc2FibGVkIix0aGlzLm9wdGlvbnMuZGlzYWJsZWQpLHRoaXMuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgibGFiZWwiKS5wcm9wKCJkaXNhYmxlZCIsdGhpcy5vcHRpb25zLmRpc2FibGVkKSx0aGlzLm9wdGlvbnMuZGlzYWJsZWQ/dGhpcy4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCJsYWJlbCIpLmNzcygib3BhY2l0eSIsIjAuNjUiKTp0aGlzLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoImxhYmVsIikuY3NzKCJvcGFjaXR5IiwiMSIpLHZvaWQgMCl9LGRyYWdkcm9wOmZ1bmN0aW9uKGUpe3JldHVybiBlIT09ITAmJmUhPT0hMT90aGlzLm9wdGlvbnMuZHJhZ2Ryb3A6dm9pZCh0aGlzLm9wdGlvbnMuZHJhZ2Ryb3A9ZSl9LGJ1dHRvbkJlZm9yZTpmdW5jdGlvbihlKXtpZihlPT09ITApdGhpcy5vcHRpb25zLmJ1dHRvbkJlZm9yZXx8KHRoaXMub3B0aW9ucy5idXR0b25CZWZvcmU9ZSx0aGlzLm9wdGlvbnMuaW5wdXQmJih0aGlzLiRlbGVtZW50RmlsZXN0eWxlLnJlbW92ZSgpLHRoaXMuY29uc3RydWN0b3IoKSx0aGlzLnB1c2hOYW1lRmlsZXMoKSkpO2Vsc2V7aWYoZSE9PSExKXJldHVybiB0aGlzLm9wdGlvbnMuYnV0dG9uQmVmb3JlO3RoaXMub3B0aW9ucy5idXR0b25CZWZvcmUmJih0aGlzLm9wdGlvbnMuYnV0dG9uQmVmb3JlPWUsdGhpcy5vcHRpb25zLmlucHV0JiYodGhpcy4kZWxlbWVudEZpbGVzdHlsZS5yZW1vdmUoKSx0aGlzLmNvbnN0cnVjdG9yKCksdGhpcy5wdXNoTmFtZUZpbGVzKCkpKX19LGlucHV0OmZ1bmN0aW9uKGUpe2lmKGU9PT0hMCl0aGlzLm9wdGlvbnMuaW5wdXR8fCh0aGlzLm9wdGlvbnMuaW5wdXQ9ZSx0aGlzLm9wdGlvbnMuYnV0dG9uQmVmb3JlP3RoaXMuJGVsZW1lbnRGaWxlc3R5bGUuYXBwZW5kKHRoaXMuaHRtbElucHV0KCkpOnRoaXMuJGVsZW1lbnRGaWxlc3R5bGUucHJlcGVuZCh0aGlzLmh0bWxJbnB1dCgpKSx0aGlzLnB1c2hOYW1lRmlsZXMoKSx0aGlzLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoIi5ncm91cC1zcGFuLWZpbGVzdHlsZSIpLmFkZENsYXNzKCJpbnB1dC1ncm91cC1idG4iKSk7ZWxzZXtpZihlIT09ITEpcmV0dXJuIHRoaXMub3B0aW9ucy5pbnB1dDt0aGlzLm9wdGlvbnMuaW5wdXQmJih0aGlzLm9wdGlvbnMuaW5wdXQ9ZSx0aGlzLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoIjp0ZXh0IikucmVtb3ZlKCksdGhpcy4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCIuZ3JvdXAtc3Bhbi1maWxlc3R5bGUiKS5yZW1vdmVDbGFzcygiaW5wdXQtZ3JvdXAtYnRuIikpfX0sc2l6ZTpmdW5jdGlvbihlKXtpZih2b2lkIDA9PT1lKXJldHVybiB0aGlzLm9wdGlvbnMuc2l6ZTt0aGlzLm9wdGlvbnMuc2l6ZT1lO3ZhciB0PXRoaXMuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgibGFiZWwiKSxpPXRoaXMuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgiaW5wdXQiKTt0LnJlbW92ZUNsYXNzKCJidG4tbGcgYnRuLXNtIiksaS5yZW1vdmVDbGFzcygiZm9ybS1jb250cm9sLWxnIGZvcm0tY29udHJvbC1zbSIpLCJuciIhPXRoaXMub3B0aW9ucy5zaXplJiYodC5hZGRDbGFzcygiYnRuLSIrdGhpcy5vcHRpb25zLnNpemUpLGkuYWRkQ2xhc3MoImZvcm0tY29udHJvbC0iK3RoaXMub3B0aW9ucy5zaXplKSl9LHBsYWNlaG9sZGVyOmZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lP3RoaXMub3B0aW9ucy5wbGFjZWhvbGRlcjoodGhpcy5vcHRpb25zLnBsYWNlaG9sZGVyPWUsdm9pZCB0aGlzLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoImlucHV0IikuYXR0cigicGxhY2Vob2xkZXIiLGUpKX0sdGV4dDpmdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZT90aGlzLm9wdGlvbnMudGV4dDoodGhpcy5vcHRpb25zLnRleHQ9ZSx2b2lkIHRoaXMuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgibGFiZWwgLnRleHQiKS5odG1sKHRoaXMub3B0aW9ucy50ZXh0KSl9LGJ0bkNsYXNzOmZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lP3RoaXMub3B0aW9ucy5idG5DbGFzczoodGhpcy5vcHRpb25zLmJ0bkNsYXNzPWUsdm9pZCB0aGlzLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoImxhYmVsIikuYXR0cih7ImNsYXNzIjoiYnRuICIrdGhpcy5vcHRpb25zLmJ0bkNsYXNzKyIgYnRuLSIrdGhpcy5vcHRpb25zLnNpemV9KSl9LGJhZGdlOmZ1bmN0aW9uKGUpe2lmKGU9PT0hMCl7dGhpcy5vcHRpb25zLmJhZGdlPWU7dmFyIHQ9dGhpcy5wdXNoTmFtZUZpbGVzKCk7dGhpcy4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCJsYWJlbCIpLmFwcGVuZCgnIDxzcGFuIGNsYXNzPSJiYWRnZSAnK3RoaXMub3B0aW9ucy5iYWRnZU5hbWUrJyI+Jyt0Lmxlbmd0aCsiPC9zcGFuPiIpfWVsc2V7aWYoZSE9PSExKXJldHVybiB0aGlzLm9wdGlvbnMuYmFkZ2U7dGhpcy5vcHRpb25zLmJhZGdlPWUsdGhpcy4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCIuYmFkZ2UiKS5yZW1vdmUoKX19LGJhZGdlTmFtZTpmdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZT90aGlzLm9wdGlvbnMuYmFkZ2VOYW1lOih0aGlzLm9wdGlvbnMuYmFkZ2VOYW1lPWUsdm9pZCB0aGlzLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoIi5iYWRnZSIpLmF0dHIoeyJjbGFzcyI6ImJhZGdlICIrdGhpcy5vcHRpb25zLmJhZGdlTmFtZX0pKX0saHRtbEljb246ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMCE9PWUmJih0aGlzLm9wdGlvbnMuaHRtbEljb249ZSksdGhpcy5vcHRpb25zLmh0bWxJY29ufSxodG1sSW5wdXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vcHRpb25zLmlucHV0Pyc8aW5wdXQgdHlwZT0idGV4dCIgY2xhc3M9ImZvcm0tY29udHJvbCAnKygibnIiPT10aGlzLm9wdGlvbnMuc2l6ZT8iIjoiZm9ybS1jb250cm9sLSIrdGhpcy5vcHRpb25zLnNpemUpKyciIHBsYWNlaG9sZGVyPSInK3RoaXMub3B0aW9ucy5wbGFjZWhvbGRlcisnIiBkaXNhYmxlZD4gJzoiIn0scHVzaE5hbWVGaWxlczpmdW5jdGlvbigpe3ZhciBlPSIiLHQ9W107dm9pZCAwPT09dGhpcy4kZWxlbWVudFswXS5maWxlcz90WzBdPXtuYW1lOnRoaXMuJGVsZW1lbnRbMF0mJnRoaXMuJGVsZW1lbnRbMF0udmFsdWV9OnQ9dGhpcy4kZWxlbWVudFswXS5maWxlcztmb3IodmFyIGk9MDtpPHQubGVuZ3RoO2krKyllKz10W2ldLm5hbWUuc3BsaXQoIlxcIikucG9wKCkrIiwgIjtyZXR1cm4iIiE9PWU/dGhpcy4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCI6dGV4dCIpLnZhbChlLnJlcGxhY2UoL1wsICQvZywiIikpOnRoaXMuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgiOnRleHQiKS52YWwoIiIpLHR9LGNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7dmFyIGk9dGhpcyxuPSIiLHM9aS4kZWxlbWVudC5hdHRyKCJpZCIpLGw9IiI7IiIhPT1zJiZzfHwocz0iZmlsZXN0eWxlLSIrdCxpLiRlbGVtZW50LmF0dHIoe2lkOnN9KSx0KyspLGw9JzxzcGFuIGNsYXNzPSJncm91cC1zcGFuLWZpbGVzdHlsZSAnKyhpLm9wdGlvbnMuaW5wdXQ/ImlucHV0LWdyb3VwLWJ0biI6IiIpKyciPjxsYWJlbCBmb3I9IicrcysnIiBzdHlsZT0ibWFyZ2luLWJvdHRvbTogMDsiIGNsYXNzPSJidG4gJytpLm9wdGlvbnMuYnRuQ2xhc3MrIiAiKygibnIiPT1pLm9wdGlvbnMuc2l6ZT8iIjoiYnRuLSIraS5vcHRpb25zLnNpemUpKyciICcrKGkub3B0aW9ucy5kaXNhYmxlZHx8aS4kZWxlbWVudC5hdHRyKCJkaXNhYmxlZCIpPycgZGlzYWJsZWQ9InRydWUiJzoiIikrIj4iK2kuaHRtbEljb24oKSsnPHNwYW4gY2xhc3M9ImJ1dHRvblRleHQiPicraS5vcHRpb25zLnRleHQrIjwvc3Bhbj48L2xhYmVsPjwvc3Bhbj4iLG49aS5vcHRpb25zLmJ1dHRvbkJlZm9yZT9sK2kuaHRtbElucHV0KCk6aS5odG1sSW5wdXQoKStsLGkuJGVsZW1lbnRGaWxlc3R5bGU9ZSgnPGRpdiBjbGFzcz0iYm9vdHN0cmFwLWZpbGVzdHlsZSBpbnB1dC1ncm91cCI+PGRpdiBuYW1lPSJmaWxlZHJhZyI+PC9kaXY+JytuKyI8L2Rpdj4iKSxpLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoIi5ncm91cC1zcGFuLWZpbGVzdHlsZSIpLmF0dHIoInRhYmluZGV4IiwiMCIpLmtleXByZXNzKGZ1bmN0aW9uKGUpe3JldHVybiAxMz09PWUua2V5Q29kZXx8MzI9PT1lLmNoYXJDb2RlPyhpLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoImxhYmVsIikuY2xpY2soKSwhMSk6dm9pZCAwfSksaS4kZWxlbWVudC5jc3Moe3Bvc2l0aW9uOiJhYnNvbHV0ZSIsY2xpcDoicmVjdCgwcHggMHB4IDBweCAwcHgpIn0pLmF0dHIoInRhYmluZGV4IiwiLTEiKS5hZnRlcihpLiRlbGVtZW50RmlsZXN0eWxlKSxpLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoaS5vcHRpb25zLmJ1dHRvbkJlZm9yZT8ibGFiZWwiOiI6aW5wdXQiKS5jc3MoeyJib3JkZXItdG9wLWxlZnQtcmFkaXVzIjoiLjI1cmVtIiwiYm9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1cyI6Ii4yNXJlbSJ9KSxpLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoJ1tuYW1lPSJmaWxlZHJhZyJdJykuY3NzKHtwb3NpdGlvbjoiYWJzb2x1dGUiLHdpZHRoOiIxMDAlIixoZWlnaHQ6aS4kZWxlbWVudEZpbGVzdHlsZS5oZWlnaHQoKSsicHgiLCJ6LWluZGV4IjotMX0pLChpLm9wdGlvbnMuZGlzYWJsZWR8fGkuJGVsZW1lbnQuYXR0cigiZGlzYWJsZWQiKSkmJihpLiRlbGVtZW50LmF0dHIoImRpc2FibGVkIiwidHJ1ZSIpLGkub3B0aW9ucy5kaXNhYmxlZD9pLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoImxhYmVsIikuY3NzKCJvcGFjaXR5IiwiMC42NSIpOmkuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgibGFiZWwiKS5jc3MoIm9wYWNpdHkiLCIxIikpLGkuJGVsZW1lbnQuY2hhbmdlKGZ1bmN0aW9uKCl7dmFyIGU9aS5wdXNoTmFtZUZpbGVzKCk7aS5vcHRpb25zLmJhZGdlPzA9PWkuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgiLmJhZGdlIikubGVuZ3RoP2kuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgibGFiZWwiKS5hcHBlbmQoJyA8c3BhbiBjbGFzcz0iYmFkZ2UgJytpLm9wdGlvbnMuYmFkZ2VOYW1lKyciPicrZS5sZW5ndGgrIjwvc3Bhbj4iKTowPT1lLmxlbmd0aD9pLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoIi5iYWRnZSIpLnJlbW92ZSgpOmkuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgiLmJhZGdlIikuaHRtbChlLmxlbmd0aCk6aS4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCIuYmFkZ2UiKS5yZW1vdmUoKSxpLm9wdGlvbnMub25DaGFuZ2UoZSl9KSx3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC5zZWFyY2goL2ZpcmVmb3gvaSk+LTEmJmkuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgibGFiZWwiKS5jbGljayhmdW5jdGlvbigpe3JldHVybiBpLiRlbGVtZW50LmNsaWNrKCksITF9KSxlKGRvY3VtZW50KS5vbigiZHJhZ292ZXIiLGZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbigpLGkub3B0aW9ucy5kcmFnZHJvcCYmZSgnW25hbWU9ImZpbGVkcmFnIl0nKS5jc3MoInotaW5kZXgiLCI5Iil9KS5vbigiZHJvcCIsZnVuY3Rpb24odCl7dC5wcmV2ZW50RGVmYXVsdCgpLHQuc3RvcFByb3BhZ2F0aW9uKCksaS5vcHRpb25zLmRyYWdkcm9wJiZlKCdbbmFtZT0iZmlsZWRyYWciXScpLmNzcygiei1pbmRleCIsIi0xIil9KSxpLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoJ1tuYW1lPSJmaWxlZHJhZyJdJykub24oImRyYWdvdmVyIixmdW5jdGlvbihlKXtlLnByZXZlbnREZWZhdWx0KCksZS5zdG9wUHJvcGFnYXRpb24oKX0pLm9uKCJkcmFnZW50ZXIiLGZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKSxlLnN0b3BQcm9wYWdhdGlvbigpfSkub24oImRyb3AiLGZ1bmN0aW9uKHQpe2lmKHQub3JpZ2luYWxFdmVudC5kYXRhVHJhbnNmZXImJiFpLm9wdGlvbnMuZGlzYWJsZWQmJmkub3B0aW9ucy5kcmFnZHJvcCYmdC5vcmlnaW5hbEV2ZW50LmRhdGFUcmFuc2Zlci5maWxlcy5sZW5ndGgpe3QucHJldmVudERlZmF1bHQoKSx0LnN0b3BQcm9wYWdhdGlvbigpLGkuJGVsZW1lbnRbMF0uZmlsZXM9dC5vcmlnaW5hbEV2ZW50LmRhdGFUcmFuc2Zlci5maWxlczt2YXIgbj1pLnB1c2hOYW1lRmlsZXMoKTtpLm9wdGlvbnMuYmFkZ2U/MD09aS4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCIuYmFkZ2UiKS5sZW5ndGg/aS4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCJsYWJlbCIpLmFwcGVuZCgnIDxzcGFuIGNsYXNzPSJiYWRnZSAnK2kub3B0aW9ucy5iYWRnZU5hbWUrJyI+JytuLmxlbmd0aCsiPC9zcGFuPiIpOjA9PW4ubGVuZ3RoP2kuJGVsZW1lbnRGaWxlc3R5bGUuZmluZCgiLmJhZGdlIikucmVtb3ZlKCk6aS4kZWxlbWVudEZpbGVzdHlsZS5maW5kKCIuYmFkZ2UiKS5odG1sKG4ubGVuZ3RoKTppLiRlbGVtZW50RmlsZXN0eWxlLmZpbmQoIi5iYWRnZSIpLnJlbW92ZSgpLGUoJ1tuYW1lPSJmaWxlZHJhZyJdJykuY3NzKCJ6LWluZGV4IiwiLTEiKX19KX19O3ZhciBuPWUuZm4uZmlsZXN0eWxlO2UuZm4uZmlsZXN0eWxlPWZ1bmN0aW9uKHQsbil7dmFyIHM9IiIsbD10aGlzLmVhY2goZnVuY3Rpb24oKXtpZigiZmlsZSI9PT1lKHRoaXMpLmF0dHIoInR5cGUiKSl7dmFyIGw9ZSh0aGlzKSxvPWwuZGF0YSgiZmlsZXN0eWxlIiksYT1lLmV4dGVuZCh7fSxlLmZuLmZpbGVzdHlsZS5kZWZhdWx0cyx0LCJvYmplY3QiPT10eXBlb2YgdCYmdCk7b3x8KGwuZGF0YSgiZmlsZXN0eWxlIixvPW5ldyBpKHRoaXMsYSkpLG8uY29uc3RydWN0b3IoKSksInN0cmluZyI9PXR5cGVvZiB0JiYocz1vW3RdKG4pKX19KTtyZXR1cm4gdm9pZCAwIT09dHlwZW9mIHM/czpsfSxlLmZuLmZpbGVzdHlsZS5kZWZhdWx0cz17dGV4dDoi6KuL6YG45pOHIixodG1sSWNvbjoiIixidG5DbGFzczoiYnRuLWluZm8iLHNpemU6Im5yIixpbnB1dDohMCxiYWRnZTohMSxiYWRnZU5hbWU6ImJhZGdlLWxpZ2h0IixidXR0b25CZWZvcmU6ITEsZHJhZ2Ryb3A6ITAsZGlzYWJsZWQ6ITEscGxhY2Vob2xkZXI6IiIsb25DaGFuZ2U6ZnVuY3Rpb24oKXt9fSxlLmZuLmZpbGVzdHlsZS5ub0NvbmZsaWN0PWZ1bmN0aW9uKCl7cmV0dXJuIGUuZm4uZmlsZXN0eWxlPW4sdGhpc30sZShmdW5jdGlvbigpe2UoIi5maWxlc3R5bGUiKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxpPXtpbnB1dDoiZmFsc2UiIT09dC5hdHRyKCJkYXRhLWlucHV0IiksaHRtbEljb246dC5hdHRyKCJkYXRhLWljb24iKSxidXR0b25CZWZvcmU6InRydWUiPT09dC5hdHRyKCJkYXRhLWJ1dHRvbkJlZm9yZSIpLGRpc2FibGVkOiJ0cnVlIj09PXQuYXR0cigiZGF0YS1kaXNhYmxlZCIpLHNpemU6dC5hdHRyKCJkYXRhLXNpemUiKSx0ZXh0OnQuYXR0cigiZGF0YS10ZXh0IiksYnRuQ2xhc3M6dC5hdHRyKCJkYXRhLWJ0bkNsYXNzIiksYmFkZ2U6InRydWUiPT09dC5hdHRyKCJkYXRhLWJhZGdlIiksZHJhZ2Ryb3A6ImZhbHNlIiE9PXQuYXR0cigiZGF0YS1kcmFnZHJvcCIpLGJhZGdlTmFtZTp0LmF0dHIoImRhdGEtYmFkZ2VOYW1lIikscGxhY2Vob2xkZXI6dC5hdHRyKCJkYXRhLXBsYWNlaG9sZGVyIil9O3QuZmlsZXN0eWxlKGkpfSl9KX0od2luZG93LmpRdWVyeSk7DQohIGZ1bmN0aW9uKHQpIHsNCiAgICBmdW5jdGlvbiBlKHIpIHsNCiAgICAgICAgaWYgKG5bcl0pIHJldHVybiBuW3JdLmV4cG9ydHM7DQogICAgICAgIHZhciBzID0gbltyXSA9IHsNCiAgICAgICAgICAgIGk6IHIsDQogICAgICAgICAgICBsOiAhMSwNCiAgICAgICAgICAgIGV4cG9ydHM6IHt9DQogICAgICAgIH07DQogICAgICAgIHJldHVybiB0W3JdLmNhbGwocy5leHBvcnRzLCBzLCBzLmV4cG9ydHMsIGUpLCBzLmwgPSAhMCwgcy5leHBvcnRzDQogICAgfQ0KICAgIHZhciBuID0ge307DQogICAgZS5tID0gdCwgZS5jID0gbiwgZS5pID0gZnVuY3Rpb24odCkgew0KICAgICAgICByZXR1cm4gdA0KICAgIH0sIGUuZCA9IGZ1bmN0aW9uKHQsIG4sIHIpIHsNCiAgICAgICAgZS5vKHQsIG4pIHx8IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCBuLCB7DQogICAgICAgICAgICBjb25maWd1cmFibGU6ICExLA0KICAgICAgICAgICAgZW51bWVyYWJsZTogITAsDQogICAgICAgICAgICBnZXQ6IHINCiAgICAgICAgfSkNCiAgICB9LCBlLm4gPSBmdW5jdGlvbih0KSB7DQogICAgICAgIHZhciBuID0gdCAmJiB0Ll9fZXNNb2R1bGUgPyBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHJldHVybiB0LmRlZmF1bHQNCiAgICAgICAgfSA6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgcmV0dXJuIHQNCiAgICAgICAgfTsNCiAgICAgICAgcmV0dXJuIGUuZChuLCAiYSIsIG4pLCBuDQogICAgfSwgZS5vID0gZnVuY3Rpb24odCwgZSkgew0KICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsIGUpDQogICAgfSwgZS5wID0gIi4vIiwgZShlLnMgPSA4MSkNCn0oWywgZnVuY3Rpb24odCwgZSkgew0KICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICB2YXIgdCA9IFtdOw0KICAgICAgICByZXR1cm4gdC50b1N0cmluZyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgZm9yICh2YXIgdCA9IFtdLCBlID0gMDsgZSA8IHRoaXMubGVuZ3RoOyBlKyspIHsNCiAgICAgICAgICAgICAgICB2YXIgbiA9IHRoaXNbZV07DQogICAgICAgICAgICAgICAgblsyXSA/IHQucHVzaCgiQG1lZGlhICIgKyBuWzJdICsgInsiICsgblsxXSArICJ9IikgOiB0LnB1c2goblsxXSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiB0LmpvaW4oIiIpDQogICAgICAgIH0sIHQuaSA9IGZ1bmN0aW9uKGUsIG4pIHsNCiAgICAgICAgICAgICJzdHJpbmciID09IHR5cGVvZiBlICYmIChlID0gWw0KICAgICAgICAgICAgICAgIFtudWxsLCBlLCAiIl0NCiAgICAgICAgICAgIF0pOw0KICAgICAgICAgICAgZm9yICh2YXIgciA9IHt9LCBzID0gMDsgcyA8IHRoaXMubGVuZ3RoOyBzKyspIHsNCiAgICAgICAgICAgICAgICB2YXIgaSA9IHRoaXNbc11bMF07DQogICAgICAgICAgICAgICAgIm51bWJlciIgPT0gdHlwZW9mIGkgJiYgKHJbaV0gPSAhMCkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGZvciAocyA9IDA7IHMgPCBlLmxlbmd0aDsgcysrKSB7DQogICAgICAgICAgICAgICAgdmFyIGEgPSBlW3NdOw0KICAgICAgICAgICAgICAgICJudW1iZXIiID09IHR5cGVvZiBhWzBdICYmIHJbYVswXV0gfHwgKG4gJiYgIWFbMl0gPyBhWzJdID0gbiA6IG4gJiYgKGFbMl0gPSAiKCIgKyBhWzJdICsgIikgYW5kICgiICsgbiArICIpIiksIHQucHVzaChhKSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwgdA0KICAgIH0NCn0sIGZ1bmN0aW9uKHQsIGUpIHsNCiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0LCBlLCBuLCByKSB7DQogICAgICAgIHZhciBzLCBpID0gdCA9IHQgfHwge30sDQogICAgICAgICAgICBhID0gdHlwZW9mIHQuZGVmYXVsdDsNCiAgICAgICAgIm9iamVjdCIgIT09IGEgJiYgImZ1bmN0aW9uIiAhPT0gYSB8fCAocyA9IHQsIGkgPSB0LmRlZmF1bHQpOw0KICAgICAgICB2YXIgbyA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIGkgPyBpLm9wdGlvbnMgOiBpOw0KICAgICAgICBpZiAoZSAmJiAoby5yZW5kZXIgPSBlLnJlbmRlciwgby5zdGF0aWNSZW5kZXJGbnMgPSBlLnN0YXRpY1JlbmRlckZucyksIG4gJiYgKG8uX3Njb3BlSWQgPSBuKSwgcikgew0KICAgICAgICAgICAgdmFyIGwgPSBvLmNvbXB1dGVkIHx8IChvLmNvbXB1dGVkID0ge30pOw0KICAgICAgICAgICAgT2JqZWN0LmtleXMocikuZm9yRWFjaChmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgdmFyIGUgPSByW3RdOw0KICAgICAgICAgICAgICAgIGxbdF0gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBlc01vZHVsZTogcywNCiAgICAgICAgICAgIGV4cG9ydHM6IGksDQogICAgICAgICAgICBvcHRpb25zOiBvDQogICAgICAgIH0NCiAgICB9DQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgZnVuY3Rpb24gcih0KSB7DQogICAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgdC5sZW5ndGg7IGUrKykgew0KICAgICAgICAgICAgdmFyIG4gPSB0W2VdLA0KICAgICAgICAgICAgICAgIHIgPSBjW24uaWRdOw0KICAgICAgICAgICAgaWYgKHIpIHsNCiAgICAgICAgICAgICAgICByLnJlZnMrKzsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBzID0gMDsgcyA8IHIucGFydHMubGVuZ3RoOyBzKyspIHIucGFydHNbc10obi5wYXJ0c1tzXSk7DQogICAgICAgICAgICAgICAgZm9yICg7IHMgPCBuLnBhcnRzLmxlbmd0aDsgcysrKSByLnBhcnRzLnB1c2goaShuLnBhcnRzW3NdKSk7DQogICAgICAgICAgICAgICAgci5wYXJ0cy5sZW5ndGggPiBuLnBhcnRzLmxlbmd0aCAmJiAoci5wYXJ0cy5sZW5ndGggPSBuLnBhcnRzLmxlbmd0aCkNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgYSA9IFtdLCBzID0gMDsgcyA8IG4ucGFydHMubGVuZ3RoOyBzKyspIGEucHVzaChpKG4ucGFydHNbc10pKTsNCiAgICAgICAgICAgICAgICBjW24uaWRdID0gew0KICAgICAgICAgICAgICAgICAgICBpZDogbi5pZCwNCiAgICAgICAgICAgICAgICAgICAgcmVmczogMSwNCiAgICAgICAgICAgICAgICAgICAgcGFydHM6IGENCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzKCkgew0KICAgICAgICB2YXIgdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInN0eWxlIik7DQogICAgICAgIHJldHVybiB0LnR5cGUgPSAidGV4dC9jc3MiLCBmLmFwcGVuZENoaWxkKHQpLCB0DQogICAgfQ0KDQogICAgZnVuY3Rpb24gaSh0KSB7DQogICAgICAgIHZhciBlLCBuLCByID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcignc3R5bGVbZGF0YS12dWUtc3NyLWlkfj0iJyArIHQuaWQgKyAnIl0nKTsNCiAgICAgICAgaWYgKHIpIHsNCiAgICAgICAgICAgIGlmIChkKSByZXR1cm4gZzsNCiAgICAgICAgICAgIHIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChyKQ0KICAgICAgICB9DQogICAgICAgIGlmIChiKSB7DQogICAgICAgICAgICB2YXIgaSA9IGgrKzsNCiAgICAgICAgICAgIHIgPSBwIHx8IChwID0gcygpKSwgZSA9IGEuYmluZChudWxsLCByLCBpLCAhMSksIG4gPSBhLmJpbmQobnVsbCwgciwgaSwgITApDQogICAgICAgIH0gZWxzZSByID0gcygpLCBlID0gby5iaW5kKG51bGwsIHIpLCBuID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICByLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQocikNCiAgICAgICAgfTsNCiAgICAgICAgcmV0dXJuIGUodCksDQogICAgICAgICAgICBmdW5jdGlvbihyKSB7DQogICAgICAgICAgICAgICAgaWYgKHIpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHIuY3NzID09PSB0LmNzcyAmJiByLm1lZGlhID09PSB0Lm1lZGlhICYmIHIuc291cmNlTWFwID09PSB0LnNvdXJjZU1hcCkgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICBlKHQgPSByKQ0KICAgICAgICAgICAgICAgIH0gZWxzZSBuKCkNCiAgICAgICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiBhKHQsIGUsIG4sIHIpIHsNCiAgICAgICAgdmFyIHMgPSBuID8gIiIgOiByLmNzczsNCiAgICAgICAgaWYgKHQuc3R5bGVTaGVldCkgdC5zdHlsZVNoZWV0LmNzc1RleHQgPSB5KGUsIHMpOw0KICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgIHZhciBpID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUocyksDQogICAgICAgICAgICAgICAgYSA9IHQuY2hpbGROb2RlczsNCiAgICAgICAgICAgIGFbZV0gJiYgdC5yZW1vdmVDaGlsZChhW2VdKSwgYS5sZW5ndGggPyB0Lmluc2VydEJlZm9yZShpLCBhW2VdKSA6IHQuYXBwZW5kQ2hpbGQoaSkNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIG8odCwgZSkgew0KICAgICAgICB2YXIgbiA9IGUuY3NzLA0KICAgICAgICAgICAgciA9IGUubWVkaWEsDQogICAgICAgICAgICBzID0gZS5zb3VyY2VNYXA7DQogICAgICAgIGlmIChyICYmIHQuc2V0QXR0cmlidXRlKCJtZWRpYSIsIHIpLCBzICYmIChuICs9ICJcbi8qIyBzb3VyY2VVUkw9IiArIHMuc291cmNlc1swXSArICIgKi8iLCBuICs9ICJcbi8qIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsIiArIGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KHMpKSkpICsgIiAqLyIpLCB0LnN0eWxlU2hlZXQpIHQuc3R5bGVTaGVldC5jc3NUZXh0ID0gbjsNCiAgICAgICAgZWxzZSB7DQogICAgICAgICAgICBmb3IgKDsgdC5maXJzdENoaWxkOykgdC5yZW1vdmVDaGlsZCh0LmZpcnN0Q2hpbGQpOw0KICAgICAgICAgICAgdC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShuKSkNCiAgICAgICAgfQ0KICAgIH0NCiAgICB2YXIgbCA9ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBkb2N1bWVudDsNCiAgICBpZiAoInVuZGVmaW5lZCIgIT0gdHlwZW9mIERFQlVHICYmIERFQlVHICYmICFsKSB0aHJvdyBuZXcgRXJyb3IoInZ1ZS1zdHlsZS1sb2FkZXIgY2Fubm90IGJlIHVzZWQgaW4gYSBub24tYnJvd3NlciBlbnZpcm9ubWVudC4gVXNlIHsgdGFyZ2V0OiAnbm9kZScgfSBpbiB5b3VyIFdlYnBhY2sgY29uZmlnIHRvIGluZGljYXRlIGEgc2VydmVyLXJlbmRlcmluZyBlbnZpcm9ubWVudC4iKTsNCiAgICB2YXIgdSA9IG4oMzcpLA0KICAgICAgICBjID0ge30sDQogICAgICAgIGYgPSBsICYmIChkb2N1bWVudC5oZWFkIHx8IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJoZWFkIilbMF0pLA0KICAgICAgICBwID0gbnVsbCwNCiAgICAgICAgaCA9IDAsDQogICAgICAgIGQgPSAhMSwNCiAgICAgICAgZyA9IGZ1bmN0aW9uKCkge30sDQogICAgICAgIGIgPSAidW5kZWZpbmVkIiAhPSB0eXBlb2YgbmF2aWdhdG9yICYmIC9tc2llIFs2LTldXGIvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpKTsNCiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgICAgIGQgPSBuOw0KICAgICAgICB2YXIgcyA9IHUodCwgZSk7DQogICAgICAgIHJldHVybiByKHMpLA0KICAgICAgICAgICAgZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgIGZvciAodmFyIG4gPSBbXSwgaSA9IDA7IGkgPCBzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBhID0gc1tpXSwNCiAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBjW2EuaWRdOw0KICAgICAgICAgICAgICAgICAgICBvLnJlZnMtLSwgbi5wdXNoKG8pDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGUgPyAocyA9IHUodCwgZSksIHIocykpIDogcyA9IFtdOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbi5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICB2YXIgbyA9IG5baV07DQogICAgICAgICAgICAgICAgICAgIGlmICgwID09PSBvLnJlZnMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGwgPSAwOyBsIDwgby5wYXJ0cy5sZW5ndGg7IGwrKykgby5wYXJ0c1tsXSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGNbby5pZF0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICB9Ow0KICAgIHZhciB5ID0gZnVuY3Rpb24oKSB7DQogICAgICAgIHZhciB0ID0gW107DQogICAgICAgIHJldHVybiBmdW5jdGlvbihlLCBuKSB7DQogICAgICAgICAgICByZXR1cm4gdFtlXSA9IG4sIHQuZmlsdGVyKEJvb2xlYW4pLmpvaW4oIlxuIikNCiAgICAgICAgfQ0KICAgIH0oKQ0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgICJ1c2Ugc3RyaWN0IjsNCg0KICAgIGZ1bmN0aW9uIHIodCwgZSkgew0KICAgICAgICBpZiAoISh0IGluc3RhbmNlb2YgZSkpIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpDQogICAgfQ0KICAgIHZhciBzID0gbig2KSwNCiAgICAgICAgaSA9IG4ubihzKSwNCiAgICAgICAgYSA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiAic3ltYm9sIiA9PSB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID8gZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiB0DQogICAgICAgIH0gOiBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICByZXR1cm4gdCAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgdC5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIHQgIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiB0DQogICAgICAgIH0sDQogICAgICAgIG8gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIGZ1bmN0aW9uIHQodCwgZSkgew0KICAgICAgICAgICAgICAgIGZvciAodmFyIG4gPSAwOyBuIDwgZS5sZW5ndGg7IG4rKykgew0KICAgICAgICAgICAgICAgICAgICB2YXIgciA9IGVbbl07DQogICAgICAgICAgICAgICAgICAgIHIuZW51bWVyYWJsZSA9IHIuZW51bWVyYWJsZSB8fCAhMSwgci5jb25maWd1cmFibGUgPSAhMCwgInZhbHVlIiBpbiByICYmIChyLndyaXRhYmxlID0gITApLCBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgci5rZXksIHIpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUsIG4sIHIpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbiAmJiB0KGUucHJvdG90eXBlLCBuKSwgciAmJiB0KGUsIHIpLCBlDQogICAgICAgICAgICB9DQogICAgICAgIH0oKSwNCiAgICAgICAgbCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgZnVuY3Rpb24gdCgpIHsNCiAgICAgICAgICAgICAgICByKHRoaXMsIHQpLCB0aGlzLnByb3BlcnRpZXMgPSB7DQogICAgICAgICAgICAgICAgICAgIHRhYmxlOiB7DQogICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogInRhYmxlIHRhYmxlLWhvdmVyIHRhYmxlLXN0cmlwZWQiLA0KICAgICAgICAgICAgICAgICAgICAgICAgcm93OiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NlczogWyIiXQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRpbmc6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhblNvcnQ6IFsic29ydCJdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3J0Tm9uZTogWyJmYSIsICJmYS1zb3J0Il0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRBc2M6IFsiZmEiLCAiZmEtc29ydC1hc2MiXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ydERlc2M6IFsiZmEiLCAiZmEtc29ydC1kZXNjIl0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIHBhZ2VyOiB7DQogICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZXI6ICJwYWdpbmF0aW9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaTogInBhZ2UtaXRlbSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYTogInBhZ2UtbGluayIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6ICJhY3RpdmUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiAiZGlzYWJsZWQiDQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgaWNvbnM6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91czogIiZsdDsiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHQ6ICImZ3Q7Ig0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIG8odCwgW3sNCiAgICAgICAgICAgICAgICBrZXk6ICJnZXQiLA0KICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBpLmEuZ2V0KHRoaXMucHJvcGVydGllcywgdCkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAga2V5OiAic2V0IiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCwgZSkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gaS5hLnNldCh0aGlzLnByb3BlcnRpZXMsIHQsIGUpLCB0aGlzDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgIGtleTogIm1lcmdlIiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzID0gdGhpcy5fbWVyZ2VPYmplY3RzKHRoaXMucHJvcGVydGllcywgdCksIHRoaXMNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAga2V5OiAiX21lcmdlT2JqZWN0cyIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQsIGUpIHsNCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbiBpbiBlKSBudWxsICE9PSBlW25dID8gIm9iamVjdCIgIT09IGEoZVtuXSkgPyB0W25dID0gZVtuXSA6IHRbbl0gPSB0aGlzLl9tZXJnZU9iamVjdHModFtuXSwgZVtuXSkgOiB0W25dID0gZVtuXTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9XSksIHQNCiAgICAgICAgfSgpOw0KICAgIGUuYSA9IGwNCn0sIGZ1bmN0aW9uKHQsIGUsIG4pIHsNCiAgICAidXNlIHN0cmljdCI7DQoNCiAgICBmdW5jdGlvbiByKHQsIGUpIHsNCiAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIGUpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKQ0KICAgIH0NCiAgICB2YXIgcyA9IG4oNiksDQogICAgICAgIGkgPSBuLm4ocyksDQogICAgICAgIGEgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIGZ1bmN0aW9uIHQodCwgZSkgew0KICAgICAgICAgICAgICAgIGZvciAodmFyIG4gPSAwOyBuIDwgZS5sZW5ndGg7IG4rKykgew0KICAgICAgICAgICAgICAgICAgICB2YXIgciA9IGVbbl07DQogICAgICAgICAgICAgICAgICAgIHIuZW51bWVyYWJsZSA9IHIuZW51bWVyYWJsZSB8fCAhMSwgci5jb25maWd1cmFibGUgPSAhMCwgInZhbHVlIiBpbiByICYmIChyLndyaXRhYmxlID0gITApLCBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgci5rZXksIHIpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUsIG4sIHIpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbiAmJiB0KGUucHJvdG90eXBlLCBuKSwgciAmJiB0KGUsIHIpLCBlDQogICAgICAgICAgICB9DQogICAgICAgIH0oKSwNCiAgICAgICAgbyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgZnVuY3Rpb24gdChlKSB7DQogICAgICAgICAgICAgICAgcih0aGlzLCB0KSwgdGhpcy5zZXRBbGlnbm1lbnQoZS5hbGlnbiksIHRoaXMubGFiZWwgPSBlLmxhYmVsIHx8ICIiLCB0aGlzLmZpZWxkID0gZS5maWVsZCB8fCBudWxsLCB0aGlzLnJlcHJlc2VudGVkQXMgPSBlLnJlcHJlc2VudGVkQXMgfHwgbnVsbCwgdGhpcy5jb21wb25lbnQgPSBlLmNvbXBvbmVudCB8fCBudWxsLCB0aGlzLmludGVycG9sYXRlID0gZS5pbnRlcnBvbGF0ZSB8fCAhMSwgdGhpcy5zb3J0YWJsZSA9IHRoaXMuaXNTb3J0YWJsZShlKSwgdGhpcy5maWx0ZXJhYmxlID0gdGhpcy5pc0ZpbHRlcmFibGUoZSksIHRoaXMuZGlzcGxheSA9IGUuZGlzcGxheSB8fCBudWxsDQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gYSh0LCBbew0KICAgICAgICAgICAgICAgIGtleTogInNldEFsaWdubWVudCIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQgJiYgInN0cmluZyIgPT0gdHlwZW9mIHQgPyAiY2VudGVyIiA9PT0gdC50b0xvd2VyQ2FzZSgpID8gKHRoaXMuYWxpZ24gPSAiY2VudGVyIiwgdGhpcykgOiAicmlnaHQiID09PSB0LnRvTG93ZXJDYXNlKCkgPyAodGhpcy5hbGlnbiA9ICJyaWdodCIsIHRoaXMpIDogKHRoaXMuYWxpZ24gPSAibGVmdCIsIHRoaXMpIDogKHRoaXMuYWxpZ24gPSAibGVmdCIsIHRoaXMpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgIGtleTogImlzRmlsdGVyYWJsZSIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICExICE9PSB0LmZpbHRlcmFibGUgJiYgKCEoIXQuZmllbGQgJiYgIXQucmVwcmVzZW50ZWRBcykgJiYgISh0aGlzLmNvbXBvbmVudCAmJiAhdGhpcy5yZXByZXNlbnRlZEFzICYmICF0aGlzLmZpZWxkKSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAga2V5OiAiaXNTb3J0YWJsZSIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICExICE9PSB0LnNvcnRhYmxlICYmICghKCF0LmZpZWxkICYmICF0LnJlcHJlc2VudGVkQXMpICYmICEodGhpcy5jb21wb25lbnQgJiYgIXRoaXMucmVwcmVzZW50ZWRBcyAmJiAhdGhpcy5maWVsZCkpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgIGtleTogImdldFJlcHJlc2VudGF0aW9uIiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZXByZXNlbnRlZEFzICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIHRoaXMucmVwcmVzZW50ZWRBcyA/IHRoaXMucmVwcmVzZW50ZWRBcyh0KSA6IHRoaXMuY29tcG9uZW50ICYmIHRoaXMuZmlsdGVyYWJsZSA/IHRoaXMucGxhaW5fdGV4dF9mdW5jdGlvbih0LCB0aGlzKSA6IGkuYS5nZXQodCwgdGhpcy5maWVsZCkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAga2V5OiAiZ2V0VmFsdWUiLA0KICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFJlcHJlc2VudGF0aW9uKHQpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgIGtleTogIm1hdGNoZXMiLA0KICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbih0LCBlKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAtMSAhPT0gKCIiICsgdGhpcy5nZXRSZXByZXNlbnRhdGlvbih0KSkudG9Mb3dlckNhc2UoKS5pbmRleE9mKGUudG9Mb3dlckNhc2UoKSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9XSksIHQNCiAgICAgICAgfSgpOw0KICAgIGUuYSA9IG8NCn0sIGZ1bmN0aW9uKHQsIGUsIG4pIHsNCiAgICB2YXIgciwgcywgaTsNCiAgICAhIGZ1bmN0aW9uKG4sIGEpIHsNCiAgICAgICAgInVzZSBzdHJpY3QiOw0KICAgICAgICAib2JqZWN0IiA9PSB0eXBlb2YgdCAmJiAib2JqZWN0IiA9PSB0eXBlb2YgdC5leHBvcnRzID8gdC5leHBvcnRzID0gYSgpIDogKHMgPSBbXSwgciA9IGEsIHZvaWQgMCAhPT0gKGkgPSAiZnVuY3Rpb24iID09IHR5cGVvZiByID8gci5hcHBseShlLCBzKSA6IHIpICYmICh0LmV4cG9ydHMgPSBpKSkNCiAgICB9KDAsIGZ1bmN0aW9uKCkgew0KICAgICAgICAidXNlIHN0cmljdCI7DQoNCiAgICAgICAgZnVuY3Rpb24gdCh0LCBlKSB7DQogICAgICAgICAgICByZXR1cm4gbnVsbCAhPSB0ICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LCBlKQ0KICAgICAgICB9DQoNCiAgICAgICAgZnVuY3Rpb24gZShlKSB7DQogICAgICAgICAgICBpZiAoIWUpIHJldHVybiAhMDsNCiAgICAgICAgICAgIGlmIChsKGUpICYmIDAgPT09IGUubGVuZ3RoKSByZXR1cm4gITA7DQogICAgICAgICAgICBpZiAoInN0cmluZyIgIT0gdHlwZW9mIGUpIHsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBuIGluIGUpDQogICAgICAgICAgICAgICAgICAgIGlmICh0KGUsIG4pKSByZXR1cm4gITE7DQogICAgICAgICAgICAgICAgcmV0dXJuICEwDQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gITENCiAgICAgICAgfQ0KDQogICAgICAgIGZ1bmN0aW9uIG4odCkgew0KICAgICAgICAgICAgcmV0dXJuIG8uY2FsbCh0KQ0KICAgICAgICB9DQoNCiAgICAgICAgZnVuY3Rpb24gcih0KSB7DQogICAgICAgICAgICByZXR1cm4gIm9iamVjdCIgPT0gdHlwZW9mIHQgJiYgIltvYmplY3QgT2JqZWN0XSIgPT09IG4odCkNCiAgICAgICAgfQ0KDQogICAgICAgIGZ1bmN0aW9uIHModCkgew0KICAgICAgICAgICAgcmV0dXJuICJib29sZWFuIiA9PSB0eXBlb2YgdCB8fCAiW29iamVjdCBCb29sZWFuXSIgPT09IG4odCkNCiAgICAgICAgfQ0KDQogICAgICAgIGZ1bmN0aW9uIGkodCkgew0KICAgICAgICAgICAgdmFyIGUgPSBwYXJzZUludCh0KTsNCiAgICAgICAgICAgIHJldHVybiBlLnRvU3RyaW5nKCkgPT09IHQgPyBlIDogdA0KICAgICAgICB9DQoNCiAgICAgICAgZnVuY3Rpb24gYShuKSB7DQogICAgICAgICAgICBmdW5jdGlvbiBhKGUsIHIpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbi5pbmNsdWRlSW5oZXJpdGVkUHJvcHMgfHwgIm51bWJlciIgPT0gdHlwZW9mIHIgJiYgQXJyYXkuaXNBcnJheShlKSB8fCB0KGUsIHIpDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGZ1bmN0aW9uIG8odCwgZSkgew0KICAgICAgICAgICAgICAgIGlmIChhKHQsIGUpKSByZXR1cm4gdFtlXQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBmdW5jdGlvbiB1KHQsIGUsIG4sIHIpIHsNCiAgICAgICAgICAgICAgICBpZiAoIm51bWJlciIgPT0gdHlwZW9mIGUgJiYgKGUgPSBbZV0pLCAhZSB8fCAwID09PSBlLmxlbmd0aCkgcmV0dXJuIHQ7DQogICAgICAgICAgICAgICAgaWYgKCJzdHJpbmciID09IHR5cGVvZiBlKSByZXR1cm4gdSh0LCBlLnNwbGl0KCIuIikubWFwKGkpLCBuLCByKTsNCiAgICAgICAgICAgICAgICB2YXIgcyA9IGVbMF0sDQogICAgICAgICAgICAgICAgICAgIGEgPSBvKHQsIHMpOw0KICAgICAgICAgICAgICAgIHJldHVybiAxID09PSBlLmxlbmd0aCA/ICh2b2lkIDAgIT09IGEgJiYgciB8fCAodFtzXSA9IG4pLCBhKSA6ICh2b2lkIDAgPT09IGEgJiYgKCJudW1iZXIiID09IHR5cGVvZiBlWzFdID8gdFtzXSA9IFtdIDogdFtzXSA9IHt9KSwgdSh0W3NdLCBlLnNsaWNlKDEpLCBuLCByKSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG4gPSBuIHx8IHt9Ow0KICAgICAgICAgICAgdmFyIGMgPSBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKGMpLnJlZHVjZShmdW5jdGlvbihlLCBuKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAiY3JlYXRlIiA9PT0gbiA/IGUgOiAoImZ1bmN0aW9uIiA9PSB0eXBlb2YgY1tuXSAmJiAoZVtuXSA9IGNbbl0uYmluZChjLCB0KSksIGUpDQogICAgICAgICAgICAgICAgfSwge30pDQogICAgICAgICAgICB9Ow0KICAgICAgICAgICAgcmV0dXJuIGMuaGFzID0gZnVuY3Rpb24oZSwgcikgew0KICAgICAgICAgICAgICAgIGlmICgibnVtYmVyIiA9PSB0eXBlb2YgciA/IHIgPSBbcl0gOiAic3RyaW5nIiA9PSB0eXBlb2YgciAmJiAociA9IHIuc3BsaXQoIi4iKSksICFyIHx8IDAgPT09IHIubGVuZ3RoKSByZXR1cm4gISFlOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIHMgPSAwOyBzIDwgci5sZW5ndGg7IHMrKykgew0KICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IGkocltzXSk7DQogICAgICAgICAgICAgICAgICAgIGlmICghKCJudW1iZXIiID09IHR5cGVvZiBhICYmIGwoZSkgJiYgYSA8IGUubGVuZ3RoIHx8IChuLmluY2x1ZGVJbmhlcml0ZWRQcm9wcyA/IGEgaW4gT2JqZWN0KGUpIDogdChlLCBhKSkpKSByZXR1cm4gITE7DQogICAgICAgICAgICAgICAgICAgIGUgPSBlW2FdDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiAhMA0KICAgICAgICAgICAgfSwgYy5lbnN1cmVFeGlzdHMgPSBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHUodCwgZSwgbiwgITApDQogICAgICAgICAgICB9LCBjLnNldCA9IGZ1bmN0aW9uKHQsIGUsIG4sIHIpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdSh0LCBlLCBuLCByKQ0KICAgICAgICAgICAgfSwgYy5pbnNlcnQgPSBmdW5jdGlvbih0LCBlLCBuLCByKSB7DQogICAgICAgICAgICAgICAgdmFyIHMgPSBjLmdldCh0LCBlKTsNCiAgICAgICAgICAgICAgICByID0gfn5yLCBsKHMpIHx8IChzID0gW10sIGMuc2V0KHQsIGUsIHMpKSwgcy5zcGxpY2UociwgMCwgbikNCiAgICAgICAgICAgIH0sIGMuZW1wdHkgPSBmdW5jdGlvbih0LCBuKSB7DQogICAgICAgICAgICAgICAgaWYgKCFlKG4pICYmIG51bGwgIT0gdCkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgaSwgbzsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPSBjLmdldCh0LCBuKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCJzdHJpbmciID09IHR5cGVvZiBpKSByZXR1cm4gYy5zZXQodCwgbiwgIiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHMoaSkpIHJldHVybiBjLnNldCh0LCBuLCAhMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIm51bWJlciIgPT0gdHlwZW9mIGkpIHJldHVybiBjLnNldCh0LCBuLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsKGkpKSBpLmxlbmd0aCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXIoaSkpIHJldHVybiBjLnNldCh0LCBuLCBudWxsKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKG8gaW4gaSkgYShpLCBvKSAmJiBkZWxldGUgaVtvXQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgYy5wdXNoID0gZnVuY3Rpb24odCwgZSkgew0KICAgICAgICAgICAgICAgIHZhciBuID0gYy5nZXQodCwgZSk7DQogICAgICAgICAgICAgICAgbChuKSB8fCAobiA9IFtdLCBjLnNldCh0LCBlLCBuKSksIG4ucHVzaC5hcHBseShuLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpKQ0KICAgICAgICAgICAgfSwgYy5jb2FsZXNjZSA9IGZ1bmN0aW9uKHQsIGUsIG4pIHsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciByLCBzID0gMCwgaSA9IGUubGVuZ3RoOyBzIDwgaTsgcysrKQ0KICAgICAgICAgICAgICAgICAgICBpZiAodm9pZCAwICE9PSAociA9IGMuZ2V0KHQsIGVbc10pKSkgcmV0dXJuIHI7DQogICAgICAgICAgICAgICAgcmV0dXJuIG4NCiAgICAgICAgICAgIH0sIGMuZ2V0ID0gZnVuY3Rpb24odCwgZSwgbikgew0KICAgICAgICAgICAgICAgIGlmICgibnVtYmVyIiA9PSB0eXBlb2YgZSAmJiAoZSA9IFtlXSksICFlIHx8IDAgPT09IGUubGVuZ3RoKSByZXR1cm4gdDsNCiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSB0KSByZXR1cm4gbjsNCiAgICAgICAgICAgICAgICBpZiAoInN0cmluZyIgPT0gdHlwZW9mIGUpIHJldHVybiBjLmdldCh0LCBlLnNwbGl0KCIuIiksIG4pOw0KICAgICAgICAgICAgICAgIHZhciByID0gaShlWzBdKSwNCiAgICAgICAgICAgICAgICAgICAgcyA9IG8odCwgcik7DQogICAgICAgICAgICAgICAgcmV0dXJuIHZvaWQgMCA9PT0gcyA/IG4gOiAxID09PSBlLmxlbmd0aCA/IHMgOiBjLmdldCh0W3JdLCBlLnNsaWNlKDEpLCBuKQ0KICAgICAgICAgICAgfSwgYy5kZWwgPSBmdW5jdGlvbih0LCBuKSB7DQogICAgICAgICAgICAgICAgaWYgKCJudW1iZXIiID09IHR5cGVvZiBuICYmIChuID0gW25dKSwgbnVsbCA9PSB0KSByZXR1cm4gdDsNCiAgICAgICAgICAgICAgICBpZiAoZShuKSkgcmV0dXJuIHQ7DQogICAgICAgICAgICAgICAgaWYgKCJzdHJpbmciID09IHR5cGVvZiBuKSByZXR1cm4gYy5kZWwodCwgbi5zcGxpdCgiLiIpKTsNCiAgICAgICAgICAgICAgICB2YXIgciA9IGkoblswXSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGEodCwgcikgPyAxICE9PSBuLmxlbmd0aCA/IGMuZGVsKHRbcl0sIG4uc2xpY2UoMSkpIDogKGwodCkgPyB0LnNwbGljZShyLCAxKSA6IGRlbGV0ZSB0W3JdLCB0KSA6IHQNCiAgICAgICAgICAgIH0sIGMNCiAgICAgICAgfQ0KICAgICAgICB2YXIgbyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcsDQogICAgICAgICAgICBsID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICJbb2JqZWN0IEFycmF5XSIgPT09IG8uY2FsbCh0KQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHUgPSBhKCk7DQogICAgICAgIHJldHVybiB1LmNyZWF0ZSA9IGEsIHUud2l0aEluaGVyaXRlZFByb3BzID0gYSh7DQogICAgICAgICAgICBpbmNsdWRlSW5oZXJpdGVkUHJvcHM6ICEwDQogICAgICAgIH0pLCB1DQogICAgfSkNCn0sICwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgICJ1c2Ugc3RyaWN0IjsNCg0KICAgIGZ1bmN0aW9uIHIodCwgZSkgew0KICAgICAgICBpZiAoISh0IGluc3RhbmNlb2YgZSkpIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpDQogICAgfQ0KICAgIHZhciBzID0gbigxMSksDQogICAgICAgIGkgPSBuLm4ocyksDQogICAgICAgIGEgPSBuKDEyKSwNCiAgICAgICAgbyA9IG4ubihhKSwNCiAgICAgICAgbCA9IG4oMTMpLA0KICAgICAgICB1ID0gbi5uKGwpLA0KICAgICAgICBjID0gbigxMCksDQogICAgICAgIGYgPSBuKDQpLA0KICAgICAgICBwID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBmdW5jdGlvbiB0KHQsIGUpIHsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBuID0gMDsgbiA8IGUubGVuZ3RoOyBuKyspIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBlW25dOw0KICAgICAgICAgICAgICAgICAgICByLmVudW1lcmFibGUgPSByLmVudW1lcmFibGUgfHwgITEsIHIuY29uZmlndXJhYmxlID0gITAsICJ2YWx1ZSIgaW4gciAmJiAoci53cml0YWJsZSA9ICEwKSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIHIua2V5LCByKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihlLCBuLCByKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIG4gJiYgdChlLnByb3RvdHlwZSwgbiksIHIgJiYgdChlLCByKSwgZQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9KCksDQogICAgICAgIGggPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIGZ1bmN0aW9uIHQoKSB7DQogICAgICAgICAgICAgICAgcih0aGlzLCB0KSwgdGhpcy50YWJsZV90eXBlcyA9IFtdLCB0aGlzLnVzZV9kZWZhdWx0X3R5cGUgPSAhMCwgdGhpcy5kZWZhdWx0X3RhYmxlX3NldHRpbmdzID0gbmV3IGYuYQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIHAodCwgW3sNCiAgICAgICAgICAgICAgICBrZXk6ICJ1c2VEZWZhdWx0VHlwZSIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudXNlX2RlZmF1bHRfdHlwZSA9ICEhdCwgdGhpcw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBrZXk6ICJyZWdpc3RlclRhYmxlVHlwZSIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQsIGUpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSBuZXcgYy5hKHQpOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50YWJsZV90eXBlcy5wdXNoKG4pLCBlICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIGUgJiYgZShuKSwgdGhpcw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBrZXk6ICJpbnN0YWxsIiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgICAgICB0LiRkYXRhdGFibGVzID0ge30sIHQuY29tcG9uZW50KCJkYXRhdGFibGUtY2VsbCIsIGkuYSksIHQuY29tcG9uZW50KCJkYXRhdGFibGUtaGVhZGVyIiwgby5hKSwgdC5jb21wb25lbnQoImRhdGF0YWJsZS1idXR0b24iLCB1LmEpLCB0aGlzLnVzZV9kZWZhdWx0X3R5cGUgJiYgdGhpcy5yZWdpc3RlclRhYmxlVHlwZSgiZGF0YXRhYmxlIiwgZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdC5tZXJnZVNldHRpbmdzKHRoaXMuZGVmYXVsdF90YWJsZV9zZXR0aW5ncy5wcm9wZXJ0aWVzKQ0KICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBlIGluIHRoaXMudGFibGVfdHlwZXMpIHRoaXMuaW5zdGFsbFRhYmxlVHlwZSh0aGlzLnRhYmxlX3R5cGVzW2VdLmdldElkKCksIHRoaXMudGFibGVfdHlwZXNbZV0sIHQpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgIGtleTogImluc3RhbGxUYWJsZVR5cGUiLA0KICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgICAgICAgICAgICAgICAgIG4uY29tcG9uZW50KHQsIGUuZ2V0VGFibGVEZWZpbml0aW9uKCkpLCBuLmNvbXBvbmVudCh0ICsgIi1wYWdlciIsIGUuZ2V0UGFnZXJEZWZpbml0aW9uKCkpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfV0pLCB0DQogICAgICAgIH0oKTsNCiAgICBlLmEgPSBoDQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgInVzZSBzdHJpY3QiOw0KDQogICAgZnVuY3Rpb24gcih0LCBlKSB7DQogICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiBlKSkgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIikNCiAgICB9DQogICAgdmFyIHMgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIGZ1bmN0aW9uIHQodCwgZSkgew0KICAgICAgICAgICAgICAgIGZvciAodmFyIG4gPSAwOyBuIDwgZS5sZW5ndGg7IG4rKykgew0KICAgICAgICAgICAgICAgICAgICB2YXIgciA9IGVbbl07DQogICAgICAgICAgICAgICAgICAgIHIuZW51bWVyYWJsZSA9IHIuZW51bWVyYWJsZSB8fCAhMSwgci5jb25maWd1cmFibGUgPSAhMCwgInZhbHVlIiBpbiByICYmIChyLndyaXRhYmxlID0gITApLCBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgci5rZXksIHIpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUsIG4sIHIpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbiAmJiB0KGUucHJvdG90eXBlLCBuKSwgciAmJiB0KGUsIHIpLCBlDQogICAgICAgICAgICB9DQogICAgICAgIH0oKSwNCiAgICAgICAgaSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgZnVuY3Rpb24gdCgpIHsNCiAgICAgICAgICAgICAgICByKHRoaXMsIHQpLCB0aGlzLmZpbHRlckhhbmRsZXIgPSB0aGlzLmhhbmRsZUZpbHRlciwgdGhpcy5zb3J0SGFuZGxlciA9IHRoaXMuaGFuZGxlU29ydCwgdGhpcy5wYWdpbmF0ZUhhbmRsZXIgPSB0aGlzLmhhbmRsZVBhZ2luYXRlLCB0aGlzLmRpc3BsYXlIYW5kbGVyID0gdGhpcy5oYW5kbGVEaXNwbGF5DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gcyh0LCBbew0KICAgICAgICAgICAgICAgIGtleTogImhhbmRsZUZpbHRlciIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQsIGUsIG4pIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCFlKSByZXR1cm4gdDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBlLnNwbGl0KC9ccy8pOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5maWx0ZXIoZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZSBpbiByKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5yb3dNYXRjaGVzKHQsIHJbZV0sIG4pKSByZXR1cm4gITE7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gITANCiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBrZXk6ICJyb3dNYXRjaGVzIiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCwgZSwgbikgew0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciByIGluIG4pDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobltyXS5tYXRjaGVzKHQsIGUpKSByZXR1cm4gITA7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiAhMQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBrZXk6ICJoYW5kbGVTb3J0IiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCwgZSwgbikgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZSAmJiBudWxsICE9PSBuID8gdC5zb3J0KGZ1bmN0aW9uKHQsIHIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzID0gZS5nZXRSZXByZXNlbnRhdGlvbih0KSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID0gZS5nZXRSZXByZXNlbnRhdGlvbihyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzID09IGkpIHJldHVybiAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBzID4gaSA/IDEgOiAtMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiZGVzYyIgPT09IG4gJiYgKGEgKj0gLTEpLCBhDQogICAgICAgICAgICAgICAgICAgIH0pIDogdA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBrZXk6ICJoYW5kbGVQYWdpbmF0ZSIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQsIGUsIG4pIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCFlKSByZXR1cm4gdDsNCiAgICAgICAgICAgICAgICAgICAgbiA8IDEgJiYgKG4gPSAxKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSAobiAtIDEpICogZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHMgPSBuICogZTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuc2xpY2UociwgcykNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAga2V5OiAiaGFuZGxlRGlzcGxheSIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQsIGUsIG4sIHIpIHsNCiAgICAgICAgICAgICAgICAgICAgbih0KSwgcihlLmZpbHRlcmVkX2RhdGEubGVuZ3RoKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH1dKSwgdA0KICAgICAgICB9KCk7DQogICAgZS5hID0gaQ0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgICJ1c2Ugc3RyaWN0IjsNCg0KICAgIGZ1bmN0aW9uIHIodCwgZSkgew0KICAgICAgICBpZiAoISh0IGluc3RhbmNlb2YgZSkpIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpDQogICAgfQ0KICAgIHZhciBzID0gbigxNCksDQogICAgICAgIGkgPSBuLm4ocyksDQogICAgICAgIGEgPSBuKDI2KSwNCiAgICAgICAgbyA9IG4ubihhKSwNCiAgICAgICAgbCA9IG4oOSksDQogICAgICAgIHUgPSBuKDQpLA0KICAgICAgICBjID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPyBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICByZXR1cm4gdHlwZW9mIHQNCiAgICAgICAgfSA6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgIHJldHVybiB0ICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiB0LmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgdCAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIHQNCiAgICAgICAgfSwNCiAgICAgICAgZiA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgZnVuY3Rpb24gdCh0LCBlKSB7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBlLmxlbmd0aDsgbisrKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciByID0gZVtuXTsNCiAgICAgICAgICAgICAgICAgICAgci5lbnVtZXJhYmxlID0gci5lbnVtZXJhYmxlIHx8ICExLCByLmNvbmZpZ3VyYWJsZSA9ICEwLCAidmFsdWUiIGluIHIgJiYgKHIud3JpdGFibGUgPSAhMCksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCByLmtleSwgcikNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSwgbiwgcikgew0KICAgICAgICAgICAgICAgIHJldHVybiBuICYmIHQoZS5wcm90b3R5cGUsIG4pLCByICYmIHQoZSwgciksIGUNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSgpLA0KICAgICAgICBwID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBmdW5jdGlvbiB0KGUpIHsNCiAgICAgICAgICAgICAgICByKHRoaXMsIHQpLCB0aGlzLmlkID0gZSwgdGhpcy5oYW5kbGVyID0gbmV3IGwuYSwgdGhpcy5zZXR0aW5ncyA9IG5ldyB1LmENCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBmKHQsIFt7DQogICAgICAgICAgICAgICAga2V5OiAiZ2V0SWQiLA0KICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaWQNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAga2V5OiAic2V0RmlsdGVySGFuZGxlciIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlci5maWx0ZXJIYW5kbGVyID0gdCwgdGhpcw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBrZXk6ICJzZXRTb3J0SGFuZGxlciIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlci5zb3J0SGFuZGxlciA9IHQsIHRoaXMNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAga2V5OiAic2V0UGFnaW5hdGVIYW5kbGVyIiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVyLnBhZ2luYXRlSGFuZGxlciA9IHQsIHRoaXMNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAga2V5OiAic2V0RGlzcGxheUhhbmRsZXIiLA0KICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmhhbmRsZXIuZGlzcGxheUhhbmRsZXIgPSB0LCB0aGlzDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgew0KICAgICAgICAgICAgICAgIGtleTogInNldHRpbmciLA0KICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbih0LCBlKSB7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB2b2lkIDAgPT09IGUgPyB0aGlzLnNldHRpbmdzLmdldCh0KSA6ICh0aGlzLnNldHRpbmdzLnNldCh0LCBlKSwgdGhpcykNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAga2V5OiAibWVyZ2VTZXR0aW5ncyIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3MubWVyZ2UodCksIHRoaXMNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCB7DQogICAgICAgICAgICAgICAga2V5OiAiZ2V0VGFibGVEZWZpbml0aW9uIiwNCiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciB0ID0gdGhpcy5jbG9uZShpLmEpOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5oYW5kbGVyID0gdGhpcy5oYW5kbGVyLCB0LnNldHRpbmdzID0gdGhpcy5zZXR0aW5ncywgdC5uYW1lID0gdGhpcy5pZCwgdA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBrZXk6ICJnZXRQYWdlckRlZmluaXRpb24iLA0KICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSB0aGlzLmNsb25lKG8uYSk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0LnNldHRpbmdzID0gdGhpcy5zZXR0aW5ncywgdC5uYW1lID0gdGhpcy5pZCwgdA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHsNCiAgICAgICAgICAgICAgICBrZXk6ICJjbG9uZSIsDQogICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGU7DQogICAgICAgICAgICAgICAgICAgIGlmIChudWxsID09PSB0IHx8ICJvYmplY3QiICE9PSAodm9pZCAwID09PSB0ID8gInVuZGVmaW5lZCIgOiBjKHQpKSkgcmV0dXJuIHQ7DQogICAgICAgICAgICAgICAgICAgIGlmICh0IGluc3RhbmNlb2YgQXJyYXkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG4gPSAwOyBuIDwgdC5sZW5ndGg7IG4rKykgZVtuXSA9IHRoaXMuY2xvbmUodFtuXSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmICh0IGluc3RhbmNlb2YgT2JqZWN0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICBlID0ge307DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciByIGluIHQpIHQuaGFzT3duUHJvcGVydHkocikgJiYgKGVbcl0gPSB0aGlzLmNsb25lKHRbcl0pKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJVbmFibGUgdG8gY29weSBvYmohIEl0cyB0eXBlIGlzbid0IHN1cHBvcnRlZC4iKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH1dKSwgdA0KICAgICAgICB9KCk7DQogICAgZS5hID0gcA0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgIG4oMzYpOw0KICAgIHZhciByID0gbigyKShuKDE2KSwgbigzMSksIG51bGwsIG51bGwpOw0KICAgIHQuZXhwb3J0cyA9IHIuZXhwb3J0cw0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgIG4oMzQpOw0KICAgIHZhciByID0gbigyKShuKDE3KSwgbigyOSksIG51bGwsIG51bGwpOw0KICAgIHQuZXhwb3J0cyA9IHIuZXhwb3J0cw0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgIG4oMzUpOw0KICAgIHZhciByID0gbigyKShuKDE4KSwgbigzMCksIG51bGwsIG51bGwpOw0KICAgIHQuZXhwb3J0cyA9IHIuZXhwb3J0cw0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgIG4oMzMpOw0KICAgIHZhciByID0gbigyKShuKDIwKSwgbigyOCksIG51bGwsIG51bGwpOw0KICAgIHQuZXhwb3J0cyA9IHIuZXhwb3J0cw0KfSwgLCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgInVzZSBzdHJpY3QiOw0KICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCAiX19lc01vZHVsZSIsIHsNCiAgICAgICAgdmFsdWU6ICEwDQogICAgfSksIGUuZGVmYXVsdCA9IHsNCiAgICAgICAgcHJvcHM6IHsNCiAgICAgICAgICAgIGNvbHVtbjogW09iamVjdCwgQXJyYXldLA0KICAgICAgICAgICAgcm93OiBbT2JqZWN0LCBBcnJheV0NCiAgICAgICAgfSwNCiAgICAgICAgY29tcHV0ZWQ6IHsNCiAgICAgICAgICAgIGNvbnRlbnQ6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbHVtbi5nZXRSZXByZXNlbnRhdGlvbih0aGlzLnJvdykNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCn0sIGZ1bmN0aW9uKHQsIGUsIG4pIHsNCiAgICAidXNlIHN0cmljdCI7DQogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsICJfX2VzTW9kdWxlIiwgew0KICAgICAgICB2YWx1ZTogITANCiAgICB9KSwgZS5kZWZhdWx0ID0gew0KICAgICAgICBwcm9wczogew0KICAgICAgICAgICAgbW9kZWw6IHsNCiAgICAgICAgICAgICAgICBwcm9wOiAiZGlyZWN0aW9uIiwNCiAgICAgICAgICAgICAgICBldmVudDogImNoYW5nZSINCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBjb2x1bW46IFtPYmplY3QsIEFycmF5XSwNCiAgICAgICAgICAgIHNldHRpbmdzOiBPYmplY3QsDQogICAgICAgICAgICBkaXJlY3Rpb246IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBTdHJpbmcsDQogICAgICAgICAgICAgICAgZGVmYXVsdDogImFzYyINCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgY29tcHV0ZWQ6IHsNCiAgICAgICAgICAgIGNhblNvcnQ6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbHVtbi5zb3J0YWJsZQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGlzX3NvcnRlZF9hc2NlbmRpbmc6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiAiYXNjIiA9PT0gdGhpcy5kaXJlY3Rpb24NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBpc19zb3J0ZWRfZGVzY2VuZGluZzogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICJkZXNjIiA9PT0gdGhpcy5kaXJlY3Rpb24NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBpc19zb3J0ZWQ6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmlzX3NvcnRlZF9kZXNjZW5kaW5nIHx8IHRoaXMuaXNfc29ydGVkX2FzY2VuZGluZw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGNsYXNzZXM6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHZhciB0ID0gdGhpcy5zZXR0aW5ncy5nZXQoInRhYmxlLnNvcnRpbmcuY2xhc3NlcyIpLA0KICAgICAgICAgICAgICAgICAgICBlID0gdC5jYW5Tb3J0Ow0KICAgICAgICAgICAgICAgIC8vcmV0dXJuIHRoaXMuY2FuU29ydCA/IHRoaXMuaXNfc29ydGVkX2Rlc2NlbmRpbmcgPyAoZSA9IGUuY29uY2F0KHQuc29ydERlc2MpLCB0aGlzLmpvaW5DbGFzc2VzKGUpKSA6IChlID0gZS5jb25jYXQodC5zb3J0QXNjKSwgdGhpcy5qb2luQ2xhc3NlcyhlKSkgOiAiIg0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNhblNvcnQgPyB0aGlzLmlzX3NvcnRlZCA/ICh0aGlzLmlzX3NvcnRlZF9hc2NlbmRpbmcgJiYgKGUgPSBlLmNvbmNhdCh0LnNvcnRBc2MpKSwgdGhpcy5pc19zb3J0ZWRfZGVzY2VuZGluZyAmJiAoZSA9IGUuY29uY2F0KHQuc29ydERlc2MpKSwgdGhpcy5qb2luQ2xhc3NlcyhlKSkgOiAoZSA9IGUuY29uY2F0KHQuc29ydE5vbmUpLCB0aGlzLmpvaW5DbGFzc2VzKGUpKSA6ICIiDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIG1ldGhvZHM6IHsNCiAgICAgICAgICAgIGpvaW5DbGFzc2VzOiBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudW5pcXVlKHQpLmpvaW4oIiAiKQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHRvZ2dsZVNvcnQ6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIC8vdGhpcy5kaXJlY3Rpb24gJiYgbnVsbCAhPT0gdGhpcy5kaXJlY3Rpb24gJiYgImFzYyIgPT09IHRoaXMuZGlyZWN0aW9uID8gdGhpcy4kZW1pdCgiY2hhbmdlIiwgImRlc2MiLCB0aGlzLmNvbHVtbikgOiB0aGlzLiRlbWl0KCJjaGFuZ2UiLCAiZGVzYyIsIHRoaXMuY29sdW1uKQ0KICAgICAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uICYmIG51bGwgIT09IHRoaXMuZGlyZWN0aW9uID8gImFzYyIgPT09IHRoaXMuZGlyZWN0aW9uID8gdGhpcy4kZW1pdCgiY2hhbmdlIiwgImRlc2MiLCB0aGlzLmNvbHVtbikgOiB0aGlzLiRlbWl0KCJjaGFuZ2UiLCBudWxsLCB0aGlzLmNvbHVtbikgOiB0aGlzLiRlbWl0KCJjaGFuZ2UiLCAiYXNjIiwgdGhpcy5jb2x1bW4pDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgdW5pcXVlOiBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgdmFyIGUgPSB7fTsNCiAgICAgICAgICAgICAgICByZXR1cm4gdC5maWx0ZXIoZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gIWUuaGFzT3duUHJvcGVydHkodCkgJiYgKGVbdF0gPSAhMCkNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgICJ1c2Ugc3RyaWN0IjsNCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgIl9fZXNNb2R1bGUiLCB7DQogICAgICAgIHZhbHVlOiAhMA0KICAgIH0pOw0KICAgIG4oNCk7DQogICAgZS5kZWZhdWx0ID0gew0KICAgICAgICBwcm9wczogew0KICAgICAgICAgICAgZGlzYWJsZWQ6IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBCb29sZWFuLA0KICAgICAgICAgICAgICAgIGRlZmF1bHQ6ICExDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgc2VsZWN0ZWQ6IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBCb29sZWFuLA0KICAgICAgICAgICAgICAgIGRlZmF1bHQ6ICExDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgdmFsdWU6IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBOdW1iZXIsDQogICAgICAgICAgICAgICAgZGVmYXVsdDogbnVsbA0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBjb21wdXRlZDogew0KICAgICAgICAgICAgbGlfY2xhc3NlczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdmFyIHQgPSBbXTsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5nZXQoInBhZ2VyLmNsYXNzZXMubGkiKSAmJiB0LnB1c2godGhpcy5zZXR0aW5ncy5nZXQoInBhZ2VyLmNsYXNzZXMubGkiKSksIHRoaXMuZGlzYWJsZWQgJiYgdC5wdXNoKHRoaXMuc2V0dGluZ3MuZ2V0KCJwYWdlci5jbGFzc2VzLmRpc2FibGVkIikpLCB0aGlzLnNlbGVjdGVkICYmIHQucHVzaCh0aGlzLnNldHRpbmdzLmdldCgicGFnZXIuY2xhc3Nlcy5zZWxlY3RlZCIpKSwgdC5qb2luKCIgIikNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBhX2NsYXNzZXM6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHZhciB0ID0gW107DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3MuZ2V0KCJwYWdlci5jbGFzc2VzLmEiKSAmJiB0LnB1c2godGhpcy5zZXR0aW5ncy5nZXQoInBhZ2VyLmNsYXNzZXMuYSIpKSwgdC5qb2luKCIgIikNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBzZXR0aW5nczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHBhcmVudC5zZXR0aW5ncw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBtZXRob2RzOiB7DQogICAgICAgICAgICBzZW5kQ2xpY2s6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHRoaXMuZGlzYWJsZWQgfHwgdGhpcy4kZW1pdCgiY2xpY2siLCB0aGlzLnZhbHVlKQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgICJ1c2Ugc3RyaWN0IjsNCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgIl9fZXNNb2R1bGUiLCB7DQogICAgICAgIHZhbHVlOiAhMA0KICAgIH0pLCBlLmRlZmF1bHQgPSB7DQogICAgICAgIG1vZGVsOiB7DQogICAgICAgICAgICBwcm9wOiAicGFnZSIsDQogICAgICAgICAgICBldmVudDogImNoYW5nZSINCiAgICAgICAgfSwNCiAgICAgICAgcHJvcHM6IHsNCiAgICAgICAgICAgIHRhYmxlOiB7DQogICAgICAgICAgICAgICAgdHlwZTogU3RyaW5nLA0KICAgICAgICAgICAgICAgIGRlZmF1bHQ6ICJkZWZhdWx0Ig0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHR5cGU6IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBTdHJpbmcsDQogICAgICAgICAgICAgICAgZGVmYXVsdDogImxvbmciDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgcGVyUGFnZTogew0KICAgICAgICAgICAgICAgIHR5cGU6IE51bWJlciwNCiAgICAgICAgICAgICAgICBkZWZhdWx0OiAxMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHBhZ2U6IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBOdW1iZXIsDQogICAgICAgICAgICAgICAgZGVmYXVsdDogMQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBkYXRhOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgdGFibGVfaW5zdGFuY2U6IG51bGwNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgY29tcHV0ZWQ6IHsNCiAgICAgICAgICAgIHNob3c6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRhYmxlX2luc3RhbmNlICYmIHRoaXMudG90YWxfcm93cyA+IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB0b3RhbF9yb3dzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50YWJsZV9pbnN0YW5jZSA/IHRoaXMudGFibGVfaW5zdGFuY2UudG90YWxfcm93cyA6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBwYWdpbmF0aW9uX2NsYXNzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5nZXQoInBhZ2VyLmNsYXNzZXMucGFnZXIiKQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGRpc2FibGVkX2NsYXNzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5nZXQoInBhZ2VyLmNsYXNzZXMuZGlzYWJsZWQiKQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHByZXZpb3VzX2xpbmtfY2xhc3NlczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFnZSAtIDEgPCAxID8gdGhpcy5zZXR0aW5ncy5nZXQoInBhZ2VyLmNsYXNzZXMuZGlzYWJsZWQiKSA6ICIiDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgbmV4dF9saW5rX2NsYXNzZXM6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBhZ2UgKyAxID4gdGhpcy50b3RhbF9wYWdlcyA/IHRoaXMuc2V0dGluZ3MuZ2V0KCJwYWdlci5jbGFzc2VzLmRpc2FibGVkIikgOiAiIg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHRvdGFsX3BhZ2VzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50b3RhbF9yb3dzID4gMCA/IE1hdGguY2VpbCh0aGlzLnRvdGFsX3Jvd3MgLyB0aGlzLnBlclBhZ2UpIDogMQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHByZXZpb3VzX2ljb246IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLmdldCgicGFnZXIuaWNvbnMucHJldmlvdXMiKQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIG5leHRfaWNvbjogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3MuZ2V0KCJwYWdlci5pY29ucy5uZXh0IikNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBzZXR0aW5nczogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJG9wdGlvbnMuc2V0dGluZ3MNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgbWV0aG9kczogew0KICAgICAgICAgICAgc2V0UGFnZU51bTogZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgIHRoaXMudGFibGVfaW5zdGFuY2UucGFnZSA9IHQsIHRoaXMudGFibGVfaW5zdGFuY2UucGVyX3BhZ2UgPSB0aGlzLnBlclBhZ2UsIHRoaXMuJGVtaXQoImNoYW5nZSIsIHQpDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgZ2V0Q2xhc3NGb3JQYWdlOiBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFnZSA9PSB0ID8gdGhpcy5zZXR0aW5ncy5nZXQoInBhZ2VyLmNsYXNzZXMuc2VsZWN0ZWQiKSA6ICIiDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIHdhdGNoOiB7DQogICAgICAgICAgICB0b3RhbF9yb3dzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB0aGlzLnBhZ2UgPiB0aGlzLnRvdGFsX3BhZ2VzICYmIHRoaXMuc2V0UGFnZU51bSh0aGlzLnRvdGFsX3BhZ2VzKQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHBlclBhZ2U6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHZhciB0ID0gdGhpcy5wYWdlOw0KICAgICAgICAgICAgICAgIHQgPiB0aGlzLnRvdGFsX3BhZ2VzICYmICh0ID0gdGhpcy50b3RhbF9wYWdlcyksIHRoaXMuc2V0UGFnZU51bSh0KQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBjcmVhdGVkOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIGlmIChWdWUuJGRhdGF0YWJsZXNbdGhpcy50YWJsZV0pIHJldHVybiB0aGlzLnRhYmxlX2luc3RhbmNlID0gVnVlLiRkYXRhdGFibGVzW3RoaXMudGFibGVdLCB2b2lkKHRoaXMudGFibGVfaW5zdGFuY2UucGVyX3BhZ2UgPSB0aGlzLnBlclBhZ2UpOw0KICAgICAgICAgICAgdGhpcy4kcm9vdC4kb24oInRhYmxlLnJlYWR5IiwgZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgIHQgPT09IHRoaXMudGFibGUgJiYgKHRoaXMudGFibGVfaW5zdGFuY2UgPSBWdWUuJGRhdGF0YWJsZXNbdGhpcy50YWJsZV0sIHRoaXMudGFibGVfaW5zdGFuY2UucGVyX3BhZ2UgPSB0aGlzLnBlclBhZ2UpDQogICAgICAgICAgICB9LmJpbmQodGhpcykpDQogICAgICAgIH0sDQogICAgICAgIHNldHRpbmdzOiBudWxsDQogICAgfQ0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgICJ1c2Ugc3RyaWN0IjsNCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgIl9fZXNNb2R1bGUiLCB7DQogICAgICAgIHZhbHVlOiAhMA0KICAgIH0pOw0KICAgIHZhciByID0gbig1KTsNCiAgICBlLmRlZmF1bHQgPSB7DQogICAgICAgIHByb3BzOiB7DQogICAgICAgICAgICBuYW1lOiB7DQogICAgICAgICAgICAgICAgdHlwZTogU3RyaW5nLA0KICAgICAgICAgICAgICAgIGRlZmF1bHQ6ICJkZWZhdWx0Ig0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGNvbHVtbnM6IFtPYmplY3QsIEFycmF5XSwNCiAgICAgICAgICAgIGRhdGE6IFtPYmplY3QsIEFycmF5LCBTdHJpbmcsIEZ1bmN0aW9uXSwNCiAgICAgICAgICAgIGZpbHRlckJ5OiB7DQogICAgICAgICAgICAgICAgdHlwZTogU3RyaW5nLA0KICAgICAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICByb3dDbGFzc2VzOiB7DQogICAgICAgICAgICAgICAgdHlwZTogW1N0cmluZywgQXJyYXksIE9iamVjdCwgRnVuY3Rpb25dLA0KICAgICAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgZGF0YTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgIHNvcnRfYnk6IG51bGwsDQogICAgICAgICAgICAgICAgc29ydF9kaXI6IG51bGwsDQogICAgICAgICAgICAgICAgdG90YWxfcm93czogMCwNCiAgICAgICAgICAgICAgICBwYWdlOiAxLA0KICAgICAgICAgICAgICAgIHBlcl9wYWdlOiBudWxsLA0KICAgICAgICAgICAgICAgIHByb2Nlc3NlZF9yb3dzOiBbXQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBjb21wdXRlZDogew0KICAgICAgICAgICAgcm93czogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5zbGljZSgwKQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHNldHRpbmdzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kb3B0aW9ucy5zZXR0aW5ncw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRvcHRpb25zLmhhbmRsZXINCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBub3JtYWxpemVkX2NvbHVtbnM6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbHVtbnMubWFwKGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyByLmEodCkNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHRhYmxlX2NsYXNzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5nZXQoInRhYmxlLmNsYXNzIikNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgbWV0aG9kczogew0KICAgICAgICAgICAgZ2V0U29ydERpcmVjdGlvbkZvckNvbHVtbjogZnVuY3Rpb24odCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNvcnRfYnkgIT09IHQgPyBudWxsIDogdGhpcy5zb3J0X2Rpcg0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHNldFNvcnREaXJlY3Rpb25Gb3JDb2x1bW46IGZ1bmN0aW9uKHQsIGUpIHsNCiAgICAgICAgICAgICAgICB0aGlzLnNvcnRfYnkgPSBlLCB0aGlzLnNvcnRfZGlyID0gdA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHByb2Nlc3NSb3dzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBpZiAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgdGhpcy5kYXRhKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciB0ID0gdGhpcy5oYW5kbGVyLmZpbHRlckhhbmRsZXIodGhpcy5yb3dzLCB0aGlzLmZpbHRlckJ5LCB0aGlzLm5vcm1hbGl6ZWRfY29sdW1ucyksDQogICAgICAgICAgICAgICAgICAgICAgICBlID0gdGhpcy5oYW5kbGVyLnNvcnRIYW5kbGVyKHQsIHRoaXMuc29ydF9ieSwgdGhpcy5zb3J0X2RpciksDQogICAgICAgICAgICAgICAgICAgICAgICBuID0gdGhpcy5oYW5kbGVyLnBhZ2luYXRlSGFuZGxlcihlLCB0aGlzLnBlcl9wYWdlLCB0aGlzLnBhZ2UpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXIuZGlzcGxheUhhbmRsZXIobiwgew0KICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWRfZGF0YTogdCwNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRlZF9kYXRhOiBlLA0KICAgICAgICAgICAgICAgICAgICAgICAgcGFnZWRfZGF0YTogbg0KICAgICAgICAgICAgICAgICAgICB9LCB0aGlzLnNldFJvd3MsIHRoaXMuc2V0VG90YWxSb3dDb3VudCkNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICB2YXIgciA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcjogdGhpcy5maWx0ZXJCeSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRfYnk6IHRoaXMuc29ydF9ieSA/IHRoaXMuc29ydF9ieS5maWVsZCA6IG51bGwsDQogICAgICAgICAgICAgICAgICAgICAgICBzb3J0X2RpcjogdGhpcy5zb3J0X2RpciwNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VfbGVuZ3RoOiB0aGlzLnBlcl9wYWdlLA0KICAgICAgICAgICAgICAgICAgICAgICAgcGFnZV9udW1iZXI6IHRoaXMucGFnZQ0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEociwgZnVuY3Rpb24odCwgZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRSb3dzKHQpLCB0aGlzLnNldFRvdGFsUm93Q291bnQoZSkNCiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBzZXRSb3dzOiBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzZWRfcm93cyA9IHQNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBzZXRUb3RhbFJvd0NvdW50OiBmdW5jdGlvbih0KSB7DQogICAgICAgICAgICAgICAgdGhpcy50b3RhbF9yb3dzID0gdA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGdldFJvd0NsYXNzZXM6IGZ1bmN0aW9uKHQpIHsNCiAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMucm93Q2xhc3NlczsNCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbCA9PT0gZSAmJiAoZSA9IHRoaXMuc2V0dGluZ3MuZ2V0KCJ0YWJsZS5yb3cuY2xhc3NlcyIpKSwgImZ1bmN0aW9uIiA9PSB0eXBlb2YgZSA/IGUodCkgOiBlDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGNyZWF0ZWQ6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgVnVlLiRkYXRhdGFibGVzW3RoaXMubmFtZV0gPSB0aGlzLCB0aGlzLiRyb290LiRlbWl0KCJ0YWJsZS5yZWFkeSIsIHRoaXMubmFtZSksIHRoaXMuJHdhdGNoKGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGENCiAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgdGhpcy5wcm9jZXNzUm93cywgew0KICAgICAgICAgICAgICAgIGRlZXA6ICEwDQogICAgICAgICAgICB9KSwgdGhpcy4kd2F0Y2goImNvbHVtbnMiLCB0aGlzLnByb2Nlc3NSb3dzKSwgdGhpcy4kd2F0Y2goZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyQnkgKyB0aGlzLnBlcl9wYWdlICsgdGhpcy5wYWdlICsgdGhpcy5zb3J0X2J5ICsgdGhpcy5zb3J0X2Rpcg0KICAgICAgICAgICAgfS5iaW5kKHRoaXMpLCB0aGlzLnByb2Nlc3NSb3dzKSwgdGhpcy5wcm9jZXNzUm93cygpDQogICAgICAgIH0sDQogICAgICAgIGhhbmRsZXI6IG51bGwsDQogICAgICAgIHNldHRpbmdzOiBudWxsDQogICAgfQ0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgIGUgPSB0LmV4cG9ydHMgPSBuKDEpKCksIGUucHVzaChbdC5pLCAiIiwgIiJdKQ0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgIGUgPSB0LmV4cG9ydHMgPSBuKDEpKCksIGUucHVzaChbdC5pLCAiIiwgIiJdKQ0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgIGUgPSB0LmV4cG9ydHMgPSBuKDEpKCksIGUucHVzaChbdC5pLCAiIiwgIiJdKQ0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgIGUgPSB0LmV4cG9ydHMgPSBuKDEpKCksIGUucHVzaChbdC5pLCAiIiwgIiJdKQ0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgIGUgPSB0LmV4cG9ydHMgPSBuKDEpKCksIGUucHVzaChbdC5pLCAiIiwgIiJdKQ0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgIG4oMzIpOw0KICAgIHZhciByID0gbigyKShuKDE5KSwgbigyNyksIG51bGwsIG51bGwpOw0KICAgIHQuZXhwb3J0cyA9IHIuZXhwb3J0cw0KfSwgZnVuY3Rpb24odCwgZSkgew0KICAgIHQuZXhwb3J0cyA9IHsNCiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciB0ID0gdGhpcywNCiAgICAgICAgICAgICAgICBlID0gdC4kY3JlYXRlRWxlbWVudCwNCiAgICAgICAgICAgICAgICBuID0gdC5fc2VsZi5fYyB8fCBlOw0KICAgICAgICAgICAgcmV0dXJuIHQuc2hvdyA/IG4oIm5hdiIsIHtjbGFzczogInRleHQtY2VudGVyIn0sIFsiYWJicmV2aWF0ZWQiID09PSB0LnR5cGUgPyBuKCJ1bCIsIHsNCiAgICAgICAgICAgICAgICBjbGFzczogdC5wYWdpbmF0aW9uX2NsYXNzDQogICAgICAgICAgICB9LCBbdC5wYWdlIC0gMyA+PSAxID8gbigiZGF0YXRhYmxlLWJ1dHRvbiIsIHsNCiAgICAgICAgICAgICAgICBhdHRyczogew0KICAgICAgICAgICAgICAgICAgICB2YWx1ZTogMQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgb246IHsNCiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IHQuc2V0UGFnZU51bQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pIDogdC5fZSgpLCB0Ll92KCIgIiksIHQucGFnZSAtIDQgPj0gMSA/IG4oImRhdGF0YWJsZS1idXR0b24iLCB7DQogICAgICAgICAgICAgICAgYXR0cnM6IHsNCiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6ICIiDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgW3QuX3YoIi4uLiIpXSkgOiB0Ll9lKCksIHQuX3YoIiAiKSwgdC5wYWdlIC0gMiA+PSAxID8gbigiZGF0YXRhYmxlLWJ1dHRvbiIsIHsNCiAgICAgICAgICAgICAgICBhdHRyczogew0KICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdC5wYWdlIC0gMg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgb246IHsNCiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IHQuc2V0UGFnZU51bQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pIDogdC5fZSgpLCB0Ll92KCIgIiksIHQucGFnZSAtIDEgPj0gMSA/IG4oImRhdGF0YWJsZS1idXR0b24iLCB7DQogICAgICAgICAgICAgICAgYXR0cnM6IHsNCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHQucGFnZSAtIDENCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIG9uOiB7DQogICAgICAgICAgICAgICAgICAgIGNsaWNrOiB0LnNldFBhZ2VOdW0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KSA6IHQuX2UoKSwgdC5fdigiICIpLCBuKCJkYXRhdGFibGUtYnV0dG9uIiwgew0KICAgICAgICAgICAgICAgIGF0dHJzOiB7DQogICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0LnBhZ2UsDQogICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiAiIg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pLCB0Ll92KCIgIiksIHQucGFnZSArIDEgPD0gdC50b3RhbF9wYWdlcyA/IG4oImRhdGF0YWJsZS1idXR0b24iLCB7DQogICAgICAgICAgICAgICAgYXR0cnM6IHsNCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHQucGFnZSArIDENCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIG9uOiB7DQogICAgICAgICAgICAgICAgICAgIGNsaWNrOiB0LnNldFBhZ2VOdW0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KSA6IHQuX2UoKSwgdC5fdigiICIpLCB0LnBhZ2UgKyAyIDw9IHQudG90YWxfcGFnZXMgPyBuKCJkYXRhdGFibGUtYnV0dG9uIiwgew0KICAgICAgICAgICAgICAgIGF0dHJzOiB7DQogICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0LnBhZ2UgKyAyDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBvbjogew0KICAgICAgICAgICAgICAgICAgICBjbGljazogdC5zZXRQYWdlTnVtDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSkgOiB0Ll9lKCksIHQuX3YoIiAiKSwgdC5wYWdlICsgNCA8PSB0LnRvdGFsX3BhZ2VzID8gbigiZGF0YXRhYmxlLWJ1dHRvbiIsIHsNCiAgICAgICAgICAgICAgICBhdHRyczogew0KICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogIiINCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCBbdC5fdigiLi4uIildKSA6IHQuX2UoKSwgdC5fdigiICIpLCB0LnBhZ2UgKyAzIDw9IHQudG90YWxfcGFnZXMgPyBuKCJkYXRhdGFibGUtYnV0dG9uIiwgew0KICAgICAgICAgICAgICAgIGF0dHJzOiB7DQogICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0LnRvdGFsX3BhZ2VzDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBvbjogew0KICAgICAgICAgICAgICAgICAgICBjbGljazogdC5zZXRQYWdlTnVtDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSkgOiB0Ll9lKCldLCAxKSA6ICJsb25nIiA9PT0gdC50eXBlID8gbigidWwiLCB7DQogICAgICAgICAgICAgICAgY2xhc3M6IHQucGFnaW5hdGlvbl9jbGFzcw0KICAgICAgICAgICAgfSwgdC5fbCh0LnRvdGFsX3BhZ2VzLCBmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIG4oImRhdGF0YWJsZS1idXR0b24iLCB7DQogICAgICAgICAgICAgICAgICAgIGtleTogZSwNCiAgICAgICAgICAgICAgICAgICAgYXR0cnM6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBlLA0KICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IGUgPT09IHQucGFnZQ0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICBvbjogew0KICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2s6IHQuc2V0UGFnZU51bQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIH0pKSA6ICJzaG9ydCIgPT09IHQudHlwZSA/IG4oInVsIiwgew0KICAgICAgICAgICAgICAgIGNsYXNzOiB0LnBhZ2luYXRpb25fY2xhc3MNCiAgICAgICAgICAgIH0sIFtuKCJkYXRhdGFibGUtYnV0dG9uIiwgew0KICAgICAgICAgICAgICAgIGF0dHJzOiB7DQogICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiB0LnBhZ2UgLSAxIDwgMSwNCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHQucGFnZSAtIDENCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIG9uOiB7DQogICAgICAgICAgICAgICAgICAgIGNsaWNrOiB0LnNldFBhZ2VOdW0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCBbbigic3BhbiIsIHsNCiAgICAgICAgICAgICAgICBkb21Qcm9wczogew0KICAgICAgICAgICAgICAgICAgICBpbm5lckhUTUw6IHQuX3ModC5wcmV2aW91c19pY29uKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pXSksIHQuX3YoIiAiKSwgbigiZGF0YXRhYmxlLWJ1dHRvbiIsIHsNCiAgICAgICAgICAgICAgICBhdHRyczogew0KICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdC5wYWdlLA0KICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogIiINCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KSwgdC5fdigiICIpLCBuKCJkYXRhdGFibGUtYnV0dG9uIiwgew0KICAgICAgICAgICAgICAgIGF0dHJzOiB7DQogICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiB0LnBhZ2UgKyAxID4gdC50b3RhbF9wYWdlcywNCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHQucGFnZSArIDENCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIG9uOiB7DQogICAgICAgICAgICAgICAgICAgIGNsaWNrOiB0LnNldFBhZ2VOdW0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCBbbigic3BhbiIsIHsNCiAgICAgICAgICAgICAgICBkb21Qcm9wczogew0KICAgICAgICAgICAgICAgICAgICBpbm5lckhUTUw6IHQuX3ModC5uZXh0X2ljb24pDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSldKV0sIDEpIDogdC5fZSgpXSkgOiB0Ll9lKCkNCiAgICAgICAgfSwNCiAgICAgICAgc3RhdGljUmVuZGVyRm5zOiBbXQ0KICAgIH0NCn0sIGZ1bmN0aW9uKHQsIGUpIHsNCiAgICB0LmV4cG9ydHMgPSB7DQogICAgICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICB2YXIgdCA9IHRoaXMsDQogICAgICAgICAgICAgICAgZSA9IHQuJGNyZWF0ZUVsZW1lbnQsDQogICAgICAgICAgICAgICAgbiA9IHQuX3NlbGYuX2MgfHwgZTsNCiAgICAgICAgICAgIHJldHVybiBuKCJ0YWJsZSIsIHsNCiAgICAgICAgICAgICAgICBjbGFzczogdC50YWJsZV9jbGFzcw0KICAgICAgICAgICAgfSwgW24oInRoZWFkIiwgW24oInRyIiwgdC5fbCh0Lm5vcm1hbGl6ZWRfY29sdW1ucywgZnVuY3Rpb24oZSwgcikgew0KICAgICAgICAgICAgICAgIHJldHVybiBuKCJkYXRhdGFibGUtaGVhZGVyIiwgew0KICAgICAgICAgICAgICAgICAgICBrZXk6IHIsDQogICAgICAgICAgICAgICAgICAgIGF0dHJzOiB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW46IGUsDQogICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5nczogdC5zZXR0aW5ncywNCiAgICAgICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogdC5nZXRTb3J0RGlyZWN0aW9uRm9yQ29sdW1uKGUpDQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgIG9uOiB7DQogICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2U6IHQuc2V0U29ydERpcmVjdGlvbkZvckNvbHVtbg0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIH0pKV0pLCB0Ll92KCIgIiksIG4oInRib2R5IiwgW3QuX2wodC5wcm9jZXNzZWRfcm93cywgZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0Ll90KCJkZWZhdWx0IiwgW24oInRyIiwgew0KICAgICAgICAgICAgICAgICAgICBjbGFzczogdC5nZXRSb3dDbGFzc2VzKGUpDQogICAgICAgICAgICAgICAgfSwgdC5fbCh0Lm5vcm1hbGl6ZWRfY29sdW1ucywgZnVuY3Rpb24odCwgcikgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbigiZGF0YXRhYmxlLWNlbGwiLCB7DQogICAgICAgICAgICAgICAgICAgICAgICBrZXk6IHIsDQogICAgICAgICAgICAgICAgICAgICAgICBhdHRyczogew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbjogdCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3c6IGUNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICB9KSldLCB7DQogICAgICAgICAgICAgICAgICAgIHJvdzogZQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9KSwgdC5fdigiICIpLCAwID09IHQucHJvY2Vzc2VkX3Jvd3MubGVuZ3RoID8gbigidHIiLCBbbigidGQiLCB7DQogICAgICAgICAgICAgICAgYXR0cnM6IHsNCiAgICAgICAgICAgICAgICAgICAgY29sc3BhbjogdC5ub3JtYWxpemVkX2NvbHVtbnMubGVuZ3RoDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgW3QuX3QoIm5vLXJlc3VsdHMiKV0sIDIpXSkgOiB0Ll9lKCldLCAyKV0pDQogICAgICAgIH0sDQogICAgICAgIHN0YXRpY1JlbmRlckZuczogW10NCiAgICB9DQp9LCBmdW5jdGlvbih0LCBlKSB7DQogICAgdC5leHBvcnRzID0gew0KICAgICAgICByZW5kZXI6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIHQgPSB0aGlzLA0KICAgICAgICAgICAgICAgIGUgPSB0LiRjcmVhdGVFbGVtZW50LA0KICAgICAgICAgICAgICAgIG4gPSB0Ll9zZWxmLl9jIHx8IGU7DQogICAgICAgICAgICByZXR1cm4gbigidGgiLCB7DQogICAgICAgICAgICAgICAgc3R5bGU6IHsNCiAgICAgICAgICAgICAgICAgICAgInRleHQtYWxpZ24iOiAiY2VudGVyIiwgIC8vdC5jb2x1bW4uYWxpZ24NCiAgICAgICAgICAgICAgICAgICAgImRpc3BsYXkiOiB0LmNvbHVtbi5kaXNwbGF5DQogICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgfSwgW3QuX3YoIlxuXHQiICsgdC5fcyh0LmNvbHVtbi5sYWJlbCkgKyAiXG5cdCIpLCB0LmNvbHVtbi5zb3J0YWJsZSA/IG4oInNwYW4iLCB7DQogICAgICAgICAgICAgICAgY2xhc3M6IHQuY2xhc3NlcywNCiAgICAgICAgICAgICAgICBvbjogew0KICAgICAgICAgICAgICAgICAgICBjbGljazogdC50b2dnbGVTb3J0DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSkgOiB0Ll9lKCldKQ0KICAgICAgICB9LA0KICAgICAgICBzdGF0aWNSZW5kZXJGbnM6IFtdDQogICAgfQ0KfSwgZnVuY3Rpb24odCwgZSkgew0KICAgIHQuZXhwb3J0cyA9IHsNCiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciB0ID0gdGhpcywNCiAgICAgICAgICAgICAgICBlID0gdC4kY3JlYXRlRWxlbWVudCwNCiAgICAgICAgICAgICAgICBuID0gdC5fc2VsZi5fYyB8fCBlOw0KICAgICAgICAgICAgcmV0dXJuIG4oImxpIiwgew0KICAgICAgICAgICAgICAgIGNsYXNzOiB0LmxpX2NsYXNzZXMNCiAgICAgICAgICAgIH0sIFtuKCJhIiwgew0KICAgICAgICAgICAgICAgIGNsYXNzOiB0LmFfY2xhc3NlcywNCiAgICAgICAgICAgICAgICBhdHRyczogew0KICAgICAgICAgICAgICAgICAgICBocmVmOiAiamF2YXNjcmlwdDogdm9pZCgwKTsiDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBvbjogew0KICAgICAgICAgICAgICAgICAgICBjbGljazogdC5zZW5kQ2xpY2sNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCBbdC5fdCgiZGVmYXVsdCIsIFt0Ll92KHQuX3ModC52YWx1ZSkpXSldLCAyKV0pDQogICAgICAgIH0sDQogICAgICAgIHN0YXRpY1JlbmRlckZuczogW10NCiAgICB9DQp9LCBmdW5jdGlvbih0LCBlKSB7DQogICAgdC5leHBvcnRzID0gew0KICAgICAgICByZW5kZXI6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIHQgPSB0aGlzLA0KICAgICAgICAgICAgICAgIGUgPSB0LiRjcmVhdGVFbGVtZW50LA0KICAgICAgICAgICAgICAgIG4gPSB0Ll9zZWxmLl9jIHx8IGU7DQogICAgICAgICAgICByZXR1cm4gbigidGQiLCB7DQogICAgICAgICAgICAgICAgc3R5bGU6IHsNCiAgICAgICAgICAgICAgICAgICAgInRleHQtYWxpZ24iOiB0LmNvbHVtbi5hbGlnbiwNCiAgICAgICAgICAgICAgICAgICAgImRpc3BsYXkiOiB0LmNvbHVtbi5kaXNwbGF5DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwgW3QuY29sdW1uLmNvbXBvbmVudCA/IG4odC5jb2x1bW4uY29tcG9uZW50LCB7DQogICAgICAgICAgICAgICAgdGFnOiAiY29tcG9uZW50IiwNCiAgICAgICAgICAgICAgICBhdHRyczogew0KICAgICAgICAgICAgICAgICAgICByb3c6IHQucm93LA0KICAgICAgICAgICAgICAgICAgICBjb2x1bW46IHQuY29sdW1uDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSkgOiB0LmNvbHVtbi5pbnRlcnBvbGF0ZSA/IG4oInNwYW4iLCB7DQogICAgICAgICAgICAgICAgZG9tUHJvcHM6IHsNCiAgICAgICAgICAgICAgICAgICAgaW5uZXJIVE1MOiB0Ll9zKHQuY29udGVudCkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KSA6IG4oInNwYW4iLCBbdC5fdih0Ll9zKHQuY29udGVudCkpXSldLCAxKQ0KICAgICAgICB9LA0KICAgICAgICBzdGF0aWNSZW5kZXJGbnM6IFtdDQogICAgfQ0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgIHZhciByID0gbigyMSk7DQogICAgInN0cmluZyIgPT0gdHlwZW9mIHIgJiYgKHIgPSBbDQogICAgICAgIFt0LmksIHIsICIiXQ0KICAgIF0pLCByLmxvY2FscyAmJiAodC5leHBvcnRzID0gci5sb2NhbHMpOw0KICAgIG4oMykoIjIyMGQ0MTE2IiwgciwgITApDQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgdmFyIHIgPSBuKDIyKTsNCiAgICAic3RyaW5nIiA9PSB0eXBlb2YgciAmJiAociA9IFsNCiAgICAgICAgW3QuaSwgciwgIiJdDQogICAgXSksIHIubG9jYWxzICYmICh0LmV4cG9ydHMgPSByLmxvY2Fscyk7DQogICAgbigzKSgiNjM0ZTI2MGMiLCByLCAhMCkNCn0sIGZ1bmN0aW9uKHQsIGUsIG4pIHsNCiAgICB2YXIgciA9IG4oMjMpOw0KICAgICJzdHJpbmciID09IHR5cGVvZiByICYmIChyID0gWw0KICAgICAgICBbdC5pLCByLCAiIl0NCiAgICBdKSwgci5sb2NhbHMgJiYgKHQuZXhwb3J0cyA9IHIubG9jYWxzKTsNCiAgICBuKDMpKCI3NjIxOTgxOCIsIHIsICEwKQ0KfSwgZnVuY3Rpb24odCwgZSwgbikgew0KICAgIHZhciByID0gbigyNCk7DQogICAgInN0cmluZyIgPT0gdHlwZW9mIHIgJiYgKHIgPSBbDQogICAgICAgIFt0LmksIHIsICIiXQ0KICAgIF0pLCByLmxvY2FscyAmJiAodC5leHBvcnRzID0gci5sb2NhbHMpOw0KICAgIG4oMykoIjNmYWNiYTc0IiwgciwgITApDQp9LCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgdmFyIHIgPSBuKDI1KTsNCiAgICAic3RyaW5nIiA9PSB0eXBlb2YgciAmJiAociA9IFsNCiAgICAgICAgW3QuaSwgciwgIiJdDQogICAgXSksIHIubG9jYWxzICYmICh0LmV4cG9ydHMgPSByLmxvY2Fscyk7DQogICAgbigzKSgiNWY5YzllZjgiLCByLCAhMCkNCn0sIGZ1bmN0aW9uKHQsIGUpIHsNCiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0LCBlKSB7DQogICAgICAgIGZvciAodmFyIG4gPSBbXSwgciA9IHt9LCBzID0gMDsgcyA8IGUubGVuZ3RoOyBzKyspIHsNCiAgICAgICAgICAgIHZhciBpID0gZVtzXSwNCiAgICAgICAgICAgICAgICBhID0gaVswXSwNCiAgICAgICAgICAgICAgICBvID0gaVsxXSwNCiAgICAgICAgICAgICAgICBsID0gaVsyXSwNCiAgICAgICAgICAgICAgICB1ID0gaVszXSwNCiAgICAgICAgICAgICAgICBjID0gew0KICAgICAgICAgICAgICAgICAgICBpZDogdCArICI6IiArIHMsDQogICAgICAgICAgICAgICAgICAgIGNzczogbywNCiAgICAgICAgICAgICAgICAgICAgbWVkaWE6IGwsDQogICAgICAgICAgICAgICAgICAgIHNvdXJjZU1hcDogdQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICByW2FdID8gclthXS5wYXJ0cy5wdXNoKGMpIDogbi5wdXNoKHJbYV0gPSB7DQogICAgICAgICAgICAgICAgaWQ6IGEsDQogICAgICAgICAgICAgICAgcGFydHM6IFtjXQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gbg0KICAgIH0NCn0sICwgLCAsICwgLCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgInVzZSBzdHJpY3QiOw0KICAgIHZhciByID0gbig4KTsNCiAgICBlLmEgPSBuZXcgci5hDQp9LCAsICwgLCAsICwgLCAsICwgLCAsICwgLCAsICwgLCAsICwgLCAsICwgLCAsIGZ1bmN0aW9uKHQsIGUsIG4pIHsNCiAgICAidXNlIHN0cmljdCI7DQogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsICJfX2VzTW9kdWxlIiwgew0KICAgICAgICB2YWx1ZTogITANCiAgICB9KTsNCiAgICB2YXIgciA9IG4oNDMpOw0KICAgIHdpbmRvdy5WdWUudXNlKHIuYSkNCn0sICwgLCAsICwgLCAsICwgLCAsICwgLCAsICwgLCBmdW5jdGlvbih0LCBlLCBuKSB7DQogICAgdC5leHBvcnRzID0gbig2NikNCn1dKTsNCg0KLy8gc2VsZWN0IOaPkuS7tg0KLy8gbGl2ZXNlYXJjaDog5pCc5bCL5LiL5ouJ6YG45ZauICh0cnVlKQ0KLy8gbXVsdGlwbGU6IOWkmumBuCAobXVsdGlwbGUpLCDlpJrpgbjmmYLmnIPmnIkgIuWFqOmBuCIsICLlhajkuI3pgbgiIOWFqeWAi+mBuOmghQ0KLy8gYmxhbms6IOmgkOioreiri+mBuOaThyAodHJ1ZSkNClZ1ZS5jb21wb25lbnQoJ3Ytc2VsZWN0Jywgew0KICAgIHByb3BzOiBbJ29wdGlvbnMnLCAndmFsdWUnLCAnbGl2ZXNlYXJjaCcsICdtdWx0aXBsZScsICdibGFuayddLA0KICAgIHRlbXBsYXRlOiBbIjxzZWxlY3QgOm11bHRpcGxlPSdtdWx0aXBsZScgOmRhdGEtbGl2ZS1zZWFyY2g9J2xpdmVzZWFyY2gnIGNsYXNzPSdmb3JtLWNvbnRyb2wnPiAiLA0KICAgICAgICAgICAgICAgICAgICI8b3B0aW9uIDp2YWx1ZT0nb3B0aW9uLkNvZGUnIHYtZm9yPSdvcHRpb24gaW4gb3B0aW9ucycgOnNlbGVjdGVkPSdvcHRpb24uQ29kZT09PXZhbHVlJz57eyBvcHRpb24uRGVzY3JpcHRpb24gfX08L29wdGlvbj4gIiwNCiAgICAgICAgICAgICAgICAiPC9zZWxlY3QiXS5qb2luKCIiKSwNCiAgICBtb3VudGVkOiBmdW5jdGlvbiAoKSB7DQoNCiAgICAgICAgdmFyIHZtID0gdGhpczsNCiAgICAgICAgLy9hbGVydCh2bS5saXZlc2VhcmNoKTsNCiAgICAgICAgLy9hbGVydCh2bS5tdWx0aXBsZSk7DQogICAgICAgIC8vYWxlcnQodGhpcy52YWx1ZSk7DQogICAgICAgIC8vJCh0aGlzLiRlbCkudmFsKHRoaXMudmFsdWUgIT0gbnVsbCA/IHRoaXMudmFsdWUgOiBudWxsKTsNCiAgICAgICAgLy9hbGVydChKU09OLnN0cmluZ2lmeSh0aGlzLm9wdGlvbnMpKTsNCiAgICAgICAgDQogICAgICAgIC8vYWxlcnQoJCh2bS4kZWwpLnByb3AoJ291dGVySFRNTCcpKTsNCiAgICAgICAgLy8g6KuL6YG45pOH6YG46aCFDQogICAgICAgIGlmICh2bS5ibGFuaykgew0KICAgICAgICAgICAgJCh0aGlzLiRlbCkucHJlcGVuZCgnPG9wdGlvbiBzdHlsZT0iY29sb3I6IGdyYXkiIHZhbHVlPSIiPuiri+mBuOaThzwvb3B0aW9uPicpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8g6aGv56S65paH5a2XKOS4reaWh+e3qOeivCkNCiAgICAgICAgJCh0aGlzLiRlbCkuc2VsZWN0cGlja2VyKHsNCiAgICAgICAgICAgIG5vbmVTZWxlY3RlZFRleHQ6ICfmspLmnInpgbjlj5bku7vkvZXpoIXnm64nLA0KICAgICAgICAgICAgbm9uZVJlc3VsdHNUZXh0OiAn5rKS5pyJ5om+5Yiw56ym5ZCI55qE57WQ5p6cJywNCiAgICAgICAgICAgIGNvdW50U2VsZWN0ZWRUZXh0OiAn5bey57aT6YG45Y+WezB95YCL6aCF55uuJywNCiAgICAgICAgICAgIG1heE9wdGlvbnNUZXh0OiBbJ+i2hemBjumZkOWItiAo5pyA5aSa6YG45pOHe2596aCFKScsICfotoXpgY7pmZDliLYo5pyA5aSa6YG45pOHe25957WEKSddLA0KICAgICAgICAgICAgc2VsZWN0QWxsVGV4dDogJ+WFqOmBuCcsDQogICAgICAgICAgICBkZXNlbGVjdEFsbFRleHQ6ICflhajlj5bmtognLA0KICAgICAgICAgICAgbXVsdGlwbGVTZXBhcmF0b3I6ICcsICcsDQogICAgICAgICAgICBzaXplOiAxMCwNCiAgICAgICAgICAgIHRpdGxlOiAnLS3oq4vpgbjmk4ctLScsDQogICAgICAgICAgICBjbGFzczogJ3NlbGVjdHBpY2tlcicsDQogICAgICAgICAgICBhY3Rpb25zQm94OiB0cnVlIC8vIOmhr+ekuuWFqOmBuCwg5YWo5Y+W5raIDQogICAgICAgIH0pOw0KICAgICAgICANCiAgICAgICAgJCh0aGlzLiRlbCkuc2VsZWN0cGlja2VyKCd2YWwnLCB0aGlzLnZhbHVlICE9IG51bGwgPyB0aGlzLnZhbHVlIDogbnVsbCk7DQogICAgICAgICQodGhpcy4kZWwpLnZhbCh0aGlzLnZhbHVlKS5zZWxlY3RwaWNrZXIoKS5vbignY2hhbmdlZC5icy5zZWxlY3QnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2bS4kZW1pdCgnaW5wdXQnLCAkKHRoaXMpLnNlbGVjdHBpY2tlcigidmFsIikpOw0KICAgICAgICB9KTsNCg0KICAgICAgICAvL2FsZXJ0KEpTT04uc3RyaW5naWZ5KHZtLm9wdGlvbnMpKTsNCiAgICAgICAgLyoNCiAgICAgICAgaWYgKHZtLm9wdGlvbnMpIHsNCiAgICAgICAgICAgICQodGhpcy4kZWwpLmRhdGEoJ3NlbGVjdHBpY2tlcicpLiRsaXMuZWFjaChmdW5jdGlvbiAoaSkgew0KICAgICAgICAgICAgICAgIGlmICh2bS5vcHRpb25zW2ldKSB7DQogICAgICAgICAgICAgICAgICAgICQodGhpcykuYXR0cigndGl0bGUnLCB2bS5vcHRpb25zW2ldLlRvb2xUaXApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgICovDQogICAgfSwNCiAgICB1cGRhdGVkOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICQodGhpcy4kZWwpLnNlbGVjdHBpY2tlcigncmVmcmVzaCcpOw0KICAgICAgICAkKHRoaXMuJGVsKS5zZWxlY3RwaWNrZXIoInZhbCIsIHRoaXMudmFsdWUpOw0KICAgICAgICAvKg0KICAgICAgICB2YXIgdm0gPSB0aGlzOw0KICAgICAgICBpZiAodm0ub3B0aW9ucykgew0KICAgICAgICAgICAgJCh0aGlzLiRlbCkuZGF0YSgnc2VsZWN0cGlja2VyJykuJGxpcy5lYWNoKGZ1bmN0aW9uIChpKSB7DQogICAgICAgICAgICAgICAgaWYgKHZtLm9wdGlvbnNbaV0pIHsNCiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5hdHRyKCd0aXRsZScsIHZtLm9wdGlvbnNbaV0uVG9vbFRpcCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgICAgKi8NCiAgICB9LA0KICAgIGRlc3Ryb3llZDogZnVuY3Rpb24gKCkgew0KICAgICAgICAkKHRoaXMuJGVsKS5vZmYoKS5zZWxlY3RwaWNrZXIoJ2Rlc3Ryb3knKTsNCiAgICB9DQp9KTsNCg0K","CacheKey":"Lgz9m2UVq3TXeJ2PyI-lIk01OXw"}